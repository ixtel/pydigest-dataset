<html><body><div><div class="post-text" itemprop="text">
<p>I have had a go transferring this into NumPy arrays and borrowed from this question: <a href="http://stackoverflow.com/questions/4709510/itertools-product-speed-up">itertools product speed up</a> </p>

<p>This is what I have got, (there may be more speed ups here):</p>

<pre><code>def find_leading_zeros(n):
    if n % 2:
        return numpy.zeros(n)
    m = n+1
    leading_zero_counts = numpy.zeros(m)
    product_list = [-1, 1]
    repeat = n
    s = (numpy.array(product_list)[numpy.rollaxis(numpy.indices((len(product_list),) * repeat),
                                                  0, repeat + 1).reshape(-1, repeat)]).astype('int8')
    i = 0
    size = s.shape[0] / 2
    products = numpy.zeros((size, size), dtype=bool)
    while i &lt; m:
        products += (numpy.tensordot(s[0:size, 0:size],
                                     numpy.roll(s, i, axis=1)[0:size, 0:size],
                                     axes=(-1,-1))).astype('bool')
        leading_zero_counts[i] = (products.size - numpy.sum(products)) * 4
        i += 1

    return leading_zero_counts
</code></pre>

<p>Running for n=14 I get:</p>

<pre><code>&gt;&gt;&gt; find_leading_zeros(14)
array([ 56229888.,  23557248.,   9903104.,   4160640.,   1758240.,
        755392.,    344800.,    172320.,    101312.,     75776.,
        65696.,     61216.,     59200.,     59200.,     59200.])
</code></pre>

<p>So all looks good. As for speed:</p>

<pre><code>&gt;&gt;&gt; timeit.timeit("find_leading_zeros_old(10)", number=10)
28.775046825408936
&gt;&gt;&gt; timeit.timeit("find_leading_zeros(10)", number=10)
2.236745834350586
</code></pre>

<p>See what you think. </p>

<p>EDIT:</p>

<p>The original version used 2074MB of memory for N=14 so I have removed the concatenated array and used <code>numpy.roll</code> instead. Also changing the data types to use a boolean array, brings the memory down to 277MB for n=14. </p>

<p>Time wise the edit is a little faster again:</p>

<pre><code>&gt;&gt;&gt; timeit.timeit("find_leading_zeros(10)", number=10)
1.3816070556640625
</code></pre>

<p>EDIT2:</p>

<p>Ok so adding in the symmetry as pointed out by David I reduce this again. It now uses 213MB. The comparison timing compared to previous edits:</p>

<pre><code>&gt;&gt;&gt; timeit.timeit("find_leading_zeros(10)", number=10)
0.35357093811035156 
</code></pre>

<p>I can now do the n=14 case in 14 seconds on my mac book which is not bad for "pure python" I think.</p>
    </div>
    </div></body></html>