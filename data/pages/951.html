<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-pywinner--get-windows-ready-to-compile-python-extensions" class="anchor" href="#pywinner--get-windows-ready-to-compile-python-extensions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>pywinner — get Windows ready to compile Python extensions</h1>

<p>The PyWinner project is a ragtag collection of scripts that sets up a
Windows EC2 instance to build Python extensions.  These are the main
subcommands:</p>

<ul>
<li><p><code>python -m pywinner.generate</code>
creates an SSL private key and self-signed certificate that your
local machine will use to give orders to the Windows machine.</p></li>
<li><p><code>python -m pywinner.ec2</code>
uses <a href="http://boto.readthedocs.org/en/latest/">Boto</a> to create a
Windows EC2 instance that, on first boot, downloads and installs
every version of Python back to version 2.5 and then also downloads
(but does not install, because I am not sure how to automate Windows
installer click-throughs) all of the Microsoft compilers that are
necessary to build Python extensions under Python 2.5 through 3.4:</p>

<ul>
<li><p><strong>Microsoft Visual Studio Express 2008</strong> which builts 32-bit
Python extensions for Python 3.2 and earlier.</p></li>
<li><p><strong>Microsoft Windows SDK for Windows 7 and .NET Framework 3.5 SP1</strong>
which builds 64-bit Python extensions for Python 3.2 and earlier.</p></li>
<li><p><strong>Microsoft Windows SDK for Windows 7 and .NET Framework 4</strong> which
builds both 32-bit and 64-bit Python extensions for Python 3.3 and
later.</p></li>
</ul>

<p>These three installers are left sitting on the Administrator desktop
so you can log in with Remote Desktop, double-click them, and get
the compilers all installed.  I would love advice or pull requests
on getting these steps automated away.</p>

<p>Finally, PyWinner also starts the tiny Python web service that will
let us give the Windows machine automated instructions from your
local machine.  (It does all of these steps through a PowerShell
“user data” script that Amazon EC2 instances run at startup.)</p></li>
<li><p><code>python -m pywinner.client</code>
is there mainly to let you experiment with the tiny RPC service that
PyWinner runs.  If you give it a command like <code>print(3+3)</code> then you
should see <code>6</code> come back, computed in the Python 3.4 runtime that is
ready to do your bidding on the Windows EC2 box.</p></li>
<li><p><code>python -m pywinner.build</code>
builds my PyEphem package for all Python versions 2.5 through 3.4 by
calling the little RPC service and telling it to run hand-crafted
<code>.BAT</code> scripts that, for each Python version, get the compilers
configured exactly the right way to do the compile.  It is the
script that probably needs the most work before it can serve as a
general tool for other projects.</p></li>
</ul>

<p>The result, for PyEphem, is a whole slew of Windows installers that are
now ready for people to use:</p>

<p><a href="https://pypi.python.org/pypi/ephem/">https://pypi.python.org/pypi/ephem/</a></p>

<p>The RPC service currently just runs <code>eval()</code> on the text it is given.
Now that I have had some experience with it, what it mostly needs to let
me do is create and run <code>.BAT</code> files, so I might simplify it later as a
real Python XML-RPC endpoint (since that is the only form of RPC
supported in the Standard Library, right?) that offers only one or two
functions, instead of being a general <code>eval()</code> as it is today.</p>

<p>Again, please feel welcome to open issues and pull requests to help me
see how this single-purpose get-PyEphem-compiled tool can be expanded
out to help you with your own projects.</p>
</article>
  </div></body></html>