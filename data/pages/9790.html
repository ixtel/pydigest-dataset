<html><body><div><div id="multipart-form-data-encoder">
<h3>multipart/form-data Encoder</h3>
<p>The main attraction is a streaming multipart form-data object, <tt>MultipartEncoder</tt>.
Its API looks like this:</p>
<pre><span class="kn">from</span> <span class="nn">requests_toolbelt</span> <span class="kn">import</span> <span class="n">MultipartEncoder</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">MultipartEncoder</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s1">'field0'</span><span class="p">:</span> <span class="s1">'value'</span><span class="p">,</span> <span class="s1">'field1'</span><span class="p">:</span> <span class="s1">'value'</span><span class="p">,</span>
            <span class="s1">'field2'</span><span class="p">:</span> <span class="p">(</span><span class="s1">'filename'</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'file.py'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">),</span> <span class="s1">'text/plain'</span><span class="p">)}</span>
    <span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">'http://httpbin.org/post'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">m</span><span class="p">,</span>
                  <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">content_type</span><span class="p">})</span>
</pre>
<p>You can also use <tt><span class="pre">multipart/form-data</span></tt> encoding for requests that don’t
require files:</p>
<pre><span class="kn">from</span> <span class="nn">requests_toolbelt</span> <span class="kn">import</span> <span class="n">MultipartEncoder</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">MultipartEncoder</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s1">'field0'</span><span class="p">:</span> <span class="s1">'value'</span><span class="p">,</span> <span class="s1">'field1'</span><span class="p">:</span> <span class="s1">'value'</span><span class="p">})</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">'http://httpbin.org/post'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">m</span><span class="p">,</span>
                  <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">content_type</span><span class="p">})</span>
</pre>
<p>Or, you can just create the string and examine the data:</p>
<pre><span class="c1"># Assuming `m` is one of the above</span>
<span class="n">m</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>  <span class="c1"># Always returns unicode</span>
</pre>
</div>
<div id="user-agent-constructor">
<h3>User-Agent constructor</h3>
<p>You can easily construct a requests-style <tt><span class="pre">User-Agent</span></tt> string:</p>
<pre>from requests_toolbelt import user_agent

headers = {
    'User-Agent': user_agent('my_package', '0.0.1')
    }

r = requests.get('https://api.github.com/users', headers=headers)
</pre>
</div>
<div id="ssladapter">
<h3>SSLAdapter</h3>
<p>The <tt>SSLAdapter</tt> was originally published on <a href="https://lukasa.co.uk/2013/01/Choosing_SSL_Version_In_Requests/" rel="nofollow">Cory Benfield’s blog</a>.
This adapter allows the user to choose one of the SSL protocols made available
in Python’s <tt>ssl</tt> module for outgoing HTTPS connections:</p>
<pre><span class="kn">from</span> <span class="nn">requests_toolbelt</span> <span class="kn">import</span> <span class="n">SSLAdapter</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">ssl</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">'https://'</span><span class="p">,</span> <span class="n">SSLAdapter</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">PROTOCOL_TLSv1</span><span class="p">))</span>
</pre>
</div>
<div id="cookies-forgetfulcookiejar">
<h3>cookies/ForgetfulCookieJar</h3>
<p>The <tt>ForgetfulCookieJar</tt> prevents a particular requests session from storing
cookies:</p>
<pre><span class="kn">from</span> <span class="nn">requests</span><span class="o">-</span><span class="n">toolbelt</span><span class="o">.</span><span class="n">cookies</span> <span class="kn">import</span> <span class="nn">ForgetfulCookieJar</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">cookies</span> <span class="o">=</span> <span class="n">ForgetfulCookieJar</span><span class="p">()</span>
</pre>
</div>
<div id="known-issues">
<h3>Known Issues</h3>
<p>On Python 3.3.0 and 3.3.1, the standard library’s <tt>http</tt> module will fail
when passing an instance of the <tt>MultipartEncoder</tt>. This is fixed in later
minor releases of Python 3.3. Please consider upgrading to a later minor
version or Python 3.4. <em>There is absolutely nothing this library can do to
work around that bug.</em></p>
</div>
</div></body></html>