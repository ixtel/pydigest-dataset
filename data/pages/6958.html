<html><body><div><div class="content article-content">
        <p>One alpha, five betas, and two release candidates after marshmallow's last 1.x release, marshmallow 2.0 is published to the PyPI.</p>
<h2>What is marshmallow?</h2>
<p>Marshmallow is a Python library for</p>
<ol>
<li>Validating input data against a schema,</li>
<li>Deserializing data to application objects (e.g. ORM objects), and</li>
<li>Serializing application objects to simple types.</li>
</ol>
<p>Think Django REST Framework's <a href="http://www.django-rest-framework.org/api-guide/serializers/">Serializers</a>, without the Django.</p>
<p>For more info, see the homepage: <a href="https://marshmallow.readthedocs.org/">https://marshmallow.readthedocs.org/</a></p>
<h2>Benefits of Upgrading</h2>
<p>Here are a few immediate benefits of upgrading to 2.0:</p>
<ul>
<li>Dump-only and load-only fields (analagous to "read-only" and "write-only" in the context of a CRUD app).</li>
<li>
<p>More consistent treatment of <a href="https://marshmallow.readthedocs.org/en/latest/upgrading.html#deserializing-none">null</a> and <a href="https://marshmallow.readthedocs.org/en/latest/upgrading.html#default-values">missing values</a>.</p>
</li>
<li>
<p>Powerful, user-friendly pre- and post-processing API.</p>
</li>
</ul>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">marshmallow</span> <span class="kn">import</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">pre_load</span><span class="p">,</span> <span class="n">post_dump</span><span class="p">,</span> <span class="n">post_load</span>

<span class="k">class</span> <span class="nc">UserSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">()</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Email</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_envelope_key</span><span class="p">(</span><span class="n">many</span><span class="p">):</span>
        <span class="sd">"""Helper to get the envelope key."""</span>
        <span class="k">return</span> <span class="s">'users'</span> <span class="k">if</span> <span class="n">many</span> <span class="k">else</span> <span class="s">'user'</span>

    <span class="nd">@pre_load</span><span class="p">(</span><span class="n">pass_many</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">unwrap_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">many</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_envelope_key</span><span class="p">(</span><span class="n">many</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="nd">@post_dump</span><span class="p">(</span><span class="n">pass_many</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrap_with_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">many</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_envelope_key</span><span class="p">(</span><span class="n">many</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span>

    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">make_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">User</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</pre></div>


<ul>
<li>More consistent default error messages and a better API for overriding error messages.</li>
</ul>
<div class="highlight"><pre><span class="n">errors</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">invalid_data</span><span class="p">)</span>
<span class="c"># {</span>
<span class="c">#     'str_field': ['Not a valid string.'],</span>
<span class="c">#     'bool_field': ['Not a valid boolean.'],</span>
<span class="c">#     'int_field': ['Not a valid integer.'],</span>
<span class="c">#     'decimal_field': ['Not a valid number.'],</span>
<span class="c">#     'float_field': ['Not a valid number.']</span>
<span class="c">#     'datetim_field': ['Not a valid datetime.'],</span>
<span class="c">#     'email_field': ['Not a valid email address.'],</span>
<span class="c">#     'url_field': ['Not a valid URL.'],</span>
<span class="c">#     'list_field': ['Not a valid list.'],</span>
<span class="c"># }</span>
</pre></div>


<ul>
<li>Better error bundling when validating multiple objects.</li>
<li>Improved <code>strict</code> mode.</li>
<li>Field and <a href="https://marshmallow.readthedocs.org/en/latest/extending.html#schema-level-validation">schema validators</a> can be written as methods.</li>
</ul>
<h2>Ecosystem</h2>
<p>A number of supporting libraries emerged since the last major release.</p>

<h2>What will happen to marshmallow 1?</h2>
<p>I will continue to merge bug fixes into the 1.2 release line. No new 1.x feature releases are planned. New libraries in the <a href="https://github.com/marshmallow-code">marshmallow-code</a> GitHub organization will likely support marshmallow&gt;=2.0 only.</p>
<h2>More</h2>
<p>Several refinements were made to the marshmallow API. For details, see the <a href="https://marshmallow.readthedocs.org/en/latest/changelog.html#changelog">changelog</a>. For a guide on upgrading from marshmallow 1, see the <a href="https://marshmallow.readthedocs.org/en/latest/upgrading.html#upgrading">upgrading guide</a>.</p>
<p>Special thanks to everyone who contributed and reported issues; you made this release awesome.</p>
      </div>
    </div></body></html>