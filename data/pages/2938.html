<html><body><div><div class="entry nobottom">
      
      <h3 class="entry-title">How can I protect my product?</h3>

      <img src="https://clickbank.zendesk.com/system/photos/5854/1642/megan_mann_colorsq_thumb.jpg" class="entry_user"/>

      <div class="entry-container">
        <p class="entry_user">
          Megan Mann<br/>
          posted this on August 23, 2013, 16:39
        </p>
      </div>

      <div class="user_formatted header_section clearfix">
        <p>An important part of being successful as a digital product vendor is taking precautions to protect your product and keep it from being improperly downloaded. In this guide, we have several steps you can take to keep your product secure.</p>
<h2>Thank You Page Protection</h2>
<p>To protect your Thank You Page, here are some suggestions:</p>
<ol>
<li>Inserting the following HTML code in the &lt;HEAD&gt; element of your Thank You Page should prevent a search engine robot from indexing that page or following links on that page:
<div>
<div id="highlighter_528635" class="syntaxhighlighter nogutter  xml">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="code">
<p class="container">&lt;META name="robots" content="noindex, nofollow"/&amp;gt</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</li>
<li>Give your Thank You Page URL an obscure file name (it should not be something like thankyou.htm, which is too easy to guess)</li>
<li>If you are concerned about security and you have experience with CGI programming, you can generate a script that will verify the customer’s successful completion of the purchase process before allowing him or her access to the Thank You Page. Please follow the instructions below for implementing the ClickBank Link Security Script.</li>
</ol>
<h2>ClickBank Link Security Script</h2>
<p>When the customer completes a purchase, several values are passed along to your thank you page in the query string if you have specified a secret key in your account settings. These are the ClickBank receipt number (cbreceipt), the epoch time of the order (time), the ClickBank item number (item), and the ClickBank proof of purchase (cbpop) value.</p>
<p>During the purchase we encrypt the receipt, time, and item using the secret key you specify in your account. We will then pass the result back to you as a query string parameter called cbpop. Use the validation script to confirm the cbpop value is correct.</p>
<p>Unlike prior versions of this script there is no need for a “seed” value.</p>
<p>The C#, VB.NET, and Ruby examples below are only a method for checking for a valid cbpop value and leave the capturing of the request parameters up to your individual implementations. These code samples do not apply to the <a href="https://support.clickbank.com/entries/22803622-Instant-Notification-Service" target="_blank">Instant Notification service.</a></p>
<hr/>
<p> </p>
<table border="0">
<tbody>
<tr>
<td><strong>PHP SOURCE:</strong>
<p> </p>
<div>
<div id="highlighter_299380" class="syntaxhighlighter nogutter  php">
<p class="p1">function cbValid(){</p>
<p class="p1">  $key='YOUR SECRET KEY';</p>
<p class="p1">  $rcpt=$_REQUEST['cbreceipt'];</p>
<p class="p1">  $time=$_REQUEST['time'];</p>
<p class="p1">  $item=$_REQUEST['item'];</p>
<p class="p1">  $cbpop=$_REQUEST['cbpop'];</p>
<p class="p2"> </p>
<p class="p1">  $xxpop=sha1("$key|$rcpt|$time|$item");</p>
<p class="p1">  $xxpop=strtoupper(substr($xxpop,0,8));</p>
<p class="p2"> </p>
<p class="p1">  if ($cbpop==$xxpop){</p>
<p class="p1">  return 1;</p>
<p class="p1">  }</p>
<p class="p1">  else {</p>
<p class="p1">  return 0;</p>
<p class="p1">  }</p>
<p class="p1">}</p>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr/>
<p> </p>
<table border="0">
<tbody>
<tr>
<td><strong>PERL SOURCE:</strong>
<p> </p>
<div>
<div id="highlighter_306122" class="syntaxhighlighter nogutter  perl">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="code">
<div class="container">
<pre>sub cbValid
{ my($q,$key,$rcpt,$time,$item,$cbpop,$xxpop) 
  $key='YOUR SECRET KEY' 

  $q='&amp;amp;'.$ENV{'QUERY_STRING'} 
  $q=~/Wcbreceipt=(w+)/; $rcpt=$1 
  $q=~/Wtime=(w+)/;      $time=$1 
  $q=~/Witem=(w+)/;      $item=$1 
  $q=~/Wcbpop=(w+)/;     $cbpop=$1 

  use Digest::SHA1 qw(sha1_hex) 
  $xxpop=uc(substr(sha1_hex("$key|$rcpt|$time|$item"),0,8)) 
  return 1 if $cbpop eq $xxpop 
  return 0 
}
</pre>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr/>
<p> </p>
<table border="0">
<tbody>
<tr>
<td><strong>C# SOURCE:</strong>
<p> </p>
<div>
<div id="highlighter_621721" class="syntaxhighlighter nogutter  csharp">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="code">
<div class="container">
<pre>public bool cbValid(string cbreceipt, string time, string item, string cbpop)
{
    string secret_key = "YOUR SECRET KEY" 

    byte[] data = Encoding.Default.GetBytes(secret_key + "|" + cbreceipt + "|" + time + "|" + item) 
    byte[] hashedData = new SHA1Managed().ComputeHash(data) 

    string xxpop = BitConverter.ToString(hashedData).Replace("-","").ToUpper().Substring(0, 8) 

    return cbpop.Equals(xxpop) 
}
</pre>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr/>
<p> </p>
<table border="0">
<tbody>
<tr>
<td><strong>VB.NET SOURCE:</strong>
<p> </p>
<div>
<div id="highlighter_914693" class="syntaxhighlighter nogutter  vb">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="code">
<div class="container">
<pre>Public Function cbValid(ByVal receipt As String, ByVal time As String, ByVal item AsString, ByVal cbpop As String) As Boolean
    Dim key As String = "YOUR SECRET KEY"
    Dim sha As New SHA1CryptoServiceProvider()
    Dim mash As String = key &amp;amp; "|" &amp;amp; receipt &amp;amp; "|" &amp;amp; time &amp;amp; "|" &amp;amp; item

    Dim result() As Byte = sha.ComputeHash(NewSystem.Text.ASCIIEncoding().GetBytes(mash))

    Dim xxpop As String = BitConverter.ToString(result).Replace("-","").ToUpper().Substring(0, 8)

    Return cbpop.Equals(xxpop)
End Function
</pre>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr/>
<p> </p>
<table border="0">
<tbody>
<tr>
<td><strong>Ruby SOURCE:</strong>
<p> </p>
<div>
<div id="highlighter_240391" class="syntaxhighlighter nogutter  ruby">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="code">
<div class="container">
<pre>require 'digest/sha1'

def cbValid(receipt, time, item, cbpop)
  key = "YOUR SECRET KEY"

  popCheck = "#{key}|#{receipt}|#{time}|#{item}"
  xxpop = Digest::SHA1.hexdigest(popCheck).upcase[0,8]

  cbpop == xxpop
end
</pre>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr/>
<p> </p>
<table border="0">
<tbody>
<tr>
<td><strong>Python SOURCE:</strong>
<p> </p>
<div>
<div id="highlighter_148972" class="syntaxhighlighter nogutter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="code">
<div class="container">
<pre>import hashlib

def valid_cb_pop(receipt, time, item, cbpop):
    secret_key = 'YOUR SECRET KEY'
    data = "%s|%s|%s|%s" % (secret_key, receipt, time, item)
    return cbpop == hashlib.sha1(data).hexdigest()[:8].upper()
</pre>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr/>
<p> </p>
<table border="0">
<tbody>
<tr>
<td><strong>Java SOURCE:</strong>
<p> </p>
<div>
<div id="highlighter_736361" class="syntaxhighlighter nogutter  java">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="code">
<div class="container">
<pre>import org.apache.commons.codec.digest.DigestUtils 

/**
* Note:  To make this method simple it uses the Apache Commons Codec library for computing the SHA value.
*        This library is available at: <a href="http://commons.apache.org/codec/">http://commons.apache.org/codec/</a>
**/

public class CBPopValidator {

     /**
     * Code to validate cbpop parameter passed from ClickBank orderform to thank-you page.
     *
     * @param receipt The receipt number that ClickBank generated and passed to thank-you page.
     * @param time The time (unix timestamp) of the purchase, also passed to thank-you page
     * @param item The item purchased, also passed to thank-you page
     * @param cbpop The passed validation parameter
     * @return True of passed cbpop matches the calculated cbpop using the passed parameters and secret key
     **/
    public static boolean validCbPop(final String receipt, final String time, final String item, final String cbpop) {
        // secret key on the site of your ClickBank account
        final String secretKey = "YOUR SECRET KEY" 

        // create sha1 of passed data with secret key
        String hashedData = DigestUtils.shaHex(String.format("%s|%s|%s|%s", secretKey, receipt, time, item)) 

        // compare hashed result to passed value
        return hashedData != null &amp;amp;&amp;amp; hashedData.substring(0,8).equalsIgnoreCase(cbpop) 
    }
}
</pre>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</td>
</tr>
</tbody>
</table>
      </div>
      

      
    </div>
  </div></body></html>