<html><body><div><div class="entry-content clearfix">







<p><strong>After a <a href="https://realpython.com/blog/python/python-ruby-and-golang-a-command-line-application-comparison/">recent comparison</a> of Python, Ruby, and Golang for a command-line application I decided to use the same pattern to compare building a simple web service. I have selected <a href="http://flask.pocoo.org/">Flask</a> (Python), <a href="http://www.sinatrarb.com/">Sinatra</a> (Ruby), and <a href="http://martini.codegangsta.io/">Martini</a> (Golang) for this comparison.</strong> Yes, there are many other options for web application libraries in each language but I felt these three lend well to comparison.</p>

<p><em>This is a guest blog post by <strong><a href="https://twitter.com/PurdonKyle">Kyle Purdon</a>â</strong>, a software engineer from Boulder.</em></p>

<a name="Library.Overviews"/>
<h2>Library Overviews</h2>

<p>Here is a high-level comparison of the libraries by <a href="http://stackshare.io/stackups/martini-vs-flask-vs-sinatra">Stackshare</a>.</p>

<a name="Flask..Python."/>
<h3>Flask (Python)</h3>

<blockquote><p>Flask is a micro-framework for Python based on Werkzeug, Jinja2 and good intentions.</p></blockquote>

<p>For very simple applications, such as the one shown in this demo, Flask is a great choice. The basic Flask application is only 7 lines of code (LOC) in a single Python source file. The draw of Flask over other Python web libraries (such as <a href="https://www.djangoproject.com/">Django</a> or <a href="http://www.pylonsproject.org/">Pyramid</a>) is that you can start small and build up to a more complex application as needed.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
</span><span class="line"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="nd">@app.route</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
</span><span class="line"><span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
</span><span class="line">    <span class="k">return</span> <span class="s">"Hello World!"</span>
</span><span class="line">
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
</span><span class="line">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Sinatra..Ruby."/>
<h3>Sinatra (Ruby)</h3>

<blockquote><p>Sinatra is a <a href="https://en.wikipedia.org/wiki/Domain-specific_language">DSL</a> for quickly creating web applications in Ruby with minimal effort.</p></blockquote>

<p>Just like Flask, Sinatra is great for simple applications. The basic Sinatra application is only 4 LOC in a single Ruby source file. Sinatra is used instead of libraries such as <a href="http://rubyonrails.org/">Ruby on Rails</a> for the same reason as Flask – you can start small and expand the application as needed.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="nb">require</span> <span class="s1">'sinatra'</span>
</span><span class="line">
</span><span class="line"><span class="n">get</span> <span class="s1">'/hi'</span> <span class="k">do</span>
</span><span class="line">  <span class="s2">"Hello World!"</span>
</span><span class="line"><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Martini..Golang."/>
<h3>Martini (Golang)</h3>

<blockquote><p>Martini is a powerful package for quickly writing modular web applications/services in Golang.</p></blockquote>

<p>Martini comes with a few more batteries included than both Sinatra and Flask but is still very lightweight to start with – only 9 LOC for the basic application. Martini has come under some <a href="https://stephensearles.com/three-reasons-you-should-not-use-martini/">criticism</a> by the Golang community but still has one of the highest rated Github projects of any Golang web framework. The author of Martini responded directly to the criticism <a href="http://codegangsta.io/blog/2014/05/19/my-thoughts-on-martini/">here</a>. Some other frameworks include <a href="https://revel.github.io/">Revel</a>, <a href="https://gin-gonic.github.io/gin/">Gin</a>, and even the built-in <a href="http://golang.org/pkg/net/http/">net/http</a> library.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="kn">package</span> <span class="nx">main</span>
</span><span class="line">
</span><span class="line"><span class="kn">import</span> <span class="s">"github.com/go-martini/martini"</span>
</span><span class="line">
</span><span class="line"><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">martini</span><span class="p">.</span><span class="nx">Classic</span><span class="p">()</span>
</span><span class="line">  <span class="nx">m</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="kd">func</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span>
</span><span class="line">    <span class="k">return</span> <span class="s">"Hello world!"</span>
</span><span class="line">  <span class="p">})</span>
</span><span class="line">  <span class="nx">m</span><span class="p">.</span><span class="nx">Run</span><span class="p">()</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>With the basics out of the way, let’s build an app!</p>

<a name="Service.Description"/>
<h2>Service Description</h2>

<p>The service created provides a very basic blog application. The following routes are constructed:</p>

<ul>
<li><code>GET /</code>: Return the blog (using a template to render).</li>
<li><code>GET /json</code>: Return the blog content in JSON format.</li>
<li><code>POST /new</code>: Add a new post (title, summary, content) to the blog.</li>
</ul>


<p>The external interface to the blog service is exactly the same for each language. For simplicity MongoDB will be used as the data store for this example as it is the simplest to set up and we don’t need to worry about schemas at all. In a normal “blog-like” application a relational database would likely be necessary.</p>

<a name="Add.A.Post"/>
<h3>Add A Post</h3>

<p><code>POST /new</code></p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">curl --form <span class="nv">title</span><span class="o">=</span><span class="s1">'Test Post 1'</span> <span class="se">\</span>
</span><span class="line">     --form <span class="nv">summary</span><span class="o">=</span><span class="s1">'The First Test Post'</span> <span class="se">\</span>
</span><span class="line">     --form <span class="nv">content</span><span class="o">=</span><span class="s1">'Lorem ipsum dolor sit amet, consectetur ...'</span> <span class="se">\</span>
</span><span class="line">     http://<span class="o">[</span>IP<span class="o">]</span>:<span class="o">[</span>PORT<span class="o">]</span>/new
</span></code></pre></td></tr></table></div></figure>


<a name="View.The.HTML"/>
<h3>View The HTML</h3>

<p><code>GET /</code></p>









<a name="View.The.JSON"/>
<h3>View The JSON</h3>

<p><code>GET /json</code></p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="p">[</span>
</span><span class="line">   <span class="p">{</span>
</span><span class="line">      <span class="nx">content</span><span class="o">:</span><span class="s2">"Lorem ipsum dolor sit amet, consectetur ..."</span><span class="p">,</span>
</span><span class="line">      <span class="nx">title</span><span class="o">:</span><span class="s2">"Test Post 1"</span><span class="p">,</span>
</span><span class="line">      <span class="nx">_id</span><span class="o">:</span><span class="p">{</span>
</span><span class="line">         <span class="nx">$oid</span><span class="o">:</span><span class="s2">"558329927315660001550970"</span>
</span><span class="line">      <span class="p">},</span>
</span><span class="line">      <span class="nx">summary</span><span class="o">:</span><span class="s2">"The First Test Post"</span>
</span><span class="line">   <span class="p">}</span>
</span><span class="line"><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Application.Structure"/>
<h2>Application Structure</h2>

<p>Each application can be broken down into the following components:</p>

<a name="Application.Setup"/>
<h3>Application Setup</h3>

<ul>
<li>Initialize an application</li>
<li>Run the application</li>
</ul>


<a name="Request"/>
<h3>Request</h3>

<ul>
<li>Define routes on which a user can request data (GET)</li>
<li>Define routes on which a user can submit data (POST)</li>
</ul>


<a name="Response"/>
<h3>Response</h3>

<ul>
<li>Render JSON (<code>GET /json</code>)</li>
<li>Render a template (<code>GET /</code>)</li>
</ul>


<a name="Database"/>
<h3>Database</h3>

<ul>
<li>Initialize a connection</li>
<li>Insert data</li>
<li>Retrieve data</li>
</ul>


<a name="Application.Deployment"/>
<h3>Application Deployment</h3>




<hr/>


<p><strong>The rest of this article will compare each of these components for each library.</strong> The purpose is not to suggest that one of these libraries is better than the other – it is to provide a specific comparison between the three tools:</p>




<a name="Project.Setup"/>
<h2>Project Setup</h2>

<p>All of the <a href="https://github.com/realpython/flask-sinatra-martini">projects</a> are bootstrapped using <a href="https://www.docker.com/">docker</a> and <a href="https://docs.docker.com/compose/">docker-compose</a>. Before diving into how each application is bootstrapped under the hood we can just use docker to get each up and running in exactly the same way – <code>docker-compose up</code></p>

<p>Seriously, that’s it! Now for each application there is a <code>Dockerfile</code> and a <code>docker-compose.yml</code> file that specify what happens when you run the above command.</p>

<a name="Python..flask..-..em.Dockerfile..em."/>
<h3>Python (flask) – <em>Dockerfile</em></h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">FROM</span> <span class="nx">python</span><span class="o">:</span><span class="mf">3.4</span>
</span><span class="line">
</span><span class="line"><span class="nx">ADD</span> <span class="p">.</span> <span class="o">/</span><span class="nx">app</span>
</span><span class="line"><span class="nx">WORKDIR</span> <span class="o">/</span><span class="nx">app</span>
</span><span class="line">
</span><span class="line"><span class="nx">RUN</span> <span class="nx">pip</span> <span class="nx">install</span> <span class="o">-</span><span class="nx">r</span> <span class="nx">requirements</span><span class="p">.</span><span class="nx">txt</span>
</span></code></pre></td></tr></table></div></figure>


<p>This <code>Dockerfile</code> says that we are starting from a base image with Python 3.4 installed, adding our application to the <code>/app</code> directory and using <a href="https://pypi.python.org/pypi/pip">pip</a> to install our application requirements specified in <code>requirements.txt</code>.</p>

<a name="Ruby..sinatra."/>
<h3>Ruby (sinatra)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">FROM</span> <span class="nx">ruby</span><span class="o">:</span><span class="mf">2.2</span>
</span><span class="line">
</span><span class="line"><span class="nx">ADD</span> <span class="p">.</span> <span class="o">/</span><span class="nx">app</span>
</span><span class="line"><span class="nx">WORKDIR</span> <span class="o">/</span><span class="nx">app</span>
</span><span class="line">
</span><span class="line"><span class="nx">RUN</span> <span class="nx">bundle</span> <span class="nx">install</span>
</span></code></pre></td></tr></table></div></figure>


<p>This <code>Dockerfile</code> says that we are starting from a base image with Ruby 2.2 installed, adding our application to the <code>/app</code> directory and using <a href="http://bundler.io/">bundler</a> to install our application requirements specified in the <code>Gemfile</code>.</p>

<a name="Golang..martini."/>
<h3>Golang (martini)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">FROM</span> <span class="nx">golang</span><span class="o">:</span><span class="mf">1.3</span>
</span><span class="line">
</span><span class="line"><span class="nx">ADD</span> <span class="p">.</span> <span class="o">/</span><span class="nx">go</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span><span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">kpurdon</span><span class="o">/</span><span class="nx">go</span><span class="o">-</span><span class="nx">blog</span>
</span><span class="line"><span class="nx">WORKDIR</span> <span class="o">/</span><span class="nx">go</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span><span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">kpurdon</span><span class="o">/</span><span class="nx">go</span><span class="o">-</span><span class="nx">blog</span>
</span><span class="line">
</span><span class="line"><span class="nx">RUN</span> <span class="nx">go</span> <span class="nx">get</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">go</span><span class="o">-</span><span class="nx">martini</span><span class="o">/</span><span class="nx">martini</span> <span class="o">&amp;&amp;</span> <span class="o">\</span>
</span><span class="line">    <span class="nx">go</span> <span class="nx">get</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">martini</span><span class="o">-</span><span class="nx">contrib</span><span class="o">/</span><span class="nx">render</span> <span class="o">&amp;&amp;</span> <span class="o">\</span>
</span><span class="line">    <span class="nx">go</span> <span class="nx">get</span> <span class="nx">gopkg</span><span class="p">.</span><span class="k">in</span><span class="err">/mgo.v2 &amp;&amp; \</span>
</span><span class="line">    <span class="nx">go</span> <span class="nx">get</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">martini</span><span class="o">-</span><span class="nx">contrib</span><span class="o">/</span><span class="nx">binding</span>
</span></code></pre></td></tr></table></div></figure>


<p>This <code>Dockerfile</code> says that we are starting from a base image with Golang 1.3 installed, adding our application to the <code>/go/src/github.com/kpurdon/go-blog</code> directory and getting all of our necessary dependencies using the <code>go get</code> command.</p>

<a name="Initialize.Run.An.Application"/>
<h2>Initialize/Run An Application</h2>

<a name="Python..Flask..-..em.app.py..em."/>
<h3>Python (Flask) – <em>app.py</em></h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># initialize application</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
</span><span class="line"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="c"># run application</span>
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
</span><span class="line">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'0.0.0.0'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class="code"><figcaption><span/></figcaption></figure>


<a name="Ruby..Sinatra..-..em.app.rb..em."/>
<h3>Ruby (Sinatra) – <em>app.rb</em></h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="c1"># initialize application</span>
</span><span class="line"><span class="nb">require</span> <span class="s1">'sinatra'</span>
</span></code></pre></td></tr></table></div></figure>




<figure class="code"><figcaption><span/></figcaption></figure>


<a name="Golang..Martini..-..em.app.go..em."/>
<h3>Golang (Martini) – <em>app.go</em></h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="c1">// initialize application</span>
</span><span class="line"><span class="kn">package</span> <span class="nx">main</span>
</span><span class="line"><span class="kn">import</span> <span class="s">"github.com/go-martini/martini"</span>
</span><span class="line"><span class="kn">import</span> <span class="s">"github.com/martini-contrib/render"</span>
</span><span class="line">
</span><span class="line"><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">    <span class="nx">app</span> <span class="o">:=</span> <span class="nx">martini</span><span class="p">.</span><span class="nx">Classic</span><span class="p">()</span>
</span><span class="line">    <span class="nx">app</span><span class="p">.</span><span class="nx">Use</span><span class="p">(</span><span class="nx">render</span><span class="p">.</span><span class="nx">Renderer</span><span class="p">())</span>
</span><span class="line">
</span><span class="line">    <span class="c1">// run application</span>
</span><span class="line">    <span class="nx">app</span><span class="p">.</span><span class="nx">Run</span><span class="p">()</span>
</span><span class="line">
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class="code"><figcaption><span/></figcaption></figure>


<a name="Define.A.Route..GET.POST."/>
<h2>Define A Route (GET/POST)</h2>

<a name="Python..Flask."/>
<h3>Python (Flask)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># get</span>
</span><span class="line"><span class="nd">@app.route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>  <span class="c"># the default is GET only</span>
</span><span class="line"><span class="k">def</span> <span class="nf">blog</span><span class="p">():</span>
</span><span class="line">    <span class="o">...</span>
</span><span class="line">
</span><span class="line"><span class="c">#post</span>
</span><span class="line"><span class="nd">@app.route</span><span class="p">(</span><span class="s">'/new'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'POST'</span><span class="p">])</span>
</span><span class="line"><span class="k">def</span> <span class="nf">new</span><span class="p">():</span>
</span><span class="line">    <span class="o">...</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Ruby..Sinatra."/>
<h3>Ruby (Sinatra)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="c1"># get</span>
</span><span class="line"><span class="n">get</span> <span class="s1">'/'</span> <span class="k">do</span>
</span><span class="line">  <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class="line"><span class="k">end</span>
</span><span class="line">
</span><span class="line"><span class="c1"># post</span>
</span><span class="line"><span class="n">post</span> <span class="s1">'/new'</span> <span class="k">do</span>
</span><span class="line">  <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class="line"><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Golang..Martini."/>
<h3>Golang (Martini)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="c1">// define data struct</span>
</span><span class="line"><span class="kd">type</span> <span class="nx">Post</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">Title</span>   <span class="kt">string</span> <span class="s">`form:"title" json:"title"`</span>
</span><span class="line">  <span class="nx">Summary</span> <span class="kt">string</span> <span class="s">`form:"summary" json:"summary"`</span>
</span><span class="line">  <span class="nx">Content</span> <span class="kt">string</span> <span class="s">`form:"content" json:"content"`</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// get</span>
</span><span class="line"><span class="nx">app</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">r</span> <span class="nx">render</span><span class="p">.</span><span class="nx">Render</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="o">...</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// post</span>
</span><span class="line"><span class="kn">import</span> <span class="s">"github.com/martini-contrib/binding"</span>
</span><span class="line"><span class="nx">app</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s">"/new"</span><span class="p">,</span> <span class="nx">binding</span><span class="p">.</span><span class="nx">Bind</span><span class="p">(</span><span class="nx">Post</span><span class="p">{}),</span> <span class="kd">func</span><span class="p">(</span><span class="nx">r</span> <span class="nx">render</span><span class="p">.</span><span class="nx">Render</span><span class="p">,</span> <span class="nx">post</span> <span class="nx">Post</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="o">...</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Render.A.JSON.Response"/>
<h2>Render A JSON Response</h2>

<a name="Python..Flask."/>
<h3>Python (Flask)</h3>

<p>Flask provides a <a href="http://flask.pocoo.org/docs/0.10/api/#flask.json.jsonify">jsonify()</a> method but since the service is using MongoDB the mongodb bson utility is used.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">bson.json_util</span> <span class="kn">import</span> <span class="n">dumps</span>
</span><span class="line"><span class="k">return</span> <span class="n">dumps</span><span class="p">(</span><span class="n">posts</span><span class="p">)</span> <span class="c"># posts is a list of dicts [{}, {}]</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Ruby..Sinatra."/>
<h3>Ruby (Sinatra)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="nb">require</span> <span class="s1">'json'</span>
</span><span class="line"><span class="n">content_type</span> <span class="ss">:json</span>
</span><span class="line"><span class="n">posts</span><span class="o">.</span><span class="n">to_json</span> <span class="c1"># posts is an array (from mongodb)</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Golang..Martini."/>
<h3>Golang (Martini)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="nx">r</span><span class="p">.</span><span class="nx">JSON</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="nx">posts</span><span class="p">)</span> <span class="c1">// posts is an array of Post{} structs</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Render.An.HTML.Response..Templating."/>
<h2>Render An HTML Response (Templating)</h2>

<a name="Python..Flask."/>
<h3>Python (Flask)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'blog.html'</span><span class="p">,</span> <span class="n">posts</span><span class="o">=</span><span class="n">posts</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="cp">&lt;!doctype HTML&gt;</span>
</span><span class="line"><span class="nt">&lt;html&gt;</span>
</span><span class="line">  <span class="nt">&lt;head&gt;</span>
</span><span class="line">    <span class="nt">&lt;title&gt;</span>Python Flask Example<span class="nt">&lt;/title&gt;</span>
</span><span class="line">  <span class="nt">&lt;/head&gt;</span>
</span><span class="line">  <span class="nt">&lt;body&gt;</span>
</span><span class="line">    {% for post in posts %}
</span><span class="line">      <span class="nt">&lt;h1&gt;</span> {{ post.title }} <span class="nt">&lt;/h1&gt;</span>
</span><span class="line">      <span class="nt">&lt;h3&gt;</span> {{ post.summary }} <span class="nt">&lt;/h3&gt;</span>
</span><span class="line">      <span class="nt">&lt;p&gt;</span> {{ post.content }} <span class="nt">&lt;/p&gt;</span>
</span><span class="line">      <span class="nt">&lt;hr&gt;</span>
</span><span class="line">    {% endfor %}
</span><span class="line">  <span class="nt">&lt;/body&gt;</span>
</span><span class="line"><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Ruby..Sinatra."/>
<h3>Ruby (Sinatra)</h3>

<figure class="code"><figcaption><span/></figcaption></figure>




<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="cp">&lt;!doctype HTML&gt;</span>
</span><span class="line"><span class="nt">&lt;html&gt;</span>
</span><span class="line">  <span class="nt">&lt;head&gt;</span>
</span><span class="line">    <span class="nt">&lt;title&gt;</span>Ruby Sinatra Example<span class="nt">&lt;/title&gt;</span>
</span><span class="line">  <span class="nt">&lt;/head&gt;</span>
</span><span class="line">  <span class="nt">&lt;body&gt;</span>
</span><span class="line">    <span class="err">&lt;</span>% @posts.each do |post| %&gt;
</span><span class="line">      <span class="nt">&lt;h1&gt;</span><span class="err">&lt;</span>%= post['title'] %&gt;<span class="nt">&lt;/h1&gt;</span>
</span><span class="line">      <span class="nt">&lt;h3&gt;</span><span class="err">&lt;</span>%= post['summary'] %&gt;<span class="nt">&lt;/h3&gt;</span>
</span><span class="line">      <span class="nt">&lt;p&gt;</span><span class="err">&lt;</span>%= post['content'] %&gt;<span class="nt">&lt;/p&gt;</span>
</span><span class="line">      <span class="nt">&lt;hr&gt;</span>
</span><span class="line">    <span class="err">&lt;</span>% end %&gt;
</span><span class="line">  <span class="nt">&lt;/body&gt;</span>
</span><span class="line"><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Golang..Martini."/>
<h3>Golang (Martini)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="nx">r</span><span class="p">.</span><span class="nx">HTML</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s">"blog"</span><span class="p">,</span> <span class="nx">posts</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="cp">&lt;!doctype HTML&gt;</span>
</span><span class="line"><span class="nt">&lt;html&gt;</span>
</span><span class="line">  <span class="nt">&lt;head&gt;</span>
</span><span class="line">    <span class="nt">&lt;title&gt;</span>Golang Martini Example<span class="nt">&lt;/title&gt;</span>
</span><span class="line">  <span class="nt">&lt;/head&gt;</span>
</span><span class="line">  <span class="nt">&lt;body&gt;</span>
</span><span class="line">    {{range . }}
</span><span class="line">      <span class="nt">&lt;h1&gt;</span>{{.Title}}<span class="nt">&lt;/h1&gt;</span>
</span><span class="line">      <span class="nt">&lt;h3&gt;</span>{{.Summary}}<span class="nt">&lt;/h3&gt;</span>
</span><span class="line">      <span class="nt">&lt;p&gt;</span>{{.Content}}<span class="nt">&lt;/p&gt;</span>
</span><span class="line">      <span class="nt">&lt;hr&gt;</span>
</span><span class="line">    {{ end }}
</span><span class="line">  <span class="nt">&lt;/body&gt;</span>
</span><span class="line"><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Database.Connection"/>
<h2>Database Connection</h2>

<p>All of the applications are using the mongodb driver specific to the language. The environment variable <code>DB_PORT_27017_TCP_ADDR</code> is the IP of a linked docker container (the database ip).</p>

<a name="Python..Flask."/>
<h3>Python (Flask)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>
</span><span class="line"><span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'DB_PORT_27017_TCP_ADDR'</span><span class="p">],</span> <span class="mi">27017</span><span class="p">)</span>
</span><span class="line"><span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">blog</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Ruby..Sinatra."/>
<h3>Ruby (Sinatra)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="nb">require</span> <span class="s1">'mongo'</span>
</span><span class="line"><span class="n">db_ip</span> <span class="o">=</span> <span class="o">[</span><span class="no">ENV</span><span class="o">[</span><span class="s1">'DB_PORT_27017_TCP_ADDR'</span><span class="o">]]</span>
</span><span class="line"><span class="n">client</span> <span class="o">=</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Client</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">db_ip</span><span class="p">,</span> <span class="ss">database</span><span class="p">:</span> <span class="s1">'blog'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Golang..Martini."/>
<h3>Golang (Martini)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="kn">import</span> <span class="s">"gopkg.in/mgo.v2"</span>
</span><span class="line"><span class="nx">session</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">mgo</span><span class="p">.</span><span class="nx">Dial</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Getenv</span><span class="p">(</span><span class="s">"DB_PORT_27017_TCP_ADDR"</span><span class="p">))</span>
</span><span class="line"><span class="nx">db</span> <span class="o">:=</span> <span class="nx">session</span><span class="p">.</span><span class="nx">DB</span><span class="p">(</span><span class="s">"blog"</span><span class="p">)</span>
</span><span class="line"><span class="k">defer</span> <span class="nx">session</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Insert.Data.From.a.POST"/>
<h2>Insert Data From a POST</h2>

<a name="Python..Flask."/>
<h3>Python (Flask)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>
</span><span class="line"><span class="n">post</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">'title'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span>
</span><span class="line">    <span class="s">'summary'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">'summary'</span><span class="p">],</span>
</span><span class="line">    <span class="s">'content'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">'content'</span><span class="p">]</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="n">db</span><span class="o">.</span><span class="n">blog</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Ruby..Sinatra."/>
<h3>Ruby (Sinatra)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">client</span><span class="o">[</span><span class="ss">:posts</span><span class="o">].</span><span class="n">insert_one</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="c1"># params is a hash generated by sinatra</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Golang..Martini."/>
<h3>Golang (Martini)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="nx">db</span><span class="p">.</span><span class="nx">C</span><span class="p">(</span><span class="s">"posts"</span><span class="p">).</span><span class="nx">Insert</span><span class="p">(</span><span class="nx">post</span><span class="p">)</span> <span class="c1">// post is an instance of the Post{} struct</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Retrieve.Data"/>
<h2>Retrieve Data</h2>

<a name="Python..Flask."/>
<h3>Python (Flask)</h3>

<figure class="code"><figcaption><span/></figcaption></figure>


<a name="Ruby..Sinatra."/>
<h3>Ruby (Sinatra)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="vi">@posts</span> <span class="o">=</span> <span class="n">client</span><span class="o">[</span><span class="ss">:posts</span><span class="o">].</span><span class="n">find</span><span class="o">.</span><span class="n">to_a</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Golang..Martini."/>
<h3>Golang (Martini)</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="kd">var</span> <span class="nx">posts</span> <span class="p">[]</span><span class="nx">Post</span>
</span><span class="line"><span class="nx">db</span><span class="p">.</span><span class="nx">C</span><span class="p">(</span><span class="s">"posts"</span><span class="p">).</span><span class="nx">Find</span><span class="p">(</span><span class="kc">nil</span><span class="p">).</span><span class="nx">All</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">posts</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Application.Deployment..docker.."/>
<h2>Application Deployment (docker!)</h2>

<p>A great solution to deploying all of these applications is to use <a href="https://www.docker.com/">docker</a> and <a href="https://docs.docker.com/compose/">docker-compose</a>.</p>

<a name="Python..Flask."/>
<h3>Python (Flask)</h3>

<p><strong>Dockerfile</strong></p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="go"><span class="line"><span class="nx">FROM</span> <span class="nx">python</span><span class="p">:</span><span class="mf">3.4</span>
</span><span class="line">
</span><span class="line"><span class="nx">ADD</span> <span class="p">.</span> <span class="o">/</span><span class="nx">app</span>
</span><span class="line"><span class="nx">WORKDIR</span> <span class="o">/</span><span class="nx">app</span>
</span><span class="line">
</span><span class="line"><span class="nx">RUN</span> <span class="nx">pip</span> <span class="nx">install</span> <span class="o">-</span><span class="nx">r</span> <span class="nx">requirements</span><span class="p">.</span><span class="nx">txt</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>docker-compose.yml</strong></p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="l-Scalar-Plain">web</span><span class="p-Indicator">:</span>
</span><span class="line">  <span class="l-Scalar-Plain">build</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">.</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">python -u app.py</span>
</span><span class="line">  <span class="l-Scalar-Plain">ports</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="s">"5000:5000"</span>
</span><span class="line">  <span class="l-Scalar-Plain">volumes</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">.:/app</span>
</span><span class="line">  <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">db</span>
</span><span class="line"><span class="l-Scalar-Plain">db</span><span class="p-Indicator">:</span>
</span><span class="line">  <span class="l-Scalar-Plain">image</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mongo:3.0.4</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mongod --quiet --logpath=/dev/null</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Ruby..Sinatra."/>
<h3>Ruby (Sinatra)</h3>

<p><strong>Dockerfile</strong></p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="l-Scalar-Plain">FROM ruby:2.2</span>
</span><span class="line">
</span><span class="line"><span class="l-Scalar-Plain">ADD . /app</span>
</span><span class="line"><span class="l-Scalar-Plain">WORKDIR /app</span>
</span><span class="line">
</span><span class="line"><span class="l-Scalar-Plain">RUN bundle install</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>docker-compose.yml</strong></p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="l-Scalar-Plain">web</span><span class="p-Indicator">:</span>
</span><span class="line">  <span class="l-Scalar-Plain">build</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">.</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">bundle exec ruby app.rb</span>
</span><span class="line">  <span class="l-Scalar-Plain">ports</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="s">"4567:4567"</span>
</span><span class="line">  <span class="l-Scalar-Plain">volumes</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">.:/app</span>
</span><span class="line">  <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">db</span>
</span><span class="line"><span class="l-Scalar-Plain">db</span><span class="p-Indicator">:</span>
</span><span class="line">  <span class="l-Scalar-Plain">image</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mongo:3.0.4</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mongod --quiet --logpath=/dev/null</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Golang..Martini."/>
<h3>Golang (Martini)</h3>

<p><strong>Dockerfile</strong></p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="l-Scalar-Plain">FROM golang:1.3</span>
</span><span class="line">
</span><span class="line"><span class="l-Scalar-Plain">ADD . /go/src/github.com/kpurdon/go-todo</span>
</span><span class="line"><span class="l-Scalar-Plain">WORKDIR /go/src/github.com/kpurdon/go-todo</span>
</span><span class="line">
</span><span class="line"><span class="l-Scalar-Plain">RUN go get github.com/go-martini/martini &amp;&amp; go get github.com/martini-contrib/render &amp;&amp; go get gopkg.in/mgo.v2 &amp;&amp; go get github.com/martini-contrib/binding</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>docker-compose.yml</strong></p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="l-Scalar-Plain">web</span><span class="p-Indicator">:</span>
</span><span class="line">  <span class="l-Scalar-Plain">build</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">.</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">go run app.go</span>
</span><span class="line">  <span class="l-Scalar-Plain">ports</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="s">"3000:3000"</span>
</span><span class="line">  <span class="l-Scalar-Plain">volumes</span><span class="p-Indicator">:</span> <span class="c1"># look into volumes v. "ADD"</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">.:/go/src/github.com/kpurdon/go-todo</span>
</span><span class="line">  <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">db</span>
</span><span class="line"><span class="l-Scalar-Plain">db</span><span class="p-Indicator">:</span>
</span><span class="line">  <span class="l-Scalar-Plain">image</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mongo:3.0.4</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mongod --quiet --logpath=/dev/null</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Conclusion"/>
<h2>Conclusion</h2>

<p>To conclude lets take a look at what I believe are a few categories where the presented libraries separate themselves from each other.</p>

<a name="Simplicity"/>
<h3>Simplicity</h3>

<p>While Flask is very lightweight and reads clearly, the Sinatra app is the simplest of the three at 23 LOC (compared to 46 for Flask and 42 for Martini). For these reasons Sinatra is the winner in this category. It should be noted however that Sinatra’s simplicity is due to more default “magic” – e.g., implicit work that happens behind the scenes. For new users this can often lead to confusion.</p>

<p>Here is a specific example of “magic” in Sinatra:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">params</span> <span class="c1"># the "request.form" logic in python is done "magically" behind the scenes in Sinatra.</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the equivalent Flask code:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>
</span><span class="line"><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">'title'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span>
</span><span class="line">    <span class="s">'summary'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">'summary'</span><span class="p">],</span>
</span><span class="line">    <span class="s">'content'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">'content'</span><span class="p">]</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>For beginners to programming Flask and Sinatra are certainly simpler, but for an experienced programmer with time spent in other statically typed languages Martini does provide a fairly simplistic interface.</p>

<a name="Documentation"/>
<h3>Documentation</h3>

<p>The Flask documentation was the simplest to search and most approachable. While Sinatra and Martini are both well documented, the documentation itself was not as approachable. For this reason Flask is the winner in this category.</p>

<a name="Community"/>
<h3>Community</h3>

<p>Flask is the winner hands down in this category. The Ruby community is more often than not dogmatic about Rails being the only good choice if you need anything more than a basic service (even though <a href="http://www.padrinorb.com/">Padrino</a> offers this on top of Sinatra). The Golang community is still nowhere near a consensus on one (or even a few) web frameworks, which is to be expected as the language itself is so young. Python however has embraced a number of approaches to web development including Django for out-of-the-box full-featured web applications and Flask, Bottle, CheryPy, and Tornado for a micro-framework approach.</p>

<a name="Final.Determination"/>
<h2>Final Determination</h2>

<p>Note that the point of this article was not to promote a single tool, rather to provide an unbiased comparison of Flask, Sinatra, and Martini. With that said, I would select Flask (Python) or Sinatra (Ruby). If you are coming from a language like C or Java perhaps the statically-typed nature of Golang may appeal to you. If you are a beginner, Flask might be the best choice as it is very easy to get up and running and there is very little default “magic”. My recommendation is that you be flexible in your decisions when selecting a library for your project.</p>

<hr/>


<p>Questions? Feedback? Please comment below. Thank you!</p>

<p><em>Also, let us know if you’d be interested in seeing some benchmarks.</em></p>
</div>


      </div></body></html>