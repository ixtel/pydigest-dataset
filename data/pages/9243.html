<html><body><div><div class="entry-content entry-content-single">
				<p><strong>The following post was originally published in the <a href="http://blog.ibis-project.org/">Ibis project blog</a>. (Ibis is a data analysis framework incubating in Cloudera Labs that brings Apache Hadoop scale to Python development.)</strong></p>
<p>The new <a href="http://getkudu.io/">Apache Kudu (incubating)</a> columnar storage engine together with <a href="http://impala.io/">Apache Impala (incubating)</a> interactive SQL engine enable a new fully open source big data architecture for data that is arriving and changing very quickly. By integrating Kudu and Impala with <a href="http://www.ibis-project.org/">Ibis</a>, this functionality is now available to Python programmers with an easy-to-use pandas-like API.</p>
<p>I spent this last week expanding the Kudu Python client (a Cython wrapper for the C++ client API) and adding initial integration with Ibis. While my <a href="http://gerrit.cloudera.org:8080/#/c/1593/">Kudu patch</a> is still in code review, I will give you a preview here of how it all works.</p>
<p>Since Kudu, a native C++ storage engine, now builds on OS X, I’m writing this blog using the Kudu client on OS X, so now is a great time for developers on both OS X and Linux to get involved with developing Python tools for Kudu.</p>
<p>Using Impala on OS X is in the works, see the <a href="https://issues.cloudera.org/browse/IMPALA-2761">issue tracker</a> for more. As soon as we can, we’ll provide a combined Kudu/Impala DMG installer for installing the environment locally on Mac computers.</p>
<p>Read on for more about Kudu and a full stack demo.</p>
<h2>Kudu Overview</h2>
<p>Kudu was designed for the Apache Hadoop ecosystem in part to simplify architectures involving very fast-arriving and fast-changing data that needs to be immediately available for analytical queries. In the past, complex architectures were devised using the fast <a href="https://parquet.apache.org/">Apache Parquet</a> columnar format stored in HDFS in conjunction with <a href="https://hbase.apache.org/">Apache HBase</a> (for new data, but very slow for analytics), but there were numerous drawbacks that made a purpose-built column-oriented storage engine desirable. For example, while Parquet is extremely fast for analytics, data can only be appended to a dataset and not deleted or updated.</p>
<p>You can read much more about Kudu in Todd Lipcon’s <a href="http://www.slideshare.net/cloudera/kudu-new-hadoop-storage-for-fast-analytics-on-fast-data">recent slide deck</a> and in an <a href="http://getkudu.io/overview.html">website overview</a>.</p>
<p><a href="http://www.zoomdata.com">Zoomdata</a> put together a <a href="https://www.youtube.com/watch?v=ck_kRb6qLKE">cool demo</a> showing a real time analytics dashboard powered by Impala and Kudu.</p>
<p>For Python users, here are the key details:</p>
<ul>
<li>Kudu has a SQL-like tabular data model; table columns are typed, and columns can be added and remove from tables. A Kudu cluster can store any number of tables.</li>
<li>Tables must have one or more <em>primary keys</em>. Like SQL databases, these will impact the performance of retrieving individual records.</li>
<li>Data is stored column-oriented, and individual table columns can be read (or<em>scanned</em>) very fast.</li>
<li>You can mutate a table by adding, deleting, or updating rows.</li>
<li>Data can be selected by indicating a number of conditions or <em>predicates</em> that must hold true</li>
<li>Kudu does not perform analytics: its job is to manage tabular data and serve it to compute engines as fast as possible.</li>
</ul>
<p>Kudu is not coupled to any particular compute engine. Any system that can use its C++ or Java clients can use it. There are a few compute system integrations built or in progress:</p>

<h2>Basic Kudu Use in Python</h2>
<p>Let’s take our first steps in Python. I’ve booted up the Kudu QuickStart VM (for VirtualBox) that you can download from the Kudu website. I’ve installed the Kudu Python client and now import it and connect to the Kudu master in the VM:</p>

		<div id="crayon-56d5c7f7f38cb831899740" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f38cb831899740-1"><span class="crayon-st">In</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-e">import </span><span class="crayon-e">kudu</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38cb831899740-2"><span class="crayon-e">        </span><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-s">'quickstart.cloudera'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7051</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Since this is a brand new cluster, there are no tables created yet:</p>

		<div id="crayon-56d5c7f7f38e3920553355" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f38e3920553355-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">list_tables</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38e3920553355-2"> </p><p class="crayon-line" id="crayon-56d5c7f7f38e3920553355-3"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>To create one, we first create a schema and then create the table:</p>

		<div id="crayon-56d5c7f7f38ee310535193" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-2">2</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-4">4</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-6">6</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-8">8</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-10">10</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-12">12</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-14">14</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-16">16</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-18">18</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-20">20</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f38ee310535193-22">22</p><p class="crayon-num" data-line="crayon-56d5c7f7f38ee310535193-23">23</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">builder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-e">schema_builder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-2"><span class="crayon-h">        </span><span class="crayon-v">builder</span><span class="crayon-sy">.</span><span class="crayon-e">add_column</span><span class="crayon-sy">(</span><span class="crayon-s">'id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-v">int64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-3"><span class="crayon-h">        </span><span class="crayon-v">builder</span><span class="crayon-sy">.</span><span class="crayon-e">add_column</span><span class="crayon-sy">(</span><span class="crayon-s">'item'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-t">string</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-4"><span class="crayon-h">        </span><span class="crayon-v">builder</span><span class="crayon-sy">.</span><span class="crayon-e">add_column</span><span class="crayon-sy">(</span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-t">double</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-6"><span class="crayon-h">        </span><span class="crayon-v">builder</span><span class="crayon-sy">.</span><span class="crayon-e">set_primary_keys</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-8"><span class="crayon-h">        </span><span class="crayon-v">schema</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">builder</span><span class="crayon-sy">.</span><span class="crayon-e">build</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-9"><span class="crayon-h">        </span><span class="crayon-e">schema </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-10"> </p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-11"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-i">Schema</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-12"><span class="crayon-h">         </span><span class="crayon-e">id     </span><span class="crayon-e">int64</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">PRIMARY </span><span class="crayon-e">KEY   </span></p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-13"><span class="crayon-e">         </span><span class="crayon-e">item   </span><span class="crayon-t">string</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h">   </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-14"><span class="crayon-h">         </span><span class="crayon-e">price  </span><span class="crayon-t">double</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-15"><span class="crayon-h">        </span><span class="crayon-sy">}</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-16"> </p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-17"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">table_exists</span><span class="crayon-sy">(</span><span class="crayon-s">'purchases'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-18"><span class="crayon-h">        </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">delete_table</span><span class="crayon-sy">(</span><span class="crayon-s">'purchases'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-19"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-20"><span class="crayon-h">        </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">create_table</span><span class="crayon-sy">(</span><span class="crayon-s">'purchases'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">schema</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-21"><span class="crayon-h">        </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">list_tables</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38ee310535193-22"> </p><p class="crayon-line" id="crayon-56d5c7f7f38ee310535193-23"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'purchases'</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now, we can get a handle for this new table and see its schema:</p>

		<div id="crayon-56d5c7f7f38f9092334938" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f38f9092334938-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">purchases</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">table</span><span class="crayon-sy">(</span><span class="crayon-s">'purchases'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38f9092334938-2"><span class="crayon-h">        </span><span class="crayon-e">purchases </span></p><p class="crayon-line" id="crayon-56d5c7f7f38f9092334938-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38f9092334938-4"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">Table </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">0x1037fc8f0</span><span class="crayon-o">&gt;</span></p><p class="crayon-line" id="crayon-56d5c7f7f38f9092334938-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38f9092334938-6"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">purchases</span><span class="crayon-sy">.</span><span class="crayon-e">schema </span></p><p class="crayon-line" id="crayon-56d5c7f7f38f9092334938-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38f9092334938-8"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-i">Schema</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">     </span></p><p class="crayon-line" id="crayon-56d5c7f7f38f9092334938-9"><span class="crayon-h">         </span><span class="crayon-e">id     </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">PRIMARY </span><span class="crayon-e">KEY   </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38f9092334938-10"><span class="crayon-e">         </span><span class="crayon-e">item   </span><span class="crayon-t">string</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h">   </span></p><p class="crayon-line" id="crayon-56d5c7f7f38f9092334938-11"><span class="crayon-h">         </span><span class="crayon-e">price  </span><span class="crayon-t">double</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f38f9092334938-12"><span class="crayon-h">        </span><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now, let’s insert some data:</p>

		<div id="crayon-56d5c7f7f390b808705283" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f390b808705283-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f390b808705283-2"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.49</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line" id="crayon-56d5c7f7f390b808705283-3"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.25</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f390b808705283-4"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.35</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line" id="crayon-56d5c7f7f390b808705283-5"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.00</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f390b808705283-6"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.49</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line" id="crayon-56d5c7f7f390b808705283-7"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.75</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f390b808705283-8"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.75</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line" id="crayon-56d5c7f7f390b808705283-9"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.95</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f390b808705283-10"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.00</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">    </span></p><p class="crayon-line" id="crayon-56d5c7f7f390b808705283-11"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.25</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f390b808705283-12"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">11</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.00</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">     </span></p><p class="crayon-line" id="crayon-56d5c7f7f390b808705283-13"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.35</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f390b808705283-14"><span class="crayon-h">         </span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>To add, change, or remove data from a table, you must create a <em>session</em> to group the operations:</p>

		<div id="crayon-56d5c7f7f3916872579186" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f3916872579186-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">session</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">new_session</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now, you create insert operations and add them to the session and call its flush method:</p>

		<div id="crayon-56d5c7f7f391f300877000" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f391f300877000-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">9</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">_id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_item</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">_price </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-o">:</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f391f300877000-2"><span class="crayon-h">            </span><span class="crayon-v">op</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">purchases</span><span class="crayon-sy">.</span><span class="crayon-e">new_insert</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">     </span></p><p class="crayon-line" id="crayon-56d5c7f7f391f300877000-3"><span class="crayon-h">            </span><span class="crayon-v">op</span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">_id     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f391f300877000-4"><span class="crayon-e">            </span><span class="crayon-v">op</span><span class="crayon-sy">[</span><span class="crayon-s">'item'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">_item     </span></p><p class="crayon-line" id="crayon-56d5c7f7f391f300877000-5"><span class="crayon-e">            </span><span class="crayon-v">op</span><span class="crayon-sy">[</span><span class="crayon-s">'price'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">_price     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f391f300877000-6"><span class="crayon-e">            </span><span class="crayon-v">session</span><span class="crayon-sy">.</span><span class="crayon-e">apply</span><span class="crayon-sy">(</span><span class="crayon-v">op</span><span class="crayon-sy">)</span><span class="crayon-h">      </span></p><p class="crayon-line" id="crayon-56d5c7f7f391f300877000-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f391f300877000-8"><span class="crayon-h">         </span><span class="crayon-v">session</span><span class="crayon-sy">.</span><span class="crayon-e">flush</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now, suppose we wanted to select some data from the table. To do this, we create a <em>scanner</em> for the table in question:</p>

		<div id="crayon-56d5c7f7f392a960092863" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f392a960092863-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">scanner</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">purchases</span><span class="crayon-sy">.</span><span class="crayon-e">scanner</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>To read all of the data out, you <em>open</em> the scanner and call one of its read methods:</p>

		<div id="crayon-56d5c7f7f3933458768936" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f3933458768936-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">11</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3933458768936-2"><span class="crayon-h">         </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">read_all_tuples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3933458768936-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3933458768936-4"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">11</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.49</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c7f7f3933458768936-5"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.25</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3933458768936-6"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.35</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c7f7f3933458768936-7"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3933458768936-8"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.49</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c7f7f3933458768936-9"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.75</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3933458768936-10"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.75</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c7f7f3933458768936-11"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.95</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3933458768936-12"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c7f7f3933458768936-13"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.25</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3933458768936-14"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">11</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c7f7f3933458768936-15"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.35</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>To only read a particular subset of data, you add <em>predicates</em> to the scanner:</p>

		<div id="crayon-56d5c7f7f393d589979626" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-2">2</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-4">4</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-6">6</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-8">8</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-10">10</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-12">12</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-14">14</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-16">16</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-18">18</p><p class="crayon-num" data-line="crayon-56d5c7f7f393d589979626-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f393d589979626-20">20</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">12</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">scanner</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">purchases</span><span class="crayon-sy">.</span><span class="crayon-e">scanner</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-2"><span class="crayon-h">          </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">add_predicate</span><span class="crayon-sy">(</span><span class="crayon-v">purchases</span><span class="crayon-sy">[</span><span class="crayon-s">'item'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-3"><span class="crayon-h">          </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-4"><span class="crayon-h">          </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">read_all_tuples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-6"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">12</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.49</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-7"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-8"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.0</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-10"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">13</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">scanner</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">purchases</span><span class="crayon-sy">.</span><span class="crayon-e">scanner</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">id_col</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">purchases</span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-11"><span class="crayon-h">         </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">add_predicates</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">id_col</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">id_col</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-12"><span class="crayon-h">         </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-13"><span class="crayon-h">         </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">read_all_tuples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-14"> </p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-15"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">13</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.49</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-16"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.75</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-17"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.75</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-18"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coffee'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.95</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c7f7f393d589979626-19"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">  </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f393d589979626-20"><span class="crayon-h">          </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'eggs'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.25</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>That’s all we need to know for now. There’s lots more to know about Kudu and things that can be added to the Python interface, such as:</p>
<ul>
<li>Native pandas DataFrame read/write capability</li>
<li>Hash and range partition configuration</li>
</ul>
<h2>Querying Existing Kudu Tables with Ibis and Impala</h2>
<p>In the latest development version of Ibis, you can add Kudu to the mix when working with Impala. Let’s take a look:</p>

		<div id="crayon-56d5c7f7f3948091440032" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f3948091440032-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">14</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-e">import </span><span class="crayon-e">ibis </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3948091440032-2"><span class="crayon-e">          </span><span class="crayon-v">ibis</span><span class="crayon-sy">.</span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-v">interactive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3948091440032-3"><span class="crayon-h">          </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3948091440032-4"><span class="crayon-h">          </span><span class="crayon-v">host</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'quickstart.cloudera'</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3948091440032-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3948091440032-6"><span class="crayon-h">          </span><span class="crayon-v">hdfs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ibis</span><span class="crayon-sy">.</span><span class="crayon-e">hdfs_connect</span><span class="crayon-sy">(</span><span class="crayon-v">host</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">port</span><span class="crayon-o">=</span><span class="crayon-cn">50070</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3948091440032-7"><span class="crayon-h">          </span><span class="crayon-v">ic</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ibis</span><span class="crayon-sy">.</span><span class="crayon-v">impala</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-v">host</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">port</span><span class="crayon-o">=</span><span class="crayon-cn">21050</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">hdfs_client</span><span class="crayon-o">=</span><span class="crayon-v">hdfs</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>This Impala cluster is built with Kudu support, so I can connect my Ibis client to the Kudu master like so:</p>

		<div id="crayon-56d5c7f7f3959011191163" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f3959011191163-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-v">host</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7051</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now, let’s see about that data we just wrote:</p>

		<div id="crayon-56d5c7f7f3963914511050" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f3963914511050-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-e">list_tables</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3963914511050-2"> </p><p class="crayon-line" id="crayon-56d5c7f7f3963914511050-3"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-sy">[</span><span class="crayon-s">'purchases'</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The table method on ic.kudu automatically creates an Impala table whose metadata references the existing data in Kudu:</p>

		<div id="crayon-56d5c7f7f396c481291563" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f396c481291563-2">2</p><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f396c481291563-4">4</p><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f396c481291563-6">6</p><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f396c481291563-8">8</p><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f396c481291563-10">10</p><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f396c481291563-12">12</p><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f396c481291563-14">14</p><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f396c481291563-16">16</p><p class="crayon-num" data-line="crayon-56d5c7f7f396c481291563-17">17</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">17</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">purchases</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-e">table</span><span class="crayon-sy">(</span><span class="crayon-s">'purchases'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f396c481291563-2"> </p><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-3"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">18</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-e">purchases </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f396c481291563-4"> </p><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-5"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">18</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">      </span><span class="crayon-e">id    </span><span class="crayon-e">item  </span><span class="crayon-i">price</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f396c481291563-6"><span class="crayon-h">          </span><span class="crayon-cn">0</span><span class="crayon-h">    </span><span class="crayon-cn">1</span><span class="crayon-h">    </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">2.49</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-7"><span class="crayon-h">          </span><span class="crayon-cn">1</span><span class="crayon-h">    </span><span class="crayon-cn">2</span><span class="crayon-h">    </span><span class="crayon-i">eggs</span><span class="crayon-h">   </span><span class="crayon-cn">1.25</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f396c481291563-8"><span class="crayon-h">          </span><span class="crayon-cn">2</span><span class="crayon-h">    </span><span class="crayon-cn">3</span><span class="crayon-h">  </span><span class="crayon-i">coffee</span><span class="crayon-h">   </span><span class="crayon-cn">2.35</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-9"><span class="crayon-h">          </span><span class="crayon-cn">3</span><span class="crayon-h">    </span><span class="crayon-cn">4</span><span class="crayon-h">    </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">2.00</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f396c481291563-10"><span class="crayon-h">          </span><span class="crayon-cn">4</span><span class="crayon-h">    </span><span class="crayon-cn">5</span><span class="crayon-h">    </span><span class="crayon-i">eggs</span><span class="crayon-h">   </span><span class="crayon-cn">2.49</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-11"><span class="crayon-h">          </span><span class="crayon-cn">5</span><span class="crayon-h">    </span><span class="crayon-cn">6</span><span class="crayon-h">  </span><span class="crayon-i">coffee</span><span class="crayon-h">   </span><span class="crayon-cn">2.75</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f396c481291563-12"><span class="crayon-h">          </span><span class="crayon-cn">6</span><span class="crayon-h">    </span><span class="crayon-cn">7</span><span class="crayon-h">    </span><span class="crayon-i">eggs</span><span class="crayon-h">   </span><span class="crayon-cn">2.75</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-13"><span class="crayon-h">          </span><span class="crayon-cn">7</span><span class="crayon-h">    </span><span class="crayon-cn">8</span><span class="crayon-h">  </span><span class="crayon-i">coffee</span><span class="crayon-h">   </span><span class="crayon-cn">1.95</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f396c481291563-14"><span class="crayon-h">          </span><span class="crayon-cn">8</span><span class="crayon-h">    </span><span class="crayon-cn">9</span><span class="crayon-h">    </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">3.00</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-15"><span class="crayon-h">          </span><span class="crayon-cn">9</span><span class="crayon-h">   </span><span class="crayon-cn">10</span><span class="crayon-h">    </span><span class="crayon-i">eggs</span><span class="crayon-h">   </span><span class="crayon-cn">2.25</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f396c481291563-16"><span class="crayon-h">          </span><span class="crayon-cn">10</span><span class="crayon-h">  </span><span class="crayon-cn">11</span><span class="crayon-h">    </span><span class="crayon-i">eggs</span><span class="crayon-h">   </span><span class="crayon-cn">2.00</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f396c481291563-17"><span class="crayon-h">          </span><span class="crayon-cn">11</span><span class="crayon-h">  </span><span class="crayon-cn">12</span><span class="crayon-h">  </span><span class="crayon-i">coffee</span><span class="crayon-h">   </span><span class="crayon-cn">2.35</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The result behaves just like any other Ibis table, such as those you might have used with HDFS or SQLite:</p>

		<div id="crayon-56d5c7f7f3976067457903" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f3976067457903-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">19</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">purchases</span><span class="crayon-sy">[</span><span class="crayon-v">purchases</span><span class="crayon-sy">.</span><span class="crayon-v">item</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3976067457903-2"> </p><p class="crayon-line" id="crayon-56d5c7f7f3976067457903-3"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">19</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">     </span><span class="crayon-e">id  </span><span class="crayon-e">item  </span><span class="crayon-i">price</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3976067457903-4"><span class="crayon-h">          </span><span class="crayon-cn">0</span><span class="crayon-h">   </span><span class="crayon-cn">1</span><span class="crayon-h">  </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">2.49</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3976067457903-5"><span class="crayon-h">          </span><span class="crayon-cn">1</span><span class="crayon-h">   </span><span class="crayon-cn">4</span><span class="crayon-h">  </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">2.00</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3976067457903-6"><span class="crayon-h">          </span><span class="crayon-cn">2</span><span class="crayon-h">   </span><span class="crayon-cn">9</span><span class="crayon-h">  </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">3.00</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3976067457903-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3976067457903-8"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">20</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">purchases</span><span class="crayon-sy">.</span><span class="crayon-e">group_by</span><span class="crayon-sy">(</span><span class="crayon-s">'item'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">price</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3976067457903-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3976067457903-10"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">20</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">       </span><span class="crayon-e">item  </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">price</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3976067457903-11"><span class="crayon-h">          </span><span class="crayon-cn">0</span><span class="crayon-h">    </span><span class="crayon-i">spam</span><span class="crayon-h">     </span><span class="crayon-cn">2.496667</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3976067457903-12"><span class="crayon-h">          </span><span class="crayon-cn">1</span><span class="crayon-h">  </span><span class="crayon-i">coffee</span><span class="crayon-h">     </span><span class="crayon-cn">2.350000</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3976067457903-13"><span class="crayon-h">          </span><span class="crayon-cn">2</span><span class="crayon-h">    </span><span class="crayon-i">eggs</span><span class="crayon-h">     </span><span class="crayon-cn">2.148000</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>You can issue <code>SELECT</code>, <code>INSERT</code>, <code>DELETE</code>, and <code>UPDATE</code> queries on data in Kudu tables via Impala, but for now only <code>SELECT</code> and <code>INSERT</code> operations are available from Ibis.</p>
<h2>Creating New Kudu-backed Impala Tables</h2>
<p>The Impala client’s Kudu interface has a method, <code>create_table</code>, that enables more flexible Impala table creation with data stored in Kudu. This includes:</p>
<ul>
<li>Creating empty tables with a particular schema</li>
<li>Creating tables from an Ibis table expression (i.e. a “CTAS” in database speak)</li>
<li>Creating tables from pandas DataFrame objects</li>
</ul>
<p>Let’s look at a couple examples.</p>
<p>First, I’ll create an empty Kudu-backed table:</p>

		<div id="crayon-56d5c7f7f3981862754517" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-2">2</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-4">4</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-6">6</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-8">8</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-10">10</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-12">12</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-14">14</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-16">16</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-18">18</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-20">20</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-22">22</p><p class="crayon-num" data-line="crayon-56d5c7f7f3981862754517-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c7f7f3981862754517-24">24</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">21</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">schema</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ibis</span><span class="crayon-sy">.</span><span class="crayon-e">schema</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'foo'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'int32'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-2"><span class="crayon-h">                                </span><span class="crayon-sy">(</span><span class="crayon-s">'bar'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'string'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-3"><span class="crayon-h">                                </span><span class="crayon-sy">(</span><span class="crayon-s">'baz'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'double'</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-4"> </p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-5"><span class="crayon-h">          </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-e">exists_database</span><span class="crayon-sy">(</span><span class="crayon-s">'kudu_tables'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-6"><span class="crayon-h">             </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-e">drop_database</span><span class="crayon-sy">(</span><span class="crayon-s">'kudu_tables'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">force</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-8"><span class="crayon-h">          </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-e">create_database</span><span class="crayon-sy">(</span><span class="crayon-s">'kudu_tables'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-9"><span class="crayon-h">          </span><span class="crayon-v">impala_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'example1'</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-10"><span class="crayon-h">          </span><span class="crayon-v">kudu_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'example1-kudu-table'</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-11"><span class="crayon-h">          </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-e">create_table</span><span class="crayon-sy">(</span><span class="crayon-v">impala_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kudu_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">schema</span><span class="crayon-o">=</span><span class="crayon-v">schema</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-12"><span class="crayon-h">                               </span><span class="crayon-v">primary_keys</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'foo'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-13"><span class="crayon-h">                               </span><span class="crayon-v">database</span><span class="crayon-o">=</span><span class="crayon-s">'kudu_tables'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-14"> </p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-15"><span class="crayon-h">          </span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-e">database</span><span class="crayon-sy">(</span><span class="crayon-s">'kudu_tables'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-16"> </p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-17"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">22</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">impala_table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">table</span><span class="crayon-sy">(</span><span class="crayon-v">impala_name</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-18"><span class="crayon-h">          </span><span class="crayon-v">impala_table</span><span class="crayon-sy">.</span><span class="crayon-e">schema</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-19"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-20"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">22</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">ibis</span><span class="crayon-sy">.</span><span class="crayon-i">Schema</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-21"><span class="crayon-h">            </span><span class="crayon-e">foo  </span><span class="crayon-e">int32   </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-22"><span class="crayon-e">            </span><span class="crayon-e">bar  </span><span class="crayon-t">string</span><span class="crayon-h">   </span></p><p class="crayon-line" id="crayon-56d5c7f7f3981862754517-23"><span class="crayon-h">            </span><span class="crayon-e">baz  </span><span class="crayon-t">double</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3981862754517-24"><span class="crayon-h">          </span><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Let’s look in Kudu!</p>

		<div id="crayon-56d5c7f7f398c865025196" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f398c865025196-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">23</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">list_tables</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f398c865025196-2"> </p><p class="crayon-line" id="crayon-56d5c7f7f398c865025196-3"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">23</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-sy">[</span><span class="crayon-s">'purchases'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'example1-kudu-table'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f398c865025196-4"> </p><p class="crayon-line" id="crayon-56d5c7f7f398c865025196-5"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">24</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">example1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">table</span><span class="crayon-sy">(</span><span class="crayon-v">kudu_name</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f398c865025196-6"> </p><p class="crayon-line" id="crayon-56d5c7f7f398c865025196-7"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">25</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">example1</span><span class="crayon-sy">.</span><span class="crayon-e">schema </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f398c865025196-8"> </p><p class="crayon-line" id="crayon-56d5c7f7f398c865025196-9"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">25</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-i">Schema</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">     </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f398c865025196-10"><span class="crayon-h">            </span><span class="crayon-e">foo  </span><span class="crayon-e">int32</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">PRIMARY </span><span class="crayon-e">KEY   </span></p><p class="crayon-line" id="crayon-56d5c7f7f398c865025196-11"><span class="crayon-e">            </span><span class="crayon-e">bar  </span><span class="crayon-t">string</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h">   </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f398c865025196-12"><span class="crayon-h">            </span><span class="crayon-e">baz  </span><span class="crayon-t">double</span><span class="crayon-sy">(</span><span class="crayon-v">nullable</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f398c865025196-13"><span class="crayon-h">          </span><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Note that Impala has neither the notion of primary keys nor non-nullable fields, but this metadata can inform query planning.</p>
<p>Now, I’ll create a table by inserting a subset of the purchases table:</p>

		<div id="crayon-56d5c7f7f3996028768857" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f3996028768857-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">26</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">expr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">purchases</span><span class="crayon-sy">[</span><span class="crayon-v">purchases</span><span class="crayon-sy">.</span><span class="crayon-v">item</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3996028768857-2"> </p><p class="crayon-line" id="crayon-56d5c7f7f3996028768857-3"><span class="crayon-h">          </span><span class="crayon-v">ic</span><span class="crayon-sy">.</span><span class="crayon-v">kudu</span><span class="crayon-sy">.</span><span class="crayon-e">create_table</span><span class="crayon-sy">(</span><span class="crayon-s">'example2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'example2-kudu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-o">=</span><span class="crayon-v">expr</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3996028768857-4"><span class="crayon-h">                               </span><span class="crayon-v">primary_keys</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5c7f7f3996028768857-5"><span class="crayon-h">                               </span><span class="crayon-v">database</span><span class="crayon-o">=</span><span class="crayon-s">'kudu_tables'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3996028768857-6"> </p><p class="crayon-line" id="crayon-56d5c7f7f3996028768857-7"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">27</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">example2 </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3996028768857-8"> </p><p class="crayon-line" id="crayon-56d5c7f7f3996028768857-9"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">27</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">     </span><span class="crayon-e">id  </span><span class="crayon-e">item  </span><span class="crayon-i">price</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3996028768857-10"><span class="crayon-h">          </span><span class="crayon-cn">0</span><span class="crayon-h">   </span><span class="crayon-cn">1</span><span class="crayon-h">  </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">2.49</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f3996028768857-11"><span class="crayon-h">          </span><span class="crayon-cn">1</span><span class="crayon-h">   </span><span class="crayon-cn">4</span><span class="crayon-h">  </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">2.00</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f3996028768857-12"><span class="crayon-h">          </span><span class="crayon-cn">2</span><span class="crayon-h">   </span><span class="crayon-cn">9</span><span class="crayon-h">  </span><span class="crayon-i">spam</span><span class="crayon-h">   </span><span class="crayon-cn">3.00</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We can look directly in Kudu to see the data that was inserted.</p>

		<div id="crayon-56d5c7f7f39a7737883664" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c7f7f39a7737883664-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">28</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-v">example2_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">table</span><span class="crayon-sy">(</span><span class="crayon-s">'example2-kudu'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f39a7737883664-2"><span class="crayon-h">          </span><span class="crayon-v">scanner</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">example2_data</span><span class="crayon-sy">.</span><span class="crayon-e">scanner</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f39a7737883664-3"><span class="crayon-h">          </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f39a7737883664-4"><span class="crayon-h">          </span><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">read_all_tuples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5c7f7f39a7737883664-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f39a7737883664-6"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">28</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.49</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5c7f7f39a7737883664-7"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c7f7f39a7737883664-8"><span class="crayon-h">           </span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'spam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.0</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>In the Context of the “Great Decoupling”</h2>
<p>Kudu’s “bring your own SQL” design is well in line with the broader decoupling and commoditization of open source storage and compute systems that has been going on the last 10 years. It is the responsibility of productivity-centric programming interfaces like Ibis (which you can think of as a “UI for developers”) to enhance interoperability and hide as much complexity from the user as possible.</p>
<p><a href="http://blog.cloudera.com/wp-content/uploads/2016/01/ibis-kudu-impala.png"><img class="aligncenter size-full wp-image-31666" src="http://blog.cloudera.com/wp-content/uploads/2016/01/ibis-kudu-impala.png" alt="ibis-kudu-impala"/></a></p>
<h2>Conclusions</h2>
<p>Kudu is an exciting new open source storage technology which, when combined with a high performance compute engine like Impala, enables scalable high performance analytics on fast-changing data sets. Having this functionality seamlessly available to Python programmers using Ibis will make it much easier to develop end-to-end applications involving big data analytics. Most importantly, the code that you write will be largely the same whether you have 1000 or 100 billion rows of data.</p>
<p>I’ve been working to build out the Kudu Python interface so that it’s easier for Python users to use the project and participate in the development community. If you see something here that interests you, we’d love to have you involved.</p>
<p><em>Wes McKinney is a Software Engineer at Cloudera, and the founder of the pandas and Ibis projects. Prior to that, Wes was co-founder of DataPad, and CTO and Cofounder of Lambda Foundry, Inc. Wes is author of the O’Reilly book</em> <a href="http://shop.oreilly.com/product/0636920023784.do">Python for Data Analysis</a>.</p>
<a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-normal synved-social-provider-facebook nolightbox" data-provider="facebook" target="_blank" rel="nofollow" title="Share on Facebook" href="http://www.facebook.com/sharer.php?u=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F&amp;t=Interactive%20Analytics%20on%20Dynamic%20Big%20Data%20in%20Python%20using%20Kudu%2C%20Impala%2C%20and%20Ibis&amp;s=100&amp;p[url]=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F&amp;p[images][0]=http%3A%2F%2Fblog.cloudera.com%2Fwp-content%2Fuploads%2F2016%2F01%2Fibis-kudu-impala.png&amp;p[title]=Interactive%20Analytics%20on%20Dynamic%20Big%20Data%20in%20Python%20using%20Kudu%2C%20Impala%2C%20and%20Ibis"><img alt="facebook" title="Share on Facebook" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/32x32/facebook.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-normal synved-social-provider-twitter nolightbox" data-provider="twitter" target="_blank" rel="nofollow" title="Share on Twitter" href="http://twitter.com/share?url=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F&amp;text=I%20just%20read%20this%20in%20the%20%40ClouderaEng%20blog%3A"><img alt="twitter" title="Share on Twitter" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/32x32/twitter.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-normal synved-social-provider-google_plus nolightbox" data-provider="google_plus" target="_blank" rel="nofollow" title="Share on Google+" href="https://plus.google.com/share?url=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F"><img alt="google_plus" title="Share on Google+" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/32x32/google_plus.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-normal synved-social-provider-linkedin nolightbox" data-provider="linkedin" target="_blank" rel="nofollow" title="Share on Linkedin" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F&amp;title=Interactive%20Analytics%20on%20Dynamic%20Big%20Data%20in%20Python%20using%20Kudu%2C%20Impala%2C%20and%20Ibis"><img alt="linkedin" title="Share on Linkedin" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/32x32/linkedin.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-normal synved-social-provider-mail nolightbox" data-provider="mail" rel="nofollow" title="Share by email" href="mailto:?subject=Interactive%20Analytics%20on%20Dynamic%20Big%20Data%20in%20Python%20using%20Kudu%2C%20Impala%2C%20and%20Ibis&amp;body=I%20just%20read%20this%20in%20the%20%40ClouderaEng%20blog%3A:%20http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F"><img alt="mail" title="Share by email" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/32x32/mail.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-hidef synved-social-provider-facebook nolightbox" data-provider="facebook" target="_blank" rel="nofollow" title="Share on Facebook" href="http://www.facebook.com/sharer.php?u=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F&amp;t=Interactive%20Analytics%20on%20Dynamic%20Big%20Data%20in%20Python%20using%20Kudu%2C%20Impala%2C%20and%20Ibis&amp;s=100&amp;p[url]=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F&amp;p[images][0]=http%3A%2F%2Fblog.cloudera.com%2Fwp-content%2Fuploads%2F2016%2F01%2Fibis-kudu-impala.png&amp;p[title]=Interactive%20Analytics%20on%20Dynamic%20Big%20Data%20in%20Python%20using%20Kudu%2C%20Impala%2C%20and%20Ibis"><img alt="facebook" title="Share on Facebook" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/64x64/facebook.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-hidef synved-social-provider-twitter nolightbox" data-provider="twitter" target="_blank" rel="nofollow" title="Share on Twitter" href="http://twitter.com/share?url=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F&amp;text=I%20just%20read%20this%20in%20the%20%40ClouderaEng%20blog%3A"><img alt="twitter" title="Share on Twitter" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/64x64/twitter.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-hidef synved-social-provider-google_plus nolightbox" data-provider="google_plus" target="_blank" rel="nofollow" title="Share on Google+" href="https://plus.google.com/share?url=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F"><img alt="google_plus" title="Share on Google+" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/64x64/google_plus.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-hidef synved-social-provider-linkedin nolightbox" data-provider="linkedin" target="_blank" rel="nofollow" title="Share on Linkedin" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F&amp;title=Interactive%20Analytics%20on%20Dynamic%20Big%20Data%20in%20Python%20using%20Kudu%2C%20Impala%2C%20and%20Ibis"><img alt="linkedin" title="Share on Linkedin" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/64x64/linkedin.png"/></a><a class="synved-social-button synved-social-button-share synved-social-size-32 synved-social-resolution-hidef synved-social-provider-mail nolightbox" data-provider="mail" rel="nofollow" title="Share by email" href="mailto:?subject=Interactive%20Analytics%20on%20Dynamic%20Big%20Data%20in%20Python%20using%20Kudu%2C%20Impala%2C%20and%20Ibis&amp;body=I%20just%20read%20this%20in%20the%20%40ClouderaEng%20blog%3A:%20http%3A%2F%2Fblog.cloudera.com%2Fblog%2F2016%2F01%2Finteractive-analytics-on-dynamic-big-data-in-python-using-kudu-impala-and-ibis%2F"><img alt="mail" title="Share by email" class="synved-share-image synved-social-image synved-social-image-share" src="http://blog.cloudera.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/64x64/mail.png"/></a>							</div> 
		
		</div></body></html>