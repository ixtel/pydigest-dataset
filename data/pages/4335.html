<html><body><div><div>
<p>Python ile konsol uygulamaları geliştirirken, konsolda bazen programı direkt olarak çağırmadan parametre kontrolü yapmamız gerekebiliyor. Örneğin şöyle bir çağrı:</p>
<p><code>program.py --falan=filan</code></p>
<p>Bu program basit ilkel yöntemlerce <code>sys.argv</code> kontrolü şeklinde yapılmakta. Ancak bunun doğruluğu için dahi uzunca uğraşmak gerekiyor.</p>
<p>Bu sorunu aşmak için çeşitli kütüphaneler mevcuttur. Örneğin <strong>argparse, docopt</strong> gibi kütüphaneler de bu soruna kolaylık sağlıyorlar. Ancak bunların yapıları gerçekten çok karmaşık. Örneğin <strong>argparse</strong> interspersed dediğimiz argümanların devre dışı bırakılmasını desteklemiyor. Bu güvenlik açısından bir sorun oluşturabilir.</p>
<p>Bu gibi bazı sorunlarla karşılaşmayı önlemek açısından <strong>Click</strong>, <a href="http://lucumr.pocoo.org/">Armin Ronacher</a> tarafından geliştirildi. 
Click kurulumu pip üzerinden yapılmakta.</p>
<p><code>pip install Click</code></p>
<p>komutu ile kurulumu yapabilirsiniz. Python 2.x ve 3.x sürümlerini desteklediğini de söylemek iyi olacaktır.</p>
<p>Kurulumdan sonra ilk olarak basit bir Merhaba uygulaması yapabiliriz.</p>
<pre class="code literal-block"><span class="kn">import</span> <span class="nn">click</span>

<span class="nd">@click.command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">merhaba</span><span class="p">():</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s">'Merhaba'</span><span class="p">)</span>



<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">merhaba</span><span class="p">()</span>
</pre>


<p>Click'i import ettikten sonra <code>command</code> decoratörünü çağırarak artık bunun click ile kontrol edileceğini söyleyebiliriz.</p>
<p>Ayrıca click <code>print()</code> harici kendisi <code>click.echo()</code> işlevi ile printer görevini sağlayabiliyor. İlk uygulamamız bu oldu ve çalıştırma işlemini yapalım. Sonuçlara bakalım. Örneğin bu yukarıdaki kodları <code>hello.py</code> adında bir dosyanın içerisine yazdığımızı varsayalım.</p>
<pre class="code literal-block">ali@linux <span class="nv">$ </span>hello
Merhaba

ali@linux <span class="nv">$ </span>hello -h
Error: no such option: -h

ali@linux <span class="nv">$ </span>hello --h
Error: no such option: --h  Did you mean --help?

ali@linux <span class="nv">$ </span>hello --help
Usage: hello.py <span class="o">[</span>OPTIONS<span class="o">]</span>

Options:
  --help  Show this message and exit.
</pre>


<p>Merhaba kısmından daha çok otomatik oluşturulan help sayfalarının dikkatinizi çektiğini umuyorum. Evet click otomatik olarak help sayfası oluşturabiliyor. Bunu siz yapmadan yapabiliyor.</p>
<p>Örnek olarak ilk parametrelerimi tanımlayalım ve bununla ilgili bir program yapalım. Programın işlevi girilen adı, girilen sayı kadar yazdırmak olsun. Bunun normalde for döngüsü ile basitçe yapılacağını biliyoruz.</p>
<p><strong>Sahte Kod</strong>:</p>
<pre class="code literal-block">sayaç =&gt; girilen sayı:
    yazdır: girilen isim
</pre>


<p>Evet sahte kodu bu şekilde. Normalde Python ile yapmak isteseydik de bu format üzerinden gidecektik. Şimdi tekrar Click ile geliştirmeye dönelim. Öncelikle <code>option()</code> ve <code>argument()</code> decoratörlerini ekleyelim ve bunlara alması gereken değerleri bildirelim. Bu eklenen değerleri de yani decoratörler içerisinde tanımlanan option ve argument değerlerini de kendimize ait olan işleve işlev değişken olarak atayalım.</p>
<pre class="code literal-block"><span class="kn">import</span> <span class="nn">click</span>

<span class="nd">@click.command</span><span class="p">()</span>
<span class="nd">@click.option</span><span class="p">(</span><span class="s">'--count'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Kac defa yazdiracagiz?'</span><span class="p">)</span>
<span class="nd">@click.argument</span><span class="p">(</span><span class="s">'isim'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">'Ali'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">merhaba</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">isim</span><span class="p">):</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s">'Merhaba'</span><span class="p">)</span>



<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">merhaba</span><span class="p">()</span>
</pre>


<p>Burada iki decorator ve bu decoratorlerin argümanları var. Option decoratorunun aldığı <code>--count</code> argümanı programa şu özelliği katar:</p>
<p><code>program.py --count</code></p>
<p>Daha sonra gelen ve 1 değerini almış olan <code>default</code> ise varsayılan değeri belirler. Burada varsayılan değerin belirli bir veri tipi yoktur. Ancak belirlenen veri tipini help metninde tür olarak gösterir. Biz sayaç işlemini yapacağımız için 1 dedik. Sonradan gelen <code>help</code> ise bu özelliğe dair yardım metnini gösterir. Yan <code>program.py --help</code> çağırıldığı zaman bu yardım metni de ayrıca gösterilir.</p>
<p>Argument decoratörü ise bir argüman alır. Bu argüman da ayrıca bir default değer alabilir.</p>
<pre class="code literal-block"><span class="kn">import</span> <span class="nn">click</span>

<span class="nd">@click.command</span><span class="p">()</span>
<span class="nd">@click.option</span><span class="p">(</span><span class="s">'--count'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Kac defa yazdiracagiz?'</span><span class="p">)</span>
<span class="nd">@click.argument</span><span class="p">(</span><span class="s">'isim'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">'Ali'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">merhaba</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">isim</span><span class="p">):</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s">'Merhaba </span><span class="si">%s</span><span class="s">'</span> <span class="o">%</span> <span class="n">isim</span><span class="p">)</span>



<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">merhaba</span><span class="p">()</span>
</pre>


<p>Şu anki görünüm nasıl?</p>
<pre class="code literal-block">ali@linux <span class="nv">$ </span>hello
Merhaba Ali

ali@linux <span class="nv">$ </span>hello --help

Usage: hello.py <span class="o">[</span>OPTIONS<span class="o">]</span> <span class="o">[</span>ISIM<span class="o">]</span>

Options:
  --count INTEGER  Kac defa yazdiracagiz?
  --help           Show this message and exit.
</pre>


<p>Son olarak programı tamamlayalım ve belirtilen miktar adedince yazdırma işlemini yaptıralım.</p>
<pre class="code literal-block"><span class="kn">import</span> <span class="nn">click</span>

<span class="nd">@click.command</span><span class="p">()</span>
<span class="nd">@click.option</span><span class="p">(</span><span class="s">'--count'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Kac defa yazdiracagiz?'</span><span class="p">)</span>
<span class="nd">@click.argument</span><span class="p">(</span><span class="s">'isim'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">'Ali'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">merhaba</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">isim</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s">'Merhaba </span><span class="si">%s</span><span class="s">'</span> <span class="o">%</span> <span class="n">isim</span><span class="p">)</span>



<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">merhaba</span><span class="p">()</span>
</pre>


<p>Kodlarımız bunlar. Konsolda şöyle çağırıyoruz.</p>
<pre class="code literal-block">ali@linux <span class="nv">$ </span>hello --count<span class="o">=</span><span class="m">5</span> Arkadaş?
Merhaba Arkadaş?
Merhaba Arkadaş?
Merhaba Arkadaş?
Merhaba Arkadaş?
Merhaba Arkadaş?
</pre>


<p>Evet şimdilik bu kadar.</p>
</div>
    </div></body></html>