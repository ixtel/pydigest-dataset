<html><body><div><div class="section">
              <h1>pyentrypoint 0.1.11</h1>

              


<p>pyentrypoint manages entrypoints in Docker containers.</p><p>








# pyentrypoint</p><p>__pyentrypoint__ is a tool written in `Python` to manager Docker containers `ENTRYPOINT`.</p><p>This tool avoids writing shell scripts to:</p><p> - Handle commands and sub commands</p><p> - Identify linked containers</p><p> - Generate configuration using `jinja2` templates</p><p> - Run commands before starting service</p><p>## Usages</p><p>### Install in container</p><p>All you need to do is to setup a `yaml` file called `entrypoint-config.yml` and to install __pyentrypoint__ in your `Dockerfile` using pip.</p><p>```dockerfile</p><p>FROM        debian</p><p># Installing git for example</p><p>RUN         apt-get update &amp;&amp; apt-get install git python-pip -y</p><p># Install pyentrypoint</p><p>RUN         pip install pyentrypoint</p><p># Copy config file in the current WORKDIR</p><p>COPY        entrypoint-config.yml .</p><p># Set ENTRYPOINT</p><p>ENTRYPOINT  ['pyentrypoint']</p><p># git will be the default command</p><p>CMD         ['git']</p><p>```</p><p>### Setup entrypoint</p><p>This is an example of `entrypoint-config.yml` file.</p><p>```yaml</p><p># Entrypoint configuration example</p><p># This entry should reflect CMD in Dockerfile</p><p>command: git</p><p># This is a list with some subcommands to handle</p><p># when CMD is not `git` here.</p><p># By default, all args started with hyphen are handled.</p><p>subcommands:</p><p>    - "-*"</p><p>    - clone</p><p>    - init</p><p>    - ls-files</p><p>    # etc...</p><p># User and group to run the cmd.</p><p># Can be name or uid/gid.</p><p># Affect only command handled.</p><p># Dockerfile USER value by default.</p><p>user: 1000</p><p>group: 1000</p><p># These files should exist (ADD or COPY)</p><p># and should be jinja templated.</p><p>config_files:</p><p>    - /etc/gitconfig</p><p>    - .ssh/config</p><p>    - .ssh/id_rsa</p><p># These environment variables will be wiped before</p><p># exec command to keep them secret</p><p># CAUTION: if the container is linked to another one,</p><p># theses variables will passed to it anyway</p><p>secret_env:</p><p>    - SSHKEY</p><p># Links are handled here</p><p># Port, name, protocol or env variable can be used to identify the links</p><p># Raise an error if the link could not be identified</p><p>links:</p><p>    'ssh':</p><p>        port: 22</p><p>        name: 'ssh*'</p><p>        protocol: tcp</p><p>        # env can be list, dictionary or string</p><p>        env:</p><p>            FOO: bar</p><p>        # Single doesn't allow multiple links for this ID</p><p>        # false by default</p><p>        single: true</p><p>        # Set to false to get optional link</p><p>        # true by default</p><p>        required: true</p><p># Commands to run before applying configuration</p><p>pre_conf_commands:</p><p>    - echo something &gt; to_this_file</p><p># commands to run after applying configuration</p><p>post_conf_commands:</p><p>    - echo "something else" &gt; to_this_another_file</p><p># Cleanup environment from variables created by linked containers</p><p># before running command (True by default)</p><p>clean_env: True</p><p># Enable debug to debug</p><p>debug: true</p><p>```</p><p>### Config templates</p><p>You can generate configuration for your service with jinga2 template.</p><p>Here an example for an hypothetical ssh config file:</p><p>```jinga</p><p>host server:</p><p>    hostname {{links.ssh.ip}}</p><p>    port {{links.ssh.port}}</p><p>```</p><p>Templates with be replaced with ip address and port of the identified link. All links can be accessed from `links.all`, this is a tuple of links you can iterate on it.</p><p>```jinga</p><p>{% for link in links.all %}</p><p>host {{link.names[0]}}</p><p>    hostname {{link.ip}}</p><p>    port {{links.port}}</p><p>{% endfor %}</p><p>```</p><p>If you change the option `single` to `false` in the `entrypoint-config.yml`, the identified link `ssh` will become a tuple of links. You must iterate on it in the `jinja` template.</p><p>```jinga</p><p>{% for link in links.ssh %}</p><p>host {{link.names[0]}}</p><p>    hostname {{link.ip}}</p><p>    port {{links.port}}</p><p>{% endfor %}</p><p>```</p><p>### Accessible object</p><p>You have 4 available objects in your templates.</p><p> - `config`</p><p> - `links`</p><p> - `containers`</p><p> - `environ`</p><p>#### config</p><p>`Config` reflect the config file. You can retrieve any setup in this object.</p><p>(see `config.py`)</p><p>#### links</p><p>`Links` handles `Link` objects. You can identify links using globing patterns in the configuration file.</p><p>`link` is related to one physical link (one ip and one port).</p><p>`link` handles the following attributes:</p><p>  - `ip`</p><p>    - link ip</p><p>  - `port`</p><p>    - link port (integer)</p><p>  - `environ`</p><p>    - related container environment</p><p>  - `protocol`</p><p>    - link protocol (`tcp` or `udp`)</p><p>  - `uri`</p><p>    - link uri (example: `tcp://10.0.0.3:80`)</p><p>  - `names`</p><p>    - tuple of related container names</p><p>#### containers</p><p>`containers` handles a tuple of `container` object.</p><p>`container` handles the following attributes:</p><p>  - `ip`</p><p>    - container ip</p><p>  - `environ`</p><p>    - container environment</p><p>  - `names`</p><p>    - List of containers names</p><p>  - `links`</p><p>    - Tuple of `link` object related to this container</p><p>#### environ</p><p>`environ` is the environment of the container (os.environ).</p><p>### Running Tests</p><p>To run tests, ensure that `docker-compose` and `make` are installed and run</p><p>```shell</p><p>$ make test</p><p>```

</p><a name="downloads">Â </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>278</span> downloads in the last week
  </li>
  <li>
    <span>673</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>