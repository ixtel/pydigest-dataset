<html><body><div><header class="entry-header"><h1 class="entry-title" itemprop="headline">Boto: using Python to automate AWS services</h1><p class="entry-meta"><time class="entry-time" itemprop="datePublished" datetime="2015-06-02T09:01:58+00:00">June 2, 2015</time> by <span class="entry-author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><span class="entry-author-name" itemprop="name">Nitheesh Poojary</span></span></p></header><div class="entry-content" itemprop="text"><hr/><h2>Boto allows you to write some scripts to automate things like starting AWS EC2 instances</h2><p><a href="https://github.com/boto/boto" target="_blank">Boto</a> is a Python package that provides programmatic connectivity to Amazon Web Services.</p><p><a href="http://cloudacademy.com/blog/wp-content/uploads/2015/06/python-boto.jpg"><img class="alignleft wp-image-6645 size-full" title="boto" src="http://cloudacademy.com/blog/wp-content/uploads/2015/06/python-boto.jpg" alt="Boto" srcset="http://cloudacademy.com/blog/wp-content/uploads/2015/06/python-boto-150x150.jpg 150w, http://cloudacademy.com/blog/wp-content/uploads/2015/06/python-boto.jpg 230w" sizes="(max-width: 230px) 100vw, 230px"/></a>The Amazon Cloud offers a range of services for dynamically scaling servers including the core compute service, the Elastic Compute Cloud (EC2), various storage offerings, load balancers, and DNS. You can control these services either through AWS console or by way of AWS’s extensive API. But there are a number of third-party libraries for using this API. for Python, we have Boto. Boto allows you to write some handy scripts to automate simple things like starting or stopping EC2 instances or taking regular snapshots of your servers.</p><h3><strong>Installing Boto on Linux (CentOS)</strong></h3><p>1. You’ll first use the yum package manager to install Python and the pip Python package installer:</p><div id="crayon-56d58f3073e33591489586" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover"><p class="crayon-info"/><p class="crayon-plain-wrap"/><div class="crayon-main"><table class="crayon-table"><tr class="crayon-row"><td class="crayon-nums " data-settings="show"/><td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58f3073e33591489586-1"><span class="crayon-e">yum </span><span class="crayon-e">install </span><span class="crayon-e">python </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-e">devel </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-v">pip</span></p></div></td></tr></table></div></div><p/><p>2. Now we will install the Boto package via pip:</p><p/><p/><p>3. Finally, we can test if everything has been successfully installed on our Linux box:</p><p/><div id="crayon-56d58f3073e42794564060" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover"><p class="crayon-info"/><p class="crayon-plain-wrap"/><div class="crayon-main"><table class="crayon-table"><tr class="crayon-row"><td class="crayon-nums " data-settings="show"/><td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58f3073e42794564060-1"><span class="crayon-v">python</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">"import boto; print boto.Version"</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e42794564060-2"><span class="crayon-cn">2.9.6</span></p></div></td></tr></table></div></div><p/><h3><strong>Configuring AWS credentials</strong></h3><p>On startup, the Boto library looks for configuration files in the following locations (in this order):</p><ul><li><em>/etc/boto.cfg</em> – for site-wide settings for all users on this machine</li><li><em>~/.boto</em> – for user-specific settings</li></ul><h3><strong>Use cases</strong></h3><p>Lets start with a basic scenario:  <strong>launching an EC2 instance</strong></p><div id="crayon-56d58f3073e48128868374" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover"><p class="crayon-info"/><p class="crayon-plain-wrap"/><div class="crayon-main"><table class="crayon-table"><tr class="crayon-row"><td class="crayon-nums " data-settings="show"/><td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58f3073e48128868374-1"><span class="crayon-c">#/usr/bin/python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e48128868374-2"><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d58f3073e48128868374-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">boto</span><span class="crayon-sy">.</span><span class="crayon-e">ec2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e48128868374-4"><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boto</span><span class="crayon-sy">.</span><span class="crayon-v">ec2</span><span class="crayon-sy">.</span><span class="crayon-e">connect_to_region</span><span class="crayon-sy">(</span><span class="crayon-s">"us-west-2"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58f3073e48128868374-5"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">run_instances</span><span class="crayon-sy">(</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e48128868374-6"><span class="crayon-h">    </span><span class="crayon-s">'ami-6ac2a85a'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d58f3073e48128868374-7"><span class="crayon-h">    </span><span class="crayon-v">key_name</span><span class="crayon-o">=</span><span class="crayon-s">'nitheesh_oregon'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e48128868374-8"><span class="crayon-h">    </span><span class="crayon-v">instance_type</span><span class="crayon-o">=</span><span class="crayon-s">'t1.micro'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d58f3073e48128868374-9"><span class="crayon-h">    </span><span class="crayon-v">security_groups</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'nitheesh_oregon'</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e48128868374-10"><span class="crayon-sy">)</span></p></div></td></tr></table></div></div><p/><p>The above python script will connect to Amazon’s us-west region and launch an instance using AMI id: ami-6ac2a85a.</p><p><strong>Scheduling stop instances.</strong> Let’s say you now want to stop your test environment instances at a certain time each day. Run:</p><p/><div id="crayon-56d58f3073e4d181838731" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover"><p class="crayon-info"/><p class="crayon-plain-wrap"/><div class="crayon-main"><table class="crayon-table"><tr class="crayon-row"><td class="crayon-nums " data-settings="show"/><td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58f3073e4d181838731-1"><span class="crayon-c">#/usr/bin/python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e4d181838731-2"> </p><p class="crayon-line" id="crayon-56d58f3073e4d181838731-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">boto</span><span class="crayon-sy">.</span><span class="crayon-e">ec2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e4d181838731-4"> </p><p class="crayon-line" id="crayon-56d58f3073e4d181838731-5"><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boto</span><span class="crayon-sy">.</span><span class="crayon-v">ec2</span><span class="crayon-sy">.</span><span class="crayon-e">connect_to_region</span><span class="crayon-sy">(</span><span class="crayon-s">"us-west-2"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e4d181838731-6"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">stop_instances</span><span class="crayon-sy">(</span><span class="crayon-v">instance_ids</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'instance-id-1'</span><span class="crayon-sy">,</span><span class="crayon-s">'instance-id-2'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p></div></td></tr></table></div></div><p>You can schedule this script to run every day at a particular time by creating a cron job.</p><p><strong>CloudFront invalidation</strong>. AWS doesn’t provide a command line tool for CloudFront. Therefore, if you want to invalidate objects, you’ll need to log into the console and add the objects to invalidate. It’s a really long and tiresome process. Instead, you can make use of the Boto library:</p><div id="crayon-56d58f3073e52316126984" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover"><p class="crayon-info"/><p class="crayon-plain-wrap"/><div class="crayon-main"><table class="crayon-table"><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58f3073e52316126984-2">2</p><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58f3073e52316126984-4">4</p><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58f3073e52316126984-6">6</p><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58f3073e52316126984-8">8</p><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58f3073e52316126984-10">10</p><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58f3073e52316126984-12">12</p><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58f3073e52316126984-14">14</p><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58f3073e52316126984-16">16</p><p class="crayon-num" data-line="crayon-56d58f3073e52316126984-17">17</p></div></td><td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58f3073e52316126984-1"><span class="crayon-c">#/usr/bin/python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e52316126984-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">boto</span></p><p class="crayon-line" id="crayon-56d58f3073e52316126984-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e52316126984-4"><span class="crayon-v">dist_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'xxxxxxxxxxx'</span></p><p class="crayon-line" id="crayon-56d58f3073e52316126984-5"><span class="crayon-v">invalidation_path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'/home/ec2-user/invalid.txt'</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e52316126984-6"> </p><p class="crayon-line" id="crayon-56d58f3073e52316126984-7"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e52316126984-8"><span class="crayon-h">    </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">invalidation_path</span><span class="crayon-sy">,</span><span class="crayon-s">"r+"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58f3073e52316126984-9"><span class="crayon-h">    </span><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boto</span><span class="crayon-sy">.</span><span class="crayon-e">connect_cloudfront</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e52316126984-10"><span class="crayon-h">    </span><span class="crayon-v">inval_req</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">create_invalidation_request</span><span class="crayon-sy">(</span><span class="crayon-v">dist_id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58f3073e52316126984-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e52316126984-12"><span class="crayon-h">    </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-e">inval_req</span></p><p class="crayon-line" id="crayon-56d58f3073e52316126984-13"><span class="crayon-e">    </span><span class="crayon-v">touch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">invalidation_path</span><span class="crayon-sy">,</span><span class="crayon-s">"w"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e52316126984-14"><span class="crayon-h">    </span><span class="crayon-v">touch</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-s">""</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58f3073e52316126984-15"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d58f3073e52316126984-16"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'__main__'</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d58f3073e52316126984-17"><span class="crayon-h">    </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td></tr></table></div></div><p>This script reads objects specified in a file, invalidates them, prints an invalidation ID, and clears the contents of invalid.txt.</p><h3><strong>AWS Services supported by Boto</strong></h3><p>At the moment, Boto supports more than fifty Amazon services, running the whole range from compute, database, application, and payments and billing. You can find a <a href="https://pypi.python.org/pypi/boto" target="_blank">complete and current list</a> on the Python.org website.</p><h3><strong>Conclusion </strong></h3><p><strong>Boto lets you write scripts</strong> that manage complex set ups in the Amazon cloud. In addition, it provides support for other public services such as Google Storage, besides private cloud systems like Eucalyptus, OpenStack, and Open Nebula.</p><p>If you’re a python expert and value your time, go for it.</p><p>(For a different way of using Python on AWS, see our <a href="http://cloudacademy.com/blog/aws-machine-learning/">Amazon Machine Learning post</a>.)<br/></p> <section id="text-6" class="widget widget_text"> </section><p/><div class="wp-about-author-containter-around"><div class="wp-about-author-text"><p>My professional IT career began nine years back when I was just out of my college. I worked with a great team as an infrastructure management engineer, managing hundreds of enterprise application servers. I found my passion when I got the opportunity to work with Cloud technologies: I'm addicted to AWS Cloud Services, DevOps engineering, and all the cloud tools and technologies that make engineers' lives easier. Currently I am working as a Technical Specialist in a respected firm in Bangalore. I'm a Certified AWS and SysOps Engineer, happily helping fellow engineers across the globe through my blogs and answering questions in various forums. When not solving problems for my projects, I play sports, hang out with friends or travel to places on my wish list.</p><p><a href="http://cloudacademy.com/blog/author/nitheesh/" title="More posts by Nitheesh Poojary">More Posts</a> - <a href="http://nitheeshp.blogspot.in/" title="Nitheesh Poojary" rel="nofollow" target="_blank">Website</a></p><p class="wpa-nomargin">Follow Me:<br/><a class="wpa-social-icons" href="http://www.twitter.com/nitheeshp" rel="nofollow" target="_blank"><img src="http://cloudacademy.com/blog/wp-content/plugins/wp-about-author/images/twitter.png" alt="Twitter"/></a><a class="wpa-social-icons" href="http://www.linkedin.com/in/nitheeshp" rel="nofollow" target="_blank"><img src="http://cloudacademy.com/blog/wp-content/plugins/wp-about-author/images/linkedin.png" alt="LinkedIn"/></a></p></div></div><span class="et_social_bottom_trigger"/></div></div></body></html>