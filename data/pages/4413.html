<html><body><div><table class="diff-table tab-size  " data-tab-size="8">
                
      <tr class="js-expandable-line" data-position="0">
    <td class="blob-num blob-num-expandable" colspan="2">
      <a href="#diff-61309edb43a99b782d081351c5c602d1" class="diff-expander js-expand" title="Expand" aria-label="Expand" data-url="/micropython/micropython/blob_excerpt/ff5d401d92fe483bee5dcf837da8f048b2897ae3?diff=unified&amp;left_hunk_size=8&amp;mode=100644&amp;next_line_num_left=33&amp;next_line_num_right=33&amp;path=esp8266%2Fmodesp.c&amp;prev_line_num_left=&amp;prev_line_num_right=&amp;right_hunk_size=437" data-left-range="1-32" data-right-range="1-32">
        <svg aria-hidden="true" class="octicon octicon-unfold" role="img" version="1.1" viewbox="0 0 14 16"><path d="M11.5 8.5l2.5 2.5c0 0.55-0.45 1-1 1H9v-1h3.5L10.5 9H3.5L1.5 11h3.5v1H1c-0.55 0-1-0.45-1-1l2.5-2.5L0 6c0-0.55 0.45-1 1-1h4v1H1.5l2 2h7l2-2H9v-1h4c0.55 0 1 0.45 1 1L11.5 8.5z m-5.5-1.5h2V4h2L7 1 4 4h2v3z m2 3H6v3H4l3 3 3-3H8V10z"/></svg>
      </a>
    </td>
    <td class="blob-code blob-code-inner blob-code-hunk">@@ -33,8 +33,437 @@</td>
  </tr>

    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L33" data-line-number="33" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R33" data-line-number="33" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> #<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>py/gc.h<span class="pl-pds">"</span></span></span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L34" data-line-number="34" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R34" data-line-number="34" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> #<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>py/runtime.h<span class="pl-pds">"</span></span></span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L35" data-line-number="35" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R35" data-line-number="35" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> #<span class="pl-k">include</span> MICROPY_HAL_H</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R36" data-line-number="36" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>netutils.h<span class="pl-pds">"</span></span></span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L36" data-line-number="36" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R37" data-line-number="37" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> #<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>queue.h<span class="pl-pds">"</span></span></span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L37" data-line-number="37" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R38" data-line-number="38" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> #<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>user_interface.h<span class="pl-pds">"</span></span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R39" data-line-number="39" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>espconn.h<span class="pl-pds">"</span></span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R40" data-line-number="40" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R41" data-line-number="41" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>utils.h<span class="pl-pds">"</span></span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R42" data-line-number="42" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R43" data-line-number="43" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">const</span> <span class="pl-c1">mp_obj_type_t</span> esp_socket_type;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R44" data-line-number="44" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R45" data-line-number="45" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-k">typedef</span> <span class="pl-k">struct</span> <span class="pl-c1">_esp_socket_obj_t</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R46" data-line-number="46" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_obj_base_t</span> base;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R47" data-line-number="47" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">struct</span> espconn *espconn;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R48" data-line-number="48" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R49" data-line-number="49" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_obj_t</span> cb_connect;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R50" data-line-number="50" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_obj_t</span> cb_recv;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R51" data-line-number="51" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_obj_t</span> cb_disconnect;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R52" data-line-number="52" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R53" data-line-number="53" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">uint8_t</span> *recvbuf;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R54" data-line-number="54" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_uint_t</span> recvbuf_len;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R55" data-line-number="55" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R56" data-line-number="56" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">bool</span> fromserver;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R57" data-line-number="57" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R58" data-line-number="58" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_obj_list_t</span> *connlist;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R59" data-line-number="59" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+} <span class="pl-c1">esp_socket_obj_t</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R60" data-line-number="60" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R61" data-line-number="61" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// Due to the onconnect callback not being able to recognize the parent esp_socket,</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R62" data-line-number="62" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// we can have only one esp_socket listening at a time</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R63" data-line-number="63" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// This should be solvable by some PIC hacking</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R64" data-line-number="64" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">esp_socket_obj_t</span> *esp_socket_listening;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R65" data-line-number="65" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R66" data-line-number="66" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_make_new_base</span>() {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R67" data-line-number="67" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = <span class="pl-c1">m_new_obj_with_finaliser</span>(<span class="pl-c1">esp_socket_obj_t</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R68" data-line-number="68" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;recvbuf = <span class="pl-c1">NULL</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R69" data-line-number="69" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;base.<span class="pl-smi">type</span> = (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_type;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R70" data-line-number="70" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;cb_connect = mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R71" data-line-number="71" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;cb_recv = mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R72" data-line-number="72" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;cb_disconnect = mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R73" data-line-number="73" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;fromserver = <span class="pl-c1">false</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R74" data-line-number="74" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> s;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R75" data-line-number="75" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R76" data-line-number="76" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R77" data-line-number="77" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// constructor esp_socket(family=AF_INET, type=SOCK_STREAM, proto=IPPROTO_TCP, fileno=None)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R78" data-line-number="78" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// Arguments ignored as we do not support UDP (yet)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R79" data-line-number="79" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_make_new</span>(<span class="pl-c1">mp_obj_t</span> type_in, <span class="pl-c1">mp_uint_t</span> n_args,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R80" data-line-number="80" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_uint_t</span> n_kw, <span class="pl-k">const</span> <span class="pl-c1">mp_obj_t</span> *args) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R81" data-line-number="81" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_arg_check_num</span>(n_args, n_kw, <span class="pl-c1">0</span>, <span class="pl-c1">4</span>, <span class="pl-c1">false</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R82" data-line-number="82" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R83" data-line-number="83" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = <span class="pl-c1">esp_socket_make_new_base</span>();</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R84" data-line-number="84" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;espconn = <span class="pl-c1">m_new_obj</span>(<span class="pl-k">struct</span> espconn);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R85" data-line-number="85" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_create</span>(s-&gt;espconn);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R86" data-line-number="86" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R87" data-line-number="87" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;espconn-&gt;reverse = s;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R88" data-line-number="88" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c">// TODO: UDP Support</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R89" data-line-number="89" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;espconn-&gt;type = ESPCONN_TCP;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R90" data-line-number="90" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;espconn-&gt;state = ESPCONN_NONE;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R91" data-line-number="91" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R92" data-line-number="92" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;espconn-&gt;proto.<span class="pl-smi">tcp</span> = <span class="pl-c1">m_new_obj</span>(esp_tcp);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R93" data-line-number="93" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R94" data-line-number="94" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> s;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R95" data-line-number="95" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R96" data-line-number="96" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R97" data-line-number="97" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.close()</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R98" data-line-number="98" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_close</span>(<span class="pl-c1">mp_obj_t</span> self_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R99" data-line-number="99" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R100" data-line-number="100" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R101" data-line-number="101" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (esp_socket_listening == s) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R102" data-line-number="102" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        esp_socket_listening = <span class="pl-c1">NULL</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R103" data-line-number="103" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R104" data-line-number="104" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R105" data-line-number="105" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;espconn-&gt;state != ESPCONN_NONE &amp;&amp; s-&gt;espconn-&gt;state != ESPCONN_CLOSE) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R106" data-line-number="106" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">espconn_disconnect</span>(s-&gt;espconn);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R107" data-line-number="107" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R108" data-line-number="108" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R109" data-line-number="109" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;connlist != <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R110" data-line-number="110" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_obj_list_set_len</span>(s-&gt;connlist, <span class="pl-c1">0</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R111" data-line-number="111" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R112" data-line-number="112" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R113" data-line-number="113" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R114" data-line-number="114" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R115" data-line-number="115" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_1</span>(esp_socket_close_obj, esp_socket_close);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R116" data-line-number="116" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R117" data-line-number="117" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.__del__()</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R118" data-line-number="118" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket___del__</span>(<span class="pl-c1">mp_obj_t</span> self_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R119" data-line-number="119" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R120" data-line-number="120" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R121" data-line-number="121" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_close</span>(self_in);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R122" data-line-number="122" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R123" data-line-number="123" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;fromserver) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R124" data-line-number="124" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">espconn_delete</span>(s-&gt;espconn);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R125" data-line-number="125" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R126" data-line-number="126" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R127" data-line-number="127" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R128" data-line-number="128" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R129" data-line-number="129" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_1</span>(esp_socket___del___obj, esp_socket___del__);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R130" data-line-number="130" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R131" data-line-number="131" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.bind(address)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R132" data-line-number="132" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_bind</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> addr_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R133" data-line-number="133" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R134" data-line-number="134" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R135" data-line-number="135" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_uint_t</span> port = <span class="pl-c1">netutils_parse_inet_addr</span>(addr_in,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R136" data-line-number="136" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        s-&gt;espconn-&gt;proto.<span class="pl-smi">tcp</span>-&gt;remote_ip, NETUTILS_BIG);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R137" data-line-number="137" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;espconn-&gt;proto.<span class="pl-smi">tcp</span>-&gt;local_port = port;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R138" data-line-number="138" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R139" data-line-number="139" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R140" data-line-number="140" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R141" data-line-number="141" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_bind_obj, esp_socket_bind);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R142" data-line-number="142" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R143" data-line-number="143" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">void</span> <span class="pl-en">esp_socket_recv_callback</span>(<span class="pl-k">void</span> *arg, <span class="pl-k">char</span> *pdata, <span class="pl-k">unsigned</span> <span class="pl-k">short</span> len) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R144" data-line-number="144" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">struct</span> espconn *conn = arg;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R145" data-line-number="145" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = conn-&gt;reverse;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R146" data-line-number="146" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R147" data-line-number="147" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;cb_recv != mp_const_none) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R148" data-line-number="148" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">call_function_2_protected</span>(s-&gt;cb_recv, s, <span class="pl-c1">mp_obj_new_bytes</span>((byte *)pdata, len));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R149" data-line-number="149" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    } <span class="pl-k">else</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R150" data-line-number="150" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-k">if</span> (s-&gt;recvbuf == <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R151" data-line-number="151" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            s-&gt;recvbuf = <span class="pl-c1">gc_alloc</span>(len, <span class="pl-c1">false</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R152" data-line-number="152" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            s-&gt;recvbuf_len = len;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R153" data-line-number="153" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-k">if</span> (s-&gt;recvbuf != <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R154" data-line-number="154" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+                <span class="pl-c1">memcpy</span>(s-&gt;recvbuf, pdata, len);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R155" data-line-number="155" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R156" data-line-number="156" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        } <span class="pl-k">else</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R157" data-line-number="157" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            s-&gt;recvbuf = <span class="pl-c1">gc_realloc</span>(s-&gt;recvbuf, s-&gt;recvbuf_len + len);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R158" data-line-number="158" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-k">if</span> (s-&gt;recvbuf != <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R159" data-line-number="159" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+                <span class="pl-c1">memcpy</span>(&amp;s-&gt;recvbuf[s-&gt;recvbuf_len], pdata, len);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R160" data-line-number="160" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+                s-&gt;recvbuf_len += len;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R161" data-line-number="161" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R162" data-line-number="162" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R163" data-line-number="163" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-k">if</span> (s-&gt;recvbuf == <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R164" data-line-number="164" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-c1">esp_socket_close</span>(s);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R165" data-line-number="165" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-k">return</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R166" data-line-number="166" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R167" data-line-number="167" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R168" data-line-number="168" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R169" data-line-number="169" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R170" data-line-number="170" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">void</span> <span class="pl-en">esp_socket_sent_callback</span>(<span class="pl-k">void</span> *arg) {}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R171" data-line-number="171" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R172" data-line-number="172" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">void</span> <span class="pl-en">esp_socket_disconnect_callback</span>(<span class="pl-k">void</span> *arg) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R173" data-line-number="173" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">struct</span> espconn *conn = arg;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R174" data-line-number="174" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = conn-&gt;reverse;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R175" data-line-number="175" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R176" data-line-number="176" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;cb_disconnect != mp_const_none) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R177" data-line-number="177" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">call_function_1_protected</span>(s-&gt;cb_disconnect, s);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R178" data-line-number="178" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R179" data-line-number="179" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R180" data-line-number="180" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_close</span>(s);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R181" data-line-number="181" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R182" data-line-number="182" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R183" data-line-number="183" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">void</span> <span class="pl-en">esp_socket_connect_callback_server</span>(<span class="pl-k">void</span> *arg) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R184" data-line-number="184" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">struct</span> espconn *conn = arg;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R185" data-line-number="185" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R186" data-line-number="186" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = <span class="pl-c1">esp_socket_make_new_base</span>();</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R187" data-line-number="187" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;espconn = conn;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R188" data-line-number="188" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;fromserver = <span class="pl-c1">true</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R189" data-line-number="189" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    conn-&gt;reverse = s;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R190" data-line-number="190" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R191" data-line-number="191" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_recvcb</span>(conn, esp_socket_recv_callback);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R192" data-line-number="192" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_sentcb</span>(conn, esp_socket_sent_callback);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R193" data-line-number="193" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_disconcb</span>(conn, esp_socket_disconnect_callback);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R194" data-line-number="194" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_time</span>(conn, <span class="pl-c1">15</span>, <span class="pl-c1">0</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R195" data-line-number="195" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R196" data-line-number="196" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (esp_socket_listening-&gt;cb_connect != mp_const_none) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R197" data-line-number="197" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">call_function_1_protected</span>(esp_socket_listening-&gt;cb_connect, s);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R198" data-line-number="198" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    } <span class="pl-k">else</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R199" data-line-number="199" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_obj_list_append</span>(esp_socket_listening-&gt;connlist, s);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R200" data-line-number="200" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R201" data-line-number="201" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R202" data-line-number="202" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R203" data-line-number="203" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">void</span> <span class="pl-en">esp_socket_connect_callback_client</span>(<span class="pl-k">void</span> *arg) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R204" data-line-number="204" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">struct</span> espconn *conn = arg;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R205" data-line-number="205" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = conn-&gt;reverse;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R206" data-line-number="206" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R207" data-line-number="207" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;cb_connect != mp_const_none) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R208" data-line-number="208" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">call_function_1_protected</span>(s-&gt;cb_connect, s);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R209" data-line-number="209" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R210" data-line-number="210" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+};</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R211" data-line-number="211" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R212" data-line-number="212" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.listen(backlog)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R213" data-line-number="213" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_listen</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> backlog) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R214" data-line-number="214" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R215" data-line-number="215" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R216" data-line-number="216" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (esp_socket_listening != <span class="pl-c1">NULL</span>)</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R217" data-line-number="217" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">nlr_raise</span>(<span class="pl-c1">mp_obj_new_exception_msg</span>(&amp;mp_type_OSError,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R218" data-line-number="218" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-s"><span class="pl-pds">"</span>Only one espconn can listen at a time<span class="pl-pds">"</span></span>));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R219" data-line-number="219" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R220" data-line-number="220" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    esp_socket_listening = s;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R221" data-line-number="221" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R222" data-line-number="222" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;connlist = <span class="pl-c1">mp_obj_new_list</span>(<span class="pl-c1">0</span>, <span class="pl-c1">NULL</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R223" data-line-number="223" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R224" data-line-number="224" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_connectcb</span>(s-&gt;espconn, esp_socket_connect_callback_server);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R225" data-line-number="225" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_accept</span>(s-&gt;espconn);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R226" data-line-number="226" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_time</span>(s-&gt;espconn, <span class="pl-c1">1500</span>, <span class="pl-c1">0</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R227" data-line-number="227" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R228" data-line-number="228" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R229" data-line-number="229" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R230" data-line-number="230" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_listen_obj, esp_socket_listen);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R231" data-line-number="231" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R232" data-line-number="232" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.accept()</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R233" data-line-number="233" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_accept</span>(<span class="pl-c1">mp_obj_t</span> self_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R234" data-line-number="234" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R235" data-line-number="235" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R236" data-line-number="236" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;connlist == <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R237" data-line-number="237" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">nlr_raise</span>(<span class="pl-c1">mp_obj_new_exception_msg</span>(&amp;mp_type_OSError,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R238" data-line-number="238" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-s"><span class="pl-pds">"</span>Not listening<span class="pl-pds">"</span></span>));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R239" data-line-number="239" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R240" data-line-number="240" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R241" data-line-number="241" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">do</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R242" data-line-number="242" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_uint_t</span> len;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R243" data-line-number="243" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_obj_t</span> *items;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R244" data-line-number="244" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R245" data-line-number="245" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_obj_list_get</span>(s-&gt;connlist, &amp;len, &amp;items);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R246" data-line-number="246" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-k">if</span> (len == <span class="pl-c1">0</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R247" data-line-number="247" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-k">break</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R248" data-line-number="248" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R249" data-line-number="249" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R250" data-line-number="250" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">esp_socket_obj_t</span> *rs = items[<span class="pl-c1">0</span>];</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R251" data-line-number="251" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_obj_list_remove</span>(s-&gt;connlist, rs);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R252" data-line-number="252" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-k">if</span> (rs-&gt;espconn-&gt;state != ESPCONN_CLOSE) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R253" data-line-number="253" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-k">return</span> rs;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R254" data-line-number="254" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R255" data-line-number="255" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    } <span class="pl-k">while</span> (<span class="pl-c1">true</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R256" data-line-number="256" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R257" data-line-number="257" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">nlr_raise</span>(<span class="pl-c1">mp_obj_new_exception_msg</span>(&amp;mp_type_OSError,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R258" data-line-number="258" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-s"><span class="pl-pds">"</span>No connection in queue<span class="pl-pds">"</span></span>));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R259" data-line-number="259" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R260" data-line-number="260" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_1</span>(esp_socket_accept_obj, esp_socket_accept);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R261" data-line-number="261" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R262" data-line-number="262" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.connect(address)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R263" data-line-number="263" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_connect</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> addr_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R264" data-line-number="264" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R265" data-line-number="265" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R266" data-line-number="266" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;espconn == <span class="pl-c1">NULL</span> || s-&gt;espconn-&gt;state != ESPCONN_NONE) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R267" data-line-number="267" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">nlr_raise</span>(<span class="pl-c1">mp_obj_new_exception_msg</span>(&amp;mp_type_OSError,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R268" data-line-number="268" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-s"><span class="pl-pds">"</span>Transport endpoint is already connected or closed<span class="pl-pds">"</span></span>));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R269" data-line-number="269" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R270" data-line-number="270" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R271" data-line-number="271" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_connectcb</span>(s-&gt;espconn, esp_socket_connect_callback_client);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R272" data-line-number="272" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_recvcb</span>(s-&gt;espconn, esp_socket_recv_callback);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R273" data-line-number="273" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_sentcb</span>(s-&gt;espconn, esp_socket_sent_callback);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R274" data-line-number="274" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_regist_disconcb</span>(s-&gt;espconn, esp_socket_disconnect_callback);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R275" data-line-number="275" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R276" data-line-number="276" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;espconn-&gt;proto.<span class="pl-smi">tcp</span>-&gt;remote_port =</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R277" data-line-number="277" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">netutils_parse_inet_addr</span>(addr_in, s-&gt;espconn-&gt;proto.<span class="pl-smi">tcp</span>-&gt;remote_ip,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R278" data-line-number="278" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            NETUTILS_BIG);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R279" data-line-number="279" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_connect</span>(s-&gt;espconn);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R280" data-line-number="280" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R281" data-line-number="281" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R282" data-line-number="282" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R283" data-line-number="283" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_connect_obj, esp_socket_connect);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R284" data-line-number="284" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R285" data-line-number="285" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.send(bytes)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R286" data-line-number="286" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_send</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> buf_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R287" data-line-number="287" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R288" data-line-number="288" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R289" data-line-number="289" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;espconn-&gt;state == ESPCONN_NONE || s-&gt;espconn-&gt;state == ESPCONN_CLOSE) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R290" data-line-number="290" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">nlr_raise</span>(<span class="pl-c1">mp_obj_new_exception_msg</span>(&amp;mp_type_OSError,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R291" data-line-number="291" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-s"><span class="pl-pds">"</span>Not connected<span class="pl-pds">"</span></span>));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R292" data-line-number="292" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R293" data-line-number="293" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R294" data-line-number="294" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_buffer_info_t</span> bufinfo;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R295" data-line-number="295" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_get_buffer_raise</span>(buf_in, &amp;bufinfo, MP_BUFFER_READ);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R296" data-line-number="296" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R297" data-line-number="297" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">espconn_sent</span>(s-&gt;espconn, bufinfo.<span class="pl-smi">buf</span>, bufinfo.<span class="pl-smi">len</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R298" data-line-number="298" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R299" data-line-number="299" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> <span class="pl-c1">mp_obj_new_int</span>(bufinfo.<span class="pl-smi">len</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R300" data-line-number="300" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R301" data-line-number="301" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_send_obj, esp_socket_send);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R302" data-line-number="302" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R303" data-line-number="303" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.recv(bufsize)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R304" data-line-number="304" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_recv</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> len_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R305" data-line-number="305" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R306" data-line-number="306" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R307" data-line-number="307" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;recvbuf == <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R308" data-line-number="308" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">nlr_raise</span>(<span class="pl-c1">mp_obj_new_exception_msg</span>(&amp;mp_type_OSError,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R309" data-line-number="309" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-s"><span class="pl-pds">"</span>No data available<span class="pl-pds">"</span></span>));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R310" data-line-number="310" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R311" data-line-number="311" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R312" data-line-number="312" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_uint_t</span> mxl = <span class="pl-c1">mp_obj_get_int</span>(len_in);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R313" data-line-number="313" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (mxl &gt;= s-&gt;recvbuf_len) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R314" data-line-number="314" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_obj_t</span> trt = <span class="pl-c1">mp_obj_new_bytes</span>(s-&gt;recvbuf, s-&gt;recvbuf_len);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R315" data-line-number="315" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">gc_free</span>(s-&gt;recvbuf);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R316" data-line-number="316" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        s-&gt;recvbuf = <span class="pl-c1">NULL</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R317" data-line-number="317" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-k">return</span> trt;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R318" data-line-number="318" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    } <span class="pl-k">else</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R319" data-line-number="319" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_obj_t</span> trt = <span class="pl-c1">mp_obj_new_bytes</span>(s-&gt;recvbuf, mxl);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R320" data-line-number="320" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">memmove</span>(s-&gt;recvbuf, &amp;s-&gt;recvbuf[mxl], s-&gt;recvbuf_len - mxl);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R321" data-line-number="321" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        s-&gt;recvbuf_len -= mxl;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R322" data-line-number="322" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        s-&gt;recvbuf = <span class="pl-c1">gc_realloc</span>(s-&gt;recvbuf, s-&gt;recvbuf_len);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R323" data-line-number="323" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-k">return</span> trt;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R324" data-line-number="324" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R325" data-line-number="325" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R326" data-line-number="326" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_recv_obj, esp_socket_recv);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R327" data-line-number="327" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R328" data-line-number="328" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.sendto(bytes, address)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R329" data-line-number="329" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_sendto</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> data_in, <span class="pl-c1">mp_obj_t</span> addr_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R330" data-line-number="330" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">nlr_raise</span>(<span class="pl-c1">mp_obj_new_exception_msg</span>(&amp;mp_type_OSError,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R331" data-line-number="331" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-s"><span class="pl-pds">"</span>UDP not supported.<span class="pl-pds">"</span></span>));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R332" data-line-number="332" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R333" data-line-number="333" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R334" data-line-number="334" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_3</span>(esp_socket_sendto_obj, esp_socket_sendto);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R335" data-line-number="335" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R336" data-line-number="336" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-c">// method socket.recvfrom(bufsize)</span></span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R337" data-line-number="337" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_recvfrom</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> len_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R338" data-line-number="338" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">nlr_raise</span>(<span class="pl-c1">mp_obj_new_exception_msg</span>(&amp;mp_type_OSError,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R339" data-line-number="339" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-s"><span class="pl-pds">"</span>UDP not supported.<span class="pl-pds">"</span></span>));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R340" data-line-number="340" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R341" data-line-number="341" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R342" data-line-number="342" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_recvfrom_obj, esp_socket_recvfrom);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R343" data-line-number="343" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R344" data-line-number="344" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_onconnect</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> lambda_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R345" data-line-number="345" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R346" data-line-number="346" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;cb_connect = lambda_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R347" data-line-number="347" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R348" data-line-number="348" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;connlist != <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R349" data-line-number="349" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-k">do</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R350" data-line-number="350" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-c1">mp_uint_t</span> len;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R351" data-line-number="351" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-c1">mp_obj_t</span> *items;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R352" data-line-number="352" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R353" data-line-number="353" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-c1">mp_obj_list_get</span>(s-&gt;connlist, &amp;len, &amp;items);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R354" data-line-number="354" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-k">if</span> (len == <span class="pl-c1">0</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R355" data-line-number="355" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+                <span class="pl-k">break</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R356" data-line-number="356" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R357" data-line-number="357" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R358" data-line-number="358" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-c1">esp_socket_obj_t</span> *rs = items[<span class="pl-c1">0</span>];</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R359" data-line-number="359" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-c1">mp_obj_list_remove</span>(s-&gt;connlist, rs);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R360" data-line-number="360" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-k">if</span> (s-&gt;espconn-&gt;state != ESPCONN_CLOSE) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R361" data-line-number="361" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+                <span class="pl-c1">call_function_1_protected</span>(s-&gt;cb_connect, rs);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R362" data-line-number="362" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R363" data-line-number="363" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        } <span class="pl-k">while</span> (<span class="pl-c1">true</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R364" data-line-number="364" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R365" data-line-number="365" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R366" data-line-number="366" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R367" data-line-number="367" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R368" data-line-number="368" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_onconnect_obj, esp_socket_onconnect);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R369" data-line-number="369" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R370" data-line-number="370" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_onrecv</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> lambda_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R371" data-line-number="371" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R372" data-line-number="372" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;cb_recv = lambda_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R373" data-line-number="373" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;recvbuf != <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R374" data-line-number="374" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">call_function_2_protected</span>(s-&gt;cb_recv, s,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R375" data-line-number="375" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            <span class="pl-c1">mp_obj_new_bytes</span>((byte *)s-&gt;recvbuf, s-&gt;recvbuf_len));</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R376" data-line-number="376" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        s-&gt;recvbuf = <span class="pl-c1">NULL</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R377" data-line-number="377" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R378" data-line-number="378" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R379" data-line-number="379" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R380" data-line-number="380" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_onrecv_obj, esp_socket_onrecv);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R381" data-line-number="381" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R382" data-line-number="382" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_socket_ondisconnect</span>(<span class="pl-c1">mp_obj_t</span> self_in, <span class="pl-c1">mp_obj_t</span> lambda_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R383" data-line-number="383" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">esp_socket_obj_t</span> *s = self_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R384" data-line-number="384" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    s-&gt;cb_disconnect = lambda_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R385" data-line-number="385" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R386" data-line-number="386" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (s-&gt;espconn-&gt;state == ESPCONN_CLOSE) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R387" data-line-number="387" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">call_function_1_protected</span>(s-&gt;cb_disconnect, s);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R388" data-line-number="388" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R389" data-line-number="389" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R390" data-line-number="390" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R391" data-line-number="391" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R392" data-line-number="392" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_2</span>(esp_socket_ondisconnect_obj, esp_socket_ondisconnect);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R393" data-line-number="393" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R394" data-line-number="394" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+<span class="pl-k">typedef</span> <span class="pl-k">struct</span> <span class="pl-c1">_esp_getaddrinfo_cb_struct_t</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R395" data-line-number="395" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_obj_t</span> lambda;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R396" data-line-number="396" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_uint_t</span> port;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R397" data-line-number="397" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+} <span class="pl-c1">esp_getaddrinfo_cb_struct_t</span>;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R398" data-line-number="398" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R399" data-line-number="399" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">esp_getaddrinfo_cb_struct_t</span> esp_getaddrinfo_cb_struct;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R400" data-line-number="400" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R401" data-line-number="401" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">void</span> <span class="pl-en">esp_getaddrinfo_cb</span>(<span class="pl-k">const</span> <span class="pl-k">char</span> *name, <span class="pl-c1">ip_addr_t</span> *ipaddr, <span class="pl-k">void</span> *arg) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R402" data-line-number="402" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_obj_t</span> namestr = <span class="pl-c1">mp_obj_new_str</span>(name, <span class="pl-c1">strlen</span>(name), <span class="pl-c1">true</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R403" data-line-number="403" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (ipaddr != <span class="pl-c1">NULL</span>) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R404" data-line-number="404" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">uint8_t</span> ip[<span class="pl-c1">4</span>];</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R405" data-line-number="405" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        ip[<span class="pl-c1">0</span>] = (ipaddr-&gt;addr &gt;&gt; <span class="pl-c1">24</span>) &amp; 0xff;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R406" data-line-number="406" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        ip[<span class="pl-c1">1</span>] = (ipaddr-&gt;addr &gt;&gt; <span class="pl-c1">16</span>) &amp; 0xff;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R407" data-line-number="407" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        ip[<span class="pl-c1">2</span>] = (ipaddr-&gt;addr &gt;&gt;  <span class="pl-c1">8</span>) &amp; 0xff;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R408" data-line-number="408" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        ip[<span class="pl-c1">3</span>] = (ipaddr-&gt;addr &gt;&gt;  <span class="pl-c1">0</span>) &amp; 0xff;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R409" data-line-number="409" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R410" data-line-number="410" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">mp_obj_tuple_t</span> *tuple = <span class="pl-c1">mp_obj_new_tuple</span>(<span class="pl-c1">5</span>, <span class="pl-c1">NULL</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R411" data-line-number="411" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R412" data-line-number="412" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        tuple-&gt;items[<span class="pl-c1">0</span>] = <span class="pl-c1">MP_OBJ_NEW_SMALL_INT</span>(<span class="pl-c1">0</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R413" data-line-number="413" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        tuple-&gt;items[<span class="pl-c1">1</span>] = <span class="pl-c1">MP_OBJ_NEW_SMALL_INT</span>(<span class="pl-c1">0</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R414" data-line-number="414" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        tuple-&gt;items[<span class="pl-c1">2</span>] = <span class="pl-c1">MP_OBJ_NEW_SMALL_INT</span>(<span class="pl-c1">0</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R415" data-line-number="415" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        tuple-&gt;items[<span class="pl-c1">3</span>] = <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R416" data-line-number="416" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        tuple-&gt;items[<span class="pl-c1">4</span>] = <span class="pl-c1">netutils_format_inet_addr</span>(ip,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R417" data-line-number="417" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+            esp_getaddrinfo_cb_struct.<span class="pl-smi">port</span>, NETUTILS_BIG);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R418" data-line-number="418" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">call_function_2_protected</span>(esp_getaddrinfo_cb_struct.<span class="pl-smi">lambda</span>, namestr, tuple);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R419" data-line-number="419" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    } <span class="pl-k">else</span> {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R420" data-line-number="420" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">call_function_2_protected</span>(esp_getaddrinfo_cb_struct.<span class="pl-smi">lambda</span>, namestr, mp_const_none);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R421" data-line-number="421" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R422" data-line-number="422" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R423" data-line-number="423" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R424" data-line-number="424" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-c1">mp_obj_t</span> <span class="pl-en">esp_getaddrinfo</span>(<span class="pl-c1">mp_obj_t</span> host_in, <span class="pl-c1">mp_obj_t</span> port_in,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R425" data-line-number="425" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_obj_t</span> lambda_in) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R426" data-line-number="426" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">mp_uint_t</span> hlen;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R427" data-line-number="427" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">const</span> <span class="pl-k">char</span> *host = <span class="pl-c1">mp_obj_str_get_data</span>(host_in, &amp;hlen);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R428" data-line-number="428" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">ip_addr_t</span> ipaddr;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R429" data-line-number="429" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R430" data-line-number="430" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    esp_getaddrinfo_cb_struct.<span class="pl-smi">lambda</span> = lambda_in;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R431" data-line-number="431" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    esp_getaddrinfo_cb_struct.<span class="pl-smi">port</span> = <span class="pl-c1">mp_obj_get_int</span>(port_in);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R432" data-line-number="432" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R433" data-line-number="433" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-c1">err_t</span> ret = <span class="pl-c1">espconn_gethostbyname</span>(<span class="pl-c1">NULL</span>, host, &amp;ipaddr,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R434" data-line-number="434" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        esp_getaddrinfo_cb);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R435" data-line-number="435" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R436" data-line-number="436" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">if</span> (ret == ESPCONN_OK) {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R437" data-line-number="437" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+        <span class="pl-c1">esp_getaddrinfo_cb</span>(host, &amp;ipaddr, <span class="pl-c1">NULL</span>);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R438" data-line-number="438" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    }</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R439" data-line-number="439" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R440" data-line-number="440" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    <span class="pl-k">return</span> mp_const_none;</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R441" data-line-number="441" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+}</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R442" data-line-number="442" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_FUN_OBJ_3</span>(esp_getaddrinfo_obj, esp_getaddrinfo);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R443" data-line-number="443" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R444" data-line-number="444" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">const</span> <span class="pl-c1">mp_map_elem_t</span> esp_socket_locals_dict_table[] = {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R445" data-line-number="445" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR___del__), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket___del___obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R446" data-line-number="446" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_close), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_close_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R447" data-line-number="447" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_bind), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_bind_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R448" data-line-number="448" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_listen), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_listen_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R449" data-line-number="449" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_accept), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_accept_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R450" data-line-number="450" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_connect), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_connect_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R451" data-line-number="451" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_send), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_send_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R452" data-line-number="452" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_recv), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_recv_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R453" data-line-number="453" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_sendto), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_sendto_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R454" data-line-number="454" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_recvfrom), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_recvfrom_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R455" data-line-number="455" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_onconnect), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_onconnect_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R456" data-line-number="456" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_onrecv), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_onrecv_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R457" data-line-number="457" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_ondisconnect), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_ondisconnect_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R458" data-line-number="458" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+};</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R459" data-line-number="459" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-en">MP_DEFINE_CONST_DICT</span>(esp_socket_locals_dict, esp_socket_locals_dict_table);</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R460" data-line-number="460" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R461" data-line-number="461" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+STATIC <span class="pl-k">const</span> <span class="pl-c1">mp_obj_type_t</span> esp_socket_type = {</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R462" data-line-number="462" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { &amp;mp_type_type },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R463" data-line-number="463" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    .<span class="pl-smi">name</span> = MP_QSTR_socket,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R464" data-line-number="464" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    .<span class="pl-smi">make_new</span> = esp_socket_make_new,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R465" data-line-number="465" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    .<span class="pl-smi">locals_dict</span> = (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_locals_dict,</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R466" data-line-number="466" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+};</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L38" data-line-number="38" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R467" data-line-number="467" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> </span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L39" data-line-number="39" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R468" data-line-number="468" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> <span class="pl-c">// Singleton instance of scan callback, meaning that there can be only</span></span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L40" data-line-number="40" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R469" data-line-number="469" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> <span class="pl-c">// one concurrent AP scan.</span></span>

  </td>
</tr>


      <tr class="js-expandable-line" data-position="438">
    <td class="blob-num blob-num-expandable" colspan="2">
      <a href="#diff-61309edb43a99b782d081351c5c602d1" class="diff-expander js-expand" title="Expand" aria-label="Expand" data-url="/micropython/micropython/blob_excerpt/ff5d401d92fe483bee5dcf837da8f048b2897ae3?diff=unified&amp;left_hunk_size=16&amp;mode=100644&amp;next_line_num_left=46&amp;next_line_num_right=475&amp;path=esp8266%2Fmodesp.c&amp;prev_line_num_left=40&amp;prev_line_num_right=469&amp;right_hunk_size=6" data-left-range="41-45" data-right-range="470-474">
        <svg aria-hidden="true" class="octicon octicon-unfold" role="img" version="1.1" viewbox="0 0 14 16"><path d="M11.5 8.5l2.5 2.5c0 0.55-0.45 1-1 1H9v-1h3.5L10.5 9H3.5L1.5 11h3.5v1H1c-0.55 0-1-0.45-1-1l2.5-2.5L0 6c0-0.55 0.45-1 1-1h4v1H1.5l2 2h7l2-2H9v-1h4c0.55 0 1 0.45 1 1L11.5 8.5z m-5.5-1.5h2V4h2L7 1 4 4h2v3z m2 3H6v3H4l3 3 3-3H8V10z"/></svg>
      </a>
    </td>
    <td class="blob-code blob-code-inner blob-code-hunk">@@ -46,16 +475,6 @@ static void error_check(bool status, const char *msg) {</td>
  </tr>

    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L46" data-line-number="46" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R475" data-line-number="475" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner">     }</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L47" data-line-number="47" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R476" data-line-number="476" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> }</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L48" data-line-number="48" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R477" data-line-number="477" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> </span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L49" data-line-number="49" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-<span class="pl-c1">mp_obj_t</span> <span class="pl-en">call_function_1_protected</span>(<span class="pl-c1">mp_obj_t</span> fun, <span class="pl-c1">mp_obj_t</span> arg) {</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L50" data-line-number="50" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-    <span class="pl-c1">nlr_buf_t</span> nlr;</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L51" data-line-number="51" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-    <span class="pl-k">if</span> (<span class="pl-c1">nlr_push</span>(&amp;nlr) == <span class="pl-c1">0</span>) {</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L52" data-line-number="52" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-        <span class="pl-k">return</span> <span class="pl-c1">mp_call_function_1</span>(fun, arg);</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L53" data-line-number="53" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-    } <span class="pl-k">else</span> {</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L54" data-line-number="54" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-        <span class="pl-c1">mp_obj_print_exception</span>(&amp;mp_plat_print, (<span class="pl-c1">mp_obj_t</span>)nlr.<span class="pl-smi">ret_val</span>);</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L55" data-line-number="55" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-        <span class="pl-k">return</span> (<span class="pl-c1">mp_obj_t</span>)nlr.<span class="pl-smi">ret_val</span>;</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L56" data-line-number="56" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-    }</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L57" data-line-number="57" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-}</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L58" data-line-number="58" class="blob-num blob-num-deletion js-linkable-line-number"/>

    <td class="blob-num blob-num-deletion empty-cell"/>

  <td class="blob-code blob-code-deletion">

    <span class="blob-code-inner">-</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L59" data-line-number="59" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R478" data-line-number="478" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> STATIC <span class="pl-k">void</span> <span class="pl-en">esp_scan_cb</span>(scaninfo *si, STATUS status) {</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L60" data-line-number="60" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R479" data-line-number="479" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner">     <span class="pl-c">//printf("in pyb_scan_cb: %d, si=%p, si-&gt;pbss=%p\n", status, si, si-&gt;pbss);</span></span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L61" data-line-number="61" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R480" data-line-number="480" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner">     <span class="pl-k">struct</span> bss_info *bs;</span>

  </td>
</tr>


      <tr class="js-expandable-line" data-position="455">
    <td class="blob-num blob-num-expandable" colspan="2">
      <a href="#diff-61309edb43a99b782d081351c5c602d1" class="diff-expander js-expand" title="Expand" aria-label="Expand" data-url="/micropython/micropython/blob_excerpt/ff5d401d92fe483bee5dcf837da8f048b2897ae3?diff=unified&amp;left_hunk_size=6&amp;mode=100644&amp;next_line_num_left=116&amp;next_line_num_right=535&amp;path=esp8266%2Fmodesp.c&amp;prev_line_num_left=61&amp;prev_line_num_right=480&amp;right_hunk_size=8" data-left-range="62-115" data-right-range="481-534">
        <svg aria-hidden="true" class="octicon octicon-unfold" role="img" version="1.1" viewbox="0 0 14 16"><path d="M11.5 8.5l2.5 2.5c0 0.55-0.45 1-1 1H9v-1h3.5L10.5 9H3.5L1.5 11h3.5v1H1c-0.55 0-1-0.45-1-1l2.5-2.5L0 6c0-0.55 0.45-1 1-1h4v1H1.5l2 2h7l2-2H9v-1h4c0.55 0 1 0.45 1 1L11.5 8.5z m-5.5-1.5h2V4h2L7 1 4 4h2v3z m2 3H6v3H4l3 3 3-3H8V10z"/></svg>
      </a>
    </td>
    <td class="blob-code blob-code-inner blob-code-hunk">@@ -116,6 +535,8 @@ STATIC const mp_map_elem_t esp_module_globals_table[] = {</td>
  </tr>

    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L116" data-line-number="116" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R535" data-line-number="535" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner">     { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_disconnect), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_disconnect_obj },</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L117" data-line-number="117" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R536" data-line-number="536" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner">     { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_scan), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_scan_obj },</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L118" data-line-number="118" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R537" data-line-number="537" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner">     { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_status), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_status_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R538" data-line-number="538" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_getaddrinfo), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_getaddrinfo_obj },</span>

  </td>
</tr>


    <tr>
    <td class="blob-num blob-num-addition empty-cell"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R539" data-line-number="539" class="blob-num blob-num-addition js-linkable-line-number"/>

  <td class="blob-code blob-code-addition">

    <span class="blob-code-inner">+    { <span class="pl-c1">MP_OBJ_NEW_QSTR</span>(MP_QSTR_socket), (<span class="pl-c1">mp_obj_t</span>)&amp;esp_socket_type },</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L119" data-line-number="119" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R540" data-line-number="540" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> };</span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L120" data-line-number="120" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R541" data-line-number="541" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> </span>

  </td>
</tr>


    <tr>
    <td id="diff-61309edb43a99b782d081351c5c602d1L121" data-line-number="121" class="blob-num blob-num-context js-linkable-line-number"/>

    <td id="diff-61309edb43a99b782d081351c5c602d1R542" data-line-number="542" class="blob-num blob-num-context js-linkable-line-number"/>

  <td class="blob-code blob-code-context">

    <span class="blob-code-inner"> STATIC <span class="pl-en">MP_DEFINE_CONST_DICT</span>(esp_module_globals, esp_module_globals_table);</span>

  </td>
</tr>


  <tr class="js-expandable-line">
   <td class="blob-num blob-num-expandable" colspan="2">
     <a href="#diff-61309edb43a99b782d081351c5c602d1" class="diff-expander js-expand" title="Expand" aria-label="Expand" data-url="/micropython/micropython/blob_excerpt/ff5d401d92fe483bee5dcf837da8f048b2897ae3?diff=unified&amp;mode=100644&amp;path=esp8266%2Fmodesp.c&amp;prev_line_num_left=121&amp;prev_line_num_right=542" data-left-range="122-548" data-right-range="543-548">
       <svg aria-hidden="true" class="octicon octicon-unfold" role="img" version="1.1" viewbox="0 0 14 16"><path d="M11.5 8.5l2.5 2.5c0 0.55-0.45 1-1 1H9v-1h3.5L10.5 9H3.5L1.5 11h3.5v1H1c-0.55 0-1-0.45-1-1l2.5-2.5L0 6c0-0.55 0.45-1 1-1h4v1H1.5l2 2h7l2-2H9v-1h4c0.55 0 1 0.45 1 1L11.5 8.5z m-5.5-1.5h2V4h2L7 1 4 4h2v3z m2 3H6v3H4l3 3 3-3H8V10z"/></svg>
     </a>
   </td>
   <td class="blob-code blob-code-expandable"/>
  </tr>

              </table>
            </div></body></html>