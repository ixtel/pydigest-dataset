<html><body><div><div id="usage">
<h2>Usage</h2>
<p>All you have to do is import the module and start using it. There is no need
for initialization. Therefore, a code block such as the one below is enough to
get an RWLock instance.</p>
<pre><span class="kn">from</span> <span class="nn">prwlock</span> <span class="kn">import</span> <span class="n">RWLock</span>

<span class="n">rwlock</span> <span class="o">=</span> <span class="n">RWLock</span><span class="p">()</span>
</pre>
<p>The RWLock itself is pickleable and, therefore, can be passed around to child processes,
such as in the code block below.</p>
<pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="kn">from</span> <span class="nn">prwlock</span> <span class="kn">import</span> <span class="n">RWLock</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">rwlock</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="s1">'Acquiring read lock'</span><span class="p">)</span>
        <span class="n">rwlock</span><span class="o">.</span><span class="n">acquire_read</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="s1">'Sleeping for a while'</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="s1">'Releasing lock'</span><span class="p">)</span>
        <span class="n">rwlock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">RWLock</span><span class="p">()</span>
<span class="n">children</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">children</span><span class="p">)</span>
<span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">children</span><span class="p">):</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="p">])</span>
</pre>
</div>
</div></body></html>