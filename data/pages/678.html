<html><body><div><div class="col-xs-9">
                                <p align="center">
 
</p>
<div align="center">
<img src="http://pythonthusiast.pythonblogs.com/gallery/230/311-Screenshot_1.png" alt="Heroku Office Entrance"/>
<p>
Heroku Office Entrance<br/>
Pulled out the image from <a href="http://www.slideshare.net/ayumin/heroku-inside">here</a>.
</p>
<p>
 
</p>
</div>
<p align="justify">
This is yet another article in this series that shows a practical hands-on using another Python Cloud Computing solution there existed in our planet: <a href="http://www.heroku.com">Heroku</a>. We will going to try to publish our Openshift's <a href="http://pythonthusiast.pythonblogs.com/230_pythonthusiast/categories/390_flask_biography_tutorial.html">Flask Biography application</a> in Heroku, and along the way --it's unavoidable-- we will compare the process with <a href="http://www.openshift.com">Openshift</a>, which due to Openshift's generosity in offering 1 GB free plan (including database and user uploaded files!), I still think Openshift is the best Python Cloud Computing platform for developers out there. I got to remind you though, I am not talking in term of its performance comparison in handling multitude number of visitors. We are just going to find out how to create, deploy and manage application installed in Heroku. The branch that we are going to use, is the Blueprints branch in our public <a href="https://github.com/pythonthusiast/bio/tree/blueprints">pythonthusiast/bio</a> Github repository. 
</p>
<p align="justify">
Great, lets get started!
</p><h2>Heroku Usage at a Glance</h2>
<h3>Prepare Local Workstation</h3>
<p align="justify">
First of all, <a href="https://signup.heroku.com/signup/dc">signup to Heroku</a> and install its <a href="https://toolbelt.heroku.com/">heroku toolbelt</a> according to your Operating System. Open your command prompt/terminal and type: <code>heroku login</code>. Follow its login process obediently and upon successful, you will be able to issue <code>heroku</code> command to create or manage your deployed application. 
</p>
<p align="justify">
PS: If this is your first time working for a PaaS/cloud computing environment, or if you have never use Git before, chance are that you don't have an <a href="https://devcenter.heroku.com/articles/keys">SSH key</a>. Don't worry about that. <code>heroku login</code> command will detect your current working environment, and depending on that, it will offer to create a pair of private/public SSH key. But, it seems like it will not upload an existing SSH key. For that, you have to manually upload your SSH key located at <code>~/.ssh/id_rsa.pub</code> into your <a href="https://dashboard.heroku.com/account">Heroku Dashboard</a>. 
</p>
<h3>Prepare Simple Flask Application</h3>
<p align="justify">
Before we begin on hosting our previous Biography Flask application in Heroku, we are going to test it with a small Flask application. First, let's make sure we have Flask package installed first:
</p>
<p align="justify">
</p>
<table class="python code"><tbody><tr class="li1"><td><pre>1
2
3
</pre></td><td><pre>$ pip install Flask <span>#you can skip this step if you have already installed Flask in your working Python environment, or use virtualenv instead</span>
$ mkdir flaskmyheroku
$ <span>cd</span> flaskmyheroku/</pre></td></tr></tbody></table>
<p> 
</p>
<p align="justify">
Create a Python module, name it <code>hello.py</code>, with this content: 
</p>
<p align="justify">
</p>
<table class="python code"><tbody><tr class="li1"><td><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td><pre><span>import</span> <span>os</span>
<span>from</span> flask <span>import</span> Flask
 
app <span>=</span> Flask<span>(</span>__name__<span>)</span>
 
<span>@</span>app.<span>route</span><span>(</span><span>'/'</span><span>)</span>
<span>def</span> hello<span>(</span><span>)</span>:
    <span>return</span> <span>'Hello World!'</span>
 
<span>if</span> __name__ <span>==</span> <span>'__main__'</span>:
    app.<span>run</span><span>(</span><span>'0.0.0.0'</span><span>,</span> <span>8888</span><span>)</span></pre></td></tr></tbody></table>
<p> 
</p>
<p align="justify">
Run it!
</p>
<p align="justify">
</p>
<table class="python code"><tbody><tr class="li1"><td><pre>1
2
</pre></td><td><pre>$ python hello.<span>py</span>
 * Running on http://0.0.0.0:<span>8888</span>/</pre></td></tr></tbody></table>
<p> 
</p>
<p align="justify">
Great! Although the application is simple enough, it is already a WSGI aware application and can run easily from the command line or hosted in WSGI enabled web server. 
</p>
<p align="justify">
Another point to note is, have a look at this <a href="https://devcenter.heroku.com/articles/getting-started-with-python">Flask quick start application</a> explained in Heroku dev center. If you have already read it and then compare it with the above simple flask application, you'll notice that I don't use <code>foreman</code> to start the application. I have a very good reason of avoiding <code>foreman</code>: I simply can't use it to start the application. <a href="http://stackoverflow.com/questions/15399637/cant-start-foreman-in-heroku-tutorial-using-python?rq=1">Several solution</a> which basically told to install Heroku toolbelt to directory not contains spaces and use <code>foreman</code> version 0.61, is not working for me. Thereby, I simply skip of using <code>foreman</code> to start the application. 
</p>
<h3>Make Application Runnable in Heroku </h3>
<p align="justify">
But, how do we make this application runnable in Heroku? Differ with Openshift that use <a href="http://pythonthusiast.pythonblogs.com/230_pythonthusiast/archive/1366_flask_biography_tutorial_part_xiii-structuring_project_to_support_larger_flask_application.html">uWSGI as its WSGI server</a>, Heroku use <a href="http://gunicorn.org/">gunicorn</a> as its WSGI server for Python application. gunicorn needs to have a regular text file named <code>Procfile</code> file to be existed in your application root directory that contains definition of your startup Python module. Here is the content of a valid <code>Procfile</code> file:
</p>
<p align="justify">
</p>
<table class="python code"><tbody><tr class="li1"><td><pre>1
</pre></td><td><pre>web: gunicorn hello:app</pre></td></tr></tbody></table>
<p> 
</p>
<p>
It told gunicorn that we have a web application from <code>hello</code> module (a.k.a <code>hello.py</code> Python file), with a WSGI application named <code>app</code>. Please remember from our <a href="http://pythonthusiast.pythonblogs.com/pythonthusiast.pythonblogs.com/230_pythonthusiast/archive/1366_flask_biography_tutorial_part_xiii-structuring_project_to_support_larger_flask_application.html">previous discussion</a>, that the above <code>if __name__ == '__main__':</code> code will only got executed if <code>hello</code> module was run from the command line. As this <code>hello</code> module will be run by gunicorn, it won't bother with this line.
</p>
<p align="justify">
Now that Heroku know what is your startup module, how do we tell Heroku what Python packages that our application need? Simple. We need another regular text file named <code>requirements.txt</code> that also reside in our application root directory. This file will be use by Heroku to run <code>pip</code> (Python package management system), and prepare all dependent packages needed by your application into local working Python environment. <a href="http://www.pip-installer.org/en/1.1/requirements.html"><code>requirements.txt</code></a> contains the same semantic entry (but different format) to what it is in Openshift's <a href="https://pythonhosted.org/an_example_pypi_project/setuptools.html"><code>setup.py</code></a> needed by <a href="https://pythonhosted.org/setuptools/"><code>setuptools</code></a>, which is also another Python package management system. Here is the content of <code>requirements.txt</code> needed by our simple Flask application above:
</p>
<p align="justify">
</p>
<table class="python code"><tbody><tr class="li1"><td><pre>1
2
</pre></td><td><pre>Flask<span>==</span>0.10.1
gunicorn<span>==</span>0.17.2</pre></td></tr></tbody></table>
<p> 
</p>
<p align="justify">
And those are the steps needed to make every Python web application runnable in Heroku.
</p>
<h3>Create Heroku Application </h3>
<p>
This subsection is interesting: it will be quick. Don't believe me? Here goes the commands needed to host the above simple Flask application:
</p>
<p>
</p>
<table class="python code"><tbody><tr class="li1"><td><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td><pre>$ git init
Initialized empty Git repository <span>in</span> c:/Users/Eko Wibowo/__sandbox__/herokuflask/.<span>git</span>/
 
$ git add . -A
 
$ git commit -m<span>'initial commit'</span>
<span>[</span>master <span>(</span>root-commit<span>)</span> <span>0766188</span><span>]</span> initial commit
 create mode <span>100644</span> .<span>gitignore</span>
 create mode <span>100644</span> Procfile
 create mode <span>100644</span> hello.<span>py</span>
 create mode <span>100644</span> requirements.<span>txt</span>
 
$ heroku create herokuflask
Creating herokuflask... <span>done</span><span>,</span> stack <span>is</span> cedar
http://herokuflask.<span>herokuapp</span>.<span>com</span>/ | git<span>@</span>heroku.<span>com</span>:herokuflask.<span>git</span>
Git remote heroku added
 
$ git push heroku master
Initializing repository<span>,</span> done.
<span>Counting</span> objects: <span>6</span><span>,</span> done.
<span>Delta</span> compression using up to <span>4</span> threads.
<span>Compressing</span> objects: <span>100</span>% <span>(</span><span>4</span>/<span>4</span><span>)</span><span>,</span> done.
<span>Writing</span> objects: <span>100</span>% <span>(</span><span>6</span>/<span>6</span><span>)</span><span>,</span> <span>2.14</span> KiB | <span>0</span> <span>bytes</span>/s<span>,</span> done.
<span>Total</span> <span>6</span> <span>(</span>delta <span>0</span><span>)</span><span>,</span> reused <span>0</span> <span>(</span>delta <span>0</span><span>)</span>
 
-----<span>&gt;</span> Python app detected
-----<span>&gt;</span> No runtime.<span>txt</span> provided<span>;</span> assuming python-2.7.6.
-----<span>&gt;</span> Preparing Python runtime <span>(</span>python-2.7.6<span>)</span>
-----<span>&gt;</span> Installing Setuptools <span>(</span><span>2.1</span><span>)</span>
-----<span>&gt;</span> Installing Pip <span>(</span>1.5.4<span>)</span>
-----<span>&gt;</span> Installing dependencies using Pip <span>(</span>1.5.4<span>)</span>
-----<span>&gt;</span> Discovering process <span>types</span>
       Procfile declares <span>types</span> -<span>&gt;</span> web
-----<span>&gt;</span> Compressing... <span>done</span><span>,</span> 30.4MB
-----<span>&gt;</span> Launching... <span>done</span><span>,</span> v3
       http://herokuflask.<span>herokuapp</span>.<span>com</span>/ deployed to Heroku
 
To git<span>@</span>heroku.<span>com</span>:herokuflask.<span>git</span>
 * <span>[</span><span>new</span> branch<span>]</span>      master -<span>&gt;</span> master
 
$ </pre></td></tr></tbody></table>
<p> 
</p>
<p align="justify">
DONE. 
</p>
<p align="justify">
Now you can navigate to <a href="http://herokuflask.herokuapp.com/">http://herokuflask.herokuapp.com</a> and see its live in action!
</p>
<p align="justify">
To sum up the above process, first we initialized an empty git repository in the current directory where our simple Flask application reside. Next we create a Heroku application named <code>herokuflask</code>, which will be automatically hosted in the domain <a href="http://herokuflask.herokuapp.com/">http://herokuflask.herokuapp.com</a> (when you have git push-ed your application of course). The process will also add remote git repository named <code>heroku</code>, which then you use it to push your application to heroku: making it live in the internet! 
</p>
<p align="justify">
Straightforward, isn't it? The only obstacle that I can think of, is if you haven't uploaded (or even created!) your public SSH key to your Heroku account. I think I will specifically address this matter in another article. It's an introductory material that I seems to be skipped throughout articles in this site. Pardon for that...
</p>
<p align="justify">
Another point to note is, differ with Openshift, the application created in Heroku will not using specific user domain. So, if you create Heroku application by simply copy pasting the above code: <code>heroku create herokuflask</code>, you will be in trouble. I have already created an application with that name! In Openshift, the similar action will result in an application that will be hosted in http://herokuflask-ekowibowo.herokuapp.com. And it will have different URL based on your user domain. Simple, yet useful <img src="http://pythonthusiast.pythonblogs.com/js/tinymce/plugins/emotions/images/smiley-smile.gif" border="0" alt="Smile" title="Smile"/>
</p>
<h2>What's Next?<br/>
</h2>
<p align="justify">
At first, I woud like to use a single article that talk about how to use Heroku as your Python Cloud Computing solution. I feels like going to treat is as my first article in this series : <a href="http://pythonthusiast.pythonblogs.com/230_pythonthusiast/archive/1360_python_cloud_computing_1_practical_hands-on_using_pythonanywhere.html">PythonAnywhere</a>. But the truth is, Heroku is not as easy and as straightforward to use as PythonAnywhere, where you don't have to prepare any local workstation. In this regard, Heroku is much like Openshift (or it must be the other way round, as Openshift was born after Heroku). 
</p>
<p align="justify">
Therefore, I split the discussion of hosting our Flask Biography application to Heroku in the next subsequent article in this series.
</p>
<p align="justify">
Stay tuned! 
</p>
<p align="justify">
 
</p>
<p align="justify">
 
</p>
<p>
 
</p>
<p>
 
</p>
<p align="justify">
 
</p>


                

            </div>

            </div></body></html>