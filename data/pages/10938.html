<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Table of Contents</h1>



<h1><a id="user-content-introduction" class="anchor" href="#introduction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Introduction</h1>

<p>FIRMADYNE is an automated and scalable system for performing emulation and
dynamic analysis of Linux-based embedded firmware. It includes the following
components:</p>

<ul>
<li>modified kernels (MIPS: <a href="https://github.com/firmadyne/kernel-v2.6.32">v2.6.32</a>,
ARM: <a href="https://github.com/firmadyne/kernel-v4.1">v4.1</a>,
<a href="https://github.com/firmadyne/kernel-v3.10">v3.10</a>) for instrumentation of
firmware execution;</li>
<li>a userspace <a href="https://github.com/firmadyne/libnvram">NVRAM library</a> to emulate
a hardware NVRAM peripheral;</li>
<li>an <a href="https://github.com/firmadyne/extractor">extractor</a> to extract a
filesystem and kernel from downloaded firmware;</li>
<li>a small <a href="https://github.com/firmadyne/console">console</a> application to spawn
an additional shell for debugging;</li>
<li>and a <a href="https://github.com/firmadyne/scraper">scraper</a> to download firmware from
42+ different vendors.</li>
</ul>

<p>We have also written the following three basic automated analyses
using the FIRMADYNE system.</p>

<ul>
<li>Accessible Webpages: This script iterates through each file
within the filesystem of a firmware image that appears to be served by a
webserver, and aggregates the results based on whether they appear to required
authentication.</li>
<li>SNMP Information: This script dumps the contents of the
<code>public</code> and <code>private</code> SNMP v2c communities to disk using no credentials.</li>
<li>Vulnerability Check: This script tests for the presence
of 74 vulnerabilities using exploits from Metasploit and other sources.</li>
</ul>

<p>In our 2016 <a href="http://www.internetsociety.org/events/ndss-symposium">Network and Distributed System Security Symposium (NDSS)</a>
paper, titled <a href="https://github.com/firmadyne/firmadyne/blob/master/paper/paper.pdf">Towards Automated Dynamic Analysis for Linux-based Embedded Firmware</a>, we evaluated the FIRMADYNE
system over a dataset of 23,035 firmware images, of which we were able to
extract 9,486. Using 60 exploits from the <a href="https://github.com/rapid7/metasploit-framework">Metasploit Framework</a>,
and 14 previously-unknown vulnerabilities that we discovered, we showed that
846 out of 1,971 (43%) firmware images were vulnerable to at least one exploit,
which we estimate to affect 89+ different products. For more details, refer to
our paper linked above.</p>

<p><strong>Note</strong>: This project is a research tool, and is currently not production ready.
In particular, some components are quite immature and rough. We suggest
running the system within a virtual machine. No support is offered, but pull
requests are greatly appreciated, whether for documentation, tests, or code!</p>

<h1><a id="user-content-setup" class="anchor" href="#setup" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Setup</h1>

<p>The following has been tested on a Ubuntu 14.04 machine. Other Debian-based
systems should also be compatible.</p>

<p>First, clone this repository recursively and install its dependencies.</p>

<ol>
<li><code>sudo apt-get install busybox-static fakeroot git kpartx netcat-openbsd nmap python-psycopg2 python3-psycopg2 snmp uml-utilities util-linux vlan</code></li>
<li><code>git clone --recursive https://github.com/firmadyne/firmadyne.git</code></li>
</ol>

<h2><a id="user-content-extractor" class="anchor" href="#extractor" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Extractor</h2>

<p>The extractor depends on the <a href="https://github.com/devttys0/binwalk">binwalk</a>
tool, so we need to install that and its dependencies.</p>

<ol>
<li><code>git clone https://github.com/devttys0/binwalk.git</code></li>
<li><code>sudo ./binwalk/deps.sh</code></li>
<li><code>sudo python ./binwalk/setup.py install</code>

<ul>
<li>For Python 2.x, <code>sudo apt-get install python-lzma</code></li>
</ul></li>
<li><code>sudo -H pip install git+https://github.com/ahupp/python-magic</code></li>
<li>Instead of <a href="https://github.com/sviehb/jefferson">upstream jefferson</a>, it is
recommended to install our <a href="https://github.com/firmadyne/jefferson">jefferson fork</a>,
which supports extraction of additional file and compression types.</li>
<li>Optionally, instead of <a href="https://github.com/devttys0/sasquatch">upstream sasquatch</a>,
our <a href="https://github.com/firmadyne/sasquatch">sasquatch fork</a> can be used to
prevent false positives by making errors fatal.</li>
</ol>

<h2><a id="user-content-database" class="anchor" href="#database" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Database</h2>

<p>Next, install, set up, and configure the database.</p>

<ol>
<li><code>sudo apt-get install postgresql</code></li>
<li><code>sudo -u postgres createuser -P firmadyne</code>, with password <code>firmadyne</code></li>
<li><code>sudo -u postgres createdb -O firmadyne firmware</code></li>
<li><code>sudo -u postgres psql -d firmware &lt; ./firmadyne/database/schema</code></li>
</ol>

<h2><a id="user-content-binaries" class="anchor" href="#binaries" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Binaries</h2>

<p>To download our pre-built binaries for all components, run the following script:</p>

<ul>
<li><code>cd ./firmadyne; ./download.sh</code></li>
</ul>

<p>Alternatively, refer to the instructions <a href="#compiling-from-source">below</a> to compile from source.</p>

<h2><a id="user-content-qemu" class="anchor" href="#qemu" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>QEMU</h2>

<p>To use <a href="http://wiki.qemu.org/Main_Page">QEMU</a> provided by your distribution:</p>

<ul>
<li><code>sudo apt-get install qemu-system-arm qemu-system-mips qemu-utils</code></li>
</ul>

<p>Alternatively, use our <a href="https://github.com/firmadyne/qemu-linaro">modified version</a>
of <a href="https://git.linaro.org/?p=qemu/qemu-linaro.git">qemu-linaro</a> for certain
firmware with an <code>alphafs</code> webserver that assumes a fixed memory mapping (not
recommended), or <a href="https://github.com/qemu/qemu">upstream qemu</a>.</p>

<h1><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h1>

<ol>
<li>Set <code>FIRMWARE_DIR</code> in <code>firmadyne.config</code> to point to the root of this repository.</li>
<li>Download a firmware image, e.g. <a href="http://www.downloads.netgear.com/files/GDC/WNAP320/WNAP320%20Firmware%20Version%202.0.3.zip">v2.0.3</a> for <a href="http://www.netgear.com/business/products/wireless/business-wireless/wnap320.aspx">Netgear WNAP320</a>.

<ul>
<li><code>wget http://www.downloads.netgear.com/files/GDC/WNAP320/WNAP320%20Firmware%20Version%202.0.3.zip</code></li>
</ul></li>
<li>Use the extractor to recover only the filesystem, no kernel (<code>-nk</code>), no parallel operation (<code>-np</code>), populating the <code>image</code> table in the SQL server at <code>127.0.0.1</code> (<code>-sql</code>) with the <code>Netgear</code> brand (<code>-b</code>), and storing the tarball in <code>images</code>.

<ul>
<li><code>./sources/extractor/extractor.py -b Netgear -sql 127.0.0.1 -np -nk "WNAP320 Firmware Version 2.0.3.zip" images</code></li>
</ul></li>
<li>Identify the architecture of firmware <code>1</code> and store the result in the <code>image</code> table of the database.

<ul>
<li><code>./scripts/getArch.sh ./images/1.tar.gz</code></li>
</ul></li>
<li>Load the contents of the filesystem for firmware <code>1</code> into the database, populating the <code>object</code> and <code>object_to_image</code> tables.

<ul>
<li><code>./scripts/tar2db.py -i 1 -f ./images/1.tar.gz</code></li>
</ul></li>
<li>Create the QEMU disk image for firmware <code>1</code>.

<ul>
<li><code>sudo ./scripts/makeImage.sh 1</code></li>
</ul></li>
<li>Infer the network configuration for firmware <code>1</code>. Kernel messages are logged to <code>./scratch/1/qemu.initial.serial.log</code>.

<ul>
<li><code>./scripts/inferNetwork.sh 1</code></li>
</ul></li>
<li>Emulate firmware <code>1</code> with the inferred network configuration. This will modify the configuration of the host system by creating a TAP device and adding a route.

</li>
<li>The system should be available over the network, and is ready for analysis. Kernel messages are logged to <code>./scratch/1/qemu.final.serial.log</code>.

<ul>
<li><code>./analyses/snmpwalk.sh 192.168.0.100</code></li>
<li><code>./analyses/webAccess.py 1 192.168.0.100 log.txt</code></li>
<li><code>mkdir exploits; ./analyses/runExploits.py -t 192.168.0.100 -o exploits/exploit -e x</code> (requires Metasploit Framework)</li>
<li><code>sudo nmap -O -sV 192.168.0.100</code></li>
</ul></li>
<li>To access a console in the firmware, use a presupplied debug run script to access the default console (no network access), modify the network-enabled <code>run.sh</code> script to provide console access, or use the second console provided by the framework.

<ul>
<li><code>./scripts/run-debug.sh 1</code></li>
<li><code>nc -U /tmp/qemu.1.S1</code></li>
</ul></li>
<li>The following scripts can be used to mount/unmount the filesystem of firmware <code>1</code>. Ensure that the emulated firmware is not running, and remember to unmount before performing any other operations.

<ul>
<li><code>sudo ./scripts/mount.sh 1</code></li>
<li><code>sudo ./scripts/umount.sh 1</code></li>
</ul></li>
</ol>

<h1><a id="user-content-compiling-from-source" class="anchor" href="#compiling-from-source" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Compiling from Source</h1>

<p>If you would like to compile the entire FIRMADYNE system from scratch
without using our pre-built binaries, please follow the steps below.</p>



<p>In order to build any of the binaries used by FIRMADYNE, you will need three
cross-compilation toolchains for the following architecture triples. Use only
<a href="http://www.musl-libc.org">musl libc</a> as the C runtime library for the
toolchain; others have not been tested.</p>

<ul>
<li>arm-linux-musleabi</li>
<li>mipseb-linux-musl</li>
<li>mipsel-linux-musl</li>
</ul>

<p>To simplify the process of building cross-compilation toolchains with musl, we
recommend using the <a href="https://github.com/GregorR/musl-cross">musl-cross</a> project.
Follow the below steps to build these toolchains from source, or alternatively
click <a href="https://cmu.box.com/s/hnpvf1n72uccnhyfe307rc2nb9rfxmjp">here</a> to
download our pre-built toolchains.</p>

<ol>
<li><p><code>git clone https://github.com/GregorR/musl-cross.git</code></p></li>
<li><p>Modify or set the following variables in <code>defs.sh</code></p>

<ul>
<li><code>BINUTILS_URL=http://ftp.gnu.org/gnu/binutils/binutils-2.25.1.tar.bz2</code></li>
<li><code>GCC_VERSION=5.3.0</code></li>
<li><code>GMP_VERSION=6.0.0a</code></li>
<li><code>MPC_VERSION=1.0.2</code></li>
<li><code>MPFR_VERSION=3.1.3</code></li>
<li><code>LIBELF_VERSION=master</code></li>
<li><code>MUSL_DEFAULT_VERSION=1.1.12</code></li>
<li><code>MUSL_GIT_VERSION=615629bd6fcd6ddb69ad762e679f088c7bd878e2</code></li>
<li><code>LANG_CXX=no</code></li>
</ul></li>
<li><p>Modify or set the following variables in <code>config.sh</code></p>

</li>
<li><p>For little-endian MIPS, perform the following:</p>

<ul>
<li>set <code>TRIPLE=mipsel-linux-musl</code> in <code>config.sh</code></li>
<li>set <code>LINUX_HEADERS_URL=https://kernel.org/pub/linux/kernel/v2.6/longterm/v2.6.32/linux-2.6.32.70.tar.xz</code> in <code>defs.sh</code></li>
<li>run <code>./clean.sh</code> to clean out any previous builds</li>
<li>run <code>./build.sh</code> to build and install the toolchain into <code>/opt/cross</code></li>
</ul></li>
<li><p>For big-endian MIPS, perform the following:</p>

<ul>
<li>set <code>TRIPLE=mipseb-linux-musl</code> in <code>config.sh</code></li>
<li>set <code>LINUX_HEADERS_URL=https://kernel.org/pub/linux/kernel/v2.6/longterm/v2.6.32/linux-2.6.32.70.tar.xz</code> in <code>defs.sh</code></li>
<li>run <code>./clean.sh</code> to clean out any previous builds</li>
<li>run <code>./build.sh</code> to build and install the toolchain into <code>/opt/cross</code></li>
</ul></li>
<li><p>For little-endian ARM, perform the following:</p>

<ul>
<li>set <code>TRIPLE=arm-linux-musleabi</code>, <code>GCC_BOOTSTRAP_CONFFLAGS="--with-arch=armv6 --with-float=softfp"</code>, and <code>GCC_CONFFLAGS="--with-arch=armv6 --with-float=softfp"</code> in <code>config.sh</code></li>
<li>set <code>LINUX_HEADERS_URL=https://kernel.org/pub/linux/kernel/v4.x/linux-4.1.17.tar.xz</code> in <code>defs.sh</code></li>
<li>run <code>./clean.sh</code> to clean out any previous builds</li>
<li>run <code>./build.sh</code> to build and install the toolchain into <code>/opt/cross</code></li>
</ul></li>
<li><p>You should have the following directories, or wherever you installed the toolchains:</p>

<ul>
<li><code>/opt/cross/arm-linux-musleabi</code></li>
<li><code>/opt/cross/mipseb-linux-musl</code></li>
<li><code>/opt/cross/mipsel-linux-musl</code></li>
</ul></li>
</ol>



<ol>
<li><code>cd ./firmadyne/sources/console</code></li>
<li><code>make clean &amp;&amp; CC=/opt/cross/arm-linux-musleabi/bin/arm-linux-musleabi-gcc make &amp;&amp; mv console ../../binaries/console.armel</code></li>
<li><code>make clean &amp;&amp; CC=/opt/cross/mipseb-linux-musl/bin/mipseb-linux-musl-gcc make &amp;&amp; mv console ../../binaries/console.mipseb</code></li>
<li><code>make clean &amp;&amp; CC=/opt/cross/mipsel-linux-musl/bin/mipsel-linux-musl-gcc make &amp;&amp; mv console ../../binaries/console.mipsel</code></li>
</ol>



<ol>
<li><code>cd ./firmadyne/sources/libnvram</code></li>
<li><code>make clean &amp;&amp; CC=/opt/cross/arm-linux-musleabi/bin/arm-linux-musleabi-gcc make &amp;&amp; mv libnvram.so ../../binaries/libnvram.so.armel</code></li>
<li><code>make clean &amp;&amp; CC=/opt/cross/mipseb-linux-musl/bin/mipseb-linux-musl-gcc make &amp;&amp; mv libnvram.so ../../binaries/libnvram.so.mipseb</code></li>
<li><code>make clean &amp;&amp; CC=/opt/cross/mipsel-linux-musl/bin/mipsel-linux-musl-gcc make &amp;&amp; mv libnvram.so ../../binaries/libnvram.so.mipsel</code></li>
</ol>

<h2><a id="user-content-kernel" class="anchor" href="#kernel" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Kernel</h2>



<ol>
<li><code>git clone https://github.com/firmadyne/kernel-v4.1.git &amp;&amp; cd kernel-v4.1</code></li>
<li><code>mkdir -p build/armel</code></li>
<li><code>cp config.armel build/armel/.config</code></li>
<li><code>make ARCH=arm CROSS_COMPILE=/opt/cross/arm-linux-musleabi/bin/arm-linux-musleabi- O=./build/armel zImage -j8</code></li>
<li><code>cp build/armel/arch/arm/boot/zImage ../firmadyne/binaries/zImage.armel</code></li>
</ol>



<ol>
<li><code>git clone https://github.com/firmadyne/kernel-v2.6.32.git &amp;&amp; cd kernel-v2.6.32</code></li>
<li><p>For big-endian MIPS, perform the following:</p>

<ol>
<li><code>mkdir -p build/mipseb</code></li>
<li><code>cp config.mipseb build/mipseb/.config</code></li>
<li><code>make ARCH=mips CROSS_COMPILE=/opt/cross/mipseb-linux-musl/bin/mipseb-linux-musl- O=./build/mipseb -j8</code></li>
<li><code>cp build/mipseb/vmlinux ../firmadyne/binaries/vmlinux.mipseb</code></li>
</ol></li>
<li><p>For little-endian MIPS, perform the following:</p>

<ol>
<li><code>mkdir -p build/mipsel</code></li>
<li><code>cp config.mipsel build/mipsel/.config</code></li>
<li><code>make ARCH=mips CROSS_COMPILE=/opt/cross/mipsel-linux-musl/bin/mipsel-linux-musl- O=./build/mipsel -j8</code></li>
<li><code>cp build/mipsel/vmlinux ../firmadyne/binaries/vmlinux.mipsel</code></li>
</ol></li>
</ol>

<h1><a id="user-content-database-1" class="anchor" href="#database-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Database</h1>

<p>During development, the database was stored on a PostgreSQL server.</p>



<p>Although we cannot redistribute binary firmware, the data used for our
experiments is available <a href="https://cmu.box.com/s/hnpvf1n72uccnhyfe307rc2nb9rfxmjp">here</a>.</p>



<p>Below are descriptions of tables in the schema.</p>

<ul>
<li><code>brand</code>: Stores brand names for each vendor.</li>
</ul>

<table><thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Primary key</td>
</tr>
<tr>
<td>name</td>
<td>Brand name</td>
</tr>
</tbody></table>

<ul>
<li><code>image</code>: Stores information about each firmware image.</li>
</ul>

<table><thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Primary key</td>
</tr>
<tr>
<td>filename</td>
<td>File name</td>
</tr>
<tr>
<td>brand_id</td>
<td>Foreign key to <code>brand</code></td>
</tr>
<tr>
<td>hash</td>
<td>MD5</td>
</tr>
<tr>
<td>rootfs_extracted</td>
<td>Whether the primary filesystem was extracted</td>
</tr>
<tr>
<td>kernel_extracted</td>
<td>Whether the kernel was extracted</td>
</tr>
<tr>
<td>arch</td>
<td>Hardware architecture</td>
</tr>
<tr>
<td>kernel_version</td>
<td>Version of the extracted kernel</td>
</tr>
</tbody></table>

<ul>
<li><code>object</code>: Stores information about each file in a filesystem.</li>
</ul>

<table><thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Primary key</td>
</tr>
<tr>
<td>hash</td>
<td>MD5</td>
</tr>
</tbody></table>

<ul>
<li><code>object_to_image</code>: Maps unique files to their firmware images.</li>
</ul>

<table><thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Primary key</td>
</tr>
<tr>
<td>oid</td>
<td>Foreign key to <code>object</code></td>
</tr>
<tr>
<td>iid</td>
<td>Foreign key to <code>image</code></td>
</tr>
<tr>
<td>filename</td>
<td>Full path to the file</td>
</tr>
<tr>
<td>regular_file</td>
<td>Whether the file is regular</td>
</tr>
<tr>
<td>permissions</td>
<td>File permissions in octal</td>
</tr>
<tr>
<td>uid</td>
<td>Owner's user ID</td>
</tr>
<tr>
<td>gid</td>
<td>Group's group ID</td>
</tr>
</tbody></table>



<table><thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Primary key</td>
</tr>
<tr>
<td>iid</td>
<td>Foreign key to <code>image</code></td>
</tr>
<tr>
<td>url</td>
<td>Download URL</td>
</tr>
<tr>
<td>mib_filename</td>
<td>Filename of the SNMP MIB</td>
</tr>
<tr>
<td>mib_hash</td>
<td>MD5 of the SNP MIB</td>
</tr>
<tr>
<td>mib_url</td>
<td>Download URL of the SNMP MIB</td>
</tr>
<tr>
<td>sdk_filename</td>
<td>Filename of the source SDK</td>
</tr>
<tr>
<td>sdk_hash</td>
<td>MD5 of the source SDK</td>
</tr>
<tr>
<td>sdk_url</td>
<td>Download URL of the source SDK</td>
</tr>
<tr>
<td>product</td>
<td>Product name</td>
</tr>
<tr>
<td>version</td>
<td>Version string</td>
</tr>
<tr>
<td>build</td>
<td>Build string</td>
</tr>
<tr>
<td>date</td>
<td>Release date</td>
</tr>
</tbody></table>

<h1><a id="user-content-paper" class="anchor" href="#paper" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Paper</h1>

<p>The results discussed in our <a href="https://github.com/firmadyne/firmadyne/blob/master/paper/paper.pdf">paper</a> were produced using pre-release versions of the following:</p>


</article>
  </div></body></html>