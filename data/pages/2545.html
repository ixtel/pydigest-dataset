<html><body><div><div class="post-body entry-content">
<p/><p>By </p><a href="http://www.dancingbison.com">Vasudev Ram</a><p/>
<a href="https://tablib.readthedocs.org/en/latest/">Tablib</a><p> is a </p><b>Python library</b><p> that allows you to import, export and manipulate </p><a href="http://en.wikipedia.org/wiki/Table_(information)">tabular data</a><p>.
</p><p>
I had come across tablib a while ago. Today I thought of using it with </p><a href="https://google.com/search?q=xtopdf">xtopdf</a><p>, my </p><a href="http://slid.es/vasudevram/xtopdf">Python library for PDF creation</a><p>, to </p><b>generate PDF output</b><p> from </p><b>tabular data</b><p>. So I wrote a program, </p><b>TablibToPDF.py</b><p>, for that. It generates dummy data for </p><b>student grades</b><p> (for an examination), then puts that data into a </p><b>tablib Dataset</b><p>, and then exports the contents of that </p><b>Dataset to PDF</b><p>, using </p><b>xtopdf</b><p>. Given the comments in the code, it is mostly self-explanatory. I first wrote the program in an obvious/naive way, and then improved it a little by removing some intermediate variables, and by </p><a href="http://stackoverflow.com/questions/15150458/how-to-convert-this-for-loop-in-list-comprehension">converting some for loops to list comprehensions</a><p>, thereby shortening the code by a few lines. Here is the code for </p><b>TablibToPDF.py</b><p>:
</p><pre>"""
TablibToPDF.py
Author: Vasudev Ram
Copyright 2014 Vasudev Ram - www.dancingbison.com
This program is a demo of how to use the tablib and xtopdf Python libraries 
to generate tabular data reports as PDF output.
Tablib is at: https://tablib.readthedocs.org/en/latest/
xtopdf is at: https://bitbucket.org/vasudevram/xtopdf
and info about xtopdf is at: http://slides.com/vasudevram/xtopdf or 
at: http://slid.es/vasudevram/xtopdf
"""

import random
import tablib
from PDFWriter import PDFWriter

# Helper function to output a string to both screen and PDF.
def print_and_write(pw, strng):
    print strng
    pw.writeLine(strng)

# Set up grade and result names and mappings.
grade_letters = ['F', 'E', 'D', 'C', 'B', 'A']
results = {'A': 'Pass', 'B': 'Pass', 'C': 'Pass', 
    'D': 'Pass', 'E': 'Pass', 'F': 'Fail'}

# Create an empty Dataset and set its headers.
data = tablib.Dataset()
data.headers = ['ID', 'Name', 'Marks', 'Grade', 'Result']
widths = [5, 12, 8, 8, 12] # Display widths for columns.

# Create some rows of student data and use it to populate the Dataset.
# Columns for each student row correspond to the header columns 
# shown above.

for i in range(20):
    id = str(i).zfill(2)
    name = 'Student-' + id
    # Let's grade them on the curve [1].
    # This examiner doesn't give anyone 100 marks :)
    marks = random.randint(40, 99)
    # Compute grade from marks.
    grade = grade_letters[(marks - 40) / 10]
    result = results[grade]
    columns = [id, name, marks, grade, result]
    row = [ str(col).center(widths[idx]) for idx, col in enumerate(columns) ]
    data.append(row)

# Set up the PDFWriter.
pw = PDFWriter('student_grades.pdf')
pw.setFont('Courier', 10)
pw.setHeader('Student Grades Report - generated by xtopdf')
pw.setFooter('xtopdf: http://slides.com/vasudevram/xtopdf')

# Generate header and data rows as strings; output them to screen and PDF.

separator = '-' * sum(widths)
print_and_write(pw, separator)

# Output headers
header_strs = [ header.center(widths[idx]) for idx, header in enumerate(data.headers) ]
print_and_write(pw, ''.join(header_strs))
print_and_write(pw, separator)

# Output data
for row in data:
    print_and_write(pw, ''.join(row))

print_and_write(pw, separator)
pw.close()

# [1] http://en.wikipedia.org/wiki/Grading_on_a_curve
# I'm not endorsing the idea of grading on a curve; I only used it as a 
# simple algorithm to generate the marks and grades for this example.

</pre><p>You can run it with:
</p><pre>$ python TablibToPDF.py
</pre><p>It sends the tabular output that it generates, to both the screen and to a PDF file named student_grades.pdf.</p><p>
Here is a </p><b>screenshot of the generated PDF file</b><p>, opened in </p><b>Foxit PDF Reader</b><p>:

</p><p>
The program that I wrote could actually have been written without using tablib, just with plain Python lists and/or dictionaries. But tablib has some additional features, such as dynamic columns, export to various formats (but not PDF), and more - see its documentation, linked near the top of this post. I may write another blog post later that explores the use of some of those tablib features.
</p><p>
- Enjoy.
</p><a href=""/>
<a href="http://jugad2.blogspot.in/p/about-vasudev-ram.html">Vasudev Ram - Python consulting and training - Dancing Bison Enterprises</a><p/><p/><p/><b><a href="mailto:vasudevram@gmail.com?subject=Email%20me%20about%20your%20new%20products%20and%20services">Signup to hear about new products or services from me.</a></b> <p/><p/><a href="http://www.dancingbison.com/contact.html">Contact Page</a>

   
<p/>
</div>
</div></body></html>