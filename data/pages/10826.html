<html><body><div><div id="basic-example">

<pre><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">proxybroker</span> <span class="kn">import</span> <span class="n">Broker</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>

<span class="n">proxies</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>
<span class="n">broker</span> <span class="o">=</span> <span class="n">Broker</span><span class="p">(</span><span class="n">proxies</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>

<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">broker</span><span class="o">.</span><span class="n">find</span><span class="p">())</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">proxy</span> <span class="o">=</span> <span class="n">proxies</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">proxy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">break</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'Found proxy: </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">proxy</span><span class="p">)</span>
</pre>
<p>In result you get a proxy objects:</p>
<pre>Found proxy: &lt;Proxy AU 0.72s [HTTP: Transparent] 1.1.1.1:80&gt;
Found proxy: &lt;Proxy FR 0.33s [HTTP: High, HTTPS] 2.2.2.2:3128&gt;
Found proxy: &lt;Proxy US 1.11s [HTTP: Anonymous, HTTPS] 8.8.8.8:8000&gt;
Found proxy: &lt;Proxy -- 0.45s [SOCKS4, SOCKS5] 192.168.1.2:1080&gt;
...
</pre>
</div>
<div id="advanced-example">

<pre><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">proxybroker</span> <span class="kn">import</span> <span class="n">Broker</span>

<span class="n">async</span> <span class="k">def</span> <span class="nf">use_example</span><span class="p">(</span><span class="n">pQueue</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="n">await</span> <span class="n">pQueue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">proxy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">'Received: </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">proxy</span><span class="p">)</span>

<span class="n">async</span> <span class="k">def</span> <span class="nf">find_advanced_example</span><span class="p">(</span><span class="n">pQueue</span><span class="p">,</span> <span class="n">loop</span><span class="p">):</span>
    <span class="n">broker</span> <span class="o">=</span> <span class="n">Broker</span><span class="p">(</span><span class="n">queue</span><span class="o">=</span><span class="n">pQueue</span><span class="p">,</span>
                    <span class="n">timeout</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">attempts_conn</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">max_concurrent_conn</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                    <span class="n">judges</span><span class="o">=</span><span class="p">[</span><span class="s1">'https://httpheader.net/'</span><span class="p">,</span> <span class="s1">'http://httpheader.net/'</span><span class="p">],</span>
                    <span class="n">providers</span><span class="o">=</span><span class="p">[</span><span class="s1">'http://www.proxylists.net/'</span><span class="p">,</span> <span class="s1">'http://fineproxy.org/eng/'</span><span class="p">],</span>
                    <span class="n">verify_ssl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                    <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>

    <span class="c1"># only anonymous &amp; high levels of anonymity for http protocol and high for others:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">'HTTP'</span><span class="p">,</span> <span class="p">(</span><span class="s1">'Anonymous'</span><span class="p">,</span> <span class="s1">'High'</span><span class="p">)),</span> <span class="s1">'HTTPS'</span><span class="p">,</span> <span class="s1">'SOCKS4'</span><span class="p">,</span> <span class="s1">'SOCKS5'</span><span class="p">]</span>
    <span class="n">countries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'US'</span><span class="p">,</span> <span class="s1">'GB'</span><span class="p">,</span> <span class="s1">'DE'</span><span class="p">]</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">await</span> <span class="n">broker</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="n">countries</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
    <span class="n">pQueue</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>
    <span class="c1"># Start searching and checking.</span>
    <span class="c1"># At the same time, using the received proxies to another part of the program</span>
    <span class="n">tasks</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">find_advanced_example</span><span class="p">(</span><span class="n">pQueue</span><span class="p">,</span> <span class="n">loop</span><span class="p">),</span> <span class="n">use_example</span><span class="p">(</span><span class="n">pQueue</span><span class="p">))</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
</pre>
</div>
<div id="example-with-your-raw-data-instead-of-providers">

<pre><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">proxybroker</span> <span class="kn">import</span> <span class="n">Broker</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>

<span class="n">proxies</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>
<span class="n">broker</span> <span class="o">=</span> <span class="n">Broker</span><span class="p">(</span><span class="n">proxies</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="s1">'''10.0.0.1:80
          OK 10.0.0.2:   80 HTTP 200 OK 1.214
          10.0.0.3;80;SOCKS5 check date 21-01-02
          &gt;&gt;&gt;10.0.0.4@80 HTTP HTTPS status OK
          ...'''</span>

<span class="c1"># Note: At the moment, information about the type of proxies in the raw data is ignored</span>
<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">broker</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">))</span>

<span class="n">found_proxies</span> <span class="o">=</span> <span class="p">[</span><span class="n">proxies</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">proxies</span><span class="o">.</span><span class="n">qsize</span><span class="p">())]</span>
</pre>
</div>
</div></body></html>