<html><body><div><div class="col-8 post-content">
					<p><a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/pin_100.png"><img alt="pin_100" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/pin_100.png"/></a></p>
<p><strong>Airbnb</strong> is a fast growing, data informed company. Our data teams and data volume are growing quickly, and accordingly, so does the complexity of the challenges we take on. Our growing workforce of data engineers, data scientists and analysts are using <strong>Airflow</strong>, a platform we built to allow us to move fast, keep our momentum as we author, monitor and retrofit <strong>data pipelines</strong>.</p>
<p>Today, we are proud to announce that we are <strong>open sourcing</strong> and <strong>sharing Airflow</strong>, our workflow management platform.</p>
<h2>DAGs are blooming</h2>
<p>As people who work with data begin to automate their processes, they inevitably write batch jobs. These jobs need to run on a schedule, typically have a set of dependencies on other existing datasets, and have other jobs that depend on them. Throw a few data workers together for even a short amount of time and quickly you have a growing complex graph of computation batch jobs. Now if you consider a fast-paced, medium-sized data team for a few years on an evolving data infrastructure and you have a massively complex network of computation jobs on your hands. This complexity can become a significant burden for the data teams to manage, or even comprehend.</p>
<p>These networks of jobs are typically <strong>DAGs</strong> (<strong>directed acyclic graphs</strong>) and have the following properties:</p>
<ul>
<li><strong>Scheduled: </strong>each job should run at a certain scheduled interval</li>
<li><strong>Mission critical:</strong> if some of the jobs aren’t running, we are in trouble</li>
<li><strong>Evolving:</strong> as the company and the data team matures, so does the data processing</li>
<li><strong>Heterogenous:</strong> the stack for modern analytics is changing quickly, and most companies run multiple systems that need to be glued together</li>
</ul>
<h2>Every company has one (or many)</h2>
<p><strong>Workflow management</strong> has become such a common need that most companies have multiple ways of creating and scheduling jobs internally. There’s always the good old cron scheduler to get started, and many vendor packages ship with scheduling capabilities. The next step forward is to have scripts call other scripts, and that can work for a short period of time. Eventually simple frameworks emerge to solve problems like storing the status of jobs and dependencies.</p>
<p>Typically these solutions <strong>grow reactively</strong> as a response to the increasing need to schedule individual jobs, and usually because current incarnation of the system doesn’t allow for simple scaling. Also note that people who write data pipelines typically are not software engineers, and their mission and competencies are centered around processing and analyzing data, not building workflow management systems.</p>
<p>Considering that internally grown workflow management systems are often at least one generation behind the company’s need, the <strong>friction</strong> around authoring, scheduling and troubleshooting jobs creates massive inefficiencies and frustrations that divert data workers off of their productive path.</p>
<p> </p>
<h2>Airflow</h2>
<p>After reviewing the open source solutions, and leveraging Airbnb employees’ insight about systems they had used in the past, we came to the conclusion that there wasn’t anything in the market that met our current and future needs.  We decided to build a modern system to solve this problem properly. As the project progressed in development, we realized that we had an amazing opportunity to give back to the open source community that we rely so heavily upon. Therefore, we have decided to open source the project under the Apache license.</p>
<p>Here are some of the processes fueled by Airflow at Airbnb:</p>
<ul>
<li><strong>Data warehousing:</strong> cleanse, organize, data quality check, and publish data into our growing data warehouse</li>
<li><strong>Growth analytics:</strong> compute metrics around guest and host engagement as well as growth accounting</li>
<li><strong>Experimentation:</strong> compute our A/B testing experimentation frameworks logic and aggregates</li>
<li><strong>Email targeting:</strong> apply rules to target and engage our users through email campaigns</li>
<li><strong>Sessionization:</strong> compute clickstream and time spent datasets</li>
<li><strong>Search:</strong> compute search ranking related metrics</li>
<li><strong>Data infrastructure maintenance:</strong> database scrapes, folder cleanup, applying data retention policies, …</li>
</ul>
<h3>Architecture</h3>
<p>Much like English is the language of business, Python has firmly established itself as the language of data. Airflow is written in pythonesque Python from the ground up. The code base is extensible, documented, consistent, linted and has broad unit test coverage.</p>
<p>Pipeline authoring is also done in Python, which means dynamic pipeline generation from configuration files or any other source of metadata comes naturally. “<strong>Configuration as code</strong>” is a principle we stand by for this purpose. While yaml or json job configuration would allow for any language to be used to generate Airflow pipelines, we felt that some fluidity gets lost in the translation. Being able to introspect code (ipython!, IDEs) subclass, meta-program and use import libraries to help write pipelines adds tremendous value. Note that it is still possible to author jobs in any language or markup, as long as you write Python that interprets these configurations.</p>
<p>While you can get up and running with Airflow in just a few commands, the complete architecture has the following components:</p>
<ul>
<li>The <strong>job definitions</strong>, in source control.</li>
<li>A rich <strong>CLI</strong> (command line interface) to test, run, backfill, describe and clear parts of your DAGs.</li>
<li>A <strong>web application</strong>, to explore your DAGs definition, their dependencies, progress, metadata and logs. The web server is packaged with Airflow and is built on top of the Flask Python web framework.</li>
<li>A <strong>metadata repository</strong>, typically a MySQL or Postgres database that Airflow uses to keep track of task job statuses and other persistent information.</li>
<li>An array of <strong>workers</strong>, running the jobs task instances in a distributed fashion.</li>
<li><strong>Scheduler</strong> processes, that fire up the task instances that are ready to run.</li>
</ul>
<h3>Extensibility</h3>
<p>While Airflow comes fully loaded with ways to interact with commonly used systems like Hive, Presto, MySQL, HDFS, Postgres and S3, and allow you to trigger arbitrary scripts, the base modules have been designed to be extended very easily.</p>
<p><strong>Hooks</strong> are defined as external systems abstraction and share a homogenous interface. Hooks use a centralized vault that abstracts host/port/login/password information and exposes methods to interact with these system.</p>
<p><strong>Operators</strong> leverage hooks to generate a certain type of task that become nodes in workflows when instantiated. All operators derive from BaseOperator and inherit a rich set of attributes and methods. There are 3 main types of operators:</p>
<ul>
<li>Operators that performs an <strong>action</strong>, or tells another system to perform an action</li>
<li><strong>Transfer</strong> operators move data from a system to another</li>
<li><strong>Sensors</strong> are a certain type of operators that will keep running until a certain criteria is met</li>
</ul>
<p><strong>Executors</strong> implement an interface that allow Airflow components (CLI, scheduler, web server) to run jobs jobs remotely. Airflow currently ships with a SequentialExecutor (for testing purposes), a threaded LocalExecutor, and a CeleryExecutor that leverages <a href="http://www.celeryproject.org/">Celery</a>, an excellent asynchronous task queue based on distributed message passing. We are also planning on sharing a YarnExecutor in the near future.</p>
<h2>A Shiny UI</h2>
<p>While Airflow exposes a rich <a href="http://pythonhosted.org/airflow/cli.html">command line interface</a>, the best way to monitor and interact with workflows is through the web user interface. You can easily visualize your pipelines dependencies, see how they progress, get easy access to logs, view the related code, trigger tasks, fix false positives/negatives, analyze where time is spent as well as getting a comprehensive view on at what time of the day different tasks usually finish. The UI is also a place where some administrative functions are exposed: managing connections, pools and pausing progress on specific DAGs.</p>
<p><a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-05-28-at-11.13.01-AM.png"><img title="UI - Graph View" alt="Screen Shot 2015-05-28 at 11.13.01 AM" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-05-28-at-11.13.01-AM-300x195.png"/></a><a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.36.55-AM.png"><img title="UI - Tree View" alt="" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.36.55-AM-300x178.png"/></a><a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.36.17-AM.png"><img title="UI - Task Contextual Menu" alt="" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.36.17-AM-300x128.png"/></a></p>
<p> </p>
<p><a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-10.09.23-AM.png"><img class="alignnone  wp-image-176595018" title="UI - Tasks Duration" alt="" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-10.09.23-AM-300x196.png"/></a> <a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-10.11.45-AM.png"><img class="alignnone  wp-image-176595020" title="UI - Gantt Chart" alt="" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-10.11.45-AM-300x154.png"/></a> <a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-10.12.03-AM.png"><img class="alignnone  wp-image-176595021" title="UI - Code View" alt="" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-10.12.03-AM-300x196.png"/></a></p>
<p>To put a cherry on top of this, the UI serves a <a href="http://pythonhosted.org/airflow/profiling.html">Data Profiling</a> section that allows users to run SQL queries against the registered connections, browse through the result sets, as well as offering a way to create and share simple charts. The charting application is a mashup of <a href="http://www.highcharts.com/">Highcharts</a>, the <a href="https://flask-admin.readthedocs.org/en/v1.0.9/">Flask Admin</a>‘s CRUD interface and Airflow’s <a href="http://pythonhosted.org/airflow/code.html#module-airflow.hooks">hooks</a> and <a href="http://pythonhosted.org/airflow/code.html#macros">macros</a> libraries. URL parameters can be passed through to the SQL in your chart, and Airflow macros are available via <a href="http://jinja.pocoo.org/">Jinja templating</a>. With these features, queries, result sets and charts can be easily created and shared by Airflow users.</p>
<p><a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.49.09-AM.png"><img title="UI - Ad Hoc Query" alt="" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.49.09-AM-300x156.png"/></a>  <a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.46.33-AM.png"><img title="UI - Chart" alt="" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.46.33-AM-300x198.png"/></a><a href="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.47.12-AM.png"><img title="UI - Edit Chart" alt="" src="http://nerds.airbnb.com/wp-content/uploads/2015/06/Screen-Shot-2015-06-02-at-9.47.12-AM-300x197.png"/></a></p>
<h2>A Catalyst</h2>
<p>As a result of using Airflow, the productivity and enthusiasm of people working with data has been multiplied at Airbnb. Authoring pipeline has accelerated and the amount of time monitoring and troubleshooting is reduced significantly. More importantly, this platform allows people to execute at a higher level of abstraction, creating reusable building blocks as well as computation frameworks and services.</p>
<h2>Enough Said!</h2>
<p>We’ve made it extremely easy to take a test drive of Airflow while powering through an enlightening tutorial. Rewarding results are a few shell commands away. Check out the  <a href="http://pythonhosted.org/airflow/start.html">quick start</a> and <a href="http://pythonhosted.org/airflow/tutorial.html">tutorial</a> sections of the <a href="http://pythonhosted.org/airflow/">Airflow documentation</a>, you should be able to have your an Airflow web application loaded with interactive examples in just a few minutes!</p>
<p><a href="https://github.com/airbnb/airflow">https://github.com/airbnb/airflow</a></p>


					<div class="row dot-babu text-contrast row-space-8 row-space-top-4">
					  <div class="col-8 panel-body">
					    <p class="h3 icon-white pull-left">
					      Want to work with us? <strong><em>We're hiring!</em></strong>
					    </p>
					  </div>
					  
					</div>
				</div>

				</div></body></html>