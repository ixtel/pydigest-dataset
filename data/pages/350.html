<html><body><div><div id="articleText">
                    <p id="articleLongDescription">In Part 5 of his seven-part series on learning Python Pyramid,  Jesse Smith looks at how to create and manage views.</p>
                    <p id="articleDescription"/>

                    <a class="relatedBookLink" href="#">Like this article? We recommend <span class="ss-icon">ï”€</span></a>
                    
                    

                <p>If you haven't read <a href="/articles/article.aspx?p=2161679">Part 4 of this series</a>,  I recommend you do that before continuing with this article. In Part 4, we discussed  the startup process and configuration files.</p>
<p>
  This article covers views and renderers. Views are very important,  as they're what the user sees after making a request to your application. The  last part of the request process we covered in <a href="/articles/article.aspx?p=2161679">Part 4</a> is rendering a view.</p>
<p>
  A <em>renderer</em> is an object  instance that can store dictionaries or custom objects and return them as a  response using a certain type of renderer, such as JSON or as a simple text  string.</p>
<p>
  To get started, we'll first look at the basics by learning what <em>view callables</em> are and how to define  them. Next, we'll cover renderers in some detail.</p>

<hr size="3"/>
<h3>Catch Up on All of the Articles in this Python Series</h3>
<p>Jesse Smith has written five articles in this series. Here are the earlier installments:</p>





<hr size="3"/>

<h2>View Callables</h2>
<p>A view callable can either be a function or a class that takes, at  minimum, the <tt>request</tt> object as a parameter. The view callable's primary  job is to take that request and issue a <tt>Response</tt> object.</p>
<p>
  The easiest way is to define the view callable is as a function:</p>
<pre>from pyramid.response import Response

def hello_world(request):
    return Response('Hello world!')</pre>
<p>
  Only the <tt>request</tt> object instance is passed into the  function, and a <tt>Response</tt> object is returned with the text <tt>Hello  world!</tt> This is great if you just want to return plain text, but chances are  you'll want to return a lot more.</p>
<p>
  Defining a class isn't much more difficult. However, we need to  have both an <tt>__init__</tt> and a <tt>__call__</tt> function:</p>
<pre>from pyramid.response import Response
class MyView(object):
    def __init__(self, request):
        self.request = request

    def __call__(self):
        return Response('hello')</pre>
<p>
  With a view callable class definition, the <tt>__init__</tt> method  takes the <tt>request</tt> object as a parameter, whereas the <tt>__call__</tt> function takes no arguments and returns the <tt>Response</tt> object.</p>
<p>
  A view callable function or class can also take the <tt>context</tt> object as a parameter:</p>
<pre>from pyramid.response import Response

class view(object):
        def __init__(self, context, request):
                self.context = context
                self.request = request

        def __call__(self):
                return Response('OK')</pre>
<p>
  The <tt>context</tt> object is similar in most languages. The context  of a request is all of the data and metadata that derives from the incoming  request, either directly or indirectly.</p>
<p>
  With view callables, you don't always have to return a <tt>Response</tt> object; sometimes you might just want to share information between view  callables. An object called a <tt>Renderer</tt> allows for information sharing  between callables. Instead of returning a <tt>Response</tt>, the following  example does a redirect:</p>
<pre>from pyramid.httpexceptions import HTTPFound

def myview(request):
    return HTTPFound(location='http://example.com')</pre>
<p>
  The <tt>HTTPFound</tt> class is actually part of the Pyramid <tt>httpexceptions</tt> package. You can use it to raise exceptions or perform simple redirects. Using <tt>HTTPFound</tt> to raise an exception returns a <tt>302 Found</tt> response to the user. For more  information on exceptions in general, see my article "<a href="/articles/article.aspx?p=2145971">An Introduction to Object-Oriented  Concepts in Python, Part 4</a>."</p>
<p>
  You might be wondering how to handle form submissions in view  callables. This is important, as most web applications need to accept form  submissions. Take the simple HTML form example below:</p>
<pre>&lt;form method="POST" action="myview"&gt;

    &lt;div&gt;
      &lt;input type="text" name="firstname"/&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;input type="text" name="lastname"/&gt;
    &lt;/div&gt;
    &lt;input type="submit" value="Submit"/&gt;
  &lt;/form&gt;</pre>
<p>
  The <tt>request</tt> object handled by the view callable will have  the parameters of the form stored in an object called <tt>params</tt>. Getting  the form values is much as in other languages that use their <tt>Request</tt> object to return form values:</p>
<pre><em>firstname = request.params['firstname']
lastname = request.params['lastname']</em></pre>
<p>
  When a view callable doesn't return a response object, it attempts  to construct a <tt>renderer</tt> instance that returns values from a view into a  string, as in the following example:</p>
<pre>from pyramid.view import view_config

@view_config(renderer='json')
def hello_world(request):
    return {'content':'Hello!'}</pre>
<p>
  In this example, a dictionary is returned from the view callable.  For more information on dictionaries in general, see my article "<a href="/articles/article.aspx?p=2145972">An Introduction to Object-Oriented  Concepts in Python, Part 5</a>." What allows this example to work  is the <tt>@view_config</tt> decorator, which takes a <tt>renderer</tt> object  argument. A <em>decorator</em> is a wrapper  around a function or class that accepts a function or class object as its first  or only argument. There are different types of renderers; in this case, the  response will be returned as a JSON string.</p>
<p>
  You can also return  custom objects using a renderer:</p>
<pre>@view_config(renderer='json')

def objects(request):
    return [MyObject(1), MyObject(2)]</pre>
<p>
  In this example, the renderer will return the objects in JSON  notation.</p>
<p>
  If a view callable has both a renderer and a response, the default  is to return the <tt>Response</tt> object and not the <tt>renderer</tt> instance.</p>
<h2>Conclusion</h2>
<p>In this article, you learned about view callables and how they're  used to return a response. Sometimes a response can be a <tt>Response</tt> object  or a <tt>renderer</tt> object. You also learned that the Pyramid <tt>request</tt> object has a method to hold form parameters, which can be rendered through a  view callable. You can do simple redirects with the <tt>HTTPFound</tt> class.</p>
<p>
  It's important to know that different renderer types can return a  string or plain text, JSON format, or custom objects. Renderers are useful for  sharing information between views. There are even template renderers that  render certain types of templates. You can pass keywords or arguments to these  templates. You can also create your own renderers by creating and registering a <em>renderer factory</em>.</p>
<p>
  <a href="/articles/article.aspx?p=2161681">Part 6 of this series</a> will cover templates in greater detail. At this stage of the  series, you should be getting more comfortable with developing Pyramid web  applications and the potential the framework has for handling large  applications.</p>
            </div>
            </div></body></html>