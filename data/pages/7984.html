<html><body><div><article class="post">
  <h1 class="post-title">Creating standalone Mac OS X applications with Python and py2app</h1>
  <time datetime="2015-11-28T00:00:00+01:00" class="post-date">28 Nov 2015</time>

  <p>In this tutorial we’ll be using <a href="https://pythonhosted.org/py2app/">py2app</a> to create a standalone OSX application from a Python 2 or 3 source code with a
simple <a href="https://wiki.python.org/moin/TkInter">Tkinter</a> user interface.</p>

<blockquote>"py2app is a Python setuptools command which will allow you to make standalone application bundles and plugins from Python scripts. py2app is similar in purpose and design to py2exe for Windows."</blockquote>

<p>Relevant links about py2app:</p>



<p>This guide is loosely based on the <a href="https://pythonhosted.org/py2app/tutorial.html">official tutorial</a>.
Based on a Python file called <code>Sandwich.py</code>, we’ll create an application called <code>Sandwich.app</code>.</p>

<p><img src="/images/posts/py2app/app_finder.png" alt="App Icon"/></p>

<h2 id="prerequisites">Prerequisites</h2>

<p>Create a custom directory and create a <a href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">virtualenv</a>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Create a custom directory</span>
<span class="gp">$ </span>mkdir SandwichApp
<span class="gp">$ </span><span class="nb">cd </span>SandwichApp

<span class="c"># Use virtualenv to create an isolated environment</span>
<span class="gp">$ </span>virtualenv venv
<span class="gp">$ </span>. venv/bin/activate</code></pre></figure>

<p>Now create a very simple <a href="https://wiki.python.org/moin/TkInter">Tkinter</a> app with the filename <code>Sandwich.py</code>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
    <span class="c"># Python 2</span>
    <span class="kn">import</span> <span class="nn">Tkinter</span> <span class="kn">as</span> <span class="nn">tk</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c"># Python 3</span>
    <span class="kn">import</span> <span class="nn">tkinter</span> <span class="kn">as</span> <span class="nn">tk</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Sandwich"</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">"Make me a Sandwich"</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
<span class="n">tk</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></code></pre></figure>

<p>This little app will look like this:</p>

<p><img src="/images/posts/py2app/app_screen.png" alt="App Screen"/></p>

<h2 id="install-py2app">Install py2app</h2>

<p>The original version of py2app has a bug due to a newer version of ModuleGraph. I
made a fork of the project and fixed this bug <a href="https://github.com/metachris/py2app">on Github</a>.
Install it with pip like this:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>pip install -U git+https://github.com/metachris/py2app.git@master</code></pre></figure>

<h2 id="create-a-setuppy-file">Create a <code>setup.py</code> file</h2>

<p>py2app includes <code>py2applet</code>, a helper which generates a setup.py file for you:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>py2applet --make-setup Sandwich.py
Wrote setup.py</code></pre></figure>

<p>This <code>setup.py</code> is a basic definition of the app:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="n">APP</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Sandwich.py'</span><span class="p">]</span>
<span class="n">DATA_FILES</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">OPTIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s">'argv_emulation'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">app</span><span class="o">=</span><span class="n">APP</span><span class="p">,</span>
    <span class="n">data_files</span><span class="o">=</span><span class="n">DATA_FILES</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s">'py2app'</span><span class="p">:</span> <span class="n">OPTIONS</span><span class="p">},</span>
    <span class="n">setup_requires</span><span class="o">=</span><span class="p">[</span><span class="s">'py2app'</span><span class="p">],</span>
<span class="p">)</span></code></pre></figure>

<p>If your application uses some data files, like a JSON, text files or images, you should include them in DATA_FILES. For example:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">DATA_FILES</span> <span class="o">=</span> <span class="p">[</span><span class="s">'testdata.json'</span><span class="p">,</span> <span class="s">'picture.png'</span><span class="p">]</span></code></pre></figure>

<h2 id="build-the-app-for-development-and-testing">Build the app for development and testing</h2>

<p>py2app builds the standalone application based on the definition in <code>setup.py</code>.</p>

<p>For testing and development, py2app provides an “<em>alias mode</em>”, which builds an
app with symbolic links to the development files:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>python setup.py py2app -A</code></pre></figure>

<p>This creates the following files and directories:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">.
├── build
│   └── bdist.macosx-10.10-x86_64
│       └── python2.7-standalone
│           └── app
│               ├── Frameworks
│               ├── collect
│               ├── lib-dynload
│               └── temp
├── Sandwich.py
├── dist
│   └── Sandwich.app
│       └── Contents
│           ├── Info.plist
│           ├── MacOS
│           │   ├── Sandwich
│           │   └── python -&gt; /Users/chris/Projects/chris/python-gui/tkinter/env/bin/../bin/python
│           ├── PkgInfo
│           └── Resources
│               ├── __boot__.py
│               ├── __error__.sh
│               ├── lib
│               │   └── python2.7
│               │       ├── config -&gt; /Users/chris/Projects/chris/python-gui/tkinter/env/bin/../lib/python2.7/config
│               │       └── site.pyc -&gt; ../../site.pyc
│               ├── site.py
│               └── site.pyc
└── setup.py</code></pre></figure>

<p>This is not a standalone application, and the applications built in alias mode are not portable to other machines!</p>

<p>The app built with alias mode simply references the original code files, so any changes you make to the original <code>Sandwich.py</code> file are instantly available on the next app start.</p>

<p>The resulting development app in <code>dist/Sandwich.app</code> can be opened just like any other .app with the Finder
or the open command (<code>$ open dist/Sandwich.app</code>). To run your application directly from the Terminal
you can just run:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>./dist/Sandwich.app/Contents/MacOS/Sandwich</code></pre></figure>

<h2 id="building-for-deployment">Building for deployment</h2>

<p>When everything is tested you can produce a build for deployment with a calling <code>python setup.py py2app</code>. Make sure that any old <code>build</code> and <code>dist</code> directories are removed:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>rm -rf build dist
<span class="gp">$ </span>python setup.py py2app</code></pre></figure>

<p>This will assemble your application as <code>dist/Sandwich.app</code>. Since this application is self-contained, you will have to run the py2app command again any time you change any source code, data files, options, etc.</p>

<p>The original py2app has a bug which would display “<code>AttributeError: 'ModuleGraph' object has no attribute 'scan_code'</code>” or <code>load_module</code>. If you encounter this error, take
a look at this <a href="http://stackoverflow.com/a/29449144/5433572">StackOverflow thread</a> or use my <a href="https://github.com/metachris/py2app">fork of py2app</a>.</p>

<p>The easiest way to wrap your application up for distribution at this point is simply to right-click the application from Finder and choose “Create Archive”.</p>

<h2 id="adding-an-icon">Adding an icon</h2>

<p>Simply add <code>"iconfile": "youricon.icns"</code> to the <code>OPTIONS</code> dict:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="n">APP</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Sandwich.py'</span><span class="p">]</span>
<span class="n">DATA_FILES</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">OPTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'argv_emulation'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="s">'iconfile'</span><span class="p">:</span> <span class="s">'app.icns'</span>
<span class="p">}</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">app</span><span class="o">=</span><span class="n">APP</span><span class="p">,</span>
    <span class="n">data_files</span><span class="o">=</span><span class="n">DATA_FILES</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s">'py2app'</span><span class="p">:</span> <span class="n">OPTIONS</span><span class="p">},</span>
    <span class="n">setup_requires</span><span class="o">=</span><span class="p">[</span><span class="s">'py2app'</span><span class="p">],</span>
<span class="p">)</span></code></pre></figure>

<p>You can find free icons in icns format around the web (eg. on <a href="https://www.iconfinder.com/search/?q=&amp;price=free">IconFinder</a> or  <a href="http://www.freepik.com/free-icons">freepik</a>).</p>

<h2 id="advanced-app-settings">Advanced app settings</h2>

<p>You can tweak the application information and behaviour with modifications
to the <code>Info.plist</code>. The most complete reference for the keys available is <a href="http://developer.apple.com/documentation/MacOSX/Conceptual/BPRuntimeConfig/index.html">Apple’s Runtime Configuration Guidelines</a>.</p>

<p>Here is an example with more modifications:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="n">APP</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Sandwich.py'</span><span class="p">]</span>
<span class="n">APP_NAME</span> <span class="o">=</span> <span class="s">"SuperSandwich"</span>
<span class="n">DATA_FILES</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">OPTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'argv_emulation'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="s">'iconfile'</span><span class="p">:</span> <span class="s">'app.icns'</span><span class="p">,</span>
    <span class="s">'plist'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'CFBundleName'</span><span class="p">:</span> <span class="n">APP_NAME</span><span class="p">,</span>
        <span class="s">'CFBundleDisplayName'</span><span class="p">:</span> <span class="n">APP_NAME</span><span class="p">,</span>
        <span class="s">'CFBundleGetInfoString'</span><span class="p">:</span> <span class="s">"Making Sandwiches"</span><span class="p">,</span>
        <span class="s">'CFBundleIdentifier'</span><span class="p">:</span> <span class="s">"com.metachris.osx.sandwich"</span><span class="p">,</span>
        <span class="s">'CFBundleVersion'</span><span class="p">:</span> <span class="s">"0.1.0"</span><span class="p">,</span>
        <span class="s">'CFBundleShortVersionString'</span><span class="p">:</span> <span class="s">"0.1.0"</span><span class="p">,</span>
        <span class="s">'NSHumanReadableCopyright'</span><span class="p">:</span> <span class="s">u"Copyright © 2015, Chris Hager, All Rights Reserved"</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">APP_NAME</span><span class="p">,</span>
    <span class="n">app</span><span class="o">=</span><span class="n">APP</span><span class="p">,</span>
    <span class="n">data_files</span><span class="o">=</span><span class="n">DATA_FILES</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s">'py2app'</span><span class="p">:</span> <span class="n">OPTIONS</span><span class="p">},</span>
    <span class="n">setup_requires</span><span class="o">=</span><span class="p">[</span><span class="s">'py2app'</span><span class="p">],</span>
<span class="p">)</span></code></pre></figure>

<p>With these settings, the app will have the following infos:</p>

<p><img src="/images/posts/py2app/get_info.png" alt="Finder Get Info"/></p>

<hr class="spaced"/>

<h2 id="references">References</h2>



<h2 id="see-also">See Also</h2>



<hr class="spaced"/>

<p>If you have suggestions, feedback or ideas, please reach out to me <a href="https://twitter.com/metachris" target="_blank">@metachris</a>.</p>


</article>

</div></body></html>