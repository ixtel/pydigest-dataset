<html><body><div><div class="text" id="extended"><p>I may be the last person out there to do that, but i hadn’t actually gotten to 
   that yet. 
</p>
<p>So here is the thing, sometime you want to produce a text file, with some 
   complex structure, and string.format is not really up to the task, so you 
   scratch your head and wonder what could be useful to… template an output.
</p>
<p>Then a nice lib like <a href="http://jinja.pocoo.org/docs/">jinja2</a> totally makes sense.
</p>
<p>For my use case, i want to generate java source code, using info parsed from 
   other java source code (thanks to the awesome <a href="https://github.com/musiKk/plyj">plyj</a> lib), so it’s easy to give 
   the general form of the output file, and to pass the content after that.
</p>
<pre><code>{% if package %}package {{ package }};{% endif %}
import {{ module.package_declaration.name.value }}.*;
{{ imports }}\

public class {{ cls.name }}{{ suffix }} extends {{ cls.name }} {
    public interface I{{ cls.name }} {\
    {% for method in methods %}
    {{ method.return_type | get_type }} {{ method.name }}({{ method.parameters | render_params }});\
    {% endfor %}
    }

    private I{{ cls.name }} implem = null;

    public void setImplem(I{{ cls.name }} implem) {
    this.implem = implem;
    }

    {% for method in methods %}
    {{ method.return_type | get_type }} {{ method.name }}({{ method.parameters | render_params }}) {
    if (this.implem)
        return this.implem.{{ method.name }}({{ method.parameters | render_params_values }});
    }{% endfor %}
}
</code></pre><p>One problem i had, though, was when it turned out it would be convenient to use 
   custom filters inside my template, it took me some time to find the relevant 
   documentation about how to register functions as filters in this situation 
   (since people usually use jinja2 in a framework, they document how to do so 
   using the environment used by this framework).
</p>
<p>So the answer was not to use jinja2.Template directly, but to build an 
   environment before.
</p>
<pre><code>env = jinja2.Environment()
</code></pre><p>then to setup my filters in this environment:
</p>
<pre><code>env.filters['render_params'] = render_params
env.filters['render_params_values'] = render_params_values
env.filters['get_type'] = get_type
</code></pre><p>and to use <code>env.template_from_string(template_string)</code> to create a Template object from my 
   string.
</p>
    
        <p class="gittip_button">
        Tip me if you like this :)
        
        </p>
        
            
        </div>
    </div></body></html>