<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-pytest-benchmark" class="anchor" href="#pytest-benchmark" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>pytest-benchmark</h1>

<p>A <code>py.test</code> fixture for benchmarking code. It will group the tests into rounds that are calibrated to the chosen timer. See <a href="http://pytest-benchmark.readthedocs.org/en/latest/features.html#calibration">calibration</a>
and <a href="http://pytest-benchmark.readthedocs.org/en/latest/faq.html">FAQ</a>.</p>
<ul>
<li>Free software: BSD license</li>
</ul>
<a name="user-content-installation"/>
<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>
<pre>pip install pytest-benchmark
</pre>
<a name="user-content-documentation"/>
<h2><a id="user-content-documentation" class="anchor" href="#documentation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Documentation</h2>
<p>Available at: <a href="http://pytest-benchmark.readthedocs.org/en/stable/">pytest-benchmark.readthedocs.org</a>.</p>
<a name="user-content-examples"/>
<h2><a id="user-content-examples" class="anchor" href="#examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Examples</h2>
<p>This plugin provides a benchmark fixture. This fixture is a callable object that will benchmark any function passed
to it.</p>
<p>Example:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">something</span>(<span class="pl-smi">duration</span><span class="pl-k">=</span><span class="pl-c1">0.000001</span>):
    <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">    Function that needs some serious benchmarking.</span>
<span class="pl-s">    <span class="pl-pds">"""</span></span>
    time.sleep(duration)
    <span class="pl-c"># You may return anything you want, like the result of a computation</span>
    <span class="pl-k">return</span> <span class="pl-c1">123</span>

<span class="pl-k">def</span> <span class="pl-en">test_my_stuff</span>(<span class="pl-smi">benchmark</span>):
    <span class="pl-c"># benchmark something</span>
    result <span class="pl-k">=</span> benchmark(something)

    <span class="pl-c"># Extra code, to verify that the run completed correctly.</span>
    <span class="pl-c"># Sometimes you may want to check the result, fast functions</span>
    <span class="pl-c"># are no good if they return incorrect results :-)</span>
    <span class="pl-k">assert</span> result <span class="pl-k">==</span> <span class="pl-c1">123</span></pre></div>
<p>You can also pass extra arguments:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">test_my_stuff</span>(<span class="pl-smi">benchmark</span>):
    benchmark(time.sleep, <span class="pl-c1">0.02</span>)</pre></div>
<p>Or even keyword arguments:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">test_my_stuff</span>(<span class="pl-smi">benchmark</span>):
    benchmark(time.sleep, <span class="pl-v">duration</span><span class="pl-k">=</span><span class="pl-c1">0.02</span>)</pre></div>
<p>Another pattern seen in the wild, that is not recommended for micro-benchmarks (very fast code) but may be convenient:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">test_my_stuff</span>(<span class="pl-smi">benchmark</span>):
    <span class="pl-en">@benchmark</span>
    <span class="pl-k">def</span> <span class="pl-en">something</span>():  <span class="pl-c"># unnecessary function call</span>
        time.sleep(<span class="pl-c1">0.000001</span>)</pre></div>
<p>A better way is to just benchmark the final function:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">test_my_stuff</span>(<span class="pl-smi">benchmark</span>):
    benchmark(time.sleep, <span class="pl-c1">0.000001</span>)  <span class="pl-c"># way more accurate results!</span></pre></div>
<p>If you need to do fine control over how the benchmark is run (like a setup function, exact control of iterations and
rounds) there's a special mode - <a href="http://pytest-benchmark.readthedocs.org/en/latest/pedantic.html">pedantic</a>:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">my_special_setup</span>():
    <span class="pl-c1">...</span>

<span class="pl-k">def</span> <span class="pl-en">test_with_setup</span>(<span class="pl-smi">benchmark</span>):
    benchmark.pedantic(something, <span class="pl-v">setup</span><span class="pl-k">=</span>my_special_setup, <span class="pl-v">args</span><span class="pl-k">=</span>(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>), <span class="pl-v">kwargs</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span>}, <span class="pl-v">iterations</span><span class="pl-k">=</span><span class="pl-c1">10</span>, <span class="pl-v">rounds</span><span class="pl-k">=</span><span class="pl-c1">100</span>)</pre></div>
<a name="user-content-screenshots"/>
<h3><a id="user-content-screenshots" class="anchor" href="#screenshots" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Screenshots</h3>
<p>Normal run:</p>
<a href="https://github.com/ionelmc/pytest-benchmark/raw/master/docs/screenshot.png" target="_blank"><img alt="Screenshot of py.test summary" src="https://github.com/ionelmc/pytest-benchmark/raw/master/docs/screenshot.png"/></a>
<p>Compare mode (<code>--benchmark-compare</code>):</p>
<a href="https://github.com/ionelmc/pytest-benchmark/raw/master/docs/screenshot-compare.png" target="_blank"><img alt="Screenshot of py.test summary in compare mode" src="https://github.com/ionelmc/pytest-benchmark/raw/master/docs/screenshot-compare.png"/></a>
<p>Histogram (<code>--benchmark-histogram</code>):</p>
<a href="https://camo.githubusercontent.com/f0f291d5549e82f5ea053b8b6259cc6296d7886a/68747470733a2f2f63646e2e7261776769742e636f6d2f696f6e656c6d632f7079746573742d62656e63686d61726b2f393438363063633866343761656437626134663963376531333830633231393533343236313366362f646f63732f73616d706c652d74657374735f746573745f6e6f726d616c2e70795f746573745f78666173745f706172616d657472697a6564253542302535442e737667" target="_blank"><img alt="Histogram sample" src="https://camo.githubusercontent.com/f0f291d5549e82f5ea053b8b6259cc6296d7886a/68747470733a2f2f63646e2e7261776769742e636f6d2f696f6e656c6d632f7079746573742d62656e63686d61726b2f393438363063633866343761656437626134663963376531333830633231393533343236313366362f646f63732f73616d706c652d74657374735f746573745f6e6f726d616c2e70795f746573745f78666173745f706172616d657472697a6564253542302535442e737667" data-canonical-src="https://cdn.rawgit.com/ionelmc/pytest-benchmark/94860cc8f47aed7ba4f9c7e1380c2195342613f6/docs/sample-tests_test_normal.py_test_xfast_parametrized%5B0%5D.svg"/></a>
<blockquote>
Also, it has <a href="https://cdn.rawgit.com/ionelmc/pytest-benchmark/master/docs/sample.svg">nice tooltips</a>.</blockquote>
<a name="user-content-development"/>
<h2><a id="user-content-development" class="anchor" href="#development" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Development</h2>
<p>To run the all tests run:</p>
<pre>tox
</pre>
<a name="user-content-credits"/>
<h2><a id="user-content-credits" class="anchor" href="#credits" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Credits</h2>


</article>
  </div></body></html>