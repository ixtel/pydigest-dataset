<html><body><div><div class="section">
              <h1>apigen 1.5.0</h1>

              


<p>Easily create a CLI and JSON-RPC interface from a common API definition.</p>








<p>Easily create a CLI and JSON-RPC interface from a common API definition.</p>
<div id="installation">
<h2>Installation</h2>
<pre>pip install apigen
</pre>
</div>
<div id="example-api-definition">
<h2>Example API definition</h2>
<p>I simple example application with an add command.</p>
<pre><span class="c1"># from examples/basic.py</span>
<span class="kn">import</span> <span class="nn">apigen</span>


<span class="c1"># automatically added verison command will use module version if present</span>
<span class="c1"># rpc exceptions will also include module version if persent</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">"1.0.0"</span>


<span class="k">class</span> <span class="nc">Calculator</span><span class="p">(</span><span class="n">apigen</span><span class="o">.</span><span class="n">Definition</span><span class="p">):</span>  <span class="c1"># Programm name taken from class name.</span>
    <span class="sd">"""Example Programm"""</span>  <span class="c1"># Programm help text taken from class doc string.</span>

    <span class="nd">@apigen.command</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>  <span class="c1"># Command name and args taken from method.</span>
        <span class="sd">"""adds two items"""</span>  <span class="c1"># Help text taken from method doc string.</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>  <span class="c1"># Returned rpc/cli output (must be JSON serializable).</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">apigen</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">Calculator</span><span class="p">)</span>  <span class="c1"># Run CLI interface.</span>
</pre>
<p>The created CLI/RPC interface behaves as you would expect from a python class.</p>
<blockquote>
<ul>
<li>Programm arguments are taken from the __init__ method.</li>
<li>Command arguments are taken from the respective command methods.</li>
<li>Manditory and optional arguments work just like you would expect in python.</li>
<li>In addition arguments with the default value False are flags in the CLI.</li>
</ul>
</blockquote>
<pre><span class="c1"># from examples/arguments.py</span>
<span class="kn">import</span> <span class="nn">apigen</span>


<span class="k">class</span> <span class="nc">ArgumentsExample</span><span class="p">(</span><span class="n">apigen</span><span class="o">.</span><span class="n">Definition</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="s2">"default/path.json"</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">quiet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span> <span class="o">=</span> <span class="n">config_path</span>

    <span class="nd">@apigen.command</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">show_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="s2">"Default"</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">"noise"</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span> <span class="s1">'first'</span><span class="p">:</span> <span class="n">first</span><span class="p">,</span> <span class="s1">'second'</span><span class="p">:</span> <span class="n">second</span><span class="p">,</span> <span class="s1">'optional'</span><span class="p">:</span> <span class="n">optional</span> <span class="p">}</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">apigen</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ArgumentsExample</span><span class="p">)</span>
</pre>
</div>
<div id="generated-cli-interface-uses-argparse">
<h2>Generated CLI interface (uses argparse)</h2>
<p>Generated CLI interface.</p>
<pre># Program, command and arguments order.
$ python program.py [program arguments] &lt;command&gt; [command arguments]

# Argument format.
$ python program.py positional_argument_value --optional_argument=value --flag
</pre>
<p>Showing the generated help.</p>
<pre># Show programm help text.
$ python examples/basic.py --help

# Show command help text
$ python examples/basic.py startserver --help
</pre>
<p>CLI arguments must be given as json data.The json data automatically is
unmarshalled before calling the command function and the returned result is
automatically marshalled.</p>
<pre>$ python examples/basic.py add 1 2
3

$ python examples/basic.py add 1.1 2.2
3.3000000000000003

$ python examples/basic.py add "foo" "bar"
"foobar"

$ python examples/basic.py add "[1,2,3]" "[4,5,6]"
[
  1,
  2,
  3,
  4,
  5,
  6
]
</pre>
</div>
<div id="client-side-json-rpc-usage-with-python-jsonrpc">
<h2>Client side json-rpc usage with python-jsonrpc.</h2>
<p>Starting the jsonrpc server from the command line.</p>
<pre>$ python examples/basic.py startserver
Starting Calculator json-rpc service at http://localhost:8080
</pre>
<p>RPC arguments must be given as json serializable data. The arguments will
automatically be marshalled and unmarshalled.</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pyjsonrpc</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">rpc</span> <span class="o">=</span> <span class="n">pyjsonrpc</span><span class="o">.</span><span class="n">HttpClient</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="s2">"http://localhost:8080"</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">rpc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">3</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">rpc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">)</span>
<span class="mf">3.3000000000000003</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">rpc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"bar"</span><span class="p">)</span>
<span class="s1">u'foobar'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">rpc</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre>
<p>Client side exception handeling.</p>
<pre><span class="c1"># from examples/exceptions.py</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pyjsonrpc</span>


<span class="n">rpc</span> <span class="o">=</span> <span class="n">pyjsonrpc</span><span class="o">.</span><span class="n">HttpClient</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">"http://localhost:8080"</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">rpc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"str"</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pyjsonrpc</span><span class="o">.</span><span class="n">rpcerror</span><span class="o">.</span><span class="n">JsonRpcError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span>  <span class="c1"># see http://www.jsonrpc.org/specification#error_object</span>

    <span class="c1"># Server error if an exception is raised during the call.</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">32000</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">32099</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span>  <span class="c1"># source exception message</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">data</span><span class="p">[</span><span class="s2">"classname"</span><span class="p">]</span>  <span class="c1"># source exception class name</span>
        <span class="k">print</span> <span class="n">data</span><span class="p">[</span><span class="s2">"repr"</span><span class="p">]</span>  <span class="c1"># source exception repr string</span>
        <span class="k">print</span> <span class="n">data</span><span class="p">[</span><span class="s2">"traceback"</span><span class="p">]</span>  <span class="c1"># source exception traceback</span>
        <span class="k">print</span> <span class="n">data</span><span class="p">[</span><span class="s2">"version"</span><span class="p">]</span>  <span class="c1"># source module version if present</span>
</pre>
<p>Starting the jsonrpc service from within python.</p>
<pre><span class="kn">import</span> <span class="nn">basic</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Calculator</span><span class="p">()</span>
<span class="n">api</span><span class="o">.</span><span class="n">startserver</span><span class="p">()</span>
</pre>
<p>Getting a pyjsonrpc.HttpRequestHandler for further use.</p>
<pre><span class="kn">import</span> <span class="nn">basic</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Calculator</span><span class="p">()</span>
<span class="n">api</span><span class="o">.</span><span class="n">get_http_request_handler</span><span class="p">()</span>
</pre>
</div>
<div id="client-side-json-rpc-usage-with-javascript">
<h2>Client side json-rpc usage with javascript</h2>
<pre><span class="c1">// from examples/node.js
</span>
<span class="c1">// https://www.npmjs.com/package/node-json-rpc
// npm install node-json-rpc
</span><span class="kd">var</span> <span class="nx">rpc</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'node-json-rpc'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">rpc</span><span class="p">.</span><span class="nx">Client</span><span class="p">({</span>
      <span class="nx">port</span><span class="o">:</span> <span class="mi">8080</span><span class="p">,</span>
      <span class="nx">host</span><span class="o">:</span> <span class="s1">'127.0.0.1'</span><span class="p">,</span>
      <span class="nx">path</span><span class="o">:</span> <span class="s1">'/'</span><span class="p">,</span>
<span class="p">});</span>

<span class="nx">client</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span>
    <span class="s2">"jsonrpc"</span><span class="o">:</span> <span class="s2">"2.0"</span><span class="p">,</span>
    <span class="s2">"method"</span><span class="o">:</span> <span class="s2">"add"</span><span class="p">,</span>
    <span class="s2">"params"</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="nx">b</span><span class="o">:</span> <span class="mi">3</span>
    <span class="p">},</span>
    <span class="s2">"id"</span><span class="o">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Error add"</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Success add"</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre>
<pre>$ node examples/node.js
Success add
{ jsonrpc: '2.0', id: 0, result: 4 }
</pre>
</div>


<a name="downloads">Â </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>654</span> downloads in the last week
  </li>
  <li>
    <span>2650</span> downloads in the last month
  </li>
</ul>



<ul class="nodot">
 <li>
  <strong>Author:</strong>
  <span>Fabian Barkhau</span>
 </li>

 

 


 <li>
  <strong>Home Page:</strong>
  
  <a href="https://github.com/F483/apigen/">https://github.com/F483/apigen/</a>
 </li>


 

 


 <li>
  <strong>Keywords:</strong>
  <span>CLI,JSON,RPC,JSON-RPC,API,Remote Procedure Call,JavaScript Object Notation,argparse,Data Interchange</span>
 </li>

 <li>
  <strong>License:</strong>
  
  
  <span>MIT</span>
  
 </li>

 


 
 
 

 <li>
  <strong>Categories</strong>
  
 </li>



 

 

 

 

 


 <li>
  <strong>Package Index Owner:</strong>
  <span>F483</span>
 </li>

 

 <li>
  <strong><a href="http://usefulinc.com/doap">DOAP</a> record:</strong>
  <a href="/pypi?:action=doap&amp;name=apigen&amp;version=1.5.0">apigen-1.5.0.xml</a>
 </li>

</ul>





            </div>


          </div></body></html>