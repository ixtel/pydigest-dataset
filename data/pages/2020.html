<html><body><div><div class="post-text" itemprop="text">
<p>I don't see any sense in trying to do this in a single pass, if the elements you are getting to after each split are semantically  diffent. </p>

<p>You could start by spliting by ":" -- that wold get you to the fine grained data - but what good would that be, if you wold not know were does this data belong? </p>

<p>That said, you could put all the levels of separation inside a generator, and have it yield
dictionary-objects with your data, ready for consunption:</p>

<pre><code>def iana_parse(data):
    for record in data.split("%%\n"):
        # skip empty records at file endings:
        if not record.strip():
            continue
        rec_data = {}
        for line in record.split("\n"):
            key, value = line.split(":")
            rec_data[key.strip()] = value.strip()
        yield rec_data
</code></pre>

<p>It can be done as a one liner as you request in the comments - but as I commented back,
It could be written to fit as a single expression in one line. It took more time to write than the example above, and would be nearly impossible to maintain. The code in the example above unfolds the logic in a few lines of code, that are placed "out of the way" - i.e. not inline where you are deaing witht he actual data, providing readability and maintainability for both tasks.</p>

<p>That said, parsing as a structure of nested lists as you want can be done thus:</p>

<pre><code>structure = [[[token.strip() for token in line.split(":")] for line in record.split("\n") ] for record in data.split("%%") if record.strip() ]
</code></pre>
    </div>
    </div></body></html>