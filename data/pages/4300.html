<html><body><div><div class="entry-content clearfix"><p><strong>Let’s build a command-line utility for quickly generating a Flask boilerplate structure.</strong></p>














<p><em>This is a collaboration piece between <a href="https://github.com/Depado">Depado</a> and the folks at Real Python.</em></p>

<hr/>


<p>Modeled after the <a href="https://github.com/Depado/flask-skeleton">Flask-Skeleton</a> project, <em>this tool will automate a number of repetitive tasks so that you can quickly get a Flask project up and running with the structure, extensions, and configurations that you prefer</em>, step by step:</p>

<ol>
<li>Set up the basic structure</li>
<li>Add a custom config file</li>
<li>Utilize <a href="http://bower.io/">Bower</a> to manage front-end dependencies</li>
<li>Create a virtualenv</li>
<li>Initialize Git</li>
</ol>


<p>Once done, you’ll have a powerful scaffolding script that you can (and should) customize to meet your own development needs.</p>

<a name="Quickstart"/>
<h2>Quickstart</h2>

<p>To start, we need a basic Flask application. For simplicity, we’ll use the <a href="https://github.com/realpython/flask-skeleton">Real Python boilerplate Flask structure</a>, so just clone it down to set the base structure:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>mkdir flask-scaffold
</span><span class="line"><span class="nv">$ </span><span class="nb">cd </span>flask-scaffold
</span><span class="line"><span class="nv">$ </span>git clone https://github.com/realpython/flask-skeleton skeleton
</span><span class="line"><span class="nv">$ </span>rm -rf skeleton/.git
</span><span class="line"><span class="nv">$ </span>rm skeleton/project/config.py skeleton/.gitignore
</span><span class="line"><span class="nv">$ </span>mkdir templates
</span><span class="line"><span class="nv">$ </span>pyvenv-3.4 env
</span><span class="line"><span class="nv">$ </span><span class="nb">source </span>env/bin/activate
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>Yes, this article utilizes Python 3.4; however, the final script is compatible with both Python 2 and 3.</p></blockquote>

<a name="L1st.Task.-.The.Structure"/>
<h2>1st Task – The Structure</h2>

<p>Save a new Python file as <em>flask_skeleton.py</em> in the root directory. This file will be used to power the entire scaffolding utility. Open it up in you favorite text editor and add the following code:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="line">
</span><span class="line"><span class="kn">import</span> <span class="nn">sys</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">os</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">argparse</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">shutil</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="c"># Globals #</span>
</span><span class="line">
</span><span class="line"><span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span class="line"><span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="c"># Arguments #</span>
</span><span class="line">
</span><span class="line">    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">'Scaffold a Flask Skeleton.'</span><span class="p">)</span>
</span><span class="line">    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'appname'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'The application name'</span><span class="p">)</span>
</span><span class="line">    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-s'</span><span class="p">,</span> <span class="s">'--skeleton'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'The skeleton folder to use.'</span><span class="p">)</span>
</span><span class="line">    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span><span class="line">
</span><span class="line">    <span class="c"># Variables #</span>
</span><span class="line">
</span><span class="line">    <span class="n">appname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">appname</span>
</span><span class="line">    <span class="n">fullpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">appname</span><span class="p">)</span>
</span><span class="line">    <span class="n">skeleton_dir</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">skeleton</span>
</span><span class="line">
</span><span class="line">    <span class="c"># Tasks #</span>
</span><span class="line">
</span><span class="line">    <span class="c"># Copy files and folders</span>
</span><span class="line">    <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="n">skeleton_dir</span><span class="p">),</span> <span class="n">fullpath</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
</span><span class="line">    <span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here, we’re using <a href="https://docs.python.org/3/library/argparse.html">argparse</a> to obtain an <code>appname</code> for the new project and then copying the <em>skeleton</em> directory (via <a href="https://docs.python.org/3.4/library/shutil.html">shutil</a>), which contains the project boilerplate, to quickly recreate the project structure.</p>

<p>The <code>shutil.copytree()</code> method (<a href="https://docs.python.org/3/library/shutil.html#shutil.copytree">source</a>) is used to recursively copy a source directory to a destination directory (as long as the destination directory does not already exist).</p>

<p>Test it out:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python flask_skeleton.py new_project -s skeleton
</span></code></pre></td></tr></table></div></figure>


<p>This should make a copy of the Real Python boilerplate Flask structure (source) to a new directory called “new_project” (destination). Did it work? If so, remove the new project since there’s still much work to be done:</p>

<figure class="code"><figcaption><span/></figcaption></figure>


<a name="Handling.Multiple.Skeletons"/>
<h3>Handling Multiple Skeletons</h3>

<p>What if you need an app with a MongoDB database or a payments blueprint? All apps have specific needs and you obviously can’t create a skeleton for them all, but perhaps you need a NoSQL database about fifty percent of the time. You can add a new skeleton to the root to accomplish this. Then when you run the scaffold command, simply specify the name of the directory containing the skeleton app you wish to make a copy of.</p>

<a name="L2nd.Task.-.Configuration"/>
<h2>2nd Task – Configuration</h2>

<blockquote><p>Need the script up to this point? Grab it from the first <a href="https://github.com/realpython/flask-scaffold/releases/tag/first_tag">tag</a>. Or if you cloned the <a href="https://github.com/realpython/flask-scaffold">repo</a>, you can grab the tag like so – <code>git checkout tags/first_tag</code>.</p></blockquote>

<p>We now need to generate a custom <em>config.py</em> file for each skeleton. This script is going to do just that for us; let the code do the repetitive work! First, add a file called <em>config.jinja2</em> in the <em>templates</em> folder:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># config.jinja2</span>
</span><span class="line">
</span><span class="line"><span class="kn">import</span> <span class="nn">os</span>
</span><span class="line"><span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">BaseConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span class="line">    <span class="sd">"""Base configuration."""</span>
</span><span class="line">    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'{{ secret_key }}'</span>
</span><span class="line">    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="line">    <span class="n">BCRYPT_LOG_ROUNDS</span> <span class="o">=</span> <span class="mi">13</span>
</span><span class="line">    <span class="n">WTF_CSRF_ENABLED</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class="line">    <span class="n">DEBUG_TB_ENABLED</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="line">    <span class="n">DEBUG_TB_INTERCEPT_REDIRECTS</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">DevelopmentConfig</span><span class="p">(</span><span class="n">BaseConfig</span><span class="p">):</span>
</span><span class="line">    <span class="sd">"""Development configuration."""</span>
</span><span class="line">    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class="line">    <span class="n">BCRYPT_LOG_ROUNDS</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class="line">    <span class="n">WTF_CSRF_ENABLED</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="line">    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s">'sqlite:///'</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s">'dev.sqlite'</span><span class="p">)</span>
</span><span class="line">    <span class="n">DEBUG_TB_ENABLED</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">TestingConfig</span><span class="p">(</span><span class="n">BaseConfig</span><span class="p">):</span>
</span><span class="line">    <span class="sd">"""Testing configuration."""</span>
</span><span class="line">    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class="line">    <span class="n">TESTING</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class="line">    <span class="n">BCRYPT_LOG_ROUNDS</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class="line">    <span class="n">WTF_CSRF_ENABLED</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="line">    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s">'sqlite:///'</span>
</span><span class="line">    <span class="n">DEBUG_TB_ENABLED</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">ProductionConfig</span><span class="p">(</span><span class="n">BaseConfig</span><span class="p">):</span>
</span><span class="line">    <span class="sd">"""Production configuration."""</span>
</span><span class="line">    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'{{ secret_key }}'</span>
</span><span class="line">    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="line">    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s">'postgresql://localhost/example'</span>
</span><span class="line">    <span class="n">DEBUG_TB_ENABLED</span> <span class="o">=</span> <span class="bp">False</span>
</span></code></pre></td></tr></table></div></figure>


<p>At the start of the scaffold script, <code>flask_skeleton.py</code>, just before the <code>main()</code> function, we need to initialize <code>Jinja2</code> in order to render the config correctly.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># Jinja2 environment</span>
</span><span class="line"><span class="n">template_loader</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="n">searchpath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s">"templates"</span><span class="p">))</span>
</span><span class="line"><span class="n">template_env</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">template_loader</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Make sure to add the import as well:</p>

<figure class="code"><figcaption><span/></figcaption></figure>


<p>Install:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>pip install jinja2
</span><span class="line"><span class="nv">$ </span>pip freeze &gt; requirements.txt
</span></code></pre></td></tr></table></div></figure>


<p>Looking back at the template, <em>config.jinja2</em>, we have one variable that needs to be defined – <code>{{ secret_key }}</code>.To do this, we can use the <a href="https://docs.python.org/3/library/codecs.html">codecs</a> module.</p>

<p>To the imports of <code>flask_skeleton.py</code> add:</p>

<figure class="code"><figcaption><span/></figcaption></figure>


<p>Add the following code to the bottom of the <code>main()</code> function:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># Create config.py</span>
</span><span class="line"><span class="n">secret_key</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="s">'hex'</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
</span><span class="line"><span class="n">template</span> <span class="o">=</span> <span class="n">template_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s">'config.jinja2'</span><span class="p">)</span>
</span><span class="line"><span class="n">template_var</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">'secret_key'</span><span class="p">:</span> <span class="n">secret_key</span><span class="p">,</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="s">'project'</span><span class="p">,</span> <span class="s">'config.py'</span><span class="p">),</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
</span><span class="line">    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">template_var</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>What if you manage several skeletons and need several configuration templates? Simple: You just have to check which skeleton is passed as an argument and use the appropriate config template. Keep in mind that <code>os.path.join(fullpath, 'project', 'config.py')</code> must represent the path where your configuration should be stored in your skeleton. If this is different for each skeleton, then you should specify the folder in which the config file is stored in as an additional argparse argument.</p></blockquote>

<p>Ready to test?</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python flask_skeleton.py new_project -s skeleton
</span></code></pre></td></tr></table></div></figure>


<p>Make sure the <em>config.py</em> file is present in the “new_project/project” folder and then remove the new project: <code>rm -rf new_project</code></p>

<a name="L3rd.Task.-.Bower"/>
<h2>3rd Task – Bower</h2>

<blockquote><p>Need the updated script? Grab it <a href="https://github.com/realpython/flask-scaffold/releases/tag/second_tag">here</a>.</p></blockquote>

<p>That’s right: We’ll be using <a href="http://bower.io/">bower</a> to download and manage static libraries. To add bower support to the scaffold script, start with adding another argument:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-b'</span><span class="p">,</span> <span class="s">'--bower'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Install dependencies via bower'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>And to handle the running of bower, add the following code right below the config section of the scaffold script:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># Add bower dependencies</span>
</span><span class="line"><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">bower</span><span class="p">:</span>
</span><span class="line">    <span class="n">bower</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">bower</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)</span>
</span><span class="line">    <span class="n">bower_exe</span> <span class="o">=</span> <span class="n">which</span><span class="p">(</span><span class="s">'bower'</span><span class="p">)</span>
</span><span class="line">    <span class="k">if</span> <span class="n">bower_exe</span><span class="p">:</span>
</span><span class="line">        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="s">'project'</span><span class="p">,</span> <span class="s">'static'</span><span class="p">))</span>
</span><span class="line">        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">bower</span><span class="p">:</span>
</span><span class="line">            <span class="n">output</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span class="line">                <span class="p">[</span><span class="n">bower_exe</span><span class="p">,</span> <span class="s">'install'</span><span class="p">,</span> <span class="n">dependency</span><span class="p">],</span>
</span><span class="line">                <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span class="line">                <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
</span><span class="line">            <span class="p">)</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span><span class="line">            <span class="c"># print(output)</span>
</span><span class="line">            <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
</span><span class="line">                <span class="k">print</span><span class="p">(</span><span class="s">"An error occurred with Bower"</span><span class="p">)</span>
</span><span class="line">                <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span class="line">    <span class="k">else</span><span class="p">:</span>
</span><span class="line">        <span class="k">print</span><span class="p">(</span><span class="s">"Could not find bower. Ignoring."</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Don’t forget to add the <a href="https://docs.python.org/3/library/subprocess.html">subprocess</a> module to the import section of <em>flask_skeleton.py</em> – <code>import subprocess</code>.</p>

<p>Did you notice the <code>which()</code> method (<a href="https://docs.python.org/dev/library/shutil.html#shutil.which">source</a>)? This essentially uses the unix/linux <a href="http://en.wikipedia.org/wiki/Which_%28Unix%29">which</a> tool in order to indicate where an executable is installed in the filesystem. So, in the above code, we’re checking to see if <code>bower</code> is installed. If you’re curious to know how this works, test it out in the Python 3 interpreter:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">&gt;&gt;&gt; import shutil
</span><span class="line">&gt;&gt;&gt; shutil.which<span class="o">(</span><span class="s1">'bower'</span><span class="o">)</span>
</span><span class="line"><span class="s1">'/usr/local/bin/bower'</span>
</span></code></pre></td></tr></table></div></figure>


<p>Unfortunately, this method, <code>which()</code>, is new to Python 3.3, so, if you’re using Python 2, then you need to install a separate package – <a href="https://github.com/mbr/shutilwhich">shutilwhich</a>:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>pip install shutilwhich
</span><span class="line"><span class="nv">$ </span>pip freeze &gt; requirements.txt
</span></code></pre></td></tr></table></div></figure>


<p>Update the imports:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span><span class="line">    <span class="kn">from</span> <span class="nn">shutilwhich</span> <span class="kn">import</span> <span class="n">which</span>
</span><span class="line"><span class="k">else</span><span class="p">:</span>
</span><span class="line">    <span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">which</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, turn you attention to the following lines of code:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">output</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span class="line">    <span class="p">[</span><span class="n">bower_exe</span><span class="p">,</span> <span class="s">'install'</span><span class="p">,</span> <span class="n">dependency</span><span class="p">],</span>
</span><span class="line">    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span class="line">    <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
</span><span class="line"><span class="p">)</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span><span class="line"><span class="c"># print(output)</span>
</span><span class="line"><span class="k">if</span> <span class="n">error</span><span class="p">:</span>
</span><span class="line">    <span class="k">print</span><span class="p">(</span><span class="s">"An error occurred with Bower"</span><span class="p">)</span>
</span><span class="line">    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Start by looking at the official <a href="https://docs.python.org/3.4/library/subprocess.html">subprocess</a> documentation. Put simply, it’s used for invoking external shell commands. In the above code we are simply capturing the output from <a href="http://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29">stdout</a> and <a href="http://en.wikipedia.org/wiki/Standard_streams#Standard_error_.28stderr.29">stderr</a>.</p>

<p>If you’re curious to see what the output is, uncomment the print statement, <code># print(output)</code>, and then run your code…</p>

<p>Before testing, this code assumes that in your skeleton folder(s), you have a “project” folder that contains a “static” folder. Classical Flask application. On the command line, you can now install multiple dependencies like so:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python flask_skeleton.py new_project -s skeleton -b <span class="s1">'angular, jquery, bootstrap'</span>
</span></code></pre></td></tr></table></div></figure>


<a name="L4th.Task.-.virtualenv"/>
<h2>4th Task – virtualenv</h2>

<blockquote><p>Again, grab the updated <a href="https://github.com/realpython/flask-scaffold/releases/tag/third_tag">script</a>, if necessary.</p></blockquote>

<p>Since the virtual environment is one of the most important parts of any Flask (err, Python) application, creating the virtualenv using the scaffold script will be really useful. As usual, start by adding the argument:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-v'</span><span class="p">,</span> <span class="s">'--virtualenv'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>And then add the following code below the bower section:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># Add a virtualenv</span>
</span><span class="line"><span class="n">virtualenv</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">virtualenv</span>
</span><span class="line"><span class="k">if</span> <span class="n">virtualenv</span><span class="p">:</span>
</span><span class="line">    <span class="n">virtualenv_exe</span> <span class="o">=</span> <span class="n">which</span><span class="p">(</span><span class="s">'pyvenv'</span><span class="p">)</span>
</span><span class="line">    <span class="k">if</span> <span class="n">virtualenv_exe</span><span class="p">:</span>
</span><span class="line">        <span class="n">output</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span class="line">            <span class="p">[</span><span class="n">virtualenv_exe</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="s">'env'</span><span class="p">)],</span>
</span><span class="line">            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span class="line">            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
</span><span class="line">        <span class="p">)</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span><span class="line">        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
</span><span class="line">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'virtualenv_error.log'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
</span><span class="line">                <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</span><span class="line">                <span class="k">print</span><span class="p">(</span><span class="s">"An error occurred with virtualenv"</span><span class="p">)</span>
</span><span class="line">                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span class="line">        <span class="n">venv_bin</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="s">'env/bin'</span><span class="p">)</span>
</span><span class="line">        <span class="n">output</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span class="line">            <span class="p">[</span>
</span><span class="line">                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">venv_bin</span><span class="p">,</span> <span class="s">'pip'</span><span class="p">),</span>
</span><span class="line">                <span class="s">'install'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'-r'</span><span class="p">,</span>
</span><span class="line">                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="s">'requirements.txt'</span><span class="p">)</span>
</span><span class="line">            <span class="p">],</span>
</span><span class="line">            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span class="line">            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
</span><span class="line">        <span class="p">)</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span><span class="line">        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
</span><span class="line">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'pip_error.log'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
</span><span class="line">                <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</span><span class="line">                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span class="line">    <span class="k">else</span><span class="p">:</span>
</span><span class="line">        <span class="k">print</span><span class="p">(</span><span class="s">"Could not find virtualenv executable. Ignoring"</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This snippet assumes that there is a <em>requirements.txt</em> file in your “skeleton” folder in the root directory. If so, it will create a virtualenv and then install the dependencies.</p>

<a name="L5th.task.-.Git.Init"/>
<h2>5th task – Git Init</h2>

<blockquote><p>Updated <a href="https://github.com/realpython/flask-scaffold/releases/tag/fourth_tag">script</a>.</p></blockquote>

<p>Notice a pattern yet? Add the argument:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-g'</span><span class="p">,</span> <span class="s">'--git'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then add the code under the task for the virtualenv:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># Git init</span>
</span><span class="line"><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">git</span><span class="p">:</span>
</span><span class="line">    <span class="n">output</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span class="line">        <span class="p">[</span><span class="s">'git'</span><span class="p">,</span> <span class="s">'init'</span><span class="p">,</span> <span class="n">fullpath</span><span class="p">],</span>
</span><span class="line">        <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span class="line">        <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
</span><span class="line">    <span class="p">)</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span><span class="line">    <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
</span><span class="line">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'git_error.log'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
</span><span class="line">            <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</span><span class="line">            <span class="k">print</span><span class="p">(</span><span class="s">"Error with git init"</span><span class="p">)</span>
</span><span class="line">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span class="line">    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span>
</span><span class="line">        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s">'templates'</span><span class="p">,</span> <span class="s">'.gitignore'</span><span class="p">),</span>
</span><span class="line">        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="s">'.gitignore'</span><span class="p">)</span>
</span><span class="line">    <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now within the templates folder add a <em>.gitignore</em> file, and then add the files and folders that you’d like to ignore. Grab the <a href="https://raw.githubusercontent.com/github/gitignore/master/Python.gitignore">example</a> from Github, if needed. Test again.</p>

<a name="Sum.and.confirm"/>
<h2>Sum and confirm</h2>

<blockquote><p>Updated <a href="https://github.com/realpython/flask-scaffold/releases/tag/fifth_tag">script</a>.</p></blockquote>

<p>Finally, let’s add a nice summary before the application is created and then ask for user confirmation before executing the script.</p>

<a name="Summary"/>
<h3>Summary</h3>

<p>Add a file called <em>brief.jinja2</em> to the “templates” folder:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Welcome</span><span class="err">!</span> <span class="n">The</span> <span class="n">following</span> <span class="n">settings</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">create</span> <span class="n">your</span> <span class="n">application</span><span class="p">:</span>
</span><span class="line">
</span><span class="line"><span class="n">Python</span> <span class="n">Version</span><span class="p">:</span>     <span class="p"/>
</span><span class="line"><span class="n">Project</span> <span class="n">Name</span><span class="p">:</span>       <span class="p"/>
</span><span class="line"><span class="n">Project</span> <span class="n">Path</span><span class="p">:</span>       <span class="p"/>
</span><span class="line"><span class="n">Virtualenv</span><span class="p">:</span>         <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">virtualenv</span> <span class="o">%</span><span class="p">}</span><span class="n">Enabled</span><span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span><span class="n">Disabled</span><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</span><span class="line"><span class="n">Skeleton</span><span class="p">:</span>           <span class="p"/>
</span><span class="line"><span class="n">Git</span><span class="p">:</span>                <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">git</span> <span class="o">%</span><span class="p">}</span><span class="n">Yes</span><span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span><span class="n">No</span><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</span><span class="line"><span class="n">Bower</span><span class="p">:</span>              <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">bower</span> <span class="o">%</span><span class="p">}</span><span class="n">Enabled</span><span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span><span class="n">Disabled</span><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</span><span class="line"><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">bower</span> <span class="o">%</span><span class="p">}</span><span class="n">Bower</span> <span class="n">Dependencies</span><span class="p">:</span> <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">bower</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we just need to catch every user-supplied argument and then render the template. First, add the import – <code>import platform</code> – to the import section and then the following code just below the “variables” section in the <em>flask_skeleton.py</em> script:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># Summary #</span>
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">generate_brief</span><span class="p">(</span><span class="n">template_var</span><span class="p">):</span>
</span><span class="line">    <span class="n">template</span> <span class="o">=</span> <span class="n">template_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s">'brief.jinja2'</span><span class="p">)</span>
</span><span class="line">    <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">template_var</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="n">template_var</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">'pyversion'</span><span class="p">:</span> <span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">(),</span>
</span><span class="line">    <span class="s">'appname'</span><span class="p">:</span> <span class="n">appname</span><span class="p">,</span>
</span><span class="line">    <span class="s">'bower'</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">bower</span><span class="p">,</span>
</span><span class="line">    <span class="s">'virtualenv'</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">virtualenv</span><span class="p">,</span>
</span><span class="line">    <span class="s">'skeleton'</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">skeleton</span><span class="p">,</span>
</span><span class="line">    <span class="s">'path'</span><span class="p">:</span> <span class="n">fullpath</span><span class="p">,</span>
</span><span class="line">    <span class="s">'git'</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">git</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="k">print</span><span class="p">(</span><span class="n">generate_brief</span><span class="p">(</span><span class="n">template_var</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Test this out:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python flask_skeleton.py new_project -s skeleton -b <span class="s1">'angular, jquery, bootstrap'</span> -g -v
</span><span class="line">
</span><span class="line">Welcome! The following settings will be used to create your application:
</span><span class="line">
</span><span class="line">Python Version:     3.4.2
</span><span class="line">Project Name:       new_project
</span><span class="line">Project Path:       /Users/michael/repos/realpython/flask-scaffold/new_project
</span><span class="line">Virtualenv:         Enabled
</span><span class="line">Skeleton:           skeleton
</span><span class="line">Git:                Yes
</span><span class="line">Bower:              Enabled
</span><span class="line">Bower Dependencies: angular, jquery, bootstrap
</span></code></pre></td></tr></table></div></figure>


<p>Nice!</p>

<a name="Refactor"/>
<h3>Refactor</h3>

<p>Now we need to refactor the script a bit to check for errors first. I suggest grabbing the code from the <a href="https://github.com/realpython/flask-scaffold/releases/tag/refactor">refactor</a> tag and then comparing the diff between that script and the previous tag’s <a href="https://github.com/realpython/flask-scaffold/releases/tag/summary">script</a> since there are a number of small updates.</p>

<p><strong>Make sure you use the updated script from the <a href="https://github.com/realpython/flask-scaffold/releases/tag/refactor">refactor</a> tag before moving on.</strong></p>

<a name="Confirm"/>
<h3>Confirm</h3>

<p>Now let’s add the user confirmation functionality by updating <code>if __name__ == '__main__':</code>:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
</span><span class="line">    <span class="n">arguments</span> <span class="o">=</span> <span class="n">get_arguments</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</span><span class="line">    <span class="k">print</span><span class="p">(</span><span class="n">generate_brief</span><span class="p">(</span><span class="n">arguments</span><span class="p">))</span>
</span><span class="line">    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span><span class="line">        <span class="nb">input</span> <span class="o">=</span> <span class="nb">raw_input</span>
</span><span class="line">    <span class="n">proceed</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Proceed (yes/no)? "</span><span class="p">)</span>
</span><span class="line">    <span class="n">valid</span> <span class="o">=</span> <span class="p">[</span><span class="s">"yes"</span><span class="p">,</span> <span class="s">"y"</span><span class="p">,</span> <span class="s">"no"</span><span class="p">,</span> <span class="s">"n"</span><span class="p">]</span>
</span><span class="line">    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
</span><span class="line">        <span class="k">if</span> <span class="n">proceed</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">:</span>
</span><span class="line">            <span class="k">if</span> <span class="n">proceed</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">"yes"</span> <span class="ow">or</span> <span class="n">proceed</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">"y"</span><span class="p">:</span>
</span><span class="line">                <span class="n">main</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>
</span><span class="line">                <span class="k">print</span><span class="p">(</span><span class="s">"Done!"</span><span class="p">)</span>
</span><span class="line">                <span class="k">break</span>
</span><span class="line">            <span class="k">else</span><span class="p">:</span>
</span><span class="line">                <span class="k">print</span><span class="p">(</span><span class="s">"Goodbye!"</span><span class="p">)</span>
</span><span class="line">                <span class="k">break</span>
</span><span class="line">        <span class="k">else</span><span class="p">:</span>
</span><span class="line">            <span class="k">print</span><span class="p">(</span><span class="s">"Please respond with 'yes' or 'no' (or 'y' or 'n')."</span><span class="p">)</span>
</span><span class="line">            <span class="n">proceed</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Proceed (yes/no)? "</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This should be fairly straightforward.</p>

<a name="Run."/>
<h2>Run!</h2>

<p>If you use Linux or Mac you can make this script easier to run. Simply add the following alias to either <em>.bashrc</em> or <em>.zshrc</em>, customizing it to match your directory structure:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nb">alias </span><span class="nv">flaskcli</span><span class="o">=</span><span class="s2">"python /Users/michael/repos/realpython/flask-scaffold/flask_skeleton.py"</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p><strong>NOTE</strong>: If you have both Python 2.7 and Python 3.4 installed you will have to specify the version you want to use – either <code>python</code> or <code>python3</code>.</p></blockquote>

<p>Remove the new project (if necessary) – <code>rm -rf new_project</code> – and then test out the script one last time to confirm:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>flaskcli new_project -s skeleton -b <span class="s1">'angular, jquery, bootstrap'</span> -g -v
</span></code></pre></td></tr></table></div></figure>


<a name="Conclusion"/>
<h2>Conclusion</h2>

<p>What do you think? Did we miss anything? What other arguments would you add to <code>argparse</code> in order to customize your scaffold script even further? Comment below!</p>

<p>Grab the final code from the <a href="https://github.com/realpython/flask-scaffold">repo</a>.</p>

<a name="Author.s.Note"/>
<h3>Author’s Note</h3>

<p>I (Depado) would like to thank <a href="http://antonin-lenfant.com/">Antonin Lenfant</a> for his support toward the project and for the changes made to the article. He is a former coworker and a Python enthusiast. I’d also like to thank <a href="https://github.com/mjhea0">Michael Herman</a>, from Real Python, who spotted my project on Github and asked me to write this article.</p>

<p>Creating this tool has been an interesting challenge. I discovered how pleasant it was to work with a template system for an application that is not a web application.</p>






<p>
  <em>Edits made by <a href="https://twitter.com/diek007">Derrick Kearney</a>. Thanks again, Derrick!</em>
</p>

</div>


      </div></body></html>