<html><body><div><div>
			<p><img alt="Админка django с превью картинок" src="http://djangonaut.ru/images/django-admin-with-thumbnails.png"/></p>
<p>Практически в каждом django-проекте рано или поздно встает вопрос о
генерировании превьюшек для картинок.  Одним из наиболее простых и удобных
решений для этого является <strong>sorl.thumbnail</strong>.  Это приложение позволяет
генерировать превьюшки либо прямо в шаблоне через тег <code>{% thumbnail %}</code>,
либо используя в моделях специальное поле <code>sorl.thumbnail.ImageField</code>.</p>
<p>В подавляющем большинстве случаев этого достаточно, но иногда возникает
необходимость получить превьюшку в python-коде прямо по месту, без
переделывания моделей.</p>
<p>К примеру может захотеться видеть совсем маленькие, нигде больше не
используемые, превьюшки в списке объектов в админке. Делается это на
удивление просто.</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.html</span> <span class="kn">import</span> <span class="n">format_html</span>
<span class="kn">from</span> <span class="nn">sorl.thumbnail</span> <span class="kn">import</span> <span class="n">get_thumbnail</span>

<span class="k">class</span> <span class="nc">ProductAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="s">'photo_thumbnail'</span><span class="p">,</span> <span class="s">'__unicode__'</span><span class="p">,</span> <span class="s">'price'</span><span class="p">)</span>
    <span class="n">list_display_links</span> <span class="o">=</span> <span class="p">(</span><span class="s">'__unicode__'</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">photo_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">get_thumbnail</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">photo</span><span class="p">,</span> <span class="s">'60x60'</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">format_html</span><span class="p">(</span>
                <span class="s">'&lt;img src="{}" border="0" alt="" width="{}" height="{}" /&gt;'</span><span class="p">,</span>
                            <span class="n">im</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
    <span class="n">photo_thumbnail</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">u'Фото'</span>
    <span class="n">photo_thumbnail</span><span class="o">.</span><span class="n">allow_tags</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>


<p>Результат можно наблюдать в начале этой статьи.</p>
		</div>

	</div></body></html>