<html><body><div><div class="post-text" itemprop="text">

<p>For learning purposes I'm making a webapp that make plots with matplotlib, and I want to save the image of that plot into the <code>figure</code> field of the Plot model but when I make a plot all it does it saves a blank image into the <code>/media/figures/</code> directory. I did this the way an other post suggested but it's not working.</p>

<p><strong>More Info</strong>
When I make the plot, the plot image gets saved in the main directory of my django project with a name like <code>&lt;_io.StringIO object at 0xb1ac69ec&gt;</code>, but as I said the plot image that gets saved in the model is blank. Also im using <strong>Python 2.7</strong> if that matters.</p>

<pre><code>def simple_plot(request):
    if request.method == "POST":
        name = request.POST.get("name")
        xvalues = request.POST.get("xvalues")
        yvalues = request.POST.get("yvalues")
        plots.simple_plot(request, name, xvalues, yvalues)
        messages.success(request, "Plot created!")
        redirect("plots:create")
    return render(request, 'plots/simple.html')
</code></pre>

<p>The file which plots are made and plot instances created.</p>

<pre><code>def simple_plot(request ,name, xvalues, yvalues):
    file_name = name+".png"
    xvalues = [int(x.replace(" ","")) for x in xvalues.split(",")]
    yvalues = [int(y.replace(" ","")) for y in yvalues.split(",")]

    figure = io.StringIO()
    plot = plt.plot(xvalues, yvalues)
    plt.savefig(u'%s' % figure, format="png")

    content_file = ContentFile(figure.getvalue())
    plot_instance = Plot(name=name, user=request.user)
    plot_instance.figure.save(file_name, content_file)
    plot_instance.save()
    return True
</code></pre>

<p>Plot Model</p>

<pre><code>class Plot(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    name = models.CharField(max_length=200)
    figure = models.ImageField(upload_to='figures/')
    timestamp = models.DateTimeField(auto_now_add=True)
</code></pre>
    </div>
    </div></body></html>