<html><body><div><div class="entry-content">
		<p>Both R and Python are incredibly good tools to manipulate your data and their integration is becoming <a href="http://www.r-bloggers.com/r-6-in-ieee-2015-top-programming-languages-rising-3-places/">increasingly important</a><span id="easy-footnote-1" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-1" title="&lt;a href=&quot;http://www.r-bloggers.com/r-6-in-ieee-2015-top-programming-languages-rising-3-places/&quot;&gt;IEEE 2015 top programming languages&lt;/a&gt;"><sup>1</sup></a></span>. The latest tool for data manipulation in R is <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">Dplyr</a><span id="easy-footnote-2" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-2" title="&lt;a href=&quot;https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html&quot;&gt;Dplyr homepage&lt;/a&gt;"><sup>2</sup></a></span> whilst Python relies on <a href="http://pandas.pydata.org/">Pandas</a><span id="easy-footnote-3" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-3" title="&lt;a href=&quot;http://pandas.pydata.org/&quot;&gt;Pandas homepage&lt;/a&gt;"><sup>3</sup></a></span>.</p>
<p>In this blog post I'll show you the fundamental primitives to manipulate your dataframes using both libraries highlighting their major advantages and disadvantages.</p>
<p><span id="more-841"/></p>
<h2>Theory first</h2>
<p>Data Frames are basically tables. <a href="https://en.wikipedia.org/wiki/Edgar_F._Codd">Codd, E.F.</a> in 1970 defined <a href="https://en.wikipedia.org/wiki/Relational_algebra">Relational algebra</a><span id="easy-footnote-4" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-4" title="&lt;a href=&quot;https://en.wikipedia.org/wiki/Relational_algebra&quot;&gt;Relational Algebra&lt;/a&gt;"><sup>4</sup></a></span> as the basic the theory to work on relational tables. It defines the following operations:</p>
<ul>
<li>Projection (π)</li>
<li>Selection (σ)</li>
<li>Rename (ρ)</li>
<li>Set operators (union, difference, cartesian product)</li>
<li>Natural join (⋈)</li>
</ul>
<p>SQL dialects also added the following</p>
<ul>
<li>Aggregations</li>
<li>Group by operations</li>
</ul>
<p>Why we care? People redefined these basic operations over and over in the last 40 years starting with SQL until today latest query languages. This framework will give us a general language independent perspective on the data manipulation.</p>
<h2>Hands on</h2>
<p>I will use the nycflights13 dataset used to introduce <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">dplyr</a><span id="easy-footnote-5" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-5" title="&lt;a href=&quot;https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html&quot;&gt;NYC Flights 2013 dataset&lt;/a&gt;"><sup>5</sup></a></span> to present the functions. If you are interested you can download this entire blog post as an <a href="https://github.com/mottalrd/data-manipulation-in-python-and-r">IPython notebook</a>. Let's initialise our environment first:</p>
<p/>

		<div id="crayon-56d5b432ea9bc119209392" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-2">2</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-4">4</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-6">6</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-8">8</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-10">10</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-12">12</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-14">14</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-16">16</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-18">18</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432ea9bc119209392-20">20</p><p class="crayon-num" data-line="crayon-56d5b432ea9bc119209392-21">21</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-1"><span class="crayon-p"># Load the R magic command</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-2"><span class="crayon-ta">%</span><span class="crayon-v">load</span><span class="crayon-sy">_</span>ext<span class="crayon-h"> </span><span class="crayon-v">rpy2</span><span class="crayon-sy">.</span><span class="crayon-i">ipython</span></p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-3"><span class="crayon-e">from </span><span class="crayon-v">rpy2</span><span class="crayon-sy">.</span><span class="crayon-e">robjects </span><span class="crayon-e">import</span><span class="crayon-h"> </span><span class="crayon-e">pandas2ri</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-4"> </p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-5"><span class="crayon-p"># numpy available as np</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-6"><span class="crayon-p"># pyplot available as ply</span></p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-7"><span class="crayon-ta">%</span><span class="crayon-i">pylab</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-8"> </p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-9"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e ">import *</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-10"> </p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-11"><span class="crayon-e">Using </span><span class="crayon-e">matplotlib </span><span class="crayon-v">backend</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">MacOSX</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-12"><span class="crayon-e">Populating</span><span class="crayon-h"> </span><span class="crayon-e">the</span><span class="crayon-h"> </span><span class="crayon-e">interactive</span><span class="crayon-h"> </span><span class="crayon-t">namespace</span><span class="crayon-h"> </span><span class="crayon-e">from</span><span class="crayon-h"> </span><span class="crayon-e">numpy</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">matplotlib</span></p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-13"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-14"><span class="crayon-ta">%</span><span class="crayon-o">%</span><span class="crayon-v">R</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-i">flights</span></p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-15"><span class="crayon-p">#sink(type="output")</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-16"><span class="crayon-e">sink</span><span class="crayon-sy">(</span><span class="crayon-s">"/dev/null"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-17"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-s">"dplyr"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-18"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">nycflights13</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-19"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9bc119209392-20"><span class="crayon-v">flights</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas2ri</span><span class="crayon-sy">.</span><span class="crayon-e">ri2py</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432ea9bc119209392-21"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Data summary</h2>
<p>In both libraries it is possible to quickly print a quick summary of your dataframe. Pandas has an object oriented approach and you can invoke <code>head()</code>, <code>tail()</code> and <code>describe()</code> directly on your dataframe object. R has a procedural approach and its functions take a dataframe as the first input.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>df.head()</code></td>
<td><code>head(df)</code></td>
</tr>
<tr>
<td><code>df.tail()</code></td>
<td><code>tail(df)</code></td>
</tr>
<tr>
<td><code>df.describe()</code></td>
<td><code>summary(df)</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432ea9df968529480" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432ea9df968529480-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9df968529480-2"> </p><p class="crayon-line" id="crayon-56d5b432ea9df968529480-3"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9df968529480-4"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">tail</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9df968529480-5"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9df968529480-6"> </p><p class="crayon-line" id="crayon-56d5b432ea9df968529480-7"><span class="crayon-ta">%</span><span class="crayon-i">R</span><span class="crayon-h"> </span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9df968529480-8"><span class="crayon-ta">%</span><span class="crayon-i">R</span><span class="crayon-h"> </span><span class="crayon-e">tail</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9df968529480-9"><span class="crayon-ta">%</span><span class="crayon-i">R</span><span class="crayon-h"> </span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9df968529480-10"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Selection</h2>
<p>In pandas in order to select multiple rows you need to use the <code>[]</code> operator with the element-wise operators like <code>&amp;</code> and <code>|</code>. If you don't use the element-wise operators you will get the following error: <code>ValueError: The truth value of a Series is ambiguous</code>. Another solution is to install the <a href="https://github.com/pydata/numexpr">numexpr</a><span id="easy-footnote-6" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-6" title="&lt;a href=&quot;https://github.com/pydata/numexpr&quot;&gt;Numexpr python package&lt;/a&gt;"><sup>6</sup></a></span> package and use the <code>query()</code> function.</p>
<p><code>dplyr</code> instead provides the <code>filter()</code> function. Combined with the pipe operator <code>%&gt;%</code> the code is incredibly readable in my opinion. Notice how repeating the dataframe variable in the boolean expression is not needed in this case.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>df[bool expr with element-wise operators]</code></td>
<td><code>df %&gt;% filter(bool expr)</code></td>
</tr>
<tr>
<td><code>df.query('bool expr')</code></td>
<td/>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432ea9e8585201878" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432ea9e8585201878-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9e8585201878-2"> </p><p class="crayon-line" id="crayon-56d5b432ea9e8585201878-3"><span class="crayon-p"># Simple filtering</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9e8585201878-4"><span class="crayon-v">flights</span><span class="crayon-sy">[</span><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">month</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9e8585201878-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9e8585201878-6"><span class="crayon-p"># Filtering with element-wise operators</span></p><p class="crayon-line" id="crayon-56d5b432ea9e8585201878-7"><span class="crayon-v">flights</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">month</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">month</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9e8585201878-8"> </p><p class="crayon-line" id="crayon-56d5b432ea9e8585201878-9"><span class="crayon-p"># with numexpr</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9e8585201878-10"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'month &gt;= 3 &amp; month &lt;= 6'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9e8585201878-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9e8585201878-12"> </p><p class="crayon-line" id="crayon-56d5b432ea9e8585201878-13"><span class="crayon-ta">%</span><span class="crayon-i">R</span><span class="crayon-h"> </span><span class="crayon-v">flights</span><span class="crayon-h"> </span><span class="crayon-ta">%&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">filter</span><span class="crayon-sy">(</span><span class="crayon-v">month</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">month</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9e8585201878-14"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Projection</h2>
<p>You can use the projection operation to extract one (or more) columns from a dataframe. In Python you pass an array with the columns you are interested in to the DataFrame object. In dplyr the projection function is called select, inspired by SQL.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>df[['col_1', 'col_2']]</code></td>
<td><code>df %&gt;% select(col_1, col_2)</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432ea9ef393474287" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432ea9ef393474287-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9ef393474287-2"><span class="crayon-v">flights</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'year'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'month'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9ef393474287-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9ef393474287-4"> </p><p class="crayon-line" id="crayon-56d5b432ea9ef393474287-5"><span class="crayon-ta">%</span><span class="crayon-i">R</span><span class="crayon-h"> </span><span class="crayon-v">flights</span><span class="crayon-h"> </span><span class="crayon-ta">%&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">select</span><span class="crayon-sy">(</span><span class="crayon-v">month</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">year</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9ef393474287-6"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Rename</h2>
<p>The rename operation is used to simply rename a column of your dataframe keeping the content intact. In pandas you use the <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html">rename</a><span id="easy-footnote-7" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-7" title="&lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html&quot;&gt;pandas.DataFrame.rename&lt;/a&gt;"><sup>7</sup></a></span> function and you provide a dictionary. In R you use a comma separated list of assignments.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>df.rename(columns={'col_name': 'col_new_name'})</code></td>
<td><code>df %&gt;% rename(col_new_name = col_name)</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432ea9f5034930467" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432ea9f5034930467-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9f5034930467-2"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">rename</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'month'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'TheMonth'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9f5034930467-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9f5034930467-4"> </p><p class="crayon-line" id="crayon-56d5b432ea9f5034930467-5"><span class="crayon-ta">%</span><span class="crayon-i">R</span><span class="crayon-h"> </span><span class="crayon-v">flights</span><span class="crayon-h"> </span><span class="crayon-ta">%&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">rename</span><span class="crayon-sy">(</span><span class="crayon-v">TheMonth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">month</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9f5034930467-6"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Union</h2>
<p>The relational algebra uses set union, set difference, and Cartesian product from set theory, with the extra constraint that tables must be "compatible", i.e. they must have the same columns.</p>
<p>You can use the union in Pandas using the <a href="http://pandas.pydata.org/pandas-docs/stable/merging.html"><code>concat()</code></a><span id="easy-footnote-8" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-8" title="&lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/merging.html&quot;&gt;Merging data frames in Panda&lt;/a&gt;"><sup>8</sup></a></span> operation. You need to take some extra care for indexes though and for that I'll forward you <a href="http://pandas.pydata.org/pandas-docs/stable/merging.html#concatenating-objects">to the docs</a><span id="easy-footnote-9" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-9" title="&lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/merging.html#concatenating-objects&quot;&gt;Concatenating objects in Pandas&lt;/a&gt;"><sup>9</sup></a></span>.</p>
<p>In R you rely on the <a href="http://rpackages.ianhowson.com/cran/dplyr/man/bind.html"><code>bind_rows</code></a><span id="easy-footnote-10" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-10" title="&lt;a href=&quot;http://rpackages.ianhowson.com/cran/dplyr/man/bind.html&quot;&gt;Dplyr bind function&lt;/a&gt;"><sup>10</sup></a></span> operator.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>concat([df_1, df_2]);</code></td>
<td><code>rbind_list(df_1, df_2)</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432ea9fd598041081" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432ea9fd598041081-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9fd598041081-2"> </p><p class="crayon-line" id="crayon-56d5b432ea9fd598041081-3"><span class="crayon-v">df_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'dep_time == 518'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9fd598041081-4"><span class="crayon-v">df_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'dep_time == 517'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9fd598041081-5"><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">df_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9fd598041081-6"> </p><p class="crayon-line" id="crayon-56d5b432ea9fd598041081-7"><span class="crayon-ta">%</span><span class="crayon-o">%</span><span class="crayon-i">R</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9fd598041081-8"><span class="crayon-e">sink</span><span class="crayon-sy">(</span><span class="crayon-s">"/dev/null"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432ea9fd598041081-9"><span class="crayon-v">df_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">filter</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dep_time</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">517</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9fd598041081-10"><span class="crayon-v">df_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">filter</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dep_time</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">518</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432ea9fd598041081-11"><span class="crayon-e">bind_rows</span><span class="crayon-sy">(</span><span class="crayon-v">df_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432ea9fd598041081-12"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Difference</h2>
<p>To the best of my knowledge there is no set difference operator in Python. In order to achieve the result we must rely on the select operator.</p>
<p>In dplyr there is a native operator <code>setdiff</code> that does exactly what we expect.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>set_a[~set_a.column.isin(set_b.column)]</code></td>
<td><code>set_a %&gt;% setdiff(set_b)</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432eaa03319851689" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432eaa03319851689-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa03319851689-2"> </p><p class="crayon-line" id="crayon-56d5b432eaa03319851689-3"><span class="crayon-v">set_a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'dep_time == 517 | dep_time == 518'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa03319851689-4"><span class="crayon-v">set_b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'dep_time == 518 | dep_time == 519'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa03319851689-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa03319851689-6"><span class="crayon-v">selection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-v">set_a</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-e">isin</span><span class="crayon-sy">(</span><span class="crayon-v">set_b</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa03319851689-7"><span class="crayon-v">set_a</span><span class="crayon-sy">[</span><span class="crayon-v">selection</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa03319851689-8"> </p><p class="crayon-line" id="crayon-56d5b432eaa03319851689-9"><span class="crayon-ta">%</span><span class="crayon-o">%</span><span class="crayon-i">R</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa03319851689-10"><span class="crayon-p">#sink(type="output")</span></p><p class="crayon-line" id="crayon-56d5b432eaa03319851689-11"><span class="crayon-p">#sink("/dev/null")</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa03319851689-12"><span class="crayon-v">set_a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">filter</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dep_time</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">517</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">dep_time</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">518</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa03319851689-13"><span class="crayon-v">set_b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">filter</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dep_time</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">518</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">dep_time</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">519</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa03319851689-14"><span class="crayon-v">set_a</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">setdiff</span><span class="crayon-sy">(</span><span class="crayon-v">set_b</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa03319851689-15"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Cartesian product</h2>
<p>You can use the cartesian product to combine two tables with a disjoint set of columns. In practice this is not a very common operation and as a result both libraries lack a pure cartesian product (in favour of the way more common <code>join</code> operator).</p>
<p>A simple trick to overcome this limitation is to create a temporary column first, perform the join and finally remove the temporary column. This can be done both in Python and R using the <code>merge()</code> and <code>full_join</code> methods.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>merge(...) with tmp column</code></td>
<td><code>full_join(...) with tmp column</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432eaa09793632185" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-2">2</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-4">4</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-6">6</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-8">8</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-10">10</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-12">12</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-14">14</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-16">16</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-18">18</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-20">20</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-22">22</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-24">24</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-26">26</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-28">28</p><p class="crayon-num" data-line="crayon-56d5b432eaa09793632185-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa09793632185-30">30</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432eaa09793632185-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-2"> </p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-3"><span class="crayon-v">df_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-4"><span class="crayon-h">        </span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Jack'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Mario'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Luigi'</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-5"><span class="crayon-h">    </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-6"><span class="crayon-v">df_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-7"><span class="crayon-h">        </span><span class="crayon-s">'surname'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Rossi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Verdi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Reacher'</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-8"><span class="crayon-h">    </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-10"><span class="crayon-v">df_1</span><span class="crayon-sy">[</span><span class="crayon-s">'tmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">nan</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-11"><span class="crayon-v">df_2</span><span class="crayon-sy">[</span><span class="crayon-s">'tmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">nan</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-12"> </p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-13"><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">df_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-o">=</span><span class="crayon-s">'tmp'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-s">'tmp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-14"> </p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-15"><span class="crayon-ta">%</span><span class="crayon-o">%</span><span class="crayon-i">R</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-16"><span class="crayon-p">#sink(type="output")</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-17"><span class="crayon-e">sink</span><span class="crayon-sy">(</span><span class="crayon-s">"/dev/null"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-18"><span class="crayon-v">df_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">frame</span><span class="crayon-sy">(</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-19"><span class="crayon-h">    </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-s">'Jack'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Mario'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Luigi'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-20"><span class="crayon-h">    </span><span class="crayon-v">stringsAsFactors</span><span class="crayon-o">=</span><span class="crayon-t">FALSE</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-21"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-22"><span class="crayon-v">df_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">frame</span><span class="crayon-sy">(</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-23"><span class="crayon-h">    </span><span class="crayon-v">surname</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-s">'Rossi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Verdi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Reacher'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-24"><span class="crayon-h">    </span><span class="crayon-v">stringsAsFactors</span><span class="crayon-o">=</span><span class="crayon-t">FALSE</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-25"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-26"><span class="crayon-v">df_1</span><span class="crayon-sy">$</span><span class="crayon-v">tmp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NA</span></p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-27"><span class="crayon-v">df_2</span><span class="crayon-sy">$</span><span class="crayon-v">tmp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NA</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-28"> </p><p class="crayon-line" id="crayon-56d5b432eaa09793632185-29"><span class="crayon-e">full_join</span><span class="crayon-sy">(</span><span class="crayon-v">df_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">by</span><span class="crayon-o">=</span><span class="crayon-s">"tmp"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">select</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">tmp</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa09793632185-30"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Natural Join</h2>
<p>If you are used to SQL you are definitely aware of what a join operation is. Given two dataframe R and S the result of the natural join is the set of all combinations of tuples in R and S that are equal on their common attribute names.</p>
<p>In Python you can rely on the very powerful <a href="http://pandas.pydata.org/pandas-docs/stable/merging.html#brief-primer-on-merge-methods-relational-algebra">merge</a><span id="easy-footnote-11" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-11" title="&lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/merging.html#brief-primer-on-merge-methods-relational-algebra&quot;&gt;Pandas merge function&lt;/a&gt;"><sup>11</sup></a></span> command.<br/>
In R Dplyr you can use the <a href="https://cran.r-project.org/web/packages/dplyr/dplyr.pdf">full_join</a><span id="easy-footnote-12" class="easy-footnote-margin-adjust"/><span class="easy-footnote"><a href="#easy-footnote-bottom-12" title="&lt;a href=&quot;https://cran.r-project.org/web/packages/dplyr/dplyr.pdf&quot;&gt;Dplyr documentation&lt;/a&gt;"><sup>12</sup></a></span> command.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>merge(..., on="key", how="outer")</code></td>
<td><code>full_join(..., by="key")</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432eaa11466460573" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-2">2</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-4">4</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-6">6</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-8">8</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-10">10</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-12">12</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-14">14</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-16">16</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-18">18</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-20">20</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-22">22</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-24">24</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-26">26</p><p class="crayon-num" data-line="crayon-56d5b432eaa11466460573-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa11466460573-28">28</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432eaa11466460573-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-2"><span class="crayon-v">df_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-3"><span class="crayon-h">        </span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Jack'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Mario'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Luigi'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-4"><span class="crayon-h">        </span><span class="crayon-s">'department_id'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-5"><span class="crayon-h">    </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-6"><span class="crayon-v">df_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-7"><span class="crayon-h">        </span><span class="crayon-s">'department_name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Sales'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Product'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Finance'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-8"><span class="crayon-h">        </span><span class="crayon-s">'department_id'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-9"><span class="crayon-h">    </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-10"> </p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-11"><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">df_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-o">=</span><span class="crayon-s">"department_id"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-o">=</span><span class="crayon-s">"outer"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-12"> </p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-13"><span class="crayon-ta">%</span><span class="crayon-o">%</span><span class="crayon-i">R</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-14"><span class="crayon-p">#sink(type="output")</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-15"><span class="crayon-e">sink</span><span class="crayon-sy">(</span><span class="crayon-s">"/dev/null"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-16"> </p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-17"><span class="crayon-v">df_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">frame</span><span class="crayon-sy">(</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-18"><span class="crayon-h">    </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-s">'Jack'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Mario'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Luigi'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-19"><span class="crayon-h">    </span><span class="crayon-v">department_id</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-20"><span class="crayon-h">    </span><span class="crayon-v">stringsAsFactors</span><span class="crayon-o">=</span><span class="crayon-t">FALSE</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-21"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-22"><span class="crayon-v">df_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">frame</span><span class="crayon-sy">(</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-23"><span class="crayon-h">    </span><span class="crayon-v">department_name</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-s">'Sales'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Product'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Finance'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-24"><span class="crayon-h">    </span><span class="crayon-v">department_id</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-25"><span class="crayon-h">    </span><span class="crayon-v">stringsAsFactors</span><span class="crayon-o">=</span><span class="crayon-t">FALSE</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-26"> </p><p class="crayon-line" id="crayon-56d5b432eaa11466460573-27"><span class="crayon-e">full_join</span><span class="crayon-sy">(</span><span class="crayon-v">df_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">by</span><span class="crayon-o">=</span><span class="crayon-s">"department_id"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa11466460573-28"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Aggregations</h2>
<p>An aggregate function is a function that takes the values of a certain column to form a single value of more significant meaning. Typical aggregate functions available in the most common SQL dialects include Average(), Count(), Maximum(), Median(), Minimum(), Mode(), Sum().</p>
<p>Both R and Python dataframes provides methods to extract this information. In this case I would say that Python handle missing values default better, whilst on R we have to provide <code>na.rm = TRUE</code>.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>df.&lt;column&gt;.mean()</code></td>
<td><code>summarise(df, test=mean(&lt;column&gt;, na.rm = TRUE))</code></td>
</tr>
<tr>
<td><code>df.&lt;column&gt;.median()</code></td>
<td><code>summarise(df, test=median(&lt;column&gt;, na.rm = TRUE))</code></td>
</tr>
<tr>
<td><code>df.&lt;column&gt;.std()</code></td>
<td><code>summarise(df, test=sd(&lt;column&gt;, na.rm = TRUE))</code></td>
</tr>
<tr>
<td><code>df.&lt;column&gt;.var()</code></td>
<td><code>summarise(df, test=var(&lt;column&gt;, na.rm = TRUE))</code></td>
</tr>
<tr>
<td><code>df.&lt;column&gt;.min()</code></td>
<td><code>summarise(df, test=min(&lt;column&gt;, na.rm = TRUE))</code></td>
</tr>
<tr>
<td><code>df.&lt;column&gt;.max()</code></td>
<td><code>summarise(df, test=max(&lt;column&gt;, na.rm = TRUE))</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432eaa19465829470" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-2">2</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-4">4</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-6">6</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-8">8</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-10">10</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-12">12</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-14">14</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-16">16</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-18">18</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b432eaa19465829470-20">20</p><p class="crayon-num" data-line="crayon-56d5b432eaa19465829470-21">21</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432eaa19465829470-1"><span class="crayon-p"># Python </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-2"> </p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-3"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-4"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-e">median</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-5"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-6"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-t">var</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-7"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-8"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-9"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-10"> </p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-11"><span class="crayon-ta">%</span><span class="crayon-o">%</span><span class="crayon-i">R</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-12"><span class="crayon-p">#sink(type="output")</span></p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-13"><span class="crayon-e">sink</span><span class="crayon-sy">(</span><span class="crayon-s">"/dev/null"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-14"> </p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-15"><span class="crayon-e">summarise</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">=</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">dep_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">na</span><span class="crayon-sy">.</span><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-16"><span class="crayon-e">summarise</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">=</span><span class="crayon-e">median</span><span class="crayon-sy">(</span><span class="crayon-v">dep_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">na</span><span class="crayon-sy">.</span><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-17"><span class="crayon-e">summarise</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">=</span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">dep_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">na</span><span class="crayon-sy">.</span><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-18"><span class="crayon-e">summarise</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">=</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">dep_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">na</span><span class="crayon-sy">.</span><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-19"><span class="crayon-e">summarise</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">=</span><span class="crayon-e">sd</span><span class="crayon-sy">(</span><span class="crayon-v">dep_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">na</span><span class="crayon-sy">.</span><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa19465829470-20"><span class="crayon-e">summarise</span><span class="crayon-sy">(</span><span class="crayon-v">flights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">=</span><span class="crayon-t">var</span><span class="crayon-sy">(</span><span class="crayon-v">dep_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">na</span><span class="crayon-sy">.</span><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa19465829470-21"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Group by</h2>
<p>Aggregations become useful especially when used in conjunction with the group by operator. This way we are able to compute statistics for a number of group subsets with just one command.</p>
<p>Both Python and R provides the function to run a group by.</p>
<table>
<thead>
<tr>
<th>Python</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>df.groupby('&lt;column&gt;')</code></td>
<td><code>df %&gt;% group_by(&lt;column&gt;)</code></td>
</tr>
</tbody>
</table>
<p/>

		<div id="crayon-56d5b432eaa1f017920316" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b432eaa1f017920316-1"><span class="crayon-p"># Python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa1f017920316-2"> </p><p class="crayon-line" id="crayon-56d5b432eaa1f017920316-3"><span class="crayon-p"># For any given day compute the mean of the flights departure time</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa1f017920316-4"><span class="crayon-v">flights</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'day'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">dep_time</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b432eaa1f017920316-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa1f017920316-6"><span class="crayon-ta">%</span><span class="crayon-o">%</span><span class="crayon-i">R</span></p><p class="crayon-line" id="crayon-56d5b432eaa1f017920316-7"><span class="crayon-p">#sink(type="output")</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa1f017920316-8"><span class="crayon-e">sink</span><span class="crayon-sy">(</span><span class="crayon-s">"/dev/null"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa1f017920316-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa1f017920316-10"><span class="crayon-v">flights</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5b432eaa1f017920316-11"><span class="crayon-h">    </span><span class="crayon-e">group_by</span><span class="crayon-sy">(</span><span class="crayon-v">day</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b432eaa1f017920316-12"><span class="crayon-h">    </span><span class="crayon-e">summarise</span><span class="crayon-sy">(</span><span class="crayon-v">dep_time_mean</span><span class="crayon-o">=</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">dep_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">na</span><span class="crayon-sy">.</span><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b432eaa1f017920316-13"> </p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Conclusion</h2>
<p>I think the Pandas and Dplyr paradigms are very different between each other.</p>
<p>Pandas is more focused on object orientation and good defaults. Indexes are a first class entity and as a result some operations that you expect to be simple are instead quite difficult to grasp.</p>
<p>Conversely Dplyr is procedural. I love the pipe operator and manipulating my data feels incredibly smooth. The only sad note is that sometimes functions defaults are not that great. I haven't tested the speed in this blog post but I assume that since indexes are hidden in Dplyr the speed is probably much lower in general.</p>
<p>In conclusion I feel like Dplyr and R are the perfect tool for some early exploration of the data. But if you are serious about the code you are producing you should probably switch to Python to productionise your data analysis.</p>
<p>Let me know your approach in the comments!</p>
<h2>References</h2>
<ol class="easy-footnotes-wrapper"><li class="easy-footnote-single"><span id="easy-footnote-bottom-1" class="easy-footnote-margin-adjust"/><a href="http://www.r-bloggers.com/r-6-in-ieee-2015-top-programming-languages-rising-3-places/">IEEE 2015 top programming languages</a><a class="easy-footnote-to-top" href="#easy-footnote-1"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-2" class="easy-footnote-margin-adjust"/><a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">Dplyr homepage</a><a class="easy-footnote-to-top" href="#easy-footnote-2"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-3" class="easy-footnote-margin-adjust"/><a href="http://pandas.pydata.org/">Pandas homepage</a><a class="easy-footnote-to-top" href="#easy-footnote-3"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-4" class="easy-footnote-margin-adjust"/><a href="https://en.wikipedia.org/wiki/Relational_algebra">Relational Algebra</a><a class="easy-footnote-to-top" href="#easy-footnote-4"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-5" class="easy-footnote-margin-adjust"/><a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">NYC Flights 2013 dataset</a><a class="easy-footnote-to-top" href="#easy-footnote-5"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-6" class="easy-footnote-margin-adjust"/><a href="https://github.com/pydata/numexpr">Numexpr python package</a><a class="easy-footnote-to-top" href="#easy-footnote-6"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-7" class="easy-footnote-margin-adjust"/><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html">pandas.DataFrame.rename</a><a class="easy-footnote-to-top" href="#easy-footnote-7"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-8" class="easy-footnote-margin-adjust"/><a href="http://pandas.pydata.org/pandas-docs/stable/merging.html">Merging data frames in Panda</a><a class="easy-footnote-to-top" href="#easy-footnote-8"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-9" class="easy-footnote-margin-adjust"/><a href="http://pandas.pydata.org/pandas-docs/stable/merging.html#concatenating-objects">Concatenating objects in Pandas</a><a class="easy-footnote-to-top" href="#easy-footnote-9"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-10" class="easy-footnote-margin-adjust"/><a href="http://rpackages.ianhowson.com/cran/dplyr/man/bind.html">Dplyr bind function</a><a class="easy-footnote-to-top" href="#easy-footnote-10"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-11" class="easy-footnote-margin-adjust"/><a href="http://pandas.pydata.org/pandas-docs/stable/merging.html#brief-primer-on-merge-methods-relational-algebra">Pandas merge function</a><a class="easy-footnote-to-top" href="#easy-footnote-11"/></li><li class="easy-footnote-single"><span id="easy-footnote-bottom-12" class="easy-footnote-margin-adjust"/><a href="https://cran.r-project.org/web/packages/dplyr/dplyr.pdf">Dplyr documentation</a><a class="easy-footnote-to-top" href="#easy-footnote-12"/></li></ol>			</div>

	</div></body></html>