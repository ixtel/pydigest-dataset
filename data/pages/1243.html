<html><body><div><article itemprop="articleBody">
    
    
    <p><strong>MicroPython</strong> is a Python 3 implementation capable of working on microcontrollers with no operating system. <strong>PyBoard</strong> is the first microcontroller board running Micro Python. It can be scripted with Python code and can execute it, work without any connection to a PC. How does it work and what can we do with pyboard and Micro Python?</p>


<a name="1" class="3" title="PyBoard"/>
<p>The pyboard is equipped with STM32F405RGT6 microcontroller (ARM 32-bit Cortex-M4 CPU with FPU), Freescale MMA766 accelerometer, micro SD and micro USB connector. Multiple GPIO provide features such as I2C, SPI, USART or DAC/ADC support.</p>


<figure class="rkthumb"><a href="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/pyboard_diagram.png" title="PyBoard pin layout" data-lightbox="pyboard_diagram.png"><img src="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/thumb_pyboard_diagram.png" alt="PyBoard pin layout"/></a><p>PyBoard pin layout</p></figure>


<figure class="rkthumb"><a href="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/pyboard_1.jpg" title="PyBoard from the top" data-lightbox="pyboard_1.jpg"><img src="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/thumb_pyboard_1.jpg" alt="PyBoard from the top"/></a></figure>


<figure class="rkthumb"><a href="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/pyboard_2.jpg" title="PyBoard from the bottom" data-lightbox="pyboard_2.jpg"><img src="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/thumb_pyboard_2.jpg" alt="PyBoard from the bottom"/></a></figure>


<p>You can buy pyboard from <a href="https://micropython.org/store/a3c50e/#/store">projects store</a> or you may have one from Kickstarter funding. If you want to buy one I recommend the one with soldered female connectors as those seems best for this board. The board I got from Kickstarter had no pin connectors so I've soldered male ones. After doing so I couldn't use it with a breadboard as the board is to wide for a standard breadboard (you would have to use two - side by side). Also the GPIO on the end would have to be placed on the top of the board to use it with breadboards. Female GPIO connectors just make it easier in this case.</p>
<p>There is quite good <a href="http://micropython.org/doc/">documentation</a> as well as <a href="http://micropython.org/doc/tut-contents">Micro Python tutorial</a>.</p>


<figure class="rkthumb"><a href="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/pyboard_3.jpg" title="To wide to fit on a breadboard" data-lightbox="pyboard_3.jpg"><img src="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/thumb_pyboard_3.jpg" alt="To wide to fit on a breadboard"/></a><p>To wide to fit on a breadboard</p></figure>


<figure class="rkthumb"><a href="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/pyboard_premade.jpg" title="Newer version with female GPIO connectors" data-lightbox="pyboard_premade.jpg"><img src="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/thumb_pyboard_premade.jpg" alt="Newer version with female GPIO connectors"/></a><p>Newer version with female GPIO connectors</p></figure>



<a name="2" class="4" title="How does it work?"/>
<p>pyboard has a small filesystem named <strong>0:/</strong>. If you connect a microSD card then it will be recognized as <strong>1:/</strong>. When starting pyboard will pick the filesystem to boot from. If the microSD card is present it will pick it, and if not it will use the internal one. During boot pyboard will execute <strong>boot.py</strong> and then <strong>main.py</strong> file in which your code should be placed. When you connect the board via USB to a PC the booted filesystem will be mounted (just like if it was a flash drive) and you will be able to copy files with the code.</p>
<p>Aside of putting code into main.py file we can also use <strong>REPL</strong> (<em>Read Evaluate Print Loop</em>) which is a sort of an interactive console of Micro Python. It uses a serial connection and you can make one under Linux like so:</p>
<p class="box">sudo screen /dev/ttyACM0</p>
<p>For other systems check the <a href="http://micropython.org/doc/tut-repl">documentation</a>. When REPL start you will the the interactive interpreter with some extra features. Write <strong>help()</strong> to get a handy help instruction. Now you can for example import the <strong>pyb</strong> module and start scripting the board right from the console. To leave REPL press <q>CTRL + a</q> and then <q>CTRL + d</q>.</p>
<p>Here is a simple example of using pyb in REPL, a simple loop that prints data from the accelerometer:</p>
<div class="box"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pyb</span>
<span class="n">accel</span> <span class="o">=</span> <span class="n">pyb</span><span class="o">.</span><span class="n">Accel</span><span class="p">()</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">accel</span><span class="o">.</span><span class="n">filtered_xyz</span><span class="p">())</span>
    <span class="n">pyb</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
<p>Just tilt the board to see how values change.</p>

<a name="3" class="3" title="MicroPython"/>
<p>As you could notice the <strong>pyb</strong> module allows use to script the GPIO features. You can check <a href="http://micropython.org/doc/module/pyb/">pyb documentation</a> to get to know all of its classes. That just a module written to run on Micro Python - a Python 3 implementation that was designed to run on microcontrollers with limited resources and no operating system. This means that there won't be a full standard library available, and you won't be able to run most of third party libraries made for Python 3. Aside of runtime Micro Python is just <a href="http://micropython.org/doc/module/">few modules</a> that we can use.</p>
<p>As the hardware platform is totally different than for the original Python some different design decisions have been taken to make it possible (including garbage collector, integer implementation and more). You can watch this video if you want to know more:</p>

<p/>

<p>Micro Python can work on other similar microcontrollers. On the project wiki there are list of supported or plausible for future support boards. At the time of writing this article STM32F4-Discovery and Teensy 3.1 are more-or-less supported.</p>
<p>Similar project - pymite existed long before Micro Python. It supports some boards, like Arduino Mega or two mbed boards, but on the other hand documentation and <q>marketing</q> are quite poore as well as it seems to be quite limited in terms of features (I didn't saw any example how to use I2C/UART/SPI on Arduino Mega. There is better support for mbeds, but the tutorials seems old and no buzz can be seen there).</p>

<a name="4" class="3" title="PyBoard in action"/>
<p>The API of the pyb module is quite easy to use. High level classes make handling some components quite easy. Some of my pyMCU code needed only minimal changes. Some time ago I wrote about <a href="/w/p/controlling-servo-and-stepper-motors-pymcu/">controlling servos</a> with pyMCU. The <strong>pyb</strong> module has a ready to use <a href="http://micropython.org/doc/module/pyb/Servo">Servo class</a> that we can use to the same thing. On the pyboard edge there are pins named from X1 to X4. As you can notice on the GPIO layout those are the pins that provide PWM for servo support. Power and GND are just next to them so it's easy to connect a three wire servo. The <strong>Servo.angle</strong> method will move the servo to a given angle. For an example we can use tilt in one of the axis to move the servo angle:</p>
<div class="box"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pyb</span>
<span class="n">servo</span> <span class="o">=</span> <span class="n">pyb</span><span class="o">.</span><span class="n">Servo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ac</span> <span class="o">=</span> <span class="n">pyb</span><span class="o">.</span><span class="n">Accel</span><span class="p">()</span>
<span class="n">SCALE_MULTIPLIER</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="n">pyb</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
  <span class="n">servo</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">*</span> <span class="n">SCALE_MULTIPLIER</span><span class="p">)</span>
</pre></div>
</div>
<p>Servo class constructor gets <q>1</q> as I used the X1 pin for the servo. I multiply the value from the X axis by 3 to increase the range of angle tilt the servo will get. When the loop start just tilt the board in the X axis and observe how the servo moves.</p>



<figure class="rkthumb"><a href="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/pyboard_servo.jpg" title="PyBoard with a servo" data-lightbox="pyboard_servo.jpg"><img src="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/thumb_pyboard_servo.jpg" alt="PyBoard with a servo"/></a><p>PyBoard with a servo</p></figure>


<p>I wrote about <a href="/w/p/handling-lcd-displays-usb-uart-your-computer/">UART controlled LCD displays</a>. For the hobbytronics serial LCD adapter I wrote a <strong>LCD</strong> class to make it easy and clean to display something on the LCD. To convert it from pyserial to Micro Python valid code we just need few minor changes - change the import to pyb and use <a href="http://micropython.org/doc/module/pyb/UART">pyb.UART</a>:</p>

<div class="box"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pyb</span>


<span class="k">class</span> <span class="nc">LCD</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">END</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commands</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'display_string'</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="s">'set_cursor_position'</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
            <span class="s">'clear_line'</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
            <span class="s">'clear'</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
            <span class="s">'set_lcd_type'</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
            <span class="s">'backlight'</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">pyb</span><span class="o">.</span><span class="n">UART</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="mi">9600</span><span class="p">)</span>
        <span class="n">pyb</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s">'set_lcd_type'</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s">'clear'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clear_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s">'clear_line'</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">set_backlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brightness</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s">'backlight'</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="n">brightness</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">set_cursor_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s">'set_cursor_position'</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">column</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">display_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s">'display_string'</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">execute_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="o">+</span> <span class="n">payload</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
</pre></div>
</div>
<p>Two methods have changed: <strong>configure</strong> and <strong>execute_command</strong>.</p>
<p>The usage is the same as the class interface did not change:</p>

<div class="box"><div class="highlight"><pre><span class="k">def</span> <span class="nf">do_serial_demo</span><span class="p">():</span>
    <span class="n">lcd</span> <span class="o">=</span> <span class="n">LCD</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">lcd</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
    <span class="n">lcd</span><span class="o">.</span><span class="n">set_backlight</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">accel</span> <span class="o">=</span> <span class="n">pyb</span><span class="o">.</span><span class="n">Accel</span><span class="p">()</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">set_cursor_position</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">display_string</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">accel</span><span class="o">.</span><span class="n">x</span><span class="p">()))</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">set_cursor_position</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">display_string</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">accel</span><span class="o">.</span><span class="n">y</span><span class="p">()))</span>
        <span class="n">pyb</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<p>I used UART3 as that was the one I found first (TX on pin Y9). I used a big 4x20 LCD and in the first two rows I've set X and Y axis tilt to be displayed.</p>


<figure class="rkthumb"><a href="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/pyboard_serial_lcd.jpg" title="PyBoard with UART controlled LCD display" data-lightbox="pyboard_serial_lcd.jpg"><img src="http://python.rk.edu.pl/site_media/resources/python.rk.edu.pl/images/thumb_pyboard_serial_lcd.jpg" alt="PyBoard with UART controlled LCD display"/></a><p>PyBoard with UART controlled LCD display</p></figure>



<a name="5" class="3" title="Summary"/>
<p>For Python developers and enthusiasts Micro Python seems the best solution for scripting electronics with Python. There is PyMCU but it requires a PC to work (and it has some hard edges, like I2C), there are single board computers like Raspberry Pi, BeagleBone Black or PcDuino with good Python support, but they are computers while you may sometimes need something smaller and much less power demanding (battery powered). The pyboard isn't cheap, it's much more expensive than Chinese Arduino clones. It can't work on simple microcontrollers used in small Arduinos, but there are similarly priced STM32 Nucleo boards and few others. With time Micro Python should be quite popular platform.</p>
    
</article>
</div></body></html>