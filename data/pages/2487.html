<html><body><div><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-1"><span class="crayon-c">#!/usr/bin/env python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">socket</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">sys</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">select</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-4"><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-5"><span class="crayon-c"># Read a line. Using select for non blocking reading of sys.stdin</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-6"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getLine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-7"><span class="crayon-h">    </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">select</span><span class="crayon-sy">.</span><span class="crayon-k ">select</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">stdin</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-cn">0.0001</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-8"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-9"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">stdin</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-10"><span class="crayon-h">            </span><span class="crayon-k ">input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">stdin</span><span class="crayon-sy">.</span><span class="crayon-k ">readline</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-11"><span class="crayon-h">            </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-k ">input</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-12"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">False</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-13"><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-14"><span class="crayon-v">host</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">raw_input</span><span class="crayon-sy">(</span><span class="crayon-s">"Please Enter IP: "</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-15"><span class="crayon-v">port</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-k ">raw_input</span><span class="crayon-sy">(</span><span class="crayon-s">"Please Enter PORT: "</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># Base 16 for hex value</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-16"><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-17"><span class="crayon-v">send_address</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">host</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">port</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># Set the address to send to</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-18"><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">socket</span><span class="crayon-sy">.</span><span class="crayon-k ">socket</span><span class="crayon-sy">(</span><span class="crayon-k ">socket</span><span class="crayon-sy">.</span><span class="crayon-v">AF_INET</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">socket</span><span class="crayon-sy">.</span><span class="crayon-v">SOCK_DGRAM</span><span class="crayon-sy">)</span><span class="crayon-h">    </span><span class="crayon-c"># Create Datagram Socket (UDP)</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-19"><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">setsockopt</span><span class="crayon-sy">(</span><span class="crayon-k ">socket</span><span class="crayon-sy">.</span><span class="crayon-v">SOL_SOCKET</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">socket</span><span class="crayon-sy">.</span><span class="crayon-v">SO_REUSEADDR</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># Make Socket Reusable</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-20"><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">setsockopt</span><span class="crayon-sy">(</span><span class="crayon-k ">socket</span><span class="crayon-sy">.</span><span class="crayon-v">SOL_SOCKET</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">socket</span><span class="crayon-sy">.</span><span class="crayon-v">SO_BROADCAST</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># Allow incoming broadcasts</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-21"><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">setblocking</span><span class="crayon-sy">(</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># Set socket to non-blocking mode</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-22"><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">bind</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">port</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">#Accept Connections on port</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-23"><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"Accepting connections on port"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">hex</span><span class="crayon-sy">(</span><span class="crayon-v">port</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-24"><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-25"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-26"><span class="crayon-h">    </span><span class="crayon-st">try</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-27"><span class="crayon-h">        </span><span class="crayon-v">message</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">address</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">recvfrom</span><span class="crayon-sy">(</span><span class="crayon-cn">8192</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># Buffer size is 8192. Change as needed.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-28"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">message</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-29"><span class="crayon-h">            </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">address</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"&gt; "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">message</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-30"><span class="crayon-e">    </span><span class="crayon-st">except</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-31"><span class="crayon-h">        </span><span class="crayon-r">pass</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-32"><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-33"><span class="crayon-h">    </span><span class="crayon-k ">input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getLine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b3f4d4105720415224-34"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-k ">input</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b3f4d4105720415224-35"><span class="crayon-h">        </span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">sendto</span><span class="crayon-sy">(</span><span class="crayon-k ">input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">send_address</span><span class="crayon-sy">)</span></p></div></div></body></html>