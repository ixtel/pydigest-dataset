<html><body><div><div role="main">
        
<h2>Security releases and advisory issued</h2>

<span class="meta">Posted by <strong>Daniele Procida and Tim Graham</strong> on March 9, 2015 </span>

<p>In accordance with <a class="reference external" href="https://docs.djangoproject.com/en/dev/internals/security/">our security release policy</a>, the Django team is issuing multiple releases -- Django 1.7.6 and Django 1.8b2. These releases are now available on PyPI and our download page. These releases address a security issue in the Django admin. We encourage all users of Django to upgrade as soon as possible. The Django master branch has also been updated. If you are using a Django version older than 1.7, the security issue in the admin does not affect you, but there is an important advisory below regarding similar vulnerabilities that may exist in your own code.</p>
<p>Usually we prenotify certain key organizations when we make security releases, but unfortunately in this case a <a class="reference external" href="https://code.djangoproject.com/ticket/24461">public disclosure of the vulnerability was made</a>, forcing us to issue a release without the usual process.</p>
<div class="section" id="s-issue-xss-attack-via-properties-in-modeladmin-readonly-fields">
<h3>Issue: XSS attack via properties in <tt class="docutils literal">ModelAdmin.readonly_fields</tt></h3>
<p>The <a class="reference external" href="https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.readonly_fields">ModelAdmin.readonly_fields</a>
attribute in the Django admin allows displaying model fields and model attributes. While the former
were correctly escaped, the latter were not. Thus untrusted content could be
injected into the admin, presenting an exploitation vector for XSS attacks.</p>
<p>In this vulnerability, every model attribute used in <tt class="docutils literal">readonly_fields</tt> that
is not an actual model field (e.g. a <a class="reference external" href="https://docs.python.org/3/library/functions.html#property">@property</a>)
will <strong>fail to be escaped</strong> even if that attribute is not marked as safe. In this release,
autoescaping is now correctly applied.</p>
<p>This issue has been assigned the identifier CVE-2015-2241.</p>
</div>
<div class="section" id="s-advisory-html-escaping-when-calling-template-filters-from-python-code">
<h3>Advisory: HTML escaping when calling template filters from Python code</h3>
<p>The vulnerability described above was caused by the admin's use of the <tt class="docutils literal">linebreaksbr</tt> function which doesn't escape its output by default when used outside of a template.</p>
<p>This same behavior is present in other functions from <a class="reference external" href="https://github.com/django/django/blob/master/django/template/defaultfilters.py">django.template.defaultfilters</a> that output HTML:</p>
<ul class="simple">
<li><tt class="docutils literal">join</tt></li>
<li><tt class="docutils literal">linebreaksbr</tt></li>
<li><tt class="docutils literal">linebreaks_filter</tt></li>
<li><tt class="docutils literal">linenumbers</tt></li>
<li><tt class="docutils literal">unordered_list</tt></li>
<li><tt class="docutils literal">urlize</tt></li>
<li><tt class="docutils literal">urlizetrunc</tt></li>
</ul>
<p>In versions older than 1.8b2, they use <tt class="docutils literal">autoescape=None</tt> as a default argument. This means when calling these functions directly from Python code, the input would be <strong>marked safe</strong>, but <strong>is not actually escaped</strong>, creating an XSS attack vector.</p>
<p>We've remedied this issue in 1.8b2+ by changing the default value of this option to <tt class="docutils literal">True</tt>. This ensures a safe behavior by default and helps prevent similar cases in the future. In addition, the <a class="reference external" href="https://docs.djangoproject.com/en/1.8/howto/custom-template-tags/#filters-and-auto-escaping">documentation for writing custom template filters</a> has been updated to recommend <tt class="docutils literal">True</tt> as the default value.</p>
<p>The change of the default parameter in 1.8 may create a compatibility issue for some users, but we feel it's important to use safe defaults. If escaping is not desired for your calls of these functions, you can revert to the old behavior by passing <tt class="docutils literal">autoescape=False</tt>.</p>
<p>Users of Django versions 1.0 to 1.7 should check their code for Python calls to these filters and ensure that any usage either explicitly sets <tt class="docutils literal">autoescape=True</tt> or passes only trusted content.</p>
<p>This issue only affects these template filters when they are called directly from Python code and not when they are used in templates.</p>
</div>
<div class="section" id="s-affected-versions">
<h3>Affected versions</h3>
<ul class="simple">
<li>Django master development branch (currently at pre-alpha status)</li>
<li>Django 1.8 (currently at beta status)</li>
<li>Django 1.7</li>
</ul>
</div>
<div class="section" id="s-resolution">
<h3>Resolution</h3>
<p>Patches have been applied to Django's master development branch and
to the 1.7 and 1.8 release branches. The patches may be obtained from the
following changesets:</p>

<p>The following new releases have been issued:</p>

</div>
<div class="section" id="s-disclosing-security-vulnerabilities">
<h3>Disclosing security vulnerabilities</h3>
<p>While we are always thrilled to receive reports of bugs that we can fix, we implore members of our community <strong>not</strong> to report security issues publicly. Reporting them privately allows us to prepare patches that can be released along with the public disclosure, and to prenotify key organizations. Public reports on the other hand expose users to greater risk and places undue strain on the team responsible for coming up with a solution.</p>
<p>For information about how to disclose a vulnerability and how those are handled by the Django team, please refer to <a class="reference external" href="https://docs.djangoproject.com/en/dev/internals/security/">our security release policy</a>.</p>
</div>


        <a href="#top" class="backtotop"><i class="icon icon-chevron-up"/> Back to Top</a>
      </div>

      
  </div></body></html>