<html><body><div><div class="aui-page-panel-inner">
    
    <p>I exist in a world that uses Python to power some pretty <a href="https://bitbucket.org">awesome sites</a> and internal
tools. From time to time there are REST APIs that I keep on hitting, it would be nice to turn
one into a <a href="https://help.hipchat.com/knowledgebase/articles/64451-work-faster-with-slash-commands">custom slash command</a> for <a href="https://www.hipchat.com/">HipChat</a>. I'll walk you through how I did that for an API.</p>
<p>You can find the code for <a href="https://bitbucket.org/travisthetechie/pypples">pypples</a>, a small API just does geocoding for a given address â€“
backed by Google. It's running on Heroku now. The project is pretty simple...</p>
<pre><code>.
|____ LICENSE.txt
|____ Procfile
|____ pypples
| |____ __init__.py
| |____ api
| | |____ __init__.py
| | |____ address_to_geocode.py
| | |____ resources.py
|____ README.md
|____ requirements.txt
|____ runserver.py</code></pre>
<p><a href="https://bitbucket.org/travisthetechie/pypples/src/32f79e384133b36ae6883604ce8bfd66e00a5bea/pypples/__init__.py"><code>pypples/__init__.py</code></a> starts up a <a href="http://flask.pocoo.org/">Flask</a> app and
<a href="https://bitbucket.org/travisthetechie/pypples/src/32f79e384133b36ae6883604ce8bfd66e00a5bea/pypples/api/__init__.py"><code>pypples/api/__init__.py</code></a> sets up some defaults for <a href="https://flask-restful.readthedocs.org/en/0.3.3/">Flask-RESTful</a>, and lets
<a href="https://bitbucket.org/travisthetechie/pypples/src/32f79e384133b36ae6883604ce8bfd66e00a5bea/pypples/api/resources.py"><code>pypples/api/resources.py</code></a> create a couple REST endpoints (<code>/geo</code>,
and <code>/hipchat/geo</code>). I extracted the actual work the API executed into
<a href="https://bitbucket.org/travisthetechie/pypples/src/32f79e384133b36ae6883604ce8bfd66e00a5bea/pypples/api/address_to_geocode.py"><code>pypples/api/address_to_geocode.py</code></a>, so the two endpoints in
<code>resources.py</code> could share that code. Not much effort to this API deployed to Heroku
using the <a href="https://toolbelt.heroku.com/">Heroku Toolbelt</a>:</p>
<pre><code class="lang-bash">heroku create pypples
git push heroku master
heroku ps:scale web=1</code></pre>
<p><em>And if you're new to Python &amp; Heroku, check out Heroku's <a href="https://devcenter.heroku.com/articles/getting-started-with-python">Getting Started with Python</a> article.</em></p>
<p>So now I have two endpoints at <a href="https://pypples.herokuapp.com/geo">https://pypples.herokuapp.com/geo</a> and
<a href="https://pypples.herokuapp.com/hipchat/geo">https://pypples.herokuapp.com/hipchat/geo</a>. Because slash commands in HipChat post data to the
endpoint, the second endpoint (<code>/hipchat/geo</code>) accepts HTTP POSTs.</p>
<p>Now I want to hook this up to HipChat, it's pretty simple. Go to <a href="https://atlassian.hipchat.com/rooms?t=mine">your rooms</a>, login, and find a
room that you want to add functionality to. Once there, find the "Integrations" option in the left
navigation.</p>
<p><img src="select-byo.png" alt="Select BYO Integrations"/></p>
<p>Find and click on "Build your own integration" and then name your integration.
The name isn't functionally important, it just helps you find the configuration later.</p>
<p><img src="enter-byo-name.png" alt="Name your integration"/></p>
<p>Hit next once you name your integration and scroll on down to create a new slash command. We need
the command and a URL to post data to.</p>
<p><img src="configure-byo-endpoint.png" alt="Configure the slash command"/></p>
<p>After this effort, you should be able to hit your slash command in your HipChat room!</p>
<p><img src="geo-lookup.png" alt="slash commands at work"/></p>
<p>So feel free to use <a href="https://bitbucket.org/travisthetechie/pypples">pypples</a> as a template for building APIs you might share between normal
REST consumers and HipChat. Good luck doing the same!</p>

    


    

  </div>

  </div></body></html>