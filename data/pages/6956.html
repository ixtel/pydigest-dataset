<html><body><div><div class="post">
            
            
            
            <a href="http://blog.yargies.com/post/130146906769/implementing-a-random-number-generator">
                <h2>Implementing a random number generator</h2> 
            </a>
            
            
            <p>Games typically have some randomness in them. The roll of dice, the deal of a hand of cards, or the selection of tiles in scrabble are all example of randomness in games. Implementing this in code can be as simple as calling the random number generator in the programming language you are using. However, when dealing with games that sync with a server and have some validation of results on the server, or that otherwise require cross-platform consistency, you’ll often want a random number generator that is repeatable, and guaranteed to be consistent across systems. In this situation, it can be a good idea to implement your own random number generator. It’s not as hard as you may think.
</p>

<p>One of the simplest random number generator algorithms is the <a href="http://t.umblr.com/redirect?z=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FLinear_congruential_generator&amp;t=OGZjOTQyZjc2NmRkZGY5MTM4OGYzYjcwYzI3NjhkZGE0NWNkN2NmZixrdE84RGpBZA%3D%3D">linear congruential generator algorithm</a>. This algorithm uses a simple linear formula to generate values and is easily implemented in any language. The formula is simply:</p>

<pre><code>x = (a*seed + c) % m
</code></pre>

<p>The multiplier (a), increment ©, and modulus (m) are constants that are chosen by you. Care must be taken when choosing these values. You’ll want parameters that result in a good period (eg the number of iterations before the generator repeats itself and returns to its initial seed). There are a lot of <a href="http://t.umblr.com/redirect?z=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FLinear_congruential_generator%23Parameters_in_common_use&amp;t=OGJiZGJmMDNiZDU0YWU2OTJhMWU2NGViNmVlOWMxNDJhM2RiZWVmMCxrdE84RGpBZA%3D%3D">published values</a> for these parameters. If you’re adventurous, you can also create your own. <a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwww.ams.org%2Fjournals%2Fmcom%2F1999-68-225%2FS0025-5718-99-00996-5%2FS0025-5718-99-00996-5.pdf&amp;t=ZWE4MDYzMWViNDVjMDAxZDg4MzVlMTk4NjRjYzhlNzUyYTA0NGZmYSxrdE84RGpBZA%3D%3D">This paper</a> describes a good criteria for choosing values and also lists a bunch of examples. This <a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fstackoverflow.com%2Fa%2F12096699%2F3482692&amp;t=OWNlNTExOWRjMmM3ZTQxOGIyNDAzMjVlMzEwMmFjNzllY2ZjMTYyNyxrdE84RGpBZA%3D%3D">stackoverflow answer</a> also briefly covers the criteria.</p>

<p>With the above formula (and a good set of parameters), you can generate a repeatable set of random numbers with a given seed. For example, in order to simulate the roll of a set of dice in Yahtzee, you would apply the formula with an initial seed and then use the generated random number as the seed to generate the next random number. Repeat until you have a random number for each of your six dice and use the modulus operator to convert those values to values ranging from 1 to 6 (ie the value shown on the dice).</p>

<p>In Python this formula could be written as:</p>

<pre><code>import random

class RandomSequence(object):
    """Create a sequence of random independent numbers using LCG.
    """
    MODULUS = 4294967296
    MULTIPLIER = 1664525
    INCREMENT = 1013904223

    def __init__(self, seed=None):
        self.seed = random.randint(0, self.MODULUS) if seed is None else seed

    def next_seed(self):
        self.seed = (self.seed*self.MULTIPLIER + self.INCREMENT) % self.MODULUS
        return self.seed

    def next_random(self):
        return self.next_seed() / self.MODULUS

    def next_int(self, a, b):
        assert b-a
        return self.next_seed() % abs(b-a) + min(a, b)
</code></pre>

<p>If you require an objective-c version for your iOS game, there’s an <a href="http://t.umblr.com/redirect?z=https%3A%2F%2Fgithub.com%2Fnicklockwood%2FRandomSequence&amp;t=NDkxZWQxODk1MmQ4NTNjYjZiODBkMjUzMDRmZDdlZDk0NmE3OTcyMyxrdE84RGpBZA%3D%3D">open source</a> version on github written by Nick Lockwood.</p>

<p>In my upcoming multiplayer game, players compete against each other by trying to complete the same puzzle as fast as possible. The puzzles are generated randomly on the client, but I generate a seed value on the server (using the built-in Python random number generator). Each client, on both iOS and android, has a linear congruential generator that uses the seed value to generate a sequence of random numbers that is used when creating the puzzle. This way, the puzzles are guaranteed to be the same for the players. I also do some validation on the server side when a player submits their turn. The random numbers used in a player’s turn (eg a dice roll) are validated using the LGC implementation in Python.</p>

<p>I’ve been working hard to get my multiplayer game done, and I’ll be announcing it here when it’s done. You can also follow me on Twitter for updates. I’m <a href="http://twitter.com/yargies">@yargies</a>.</p>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            </div>
            
            
            
        	</div></body></html>