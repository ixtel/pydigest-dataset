<html><body><div><div class="right_panel">
    <a href="/blog/2014/09/selenium-testing/" class="noline"><h1 class="post_title" itemprop="headline">Introduction to functional testing with Selenium in Django</h1></a>
    
    
      <p/><p>In this tutorial we will learn what selenium is and how it can be used in writing functional tests for our Django projects.</p>
<h2>What is Selenium?</h2>
<p>Selenium is a Web Browser automation tool, which basically means you can use it to surf web programmatically on real web browsers. But mostly selenium is used for testing web applications. It has packages for most programming languages. For python, we can try selenium by installing its package:</p>



<p>For a quick demo, we will open Django Documentation website, perform some search and check the first result. Save and run the following script:</p>
<div class="highlight"><pre><span class="n">from</span> <span class="n">selenium</span> <span class="n">import</span> <span class="n">webdriver</span>
<span class="n">from</span> <span class="n">selenium</span><span class="p">.</span><span class="n">webdriver</span><span class="p">.</span><span class="n">common</span><span class="p">.</span><span class="n">keys</span> <span class="n">import</span> <span class="n">Keys</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Firefox</span><span class="p">()</span>
<span class="n">driver</span><span class="p">.</span><span class="n">maximize_window</span><span class="p">()</span>
<span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"https://docs.djangoproject.com/"</span><span class="p">)</span>
<span class="n">search_box</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"q"</span><span class="p">)</span>
<span class="n">search_box</span><span class="p">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"testing"</span><span class="p">)</span>
<span class="n">search_box</span><span class="p">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">RETURN</span><span class="p">)</span>
<span class="n">assert</span> <span class="s">"Search"</span> <span class="n">in</span> <span class="n">driver</span><span class="p">.</span><span class="n">title</span>
<span class="cp"># Locate first result in page using css selectors.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">"div#search-results a"</span><span class="p">)</span>
<span class="n">result</span><span class="p">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">assert</span> <span class="s">"testing"</span> <span class="n">in</span> <span class="n">driver</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">driver</span><span class="p">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>


<p>Most of the code is self explanatory. It checks for the search box on the page, enter the search term and hit return key. Then it clicks on the first result and do an assert. <em>Keys</em> class is used for keyboard simulation and can also be used to enter special keys(we used RETURN key in example to submit form).</p>
<p>Selenium provide many methods to locate an element on a page:</p>
<ul>
<li>find_element_by_id</li>
<li>find_element_by_name</li>
<li>find_element_by_tag_name</li>
<li>find_element_by_xpath</li>
<li>find_element_by_link_text</li>
<li>find_element_by_partial_link_text</li>
<li>find_element_by_class_name</li>
<li>find_element_by_css_selector</li>
</ul>
<p>If multiple matches are found for a query then it returns the first match(note how we used css selector to find first result in above example). You can also find multiple elements with a given logic by similar methods. For example to locate all the links on the page you can do:</p>
<div class="highlight"><pre><span class="n">all_links</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span> <span class="err">#</span> <span class="n">note</span> <span class="n">the</span> <span class="sc">'s'</span> <span class="n">in</span> <span class="n">find_elements</span>
</pre></div>


<p>Each element is an object of WebElement class and have many methods associated with it. Most commonly used are:</p>
<ul>
<li>click - perform a mouse click on element</li>
<li>text - gets the text of the element</li>
<li>location - Returns the location of the element in the renderable canvas</li>
<li>is_displayed - Whether the element would be visible to a user</li>
<li>get_attribute(name) - Gets the attribute value.</li>
</ul>
<p>There are several more. You can read about them at the <a href="http://selenium.googlecode.com/svn/trunk/docs/api/py/webdriver_remote/selenium.webdriver.remote.webelement.html">Selenium Python docs</a>.</p>
<h2>Testing Django Web application</h2>
<p>We will setup a minimal Django project with just admin activated:</p>
<div class="highlight"><pre><span class="n">pip</span> <span class="n">install</span> <span class="n">Django</span><span class="o">==</span><span class="mf">1.6.6</span> <span class="n">selenium</span>
<span class="n">django</span><span class="o">-</span><span class="n">admin</span><span class="p">.</span><span class="n">py</span> <span class="n">startproject</span> <span class="n">myproject</span>
<span class="n">cd</span> <span class="n">myproject</span>
<span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">syncdb</span> <span class="o">--</span><span class="n">noinput</span>
</pre></div>


<h3>Note:</h3>
<p><em>Django 1.6 onwards, admin is activated in urls.py. If you are using django&lt;1.6, you should add the admin urls.</em></p>
<p>Now we will write a test to create a user in Django admin. Add a file <em>test.py</em> with following code:</p>
<div class="highlight"><pre><span class="n">from</span> <span class="n">django</span><span class="p">.</span><span class="n">test</span> <span class="n">import</span> <span class="n">LiveServerTestCase</span>
<span class="n">from</span> <span class="n">django</span><span class="p">.</span><span class="n">contrib</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">models</span> <span class="n">import</span> <span class="n">User</span>

<span class="n">from</span> <span class="n">selenium</span> <span class="n">import</span> <span class="n">webdriver</span>

<span class="n">class</span> <span class="n">AdminTestCase</span><span class="p">(</span><span class="n">LiveServerTestCase</span><span class="p">)</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">setUp</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
        <span class="err">#</span> <span class="n">setUp</span> <span class="n">is</span> <span class="n">where</span> <span class="n">you</span> <span class="n">instantiate</span> <span class="n">the</span> <span class="n">selenium</span> <span class="n">webdriver</span> <span class="n">and</span> <span class="n">loads</span> <span class="n">the</span> <span class="n">browser</span><span class="p">.</span>
        <span class="n">User</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">create_superuser</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="err">'</span><span class="n">admin</span><span class="err">'</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="err">'</span><span class="n">admin</span><span class="err">'</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="n">admin</span><span class="err">@</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="err">'</span>
        <span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Firefox</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">maximize_window</span><span class="p">()</span>
        <span class="n">super</span><span class="p">(</span><span class="n">AdminTestCase</span><span class="p">,</span> <span class="n">self</span><span class="p">).</span><span class="n">setUp</span><span class="p">()</span>

    <span class="n">def</span> <span class="n">tearDown</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
        <span class="err">#</span> <span class="n">Call</span> <span class="n">tearDown</span> <span class="n">to</span> <span class="n">close</span> <span class="n">the</span> <span class="n">web</span> <span class="n">browser</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">quit</span><span class="p">()</span>
        <span class="n">super</span><span class="p">(</span><span class="n">AdminTestCase</span><span class="p">,</span> <span class="n">self</span><span class="p">).</span><span class="n">tearDown</span><span class="p">()</span>

    <span class="n">def</span> <span class="n">test_create_user</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
        <span class="s">"""</span>
        <span class="n">Django</span> <span class="n">admin</span> <span class="n">create</span> <span class="n">user</span> <span class="n">test</span>
        <span class="n">This</span> <span class="n">test</span> <span class="n">will</span> <span class="n">create</span> <span class="n">a</span> <span class="n">user</span> <span class="n">in</span> <span class="n">django</span> <span class="n">admin</span> <span class="n">and</span> <span class="n">assert</span> <span class="n">that</span>
        <span class="n">page</span> <span class="n">is</span> <span class="n">redirected</span> <span class="n">to</span> <span class="n">the</span> <span class="n">new</span> <span class="n">user</span> <span class="n">change</span> <span class="n">form</span><span class="p">.</span>
        <span class="s">"""</span>
        <span class="err">#</span> <span class="n">Open</span> <span class="n">the</span> <span class="n">django</span> <span class="n">admin</span> <span class="n">page</span><span class="p">.</span>
        <span class="err">#</span> <span class="n">DjangoLiveServerTestCase</span> <span class="n">provides</span> <span class="n">a</span> <span class="n">live</span> <span class="n">server</span> <span class="n">url</span> <span class="n">attribute</span>
        <span class="err">#</span> <span class="n">to</span> <span class="n">access</span> <span class="n">the</span> <span class="n">base</span> <span class="n">url</span> <span class="n">in</span> <span class="n">tests</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
            <span class="err">'</span><span class="o">%</span><span class="n">s</span><span class="o">%</span><span class="n">s</span><span class="err">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">live_server_url</span><span class="p">,</span>  <span class="s">"/admin/"</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="err">#</span> <span class="n">Fill</span> <span class="n">login</span> <span class="n">information</span> <span class="n">of</span> <span class="n">admin</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s">"id_username"</span><span class="p">)</span>
        <span class="n">username</span><span class="p">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"admin"</span><span class="p">)</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s">"id_password"</span><span class="p">)</span>
        <span class="n">password</span><span class="p">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"admin"</span><span class="p">)</span>

        <span class="err">#</span> <span class="n">Locate</span> <span class="n">Login</span> <span class="n">button</span> <span class="n">and</span> <span class="n">click</span> <span class="n">it</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="err">'</span><span class="c1">//input[@value="Log in"]').click()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
            <span class="err">'</span><span class="o">%</span><span class="n">s</span><span class="o">%</span><span class="n">s</span><span class="err">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">live_server_url</span><span class="p">,</span> <span class="s">"/admin/auth/user/add/"</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="err">#</span> <span class="n">Fill</span> <span class="n">the</span> <span class="n">create</span> <span class="n">user</span> <span class="n">form</span> <span class="n">with</span> <span class="n">username</span> <span class="n">and</span> <span class="n">password</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s">"id_username"</span><span class="p">).</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"test"</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s">"id_password1"</span><span class="p">).</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"test"</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s">"id_password2"</span><span class="p">).</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"test"</span><span class="p">)</span>

        <span class="err">#</span> <span class="n">Forms</span> <span class="n">can</span> <span class="n">be</span> <span class="n">submitted</span> <span class="n">directly</span> <span class="n">by</span> <span class="n">calling</span> <span class="n">its</span> <span class="n">method</span> <span class="n">submit</span>
        <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s">"user_form"</span><span class="p">).</span><span class="n">submit</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">"Change user"</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">selenium</span><span class="p">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>


<p>Django LiveServerTestCase is extended from TransactionTestCase class. It launches a Django server(on port 8081) in the background on setup and shuts it down on teardown. Note in the code above we are instantiating the selenium webdriver in the setUp method and call quit on it in tearDown. We can get the server url from live_server_url attribute provided by TestCase.</p>
<p>Now just run the test command:</p>



<p>You will see a firefox browser opens and run the test. This is a very simple example but you can use selenium to check every major functionality of your website.</p>
<p>We will cover some advanced functionality like testing javascript heavy site and running tests on travis, <a href="https://saucelabs.com">Sauce</a>, <a href="https://www.browserstack.com">BrowserStack</a> in our <a href="http://agiliq.com/blog/2014/09/advanced-functional-testing-with-selenium/">next post</a>. Meanwhile read more about selenium at the Python selenium docs <a href="http://selenium-python.readthedocs.org/index.html">here</a>(unofficial but good for beginners) and <a href="http://selenium.googlecode.com/svn/trunk/docs/api/py/index.html">here</a>(official). Happy Testing</p>

      
          <hr/>
          
      

      
      
        <h4>Related Posts</h4>
        
      

      <hr/>
      <p>Can we help you build amazing apps? <a href="/contactus">Contact us today.</a>
    
    </p> 


  </div>
</div></body></html>