<html><body><div><div class="entry-content clearfix">







<p>Welcome to part 2!</p>

<p><em>Again, here’s what we’re covering</em>: <strong>Let’s look at the small, yet powerful JavaScript UI library <a href="http://facebook.github.io/react/">ReactJS</a> in action, as we build a basic web application.</strong> This app is powered by Python 3 and the <a href="http://flask.pocoo.org/">Flask framework</a>, in the back-end, along with <a href="http://gulpjs.com/">gulp.js</a> (task runner), <a href="http://bower.io/">bower</a> (front-end package manager), and <a href="http://browserify.org/">Browserify</a> (JavaScript dependency bundler), in the front.</p>

<ul>
<li>Part 1 – <a href="/blog/python/the-ultimate-flask-front-end/">getting started</a></li>
<li><strong>Part 2 – developing a dynamic search tool (current)</strong></li>
</ul>


<blockquote><p><strong>Note</strong> This tutorial uses React v<a href="http://facebook.github.io/react/blog/2014/12/18/react-v0.12.2.html">0.12.2</a>.</p></blockquote>

<a name="React.-.round.two"/>
<h2>React – round two</h2>

<p>Hello World is great and all, but let’s build something a bit more fun – a dynamic search tool. This <a href="http://facebook.github.io/react/docs/reusable-components.html">Component</a> is used to filter down a list of items based on user input.</p>

<blockquote><p>Need the code? Grab it from the <a href="https://github.com/realpython/ultimate-flask-front-end/tags">repo</a>. Download <a href="https://github.com/realpython/ultimate-flask-front-end/releases/tag/v2">v2</a> to start where we left off from part 1.</p></blockquote>

<p>Add the following code to <em>project/statics/scripts/jsx/main.js</em>:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="cm">/** @jsx React.DOM */</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">DynamicSearch</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class="line">
</span><span class="line">  <span class="c1">// sets initial state</span>
</span><span class="line">  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class="line">    <span class="k">return</span> <span class="p">{</span> <span class="nx">searchString</span><span class="o">:</span> <span class="s1">''</span> <span class="p">};</span>
</span><span class="line">  <span class="p">},</span>
</span><span class="line">
</span><span class="line">  <span class="c1">// sets state, triggers render method</span>
</span><span class="line">  <span class="nx">handleChange</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
</span><span class="line">    <span class="c1">// grab value form input box</span>
</span><span class="line">    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">searchString</span><span class="o">:</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">});</span>
</span><span class="line">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"scope updated!"</span><span class="p">)</span>
</span><span class="line">  <span class="p">},</span>
</span><span class="line">
</span><span class="line">  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">    <span class="kd">var</span> <span class="nx">countries</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">items</span><span class="p">;</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">searchString</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">searchString</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span class="line">
</span><span class="line">    <span class="c1">// filter countries list by value from input box</span>
</span><span class="line">    <span class="k">if</span><span class="p">(</span><span class="nx">searchString</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
</span><span class="line">      <span class="nx">countries</span> <span class="o">=</span> <span class="nx">countries</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">country</span><span class="p">){</span>
</span><span class="line">        <span class="k">return</span> <span class="nx">country</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">match</span><span class="p">(</span> <span class="nx">searchString</span> <span class="p">);</span>
</span><span class="line">      <span class="p">});</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">
</span><span class="line">    <span class="k">return</span> <span class="p">(</span>
</span><span class="line">      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span><span class="line">        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">searchString</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">}</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">"Search!"</span> <span class="o">/&gt;</span>
</span><span class="line">        <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
</span><span class="line">          <span class="p">{</span> <span class="nx">countries</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">country</span><span class="p">){</span> <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">country</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="o">&lt;</span><span class="err">/li&gt; }) }</span>
</span><span class="line">        <span class="o">&lt;</span><span class="err">/ul&gt;</span>
</span><span class="line">      <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class="line">    <span class="p">)</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="c1">// list of countries, defined with JavaScript object literals</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">countries</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">  <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Sweden"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"China"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Peru"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Czech Republic"</span><span class="p">},</span>
</span><span class="line">  <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Bolivia"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Latvia"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Samoa"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Armenia"</span><span class="p">},</span>
</span><span class="line">  <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Greenland"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Cuba"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Western Sahara"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Ethiopia"</span><span class="p">},</span>
</span><span class="line">  <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Malaysia"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Argentina"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Uganda"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Chile"</span><span class="p">},</span>
</span><span class="line">  <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Aruba"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Japan"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Trinidad and Tobago"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Italy"</span><span class="p">},</span>
</span><span class="line">  <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Cambodia"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Iceland"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Dominican Republic"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Turkey"</span><span class="p">},</span>
</span><span class="line">  <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Spain"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Poland"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Haiti"</span><span class="p">}</span>
</span><span class="line"><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="nx">React</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
</span><span class="line">  <span class="o">&lt;</span><span class="nx">DynamicSearch</span> <span class="nx">items</span><span class="o">=</span><span class="p">{</span> <span class="nx">countries</span> <span class="p">}</span> <span class="o">/&gt;</span><span class="p">,</span>
</span><span class="line">  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'main'</span><span class="p">)</span>
</span><span class="line"><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>What’s going on?</strong></p>

<p>We created a Component called <code>DynamicSearch</code>, which updates the DOM when the value in the input box is changed. How does this work? Well, the <code>handleChange()</code> function is called when a value is added or removed from the input box, which, in turn, updates the state via <code>setState()</code>. This method then calls the <code>render()</code> function to re-render the Component.</p>

<p><em>The key takeaway here is that state changes only occur within the Component.</em></p>

<p>Test it out:</p>









<p>Since we added our JSX code to an external file, we need to trigger the transform, from JSX to vanilla JavaScript, outside the browser with Gulp.</p>

<a name="Gulp"/>
<h2>Gulp</h2>

<p><a href="http://gulpjs.com/">Gulp</a> is a powerful task runner/build tool that can be used to handle the transform process. We’ll also use it to watch for changes to our code (<em>project/static/scripts/jsx/main.js</em>) and automatically create new builds based on those changes.</p>

<a name="Initialization"/>
<h3>Initialization</h3>

<p>Like bower, you can install gulp with npm. Install it globally, and then add it to the <em>package.json</em> file:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>npm install -g gulp
</span><span class="line"><span class="nv">$ </span>npm install --save-dev gulp
</span></code></pre></td></tr></table></div></figure>


<p>Add a <em>gulpfile.js</em> at the root directory of your project:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="s1">'use strict'</span><span class="p">;</span>
</span><span class="line">
</span><span class="line"><span class="c1">// requirements</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">gulp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp'</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello!"</span><span class="p">)</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>This file tells gulp what tasks to run and in what order to run them in. You can see that our <code>default</code> task logs the string <code>hello!</code> to the console. You can run this task by simply running <code>gulp</code>. You should see something like:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>gulp
</span><span class="line"><span class="o">[</span>08:54:47<span class="o">]</span> Using gulpfile ~/gulpfile.js
</span><span class="line"><span class="o">[</span>08:54:47<span class="o">]</span> Starting <span class="s1">'default'</span>...
</span><span class="line">hello!
</span><span class="line"><span class="o">[</span>08:54:47<span class="o">]</span> Finished <span class="s1">'default'</span> after 148 Îźs
</span></code></pre></td></tr></table></div></figure>


<p>We need the following gulp plugins for this project-</p>




<p>-as well as-</p>




<p>-which we can add to the <em>package.json</em> file. Update the file like so:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
</pre></td><td class="code"><pre><code class="json"><span class="line"><span class="p">{</span>
</span><span class="line">  <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"ultimate-flask-front-end"</span><span class="p">,</span>
</span><span class="line">  <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"1.0.0"</span><span class="p">,</span>
</span><span class="line">  <span class="nt">"description"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
</span><span class="line">  <span class="nt">"main"</span><span class="p">:</span> <span class="s2">"index.js"</span><span class="p">,</span>
</span><span class="line">  <span class="nt">"scripts"</span><span class="p">:</span> <span class="p">{</span>
</span><span class="line">    <span class="nt">"test"</span><span class="p">:</span> <span class="s2">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
</span><span class="line">  <span class="p">},</span>
</span><span class="line">  <span class="nt">"author"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
</span><span class="line">  <span class="nt">"license"</span><span class="p">:</span> <span class="s2">"ISC"</span><span class="p">,</span>
</span><span class="line">  <span class="nt">"devDependencies"</span><span class="p">:</span> <span class="p">{</span>
</span><span class="line">    <span class="nt">"bower"</span><span class="p">:</span> <span class="s2">"^1.3.12"</span><span class="p">,</span>
</span><span class="line">    <span class="nt">"gulp"</span><span class="p">:</span> <span class="s2">"^3.8.11"</span><span class="p">,</span>
</span><span class="line">    <span class="nt">"gulp-browserify"</span><span class="p">:</span> <span class="s2">"^0.5.1"</span><span class="p">,</span>
</span><span class="line">    <span class="nt">"gulp-clean"</span><span class="p">:</span> <span class="s2">"^0.3.1"</span><span class="p">,</span>
</span><span class="line">    <span class="nt">"gulp-size"</span><span class="p">:</span> <span class="s2">"^1.2.1"</span><span class="p">,</span>
</span><span class="line">    <span class="nt">"react"</span><span class="p">:</span> <span class="s2">"^0.12.2"</span><span class="p">,</span>
</span><span class="line">    <span class="nt">"reactify"</span><span class="p">:</span> <span class="s2">"^1.0.0"</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now just run <code>npm install</code> to install these additional plugins.</p>

<blockquote><p>You can see these installed plugins within the “node_modules” directory. Make sure to include this directory in your <em>.gitignore</em> file.</p></blockquote>

<p>Finally, update <em>gulpfile.js</em>:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="s1">'use strict'</span><span class="p">;</span>
</span><span class="line">
</span><span class="line"><span class="c1">// requirements</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">gulp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp'</span><span class="p">),</span>
</span><span class="line">    <span class="nx">browserify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-browserify'</span><span class="p">),</span>
</span><span class="line">    <span class="nx">size</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-size'</span><span class="p">),</span>
</span><span class="line">    <span class="nx">clean</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-clean'</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="c1">// tasks</span>
</span><span class="line">
</span><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="c1">// add task</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="c1">// add task</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello!"</span><span class="p">)</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now let’s add some tasks, starting with <code>transform</code> to handle, well, the transform process from JSX to JavaScript.</p>

<a name="First.task.-..code.transform..code."/>
<h3>First task – <code>transform</code></h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">'./project/static/scripts/jsx/main.js'</span><span class="p">)</span>
</span><span class="line">    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">browserify</span><span class="p">({</span><span class="nx">transform</span><span class="o">:</span> <span class="p">[</span><span class="s1">'reactify'</span><span class="p">]}))</span>
</span><span class="line">    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'./project/static/scripts/js'</span><span class="p">))</span>
</span><span class="line">    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">size</span><span class="p">());</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>task()</code> function takes two arguments – the task’s name and an anonymous function to run in order to tell/instruct the task what to do. Here we define the task, <code>transform</code>, and then within the function, we:</p>

<ul>
<li>Specify the source directory,</li>
<li>Create the Browserify bundler functionality along with the transformer via <a href="https://github.com/andreypopp/reactify">Reactify</a>,</li>
<li>Specify the destination directory, and</li>
<li>Calculate the size of the created file.</li>
</ul>


<p>Gulp utilizes pipes to <a href="http://nodejs.org/api/stream.html">stream</a> data for processing. After grabbing the source file (<em>main.js</em>), the file is then “piped” to the <code>browserify()</code> function for transformation/bundling. This transformed and bundled code is then “piped” to the destination directory along with the <code>size()</code> function.</p>

<blockquote><p>Curious about pipes and streams? Check out <a href="https://github.com/substack/stream-handbook">this</a> excellent resource.</p></blockquote>

<p>Ready for a quick test? Update <em>index.html</em>:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class="line"><span class="nt">&lt;html&gt;</span>
</span><span class="line">  <span class="nt">&lt;head</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;title&gt;</span>Flask React<span class="nt">&lt;/title&gt;</span>
</span><span class="line">    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="c">&lt;!-- styles --&gt;</span>
</span><span class="line">    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"{{ url_for('static', filename='bower_components/bootstrap/dist/css/bootstrap.min.css') }}"</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"{{ url_for('static', filename='css/style.css') }}"</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;/head&gt;</span>
</span><span class="line">  <span class="nt">&lt;body&gt;</span>
</span><span class="line">    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
</span><span class="line">      <span class="nt">&lt;h1&gt;</span>Flask React<span class="nt">&lt;/h1&gt;</span>
</span><span class="line">      <span class="nt">&lt;br&gt;</span>
</span><span class="line">      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"main"</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class="line">    <span class="nt">&lt;/div&gt;</span>
</span><span class="line">    <span class="c">&lt;!-- scripts --&gt;</span>
</span><span class="line">    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"{{ url_for('static', filename='bower_components/react/react.min.js') }}"</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line">    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"{{ url_for('static', filename='bower_components/jquery/dist/jquery.min.js') }}"</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line">    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"{{ url_for('static', filename='bower_components/bootstrap/dist/js/bootstrap.min.js') }}"</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line">    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"{{ url_for('static', filename='scripts/js/main.js') }}"</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line">  <span class="nt">&lt;/body&gt;</span>
</span><span class="line"><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then update the <code>default</code> task:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">gulp</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">);</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Test:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>gulp
</span><span class="line"><span class="o">[</span>08:58:39<span class="o">]</span> Using gulpfile /gulpfile.js
</span><span class="line"><span class="o">[</span>08:58:39<span class="o">]</span> Starting <span class="s1">'default'</span>...
</span><span class="line"><span class="o">[</span>08:58:39<span class="o">]</span> Starting <span class="s1">'transform'</span>...
</span><span class="line"><span class="o">[</span>08:58:39<span class="o">]</span> Finished <span class="s1">'default'</span> after 12 ms
</span><span class="line"><span class="o">[</span>08:58:40<span class="o">]</span> all files 2.37 kB
</span><span class="line"><span class="o">[</span>08:58:40<span class="o">]</span> Finished <span class="s1">'transform'</span> after 181 ms
</span></code></pre></td></tr></table></div></figure>


<p>Did you notice the second to last line? This is the result of the <code>size()</code> function. In other words, the newly created JavaScript file (after the transform), <em>project/static/scripts/js/main.js</em>, is 2.37 kB in size.</p>

<p>Fire up the Flask server, and navigate to <a href="http://localhost:5000/hello">http://localhost:5000/</a>. You should see all the countries along with the search box. Test out the functionality. Also, if you open the JavaScript console within Chrome Developer Tools, you’ll see the string, <code>scope updated!</code>, logged every time there’s a change in scope – which comes from the <code>handleChange()</code> function in the <code>DynamicSearch</code> Component.</p>

<a name="Second.task.-..code.clean..code."/>
<h3>Second task – <code>clean</code></h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">([</span><span class="s1">'./project/static/scripts/js'</span><span class="p">],</span> <span class="p">{</span><span class="nx">read</span><span class="o">:</span> <span class="kc">false</span><span class="p">})</span>
</span><span class="line">    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">clean</span><span class="p">());</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>When this task is ran, we grab the source directory – the result of the <code>transform</code> task – and then run the <code>clean()</code> function to remove the directory and its contents. It’s a good idea to run this before each new build to ensure you start fresh and clean.</p>

<p>Try running <code>gulp clean</code>. This should remove “project/static/scripts/js”. Let’s add it to our <code>default</code> task so that it automatically runs before the transformation:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'clean'</span><span class="p">],</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">gulp</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">);</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Be sure to test this out before moving on.</p>

<a name="Third.task.-.code.watch..code."/>
<h3>Third task –<code>watch</code></h3>

<p>Finally, update the <code>default</code> task one last time, adding the ability to automatically re-run the <code>transform</code> task anytime changes are made to the <em>project/static/scripts/jsx/main.js</em> file:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'clean'</span><span class="p">],</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">gulp</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">);</span>
</span><span class="line">  <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'./project/static/scripts/jsx/main.js'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'transform'</span><span class="p">]);</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Open up a new terminal window and run <code>gulp</code> to generate a new build and activate the <code>watcher</code> functionality. In the other window run <code>sh run.sh</code> to run the Flask server. Your app should be running. Now if you comment out all the code in the <em>project/static/scripts/jsx/main.js</em> file, this will trigger the <code>transform</code> function. Refresh the browser to see the changes. Make sure to revert the changes when done.</p>

<p>Want to take this to the next level? Check out the <a href="https://github.com/vohof/gulp-livereload">Livereload</a> plugin.</p>

<a name="Conclusion"/>
<h2>Conclusion</h2>

<p>Here’s the end result after adding some custom styles to <em>project/static/css/style.css</em>:</p>









<p>Be sure to check out the official <a href="http://facebook.github.io/react/">documentation</a> along with the excellent <a href="http://facebook.github.io/react/docs/tutorial.html">tutorial</a> for more information on React.</p>

<p>Grab the code from the <a href="https://github.com/realpython/ultimate-flask-front-end">repo</a>. Comment below if you have any questions or spot any errors. Also, what else would you like to see? We may add a third part if people are interested. Comment below.</p>






<p>
  <em>Edits made by <a href="https://twitter.com/diek007">Derrick Kearney</a>. Thanks again!</em>
</p>

</div>


      </div></body></html>