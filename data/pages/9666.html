<html><body><div><div id="what-is-this">
<h2>What is this?</h2>
<p>This is a pytest plugin, that enables you to test your code that relies on a
database connection to a MongoDB and expects certain data to be present.
It allows you to specify fixtures for database collections in JSON/BSON or YAML
format. Under the hood we use the <a href="https://github.com/vmalloc/mongomock" rel="nofollow">mongomock</a> library, that you should
consult for documentation on how to use MongoDB mock objects. If suitable you
can also use a real MongoDB server.</p>
<p><em>Note</em>: This project has been renamed from <tt>humongous</tt> to <tt><span class="pre">pytest-mongodb</span></tt> in order
to conform to the pytest plugin naming conventions and to be more easy to find on the
Python package index. See the <a href="#migration-section" rel="nofollow">migration section</a> for more information.</p>
<div id="configuration">
<h3>Configuration</h3>
<p>If you don’t want to put your fixtures on the top-level directory of your package
you have to specify a directory where <tt><span class="pre">pytest-mongodb</span></tt> looks for your data definitions.</p>
<p>To do so put a line like the following under the <tt>pytest</tt> section of your
<tt>pytest.ini</tt>-file put a</p>
<pre><span class="k">[pytest]</span>
<span class="na">mongodb_fixture_dir</span> <span class="o">=</span><span class="s">
  tests/unit/fixtures</span>
</pre>
<p><tt><span class="pre">pytest-mongodb</span></tt> would then look for files ending in <tt>.yaml</tt> or <tt>.json</tt> in that
directory.</p>
<p>You can also choose to use a real MongoDB server for your tests. In that case
you might also want to configure the hostname and/or the credentials if you
don’t want to stick with the default (localhost and no credentials). Use the
following configuration values in your <tt>pytest.ini</tt> to adapt the settings to
your needs:</p>
<pre><span class="k">[pytest]</span>
<span class="na">mongodb_engine</span> <span class="o">=</span> <span class="s">pymongo</span>
<span class="na">mongodb_host</span> <span class="o">=</span> <span class="s">mongodb://user:passwd@server.tld</span>
<span class="na">mongodb_dbname</span> <span class="o">=</span> <span class="s">mydbname</span>
</pre>
</div>
<div id="basic-usage">
<h3>Basic usage</h3>
<p>After you configured <tt><span class="pre">pytest-mongodb</span></tt> so that it can find your fixtures you’re ready to
specify some data. Regardless of the markup language you choose, the data is provided
as a list of documents (dicts). The collection that these documents are being inserted
into is given by the filename of your fixture-file. E.g.: If you had a file named
<tt>players.yaml</tt> with the following content:</p>
<pre><span class="p-Indicator">-</span>
  <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Mario</span>
  <span class="l-Scalar-Plain">surname</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Götze</span>
  <span class="l-Scalar-Plain">position</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">striker</span>

<span class="p-Indicator">-</span>
  <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Manuel</span>
  <span class="l-Scalar-Plain">surname</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Neuer</span>
  <span class="l-Scalar-Plain">position</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">keeper</span>
</pre>
<p>you’d end up with a collection <tt>players</tt> that has the above player definitions
inserted. If your fixture file is in JSON/BSON format you can also use BSON specific
types like <tt>$oid</tt>, <tt>$date</tt>, etc.</p>
<p>You get ahold of the database in you test-function by using the <tt>humongous</tt> fixture
like so:</p>
<pre><span class="k">def</span> <span class="nf">test_players</span><span class="p">(</span><span class="n">mongodb</span><span class="p">):</span>
    <span class="k">assert</span> <span class="s1">'players'</span> <span class="ow">in</span> <span class="n">mongodb</span><span class="o">.</span><span class="n">collection_names</span><span class="p">()</span>
    <span class="n">manuel</span> <span class="o">=</span> <span class="n">mongodb</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Manuel'</span><span class="p">})</span>
    <span class="k">assert</span> <span class="n">manuel</span><span class="p">[</span><span class="s1">'surname'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Neuer'</span>
</pre>
<p>For further information refer to the <a href="https://github.com/vmalloc/mongomock" rel="nofollow">mongomock</a> documentation.</p>
</div>
<div id="migration-from-humongous">
<h3>Migration from humongous</h3>
<p id="migration-section">In the course of migrating the package name from <tt>humongous</tt> to <tt><span class="pre">pytest-mongodb</span></tt> most
configuration values which previously were prefixed with <tt>humongous_</tt> have been
renamed to a <tt>mongodb_</tt>-prefixed counterpart. The only notable exception is the
<tt>humongous_basedir</tt> config value, which now is named <tt>mongodb_fixture_dir</tt>.
Additionally the commandline options have been unified, in a way that multi-word option
names are now consistently separated with dashes instead of underscores.</p>
</div>
</div>


</div></body></html>