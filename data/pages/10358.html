<html><body><div><div class="entry-content content">


  <p><a href="http://www.sympy.org/en/index.html">SymPy</a> is an amazing library for symbolic mathematics in Python. It’s like <a href="http://www.wolfram.com/mathematica/">Mathematica</a>, and its <a href="http://live.sympy.org/">online shell</a> version along with <a href="http://www.sympygamma.com/">SymPy Gamma</a>  is pretty much like<a href="https://www.wolframalpha.com/"> Wolfram Alpha</a> (WA). OK, I know you can ask WA some pretty cool questions, but let’s face it, most of use just want to find the derivative of a function, or simplify an expression, and not compare the GDP of Nigeria with the profit of Google. <a href="https://www.wolframalpha.com/input/?i=gdp+of+nigeria+%3E+google+profit&amp;rawformassumption=%7B%22DPClash%22,+%22FinancialE%22,+%22google%22%7D+-%3E+%7B%22NASDAQ:GOOG%22%7D">Here</a> it is if you’re interested btw. Also WA isn’t free anymore, and we all love Python so why not give SymPy a try?</p>
<p>This post definitely won’t be an in-depth tour in SymPy, I’m learning it myself at the moment as well. I’ve barely scratched its surface and I already love it, not to mention the <a href="http://matthewrocklin.com/blog/work/2013/04/05/SymPy-Theano-part-3/">ridiculously powerful stuff</a> you can do with it, once you master it.</p>
<p>In this dummy example we’ll go to a gallery and figure out how far we should stand from a huge painting on the wall so we have the widest possible viewing angle. If you have a look at the image below you’ll see, that the bottom of the painting is 3 meters above our level of eyesight and the top of the painting is 15 meters above it. These numbers are totally made up and the this whole example isn’t very realistic, but we’ll go with it anyway because we need an example.. You can imagine that if you were standing right below the painting you wouldn’t see much of it. Same thing would happen if you stood very far away. But where exactly should you stand to get the best viewing angle? (Btw I took this example from <a href="https://mooculus.osu.edu/">here</a>.)</p>
<p><img class="x-img x-img-rounded right" src="http://danielhomola.com/wp-content/uploads/2016/02/sympy_opt.jpg" alt="Where to stand in a gallery?"/>
</p><p>So we are looking for the maximum <img src="//s0.wp.com/latex.php?latex=%5Ctheta&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="\theta" title="\theta" class="latex"/> as we are moving closer to or further away from the painting, effectively varying <img src="//s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x" title="x" class="latex"/>. Basic geometry tells us that we can find this angle as the difference of two related angles <img src="//s0.wp.com/latex.php?latex=%5Calpha-%5Cbeta&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="\alpha-\beta" title="\alpha-\beta" class="latex"/>, and trigonometry tells us that</p>
<p><img src="//s0.wp.com/latex.php?latex=f%28x%29+%3D+%5Ctheta+%3D+%5Carctan+%5Cleft%28%5Cfrac%7B15%7D%7Bx%7D%5Cright%29-%5Carctan+%5Cleft%28%5Cfrac%7B3%7D%7Bx%7D%5Cright%29+&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x) = \theta = \arctan \left(\frac{15}{x}\right)-\arctan \left(\frac{3}{x}\right) " title="f(x) = \theta = \arctan \left(\frac{15}{x}\right)-\arctan \left(\frac{3}{x}\right) " class="latex"/>.</p>
<p>OK, so we want to find the maximum of this function with respect to <img src="//s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x" title="x" class="latex"/>. So we  need to differentiate it, find its critical points and check at which of those critical points the second derivative is negative (i.e. there we’ll have the max of <img src="//s0.wp.com/latex.php?latex=f%28x%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)" title="f(x)" class="latex"/>).</p>
<p>We could do this manually remembering that</p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cfrac%7Bd%7D%7Bdx%7D%5Carctan+x%3D%5Cfrac%7B1%7D%7B1%2Bx%5E2%7D%2C&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="\frac{d}{dx}\arctan x=\frac{1}{1+x^2}," title="\frac{d}{dx}\arctan x=\frac{1}{1+x^2}," class="latex"/></p>
<p>but what’s the fun in that? :) So let’s type a few lines of code into <a href="http://live.sympy.org/">SymPy’s online shell</a>:</p>


		<div id="crayon-56d59bb1e990f457446996" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59bb1e990f457446996-1"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">atan</span><span class="crayon-sy">(</span><span class="crayon-cn">15</span><span class="crayon-o">/</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">atan</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-o">/</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bb1e990f457446996-2"><span class="crayon-v">df1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">diff</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59bb1e990f457446996-3"><span class="crayon-v">df2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">diff</span><span class="crayon-sy">(</span><span class="crayon-e">diff</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bb1e990f457446996-4"><span class="crayon-v">critical</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">solve</span><span class="crayon-sy">(</span><span class="crayon-e">Eq</span><span class="crayon-sy">(</span><span class="crayon-v">df1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59bb1e990f457446996-5"><span class="crayon-e">critical</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bb1e990f457446996-6"><span class="crayon-v">df2</span><span class="crayon-sy">.</span><span class="crayon-e">subs</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">critical</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59bb1e990f457446996-7"><span class="crayon-e">N</span><span class="crayon-sy">(</span><span class="crayon-v">critical</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>


<p>In the first line we define <img src="//s0.wp.com/latex.php?latex=f%28x%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)" title="f(x)" class="latex"/>. The cool thing here is that this is done symbolically, as we would do it on a piece of paper.  Then in the 2nd line we differentiate this function. Again, this is done as it would be done on paper. If you now type <img src="//s0.wp.com/latex.php?latex=df&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="df" title="df" class="latex"/>, you’ll get the derivative:</p>
<p><img src="//s0.wp.com/latex.php?latex=f%27%28x%29+%3D+-%5Cfrac%7B15%7D%7Bx%5E2+%5Cleft%28+1%2B%5Cfrac%7B255%7D%7Bx%5E2%7D%5Cright%29%7D%2B%5Cfrac%7B3%7D%7Bx%5E2+%5Cleft%28+1%2B%5Cfrac%7B9%7D%7Bx%5E2%7D%5Cright%29%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f'(x) = -\frac{15}{x^2 \left( 1+\frac{255}{x^2}\right)}+\frac{3}{x^2 \left( 1+\frac{9}{x^2}\right)}" title="f'(x) = -\frac{15}{x^2 \left( 1+\frac{255}{x^2}\right)}+\frac{3}{x^2 \left( 1+\frac{9}{x^2}\right)}" class="latex"/></p>
<p>Even if I had looked up <img src="//s0.wp.com/latex.php?latex=%5Cfrac%7Bd%7D%7Bdx%7D+arctan+x&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="\frac{d}{dx} arctan x" title="\frac{d}{dx} arctan x" class="latex"/>, it would have taken a bit of time for me to get here to be honest.. But we aren’t nearly there.. In the third line we get the second derivative, in the 4th we find the critical points of <img src="//s0.wp.com/latex.php?latex=f%28x%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)" title="f(x)" class="latex"/>. Again everything is symbolic, nothing would make sense in pure Python, but it works beautifully in SymPy.</p>
<p>In the 5th line we print the critical points. We get <img src="//s0.wp.com/latex.php?latex=-3%5Csqrt%7B5%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="-3\sqrt{5}" title="-3\sqrt{5}" class="latex"/> and <img src="//s0.wp.com/latex.php?latex=3%5Csqrt%7B5%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="3\sqrt{5}" title="3\sqrt{5}" class="latex"/>. Remember, we are looking for <img src="//s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x" title="x" class="latex"/>, which is a distance, so we should be suspicious(to say the least) about the negative value, but we still need to check that <img src="//s0.wp.com/latex.php?latex=f%28x%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)" title="f(x)" class="latex"/> actually has a local maximum at <img src="//s0.wp.com/latex.php?latex=3%5Csqrt%7B5%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="3\sqrt{5}" title="3\sqrt{5}" class="latex"/>.</p>
<p>That’s exactly what the 6th line does. We substitute in the second critical point into the second derivative, and indeed we get a negative value, confirming that <img src="//s0.wp.com/latex.php?latex=f%28x%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)" title="f(x)" class="latex"/> has a local maximum at <img src="//s0.wp.com/latex.php?latex=3%5Csqrt%7B5%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="3\sqrt{5}" title="3\sqrt{5}" class="latex"/>.</p>
<p>In the 7th line we use the <img src="//s0.wp.com/latex.php?latex=N%28%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="N()" title="N()" class="latex"/> function to print out the numerical value of this expression, which is <img src="//s0.wp.com/latex.php?latex=%5Capprox&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="\approx" title="\approx" class="latex"/> 6.7 meters. So we should stand about 6.7 meters away from the painting to get the maximum possible viewing angle.</p>
<p>There you go, in less than 10 lines we did some optimization symbolically in Python. Actually we could have done this in about three lines, sacrificing a bit of clarity, but that’s never a good trade-off..</p>
<p>As I said, this is barely scratching the surface of what SymPy can do for you, but if you were after an alternative of Wolfram Alpha for symbolic mathematics, I think you’ll find it extremely helpful.</p>
<p>
</p>  

</div>

  </div></body></html>