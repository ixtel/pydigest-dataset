<html><body><div><div class="section">
              <h1>alipay 0.7.3</h1>

              


<p>An Unofficial Alipay API for Python</p><p>








An Unofficial Alipay API for Python</p><p>=======================================</p><p>.. image:: https://img.shields.io/travis/lxneng/alipay.svg</p><p>    :target: https://travis-ci.org/lxneng/alipay</p><p>.. image:: https://img.shields.io/pypi/v/alipay.svg</p><p>    :target: https://pypi.python.org/pypi/alipay/</p><p>.. image:: https://img.shields.io/pypi/dm/alipay.svg</p><p>    :target: https://pypi.python.org/pypi/alipay/</p><p>Overview</p><p>---------------------------------------</p><p>An Unofficial Alipay API for Python, It Contain these API:</p><p>- Generate direct payment url</p><p>- Generate partner trade payment url</p><p>- Generate standard mixed payment url</p><p>- Generate batch trans pay url</p><p>- Generate send goods confirm url</p><p>- Generate forex trade url</p><p>- Generate QR code url</p><p>- Verify notify</p><p>- Single Trade Query</p><p>official document: https://b.alipay.com/order/techService.htm</p><p>Install</p><p>---------------------------------------</p><p>.. code-block:: bash</p><p>    pip install alipay</p><p>Usage</p><p>---------------------------------------</p><p>Initialization</p><p>~~~~~~~~~~~~~~~~~~~~~~~</p><p>.. code-block:: python</p><p>    &gt;&gt;&gt; from alipay import Alipay</p><p>    &gt;&gt;&gt; alipay = Alipay(pid='your_alipay_pid', key='your_alipay_key', seller_email='your_seller_mail')</p><p>Or you can use `seller_id` instead of `seller_email`:</p><p>.. code-block:: python</p><p>    &gt;&gt;&gt; alipay = Alipay(pid='your_alipay_pid', key='your_alipay_key', seller_id='your_seller_id')</p><p>Generate direct payment url</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>..</p><p>    生成即时到账支付链接</p><p>Introduction: https://b.alipay.com/order/productDetail.htm?productId=2012111200373124</p><p>.. code-block:: python</p><p>	&gt;&gt;&gt; alipay.create_direct_pay_by_user_url(out_trade_no='your_order_id', subject='your_order_subject', total_fee='100.0', return_url='your_order</p><p>	_return_url', notify_url='your_order_notify_url')</p><p>	'https://mapi.alipay.com/gateway.do?seller_email=.....'</p><p>..</p><p>    生成即时到账支付链接 (Wap)</p><p>.. code-block:: python</p><p>    &gt;&gt;&gt; alipay_wap = Alipay(pid='your_alipay_pid', key='your_alipay_key', seller_id='your_seller_id')</p><p>    &gt;&gt;&gt; alipay_wap.create_direct_pay_by_user_url(out_trade_no='your_order_id', subject='your_order_subject', total_fee='100.0', return_url='your_order</p><p>    _return_url', notify_url='your_order_notify_url')</p><p>    'https://mapi.alipay.com/gateway.do?seller_email=.....'</p><p>Generate partner trade payment url</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>..</p><p>    生成担保交易支付链接</p><p>Introduction: https://b.alipay.com/order/productDetail.htm?productId=2012111200373121</p><p>.. code-block:: python</p><p>	&gt;&gt;&gt; params = {</p><p>	... 'out_trade_no': 'your_order_id',</p><p>	... 'subject': 'your_order_subject',</p><p>	... 'logistics_type': 'DIRECT',</p><p>	... 'logistics_fee': '0',</p><p>	... 'logistics_payment': 'SELLER_PAY',</p><p>	... 'price': '10.00',</p><p>	... 'quantity': '12',</p><p>	... 'return_url': 'your_order_return_url',</p><p>	... 'notify_url': 'your_order_notify_url'</p><p>	... }</p><p>	&gt;&gt;&gt; alipay.create_partner_trade_by_buyer_url(**params)</p><p>	'https://mapi.alipay.com/gateway.do?seller_email=.....'</p><p>Generate standard mixed payment url</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>..</p><p>    生成标准双接口支付链接</p><p>Introduction: https://b.alipay.com/order/productDetail.htm?productId=2012111300373136</p><p>.. code-block:: python</p><p>    &gt;&gt;&gt; alipay.trade_create_by_buyer_url(**params)</p><p>    'https://mapi.alipay.com/gateway.do?seller_email=.....'</p><p>Generate batch trans pay url</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>..</p><p>    生成批量付款链接</p><p>Introduction: https://b.alipay.com/order/productDetail.htm?productId=2012111200373121</p><p>.. code-block:: python</p><p>	&gt;&gt;&gt; params = {</p><p>	... 'batch_list': (), #批量付款用户列表</p><p>	... 'account_name': 'seller_account_name', #卖家支付宝名称</p><p>	... 'batch_no': 'batch_id', #转账流水号，须唯一</p><p>	... 'notify_url': 'your_batch_notify_url' #异步通知地址</p><p>	... }</p><p>	&gt;&gt;&gt; alipay.create_batch_trans_notify_url(**params)</p><p>	'https://mapi.alipay.com/gateway.do?seller_email=xxx&amp;detail_data=....'</p><p>Note: batch_list 为批量付款用户列表，具体格式如下例子：(如涉及中文请使用unicode字符)</p><p>.. code-block:: python</p><p>	&gt;&gt;&gt; batch_list = ({'account': 'test@xxx.com', #支付宝账号</p><p>	...                'name': u'测试', #支付宝用户姓名</p><p>	...                'fee': '100', #转账金额</p><p>	...                'note': 'test'},</p><p>	...               {'account': 'test@xxx.com', #支付宝账号</p><p>	...                'name': u'测试', #支付宝用户姓名</p><p>	...                'fee': '100', #转账金额</p><p>	...                'note': 'test'}) #转账原因</p><p>Generate send goods confirm url</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>..</p><p>    生成确认发货链接</p><p>Introduction: https://cshall.alipay.com/support/help_detail.htm?help_id=491097</p><p>.. code-block:: python</p><p>    &gt;&gt;&gt; params = {</p><p>    ... 'trade_no': 'your_alipay_trade_id',</p><p>    ... 'logistics_name': 'your_logicstic_name',</p><p>    ... 'transport_type': 'EXPRESS',</p><p>    ... 'invocie_no': 'your_invocie_no'</p><p>    ... }</p><p>    &gt;&gt;&gt; alipay.send_goods_confirm_by_platform(**params)</p><p>    'https://mapi.alipay.com/gateway.do?sign=.....&amp;trade_no=...'</p><p>Generate forex trade url</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>..</p><p>    - Create website payment for foreigners (With QR code)</p><p>    - Create mobile payment for foreigners</p><p>Introduction: http://global.alipay.com/ospay/home.htm</p><p>.. code-block:: python</p><p>    &gt;&gt;&gt; params = {</p><p>    ... 'out_trade_no': 'your_order_id',</p><p>    ... 'subject': 'your_order_subject',</p><p>    ... 'logistics_type': 'DIRECT',</p><p>    ... 'logistics_fee': '0',</p><p>    ... 'logistics_payment': 'SELLER_PAY',</p><p>    ... 'price': '10.00',</p><p>    ... 'quantity': '12',</p><p>    ... 'return_url': 'your_order_return_url',</p><p>    ... 'notify_url': 'your_order_notify_url'</p><p>    ... }</p><p>    &gt;&gt;&gt; # Create website payment for foreigners</p><p>    &gt;&gt;&gt; alipay.create_forex_trade_url(**params)</p><p>    'https://mapi.alipay.com/gateway.do?service=create_forex_trade......'</p><p>    &gt;&gt;&gt; # Create mobile payment for foreigners</p><p>    &gt;&gt;&gt; alipay.create_forex_trade_wap_url(**params)</p><p>    'https://mapi.alipay.com/gateway.do?service=create_forex_trade_wap......'</p><p>Generate QR code url</p><p>~~~~~~~~~~~~~~~~~~~</p><p>..</p><p>    生成创建 QR 码链接</p><p>Introduction: https://b.alipay.com/order/productDetail.htm?productId=2012120700377303</p><p>.. code-block:: python</p><p>    &gt;&gt;&gt; alipay.add_alipay_qrcode_url(**params)</p><p>    'https://mapi.alipay.com/gateway.do?seller_id=.......'</p><p>Note: 如果你的 `biz_data` 中有 Unicode 字符，在 dumps 的时候需要把 `ensure_ascii` 设置为 `False`，即 :code:`json.dumps(d, ensure_ascii=False)` 否则会遇到错误</p><p>Verify notify</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>verify notify from alipay server, example in Pyramid Application</p><p>.. code-block:: python</p><p>    def alipy_notify(request):</p><p>        alipay = request.registry['alipay']</p><p>        if alipay.verify_notify(**request.params):</p><p>            # this is a valid notify, code business logic here</p><p>        else:</p><p>            # this is a invalid notify</p><p>Single Trade Query</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>..</p><p>    单笔交易查询</p><p>文档：http://wenku.baidu.com/link?url=WLjyz-H6AlfDLIU7kR4LcVNQgxSTMxX61fW0tDCE8yZbqXflCd0CVFsZaIKbRFDvVLaFlq0Q3wcJ935A7Kw-mRSs0iA4wQu8cLaCe5B8FIq</p><p>.. code-block:: python</p><p>	import re</p><p>	xml = alipay.single_trade_query(out_trade_no="10000005")</p><p>	res = re.findall('&lt;trade_status&gt;(\S+)&lt;/trade_status&gt;', xml) # use RE to find trade_status, xml parsing is more useful, in fact.</p><p>	status = None if not res else res[0]</p><p>	print status # will print out TRADE_SUCCESS when trade is success</p><p>Example in Pyramid Application</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>Include alipay either by setting your includes in your .ini, or by calling config.include('alipay').</p><p>.. code-block:: python</p><p>	pyramid.includes = alipay</p><p>now in your View</p><p>.. code-block:: python</p><p>    def some_view(request):</p><p>        alipay = request.registry['alipay']</p><p>        url = alipay.create_direct_pay_by_user_url(...)</p><p>Reference</p><p>---------------------------------------</p><p>- `Ruby Alipay GEM &lt;https: github.com="" chloerei="" alipay=""&gt;`_</p><p>- `Official document &lt;https: b.alipay.com="" order="" techservice.htm=""&gt;`_</p><p>Changelog</p><p>==============================</p><p>0.7.3 - Dec.14, 2015</p><p>--------------------------------</p><p>- replace open() calls with io.open() for Python 3 compatibility,</p><p>  fix `UnicodeDecodeError`</p><p>- add `create_direct_pay_by_user_url` doc for Wap site</p><p>0.7.2 - Nov.1, 2015</p><p>--------------------------------</p><p>- add `single_trade_query` method</p><p>  https://github.com/lxneng/alipay/pull/20</p><p>0.7.1 - Sep.16, 2015</p><p>--------------------------------</p><p>- Fix verify_notify raise KeyError: 'sign' bug</p><p>  https://github.com/lxneng/alipay/pull/18</p><p>0.7 - Sep.07, 2015</p><p>--------------------------------</p><p>- add `create_forex_trade_url` method</p><p>- add `create_forex_trade_wap_url` method</p><p>- add `create_batch_trans_notify_url` method</p><p>0.6 - Jul.27, 2015</p><p>--------------------------------</p><p>- add `send_goods_confirm_by_platform` method</p><p>0.5 - Apr.16, 2015</p><p>--------------------------------</p><p>- add `add_alipay_qrcode` method</p><p>0.4.2 - Feb.14, 2015</p><p>--------------------------------</p><p>- Fix argument type error of verify_notify in README</p><p>- FIX SEVERE FAULT IN `check_notify_remotely`</p><p>0.4.1 - Feb.09, 2015</p><p>--------------------------------</p><p>- Resolved README.rst is not formatted on pypi.python.org</p><p>0.4 - Feb.09, 2015</p><p>--------------------------------</p><p>- Seller id support</p><p>0.3 - Aug.03, 2014</p><p>--------------------------------</p><p>- Add wap payment support</p><p>0.2.3 - Nov.20, 2013</p><p>--------------------------------</p><p>- english version readme doc</p><p>0.2.2 - Nov.12, 2013</p><p>--------------------------------</p><p>- add includeme func for pyramid</p><p>- update readme</p><p>0.2.1 - Nov.11, 2013</p><p>--------------------------------</p><p>- fix rst doc</p><p>0.2 - Nov.11, 2013</p><p>--------------------------------</p><p>- add unittest</p><p>- update readme</p><p>- add verify_notify func</p><p>- add check_parameters func</p><p>- add travis.yml</p><p>- add tox.ini</p><p>0.1 - Nov.11, 2013</p><p>------------------------------</p><p>- first commit

</p><a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>321</span> downloads in the last week
  </li>
  <li>
    <span>1702</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>