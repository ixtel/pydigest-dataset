<html><body><div><div id="quick-intro">
<h3>Quick Intro</h3>
<p>Imagine this folder tree:</p>
<pre>data
└── raw
    ├── 0040000
    │   └── session_1
    │       ├── anat_1
    │       └── rest_1
    ├── 0040001
    │   └── session_1
    │       ├── anat_1
    │       └── rest_1
    ├── 0040002
    │   └── session_1
    │       ├── anat_1
    │       └── rest_1
    ├── 0040003
    │   └── session_1
    │       ├── anat_1
    │       └── rest_1
    ├── 0040004
    │   └── session_1
    │       ├── anat_1
    │       └── rest_1
</pre>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">hansel</span> <span class="kn">import</span> <span class="n">Crumb</span>

<span class="c1"># create the crumb</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">crumb</span> <span class="o">=</span> <span class="n">Crumb</span><span class="p">(</span><span class="s2">"{base_dir}/data/raw/{subject_id}/{session_id}/{image_type}/{image}"</span><span class="p">)</span>

<span class="c1"># set the base_dir path</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">crumb</span> <span class="o">=</span> <span class="n">crumb</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="s1">'/home/hansel'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">crumb</span><span class="p">))</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hansel</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">raw</span><span class="o">/</span><span class="p">{</span><span class="n">subject_id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session_id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">image_type</span><span class="p">}</span>

<span class="c1"># get the ids of the subjects</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">subj_ids</span> <span class="o">=</span> <span class="n">crumb</span><span class="p">[</span><span class="s1">'subject_id'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">subj_ids</span><span class="p">)</span>
<span class="p">[</span><span class="s1">'0040000'</span><span class="p">,</span> <span class="s1">'0040001'</span><span class="p">,</span> <span class="s1">'0040002'</span><span class="p">,</span> <span class="s1">'0040003'</span><span class="p">,</span> <span class="s1">'0040004'</span><span class="p">,</span> <span class="s1">'0040005'</span><span class="p">,</span> <span class="o">...</span>

<span class="c1"># get the paths to the subject folders, the output can be strings or crumbs,</span>
<span class="c1"># you choose with the ``make_crumbs`` boolean argument. Default: True.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">subj_paths</span> <span class="o">=</span> <span class="n">crumb</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">'subject_id'</span><span class="p">,</span> <span class="n">make_crumbs</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">subj_paths</span><span class="p">)</span>
<span class="p">[</span><span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040000/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040001/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040002/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040003/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040004/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="o">...</span>

<span class="c1"># set the image_type</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">anat_crumb</span> <span class="o">=</span> <span class="n">crumb</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">image_type</span><span class="o">=</span><span class="s1">'anat_1'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">anat_crumb</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hansel</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">raw</span><span class="o">/</span><span class="p">{</span><span class="n">subject_id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session_id</span><span class="p">}</span><span class="o">/</span><span class="n">anat_1</span><span class="o">/</span><span class="p">{</span><span class="n">image</span><span class="p">}</span>

<span class="c1"># get the paths to the images inside the anat_1 folders</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">anat_paths</span> <span class="o">=</span> <span class="n">anat_crumb</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">'image'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">anat_paths</span><span class="p">)</span>
<span class="p">[</span><span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040000/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040001/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040002/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040003/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040004/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="o">...</span>

<span class="c1"># get the ``session_id`` of each of these ``anat_paths``</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sessions</span> <span class="o">=</span> <span class="p">[</span><span class="n">cr</span><span class="p">[</span><span class="s1">'session_id'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">cr</span> <span class="ow">in</span> <span class="n">anat_paths</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">sessions</span><span class="p">)</span>
<span class="p">[</span><span class="s1">'session_1'</span><span class="p">,</span> <span class="s1">'session_1'</span><span class="p">,</span> <span class="s1">'session_1'</span><span class="p">,</span> <span class="s1">'session_1'</span><span class="p">,</span> <span class="s1">'session_1'</span><span class="p">,</span> <span class="o">...</span>

<span class="c1"># if you don't want the the output to be ``Crumbs`` but string paths:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">anat_paths</span> <span class="o">=</span> <span class="n">anat_crumb</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">'image'</span><span class="p">,</span> <span class="n">make_crumbs</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">anat_paths</span><span class="p">)</span>
<span class="p">[</span><span class="s2">"/home/hansel/data/raw/0040000/session_1/anat_1/mprage.nii.gz"</span><span class="p">,</span>
 <span class="s2">"/home/hansel/data/raw/0040001/session_1/anat_1/mprage.nii.gz"</span><span class="p">,</span>
 <span class="s2">"/home/hansel/data/raw/0040002/session_1/anat_1/mprage.nii.gz"</span><span class="p">,</span>
 <span class="s2">"/home/hansel/data/raw/0040003/session_1/anat_1/mprage.nii.gz"</span><span class="p">,</span>
 <span class="s2">"/home/hansel/data/raw/0040004/session_1/anat_1/mprage.nii.gz"</span><span class="p">,</span>
 <span class="o">...</span>

<span class="c1"># you can also use a list of ``fnmatch`` expressions to ignore certain files patterns</span>
<span class="c1"># using the ``ignore_list`` argument in the constructor.</span>
<span class="c1"># For example, the files that start with '.'.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">crumb</span> <span class="o">=</span> <span class="n">Crumb</span><span class="p">(</span><span class="s2">"{base_dir}/data/raw/{subject_id}/{session_id}/{image_type}/{image}"</span><span class="p">,</span>
<span class="o">&gt;&gt;&gt;</span>               <span class="n">ignore_list</span><span class="o">=</span><span class="p">[</span><span class="s1">'.*'</span><span class="p">])</span>
</pre>
<p>See more quick examples after the <a href="#long-intro" rel="nofollow">Long Intro</a> check <a href="#more-features-and-tricks" rel="nofollow">More features and tricks</a>.</p>
</div>
<div id="long-intro">
<h3>Long Intro</h3>
<p>I often find myself in a work related with structured folder paths, such as the
one shown above.</p>
<p>I have tried many ways of solving these situations: loops, dictionaries,
configuration files, etc. I always end up doing a different thing for the same
problem over and over again.</p>
<p>This week I grew tired of it and decided to make a representation of a
structured folder tree in a string and access it the most easy way.</p>
<p>If you look at the folder structure above I have:</p>
<ul>
<li>the root directory from where it is hanging: <tt><span class="pre">...data/raw</span></tt>,</li>
<li>many identifiers (in this case a subject identification), e.g.,
<tt>0040000</tt>,</li>
<li>session identification, <tt>session_1</tt> and</li>
<li>a data type (in this case an image type), <tt>anat_1</tt> and <tt>rest_1</tt>.</li>
</ul>
<p>With <tt>hansel</tt> I can represent this folder structure like this:</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">hansel</span> <span class="kn">import</span> <span class="n">Crumb</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">crumb</span> <span class="o">=</span> <span class="n">Crumb</span><span class="p">(</span><span class="s2">"{base_dir}/data/raw/{subject_id}/{session_id}/{image_type}/{image}"</span><span class="p">)</span>
</pre>
<p>Let’s say we have the structure above hanging from a base directory like <tt>/home/hansel/</tt>.</p>
<p>I can use the <tt>replace</tt> function to make set the <tt>base_dir</tt> parameter:</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="n">crumb</span> <span class="o">=</span> <span class="n">crumb</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="s1">'/home/hansel'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">crumb</span><span class="p">))</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hansel</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">raw</span><span class="o">/</span><span class="p">{</span><span class="n">subject_id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session_id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">image_type</span><span class="p">}</span>
</pre>
<p>if I don’t need a copy of <tt>crumb</tt>, I can use the <tt>[]</tt> operator:</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="n">crumb</span><span class="p">[</span><span class="s1">'base_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/home/hansel'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">crumb</span><span class="p">))</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hansel</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">raw</span><span class="o">/</span><span class="p">{</span><span class="n">subject_id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session_id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">image_type</span><span class="p">}</span>
</pre>
<p>Now that the root path of my dataset is set, I can start querying my
crumb path.</p>
<p>If I want to know the path to the existing <tt>subject_id</tt> folders:</p>
<p>We can use the <tt>ls</tt> function. Its output can be <tt>str</tt> or <tt>Crumb</tt>.
I can choose this using the <tt>make_crumbs</tt> argument (default: True):</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="n">subj_crumbs</span> <span class="o">=</span> <span class="n">crumb</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">'subject_id'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">subj_crumbs</span><span class="p">)</span>
<span class="p">[</span><span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040000/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040001/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040002/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040003/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040004/{session_id}/{image_type}/{image}"</span><span class="p">),</span>
 <span class="o">...</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">subj_paths</span> <span class="o">=</span> <span class="n">anat_crumb</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">'subject_id'</span><span class="p">,</span> <span class="n">make_crumbs</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">subj_paths</span><span class="p">)</span>
<span class="p">[</span><span class="s2">"/home/hansel/data/raw/0040000/{session_id}/{image_type}/{image}"</span><span class="p">,</span>
 <span class="s2">"/home/hansel/data/raw/0040001/{session_id}/{image_type}/{image}"</span><span class="p">,</span>
 <span class="s2">"/home/hansel/data/raw/0040002/{session_id}/{image_type}/{image}"</span><span class="p">,</span>
 <span class="s2">"/home/hansel/data/raw/0040003/{session_id}/{image_type}/{image}"</span><span class="p">,</span>
 <span class="s2">"/home/hansel/data/raw/0040004/{session_id}/{image_type}/{image}"</span><span class="p">,</span>
 <span class="o">...</span>
</pre>
<p>If I want to know what are the existing <tt>subject_id</tt>:</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="n">subj_ids</span> <span class="o">=</span> <span class="n">crumb</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">'subject_id'</span><span class="p">,</span> <span class="n">fullpath</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">subj_ids</span><span class="p">)</span>
<span class="p">[</span><span class="s1">'0040000'</span><span class="p">,</span> <span class="s1">'0040001'</span><span class="p">,</span> <span class="s1">'0040002'</span><span class="p">,</span> <span class="s1">'0040003'</span><span class="p">,</span> <span class="s1">'0040004'</span><span class="p">,</span> <span class="s1">'0040005'</span><span class="p">,</span> <span class="o">...</span>
</pre>
<p>or</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="n">subj_ids</span> <span class="o">=</span> <span class="n">crumb</span><span class="p">[</span><span class="s1">'subject_id'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">subj_ids</span><span class="p">)</span>
<span class="p">[</span><span class="s1">'0040000'</span><span class="p">,</span> <span class="s1">'0040001'</span><span class="p">,</span> <span class="s1">'0040002'</span><span class="p">,</span> <span class="s1">'0040003'</span><span class="p">,</span> <span class="s1">'0040004'</span><span class="p">,</span> <span class="s1">'0040005'</span><span class="p">,</span> <span class="o">...</span>
</pre>
<p>Now, if I wanted to get the path to all the images inside the <tt>anat_1</tt> folders,
I could do this:</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="n">anat_crumb</span> <span class="o">=</span> <span class="n">crumb</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">image_type</span><span class="o">=</span><span class="s1">'anat_1'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">anat_crumb</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hansel</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">raw</span><span class="o">/</span><span class="p">{</span><span class="n">subject_id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session_id</span><span class="p">}</span><span class="o">/</span><span class="n">anat_1</span><span class="o">/</span><span class="p">{</span><span class="n">image</span><span class="p">}</span>
</pre>
<p>or if I don’t need to keep a copy of <tt>crumb</tt>:</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="n">crumb</span><span class="p">[</span><span class="s1">'image_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'anat_1'</span>

<span class="c1"># get the paths to the images inside the anat_1 folders</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">anat_paths</span> <span class="o">=</span> <span class="n">crumb</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">'image'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">anat_paths</span><span class="p">)</span>
<span class="p">[</span><span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040000/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040001/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040002/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040003/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="n">Crumb</span><span class="p">(</span><span class="s2">"/home/hansel/data/raw/0040004/session_1/anat_1/mprage.nii.gz"</span><span class="p">),</span>
 <span class="o">...</span>
</pre>
<p>Remember that I can still access the replaced crumb arguments in each of the previous
crumbs in <tt>anat_paths</tt>.</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="n">subj_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">cr</span><span class="p">[</span><span class="s1">'subject_id'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">cr</span> <span class="ow">in</span> <span class="n">anat_paths</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">subj_ids</span><span class="p">)</span>
<span class="p">[</span><span class="s1">'0040000'</span><span class="p">,</span> <span class="s1">'0040001'</span><span class="p">,</span> <span class="s1">'0040002'</span><span class="p">,</span> <span class="s1">'0040003'</span><span class="p">,</span> <span class="s1">'0040004'</span><span class="p">,</span> <span class="s1">'0040005'</span><span class="p">,</span> <span class="o">...</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">cr</span><span class="p">[</span><span class="s1">'image'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">cr</span> <span class="ow">in</span> <span class="n">anat_paths</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<span class="p">[</span><span class="s1">'mprage.nii.gz'</span><span class="p">,</span> <span class="s1">'mprage.nii.gz'</span><span class="p">,</span> <span class="s1">'mprage.nii.gz'</span><span class="p">,</span> <span class="s1">'mprage.nii.gz'</span><span class="p">,</span> <span class="o">...</span>
</pre>
</div>
</div></body></html>