<html><body><div><div class="entry-content content">


  <p>I’m starting a new series of blog posts, called “<strong>XY in less than 10 lines of Python</strong>“. This first one is about Newton’s method, which is an old numerical approximation technique that could be used to find the roots of complex polynomials and any differentiable function.</p>
<p>Let’s say we have a complicated polynomial:</p>
<p><img src="//s0.wp.com/latex.php?latex=f%28x%29%3D6x%5E5-5x%5E4-4x%5E3%2B3x%5E2+&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)=6x^5-5x^4-4x^3+3x^2 " title="f(x)=6x^5-5x^4-4x^3+3x^2 " class="latex"/></p>
<p>and we want to find its roots. Unfortunately we know from the <a href="https://www.wikiwand.com/en/Galois_theory">Galois theory</a> that there is no formula for a 5th degree polynomial so we’ll have to use numeric methods. Wait a second. What’s going on? We all learned the quadratic formula in school, and there are formulas for cubic and quartic polynomials, but Galois proved that no such “root-finding” formula exist for fifth or higher degree polynomials, that uses only the usual algebraic operations (addition, subtraction, multiplication, division) and application of radicals (square roots, cube roots, etc).</p>
<p>Some <a href="https://www.reddit.com/user/pqnelson">nice</a> <a href="https://www.reddit.com/user/KalROFL">guys</a> pointed out on reddit that I didn’t quite get the theory right. Sorry about that, I’m no mathematician by any means. It turns out that this polynomial could be factored into <img src="//s0.wp.com/latex.php?latex=x%5E2%28x-1%29%286x%5E2+%2B+x+-+3%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x^2(x-1)(6x^2 + x - 3)" title="x^2(x-1)(6x^2 + x - 3)" class="latex"/> and solved with traditional cubic formula. Also the theorem I referred to is the <a href="https://en.wikipedia.org/wiki/Abel%E2%80%93Ruffini_theorem">Abel-Ruffini Theorem</a> and it only applies to the solution to the general polynomial of degree five or greater. Nonetheless the example is still valid, and demonstrates how would you apply Newton’s method, to any polynomial, so let’s crack on.</p>
<p>So in these cases we have to resort to numeric linear approximation. A simple way would be to use the <a href="https://www.wikiwand.com/en/Intermediate_value_theorem">intermediate value theorem</a>, which states that if <img src="//s0.wp.com/latex.php?latex=f%28x%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)" title="f(x)" class="latex"/> is continuous on <img src="//s0.wp.com/latex.php?latex=%5Ba%2Cb%5D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="[a,b]" title="[a,b]" class="latex"/> and <img src="//s0.wp.com/latex.php?latex=f%28a%29+%3C+y%3C+f%28b%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(a) &lt; y&lt; f(b)" title="f(a) &lt; y&lt; f(b)" class="latex"/>, then there is an <img src="//s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x" title="x" class="latex"/> between <img src="//s0.wp.com/latex.php?latex=a&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="a" title="a" class="latex"/> and <img src="//s0.wp.com/latex.php?latex=b&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="b" title="b" class="latex"/> so that <img src="//s0.wp.com/latex.php?latex=f%28x%29%3Dy&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)=y" title="f(x)=y" class="latex"/>.</p>
<p>We could exploit this by looking for an <img src="//s0.wp.com/latex.php?latex=x_1&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_1" title="x_1" class="latex"/> where <img src="//s0.wp.com/latex.php?latex=f%28x_1%29%3E0&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x_1)&gt;0" title="f(x_1)&gt;0" class="latex"/> and an <img src="//s0.wp.com/latex.php?latex=x_2&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_2" title="x_2" class="latex"/> where <img src="//s0.wp.com/latex.php?latex=f%28x_2%29%3C0&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x_2)&lt;0" title="f(x_2)&lt;0" class="latex"/>, and then we could be certain that <img src="//s0.wp.com/latex.php?latex=f%28x%29%3D0&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)=0" title="f(x)=0" class="latex"/> must be between <img src="//s0.wp.com/latex.php?latex=x_1&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_1" title="x_1" class="latex"/> and <img src="//s0.wp.com/latex.php?latex=x_2&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_2" title="x_2" class="latex"/>. So we could  check <img src="//s0.wp.com/latex.php?latex=x_3%3D%5Cfrac%7Bx_2-x_1%7D%7B2%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_3=\frac{x_2-x_1}{2}" title="x_3=\frac{x_2-x_1}{2}" class="latex"/>, and find that <img src="//s0.wp.com/latex.php?latex=f%28x_3%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x_3)" title="f(x_3)" class="latex"/> will be positive, then continue with<img src="//s0.wp.com/latex.php?latex=x_4%3D%5Cfrac%7Bx_2-x_3%7D%7B2%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_4=\frac{x_2-x_3}{2}" title="x_4=\frac{x_2-x_3}{2}" class="latex"/> which would be negative and our proposed <img src="//s0.wp.com/latex.php?latex=x_n&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_n" title="x_n" class="latex"/> would become closer and closer to <img src="//s0.wp.com/latex.php?latex=f%28x_n%29%3D0&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x_n)=0" title="f(x_n)=0" class="latex"/>. This method however can be pretty slow, so Newton devised a better way to speed things up (when it works).</p>
<p>If you look at the figure below, you’ll see the plot of our polynomial. It has three roots at 0, 1, and somewhere in-between. So how do we find these?</p>
<p>In Newton’s method we take a random point <img src="//s0.wp.com/latex.php?latex=f%28x_0%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x_0)" title="f(x_0)" class="latex"/>, then draw a tangent line through <img src="//s0.wp.com/latex.php?latex=x_0%2C+f%28x_0%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_0, f(x_0)" title="x_0, f(x_0)" class="latex"/>, using the derivative <img src="//s0.wp.com/latex.php?latex=f%27%28x_0%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f'(x_0)" title="f'(x_0)" class="latex"/>. The point <img src="//s0.wp.com/latex.php?latex=x_1&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_1" title="x_1" class="latex"/> where this tangent line crosses the <img src="//s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x" title="x" class="latex"/> axis will become the next proposal we check. We calculate the tangent line at <img src="//s0.wp.com/latex.php?latex=f%27%28x_1%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f'(x_1)" title="f'(x_1)" class="latex"/> and find <img src="//s0.wp.com/latex.php?latex=x_2&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_2" title="x_2" class="latex"/>. We carry on, and as we do <img src="//s0.wp.com/latex.php?latex=%7Cf%28x_n%29%7C+%5Cto+0&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="|f(x_n)| \to 0" title="|f(x_n)| \to 0" class="latex"/>, or in other words we can make our approximation as close to zero as we want, provided we are willing to continue with the number crunching. Using the fact that the slope of tangent (by the definition of derivatives) at <img src="//s0.wp.com/latex.php?latex=x_n&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_n" title="x_n" class="latex"/> is <img src="//s0.wp.com/latex.php?latex=f%27%28x_n%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f'(x_n)" title="f'(x_n)" class="latex"/> we can derive the formula for <img src="//s0.wp.com/latex.php?latex=x_%7Bn%2B1%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_{n+1}" title="x_{n+1}" class="latex"/>, i.e. where the tangent crosses the <img src="//s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x" title="x" class="latex"/> axis:</p>
<p><img src="//s0.wp.com/latex.php?latex=x_%7Bn%2B1%7D%3Dx_n-%5Cfrac%7Bf%28x_n%29%7D%7Bf%27%28x_n%29%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_{n+1}=x_n-\frac{f(x_n)}{f'(x_n)}" title="x_{n+1}=x_n-\frac{f(x_n)}{f'(x_n)}" class="latex"/></p>
<p><img class="x-img x-img-rounded" src="http://danielhomola.com/wp-content/uploads/2016/02/polynomial.png" alt="Newton's method"/>
</p><p>With all this in mind it’s easy to write an algorithm that approximates $f(x)=0$ with arbitrary error <img src="//s0.wp.com/latex.php?latex=%5Cvarepsilon&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="\varepsilon" title="\varepsilon" class="latex"/>. Obviously in this example depending on where we start <img src="//s0.wp.com/latex.php?latex=x_0&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="x_0" title="x_0" class="latex"/> we might find different roots.</p>


		<div id="crayon-56d5994f3d56f578029650" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5994f3d56f578029650-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">dx</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d56f578029650-2"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-k ">abs</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">-</span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5994f3d56f578029650-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d56f578029650-4"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">newtons_method</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5994f3d56f578029650-5"><span class="crayon-h">    </span><span class="crayon-v">delta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dx</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x0</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d56f578029650-6"><span class="crayon-h">    </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">delta</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5994f3d56f578029650-7"><span class="crayon-h">        </span><span class="crayon-v">x0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">x0</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-e">df</span><span class="crayon-sy">(</span><span class="crayon-v">x0</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d56f578029650-8"><span class="crayon-h">        </span><span class="crayon-v">delta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dx</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x0</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5994f3d56f578029650-9"><span class="crayon-h">    </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">'Root is at: '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">x0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d56f578029650-10"><span class="crayon-e">    </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">'f(x) at root is: '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">x0</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>


<p>There you go, we’are done in 10 lines (9 without the blank line), even less without the print statements. So in order to use this, we need two functions, <img src="//s0.wp.com/latex.php?latex=f%28x%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f(x)" title="f(x)" class="latex"/> and <img src="//s0.wp.com/latex.php?latex=f%27%28x%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f'(x)" title="f'(x)" class="latex"/>. For this polynomial these are:</p>


		<div id="crayon-56d5994f3d583274795315" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5994f3d583274795315-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d583274795315-2"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">5</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">4</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">3</span><span class="crayon-o">+</span><span class="crayon-cn">3</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></p><p class="crayon-line" id="crayon-56d5994f3d583274795315-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d583274795315-4"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">df</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5994f3d583274795315-5"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">4</span><span class="crayon-o">-</span><span class="crayon-cn">20</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">3</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-o">+</span><span class="crayon-cn">6</span><span class="crayon-o">*</span><span class="crayon-v">x</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>


<p>Now we can simply find the three roots with:</p>


		<div id="crayon-56d5994f3d58b427439047" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5994f3d58b427439047-1"><span class="crayon-v">x0s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d58b427439047-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">x0 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">x0s</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5994f3d58b427439047-3"><span class="crayon-h">    </span><span class="crayon-e">newtons_method</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d58b427439047-4"> </p><p class="crayon-line" id="crayon-56d5994f3d58b427439047-5"><span class="crayon-c"># Root is at:  0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d58b427439047-6"><span class="crayon-c"># f(x) at root is:  0</span></p><p class="crayon-line" id="crayon-56d5994f3d58b427439047-7"><span class="crayon-c"># Root is at:  0.628668078167</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d58b427439047-8"><span class="crayon-c"># f(x) at root is:  -1.37853879978e-06</span></p><p class="crayon-line" id="crayon-56d5994f3d58b427439047-9"><span class="crayon-c"># Root is at:  1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994f3d58b427439047-10"><span class="crayon-c"># f(x) at root is:  0</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>


<p>All of the above code, and some additional comparison test with the scipy.optimize.newton method can be found in this <a href="https://gist.github.com/danielhomola/de1726bfc7330b2c9b2a">Gist</a>. And don’t forget, if you find it too much trouble differentiating your functions, just use <a href="http://live.sympy.org/">SymPy</a>, I wrote about it <a href="http://danielhomola.com/2016/02/06/solving-real-world-problems-with-sympy/">here</a>.</p>
<p>Newton’s method is pretty powerful but there could be problems with the speed of convergence, and awfully wrong initial guesses might make it not even converge ever, see <a href="https://www.wikiwand.com/en/Newton's_method#/Practical_considerations">here</a>. Nonetheless I hope you found this relatively useful.. Let me know in the comments.</p>
  

</div>

  </div></body></html>