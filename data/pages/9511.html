<html><body><div><section class="entry">
<p class="fsb-clear"/><p><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_animated.gif"><img class="aligncenter size-full wp-image-3569" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_animated.gif" alt="multiple_cameras_animated"/></a></p>
<p>I’ll keep the introduction to today’s post short, since I think the title of this post and GIF animation above speak for themselves.</p>
<p>Inside this post, I’ll demonstrate how to attach <em>multiple cameras</em> to your Raspberry Pi…<strong><em>and access all of them using a single Python script.</em></strong></p>
<p>Regardless if your setup includes:</p>
<ul>
<li>Multiple USB webcams.</li>
<li>Or the Raspberry Pi camera module + additional USB cameras…</li>
</ul>
<p>…the code detailed in this post will allow you to access <em>all</em> of your video streams — <em><strong>and perform motion detection on each of them!</strong></em></p>
<p>Best of all, our implementation of multiple camera access with the Raspberry Pi and OpenCV is capable of running in <strong>real-time</strong> (or near real-time, depending on the number of cameras you have attached), making it perfect for creating your own multi-camera home surveillance system.</p>
<p>Keep reading to learn more.</p>

<h2>Multiple cameras with the Raspberry Pi and OpenCV</h2>
<p>When building a Raspberry Pi setup to leverage multiple cameras, you have two options:</p>
<ul>
<li>Simply use <em>multiple</em> USB web cams.</li>
<li>Or use <em>one</em> Raspberry Pi camera module and <em>at least one</em> USB web camera.</li>
</ul>
<p>The Raspberry Pi board has only <em>one camera port</em>, so you will not be able to use <em>multiple</em> Raspberry Pi camera boards (unless you want to perform some extensive hacks to your Pi). So in order to attach multiple cameras to your Pi, you’ll need to leverage <em>at least one</em> (if not more) USB cameras.</p>
<p>That said, in order to build my own multi-camera Raspberry Pi setup, I ended up using:</p>
<ol>
<li><a href="http://www.amazon.com/gp/product/B00E1GGE40/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00E1GGE40&amp;linkCode=as2&amp;tag=trndingcom-20&amp;linkId=XF5KMO3TGBUENU5T" target="_blank">A Raspberry Pi camera module</a> + <a href="http://www.amazon.com/gp/product/B00IJZJKK4/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00IJZJKK4&amp;linkCode=as2&amp;tag=trndingcom-20&amp;linkId=PMQZXV7K7MWCPAZ3" target="_blank">camera housing</a> (optional). We can interface with the camera using the 
			<span id="crayon-56d581bcbf9ea662596319" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">picamera</span></span></span>  Python package or (preferably) the threaded 
			<span id="crayon-56d581bcbf9f6345740121" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">VideoStream</span></span></span>  class defined in a <a href="http://www.pyimagesearch.com/2016/01/04/unifying-picamera-and-cv2-videocapture-into-a-single-class-with-opencv/" target="_blank">previous blog post</a>.</li>
<li>A <a href="http://www.amazon.com/gp/product/B006JH8T3S/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B006JH8T3S&amp;linkCode=as2&amp;tag=trndingcom-20&amp;linkId=BWJJLCCXZCBM465P" target="_blank">Logitech C920</a> webcam that is plug-and-play compatible with the Raspberry Pi. We can access this camera using either the 
			<span id="crayon-56d581bcbf9fb613165757" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">VideoCapture</span></span></span>  function built-in to OpenCV or the 
			<span id="crayon-56d581bcbf9ff078930157" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">VideoStream</span></span></span>  class <a href="http://www.pyimagesearch.com/2016/01/04/unifying-picamera-and-cv2-videocapture-into-a-single-class-with-opencv/" target="_blank">from this lesson</a>.</li>
</ol>
<p>You can see an example of my setup below:</p>
<div id="attachment_3570" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_03.jpg"><img class="wp-image-3570" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_03.jpg" alt="Figure 1: My multiple camera Raspberry Pi setup." srcset="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_03-300x225.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_03-1024x768.jpg 1024w, http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_03.jpg 1250w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 1:</strong> My multiple camera Raspberry Pi setup.</p></div>
<p>Here we can see my Raspberry Pi 2, along with the Raspberry Pi camera module (sitting on top of the Pi 2) and my Logitech C920 webcam.</p>
<p>The Raspberry Pi camera module is pointing towards my apartment door to monitor anyone that is entering and leaving, while the USB webcam is pointed towards the kitchen, observing any activity that may be going on:</p>
<div id="attachment_3571" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_04.jpg"><img class="wp-image-3571" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_04.jpg" alt="Figure 2: The Raspberry Pi camera module and USB camera are both hooked up to my Raspberry Pi, but are monitoring different areas of the room." srcset="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_04-300x225.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_04-1024x768.jpg 1024w, http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_setup_04.jpg 1250w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 2:</strong> The Raspberry Pi camera module and USB camera are both hooked up to my Raspberry Pi, but are monitoring different areas of the room.</p></div>
<p>Ignore the electrical tape and cardboard on the USB camera — this was from a previous experiment which should (hopefully) be published on the PyImageSearch blog soon.</p>
<p>Finally, you can see an example of both video feeds displayed to my Raspberry Pi in the image below:</p>
<div id="attachment_3572" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_start.jpg"><img class="wp-image-3572" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_start.jpg" alt="Figure 3: An example screenshot of monitoring both video feeds from the multiple camera Raspberry Pi setup." srcset="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_start-300x225.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_start-1024x768.jpg 1024w, http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_rpi_start.jpg 1250w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 3:</strong> An example screenshot of monitoring both video feeds from the <em>multiple camera</em> Raspberry Pi setup.</p></div>
<p>In the remainder of this blog post, we’ll define a simple motion detection class that can detect if a person/object is moving in the field of view of a given camera. We’ll then write a Python driver script that instantiates our two video streams and performs motion detection in both of them.</p>
<p>As we’ll see, by using the threaded video stream capture classes (where one thread per camera is dedicated to perform I/O operations, allowing the main program thread to continue unblocked), we can easily get our motion detectors for <em>multiple cameras</em> to run in <strong>real-time</strong> on the Raspberry Pi 2.</p>
<p>Let’s go ahead and get started by defining the simple motion detector class.</p>
<h3>Defining our simple motion detector</h3>
<p>In this section, we’ll build a simple Python class that can be used to detect motion in a field of view of a given camera.</p>
<p>For efficiency, this class will assume there is only <em>one</em> object moving in the camera view at a time — in future blog posts, we’ll look at more advanced motion detection and background subtraction methods to track multiple objects.</p>
<p>In fact, we have already (partially) reviewed this motion detection method in our previous lesson, <a href="http://www.pyimagesearch.com/2015/06/01/home-surveillance-and-motion-detection-with-the-raspberry-pi-python-and-opencv/" target="_blank">home surveillance and motion detection with the Raspberry Pi, Python, OpenCV, and Dropbox</a> — we are now formalizing this implementation into a reusable class rather than just inline code.</p>
<p>Let’s get started by opening a new file, naming it 
			<span id="crayon-56d581bcbfa06718197158" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">basicmotiondetector</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> , and adding in the following code:</p>

		<div id="crayon-56d581bcbfa09071072288" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa09071072288-2">2</p><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa09071072288-4">4</p><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa09071072288-6">6</p><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa09071072288-8">8</p><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa09071072288-10">10</p><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa09071072288-12">12</p><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa09071072288-14">14</p><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa09071072288-16">16</p><p class="crayon-num" data-line="crayon-56d581bcbfa09071072288-17">17</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581bcbfa09071072288-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa09071072288-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></p><p class="crayon-line" id="crayon-56d581bcbfa09071072288-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa09071072288-4"> </p><p class="crayon-line" id="crayon-56d581bcbfa09071072288-5"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-v">BasicMotionDetector</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa09071072288-6"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">accumWeight</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">deltaThresh</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minArea</span><span class="crayon-o">=</span><span class="crayon-cn">5000</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d581bcbfa09071072288-7"><span class="crayon-h">		</span><span class="crayon-c"># determine the OpenCV version, followed by storing the</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa09071072288-8"><span class="crayon-h">		</span><span class="crayon-c"># the frame accumulation weight, the fixed threshold for</span></p><p class="crayon-line" id="crayon-56d581bcbfa09071072288-9"><span class="crayon-h">		</span><span class="crayon-c"># the delta image, and finally the minimum area required</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa09071072288-10"><span class="crayon-h">		</span><span class="crayon-c"># for "motion" to be reported</span></p><p class="crayon-line" id="crayon-56d581bcbfa09071072288-11"><span class="crayon-h">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">isv2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">is_cv2</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa09071072288-12"><span class="crayon-h">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">accumWeight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accumWeight</span></p><p class="crayon-line" id="crayon-56d581bcbfa09071072288-13"><span class="crayon-e">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">deltaThresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">deltaThresh</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa09071072288-14"><span class="crayon-e">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">minArea</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">minArea</span></p><p class="crayon-line" id="crayon-56d581bcbfa09071072288-15"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa09071072288-16"><span class="crayon-h">		</span><span class="crayon-c"># initialize the average image for motion detection</span></p><p class="crayon-line" id="crayon-56d581bcbfa09071072288-17"><span class="crayon-h">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Line 6</strong> defines the constructor to our 
			<span id="crayon-56d581bcbfa0d715257397" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">BasicMotionDetector</span></span></span>  class. The constructor accepts three optional keyword arguments, which include:</p>
<ul>
<li>
			<span id="crayon-56d581bcbfa11001343727" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">accumWeight</span></span></span> : The floating point value used for the taking the weighted average between the <i>current frame</i> and the <em>previous set of frames</em>. A larger 
			<span id="crayon-56d581bcbfa15953656147" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">accumWeight</span></span></span>  will result in the background model having less “memory” and quickly “forgetting” what previous frames looked like. Using a high value of 
			<span id="crayon-56d581bcbfa19484821132" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">accumWeight</span></span></span>  is useful if you except lots of motion in a short amount of time. Conversely, smaller values of 
			<span id="crayon-56d581bcbfa1c486207286" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">accumWeight</span></span></span>  give more weight to the background model than the current frame, allowing you to detect larger changes in the foreground. We’ll use a default value of 
			<span id="crayon-56d581bcbfa20276985063" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-cn">0.5</span></span></span> in this example, just keep in mind that this is a tunable parameter that you should consider working with.</li>
<li>
			<span id="crayon-56d581bcbfa24064411834" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">deltaThresh</span></span></span> : After computing the difference between the current frame and the background model, we’ll need to apply thresholding to find regions in a frame that contain motion — this 
			<span id="crayon-56d581bcbfa27070756116" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">deltaThresh</span></span></span>  value is used for the thresholding. Smaller values of 
			<span id="crayon-56d581bcbfa2b228937703" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">deltaThresh</span></span></span>  will detect <i>more</i> motion, while larger values will detect <i>less</i> motion.</li>
<li>
			<span id="crayon-56d581bcbfa2e682162370" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">minArea</span></span></span> : After applying thresholding, we’ll be left with a binary image that we extract contours from. In order to handle noise and ignore small regions of motion, we can use the 
			<span id="crayon-56d581bcbfa32120059409" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">minArea</span></span></span>  parameter. Any region with 
			<span id="crayon-56d581bcbfa36205195813" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">minArea</span></span></span>  is labeled as “motion”; otherwise, it is ignored.</li>
</ul>
<p>Finally, <strong>Line 17</strong> initializes 
			<span id="crayon-56d581bcbfa39981827670" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">avg</span></span></span> , which is simply the running, weighted average of the previous frames the 
			<span id="crayon-56d581bcbfa3d257464061" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">BasicMotionDetector</span></span></span>  has seen.</p>
<p>Let’s move on to our 
			<span id="crayon-56d581bcbfa41655310481" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">update</span></span></span>  method:</p>

		<div id="crayon-56d581bcbfa44392110644" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d581bcbfa44392110644-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa44392110644-20">20</p><p class="crayon-num" data-line="crayon-56d581bcbfa44392110644-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa44392110644-22">22</p><p class="crayon-num" data-line="crayon-56d581bcbfa44392110644-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa44392110644-24">24</p><p class="crayon-num" data-line="crayon-56d581bcbfa44392110644-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa44392110644-26">26</p><p class="crayon-num" data-line="crayon-56d581bcbfa44392110644-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa44392110644-28">28</p><p class="crayon-num" data-line="crayon-56d581bcbfa44392110644-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa44392110644-30">30</p><p class="crayon-num" data-line="crayon-56d581bcbfa44392110644-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa44392110644-32">32</p><p class="crayon-num" data-line="crayon-56d581bcbfa44392110644-33">33</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581bcbfa44392110644-19"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa44392110644-20"><span class="crayon-h">		</span><span class="crayon-c"># initialize the list of locations containing motion</span></p><p class="crayon-line" id="crayon-56d581bcbfa44392110644-21"><span class="crayon-h">		</span><span class="crayon-v">locs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa44392110644-22"> </p><p class="crayon-line" id="crayon-56d581bcbfa44392110644-23"><span class="crayon-h">		</span><span class="crayon-c"># if the average image is None, initialize it</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa44392110644-24"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">avg </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d581bcbfa44392110644-25"><span class="crayon-h">			</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"float"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa44392110644-26"><span class="crayon-h">			</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">locs</span></p><p class="crayon-line" id="crayon-56d581bcbfa44392110644-27"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa44392110644-28"><span class="crayon-h">		</span><span class="crayon-c"># otherwise, accumulate the weighted average between</span></p><p class="crayon-line" id="crayon-56d581bcbfa44392110644-29"><span class="crayon-h">		</span><span class="crayon-c"># the current frame and the previous frames, then compute</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa44392110644-30"><span class="crayon-h">		</span><span class="crayon-c"># the pixel-wise differences between the current frame</span></p><p class="crayon-line" id="crayon-56d581bcbfa44392110644-31"><span class="crayon-h">		</span><span class="crayon-c"># and running average</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa44392110644-32"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">accumulateWeighted</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">avg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">accumWeight</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfa44392110644-33"><span class="crayon-h">		</span><span class="crayon-v">frameDelta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">absdiff</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">convertScaleAbs</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">avg</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The 
			<span id="crayon-56d581bcbfa49469601013" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">update</span></span></span>  function requires a single parameter — the image we want to detect motion in.</p>
<p><strong>Line 21</strong> initializes 
			<span id="crayon-56d581bcbfa4c574313967" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">locs</span></span></span> , the list of contours that correspond to motion locations in the image. However, if the 
			<span id="crayon-56d581bcbfa50717297279" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">avg</span></span></span>  has not been initialized (<strong>Lines 24-26</strong>), we set 
			<span id="crayon-56d581bcbfa54271873841" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">avg</span></span></span>  to the current frame and return from the method.</p>
<p>Otherwise, the 
			<span id="crayon-56d581bcbfa57707004331" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">avg</span></span></span>  has already been initialized so we accumulate the running, weighted average between the previous frames and the current frames, using the 
			<span id="crayon-56d581bcbfa5b165830423" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">accumWeight</span></span></span>  value supplied to the constructor (<strong>Line 32</strong>). Taking the absolute value difference between the current frame and the running average yields regions of the image that contain motion — we call this our <i>delta image</i>.</p>
<p>However, in order to actually <em>detect</em> regions in our delta image that contain motion, we first need to apply thresholding and contour detection:</p>

		<div id="crayon-56d581bcbfa5f513984258" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-36">36</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-38">38</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-40">40</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-42">42</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-44">44</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-46">46</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-48">48</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-50">50</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-52">52</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa5f513984258-54">54</p><p class="crayon-num" data-line="crayon-56d581bcbfa5f513984258-55">55</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-35"><span class="crayon-h">		</span><span class="crayon-c"># threshold the delta image and apply a series of dilations</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-36"><span class="crayon-h">		</span><span class="crayon-c"># to help fill in holes</span></p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-37"><span class="crayon-h">		</span><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">threshold</span><span class="crayon-sy">(</span><span class="crayon-v">frameDelta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">deltaThresh</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-38"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">THRESH_BINARY</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-39"><span class="crayon-h">		</span><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">dilate</span><span class="crayon-sy">(</span><span class="crayon-v">thresh</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">iterations</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-40"> </p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-41"><span class="crayon-h">		</span><span class="crayon-c"># find contours in the thresholded image, taking care to</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-42"><span class="crayon-h">		</span><span class="crayon-c"># use the appropriate version of OpenCV</span></p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-43"><span class="crayon-h">		</span><span class="crayon-v">cnts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">findContours</span><span class="crayon-sy">(</span><span class="crayon-v">thresh</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">RETR_EXTERNAL</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-44"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">CHAIN_APPROX_SIMPLE</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-45"><span class="crayon-h">		</span><span class="crayon-v">cnts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cnts</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">isv2 </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">cnts</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-46"> </p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-47"><span class="crayon-h">		</span><span class="crayon-c"># loop over the contours</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-48"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">cnts</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-49"><span class="crayon-h">			</span><span class="crayon-c"># only add the contour to the locations list if it</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-50"><span class="crayon-h">			</span><span class="crayon-c"># exceeds the minimum area</span></p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-51"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">contourArea</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">minArea</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-52"><span class="crayon-h">				</span><span class="crayon-v">locs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-53"><span class="crayon-h">		</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa5f513984258-54"><span class="crayon-h">		</span><span class="crayon-c"># return the set of locations</span></p><p class="crayon-line" id="crayon-56d581bcbfa5f513984258-55"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">locs</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Calling 
			<span id="crayon-56d581bcbfa64055750967" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">threshold</span></span></span>  using the supplied value of 
			<span id="crayon-56d581bcbfa67289356348" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">deltaThresh</span></span></span>  allows us to binarize the delta image, which we then find contours in (<strong>Lines 37-45</strong>).</p>
<p><em><strong>Note:</strong></em><strong> </strong><em>Take special care when examining <strong>Lines 43-45</strong>. As we know, the 
			<span id="crayon-56d581bcbfa6b705595440" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">findContours</span></span></span>  method return signature <a href="http://www.pyimagesearch.com/2015/08/10/checking-your-opencv-version-using-python/" target="_blank">changed between OpenCV 2.4 and 3</a>. This codeblock allows us to use 
			<span id="crayon-56d581bcbfa6f372216302" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">findContours</span></span></span>  in </em><strong>both</strong><em> OpenCV 2.4 and 3 without having to change a line of code (or worry about versioning issues).</em></p>
<p>Finally, <strong>Lines 48-52</strong> loop over the detected contours, check to see if their area is greater than the supplied 
			<span id="crayon-56d581bcbfa72671950971" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">minArea</span></span></span> , and if so, updates the 
			<span id="crayon-56d581bcbfa76088821956" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">locs</span></span></span>  list.</p>
<p>The list of contours containing motion are then returned to calling method on <strong>Line 55</strong>.</p>
<p><em><strong>Note: </strong>Again, for a more detailed review of the motion detection algorithm, please see the <strong><a href="http://www.pyimagesearch.com/2015/06/01/home-surveillance-and-motion-detection-with-the-raspberry-pi-python-and-opencv/" target="_blank">home surveillance tutorial</a></strong>.</em></p>
<h3><b>Accessing multiple cameras on the Raspberry Pi</b></h3>
<p>Now that our 
			<span id="crayon-56d581bcbfa7a613639698" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">BasicMotionDetector</span></span></span>  class has been defined, we are now ready to create the 
			<span id="crayon-56d581bcbfa7e267635439" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">multi_cam_motion</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  driver script to access the <em><strong>multiple</strong></em> cameras with the Raspberry Pi — and apply motion detection to each of the video streams.</p>
<p>Let’s go ahead and get started defining our driver script:</p>

		<div id="crayon-56d581bcbfa81329862007" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-2">2</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-4">4</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-6">6</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-8">8</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-10">10</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-12">12</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-14">14</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-16">16</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-18">18</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfa81329862007-20">20</p><p class="crayon-num" data-line="crayon-56d581bcbfa81329862007-21">21</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581bcbfa81329862007-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">__future__</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">print_function</span></p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span><span class="crayon-sy">.</span><span class="crayon-e">basicmotiondetector </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">BasicMotionDetector</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">video </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">VideoStream</span></p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span></p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-8"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">time</span></p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-9"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-10"> </p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-11"><span class="crayon-c"># initialize the video streams and allow them to warmup</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-12"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] starting cameras..."</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-13"><span class="crayon-v">webcam</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">VideoStream</span><span class="crayon-sy">(</span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-14"><span class="crayon-v">picam</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">VideoStream</span><span class="crayon-sy">(</span><span class="crayon-v">usePiCamera</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-15"><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2.0</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-16"> </p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-17"><span class="crayon-c"># initialize the two motion detectors, along with the total</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-18"><span class="crayon-c"># number of frames read</span></p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-19"><span class="crayon-v">camMotion</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BasicMotionDetector</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfa81329862007-20"><span class="crayon-v">piMotion</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BasicMotionDetector</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfa81329862007-21"><span class="crayon-v">total</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We start off on <strong>Lines 2-9</strong> by importing our required Python packages. Notice how we have placed the 
			<span id="crayon-56d581bcbfa85106995528" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">BasicMotionDetector</span></span></span>  class inside the 
			<span id="crayon-56d581bcbfa89389782115" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">pyimagesearch</span></span></span>  module for organizational purposes. We also import 
			<span id="crayon-56d581bcbfa8d367356279" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">VideoStream</span></span></span> , our threaded video stream class that is capable of accessing <em>both</em> the Raspberry Pi camera module and built-in/USB web cameras.</p>
<p>The 
			<span id="crayon-56d581bcbfa90395953472" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">VideoStream</span></span></span>  class is part of the <a href="https://github.com/jrosebr1/imutils" target="_blank">imutils package</a>, so if you do not already have it installed, just execute the following command:</p>

		

<p><strong>Line 13 </strong>initializes our <em><strong>USB webcam</strong></em> 
			<span id="crayon-56d581bcbfa98086415657" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">VideoStream</span></span></span>  class while <strong>Line 14</strong> initializes our <em><strong>Raspberry Pi camera module</strong></em> 
			<span id="crayon-56d581bcbfa9b817676678" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">VideoStream</span></span></span>  class (by specifying 
			<span id="crayon-56d581bcbfa9f154438376" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">usePiCamera</span><span class="crayon-o">=</span><span class="crayon-t">True</span></span></span> ).</p>
<p>In the case that you <em>do not</em> want to use the Raspberry Pi camera module and instead want to leverage two USB cameras, simply changes <strong>Lines 13 and 14 </strong>to:</p>

		<div id="crayon-56d581bcbfaa2267984880" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581bcbfaa2267984880-1"><span class="crayon-v">webcam1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">VideoStream</span><span class="crayon-sy">(</span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfaa2267984880-2"><span class="crayon-v">webcam2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">VideoStream</span><span class="crayon-sy">(</span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Where the 
			<span id="crayon-56d581bcbfaa6820923882" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">src</span></span></span>  parameter controls the index of the camera on your machine. Also note that you’ll have to replace 
			<span id="crayon-56d581bcbfaaa254242128" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">webcam</span></span></span>  and 
			<span id="crayon-56d581bcbfaad801135115" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">picam</span></span></span>  with 
			<span id="crayon-56d581bcbfab1297115368" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">webcam1</span></span></span>  and 
			<span id="crayon-56d581bcbfab4236896676" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">webcam2</span></span></span> , respectively throughout the rest of this script as well.</p>
<p>Finally, <strong>Lines 19 and 20</strong> instantiate two 
			<span id="crayon-56d581bcbfab8892014354" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">BasicMotionDetector</span></span></span> ‘s, one for the USB camera and a second for the Raspberry Pi camera module.</p>
<p>We are now ready to perform motion detection in both video feeds:</p>

		<div id="crayon-56d581bcbfabc444783985" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-24">24</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-26">26</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-28">28</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-30">30</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-32">32</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-34">34</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-36">36</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-38">38</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-40">40</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-42">42</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfabc444783985-44">44</p><p class="crayon-num" data-line="crayon-56d581bcbfabc444783985-45">45</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581bcbfabc444783985-23"><span class="crayon-c"># loop over frames from the video streams</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-24"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-25"><span class="crayon-h">	</span><span class="crayon-c"># initialize the list of frames that have been processed</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-26"><span class="crayon-h">	</span><span class="crayon-v">frames</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-27"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-28"><span class="crayon-h">	</span><span class="crayon-c"># loop over the frames and their respective motion detectors</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-29"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">stream</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">motion</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">webcam</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">picam</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">camMotion</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">piMotion</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-30"><span class="crayon-h">		</span><span class="crayon-c"># read the next frame from the video stream and resize</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-31"><span class="crayon-h">		</span><span class="crayon-c"># it to have a maximum width of 400 pixels</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-32"><span class="crayon-h">		</span><span class="crayon-v">frame</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stream</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-33"><span class="crayon-h">		</span><span class="crayon-v">frame</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">400</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-34"> </p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-35"><span class="crayon-h">		</span><span class="crayon-c"># convert the frame to grayscale, blur it slightly, update</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-36"><span class="crayon-h">		</span><span class="crayon-c"># the motion detector</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-37"><span class="crayon-h">		</span><span class="crayon-v">gray</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_BGR2GRAY</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-38"><span class="crayon-h">		</span><span class="crayon-v">gray</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">GaussianBlur</span><span class="crayon-sy">(</span><span class="crayon-v">gray</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-39"><span class="crayon-h">		</span><span class="crayon-v">locs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">motion</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-v">gray</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-40"> </p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-41"><span class="crayon-h">		</span><span class="crayon-c"># we should allow the motion detector to "run" for a bit</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-42"><span class="crayon-h">		</span><span class="crayon-c"># and accumulate a set of frames to form a nice average</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-43"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">total</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfabc444783985-44"><span class="crayon-h">			</span><span class="crayon-v">frames</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfabc444783985-45"><span class="crayon-h">			</span><span class="crayon-st">continue</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>On <strong>Line 24</strong> we start an infinite loop that is used to constantly poll frames from our (two) camera sensors. We initialize a list of such 
			<span id="crayon-56d581bcbfac0031764879" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frames</span></span></span>  on <strong>Line 26</strong>.</p>
<p>Then, <strong>Line 29</strong> defines a 
			<span id="crayon-56d581bcbfac4658454275" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-st">for</span></span></span>  loop that loops over each of the video stream and motion detectors, respectively. We use the 
			<span id="crayon-56d581bcbfac8992423190" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">stream</span></span></span>  to read a 
			<span id="crayon-56d581bcbfacb885773611" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frame</span></span></span>  from our camera sensor and then resize the frame to have a fixed width of 400 pixels.</p>
<p>Further pre-processing is performed on <strong>Lines 37 and 38</strong> by converting the frame to grayscale and applying a Gaussian smoothing operation to reduce high frequency noise. Finally, the processed frame is passed to our 
			<span id="crayon-56d581bcbfacf721682526" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">motion</span></span></span>  detector where the actual motion detection is performed (<strong>Line 39</strong>).</p>
<p>However, it’s important to let our motion detector “run” for a bit so that it can obtain an accurate running average of what our background “looks like”. We’ll allow 32 frames to be used in the average background computation <em>before</em> applying any motion detection (<strong>Lines 43-45</strong>).</p>
<p>After we have allowed 32 frames to be passed into our 
			<span id="crayon-56d581bcbfad3196769193" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">BasicMotionDetector</span></span></span>’s, we can check to see if any motion was detected:</p>

		<div id="crayon-56d581bcbfad7927901400" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-48">48</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-50">50</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-52">52</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-54">54</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-55">55</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-56">56</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-57">57</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-58">58</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-59">59</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-60">60</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-61">61</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-62">62</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-63">63</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-64">64</p><p class="crayon-num" data-line="crayon-56d581bcbfad7927901400-65">65</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfad7927901400-66">66</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581bcbfad7927901400-47"><span class="crayon-h">		</span><span class="crayon-c"># otherwise, check to see if motion was detected</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-48"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">locs</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-49"><span class="crayon-h">			</span><span class="crayon-c"># initialize the minimum and maximum (x, y)-coordinates,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-50"><span class="crayon-h">			</span><span class="crayon-c"># respectively</span></p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-51"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">minX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">inf</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">inf</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-52"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">maxX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">inf</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">inf</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-53"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-54"><span class="crayon-h">			</span><span class="crayon-c"># loop over the locations of motion and accumulate the</span></p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-55"><span class="crayon-h">			</span><span class="crayon-c"># minimum and maximum locations of the bounding boxes</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-56"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">l</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">locs</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-57"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">boundingRect</span><span class="crayon-sy">(</span><span class="crayon-v">l</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-58"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-v">minX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxX</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">min</span><span class="crayon-sy">(</span><span class="crayon-v">minX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">maxX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-59"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-v">minY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">min</span><span class="crayon-sy">(</span><span class="crayon-v">minY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">maxY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-60"> </p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-61"><span class="crayon-h">			</span><span class="crayon-c"># draw the bounding box</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-62"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">rectangle</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">minX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">maxX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-63"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-64"><span class="crayon-h">		</span></p><p class="crayon-line" id="crayon-56d581bcbfad7927901400-65"><span class="crayon-h">		</span><span class="crayon-c"># update the frames list</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfad7927901400-66"><span class="crayon-h">		</span><span class="crayon-v">frames</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Line 48</strong> checks to see if motion was detected in the 
			<span id="crayon-56d581bcbfadc676830031" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frame</span></span></span>  of the current video 
			<span id="crayon-56d581bcbfadf871735353" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">stream</span></span></span> .</p>
<p>Provided that motion was detected, we initialize the minimum and maximum <em>(x, y)</em>-coordinates associated with the contours (i.e., 
			<span id="crayon-56d581bcbfaf8530938967" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">locs</span></span></span> ). We then loop over the contours individually and use them to determine the smallest bounding box that encompasses <em>all</em> contours (<strong>Lines 51-59</strong>).</p>
<p>The bounding box is then drawn surrounding the motion region on <strong>Lines 62 and 63</strong>, followed by our list of 
			<span id="crayon-56d581bcbfafc152046972" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frames</span></span></span>  updated on <strong>Line 66</strong>.</p>
<p>Again, the code detailed in this blog post assumes that there is only <em>one</em> object/person moving at a time in the given frame, hence this approach will obtain the desired result. However, if there are <em>multiple</em> moving objects, then we’ll need to use more advanced background subtraction and tracking methods — future blog posts on PyImageSearch will cover how to perform multi-object tracking.</p>
<p>The last step is to display our 
			<span id="crayon-56d581bcbfb00199021012" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frames</span></span></span>  to our screen:</p>

		<div id="crayon-56d581bcbfb04970754715" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-68">68</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-69">69</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-70">70</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-71">71</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-72">72</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-73">73</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-74">74</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-75">75</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-76">76</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-77">77</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-78">78</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-79">79</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-80">80</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-81">81</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-82">82</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-83">83</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-84">84</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-85">85</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-86">86</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-87">87</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-88">88</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-89">89</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-90">90</p><p class="crayon-num" data-line="crayon-56d581bcbfb04970754715-91">91</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581bcbfb04970754715-92">92</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-68"><span class="crayon-h">	</span><span class="crayon-c"># increment the total number of frames read and grab the </span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-69"><span class="crayon-h">	</span><span class="crayon-c"># current timestamp</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-70"><span class="crayon-h">	</span><span class="crayon-v">total</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-71"><span class="crayon-h">	</span><span class="crayon-v">timestamp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-72"><span class="crayon-h">	</span><span class="crayon-v">ts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">timestamp</span><span class="crayon-sy">.</span><span class="crayon-e">strftime</span><span class="crayon-sy">(</span><span class="crayon-s">"%A %d %B %Y %I:%M:%S%p"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-73"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-74"><span class="crayon-h">	</span><span class="crayon-c"># loop over the frames a second time</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-75"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-v">frames</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"Webcam"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"Picamera"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-76"><span class="crayon-h">		</span><span class="crayon-c"># draw the timestamp on the frame and display it</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-77"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">putText</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-78"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">FONT_HERSHEY_SIMPLEX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-79"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-80"> </p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-81"><span class="crayon-h">	</span><span class="crayon-c"># check to see if a key was pressed</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-82"><span class="crayon-h">	</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-83"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-84"><span class="crayon-h">	</span><span class="crayon-c"># if the `q` key was pressed, break from the loop</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-85"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k ">ord</span><span class="crayon-sy">(</span><span class="crayon-s">"q"</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-86"><span class="crayon-h">		</span><span class="crayon-st">break</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-87"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-88"><span class="crayon-c"># do a bit of cleanup</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-89"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] cleaning up..."</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-90"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">destroyAllWindows</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581bcbfb04970754715-91"><span class="crayon-v">webcam</span><span class="crayon-sy">.</span><span class="crayon-e">stop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581bcbfb04970754715-92"><span class="crayon-v">picam</span><span class="crayon-sy">.</span><span class="crayon-e">stop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Liens 70-72</strong> increments the 
			<span id="crayon-56d581bcbfb09914877496" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">total</span></span></span>  number of frames processed, followed by grabbing and formatting the current timestamp.</p>
<p>We then loop over each of the 
			<span id="crayon-56d581bcbfb0e946252322" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frames</span></span></span>  we have processed for motion on <strong>Line 75</strong> and display them to our screen.</p>
<p>Finally, <strong>Lines 82-86</strong> check to see if the 
			<span id="crayon-56d581bcbfb11824914894" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">q</span></span></span>  key is pressed, indicating that we should break from the frame reading loop. <strong>Lines 89-92</strong> then perform a bit of cleanup.</p>
<h3><b>Motion detection on the Raspberry Pi with multiple cameras</b></h3>
<p>To see our multiple camera motion detector run on the Raspberry Pi, just execute the following command:</p>

		<div id="crayon-56d581bcbfb15112451938" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581bcbfb15112451938-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">multi_cam_motion</span><span class="crayon-e">.py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>I have included a series of “highlight frames” in the following GIF that demonstrate our multi-camera motion detector in action:</p>
<div id="attachment_3569" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_animated.gif"><img class="size-full wp-image-3569" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/multiple_cameras_animated.gif" alt="Figure 4: An example of applying motion detection to multiple cameras using the Raspberry Pi, OpenCV, and Python."/></a><p class="wp-caption-text"><strong>Figure 4:</strong> An example of applying motion detection to multiple cameras using the Raspberry Pi, OpenCV, and Python.</p></div>
<p>Notice how I start in the kitchen, open a cabinet, reach for a mug, and head to the sink to fill the mug up with water — <em>this series of actions and motion are detected on the first camera.</em></p>
<p>Finally, I head to the trash can to throw out a paper towel before exiting the frame view <em>of the second camera</em>.</p>
<p>A full video demo of multiple camera access using the Raspberry Pi can be seen below:</p>
<p><iframe src="http://www.youtube.com/embed/ssJnIiQWkDQ?feature=oembed" frameborder="0" allowfullscreen="">VIDEO</iframe></p>
<h2>Summary</h2>
<p>In this blog post, we learned how to access multiple cameras using the Raspberry Pi 2, OpenCV, and Python.</p>
<p><strong>When accessing multiple cameras on the Raspberry Pi, you have two choices when constructing your setup:</strong></p>
<ol>
<li>Either use multiple USB webcams.</li>
<li>Or using a single Raspberry Pi camera module and <em>at least one</em> USB webcam.</li>
</ol>
<p>Since the Raspberry Pi board has only one camera input, you cannot leverage multiple Pi camera boards — atleast without extensive hacks to your Pi.</p>
<p>In order to provide an interesting implementation of multiple camera access with the Raspberry Pi, we created a simple motion detection class that can be used to detect motion in the frame views of <em>each camera</em> connected to the Pi.</p>
<p>While basic, this motion detector demonstrated that multiple camera access is capable of being executed in real-time on the Raspberry Pi — <em>especially</em> with the help of our threaded 
			<span id="crayon-56d581bcbfb1a033365970" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">PiVideoStream</span></span></span>  and 
			<span id="crayon-56d581bcbfb1e942859058" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">VideoStream</span></span></span>  classes implemented in <a href="http://www.pyimagesearch.com/2015/12/28/increasing-raspberry-pi-fps-with-python-and-opencv/" target="_blank">blog posts</a> a <a href="http://www.pyimagesearch.com/2016/01/04/unifying-picamera-and-cv2-videocapture-into-a-single-class-with-opencv/" target="_blank">few weeks ago</a>.</p>
<p>If you are interested in learning more about using the Raspberry Pi for computer vision, along with other tips, tricks, and hacks related to OpenCV, <strong>be sure to signup for the PyImageSearch Newsletter using the form at the bottom of this post.</strong></p>
<p>See you next week!</p>
<h2 id="post_downloads">Downloads:</h2>

	</section>
	</div></body></html>