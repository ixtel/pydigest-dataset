<html><body><div><div id="entry" class="usertext">
<p>Yesterday I released version 2.0 of the streaming JSON parser <a href="https://pypi.python.org/pypi/ijson/">ijson</a>. It mostly includes bug fixes accumulated over the last year and the only reason to change the major part of the version number was that <code>import ijson</code> doesn't do any discovery magic anymore.</p>
<p><a name="more"/></p>
<h2>Import</h2>
<p>Previously, when you did <code>import ijson</code> it used to first go on a trial-and-error search for the latest version of the C library yajl and if none found used the Python backend as a fallback. This approach proved to be <a href="https://github.com/isagalaev/ijson/pull/22">buggy</a> and unpredictable: simply moving your app into another environment might have introduced different behavior, like being significantly slower on a machine without yajl or exposing bugs present in one backend but not the other.</p>
<p>So, following the "<a href="http://legacy.python.org/dev/peps/pep-0020/">explicit is better than implicit</a>" commandment I dropped the discovery, so <code>import ijson</code> now always loads the safe pure Python backend. You can explicitly import any of them with <code>import ijson.backends.&lt;name&gt; as ijson</code>.</p>
<p>You might argue that <code>import ijson</code> is still not explicit enough but I didn't want to force users to always use a full backend name. Because "<a href="http://legacy.python.org/dev/peps/pep-0020/">practicality beats purity</a>".</p>
<h2>Other changes</h2>
<ul>
<li>Fixed breakage when a multi-byte UTF-8 characters was split by a buffer boundary.</li>
<li>Python backend now accepts custom buffer size as an argument.</li>
<li>Always return integer values as 'type int' even if spelled like <code>1.0</code> or <code>1E2</code> in JSON.</li>
<li>Use <a href="http://pythonwheels.com/">Wheels</a> for a distribution format.</li>
</ul>
<p>Also the lexer is now reimplemented as a generator and simplified a little bit, it's now <a href="https://github.com/isagalaev/ijson/blob/8da3f09151b26d4a754601305a617b7891a9aa39/ijson/backends/python.py#L24-L69">only 46 lines of code</a>. Funny thing, though: this change made it slightly faster on CPython but slightly slower on PyPy. Looks like PyPy really likes objects and doesn't mind all the <code>self.something</code> references and myriads of method calls. Go figure :-).

</p></div>
</div></body></html>