<html><body><div><div class="body" role="main">
            
  <div class="section" id="slimta-mail-transfer-library">
<h1>slimta: Mail Transfer Library</h1>
<p class="toctree-wrapper compound">
</p>
<p>The <em>slimta</em> suite was created to provide an MTA (Mail Transfer Agent) taking advantage of new
technologies and methodologies to scale horizontally in a virtualized
environment. Along with that, <em>slimta</em> is designed to work either as a
traditional application or as a software library.</p>
<ol class="arabic simple">
<li><a class="reference internal" href="license.html"><em>MIT License</em></a></li>
<li><a class="reference internal" href="manual/terminology.html"><em>Terminology</em></a></li>
<li><a class="reference external" href="https://travis-ci.org/slimta/">Continuous Integration</a> <img alt="buildstatus" src="https://travis-ci.org/slimta/python-slimta.svg?branch=master"/></li>
<li>IRC Channel: <a class="reference external" href="https://webchat.freenode.net/?channels=%23slimta">#slimta</a> on Freenode.</li>
</ol>
<div class="html-toggle section" id="python-library">
<h2>Python Library</h2>
<p>The <em>python-slimta</em> project is a Python library offering the building blocks
necessary to create a full-featured <a class="reference external" href="https://en.wikipedia.org/wiki/Message_transfer_agent">MTA</a>. Most MTAs must be configured, but an
MTA built with <em>python-slimta</em> is coded. An MTA built with <em>python-slimta</em> can
incorporate any protocol or policy – custom or built-in. An MTA built with
<em>python-slimta</em> can integrate with other Python libraries and take advantage of
Python’s great community.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.0.0: </span>We are now compatible with Python 3.3+!  Compatibility with Python 2.6 has
been removed to ease the transition. Huge thanks to our <a class="reference external" href="https://github.com/slimta/python-slimta/graphs/contributors">contributors</a> for
their efforts! See the <em>Change Log</em> for details.</p>
</div>
<ol class="arabic simple">
<li><a class="reference external" href="https://github.com/slimta/python-slimta/blob/master/README.md">README</a></li>
<li><a class="reference external" href="https://github.com/slimta/python-slimta/tags">Download</a> [<a class="reference external" href="https://github.com/slimta/python-slimta">Repository</a>]</li>
<li><a class="reference external" href="https://github.com/slimta/python-slimta/issues">Bug Reports</a></li>
<li><a class="reference external" href="https://github.com/slimta/python-slimta/blob/master/CHANGELOG.md">Change Log</a></li>
<li><a class="reference external" href="https://github.com/slimta/python-slimta/blob/master/README.md#getting-started">Installation</a></li>
<li><a class="reference internal" href="api.html"><em>API Reference</em></a></li>
<li><a class="reference internal" href="manual/python-slimta.html"><em>Python Library Usage</em></a></li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">slimta.edge.smtp</span> <span class="kn">import</span> <span class="n">SmtpEdge</span>
<span class="kn">from</span> <span class="nn">slimta.queue</span> <span class="kn">import</span> <span class="n">Queue</span>
<span class="kn">from</span> <span class="nn">slimta.queue.dict</span> <span class="kn">import</span> <span class="n">DictStorage</span>
<span class="kn">from</span> <span class="nn">slimta.relay.smtp.mx</span> <span class="kn">import</span> <span class="n">MxSmtpRelay</span>
<span class="kn">from</span> <span class="nn">slimta.policy.headers</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">slimta.policy.split</span> <span class="kn">import</span> <span class="n">RecipientDomainSplit</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c"># Set up outbound delivery by MX lookup.</span>
<span class="n">relay</span> <span class="o">=</span> <span class="n">MxSmtpRelay</span><span class="p">()</span>

<span class="c"># Set up local queue storage to in-memory dictionaries.</span>
<span class="n">queue_storage</span> <span class="o">=</span> <span class="n">DictStorage</span><span class="p">({},</span> <span class="p">{})</span>
<span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">(</span><span class="n">queue_storage</span><span class="p">,</span> <span class="n">relay</span><span class="p">)</span>
<span class="n">queue</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="c"># Ensure necessary headers are added.</span>
<span class="n">queue</span><span class="o">.</span><span class="n">add_policy</span><span class="p">(</span><span class="n">AddDateHeader</span><span class="p">())</span>
<span class="n">queue</span><span class="o">.</span><span class="n">add_policy</span><span class="p">(</span><span class="n">AddMessageIdHeader</span><span class="p">())</span>
<span class="n">queue</span><span class="o">.</span><span class="n">add_policy</span><span class="p">(</span><span class="n">AddReceivedHeader</span><span class="p">())</span>
<span class="n">queue</span><span class="o">.</span><span class="n">add_policy</span><span class="p">(</span><span class="n">RecipientDomainSplit</span><span class="p">())</span>

<span class="c"># Listen for messages on port 25.</span>
<span class="n">edge</span> <span class="o">=</span> <span class="n">SmtpEdge</span><span class="p">((</span><span class="s">'127.0.0.1'</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">queue</span><span class="p">)</span>
<span class="n">edge</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">edge</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">print</span>

</pre></div>
</div>
</div>
<div class="html-toggle section" id="traditional-application">
<h2>Traditional Application</h2>
<p>The <em>slimta</em> project is a traditional application built on top of the
<em>python-slimta</em> library. It allows a more “out-of-the-box” <a class="reference external" href="https://en.wikipedia.org/wiki/Message_transfer_agent">MTA</a> that offers all
the useful, built-in features needed for a normal mail system setup.</p>
<ol class="arabic simple">
<li><a class="reference external" href="https://github.com/slimta/slimta/blob/master/README.md">README</a></li>
<li><a class="reference external" href="https://github.com/slimta/slimta/tags">Download</a> [<a class="reference external" href="https://github.com/slimta/slimta">Repository</a>]</li>
<li><a class="reference external" href="https://github.com/slimta/slimta/issues">Bug Reports</a></li>
<li><a class="reference internal" href="manual/slimta.html"><em>Configuration and Setup Guide</em></a></li>
</ol>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">process</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">slimta</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">daemon</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>

<span class="l-Scalar-Plain">tls</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">main</span><span class="p-Indicator">:</span> <span class="nl">&amp;tls_main</span>
    <span class="l-Scalar-Plain">certfile</span><span class="p-Indicator">:</span> <span class="s">'/path/to/cert.pem'</span>
    <span class="l-Scalar-Plain">keyfile</span><span class="p-Indicator">:</span> <span class="s">'/path/to/key.pem'</span>

<span class="l-Scalar-Plain">edge</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">outbound</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">smtp</span>
    <span class="l-Scalar-Plain">queue</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">outbound</span>
    <span class="l-Scalar-Plain">listener</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">interface</span><span class="p-Indicator">:</span> <span class="s">'127.0.0.1'</span>
      <span class="l-Scalar-Plain">port</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">587</span>
    <span class="l-Scalar-Plain">tls</span><span class="p-Indicator">:</span> <span class="nv">*tls_main</span>
    <span class="l-Scalar-Plain">rules</span><span class="p-Indicator">:</span> <span class="kt">!include</span> <span class="l-Scalar-Plain">rules.yaml</span>

<span class="l-Scalar-Plain">queue</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">outbound</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">memory</span>
    <span class="l-Scalar-Plain">relay</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">outbound</span>
    <span class="l-Scalar-Plain">policies</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">add_date_header</span> <span class="p-Indicator">}</span>
      <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">add_messageid_header</span> <span class="p-Indicator">}</span>
      <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">add_received_header</span> <span class="p-Indicator">}</span>
      <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">recipient_domain_split</span> <span class="p-Indicator">}</span>

<span class="l-Scalar-Plain">relay</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">outbound</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mx</span>
    <span class="l-Scalar-Plain">tls</span><span class="p-Indicator">:</span> <span class="nv">*tls_main</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div></body></html>