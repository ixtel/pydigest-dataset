<html><body><div><div class="field-item even" property="content:encoded"><p>Libnotify is part of the Gnome project and built on top of the Gnome library. Python has bindings to Gnome and we will take advantage of them to create desktop notifications. We can set the text, images, urgency, and create custom buttons in our notifications. Libnotify is a small and simple library and is a good place to start if you have never done any Gnome/Gtk programming. These examples will walk through all the options available.
</p>


<h2>Install Prerequisites</h2>
<p>
A base Debian install with Gnome install will not require any special packages to be installed.
Here are some relevant packages though.
</p>
<pre class="prettyprint"><code># This one is required, but should already be installed<br/>sudo apt-get install python-gobject<br/><br/># Installing this will install the<br/># notify-send program. Check that out<br/># for sending notifications in the shell<br/>sudo apt-get install libnotify-bin<br/><br/># The development headers if you<br/># want to do any development in C/C++<br/>sudo apt-get install libnotify-dev</code></pre>

<h2>Hello World</h2>
<p>Short enough you can type it right in to an interactive python interpreter.</p>
<pre class="prettyprint"><code>from gi.repository import Notify<br/>Notify.init("App Name")<br/>Notify.Notification.new("Hi").show()</code></pre>
<p>That is the shortest you can get a simple notify program.  The notification object is created, and show() is immediately chained, but
the object is never stored or used again. We can actually store the notification
object that was created, and re-use later by calling show() again on the object. We
will do that in the rest of the examples. We will also explore the options available.</p>

<h2>Uninitializing</h2>
<p>It is always good to clean up things when you are done. Libnotify provides
an unitialize function that we should call whenever we are done using notifications.</p>
<pre class="prettyprint"><code>Notify.uninit()</code></pre>

<h2>Hiding Notification</h2>
<p>We can immediately close a notification by simply calling <strong>close()</strong>.</p>
<pre class="prettyprint"><code># Close notification immediately<br/>notification.close()</code></pre>


<h2>Hello Again</h2>
<p>Check out another hello world notification program, but not as simplified
as the first Python example. We import the <strong>gi.repository</strong> library.
Gi stands for <a href="https://wiki.gnome.org/Projects/GObjectIntrospection" target="_blank">GObject Introspection</a>,
and is the  layer between the Gnome libraries in C and bindings to other languages.
</p>

<pre class="prettyprint"><code>from gi.repository import Notify<br/><br/># One time initialization of libnotify<br/>Notify.init("My Program Name")<br/><br/># Create the notification object<br/>summary = "Wake up!"<br/>body = "Meeting at 3PM!"<br/>notification = Notify.Notification.new(<br/>    summary,<br/>    body, # Optional<br/>)<br/><br/># Actually show on screen<br/>notification.show()</code></pre>

<p>Once the object is created and stored in a variable, we can repeatedly call <strong>show()</strong> on the object
to send the same notification.</p>


<h2>Re-using Notification Object</h2>
<p>Instead of creating new notification objects for every message, you can re-use
the same object. You can just call <strong>show()</strong> again, but it would
have the same message. You can change the properties before you show it again.</p>

<pre class="prettyprint"><code>from gi.repository import Notify<br/>Notify.init("My Program Name")<br/><br/># Create the notification object and show once<br/>notification = Notify.Notification.new("Hi")<br/>notification.show()<br/><br/># Let's throw in a sleep before we show again<br/>import time<br/>time.sleep(1)<br/><br/># Change application name<br/>notification.set_app_name("New App Name")<br/><br/># Change summary and body<br/>notification.update("Ding!", "Cupcakes are done.")<br/><br/># Show again<br/>notification.show()</code></pre>




<h2>Icons and Images</h2>
<p>We can set the icon and image for the notification by creating
a <strong>GdkPixbuf</strong> type image. We can easily load an image
file using the <strong>new_from_file()</strong> function on the GdkPixbuf object.
This will require importing GdkPixbuf module from the GObject Introspection repository (gi.repository).</p>

<pre class="prettyprint"><code># This time import the GdkPixbuf module<br/>from gi.repository import Notify, GdkPixbuf<br/><br/>Notify.init("Test App")<br/>notification = Notify.Notification.new("Alert!")<br/><br/># Use GdkPixbuf to create the proper image type<br/>image = GdkPixbuf.Pixbuf.new_from_file("/home/NanoDano/test.png")<br/><br/># Use the GdkPixbuf image<br/>notification.set_icon_from_pixbuf(image)<br/>notification.set_image_from_pixbuf(image)<br/><br/>notification.show()</code></pre>

<p>You can also specify an image file name to the <strong>new()</strong> function.</p>
<pre class="prettyprint"><code>from gi.repository import Notify<br/>Notify.init("Test App")<br/><br/># A raw file name/path<br/>Notify.Notification.new(<br/>    "Ding!",<br/>    "Time is up.",<br/>    "/home/dtron/image.png"<br/>).show()<br/><br/># Or a icon name in the theme<br/>Notify.Notification.new(<br/>    "Ding!",<br/>    "Time is up.",<br/>    "dialog-information" # dialog-warn, dialog-error<br/>).show()</code></pre>

<p>When <strong>show()</strong> is called, there can be a delay if you use a large image file.</p>

<h2>Adding Buttons/Actions to Notification</h2>
<p>If you want the user to take some kind of action like "Reply" there is a way
to add a button to the notification. Call <strong>add_action()</strong> like in the example below.
Actions are a core part of Gnome programming. Actions are a topic of their own so I will
only provide this snippet so that you know it is possible to use button clicks
in the notification to trigger Gnome actions.
</p>

<pre class="prettyprint"><code>from gi.repository import Notify<br/><br/>Notify.init("Test App")<br/><br/># Define a callback function<br/>def my_callback_func():<br/>    pass<br/><br/>notification = Notify.Notification.new("Hi!")<br/># The notification will have a button that says<br/># "Reply to Message". my_callback_func is something<br/># We will have to define<br/>notification.add_action(<br/>    "action_click",<br/>    "Reply to Message",<br/>    my_callback_func,<br/>    None # Arguments<br/>)<br/><br/># Clear all actions with clear_actions()<br/>#notification.clear_actions()</code></pre>

<h2>Different Urgency Levels</h2>
<p>There are three urgency levels available: low, normal, and critical.</p>
<pre class="prettyprint"><code>from gi.repository import Notify<br/>Notify.init("Test App")<br/><br/>notification = Notify.Notification.new("Hi")<br/><br/>notification.set_urgency(0)<br/>notification.set_urgency(1)<br/>notification.set_urgency(2) # Highest priority<br/><br/>notification.show()</code></pre>


<h2>The notify-send Program</h2>
<p>It is worth mentioning there is already a program available called
<strong>notify-send</strong>. It is written in C, but the compiled program
is part of the <strong>libnotify-bin</strong> package in Debian. It is good
for scripting in bash shell. The entire <strong>notify-send</strong> program
is one single file. To see how that is written in C, check out the <a href="http://libnotify.sourcearchive.com/documentation/0.4.4/notify-send_8c-source.html" target="_blank">notify-send.c</a> source code. You can even find <a href="http://vaskovsky.net/notify-send/" target="_blank">notify-send for Windows</a>.</p>

<p>Install and use the <strong>notify-send</strong> program like this.</p>
<pre class="prettyprint"><code>#!/bin/bash<br/><br/># Install notify-send it if needed<br/>sudo apt-get install libnotify-bin<br/><br/># Basic usage. Script it.<br/>notify-send "Hello"<br/><br/># There are some options. check the man page.<br/>man notify-send</code></pre>

<p>
You could even use a system call to just run the <strong>notify-send</strong>
program. While that technically works, it is not the best way to do things if you
want to control the objects in your code. We will move on to see how to do it
all in Python.
</p>

<pre class="prettyprint"><code>#!/usr/bin/python<br/>from subprocess import call<br/>call(["notify-send", "Hello!", "Not the best way!"])</code></pre>


<h2>Other Languages</h2>
<p>While my examples are aimed Debian distributions, I really like Arch Linux too.
The Arch Linux wiki has a really great article on using libnotify. The dependencies they
list may differ slightly just because the package name is different between Arch Linux
and Debian, but it should be easy enough to find the same package for your distribution.
The <a href="https://wiki.archlinux.org/index.php/Desktop_notifications" target="_blank">Arch Wiki page on desktop notifications</a> covers a basic notification application in over a dozen languages.
<strong>Libnotify</strong> is very simple so it is a good library to play with
in unfamiliar languages.
</p>

<h2>References</h2>
<p>The <a href="https://developer.gnome.org/libnotify" target="_blank">Libnotify documentation</a> can be found on the Gnome Developer site.</p>
</div></div></body></html>