<html><body><div><article class="markdown-body entry-content" itemprop="text"><p><a href="https://camo.githubusercontent.com/d17ada80b5581bba766943e92ae7ecdd65933934/68747470733a2f2f63732e68656c73696e6b692e66692f752f6f6f7474656c612f7466636c6f676f2e706e67" target="_blank"><img align="right" src="https://camo.githubusercontent.com/d17ada80b5581bba766943e92ae7ecdd65933934/68747470733a2f2f63732e68656c73696e6b692e66692f752f6f6f7474656c612f7466636c6f676f2e706e67" data-canonical-src="https://cs.helsinki.fi/u/oottela/tfclogo.png"/></a></p>

<h3><a id="user-content-tinfoil-chat-nacl" class="anchor" href="#tinfoil-chat-nacl" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Tinfoil Chat NaCl</h3>

<p>TFC-NaCl is a high assurance encryption plugin for Pidgin IM client that 
protects users from <a href="https://en.wikipedia.org/wiki/Upstream_collection">passive eavesdropping</a>, 
<a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">active MITM attacks</a>
and remote CNE (aka equipment interference) of endpoints practiced by TLAs such 
as the <a href="https://firstlook.org/theintercept/2014/03/12/nsa-plans-infect-millions-computers-malware/">NSA</a>, 
 <a href="http://www.wired.co.uk/news/archive/2014-03/13/nsa-turbine">GCHQ</a> and 
 <a href="http://ccc.de/en/updates/2011/staatstrojaner">BKA</a>.</p>

<h3><a id="user-content-overview" class="anchor" href="#overview" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Overview</h3>

<p><strong>Strong end-to-end encryption</strong> with Curve25519 ECDHE / PSKs.
XSalsa20-Poly1305 AEAD with forward secrecy and deniability.</p>

<p><strong>Secure key generation</strong> with /dev/urandom mixed with entropy from 
open circuit design GPIO HWRNG of RPi that acts either as TCB itself or as 
a sampling device over SSH.</p>

<p><strong>Endpoint security</strong> obtained with hardware-based TCB separation:
Unidirectional data flow between end point's three computers prevents 
either injection of malware or exfiltration of keys and plaintexts from TCB
regardless of existing software zero-day vulnerabilities in software.</p>

<p><strong>Defeats metadata</strong> about quantity and schedule of communication with 
trickle connection that outputs constant stream of encrypted noise data.</p>

<p><strong>Covert file transfer</strong> that takes place in background during 
trickle connection.</p>

<p><strong>Multicasting</strong> of messages and files to multiple recipients (no trickle 
supported).</p>

<h3><a id="user-content-how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How it works</h3>

<p><a href="https://camo.githubusercontent.com/cf55bdae1b8b556e77b9665e93d54035ab161ba0/68747470733a2f2f63732e68656c73696e6b692e66692f752f6f6f7474656c612f7466635f6772617068322e706e67" target="_blank"><img src="https://camo.githubusercontent.com/cf55bdae1b8b556e77b9665e93d54035ab161ba0/68747470733a2f2f63732e68656c73696e6b692e66692f752f6f6f7474656c612f7466635f6772617068322e706e67" alt="" data-canonical-src="https://cs.helsinki.fi/u/oottela/tfc_graph2.png"/></a></p>

<p>TFC uses three computers per endpoint. Alice enters her commands and messages to
program Tx.py running on her Transmitter computer (TxM), a <a href="https://en.wikipedia.org/wiki/Trusted_computing_base">TCB</a>
separated from network. Tx.py encrypts and signs plaintext data and relays it
to receiver computers (RxM) via networked computer (NH) through RS-232 interface 
and a data diode.</p>

<p>Depending on packet type, the program NH.py running on Alice's NH forwards 
packets from TxM-side serial interface to Pidgin and local RxM (through another 
RS-232 interface and data diode). Local RxM authenticates and decrypts received
data before processing it.</p>

<p>Pidgin sends the packet either directly or through Tor network to IM server, 
that then forwards it directly (or again through Tor) to Bob.</p>

<p>NH.py on Bob's NH receives Alice's packet from Pidgin, and forwards it through 
RS-232 interface and data diode to Bob's RxM, where the ciphertext is 
authenticated, decrypted, and processed. When the Bob responds, he will send
the message/file using his TxM and in the end Alice reads the message from her RxM.</p>

<h3><a id="user-content-why-keys-can-not-be-exfiltrated" class="anchor" href="#why-keys-can-not-be-exfiltrated" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Why keys can not be exfiltrated</h3>

<ol>
<li><p>Malware that exploits an unknown vulnerability in RxM can infiltrate to 
the system, but is unable to exfiltrate keys or plaintexts, as data diode prevents
all outbound traffic.</p></li>
<li><p>Malware can not breach TxM as data diode prevents all inbound traffic. The
only data input from RxM to TxM is the 72 char public key, manually typed by 
user.</p></li>
<li><p>The NH is assumed to be compromised, but unencrypted data never touches it.</p></li>
</ol>

<p><a href="https://camo.githubusercontent.com/a7c78bbc45a741eccf4cb93b455f479e4b6d6b90/68747470733a2f2f63732e68656c73696e6b692e66692f752f6f6f7474656c612f7466635f61747461636b73322e706e67" target="_blank"><img src="https://camo.githubusercontent.com/a7c78bbc45a741eccf4cb93b455f479e4b6d6b90/68747470733a2f2f63732e68656c73696e6b692e66692f752f6f6f7474656c612f7466635f61747461636b73322e706e67" alt="" data-canonical-src="https://cs.helsinki.fi/u/oottela/tfc_attacks2.png"/></a></p>

<p>Optical repeater inside the optocoupler of the data diode (below) enforces direction of data transmission.</p>

<p><a href="https://camo.githubusercontent.com/9bf48e46421d5ac747f91e5076cbf0d833c91a5c/68747470733a2f2f63732e68656c73696e6b692e66692f752f6f6f7474656c612f646174615f64696f64652e706e67" target="_blank"><img src="https://camo.githubusercontent.com/9bf48e46421d5ac747f91e5076cbf0d833c91a5c/68747470733a2f2f63732e68656c73696e6b692e66692f752f6f6f7474656c612f646174615f64696f64652e706e67" align="center" data-canonical-src="https://cs.helsinki.fi/u/oottela/data_diode.png"/></a></p>

<h3><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h3>

<p><a href="http://www.youtube.com/watch?v=D5pDoJZj2Uw"><img src="https://camo.githubusercontent.com/cf8c6ffdfeee055a0ca9458b1982fcf64a107970/687474703a2f2f696d672e796f75747562652e636f6d2f76692f443570446f4a5a6a3255772f302e6a7067" alt="Installation" data-canonical-src="http://img.youtube.com/vi/D5pDoJZj2Uw/0.jpg"/></a></p>

<h3><a id="user-content-how-to-use" class="anchor" href="#how-to-use" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How to use</h3>

<p><a href="http://www.youtube.com/watch?v=tH8qbl1USoo"><img src="https://camo.githubusercontent.com/00e9de82e64612bbd2c52f269f0ecbeb0baf38e3/687474703a2f2f696d672e796f75747562652e636f6d2f76692f74483871626c3155536f6f2f302e6a7067" alt="Use" data-canonical-src="http://img.youtube.com/vi/tH8qbl1USoo/0.jpg"/></a></p>

<h3><a id="user-content-more-information" class="anchor" href="#more-information" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>More information</h3>

<p>White paper and manual for previous versions are listed below. TFC-NaCl specific
updates are listed in the updatelog. Updated white paper and documentation are
under work.</p>

<p>White paper: <a href="https://cs.helsinki.fi/u/oottela/tfc.pdf">https://cs.helsinki.fi/u/oottela/tfc.pdf</a></p>

<p>Manual: <a href="https://cs.helsinki.fi/u/oottela/tfc-manual.pdf">https://cs.helsinki.fi/u/oottela/tfc-manual.pdf</a></p>
</article>
  </div></body></html>