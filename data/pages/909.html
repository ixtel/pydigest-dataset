<html><body><div><div class="entry-content clearfix"><p>So, a friend of mine recently interviewed for a back-end Python developer position, and the initial interview consisted of answering the following problem. He was given two hours.</p>

<a name="Problem"/>
<h2>Problem</h2>

<ol>
<li><strong>Football</strong>: The <em>football.csv</em> file contains the results from the English Premier League. The columns labeled ‘Goals’ and ‘Goals Allowed’ contain the total number of goals scored for and against each team in that season (so Arsenal scored 79 goals against opponents, and had 36 goals scored against them). Write a program to read the file, then print the name of the team with the smallest difference in ‘for’ and ‘against’ goals.</li>
<li><strong>Weather</strong>: In <em>weather.csv</em> you’ll find daily weather data. Write a program to read the file, then output the day number (column one) with the smallest temperature spread (the maximum temperature is the second column, the minimum the third column).</li>
<li>See if you can write the same program to solve both questions.</li>
<li>Test Driven Development!</li>
</ol>


<p>You can grab all the files <a href="https://github.com/realpython/interview-questions/tree/master/parsing-data">here</a>.</p>

<p><em>Try this on your own before you look at my answer below.</em></p>

<blockquote><p><strong>Note:</strong> I have not solved this problem before, so I will be going through a number of iterations. Hopefully, this will give you insight into the process/workflow I went through. Once finished, compare your workflow with mine. What did you do differently? Finally, I will be using a true TDD approach for this. In other words, after I write a test, I will only write the bare minimum amount of code to get it to pass. That said, there will most likely be plenty of refactoring throughout. Bare with me. Patience.</p></blockquote>

<a name="Part.1:.Football"/>
<h2>Part 1: Football</h2>

<a name="Write.your.tests"/>
<h3>Write your tests</h3>

<p>In true TDD style, we start by writing our tests that will fail. Since we must first read in the CSV data, let’s ensure that we can do that, by testing that the data read in is what we think it should be.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">unittest</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">parse_csv</span> <span class="kn">import</span> <span class="n">read_data</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">ParseCSVTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s">'football.csv'</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
</span><span class="line">            <span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">]</span>
</span><span class="line">            <span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_team_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">'Arsenal'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span> <span class="s">'87'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
</span><span class="line">    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here, we are using a function imported from <em>parse_csv.py</em> called <code>read_data()</code>, which we haven’t written yet, to read in the data. Then we have three unit tests to check the values of the data read in.</p>

<p>Run your tests:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python parse_csv_test.py
</span><span class="line">Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
</span><span class="line">  File <span class="s2">"parse_csv_test.py"</span>, line 2, in &lt;module&gt;
</span><span class="line">    from parse_csv import read_data
</span><span class="line">ImportError: cannot import name read_data
</span></code></pre></td></tr></table></div></figure>


<a name="Write.the..code.read_data....code..function"/>
<h3>Write the <code>read_data()</code> function</h3>

<p>Next, let’s write <em>just enough</em> code in <em>parse_csv.py</em> to get our tests to pass.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">csv</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span class="line">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span class="line">        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())]</span>
</span><span class="line">    <span class="k">return</span> <span class="n">data</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="c"># ---- run code ---- #</span>
</span><span class="line">
</span><span class="line"><span class="n">data</span> <span class="o">=</span> <span class="s">"football.csv"</span>
</span><span class="line"><span class="n">read_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the tests again:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python parse_csv_test.py -v
</span><span class="line">test_csv_read_data_headers <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_csv_read_data_points <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_csv_read_data_team_name <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">
</span><span class="line">----------------------------------------------------------------------
</span><span class="line">Ran 3 tests in 0.001s
</span><span class="line">
</span><span class="line">OK
</span></code></pre></td></tr></table></div></figure>


<a name="Test.Redux"/>
<h3>Test Redux</h3>

<p>Back to the test file. This time, we want to find the “smallest difference in ‘for’ and ‘against’ goals”. So, add this import and function:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">parse_csv</span> <span class="kn">import</span> <span class="n">read_data</span><span class="p">,</span> <span class="n">get_min_score_difference</span>
</span><span class="line">
</span><span class="line"><span class="o">...</span>
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">test_get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">),</span> <span class="s">"no idea"</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Since, we don’t know off hand what the smallest difference will be, we can just add the string “no idea”. You could update that when you know what the answer is after we add the <code>get_min_score_difference()</code> function to <em>parse_csv.py</em> – but how do we know if that answer is correct?</p>

<p>Keep in mind, that since this is a small amount of data, you can get away with calculating them all by hand and finding the smallest difference. Or you could also use test data.:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">test_get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="n">parsed_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">],</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Arsenal'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'26'</span><span class="p">,</span> <span class="s">'9'</span><span class="p">,</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'79'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">,</span> <span class="s">'87'</span><span class="p">],</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Liverpool'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'24'</span><span class="p">,</span> <span class="s">'8'</span><span class="p">,</span> <span class="s">'6'</span><span class="p">,</span> <span class="s">'67'</span><span class="p">,</span> <span class="s">'30'</span><span class="p">,</span> <span class="s">'80'</span><span class="p">]</span>
</span><span class="line">    <span class="p">]</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">),</span> <span class="s">'37'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let’s go with the latter, since we <em>know</em> this is correct.</p>

<p>Run the test. Watch it fail.</p>

<a name="Write.the..code.get_min_score_difference....code..function"/>
<h3>Write the <code>get_min_score_difference()</code> function</h3>

<p>To simplify this, let’s use list comprehensions:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">get_min_score_difference</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">):</span>
</span><span class="line">    <span class="n">parsed_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class="line">    <span class="n">goals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="n">goals_allowed</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="k">return</span> <span class="nb">min</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">goals</span><span class="p">,</span> <span class="n">goals_allowed</span><span class="p">)])</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, what’s going on:</p>

<ol>
<li>First, we removed the header row since it will just get in the way.</li>
<li>Next, we created two new lists – one containing the goals score, the other containing the goals allowed</li>
<li>Finally, we simply created another new list containing the values from the first two lists subtracted, then we returned the smallest value.</li>
</ol>


<p>Test:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python parse_csv_test.py -v
</span><span class="line">test_csv_read_data_headers <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_csv_read_data_points <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_csv_read_data_team_name <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_get_min_score_difference <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">
</span><span class="line">----------------------------------------------------------------------
</span><span class="line">Ran 4 tests in 0.000s
</span><span class="line">
</span><span class="line">OK
</span></code></pre></td></tr></table></div></figure>


<p>They pass. But remember – There is another step to the TDD process: Refactoring. (<em>Hint, hint</em>).</p>

<p>Ask yourself: Since we eventually want the name of the team with the smallest spread, does it help to get the minimum value? No. It would be much easier to find the minimum value and then return the index value so that we can plug that in to the next function to easily get the name of the team.</p>

<p>First, rewrite the test:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">test_get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">],</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Arsenal'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'26'</span><span class="p">,</span> <span class="s">'9'</span><span class="p">,</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'79'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">,</span> <span class="s">'87'</span><span class="p">],</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Liverpool'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'24'</span><span class="p">,</span> <span class="s">'8'</span><span class="p">,</span> <span class="s">'6'</span><span class="p">,</span> <span class="s">'67'</span><span class="p">,</span> <span class="s">'30'</span><span class="p">,</span> <span class="s">'80'</span><span class="p">]</span>
</span><span class="line">    <span class="p">]</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, let’s get it to pass:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">get_min_score_difference</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">):</span>
</span><span class="line">    <span class="n">parsed_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class="line">    <span class="n">goals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="n">goals_allowed</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">goals</span><span class="p">,</span> <span class="n">goals_allowed</span><span class="p">)]</span>
</span><span class="line">    <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Test again.</p>

<blockquote><p>If you’re having trouble following the list comprehensions, try rewriting them using the regular list construct. For example:
  “`python</p>

<pre><code>for x in parsed_data:
    goals.append(x[5])
```
</code></pre></blockquote>

<a name="Final.Test"/>
<h3>Final Test</h3>

<p>Again, let’s test to see which team has the smallest range between goals scored and goals allowed:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">test_get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">],</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Arsenal'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'26'</span><span class="p">,</span> <span class="s">'9'</span><span class="p">,</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'79'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">,</span> <span class="s">'87'</span><span class="p">],</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Liverpool'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'24'</span><span class="p">,</span> <span class="s">'8'</span><span class="p">,</span> <span class="s">'6'</span><span class="p">,</span> <span class="s">'67'</span><span class="p">,</span> <span class="s">'30'</span><span class="p">,</span> <span class="s">'80'</span><span class="p">]</span>
</span><span class="line">    <span class="p">]</span>
</span><span class="line">    <span class="n">index_value</span> <span class="o">=</span> <span class="n">get_min_score_difference</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">),</span> <span class="s">'Liverpool'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Make sure to import in the <code>get_team</code> function. Run the tests file. This will fail. Success!</p>

<a name="Write.the..code.get_team....code..function"/>
<h3>Write the <code>get_team()</code> function</h3>

<p>Simply use that index value from the previous function as an argument, then create a list of all the teams, and finally pass in that index value to that list of teams:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">):</span>
</span><span class="line">    <span class="n">teams</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="k">return</span> <span class="n">teams</span><span class="p">[</span><span class="n">index_value</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Tests pass.</p>

<a name="Refactor.Tests"/>
<h3>Refactor Tests</h3>

<p>In our tests, let’s move our parsed data to the <code>setUp</code> so that we’re not repeating ourselves:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">unittest</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">parse_csv</span> <span class="kn">import</span> <span class="n">read_data</span><span class="p">,</span> <span class="n">get_min_score_difference</span><span class="p">,</span> <span class="n">get_team</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">ParseCSVTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s">'football.csv'</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Arsenal'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'26'</span><span class="p">,</span> <span class="s">'9'</span><span class="p">,</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'79'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">,</span> <span class="s">'87'</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Liverpool'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'24'</span><span class="p">,</span> <span class="s">'8'</span><span class="p">,</span> <span class="s">'6'</span><span class="p">,</span> <span class="s">'67'</span><span class="p">,</span> <span class="s">'30'</span><span class="p">,</span> <span class="s">'80'</span><span class="p">]</span>
</span><span class="line">        <span class="p">]</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
</span><span class="line">            <span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">]</span>
</span><span class="line">            <span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_team_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">'Arsenal'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span> <span class="s">'87'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">index_value</span> <span class="o">=</span> <span class="n">get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">),</span> <span class="s">'Liverpool'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
</span><span class="line">    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Refactor.Code"/>
<h3>Refactor Code</h3>

<p>So, per the instructions, we need to make this code work for both CSV files. Let’s refactor our code from using a procedural structure or an OOP structure, meant for code reuse:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">csv</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">ParseCSV</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span class="line">            <span class="n">parsed_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())]</span>
</span><span class="line">        <span class="k">return</span> <span class="n">parsed_data</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">):</span>
</span><span class="line">        <span class="n">parsed_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class="line">        <span class="n">goals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">        <span class="n">goals_allowed</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">goals</span><span class="p">,</span> <span class="n">goals_allowed</span><span class="p">)]</span>
</span><span class="line">        <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_value</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">):</span>
</span><span class="line">        <span class="n">teams</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">        <span class="k">return</span> <span class="n">teams</span><span class="p">[</span><span class="n">index_value</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Try running the tests; they will fail:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python parse_csv_test.py
</span><span class="line">Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
</span><span class="line">  File <span class="s2">"parse_csv_test.py"</span>, line 2, in &lt;module&gt;
</span><span class="line">    from parse_csv import read_data, get_min_score_difference, get_team
</span><span class="line">ImportError: cannot import name read_data
</span></code></pre></td></tr></table></div></figure>


<a name="Refactor.Tests.Redux"/>
<h3>Refactor Tests Redux</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">unittest</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">parse_csv</span> <span class="kn">import</span> <span class="n">ParseCSV</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">ParseCSVTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s">'football.csv'</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Arsenal'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'26'</span><span class="p">,</span> <span class="s">'9'</span><span class="p">,</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'79'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">,</span> <span class="s">'87'</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Liverpool'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">,</span> <span class="s">'24'</span><span class="p">,</span> <span class="s">'8'</span><span class="p">,</span> <span class="s">'6'</span><span class="p">,</span> <span class="s">'67'</span><span class="p">,</span> <span class="s">'30'</span><span class="p">,</span> <span class="s">'80'</span><span class="p">]</span>
</span><span class="line">        <span class="p">]</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">football</span> <span class="o">=</span> <span class="n">ParseCSV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
</span><span class="line">            <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">]</span>
</span><span class="line">            <span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_team_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">'Arsenal'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span> <span class="s">'87'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">index_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">),</span> <span class="s">'Liverpool'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
</span><span class="line">    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>There are minimal changes here. At this point, you could create a separate CSV file for testing. Instead, let’s go on to the next part and look at the CSV issue later.</p>

<blockquote><p>Remember: Let’s not over optimize too early – just make the minimal changes necessary to get the tests to pass. We do have some naming issues and a few other issues to refactor. However, let’s work on the second part of the problem, incorporating the weather data into this code, then refactor at the end.</p></blockquote>

<a name="Part.2:.Weather"/>
<h2>Part 2: Weather</h2>

<a name="Watch.our.tests.Fail"/>
<h3>Watch our tests Fail</h3>

<p>Before we do anything, let’s use the new CSV file and watch our tests fail:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">python parse_csv_test.py -v
</span><span class="line">test_csv_read_data_headers <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... FAIL
</span><span class="line">test_csv_read_data_points <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... FAIL
</span><span class="line">test_csv_read_data_team_name <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... FAIL
</span><span class="line">test_get_min_score_difference <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_get_team <span class="o">(</span>__main__.ParseCSVTest<span class="o">)</span> ... ok
</span></code></pre></td></tr></table></div></figure>


<p>Notice how the only tests that pass are the tests that use <code>parsed_data</code> rather than the CSV. This is a good indication that we really should be using the actual data for testing. Let’s quickly refactor (again!):</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">unittest</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">parse_csv</span> <span class="kn">import</span> <span class="n">ParseCSV</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">FootballParseCSVTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s">'football.csv'</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">football</span> <span class="o">=</span> <span class="n">ParseCSV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
</span><span class="line">            <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">]</span>
</span><span class="line">            <span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_team_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">'Arsenal'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span> <span class="s">'87'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">),</span> <span class="mi">19</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">        <span class="n">index_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">),</span> <span class="s">'Leicester'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
</span><span class="line">    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>These will pass. Now change the data so that they run with <em>weather.csv</em>:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python parse_csv_test.py -v
</span><span class="line">test_csv_read_data_headers <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... FAIL
</span><span class="line">test_csv_read_data_points <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... FAIL
</span><span class="line">test_csv_read_data_team_name <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... FAIL
</span><span class="line">test_get_min_score_difference <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ERROR
</span><span class="line">test_get_team <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ERROR
</span></code></pre></td></tr></table></div></figure>


<p>This is exactly what we want to see. Now we need to refactor both our code and tests to get our code to work with both data sets as well as simplify our tests to eliminate redundancy. (Notice a trend yet?)</p>

<a name="Refactor.Tests.and.Code"/>
<h3>Refactor Tests and Code</h3>

<a name="Test"/>
<h4>Test</h4>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">football_data</span> <span class="o">=</span> <span class="s">'football.csv'</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">weather_data</span> <span class="o">=</span> <span class="s">'weather.csv'</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">football</span> <span class="o">=</span> <span class="n">ParseCSV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football_data</span><span class="p">)</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">weather</span> <span class="o">=</span> <span class="n">ParseCSV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weather_data</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here, we are using both data sets and instantiating multiple instances of the same class, <code>ParseCSV()</code>. <em>Yes, there is some redundancy here, but let’s just keep it simple for now. We’ll refactor at the end.</em></p>

<a name="Test"/>
<h4>Test</h4>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">test_csv_read_data_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Team'</span><span class="p">,</span> <span class="s">'Games'</span><span class="p">,</span> <span class="s">'Wins'</span><span class="p">,</span> <span class="s">'Losses'</span><span class="p">,</span> <span class="s">'Draws'</span><span class="p">,</span> <span class="s">'Goals'</span><span class="p">,</span> <span class="s">'Goals Allowed'</span><span class="p">,</span> <span class="s">'Points'</span><span class="p">]</span>
</span><span class="line">        <span class="p">)</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
</span><span class="line">        <span class="p">[</span><span class="s">'Day'</span><span class="p">,</span> <span class="s">'MxT'</span><span class="p">,</span> <span class="s">'MnT'</span><span class="p">,</span> <span class="s">'AvT'</span><span class="p">,</span> <span class="s">'AvDP'</span><span class="p">,</span> <span class="s">'1HrP TPcpn'</span><span class="p">,</span> <span class="s">'PDir'</span><span class="p">,</span> <span class="s">'AvSp'</span><span class="p">,</span> <span class="s">'Dir'</span><span class="p">,</span> <span class="s">'MxS'</span><span class="p">,</span> <span class="s">'SkyC'</span><span class="p">,</span> <span class="s">'MxR'</span><span class="p">,</span> <span class="s">'Mn'</span><span class="p">,</span> <span class="s">'R AvSLP'</span><span class="p">]</span>
</span><span class="line">        <span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">test_csv_read_random_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">'Arsenal'</span><span class="p">)</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span> <span class="s">'87'</span><span class="p">)</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">'1'</span><span class="p">)</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span> <span class="s">'9.6'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is straightforward. Comment out the other two tests and run just this one. It should pass.</p>

<a name="Test"/>
<h4>Test</h4>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">test_get_min_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="n">football_parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="n">football_parsed_data</span><span class="p">),</span> <span class="mi">19</span><span class="p">)</span>
</span><span class="line">    <span class="n">weather_parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">get_min_score_difference</span><span class="p">(</span><span class="n">weather_parsed_data</span><span class="p">),</span> <span class="s">"no idea"</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Uncomment this test. It will fail:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python parse_csv_test.py -v
</span><span class="line">test_csv_read_data_headers <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_csv_read_random_data_points <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_get_min_difference <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... FAIL
</span></code></pre></td></tr></table></div></figure>


<p>Why does it fail?</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">AssertionError: 2 !<span class="o">=</span> <span class="s1">'no idea'</span>
</span></code></pre></td></tr></table></div></figure>


<p>This essentially is saying that the smallest difference between the second and third column is row two. Is that correct? We addressed this very same issue earlier:</p>

<blockquote><p>Since, we don’t know off hand what the smallest difference will be, we can just add the string “no idea”. You could update that when you know what the answer is after we add the <code>get_min_score_difference()</code> function to <em>parse_csv.py</em> – but how do we know if that answer is correct?</p>

<p>Keep in mind, that since this is a small amount of data, you can get away with calculating them all by hand and finding the smallest difference. Or you could also use test data.</p></blockquote>

<p>Let’s go the other route this time: Just calculating it by hand. <em>Do not do this if you have a lot of data!</em>.</p>

<p>Do this now.</p>

<p>You should find that the row with the smallest difference is row 14 (or 13 minus the header). Update your tests, run them again, and they should still fail:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">AssertionError: 2 !<span class="o">=</span> 13
</span></code></pre></td></tr></table></div></figure>


<p>Why is this?</p>

<a name="Code"/>
<h4>Code</h4>

<p>Go back to <em>parse.csv</em> and look at the <code>get_min_score_difference()</code> function:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">get_min_score_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">):</span>
</span><span class="line">    <span class="n">parsed_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class="line">    <span class="n">goals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="n">goals_allowed</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">goals</span><span class="p">,</span> <span class="n">goals_allowed</span><span class="p">)]</span>
</span><span class="line">    <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Did you figure it out?</p>

<p>We’re passing in the column values – <code>x[5]</code> and x[6] – which are applicable only to the <em>football.csv</em>. Thus, we need to pass in either the column index values or the header names so that this function uses the right data regardless of the data set used. Since we’re popping off the header, let’s use the column index values:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">get_min_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">,</span> <span class="n">column1</span><span class="p">,</span> <span class="n">column2</span><span class="p">):</span>
</span><span class="line">    <span class="n">parsed_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class="line">    <span class="n">column1_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">column1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="n">column2_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">column2</span><span class="p">]</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">column1_list</span><span class="p">,</span> <span class="n">column2_list</span><span class="p">)]</span>
</span><span class="line">    <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Test"/>
<h4>Test</h4>

<p>Update the test:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">test_get_min_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="n">football_parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_min_difference</span><span class="p">(</span><span class="n">football_parsed_data</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">19</span><span class="p">)</span>
</span><span class="line">    <span class="n">weather_parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">get_min_difference</span><span class="p">(</span><span class="n">weather_parsed_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">13</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>And they pass:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python parse_csv_test.py -v
</span><span class="line">test_csv_read_data_headers <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_csv_read_random_data_points <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_get_min_difference <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">
</span><span class="line">----------------------------------------------------------------------
</span><span class="line">Ran 3 tests in 0.001s
</span><span class="line">
</span><span class="line">OK
</span></code></pre></td></tr></table></div></figure>


<p>Uncomment the last test and update <code>get_min_score_difference()</code> to <code>get_min_difference()</code> then pass in the columns:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">test_get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">    <span class="n">football_parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">    <span class="n">index_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_min_difference</span><span class="p">(</span><span class="n">football_parsed_data</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">football</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">,</span> <span class="n">football_parsed_data</span><span class="p">),</span> <span class="s">'Leicester'</span><span class="p">)</span>
</span><span class="line">    <span class="n">weather_parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">    <span class="n">index_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">get_min_difference</span><span class="p">(</span><span class="n">weather_parsed_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">,</span> <span class="n">weather_parsed_data</span><span class="p">),</span> <span class="s">'14'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now they all pass:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"> python parse_csv_test.py -v
</span><span class="line">test_csv_read_data_headers <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_csv_read_random_data_points <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_get_min_difference <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">test_get_name <span class="o">(</span>__main__.FootballParseCSVTest<span class="o">)</span> ... ok
</span><span class="line">
</span><span class="line">----------------------------------------------------------------------
</span><span class="line">Ran 4 tests in 0.001s
</span><span class="line">
</span><span class="line">OK
</span></code></pre></td></tr></table></div></figure>


<a name="Add.test.data"/>
<h3>Add test data</h3>

<p>Finally, let’s add our own test data for use rather than using the actual CSV files to isolate test data from actual, real data.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">unittest</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">parse_csv</span> <span class="kn">import</span> <span class="n">ParseCSV</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">testParseCSVTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s">'test.csv'</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">test</span> <span class="o">=</span> <span class="n">ParseCSV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_data_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
</span><span class="line">            <span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span class="line">            <span class="p">[</span><span class="s">'Date'</span><span class="p">,</span> <span class="s">'Open'</span><span class="p">,</span> <span class="s">'High'</span><span class="p">,</span> <span class="s">'Low'</span><span class="p">,</span> <span class="s">'Close'</span><span class="p">,</span> <span class="s">'Volume'</span><span class="p">,</span> <span class="s">'Adj Close'</span><span class="p">]</span>
</span><span class="line">            <span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_csv_read_random_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">'5/8/14'</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">read_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span> <span class="s">'511'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_get_min_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">get_min_difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">test_get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">index_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">get_min_difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">),</span> <span class="s">'4/30/14'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
</span><span class="line">    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the tests. They should pass.</p>

<a name="One.last.thing...."/>
<h3>One last thing …</h3>

<p>One thing to keep in mind is the nature of the <code>pop()</code> method. It’s destructive, so it alters the original list, <code>parsed_data</code>, removing the headers permanently within the <code>get_min_difference()</code> function. What are the ramifications of this?</p>

<p>Let’s test it out.</p>

<p>Add a <code>print</code> statement to the <code>test_get_name()</code> function:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_value</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">):</span>
</span><span class="line">    <span class="k">print</span> <span class="n">parsed_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class="line">    <span class="n">teams</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">]</span>
</span><span class="line">    <span class="k">return</span> <span class="n">teams</span><span class="p">[</span><span class="n">index_value</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the tests again.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="err">$</span> <span class="n">python</span> <span class="n">parse_csv_test</span><span class="o">.</span><span class="n">py</span>
</span><span class="line"><span class="o">...</span><span class="p">[</span><span class="s">'5/8/14'</span><span class="p">,</span> <span class="s">'508.46'</span><span class="p">,</span> <span class="s">'517.23'</span><span class="p">,</span> <span class="s">'506.45'</span><span class="p">,</span> <span class="s">'511'</span><span class="p">,</span> <span class="s">'2015800'</span><span class="p">,</span> <span class="s">'511'</span><span class="p">]</span>
</span><span class="line"><span class="o">.</span>
</span><span class="line"><span class="o">----------------------------------------------------------------------</span>
</span><span class="line"><span class="n">Ran</span> <span class="mi">4</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.001</span><span class="n">s</span>
</span><span class="line">
</span><span class="line"><span class="n">OK</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice that row 0 contains data, not the headers. This can create problems. Sure, you could just assign a variable to the data when you pop it off – <code>headers = parsed_data.pop(0)</code> – then add the data back to the list. But, it’s generally better to work with non-destructive methods if you do not actually need to alter the original structure.</p>

<p>Thus, let’s use <code>slice</code> instead. Update the <code>get_min_difference()</code> function:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">get_min_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">,</span> <span class="n">column1</span><span class="p">,</span> <span class="n">column2</span><span class="p">):</span>
</span><span class="line">    <span class="n">column1_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">column1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
</span><span class="line">    <span class="n">column2_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">column2</span><span class="p">]</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
</span><span class="line">    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">column1_list</span><span class="p">,</span> <span class="n">column2_list</span><span class="p">)]</span>
</span><span class="line">    <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the test again. You should see the following failure:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="err">$</span> <span class="n">python</span> <span class="n">parse_csv_test</span><span class="o">.</span><span class="n">py</span>
</span><span class="line"><span class="o">...</span><span class="n">F</span>
</span><span class="line"><span class="o">======================================================================</span>
</span><span class="line"><span class="n">FAIL</span><span class="p">:</span> <span class="n">test_get_name</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">testParseCSVTest</span><span class="p">)</span>
</span><span class="line"><span class="o">----------------------------------------------------------------------</span>
</span><span class="line"><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span class="line">  <span class="n">File</span> <span class="s">"parse_csv_test.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">27</span><span class="p">,</span> <span class="ow">in</span> <span class="n">test_get_name</span>
</span><span class="line">    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">index_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_data</span><span class="p">),</span> <span class="s">'4/30/14'</span><span class="p">)</span>
</span><span class="line"><span class="ne">AssertionError</span><span class="p">:</span> <span class="s">'5/1/14'</span> <span class="o">!=</span> <span class="s">'4/30/14'</span>
</span><span class="line">
</span><span class="line"><span class="o">----------------------------------------------------------------------</span>
</span><span class="line"><span class="n">Ran</span> <span class="mi">4</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.001</span><span class="n">s</span>
</span><span class="line">
</span><span class="line"><span class="n">FAILED</span> <span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is because we are now dealing with data that has the header back in within the <code>get_team</code> function while the header was sliced off in <code>get_min_difference()</code>. Thus, we need to update the <code>get_team()</code> function:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_value</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">):</span>
</span><span class="line">    <span class="n">teams</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
</span><span class="line">    <span class="k">return</span> <span class="n">teams</span><span class="p">[</span><span class="n">index_value</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the tests one last time …</p>
</div>


      </div></body></html>