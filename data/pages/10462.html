<html><body><div><div class="post-text" itemprop="text">

<p>I need to gather information from a webpage which can't be referenced due to containing adult content. Before I can go any further in this page, first, I need to click the age confirmation button. For now on, I'm only interested in getting it's source. However, the simplest possible solution does not work. I tried to locate the age button after the page is loaded, but I got this message:</p>

<pre><code>C:\Documents and Settings\katie&gt;python test.py
Message: {"errorMessage":"Unable to find element with class name '.enter_pl'","r
equest":{"headers":{"Accept":"application/json","Accept-Encoding":"identity","Co
nnection":"close","Content-Length":"98","Content-Type":"application/json;charset
=UTF-8","Host":"127.0.0.1:1559","User-Agent":"Python-urllib/2.7"},"httpVersion":
"1.1","method":"POST","post":"{\"using\": \"class name\", \"sessionId\": \"8ef74
610-d21e-11e5-a0c9-ede1ada579b6\", \"value\": \".enter_pl\"}","url":"/element","
urlParsed":{"anchor":"","query":"","file":"element","directory":"/","path":"/ele
ment","relative":"/element","port":"","host":"","password":"","user":"","userInf
o":"","authority":"","protocol":"","source":"/element","queryKey":{},"chunks":["
element"]},"urlOriginal":"/session/8ef74610-d21e-11e5-a0c9-ede1ada579b6/element"
}}
Screenshot: available via screen
</code></pre>

<p>And here's the code:</p>

<pre><code>#!/bin/env/python
# -*- coding: cp1250 -*-
from datetime import datetime
import time
import sys, os
from selenium.webdriver.support.wait import WebDriverWait
from selenium import webdriver

reload(sys)
sys.setdefaultencoding("cp1250")

main_page_url = "" # actual URL removed due to referencing adult content

def get_browser():
    return webdriver.PhantomJS("phantomjs.exe")

try :
    browser = get_browser()
    wait = WebDriverWait(browser, 30)
    browser.get(main_page_url)
    close = browser.find_element_by_class_name('.enter_pl')
    close.click()
    html = browser.page_source
    browser.close()
    print html
except Exception, e:
    print e
</code></pre>

<p>I also tried locating the element with a xpath, like this:</p>

<pre><code>#!/bin/env/python
# -*- coding: cp1250 -*-
from datetime import datetime
import time
import sys, os
from selenium.webdriver.support.wait import WebDriverWait
from selenium import webdriver

reload(sys)
sys.setdefaultencoding("cp1250")

main_page_url = "" # actual URL removed due to referencing adult content

def get_browser():
    return webdriver.PhantomJS("phantomjs.exe")

try :
    browser = get_browser()
    wait = WebDriverWait(browser, 30)
    browser.get(main_page_url)

    button_age_accept = browser.find_element_by_xpath("/html/body/div[1]/div[2]/div[1]/div[1]/div[2]/button")
    button_age_accept.click()

    html = browser.page_source
    browser.close()
    print html
except Exception, e:
    print e
</code></pre>

<p>But I also got this message ...</p>

<pre><code>C:\Documents and Settings\katie&gt;python test2.py

Message: {"errorMessage":"Unable to find element with xpath '/html/body/div[1]/d
iv[2]/div[1]/div[1]/div[2]/button'","request":{"headers":{"Accept":"application/
json","Accept-Encoding":"identity","Connection":"close","Content-Length":"136","
Content-Type":"application/json;charset=UTF-8","Host":"127.0.0.1:1655","User-Age
nt":"Python-urllib/2.7"},"httpVersion":"1.1","method":"POST","post":"{\"using\":
 \"xpath\", \"sessionId\": \"63c74110-d21f-11e5-b1f9-dbb94da03942\", \"value\":
\"/html/body/div[1]/div[2]/div[1]/div[1]/div[2]/button\"}","url":"/element","url
Parsed":{"anchor":"","query":"","file":"element","directory":"/","path":"/elemen
t","relative":"/element","port":"","host":"","password":"","user":"","userInfo":
"","authority":"","protocol":"","source":"/element","queryKey":{},"chunks":["ele
ment"]},"urlOriginal":"/session/63c74110-d21f-11e5-b1f9-dbb94da03942/element"}}
Screenshot: available via screen
</code></pre>

<p>Here's the html of this webpage: <a href="http://pastie.org/private/koxyw655innytv9skcijog" rel="nofollow">http://pastie.org/private/koxyw655innytv9skcijog</a></p>

<p><strong>-----------------------------------------------------------------------------------------------------------------------------------EDIT: I tried to go with Chrome
-----------------------------------------------------------------------------------------------------------------------------------</strong></p>

<p>I tried to do exact thing using chrome, instead of PhantomJS, however, chrome shows me <code>ERR_SSL_VERSION_OR_CIPHER_MISMATCH</code>:</p>

<pre><code>#!/bin/env/python
# -*- coding: cp1250 -*-
from datetime import datetime
import time
from selenium.webdriver.common.by import By
import sys, os
from selenium.webdriver.support.wait import WebDriverWait
from selenium import webdriver
from selenium.webdriver.support import expected_conditions as EC

reload(sys)
sys.setdefaultencoding("cp1250")

main_page_url = "" # actual URL removed due to referencing adult content

def get_browser():
    return webdriver.PhantomJS(executable_path=r'./phantomjs.exe', service_args=['--ignore-ssl-errors=true', 'â€“ssl-protocol=any'])

def get_chrome():
    options = webdriver.ChromeOptions()
    options.add_argument("--start-maximized")
    options.add_argument('--ignore-certificate-errors')
    return webdriver.Chrome(chrome_options=options)

try :

    browser = get_chrome()
    wait = WebDriverWait(browser, 100)
    browser.maximize_window()
    browser.get(main_page_url)

    browser.maximize_window()
    wait = WebDriverWait(browser, 20)
    wait.until(EC.presence_of_element_located((By.XPATH, "//*[@id='confirmage']/div[2]/button")))
    elemnt = browser.find_element_by_xpath(".//*[@id='confirmage']/div[2]/button")
    elemnt.click();

    html = browser.page_source
    browser.close()
    print html

    with open('result.txt', 'w') as file_:
        file_.write(html)

except Exception, e:
    print e
    with open('result.txt', 'w') as file_:
        file_.write("ERROR")
</code></pre>
    </div>
    </div></body></html>