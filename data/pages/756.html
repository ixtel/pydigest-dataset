<html><body><div><div class="entry-content">
                    <p>Writing reusable code is a good thing, right? The trick is to do so in a way that makes your life and those of others easier, but to do so in a very clear and maintainable way. Recently I've been playing around with Python's <a class="reference external" href="https://docs.python.org/2.7/library/functools.html#functools.partial">functools.partial</a> function, which I've found can help facilitate writing reusable code.</p>
<a class="reference external image-reference" href="http://pydanny.com/python-partials-are-fun.html"><img alt="http://pydanny.com/static/partials.png" class="align-center" id="id1" src="http://pydanny.com/static/partials.png"/></a>
<p>While the documentation has a nice explanation and demonstration of <tt class="docutils literal">functools.partial</tt>, it's very serious. I've got my own internal version of things which I think is a little more fun.</p>


<div class="section" id="a-way-to-organize-partials">
<h2>A Way to Organize Partials</h2>
<p>Lists are great, but sometimes it's nice to have a more legible way of interacting with functions. There are an infinite ways to make this happen, but I like the dot notation of classes. So here is a 'partial structure' class which follows a pattern I think is pretty handy:</p>
<div class="highlight"><pre><span class="c"># Since I like my article code to work in both Python 2.7 and 3,</span>
<span class="c">#   I'll import the excellent six library to manage the</span>
<span class="c">#   differences between Python versions. Six is available on PyPI</span>
<span class="c">#   at https://pypi.python.org/pypi/six.</span>
<span class="kn">from</span> <span class="nn">six</span> <span class="kn">import</span> <span class="n">add_metaclass</span>

<span class="k">class</span> <span class="nc">PowerMeta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">dct</span><span class="p">):</span>

        <span class="c"># generate 50 partial power functions:</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">):</span>

            <span class="c"># Set the partials to the class</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="c"># cls represents the class</span>
                <span class="n">cls</span><span class="p">,</span>

                <span class="c"># name the partial</span>
                <span class="s">"p{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>

                <span class="c"># partials created here</span>
                <span class="n">partial</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PowerMeta</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">dct</span><span class="p">)</span>

<span class="nd">@add_metaclass</span><span class="p">(</span><span class="n">PowerMeta</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">PowerStructure</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>Okay, let's test our PowerStructure class as an instantiated PowerStructure:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">test_power_structure_object</span><span class="p">():</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">PowerStructure</span><span class="p">()</span>

    <span class="c"># 10 squared</span>
    <span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">p2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">100</span>

    <span class="c"># 2 to the 5th power</span>
    <span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">p5</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">32</span>

    <span class="c"># 2 to the 50th power</span>
    <span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">p50</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1125899906842624</span>
</pre></div>
<p>Looks good, right? But wait, there's more!</p>
<p>Thanks to the power of metaclasses, we don't need to instantiate the PowerStructure class!</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">test_power_structure_class</span><span class="p">():</span>
    <span class="c"># Thanks to the power of metaclasses, we don't need to instantiate!</span>

    <span class="c"># 10 squared</span>
    <span class="k">assert</span> <span class="n">PowerStructure</span><span class="o">.</span><span class="n">p2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">100</span>

    <span class="c"># 2 to the 5th power</span>
    <span class="k">assert</span> <span class="n">PowerStructure</span><span class="o">.</span><span class="n">p5</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">32</span>

    <span class="c"># 2 to the 50th power</span>
    <span class="k">assert</span> <span class="n">PowerStructure</span><span class="o">.</span><span class="n">p50</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1125899906842624</span>
</pre></div>
<p><a class="reference external" href="https://gist.github.com/pydanny/11295815">Source Code</a></p>
</div>
<div class="section" id="summary">
<h2>Summary</h2>
<p>I've provided some simple examples of how to use <tt class="docutils literal">functools.partials</tt>. I find them really useful for certain tasks, mostly in avoiding repeating myself. Like any coding tool, complex usage can cloak the meaning of code, so be careful and use <tt class="docutils literal">functools.partials</tt> judiciously.</p>
<p>Update: <a class="reference external" href="https://twitter.com/ncoghlan_dev">Nick Coghlan</a> reminded me to mention that Python has a <tt class="docutils literal">pow()</tt> built-in.</p>
<p>Update 04/30/2014: <a class="reference external" href="https://twitter.com/samueljohn_de">Samuel John</a> corrected me on Nick Coghlan's name.</p>
</div>

                    
                </div>
                                </div></body></html>