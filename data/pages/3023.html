<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-dshell" class="anchor" href="#dshell" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Dshell</h1>

<p>An extensible network forensic analysis framework.  Enables rapid development of plugins to support the dissection of network packet captures.  </p>

<p>Key features:</p>

<ul>
<li>Robust stream reassembly </li>
<li>IPv4 and IPv6 support</li>
<li>Custom output handlers</li>
<li>Chainable decoders</li>
</ul>

<h2><a id="user-content-prerequisites" class="anchor" href="#prerequisites" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Prerequisites</h2>

<ul>
<li>Linux (developed on Ubuntu 12.04)</li>
<li>Python 2.7</li>
<li><a href="https://github.com/appliedsec/pygeoip">pygeoip</a>, GNU Lesser GPL

</li>
<li><a href="https://pypi.python.org/pypi/pycrypto">PyCrypto</a>, custom license</li>
<li><a href="https://code.google.com/p/dpkt/">dpkt</a>, New BSD License</li>
<li><a href="https://github.com/haypo/python-ipy">IPy</a>, BSD 2-Clause License</li>
<li><a href="https://code.google.com/p/pypcap/">pypcap</a>, New BSD License</li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/client/python-api/current/index.html">elasticsearch-py</a>, Apache License, Version 2.0 - optional, used only with Dshell's elasticout output module</li>
</ul>

<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>

<ol>
<li><p>Install all of the necessary Python modules listed above. Many of them are available via pip and/or apt-get. Pygeoip is not yet available as a package and must be installed with pip or manually.</p>

<ol>
<li><p><code>sudo apt-get install python-crypto python-dpkt python-ipy python-pypcap</code></p></li>
<li><p><code>sudo pip install pygeoip</code></p></li>
</ol></li>
<li><p>Configure pygeoip by moving the MaxMind data files (GeoIP.dat, GeoIPv6.dat, GeoIPASNum.dat, GeoIPASNumv6.dat) to &lt;install-location&gt;/share/GeoIP/</p></li>
<li><p>Run <code>make</code>. This will build Dshell.</p></li>
<li><p>Run <code>./dshell</code>. This is Dshell. If you get a Dshell&gt; prompt, you're good to go!</p></li>
</ol>

<h2><a id="user-content-basic-usage" class="anchor" href="#basic-usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Basic usage</h2>

<ul>
<li><code>decode -l</code>

<ul>
<li>This will list all available decoders alongside basic information about them</li>
</ul></li>
<li><code>decode -h</code>

<ul>
<li>Show generic command-line flags available to most decoders</li>
</ul></li>
<li><code>decode -d &lt;decoder&gt;</code>

<ul>
<li>Display information about a decoder, including available command-line flags</li>
</ul></li>
<li><code>decode -d &lt;decoder&gt; &lt;pcap&gt;</code>

<ul>
<li>Run the selected decoder on a pcap file</li>
</ul></li>
</ul>

<h2><a id="user-content-partners" class="anchor" href="#partners" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Partners</h2>

<p>Below are repositories from partners Dshell has worked together with.</p>



<h2><a id="user-content-usage-examples" class="anchor" href="#usage-examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage Examples</h2>

<p>Showing DNS lookups in <a href="http://wiki.wireshark.org/SampleCaptures#General_.2F_Unsorted">sample traffic</a></p>

<pre><code>Dshell&gt; decode -d dns ~/pcap/dns.cap
dns 2005-03-30 03:47:46    192.168.170.8:32795 -&gt;   192.168.170.20:53    ** 39867 PTR? 66.192.9.104 / PTR: 66-192-9-104.gen.twtelecom.net **
dns 2005-03-30 03:47:46    192.168.170.8:32795 -&gt;   192.168.170.20:53    ** 30144 A? www.netbsd.org / A: 204.152.190.12 (ttl 82159s) **
dns 2005-03-30 03:47:46    192.168.170.8:32795 -&gt;   192.168.170.20:53    ** 61652 AAAA? www.netbsd.org / AAAA: 2001:4f8:4:7:2e0:81ff:fe52:9a6b (ttl 86400s) **
dns 2005-03-30 03:47:46    192.168.170.8:32795 -&gt;   192.168.170.20:53    ** 32569 AAAA? www.netbsd.org / AAAA: 2001:4f8:4:7:2e0:81ff:fe52:9a6b (ttl 86340s) **
dns 2005-03-30 03:47:46    192.168.170.8:32795 -&gt;   192.168.170.20:53    ** 36275 AAAA? www.google.com / CNAME: www.l.google.com **
dns 2005-03-30 03:47:46    192.168.170.8:32795 -&gt;   192.168.170.20:53    ** 9837 AAAA? www.example.notginh / NXDOMAIN **
dns 2005-03-30 03:52:17    192.168.170.8:32796 &lt;-   192.168.170.20:53    ** 23123 PTR? 127.0.0.1 / PTR: localhost **
dns 2005-03-30 03:52:25   192.168.170.56:1711  &lt;-      217.13.4.24:53    ** 30307 A? GRIMM.utelsystems.local / NXDOMAIN **
dns 2005-03-30 03:52:17   192.168.170.56:1710  &lt;-      217.13.4.24:53    ** 53344 A? GRIMM.utelsystems.local / NXDOMAIN **
</code></pre>

<p>Following and reassembling a stream in <a href="http://wiki.wireshark.org/SampleCaptures#General_.2F_Unsorted">sample traffic</a></p>

<pre><code>Dshell&gt; decode -d followstream ~/pcap/v6-http.cap
Connection 1 (TCP)
Start: 2007-08-05 19:16:44.189852 UTC
  End: 2007-08-05 19:16:44.204687 UTC
2001:6f8:102d:0:2d0:9ff:fee3:e8de:59201 -&gt; 2001:6f8:900:7c0::2:80 (240 bytes)
2001:6f8:900:7c0::2:80 -&gt; 2001:6f8:102d:0:2d0:9ff:fee3:e8de:59201 (2259 bytes)

GET / HTTP/1.0
Host: cl-1985.ham-01.de.sixxs.net
Accept: text/html, text/plain, text/css, text/sgml, */*;q=0.01
Accept-Encoding: gzip, bzip2
Accept-Language: en
User-Agent: Lynx/2.8.6rel.2 libwww-FM/2.14 SSL-MM/1.4.1 OpenSSL/0.9.8b

HTTP/1.1 200 OK
Date: Sun, 05 Aug 2007 19:16:44 GMT
Server: Apache
Content-Length: 2121
Connection: close
Content-Type: text/html

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;Index of /&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
&lt;h1&gt;Index of /&lt;/h1&gt;
&lt;pre&gt;&lt;img src="/icons/blank.gif" alt="Icon "&gt; &lt;a href="?C=N;O=D"&gt;Name&lt;/a&gt;                    &lt;a href="?C=M;O=A"&gt;Last modified&lt;/a&gt;      &lt;a href="?C=S;O=A"&gt;Size&lt;/a&gt;  &lt;a href="?C=D;O=A"&gt;Description&lt;/a&gt;&lt;hr&gt;&lt;img src="/icons/folder.gif" alt="[DIR]"&gt; &lt;a href="202-vorbereitung/"&gt;202-vorbereitung/&lt;/a&gt;       06-Jul-2007 14:31    -   
&lt;img src="/icons/layout.gif" alt="[   ]"&gt; &lt;a href="Efficient_Video_on_demand_over_Multicast.pdf"&gt;Efficient_Video_on_d..&amp;gt;&lt;/a&gt; 19-Dec-2006 03:17  291K  
&lt;img src="/icons/unknown.gif" alt="[   ]"&gt; &lt;a href="Welcome%20Stranger!!!"&gt;Welcome Stranger!!!&lt;/a&gt;     28-Dec-2006 03:46    0   
&lt;img src="/icons/text.gif" alt="[TXT]"&gt; &lt;a href="barschel.htm"&gt;barschel.htm&lt;/a&gt;            31-Jul-2007 02:21   44K  
&lt;img src="/icons/folder.gif" alt="[DIR]"&gt; &lt;a href="bnd/"&gt;bnd/&lt;/a&gt;                    30-Dec-2006 08:59    -   
&lt;img src="/icons/folder.gif" alt="[DIR]"&gt; &lt;a href="cia/"&gt;cia/&lt;/a&gt;                    28-Jun-2007 00:04    -   
&lt;img src="/icons/layout.gif" alt="[   ]"&gt; &lt;a href="cisco_ccna_640-801_command_reference_guide.pdf"&gt;cisco_ccna_640-801_c..&amp;gt;&lt;/a&gt; 28-Dec-2006 03:48  236K  
&lt;img src="/icons/folder.gif" alt="[DIR]"&gt; &lt;a href="doc/"&gt;doc/&lt;/a&gt;                    19-Sep-2006 01:43    -   
&lt;img src="/icons/folder.gif" alt="[DIR]"&gt; &lt;a href="freenetproto/"&gt;freenetproto/&lt;/a&gt;           06-Dec-2006 09:00    -   
&lt;img src="/icons/folder.gif" alt="[DIR]"&gt; &lt;a href="korrupt/"&gt;korrupt/&lt;/a&gt;                03-Jul-2007 11:57    -   
&lt;img src="/icons/folder.gif" alt="[DIR]"&gt; &lt;a href="mp3_technosets/"&gt;mp3_technosets/&lt;/a&gt;         04-Jul-2007 08:56    -   
&lt;img src="/icons/text.gif" alt="[TXT]"&gt; &lt;a href="neues_von_rainald_goetz.htm"&gt;neues_von_rainald_go..&amp;gt;&lt;/a&gt; 21-Mar-2007 23:27   31K  
&lt;img src="/icons/text.gif" alt="[TXT]"&gt; &lt;a href="neues_von_rainald_goetz0.htm"&gt;neues_von_rainald_go..&amp;gt;&lt;/a&gt; 21-Mar-2007 23:29   36K  
&lt;img src="/icons/layout.gif" alt="[   ]"&gt; &lt;a href="pruef.pdf"&gt;pruef.pdf&lt;/a&gt;               28-Dec-2006 07:48   88K  
&lt;hr&gt;&lt;/pre&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>

<p>Chaining decoders to view flow data for a specific country code in <a href="http://wiki.wireshark.org/SampleCaptures#General_.2F_Unsorted">sample traffic</a> (note: TCP handshakes are not included in the packet count)</p>

<pre><code>Dshell&gt; decode -d country+netflow --country_code=JP ~/pcap/SkypeIRC.cap
2006-08-25 19:32:20.651502       192.168.1.2 -&gt;  202.232.205.123  (-- -&gt; JP)  UDP   60583   33436     1      0       36        0  0.0000s
2006-08-25 19:32:20.766761       192.168.1.2 -&gt;  202.232.205.123  (-- -&gt; JP)  UDP   60583   33438     1      0       36        0  0.0000s
2006-08-25 19:32:20.634046       192.168.1.2 -&gt;  202.232.205.123  (-- -&gt; JP)  UDP   60583   33435     1      0       36        0  0.0000s
2006-08-25 19:32:20.747503       192.168.1.2 -&gt;  202.232.205.123  (-- -&gt; JP)  UDP   60583   33437     1      0       36        0  0.0000s
</code></pre>

<p>Collecting netflow data for <a href="http://wiki.wireshark.org/SampleCaptures#General_.2F_Unsorted">sample traffic</a> with vlan headers, then tracking the connection to a specific IP address</p>

<pre><code>Dshell&gt; decode -d netflow ~/pcap/vlan.cap
1999-11-05 18:20:43.170500    131.151.20.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:42.063074     131.151.32.71 -&gt;   131.151.32.255  (US -&gt; US)  UDP     138     138     1      0      201        0  0.0000s
1999-11-05 18:20:43.096540     131.151.1.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:43.079765     131.151.5.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:41.521798    131.151.104.96 -&gt;  131.151.107.255  (US -&gt; US)  UDP     137     137     3      0      150        0  1.5020s
1999-11-05 18:20:43.087010     131.151.6.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:43.368210   131.151.111.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:43.250410    131.151.32.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:43.115330    131.151.10.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:43.375145   131.151.115.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:43.363348   131.151.107.254 -&gt;  255.255.255.255  (US -&gt; --)  UDP     520     520     1      0       24        0  0.0000s
1999-11-05 18:20:40.112031      131.151.5.55 -&gt;    131.151.5.255  (US -&gt; US)  UDP     138     138     1      0      201        0  0.0000s
1999-11-05 18:20:43.183825     131.151.32.79 -&gt;   131.151.32.255  (US -&gt; US)  UDP     138     138     1      0      201        0  0.0000s
</code></pre>
</article>
  </div></body></html>