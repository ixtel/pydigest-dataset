<html><body><div><div class="entry-content">

                

                <p>Коротко: <code>all</code> и <code>any</code> - встроенные методы, которые позволяют проверять все элементов списка на выполнение условия.</p>
<p>При валидации данных часто возникает задача проверить структуру на корректность.
Например, пускай есть список словарей:</p>
<div class="highlight"><pre>data = 
[
    {
        'title': "Super page",
        'description': "Super puper page",
        'id': 'page_super',
        'data': {}
    },
    {
        'title': "Super super page",
        'description': "Super puper page2",
        'id': 'page_super_super',
        'data': {}
    },
]
</pre></div>


<p>И надо проверить что во всех внутренних словарях есть все необходимые ключи.</p>
<blockquote>
<p>Как решаете такую задачу вы?</p>
</blockquote>
<p>Можно, конечно, сделать цикл, а то и двойной. Один пойдет по всем словарям, другой по внутренностям словарей, во втором цикле сделать if и проверять существование ключей. Что-то такое:</p>
<div class="highlight"><pre><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'description'</span><span class="p">,</span> <span class="s1">'id'</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">,]</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
              <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Not valid data"</span><span class="p">)</span>
</pre></div>


<p>Получается простой и понятный код, только вложенность большая.
Можно сократить этот код и воспользоваться встроенными методами - <code>all</code>.</p>
<p>Встроенная функция <code>all</code> - идет по списку True/False (выражения которые сводятся к этим значениям) и прекращает проверку после первого элемента, не удовлетворяющего условию. 
Тогда наш код, на проверку существования ключей можно записать с помощью списковых исключений</p>
<div class="highlight"><pre><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span> <span class="p">[</span><span class="n">key</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span> <span class="p">]</span> <span class="p">):</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Not valid data"</span><span class="p">)</span>
</pre></div>


<p>Идейно ничего не поменялось, а вот вложенность уменьшилась.</p>
<p>А что если надо не "все", а "хотя бы один". Здесь на помощь приходит <code>any</code>.
Допустим, нам надо проверить, выполняется ли условие хотя бы для одного элемента</p>
<p>Без <code>any</code>:</p>
<div class="highlight"><pre><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>
<span class="k">if</span> <span class="p">[</span><span class="n">number</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span> <span class="k">if</span> <span class="n">number</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">]:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'At least one element is over 10'</span><span class="p">)</span>
</pre></div>


<p>с <code>any</code>:</p>
<div class="highlight"><pre><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>
<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">number</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'Success'</span><span class="p">)</span>
</pre></div>


<p>P.S. в примере с <code>all</code> можно написать еще короче:</p>
<div class="highlight"><pre><span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span> <span class="p">[</span><span class="n">key</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span> <span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Not valid data"</span><span class="p">)</span>
</pre></div>
            </div>
            
    </div></body></html>