<html><body><div><article class="markdown-body entry-content" itemprop="text"><h2><a id="user-content-tracker" class="anchor" href="#tracker" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>tracker</h2>

<p>A time machine for debugging pesky stateful errors.</p>

<h2><a id="user-content-motivation" class="anchor" href="#motivation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Motivation</h2>

<p>It's not always clear what lines of code introduce ugly bugs.  By walking through modifications to an object's state step by step, <code>tracker</code> makes it simpler to debug where the flaws in your logic lie.</p>

<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>

<p>Tracker is conveniently available via pip:</p>



<p>or installable via git clone and setup.py</p>

<div class="highlight highlight-source-shell"><pre>git clone git@github.com:madisonmay/tracker.git
python setup.py install</pre></div>

<p>To ensure Tracker is properly installed, you can run the unittest suite from the project root:</p>



<h2><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h2>

<p>Tracker uses class decorators to specify a list of attributes to monitor as a program executes.  Let's walk through an example with a bit of code designed to implement a simple balance sheet and see how <code>tracker</code> might help hunt down a bug in some sample code.  See the <code>examples</code> directory for runnable code snippets.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> tracker <span class="pl-k">import</span> tracked

<span class="pl-en">@tracked</span>(<span class="pl-s"><span class="pl-pds">'</span>balance<span class="pl-pds">'</span></span>)
<span class="pl-k">class</span> <span class="pl-en">BalanceSheet</span>(<span class="pl-c1">object</span>):

    <span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">balance</span><span class="pl-k">=</span><span class="pl-c1">0</span>):
        <span class="pl-v">self</span>.balance <span class="pl-k">=</span> balance

    <span class="pl-k">def</span> <span class="pl-en">add_expense</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">value</span>):
        <span class="pl-v">self</span>.balance <span class="pl-k">-=</span> value

    <span class="pl-k">def</span> <span class="pl-en">deposit</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">value</span>):
        <span class="pl-v">self</span>.balance <span class="pl-k">+=</span> value</pre></div>

<p>Now let's add some simple erroneous code to demonstrate the usefulness of <code>tracker</code>. Let's imagine for a minute that a second developer working on the balance sheet project misunderstood how the <code>BalanceSheet</code> class was intended to work, added their own syntax for direct modification of the <code>balance</code> attribute, and also included calls to the BalanceSheet's methods.  In other words, our second developer is doubling the amount of every expense and deposit.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">add_expense</span>(<span class="pl-smi">sheet</span>, <span class="pl-smi">value</span>):
    sheet.balance <span class="pl-k">-=</span> value
    sheet.add_expense(value)

<span class="pl-k">def</span> <span class="pl-en">deposit</span>(<span class="pl-smi">sheet</span>, <span class="pl-smi">value</span>):
    sheet.balance <span class="pl-k">+=</span> value
    sheet.deposit(value)</pre></div>

<p>So when the second developer goes to run a routine deposit, they see that the balance is not what they expected.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> balance_sheet <span class="pl-k">import</span> BalanceSheet, add_expense, deposit
sheet <span class="pl-k">=</span> BalanceSheet()
deposit(sheet, <span class="pl-c1">100</span>)
<span class="pl-c1">print</span> sheet.balance</pre></div>

<p>Using tracker's replay functionality, we can rewind and see what lines of code changed the sheet's balance and help our second developer uncover their simple mistake.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">for</span> snapshot <span class="pl-k">in</span> sheet.replay():
    <span class="pl-c1">print</span> snapshot</pre></div>

<p>which outputs:</p>

<pre><code>{'balance': 0}
--------------------------------------------------------------------------------
balance_sheet_debugging.py:3
  2       
  3       sheet = BalanceSheet()
  4       deposit(sheet, 100)

/home/m/Projects/Tracker/examples/balance_sheet.py:8
  7           def __init__(self):
  8               self.balance = 0
  9       


{'balance': 100}
--------------------------------------------------------------------------------
balance_sheet_debugging.py:4
  3       sheet = BalanceSheet()
  4       deposit(sheet, 100)
  5       print sheet.balance

balance_sheet.py:23
  22      def deposit(sheet, value):
  23          sheet.balance += value
  24          sheet.deposit(value)


{'balance': 200}
--------------------------------------------------------------------------------
balance_sheet_debugging.py:4
  3       sheet = BalanceSheet()
  4       deposit(sheet, 100)
  5       print sheet.balance

balance_sheet.py:24
  23          sheet.balance += value
  24          sheet.deposit(value)
  25      

balance_sheet.py:14
  13          def deposit(self, value):
  14              self.balance += value
  15      
</code></pre>

<p>Each <code>Snapshot</code> object in <code>sheet.replay()</code> has a <code>state</code> attribute (i.e. <code>{'balance': 200}</code>) and a <code>stack</code> attribute (an array of <code>Frame</code> objects).  Each <code>Frame</code> object has a <code>file</code> attribute and a <code>line</code> attribute which point to the line of code which triggered the modification.  For dead simple debugging, the <code>__str__</code> method of the <code>Snapshot</code> object outputs a human readable represenations of those values.</p>

<p>Now we can easily walk through the code that caused the double deposit and follow how the <code>balance</code> attribute changed value over time.</p>

<h2><a id="user-content-how-does-it-work" class="anchor" href="#how-does-it-work" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How does it work?</h2>

<p>Tracker patches <code>__setattr__</code> and <code>__setitem__</code> in order to record changes to variables that you've placed on a watch list.
Whenever a change is caught, the <code>inspect</code> library is used to capture the lines of code that caused the modification.  Tracker is barely over 100 lines of code long, so I encourage you to read the source for the gritty details.</p>

<h2><a id="user-content-contributions" class="anchor" href="#contributions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Contributions</h2>

<p>Tracker is a work in progress, so pull requests, critical feedback, github issues, and feedback of any kind is welcome.</p>
</article>
  </div></body></html>