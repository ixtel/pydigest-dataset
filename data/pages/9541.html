<html><body><div><div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">From <strong>the documentation</strong>:</a></p>

<blockquote>
  <p>List comprehensions provide a concise way to create lists. Common applications are to make new lists where each element is the result of some operations applied to each member of another sequence or iterable, or to create a subsequence of those elements that satisfy a certain condition.</p>
</blockquote>

<hr/>

<p>About your question, the list comprehension does the same thing as the following "plain" Python code:</p>

<pre><code>&gt;&gt;&gt; l = [] 
&gt;&gt;&gt; for x in range(10):
...     l.append(x**2)
&gt;&gt;&gt; l
[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
</code></pre>

<p>How do you write it in one line? Hmm...we can...probably...use <a href="https://docs.python.org/3/library/functions.html#map"><code>map()</code></a> with <a href="https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions"><code>lambda</code></a>:</p>

<pre><code>&gt;&gt;&gt; list(map(lambda x: x**2, range(10)))
[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
</code></pre>

<p>But isn't it clearer and simpler to just use a list comprehension?</p>

<pre><code>&gt;&gt;&gt; [x**2 for x in range(10)]
[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
</code></pre>

<hr/>

<p>Basically, we can do anything with <code>x</code>. Not only <code>x**2</code>. For example, run a method of <code>x</code>:</p>

<pre><code>&gt;&gt;&gt; [x.strip() for x in ('foo\n', 'bar\n', 'baz\n')]
['foo', 'bar', 'baz']
</code></pre>

<p>Or use <code>x</code> as another function's argument:</p>

<pre><code>&gt;&gt;&gt; [int(x) for x in ('1', '2', '3')]
[1, 2, 3]
</code></pre>

<p>We can also, for example, use <code>x</code> as the key of a <code>dict</code> object. Let's see:</p>

<pre><code>&gt;&gt;&gt; d = {'foo': '10', 'bar': '20', 'baz': '30'}
&gt;&gt;&gt; [d[x] for x in ['foo', 'baz']]
['10', '30']
</code></pre>

<p>How about a combination?  </p>

<pre><code>&gt;&gt;&gt; d = {'foo': '10', 'bar': '20', 'baz': '30'}
&gt;&gt;&gt; [int(d[x].rstrip('0')) for x in ['foo', 'baz']]
[1, 3]
</code></pre>

<p>And so on.</p>

<hr/>

<p>You can also use <code>if</code> or <code>if...else</code> in a list comprehension. For example, you only want odd numbers in <code>range(10)</code>. You can do:</p>

<pre><code>&gt;&gt;&gt; l = []
&gt;&gt;&gt; for x in range(10):
...     if x%2:
...         l.append(x)
&gt;&gt;&gt; l
[1, 3, 5, 7, 9]
</code></pre>

<p>Ah that's too complex. What about the following version?</p>

<pre><code>&gt;&gt;&gt; [x for x in range(10) if x%2]
[1, 3, 5, 7, 9]
</code></pre>

<p>To use an <code>if...else</code> ternary expression, you need put the <code>if ... else ...</code> after <code>x</code>, <strong>not</strong> after <code>range(10)</code>:</p>

<pre><code>&gt;&gt;&gt; [i if i%2 != 0 else None for i in range(10)]
[None, 1, None, 3, None, 5, None, 7, None, 9]
</code></pre>

<hr/>

<p>Have you heard about <a href="https://docs.python.org/3/tutorial/datastructures.html#nested-list-comprehensions"><strong>nested list comprehension</strong></a>? You can put <em>two or more <code>for</code>s in one list comprehension</em>. For example:</p>

<pre><code>&gt;&gt;&gt; [i for x in [[1, 2, 3], [4, 5, 6]] for i in x]
[1, 2, 3, 4, 5, 6]

&gt;&gt;&gt; [j for x in [[[1, 2], [3]], [[4, 5], [6]]] for i in x for j in i]
[1, 2, 3, 4, 5, 6]
</code></pre>

<p>Let's talk about the first part, <code>for x in [[1, 2, 3], [4, 5, 6]]</code> which gives <code>[1, 2, 3]</code> and <code>[4, 5, 6]</code>. Then, <code>for i in x</code> gives <code>1</code>, <code>2</code>, <code>3</code> and <code>4</code>, <code>5</code>, <code>6</code>. </p>

<p><strong>Warning:</strong> You always need put <code>for x in [[1, 2, 3], [4, 5, 6]]</code> <strong>before</strong> <code>for i in x</code>:</p>

<pre><code>&gt;&gt;&gt; [j for j in x for x in [[1, 2, 3], [4, 5, 6]]]
Traceback (most recent call last):
  File "&lt;input&gt;", line 1, in &lt;module&gt;
NameError: name 'x' is not defined
</code></pre>

<hr/>

<p>We also have <em>set comprehensions</em>, <em>dict comprehensions</em>, and <em>generator expressions</em>.</p>

<p><strong>set comprehensions</strong> and list comprehensions are basically the same, but the former returns a <em>set</em> instead of a <em>list</em>:</p>

<pre><code>&gt;&gt;&gt; {x for x in [1, 1, 2, 3, 3, 1]}
{1, 2, 3}
</code></pre>

<p>It's the same as:</p>

<pre><code>&gt;&gt;&gt; set([i for i in [1, 1, 2, 3, 3, 1]])
{1, 2, 3}
</code></pre>

<p>A <a href="https://www.python.org/dev/peps/pep-0274/"><strong>dict comprehension</strong></a> <em>looks like</em> a set comprehension, but it uses <code>{key: value for key, value in ...}</code> or <code>{i: i for i in ...}</code> instead of  <code>{i for i in ...}</code>.</p>

<p>For example:</p>

<pre><code>&gt;&gt;&gt; {i: i**2 for i in range(5)}
{0: 0, 1: 1, 2: 4, 3: 9, 4: 16}
</code></pre>

<p>And it equals:</p>

<pre><code>&gt;&gt;&gt; d = {}
&gt;&gt;&gt; for i in range(5):
...     d[i] = i**2
&gt;&gt;&gt; d
{0: 0, 1: 1, 2: 4, 3: 9, 4: 16}
</code></pre>

<p>Does <code>(i for i in range(5))</code> give a <em>tuple</em>? No!, it's a <a href="https://www.python.org/dev/peps/pep-0289/"><strong>generator expression</strong></a>. Which returns a <strong>generator</strong>:</p>

<pre><code>&gt;&gt;&gt; (i for i in range(5))
&lt;generator object &lt;genexpr&gt; at 0x7f52703fbca8&gt;
</code></pre>

<p>It's the same as:</p>

<pre><code>&gt;&gt;&gt; def gen():
...     for i in range(5):
...         yield i
&gt;&gt;&gt; gen()
&lt;generator object gen at 0x7f5270380db0&gt;
</code></pre>

<p>And you can use it as a generator:</p>

<pre><code>&gt;&gt;&gt; gen = (i for i in range(5))
&gt;&gt;&gt; next(gen)
0
&gt;&gt;&gt; next(gen)
1
&gt;&gt;&gt; list(gen)
[2, 3, 4]
&gt;&gt;&gt; next(gen)
Traceback (most recent call last):
  File "&lt;input&gt;", line 1, in &lt;module&gt;
StopIteration
</code></pre>

<p><strong>Note:</strong> If you use a list comprehension <em>inside a function</em>, you don't need the <code>[]</code> if that function could loop over a generator. For example, <a href="https://docs.python.org/3/library/functions.html#sum"><code>sum()</code></a>:</p>

<pre><code>&gt;&gt;&gt; sum(i**2 for i in range(5))
30
</code></pre>

<p><strong>Related</strong> (about generators): <a href="http://stackoverflow.com/questions/1756096/understanding-generators-in-python">Understanding Generators in Python</a>.</p>
    </div>
    </div></body></html>