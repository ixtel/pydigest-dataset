<html><body><div><div class="post-text" itemprop="text">
<h2>Overview:</h2>

<p>The manual build you're trying looks like it might be failing because it's referencing the OS X 10.6 SDK, which you likely don't have, and is outdated for the most part. Also, SDKs are now stored in a completely different location than when the 10.6 SDK was in it's prime.</p>

<p><strong>New SDKs location:</strong></p>

<pre><code>/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/
</code></pre>

<p><strong>Old SDKs location:</strong></p>

<pre><code>/Developer/SDKs/
</code></pre>

<h2>Non-existent / outdated SDK:</h2>

<p>Since it appears that when trying to build PyCrypto it's referencing the <code>MacOSX10.6.sdk</code> there are several things to consider:</p>

<ol>
<li>Why does it reference an outdated SDK</li>
<li>Where is the SDK it's referencing set</li>
<li>What should be done to correct the issue</li>
</ol>

<p>Unless we audit the source code carefully we might not know exactly where the incorrect flags are set, but we can do our best to work with the information we have. From the error we can see that there are several instances where the 10.6 SDK's name pops up:</p>

<pre><code>/usr/bin/clang -fno-strict-aliasing -fno-common -dynamic -isysroot /Developer/SDKs/MacOSX10.6.sdk -arch i386 -arch x86_64 -fwrapv -Wall -Wstrict-prototypes -std=c99 -O3 -fomit-frame-pointer -Isrc/ -I/Library
</code></pre>

<p><strong>Building from source:</strong></p>

<pre><code>/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c src/MD2.c -o build/temp.macosx-10.6-intel-2.7/src/MD2.o
src/MD2.c:30:10: fatal error: 'string.h' file not found
#include &lt;string.h&gt;
                 ^
1 error generated.
error: command '/usr/bin/clang' failed with exit status 1
</code></pre>

<p>Analyzing this we can see that the PyCrypto's MD2.c file is trying to be built using the flag <code>-isysroot /Developer/SDKs/MacOSX10.6.sdk</code>. It might be worth trying <code>pip</code> instead:</p>

<p><strong>Installing with pip:</strong></p>

<pre><code>...
fatal error: 'string.h' file not found #include &lt;string.h&gt;
...
</code></pre>

<p>Same error; we should probably find out if the <code>&lt;string.h&gt;</code> header even exists on the system — Let's make a quick test <code>C</code> application to find out:</p>

<p><strong>Testing the C headers:</strong></p>

<pre><code>$ echo "#include &lt;string.h&gt;
#include &lt;stdio.h&gt;
int main() { printf(\"TEST\n\"); return 0; }" &gt; t.c
$ clang t.c -o t
$ ./t
TEST
</code></pre>

<p>It's apparent the header does exist because the test worked fine. This tells us that the problem is more likely related directly to the 10.6 SDK (which doesn't seem to exist on the system). </p>

<p><strong>Symlinking (non-existing) 10.6 SDK to 10.11 SDK:</strong></p>

<p>Since we haven't determined where the SDK is actually getting set we'll go ahead and try to create symlinks so that any reference of the old 10.6 SDK links to the latest SDK (10.11 at this time):</p>

<pre><code>$ cd /Developer/SDKs
$ sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk MacOSX10.6.sdk
</code></pre>

<p>We can verify the symlink by issuing the following command: </p>

<pre><code>$ ls -lat
total 8
drwxr-xr-x  3 root  wheel  102 Feb 21 15:54 .
lrwxr-xr-x  1 root  wheel   99 Feb 21 15:54 MacOSX10.6.sdk -&gt; /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk
drwxr-xr-x  3 root  wheel  102 Feb 21 15:52 ..
</code></pre>

<p>Now that we've successfully created the symlink let's try installing PyCrypto with pip once more:</p>

<pre><code>$ sudo pip install pycrypto
Collecting pycrypto
  Downloading pycrypto-2.6.1.tar.gz (446kB)
    100% |████████████████████████████████| 446kB 1.2GB/s 
Installing collected packages: pycrypto
  Running setup.py install for pycrypto ... done
Successfully installed pycrypto-2.6.1
</code></pre>

<blockquote>
  <p>No errors! It looks like our problem is solved! Well, almost...</p>
</blockquote>

<p>We still need to figure out what is responsible for setting the wrong (10.6) SDK during builds. Let's use the <code>xcrun</code> tool to see what the defaults are set at:</p>

<pre><code>$ xcrun --show-sdk-version
10.11
</code></pre>

<p>The system default SDK is set to 10.11, so it must be get set incorrectly to 10.6 by Python, PyCrypto, or some other anomaly we might not have considered. </p>

<h2>UPDATE:</h2>

<p>After doing some recon it was discovered that <a href="https://www.python.org/downloads/release/python-351/" rel="nofollow">Python 3</a> appears to be built with the OS X 10.6 SDK. In addition it's also setting the SDK to 10.6 and setting the (outdated) path in numerous places throughout the <code>Python_Framework</code>. There are so many references I won't bother listing them all, although here's an example:</p>

<pre><code>Python_Framework Folder/Versions/3.5/lib/python3.5/config-3.5m/Makefile:79:CONFIGURE_CFLAGS= -arch i386 -arch x86_64 -isysroot /Developer/SDKs/MacOSX10.6.sdk
</code></pre>

<p><em>I can only assume the developers were trying to be as backward compatible as possible, however, it's unfortunately breaking forward compatibility in the process.</em></p>

<hr/>

<p><strong>Notes:</strong> </p>

<p>Installing Python packages with <strong><a href="https://pypi.python.org/pypi/pip" rel="nofollow"><code>pip</code></a></strong> can make life much easier in a lot of ways (package management, updating, uninstalling, etc.). For example installing PyCrypto should just be a matter of issuing the command:</p>

<pre><code>$ sudo pip install pycrypto
</code></pre>

<p>If you have <a href="http://stackoverflow.com/questions/2812520/pip-dealing-with-multiple-python-versions">multiple Python's</a> you can use the version number to install for that Python accordingly:</p>

<pre><code>$ sudo pip3.5 install pycrypto
</code></pre>

<p>↳ <a href="https://pip.pypa.io/en/stable/installing/" rel="nofollow">https://pip.pypa.io/en/stable/installing/</a></p>
    </div>
    </div></body></html>