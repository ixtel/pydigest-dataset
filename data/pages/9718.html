<html><body><div><div class="section">
              <h1>cpymad 0.13.0</h1>

              


<p>Cython binding to MAD-X</p>








<p><a href="https://pypi.python.org/pypi/cpymad/" rel="nofollow"><img src="http://coldfix.de:8080/v/cpymad/badge.svg"/>
</a> <a href="https://pypi.python.org/pypi/cpymad#downloads" rel="nofollow"><img src="http://coldfix.de:8080/d/cpymad/badge.svg"/>
</a> <a href="https://github.com/hibtc/cpymad/blob/master/COPYING.rst" rel="nofollow"><img src="http://img.shields.io/badge/license-CC0,_Apache,_Non--Free-red.svg"/>
</a> <a href="https://pypi.python.org/pypi/cpymad#downloads" rel="nofollow"><img src="http://coldfix.de:8080/py_versions/cpymad/badge.svg"/>
</a></p>
<p>CPyMAD is a <a href="http://cython.org/" rel="nofollow">Cython</a> binding to <a href="http://cern.ch/mad" rel="nofollow">MAD-X</a>.</p>
<p>MAD-X is a software package to simulate particle accelerators and is used
at CERN and all around the world. It has its own proprietary scripting
language and is usually launched from the command line.</p>
<p>This version of CPyMAD is tested with MAD-X 5.02.08. Other MAD-X
versions (and immediate revisions) might work too, but are more likely to
cause problems.</p>
<p>The installable wheel archives that are provided for some versions of
python to simplify the installation on windows contain a precompiled
version of CPyMAD that is statically linked against MAD-X 5.02.08.</p>
<div id="disclaimer">
<h2>Disclaimer</h2>
<p>This is a heavily modified fork of the <a href="https://github.com/pymad/cpymad" rel="nofollow">cern-cpymad</a> package. The fork is
not authored or maintained by CERN members.</p>
<p>CPyMAD links against an unofficial build of MAD-X that is not supported by
CERN, i.e. this binary may have problems that the official binary does not
have and vice versa. This means:</p>
<ul>
<li>Only report issues to CERN that can be reproduced with their official
command line client.</li>
<li>Only report issues here if they cannot be reproduced with their official
command line client.</li>
</ul>
<p>See <a href="#reporting-issues" rel="nofollow">Reporting issues</a>.</p>
</div>

<div id="usage">
<h2>Usage</h2>
<p>The <tt>Madx</tt> class provides a basic binding to the MAD-X interpreter:</p>
<pre><span class="kn">from</span> <span class="nn">cpymad.madx</span> <span class="kn">import</span> <span class="n">Madx</span>

<span class="c1"># Start a MAD-X interpretor. All MAD-X commands issued via cpymad will</span>
<span class="c1"># be logged to `command_log`:</span>
<span class="n">madx</span> <span class="o">=</span> <span class="n">Madx</span><span class="p">(</span><span class="n">command_log</span><span class="o">=</span><span class="s2">"log.madx"</span><span class="p">)</span>

<span class="c1"># Show the version of MAD-X that is actually loaded:</span>
<span class="k">print</span><span class="p">(</span><span class="n">madx</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>

<span class="c1"># Execute one of your predefined MAD-X files:</span>
<span class="n">madx</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">'/path/to/some/input_file.madx'</span><span class="p">)</span>

<span class="c1"># Only a handful of MAD-X methods are exposed as methods. For others,</span>
<span class="c1"># you can use the `command` attribute. For example, to set a beam:</span>
<span class="n">madx</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="s1">'myseq1'</span><span class="p">,</span> <span class="n">particle</span><span class="o">=</span><span class="s1">'PROTON'</span><span class="p">)</span>

<span class="c1"># Calculate TWISS parameters:</span>
<span class="n">twiss</span> <span class="o">=</span> <span class="n">madx</span><span class="o">.</span><span class="n">twiss</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="s1">'LEBT'</span><span class="p">,</span>
                   <span class="n">betx</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">bety</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                   <span class="n">alfx</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alfy</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Your own analysis below:</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">twiss</span><span class="p">[</span><span class="s1">'s'</span><span class="p">],</span> <span class="n">twiss</span><span class="p">[</span><span class="s1">'betx'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<p>There are alternative syntaxes for the extreme cases where you need more
fine grained control over the command string composition or where
<tt>command</tt> fails to do the right thing:</p>
<pre><span class="c1"># can't use `global` as attribute, since it's a python keyword:</span>
<span class="n">madx</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">global_</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="s1">'cassps'</span><span class="p">,</span> <span class="n">Q1</span><span class="o">=</span><span class="mf">26.58</span><span class="p">)</span>

<span class="c1"># can't use `: ` as attribute:</span>
<span class="n">madx</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">'QP: QUADRUPOLE'</span><span class="p">,</span> <span class="n">AT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># issue a plain text command, don't forget the semicolon!</span>
<span class="n">madx</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">'FOO, BAR=[baz], QUX=&lt;NORF&gt;;'</span><span class="p">)</span>
</pre>
<p>See <a href="http://hibtc.github.io/cpymad" rel="nofollow">http://hibtc.github.io/cpymad</a> for further documentation.</p>
</div>
<div id="known-issues">
<h2>Known issues</h2>
<p>On windows with python3.3, there is currently no satisfying way to close file
handles in the MAD-X process or prevent them from being inherited by default.
You have to make sure on your own that you close all file handles before
creating a new <tt>cpymad.madx.Madx</tt> instance!</p>
</div>
<div id="hacking">
<h2>Hacking</h2>
<p>Try to be consistent with the <a href="http://www.python.org/dev/peps/pep-0008/" rel="nofollow">PEP8</a> guidelines. Add <a href="http://docs.python.org/2/library/unittest.html" rel="nofollow">unit tests</a> for all
non-trivial functionality. <a href="http://www.youtube.com/watch?v=RlfLCWKxHJ0" rel="nofollow">Dependency injection</a> is a great pattern to
keep modules testable.</p>
<p>Commits should be reversible, independent units if possible. Use descriptive
titles and also add an explaining commit message unless the modification is
trivial. See also: <a href="http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html" rel="nofollow">A Note About Git Commit Messages</a>.</p>
</div>
<div id="reporting-issues">
<h2>Reporting issues</h2>
<p>If you have a problem with a sequence file, first try to check if that
problem remains when using the MAD-X command line client distributed by
CERN, then:</p>
<ul>
<li>Report the issue to CERN only if it be reproduced with their official
command line client.</li>
<li>Report the issue here only if it cannot be reproduced with their official
command line client.</li>
</ul>
<p>For issues regarding the cpymad code itself or usage information, I’m happy to
answer. Just keep in mind to be <strong>precise</strong>, <strong>specific</strong>, <strong>concise</strong> and
provide all the necessary information.</p>
<p>See also:</p>

</div>
<div id="tests">
<h2>Tests</h2>
<p>Currently, tests run on:</p>
<ul>
<li><p>The <a href="https://travis-ci.org/hibtc/cpymad" rel="nofollow">Travis CI</a> service is mainly used to check that the unit tests for
pymad itself execute on several python versions. Python{2.7,3.3} are
supported. The tests are executed on any update of an upstream branch.
The Travis builds use a unofficial precompiled <a href="https://github.com/hibtc/madx-debian" rel="nofollow">libmadx-dev</a> package to
avoid having to rebuild the entire MAD-X library on each invocation.</p>
<p><a href="https://travis-ci.org/hibtc/cpymad" rel="nofollow"><img src="https://api.travis-ci.org/hibtc/cpymad.svg?branch=master"/></a> <a href="https://coveralls.io/r/hibtc/cpymad" rel="nofollow"><img src="https://coveralls.io/repos/hibtc/cpymad/badge.svg?branch=master"/></a></p>
</li>
</ul>
</div>
<div id="license">
<h2>License</h2>
<p>CPyMAD must be used in compliance with the licenses as described in the
following sections:</p>
<div id="license-for-cpymad-source">
<h3>License for CPyMAD source</h3>
<p>applies to the python source of the CPyMAD package:</p>
<pre>Copyright (c) 2013-2015, HIT - Heidelberg Ion-Therapy Center

To the extent possible under law, the person who associated CC0 with
CPyMAD has waived all copyright and related or neighboring rights to
CPyMAD.

You should have received a copy of the CC0 legalcode along with this
work. If not, see &lt;http://creativecommons.org/publicdomain/zero/1.0/&gt;.
</pre>
<p>Note that this package is a heavily modified fork of the original
cern-cpymad package developed at CERN:</p>
<pre>Copyright (c) 2011, CERN. All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use cern-cpymad except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</pre>
<p>For details, see the version history or ask the package maintainer.</p>
</div>
<div id="license-for-mad-x">
<h3>License for MAD-X</h3>
<p>applies to binary distributions that do not require a separate
installation of MAD-X, i.e. binaries that are statically linked to MAD-X:</p>
<pre>CERN

EUROPEAN ORGANISATION FOR NUCLEAR RESEARCH


Program name:                 MAD --- Methodical Accelerator Design

CERN program library entry:   T5001

Authors or contacts:          mad@cern.ch
                              BE-ABP Group
                              CERN
                              CH-1211 GENEVA 23
                              SWITZERLAND


Copyright CERN, Geneva 1990 - Copyright and any other appropriate legal
protection of this computer program and associated documentation reserved
in all countries of the world. Organisations collaborating with CERN may
receive this program and documentation freely and without charge. CERN
undertakes no obligation for the maintenance of this program, nor
responsibility for its correctness, and accepts no liability whatsoever
resulting from its use. Program and documentation are provided solely for
the use of the organisation to which they are distributed. This program
may not be copied or otherwise distributed without permission. This
message must be retained on this and any other authorised copies. The
material cannot be sold. CERN should be given credit in all references.
</pre>
</div>
</div>
<div id="changelog">
<h2>Changelog</h2>
<p>(dates are in the form dd.mm.yyyy)</p>
<div id="id1">
<h3>0.13.0</h3>
<p>Date: 24.01.2016</p>
<ul>
<li><dl>
<dt>Update to <tt><span class="pre">MAD-X</span> 5.02.08</tt>:</dt>
<dd><ul>
<li>official support</li>
<li>automatic tests</li>
<li>prebuilt binaries on PyPI (for windows)</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>

<div id="id3">
<h3>0.12.1</h3>
<p>Date: 13.10.2015</p>
<ul>
<li>fix crash due to incorrect parameter name for <tt>logging.basicConfig</tt></li>
<li>fix crash due to missing <tt>subprocess.MAXFD</tt> on python3.5</li>
<li>fix coverage report submitted to coveralls.io</li>
</ul>
</div>
<div id="id4">
<h3>0.12.0</h3>
<p>Date: 05.10.2015</p>
<ul>
<li>expose directory of global MAD-X variables as <tt>Madx.globals</tt></li>
<li>expose directory of global MAD-X elements as <tt>Madx.elements</tt></li>
<li>fix a bug with Elements.__contains__ reporting yes incorrectly</li>
<li>list only those column of a table that are marked for output</li>
<li>add function to get row names of a table</li>
</ul>
</div>
<div id="id5">
<h3>0.11.0</h3>
<p>Date: 03.07.2015</p>
<ul>
<li>Remove models + resource handling from cpymad. If you need these, check
them out from the previous version and maintain them in your own code
base. This way you are much more flexible to adapt models to your needs.</li>
</ul>
</div>
<div id="id6">
<h3>0.10.8</h3>
<p>Date: 02.07.2015</p>
<ul>
<li>Public element names are now of the form “foo[3]” or simply “foo”. The
syntax “foo:d” can not be used anymore (this form is used by MAD-X only
internally and converted at the lowest wrapper level).</li>
<li>Fix exception when not specifying sequence name on Madx methods</li>
</ul>
</div>
<div id="id7">
<h3>0.10.7</h3>
<p>Date: 21.06.2015</p>
<ul>
<li>allow redirection of MAD-X standard I/O via Madx constructor</li>
</ul>
</div>
<div id="id8">
<h3>0.10.6</h3>
<p>Date: 29.05.2015</p>
<ul>
<li>add csv() method for ResourceProvider</li>
<li>use C loader from yaml for performance if available</li>
<li>convert madx.metadata.get_copyright_notice</li>
<li>add accessors to real sequence + elements for model.Sequence</li>
</ul>
</div>
<div id="id9">
<h3>0.10.5</h3>
<p>Date: 25.05.2015</p>
<ul>
<li>add MAD-X specific metadata in cpymad.madx.metadata</li>
<li>speedup Travis testing (using caches and docker containers)</li>
</ul>
</div>
<div id="id10">
<h3>0.10.4</h3>
<p>Date: 22.04.2015</p>
<ul>
<li>prevent MAD-X process from exiting on Ctrl-C (this was an especially
nasty feature when using the interactive python interpretor)</li>
<li>upgrade to <a href="http://madx.web.cern.ch/madx/releases/5.02.05/" rel="nofollow">MAD-X 5.02.05</a> (development release from 10.04.2015)</li>
<li>fix leakage of open file handles into remote process on py2/windows</li>
</ul>
</div>
<div id="id11">
<h3>0.10.3</h3>
<p>Date: 29.03.2015</p>
<ul>
<li>make sequence.elements.index more convenient: can now handle names with or
without the ‘:d’ suffix as well as the special names ‘#s’ and ‘#e’</li>
</ul>
</div>
<div id="id12">
<h3>0.10.2</h3>
<p>Date: 05.03.2015</p>
<ul>
<li>add some utility functions to work with MAD-X element names and identifiers</li>
<li>add a setter method for values to Madx</li>
<li>improve install instructions. In particular, recommend WinPython as build
environment</li>
<li>fix the MinGW build error due to broken sysconfig inline</li>
<li>run setup only if invoked as main script</li>
</ul>
</div>
<div id="id13">
<h3>0.10.1</h3>
<p>Date: 09.01.2015</p>
<ul>
<li>convert IOError to RemoteProcessCrashed, which can occur on transmission
if the remote process is already down</li>
<li>convert ValueError to RemoteProcessClosed, which can occur on transmission
if the remote process was already closed</li>
</ul>
</div>
<div id="fork">
<h3>0.10.0 Fork</h3>
<p>Date: 09.01.2015</p>
<p>This is the first independent version released for the <a href="https://github.com/hibtc/cpymad" rel="nofollow">HIT cpymad fork</a>.
The changes on the public API are so heavy, that this is basically a new
library.</p>
<ul>
<li>rename package from <tt>cern.cpymad</tt> to <tt>cpymad</tt></li>
<li>remove LHC models from repository</li>
<li>redesign API to make more use of OOP (no stable API yet!)</li>
<li>removed some obsolete / unused modules</li>
</ul>
</div>
<div id="id14">
<h3>0.9</h3>
<p>Date: 17.11.2014</p>
<ul>
<li>don’t link against numpy anymore (this makes distribution of prebuilt
binaries on windows actually useful)</li>
<li>add MAD-X license notice (required to distribute binaries)</li>
<li>setup.py doesn’t require setuptools to be pre-installed anymore (if
internet is available)</li>
<li>some doc-fixes</li>
<li>convert cpymad._couch to a simple module (was a single file package)</li>
<li>use <tt>logging</tt> through-out the project</li>
<li>alow logger to be specified as model/madx constructor argument</li>
<li>multi-column access, e.g.: <tt><span class="pre">table.columns['betx','bety']</span></tt></li>
<li>move tests one folder level up</li>
</ul>
</div>
<div id="id15">
<h3>0.8</h3>
<p>Date: 30.06.2014</p>
<ul>
<li>isolate cpymad: remove jpymad backend, remove pymad base</li>
<li>bootstrap the dependency on numpy</li>
<li>remove custom MAD-X path discovery during setup. You should use
<em>–madxdir</em> if the library is not installed in a system location.</li>
<li>add function <tt>libmadx.is_expanded</tt></li>
<li>add function <tt>libmadx.chdir</tt></li>
<li>handle MAD-X table columns with integer arrays</li>
<li>make <tt>madx.command</tt> more powerful (allows <tt>**kwargs</tt> and attribute
access)</li>
<li>use inherited pipes for IPC with remote MAD-X processes (allows to
forward stdin/stdout separately)</li>
<li>close connection to remote process on finalization of <tt>LibMadxClient</tt></li>
<li>remove MAD-X command checks, <tt>recursive_history</tt> and filename
completion</li>
<li>fix name clash</li>
<li>fix some bugs</li>
<li>rename convenience constructors to <tt>cern.cpymad.load_model</tt> and
<tt>cern.cpymad.start_madx</tt> due to name clash with module names</li>
</ul>
</div>
<div id="id16">
<h3>0.7</h3>
<p>Date: 16.04.2014</p>
<ul>
<li>close handles in remote process properly on all supported python versions</li>
<li>rewrite <tt>libmadx.get_table</tt> functionality</li>
<li>madx functions that return tables now return proxy objects instead. For
backward compatibility these can be iterated to allow unpacking into a tuple</li>
<li>the returned table columns is now a proxy object as well and not <tt>TfsTable</tt></li>
<li>remove <tt>retdict</tt> parameter</li>
<li>move some cpymad specific functionality into the cpymad package</li>
<li>add libmadx/madx functions to access list of elements in a sequence</li>
</ul>
</div>
<div id="id17">
<h3>0.6</h3>
<p>Date: 17.03.2014</p>
<ul>
<li>raise exception and don’t hang up anymore, if libmadx process crashes</li>
<li>on python&gt;=3.4, close handles in remote process properly</li>
<li>let every ‘Madx’ instance have an independent copy of the madx library.
this makes the madx module much more useful. previously, this was only
true for instances of ‘cpymad.model’.</li>
<li>restrict to only one cython module that links to libmadx. (allows static
linking which is advantageous on windows!)</li>
<li>use YAML model files instead of JSON</li>
<li>make ‘madx’ a submodule of ‘cpymad’</li>
<li>fix test exit status</li>
</ul>
</div>
<div id="id18">
<h3>0.5</h3>
<p>Date: 21.01.2014</p>
<ul>
<li>migrate to setuptools from distutils</li>
<li>python3 support</li>
<li>add continuous integration with Travis</li>
<li>proper setup.py and MANIFEST.in to be used with PyPI</li>
<li>rename package to ‘cern-pymad’</li>
<li>allow to build from PyPI without having cython</li>
</ul>
</div>
</div>


<a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>1605</span> downloads in the last week
  </li>
  <li>
    <span>10029</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>