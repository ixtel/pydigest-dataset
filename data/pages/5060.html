<html><body><div><div class="post">
<h1 class="post-title">Electron as GUI of Python Applications</h1>
<span class="post-date">21 Jun 2015</span>
<h2 id="what">what</h2>
<p><a href="http://electron.atom.io/">Electron</a> (formerly Atom Shell) is a desktop node.js-powered “shell”. It is designed by Github and used to build <a href="https://atom.io/">Atom Editor</a>.</p>
<p>Python is a simple and powerful programming language.</p>
<p>This post is a note about how to use Electron as the desktop GUI for Python applications.</p>
<h2 id="but-why">but why?</h2>
<p>Building desktop applications with Python is not easy.</p>
<p><a href="https://wiki.python.org/moin/TkInter">Tkinter</a> is the standard package for Python GUI, but it is ~~very~~ ugly.</p>
<p>The only mature and real-world solution is <a href="http://www.qt.io/developers/">QT</a>, with Python package <a href="https://wiki.qt.io/Category:LanguageBindings::PySide">PySide</a> or <a href="http://www.riverbankcomputing.co.uk/software/pyqt/intro">PyQT</a>, and <a href="https://github.com/nucleic/enaml">Enaml</a> based on that. However, PySide seems to have died, and PyQT is not free for commercial usages.</p>
<p><a href="http://ipython.org/">IPython</a>, an enhanced shell for Python, has an interesting design: it has kernal, a <code class="highlighter-rouge">qtconsole</code> powered by QT, and <code class="highlighter-rouge">notebook</code> powered by web pages.</p>
<p>So I was thinking, why not use Electron as the “GUI shell” for the Python applications by embedding web pages? It is free, and hopefully elegant.</p>
<h2 id="the-architecture">the architecture</h2>
<p>The basic idea is rather simple:</p>
<p>The first way: Electron as the “launcher and minimal web browser”, loading the web pages dynamically generated by Python, where behind the web pages Python does all the heavy lifting.</p>
<p>The second way: Electron as the “launcher and minimal web browser”, loading the web pages statically written (the static files <code class="highlighter-rouge">index.html</code>, etc), where these pages communicate with Python by restful api or something like zeromq.</p>
<p>The first way is easy to understand and implemented, while the second way seems to provide more protentials.</p>
<p>After that, we could use <code class="highlighter-rouge">PyInstaller</code> to package the Python files, then use the built-in method of Electron to package all the HTML, CSS, Javascript files and Python binaries together. In the end we are able to distribute the generated binary files. Although we should notice that it may be easy to extract the souce codes in the distributed files.</p>
<h2 id="a-complete-example">a complete example</h2>
<p>This is the example modified from the “hello world” of Electron, implementing the first way mentioned above. Nothing magic. The key point is to create a child process to run the python script and load the “home page” generated.</p>
<p>Install Python, node.js, then</p>
<div class="highlighter-rouge"><pre class="highlight"><code>pip install Flask
npm install electron-prebuilt -g
npm install request-promise -g
</code></pre>
</div>
<p>Then create a working directory. <code class="highlighter-rouge">cd</code> to the directory.</p>
<p>We need a basic <code class="highlighter-rouge">package.json</code>:</p>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
  <span class="s2">"name"</span>    <span class="err">:</span> <span class="s2">"your-app"</span><span class="p">,</span>
  <span class="s2">"version"</span> <span class="err">:</span> <span class="s2">"0.1.0"</span><span class="p">,</span>
  <span class="s2">"main"</span>    <span class="err">:</span> <span class="s2">"main.js"</span><span class="p">,</span>
  <span class="s2">"dependencies"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"request-promise"</span><span class="err">:</span> <span class="s2">"*"</span><span class="p">,</span>
    <span class="s2">"electron-prebuilt"</span><span class="err">:</span> <span class="s2">"*"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<p>as well as the <code class="highlighter-rouge">main.js</code>:</p>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">electron</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'electron'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">electron</span><span class="p">.</span><span class="nx">app</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">BrowserWindow</span> <span class="o">=</span> <span class="nx">electron</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">;</span>
<span class="nx">electron</span><span class="p">.</span><span class="nx">crashReporter</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">mainWindow</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'window-all-closed'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//if (process.platform != 'darwin') {</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">quit</span><span class="p">();</span>
  <span class="c1">//}</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'ready'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// call python?</span>
  <span class="kd">var</span> <span class="nx">subpy</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'child_process'</span><span class="p">).</span><span class="nx">spawn</span><span class="p">(</span><span class="s1">'python'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'./hello.py'</span><span class="p">]);</span>
  <span class="c1">//var subpy = require('child_process').spawn('./dist/hello.exe');</span>
  <span class="kd">var</span> <span class="nx">rq</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request-promise'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">mainAddr</span> <span class="o">=</span> <span class="s1">'http://localhost:5000'</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">openWindow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">mainWindow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">({</span><span class="na">width</span><span class="p">:</span> <span class="mi">800</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="mi">600</span><span class="p">});</span>
    <span class="c1">// mainWindow.loadURL('file://' + __dirname + '/index.html');</span>
    <span class="nx">mainWindow</span><span class="p">.</span><span class="nx">loadURL</span><span class="p">(</span><span class="s1">'http://localhost:5000'</span><span class="p">);</span>
    <span class="nx">mainWindow</span><span class="p">.</span><span class="nx">webContents</span><span class="p">.</span><span class="nx">openDevTools</span><span class="p">();</span>
    <span class="nx">mainWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'closed'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">mainWindow</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="nx">subpy</span><span class="p">.</span><span class="nx">kill</span><span class="p">(</span><span class="s1">'SIGINT'</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">startUp</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">rq</span><span class="p">(</span><span class="nx">mainAddr</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">htmlString</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'server started!'</span><span class="p">);</span>
        <span class="nx">openWindow</span><span class="p">();</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">//console.log('waiting for the server start...');</span>
        <span class="nx">startUp</span><span class="p">();</span>
      <span class="p">});</span>
  <span class="p">};</span>

  <span class="c1">// fire!</span>
  <span class="nx">startUp</span><span class="p">();</span>
<span class="p">});</span>
</code></pre>
</div>
<p>Notice that in <code class="highlighter-rouge">main.js</code>, we spawn a child process for a Python application. Then we check whether the server has been up or not using unlimited loop (well, bad practice! we should actually check the time required and break the loop after some seconds). After the server has been up, we build an actual electron window pointing to the new local website index page.</p>
<p>Lastly, the <code class="highlighter-rouge">hello.py</code>:</p>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">"Hello World! This is powered by Python backend."</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'oh hello'</span><span class="p">)</span>
    <span class="c">#time.sleep(5)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'127.0.0.1'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre>
</div>
<p>After all the files are generated, we could simply run Electron inside bash:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>electron . <span class="c"># . as the working directory</span>
</code></pre>
</div>
<p>A desktop application should be launched as desired.</p>
<p>The full code could be viewed on <a href="https://github.com/fyears/electron-python-example">GitHub</a>.</p>
<h2 id="further-thinking">further thinking</h2>
<p>Electron is cool. But according to the issues in Atom Editor, the performance one of the main issue.</p>
<p>“Everything is a website” is also cool. But well, we may ~~easily~~ reach the limitations of web technologies.</p>
<p>That said, I believe “Electron as GUI for Python applications” is still an interesting approach about writing GUI in Python.</p>
</div>
</div></body></html>