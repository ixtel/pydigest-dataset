<html><body><div><div class="e-content entry-content" itemprop="articleBody text">
<div class="lead"><div>
<p>There are multiple ways to write an app in Python. However, not all of them
provide your users with the best experience.</p>
<p>One of the problems some people encounter is <em>writing launch scripts</em>. The
best way to handle this is the <em>Entry Points</em> mechanism of Setuptools, and a
<tt class="docutils literal">__main__.py</tt> file. It’s quite easy to implement. If you’re interested,
read on to learn more!</p>
</div></div>
<div class="section" id="requirements-and-desired-results">
<h2>Requirements and Desired Results</h2>
<p>You will need:</p>

<p>(<tt class="docutils literal">entry_points_project</tt> is also where the README and other auxiliary files
go, while <tt class="docutils literal">my_project</tt> contains all the Python code.)</p>
<p>When you’re done, you will have a project that can be executed by:</p>
<ul class="simple">
<li><tt class="docutils literal">python <span class="pre">-m</span> my_project</tt></li>
<li><tt class="docutils literal">my_project</tt></li>
</ul>
<p>Provided that you have your Python directory and its <tt class="docutils literal">Scripts\</tt> subdirectory on
the %PATH%, this will <strong>also work in Windows</strong>.</p>
</div>
<div class="section" id="step-1-create-a-main-py-file">
<h2>Step 1: create a <tt class="docutils literal">__main__.py</tt> file</h2>
<p>In order to implement the first desired result, you need to create a
<tt class="docutils literal">__main__.py</tt> file in your package. This file needs to contain a <tt class="docutils literal">main()</tt>
function that takes no arguments, and also a special passage to determine code
to run:</p>
<p><a class="reference external" href="/listings/entry_points_project/my_project/__main__.py.html">entry_points_project/my_project/__main__.py</a></p>
<pre class="code python"><a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-1"/><span class="kn">import</span> <span class="nn">sys</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-2"/>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-3"/>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-4"/><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-5"/>    <span class="sd">"""The main routine."""</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-6"/>    <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-7"/>        <span class="n">args</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-8"/>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-9"/>    <span class="k">print</span><span class="p">(</span><span class="s">"This is the main routine."</span><span class="p">)</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-10"/>    <span class="k">print</span><span class="p">(</span><span class="s">"It should do something interesting."</span><span class="p">)</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-11"/>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-12"/>    <span class="c"># Do argument parsing here (eg. with argparse) and anything else</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-13"/>    <span class="c"># you want your project to do.</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-14"/>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-15"/><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
<a name="rest_code_a66e3d3ac6cc445bb7a8df70f484a529-16"/>    <span class="n">main</span><span class="p">()</span>
</pre>
<ol class="arabic simple">
<li>The <tt class="docutils literal">if __name__ == "__main__":</tt> idiom, as <a class="reference external" href="https://docs.python.org/3/library/__main__.html">documented here</a>, is used to check whether
this is executed as the top-level file, or if it has been imported by someone
else (in this case, executing the <tt class="docutils literal">main()</tt> function is not always intended).</li>
<li>The <tt class="docutils literal">main()</tt> function must not take any arguments, because that’s how
<tt class="docutils literal">entry_points</tt> executes things.</li>
</ol>
</div>
<div class="section" id="step-2-adjust-setup-py-accordingly">
<h2>Step 2: adjust <tt class="docutils literal">setup.py</tt> accordingly</h2>
<p>This is the real deal: create the entry points in your <tt class="docutils literal">setup.py</tt> file.</p>
<p><a class="reference external" href="/listings/entry_points_project/setup.py.html">entry_points_project/setup.py</a></p>
<pre class="code python"><a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-1"/><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-2"/>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-3"/><span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'my_project'</span><span class="p">,</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-4"/>      <span class="n">version</span><span class="o">=</span><span class="s">'0.1.0'</span><span class="p">,</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-5"/>      <span class="n">packages</span><span class="o">=</span><span class="p">[</span><span class="s">'my_project'</span><span class="p">],</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-6"/>      <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-7"/>          <span class="s">'console_scripts'</span><span class="p">:</span> <span class="p">[</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-8"/>              <span class="s">'my_project = my_project.__main__:main'</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-9"/>          <span class="p">]</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-10"/>      <span class="p">},</span>
<a name="rest_code_f5d5c58ec74f4eb9836ee4edeaca9446-11"/>      <span class="p">)</span>
</pre>
<ol class="arabic simple">
<li>You must use setuptools, otherwise this won’t work.</li>
<li>The most important piece of code is the <tt class="docutils literal">entry_points</tt> declaration (unsurprisingly).</li>
<li>The declaration reads</li>
</ol>
<pre class="code text"><a name="rest_code_f21b6027a80442799a64a521fd33e6e2-1"/>"name_of_executable = module.with:function_to_execute"
</pre>
<ol class="arabic simple" start="4">
<li>If you are developing a GUI application (in Tkinter, PyQt/PySide,
WxPython, PyGTK, PyGame…), you should change the declaration to
<tt class="docutils literal">gui_scripts</tt>.</li>
<li>You can create multiple scripts this way. You can also have multiple
<tt class="docutils literal">console_scripts</tt> <em>and</em> <tt class="docutils literal">gui_scripts</tt> in one setup file.</li>
</ol>
<p class="text-muted">All <a class="reference external" href="/listings/entry_points_project/">code samples</a> are Copyright © 2014 Chris Warrick and licensed
under <a class="reference external" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">CC-BY 3.0</a>.</p>
</div>
</div>
</div></body></html>