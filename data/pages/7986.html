<html><body><div><div id="content">

            

            
        


            <div class="section">
              <h1>local_mutex 1.0</h1>

              


<p>local mutex</p><p>








#local_mutex</p><p>本地锁,通过fcntl针对文件加锁实现的. 需要强烈注意的是,多线程下是无效的,原因? [查看链接](http://xiaorui.cc)</p><p>#Usage:</p><p>最简单的例子,适合一个程序同时跑一个的场景.</p><p>```</p><p>import sys</p><p>from local_mutex import LocalMutex</p><p>try:</p><p>    lock = LocalMutex('app.lock')</p><p>except LockError:</p><p>    sys.exit('already running')</p><p>try:</p><p>    print 'doing'</p><p>finally:</p><p>    lock.release()</p><p>```</p><p>使用wait参数不停的试图获取Lock, 直到获取锁.</p><p>```</p><p>lock = LocalMutex('/var/run/app.lock', wait = True)</p><p>try:</p><p>    print 'doing'</p><p>finally:</p><p>    lock.release()</p><p>```</p><p>使用with关键词</p><p>```</p><p>with LocalMutex('app.lock', wait = True):</p><p>    print 'doing'</p><p>```</p><p>如果是多线程环境,直接用threading的Lock</p><p>```</p><p>import threading</p><p>lock = threading.Lock()</p><p>with lock:</p><p>    pass</p><p>```

</p><a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>5</span> downloads in the last week
  </li>
  <li>
    <span>81</span> downloads in the last month
  </li>
</ul>









            </div>


          </div>
          </div></body></html>