<html><body><div><div class="post-format-content"><p class="at-above-post addthis_default_style addthis_toolbox at-wordpress-hide" data-title="Z algorithm" data-url="https://ivanyu.me/blog/2013/10/15/z-algorithm/"/><h3>Introduction</h3>
<p>There are some algorithms of exact substring searching (e.g. <a href="https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm"><dfn>Knuth-Morris-Pratt</dfn></a>, <a href="https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm"><dfn>Boyer-Moore</dfn></a> etc.) I want to explain one of them which is called <strong>Z algorithm</strong> in some sources.</p>
<h3>Z-boxes and Z-values</h3>
<p>Let’s consider the concept of <dfn>Z-box</dfn>. Take the string <code>S = "abcxxxabyyy"</code>. We have an internal part <code>"ab"</code> in the string which repeats its prefix. The internal <code>"ab"</code> is a <strong>Z-box</strong>. It has the beginning at the position with index 6 and the end in 7 (0-based). Z-boxes are substrings which match string prefixes with the same length. For the Z-box, let’s call the corresponding prefix <dfn>the prototype</dfn> (it’s my term but I think it’s OK to use it.)</p>
<p><img class="aligncenter size-full" src="//ivanyu.me/wp-content/uploads/2014/09/zalg1.png" alt="Z algorithm"/></p>
<p><span id="more-5"/></p>
<p>In fact, the string <code>"abcxxxabyyy"</code> has three non-empty (i.e. with length greater than zero) Z-boxes:<br/>
1) the whole strings matches it’s prefix length 11;<br/>
2) <code>'a'</code> character at the position 6;<br/>
3) just considered substring <code>"ab"</code> (6-7).</p>
<p>Let Z-value, <code>Z<sub>i</sub>(S)</code> or just <code>Z<sub>i</sub></code> be the length of a Z-box in string <code>S</code> which starts at the position <code>i</code>. Obviously, Z-value can’t be bigger than the length of the rest of the string.</p>
<p>We can compute all Z-values in the string:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">c</td>
<td class="ztable">x</td>
<td class="ztable">x</td>
<td class="ztable">x</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable">y</td>
<td class="ztable">y</td>
<td class="ztable">y</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">11</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<p>Z-box [0-10] matches the whole string, so has the length 11. Z-box [6-7] matches prefix [0-1], length 2. Z-box [7-7] matches prefix [0-0], length 1.</p>
<p>Let’s ignore empty Z-boxes (with the length 0).</p>
<p class="small-margin-bottom">Some examples:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">6</td>
<td class="ztable">5</td>
<td class="ztable">4</td>
<td class="ztable">3</td>
<td class="ztable">2</td>
<td class="ztable">1</td>
</tr>
</tbody>
</table>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">b</td>
<td class="ztable">b</td>
<td class="ztable">b</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">6</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">c</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable ztable-zbox">c</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">6</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">r</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable">c</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable">d</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable ztable-zbox">r</td>
<td class="ztable ztable-zbox">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">11</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
</tr>
</tbody>
</table>
<h3>Naïve computation of Z-values</h3>
<p>The naïve algorithm of Z-values computation is very simple: we just need to go through all string indexes starting from 1 and explicitly calculate <code>Z<sub>i</sub>(S)</code>.</p>
<p class="small-margin-bottom">In Python it’d look like:</p>
<p/>

		<div id="crayon-56d59b39712f3789942995" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59b39712f3789942995-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">z_naive</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b39712f3789942995-2"><span class="crayon-h">    </span><span class="crayon-v">Z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d59b39712f3789942995-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b39712f3789942995-4"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b39712f3789942995-5"><span class="crayon-h">        </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b39712f3789942995-6"><span class="crayon-h">        </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b39712f3789942995-7"><span class="crayon-h">            </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b39712f3789942995-8"><span class="crayon-h">        </span><span class="crayon-v">Z</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59b39712f3789942995-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b39712f3789942995-10"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">Z</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Or you might want some <em>Python magic</em> :)</p>

		<div id="crayon-56d59b397130c638232559" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59b397130c638232559-1"><span class="crayon-v">Z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-e">takewhile</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397130c638232559-2"><span class="crayon-h">     </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>But <a href="http://www.python.org/dev/peps/pep-0020/">simple is better than complex</a>, isn’t it?</p>
<h3>Advanced computation of Z-values</h3>
<p>The naïve implementation has <code>O(|S|<sup>2</sup>)</code> time complexity, where <code>|S|</code> is the length of the string. Can it be better? Yes, it can.</p>
<p>What do we know about Z-box? We know that the corresponding substring is exactly the same as the prefix of the string (with the same length). We compute Z-value sequentially from the beginning, so we could use these previous values.</p>
<p>Introduce indexes <code>lt<sub>i</sub></code> (for “left”) and <code>rt<sub>i</sub></code> (for “right”). <code>rt<sub>i</sub></code> indicates the right-most end (the index of the last character) of any Z-box that starts at the position <code>i</code> or to the left of this position at the position <code>lt<sub>i</sub></code>. In the future we will skip <code>i</code> in <code>lt<sub>i</sub></code> and <code>rt<sub>i</sub></code>. Let’s call Z-box in range <code>[lt..rt]</code> (both ends are included) <strong>the current Z-box</strong>.</p>
<p>For index k inside the current Z-box, let’s call index <code>p=k-lt</code> lying inside the prototype <strong>the pair index</strong>.</p>
<p><img class="aligncenter size-full" src="//ivanyu.me/wp-content/uploads/2014/09/zalg2.png" alt=""/></p>
<p>We know the value of <code>Z<sub>p</sub></code>. Substrings in Z-box and its prototype are equal. Can we say that <code>Z<sub>k</sub> = Z<sub>p</sub></code>? Under some conditions, yes.</p>
<p>The fact that the current character at the position k is inside previously found Z-box can give us some information. Let’s take substring <code>S(k..rt)</code> and consider two cases.</p>
<h4>Case 1</h4>
<p><code>Z<sub>p</sub> &lt; |S(k..rt)|</code>, i.e. <code>Z<sub>p</sub></code> is less then the length of the rest (starting from <code>k</code>) of the current Z-box.<br/>
<code>|S(k..rt)| = rt-k+1</code>.<br/>
We can add <code>k</code> to the both side of the condition: <code>k+Z<sub>p</sub> &lt; rt+1</code>.</p>
<p>Note: Pay attention that if we have a string with the length <code>n</code> which starts at the position <code>i</code> then the end of the string will be at the position <code>x+i-1</code>. For example, if <code>n=1</code> and <code>i=2</code> then the string begins and ends at the position 2. If <code>i=0</code> and <code>n=2</code> then the string begins in 0 and ends in 1.</p>
<p>In this case, we have two identical substrings (Z-box and its prototype), two identical characters inside them (at k and p positions correspondingly).<br/>
Moreover, we have the following information:<br/>
1) substrings <code>S(p..p+Z<sub>p</sub>-1)</code> and <code>S(0..Z<sub>p</sub>-1)</code> are identical (from the meaning of <code>Z<sub>p</sub></code>);<br/>
2) substrings <code>S(k..k+Z<sub>p</sub>-1)</code> and <code>S(p..p+Z<sub>p</sub>-1)</code> are identical because indexes <code>k</code> and <code>k+Z<sub>p</sub>-1</code>, <code>p</code> and <code>p+Z<sub>p</sub>-1</code> lie inside the Z-box and its prototype at the same relative positions;<br/>
3) substrings <code>S(k..k+Z<sub>p</sub>-1)</code> and <code>S(0..Z<sub>p</sub>-1)</code> are identical (from statement 1 and 2);</p>
<p><img class="aligncenter size-full" src="//ivanyu.me/wp-content/uploads/2014/09/zalg3.png" alt=""/></p>
<p>4) characters <code>S(p+Z<sub>p</sub>)</code> and <code>S(Z<sub>p</sub>)</code> aren’t equal (again, from the meaning of <code>Z<sub>p</sub></code>);<br/>
5) characters <code>S(k+Z<sub>p</sub>)</code> and <code>S(p+Z<sub>p</sub>)</code> are equal because these indexes lie inside Z-box and its prototype at the same relative positions;<br/>
6) characters <code>S(k+Z<sub>p</sub>)</code> and <code>S(Z<sub>p</sub>)</code> aren’t equal (from statement 4 and 5);</p>
<p><img class="aligncenter size-full" src="//ivanyu.me/wp-content/uploads/2014/09/zalg4.png" alt=""/></p>
<p>From statements 3 and 5 and the meaning of <code>Z<sub>k</sub></code> we can conclude that <code>Z<sub>k</sub></code> is equal to <code>Z<sub>p</sub></code>.</p>
<p>Thus we can state that when index <code>k</code> is inside the current Z-box with the left border <code>lt</code>, right border <code>rt</code> and <code>Z<sub>p</sub> &lt; rt-k+1</code> then <code>Z<sub>k</sub> = Z<sub>p</sub></code>, where <code>p=k-lt</code>.</p>
<p><code>lt</code> and <code>rt</code> remain the same because <code>k+Z<sub>k</sub></code> certainly lies to the left of the current <code>rt</code>.</p>
<p>We need the strict condition <code>Z<sub>p</sub> &lt; |S(k..rt)|</code> instead of <code>Z<sub>p</sub> ≤ |S(k..rt)|</code> to be able to say about the equality of characters <code>S(k+Z<sub>p</sub>)</code> and <code>S(p+Z<sub>p</sub>)</code> with confidence. If <code>Z<sub>p</sub> = |S(k..rt)|</code> then <code>S(k+Z<sub>p</sub>)</code> lies outside the current Z-box and we have no idea about either these characters are equal or not. Why don’t we just check? This smoothly brings us to the case 2.</p>
<h4>Case 2</h4>
<p><code>Z<sub>p</sub> &gt; |S(k..rt)|</code>.<br/>
<code>|S(k..rt)| = rt-k+1</code>.<br/>
In this case we can’t simply state that <code>Z<sub>k</sub> = Z<sub>p</sub></code> because we don’t know anything about equality of characters beyond the right bounds of prototype and Z-box.</p>
<p><img class="aligncenter size-full" src="//ivanyu.me/wp-content/uploads/2014/09/zalg5.png" alt=""/></p>
<p>We know that substrings <code>S(k..k+h)</code>, <code>S(p..p+h)</code> and <code>S(0..h)</code> are identical. We can simply compare characters from ranges <code>[rt+1..|S|]</code> and <code>[rt-k+1..|S|-k]</code> until the first inequality or the end of the ranges (and the whole string). If we found not equal characters at positions <code>q</code> and <code>k+q</code> then <code>Z<sub>k</sub></code> equals the length of the equal substrings, i.e. <code>Z<sub>k</sub> = q</code>.</p>
<p>Of course, we must set the new value to <code>rt</code> and <code>lt</code>, corresponding to the newly found Z-box because <code>k+q-1</code> lies to the right of <code>rt</code> (or at least they are equal).</p>
<p>Obviously, when <code>k</code> isn’t inside the current Z-box (<code>k &gt; rt</code>), we have to calculate <code>Z<sub>k</sub></code> explicitly.</p>
<p>The formalization of the algorithm might look like this:</p>
<p>Having string <code>S</code>,<br/>
Set <code>Z<sub>0</sub>=|S|</code>, <code>lt=0</code>, <code>rt=0</code>.<br/>
For each <code>k</code>, <code>1 ≤ k &lt; |S|</code> do:<br/>
1. If <code>k &gt; rt</code>: calculate <code>Z<sub>k</sub>(S)</code> explicitly. If <code>Z<sub>k</sub> &gt; 0</code>, set <code>lt := k</code> and <code>rt := k+Z<sub>k</sub>-1</code>.<br/>
2. Else: <code>p := k-lt</code>.<br/>
<span>2.1. If <code>Z<sub>p</sub> &lt; rt-k+1</code>, set <code>Z<sub>k</sub> := Z<sub>p</sub></code>.</span><br/>
<span>2.2. If <code>Z<sub>p</sub> ≥ rt-k+1</code>, for each <code>i</code>, <code>rt+1 ≤ i &lt; |S|</code> do:</span><br/>
<span>2.2.1. If <code>S(i) = S(i-k)</code>: increment <code>i</code> and continue.</span><br/>
<span>2.2.2. If <code>S(i) ≠ S(i-k)</code>: set <code>Z<sub>k</sub> := i-k</code>, <code>lt := k</code>, <code>rt := i-1</code> and break.</span></p>
<p>And in Python:</p>

		<div id="crayon-56d59b397131e460267102" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59b397131e460267102-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-2">2</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-4">4</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-6">6</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-8">8</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-10">10</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-12">12</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-14">14</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-16">16</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-18">18</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-20">20</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-22">22</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-24">24</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-26">26</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-28">28</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-30">30</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-32">32</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-34">34</p><p class="crayon-num" data-line="crayon-56d59b397131e460267102-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397131e460267102-36">36</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59b397131e460267102-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">z_advanced</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-2"><span class="crayon-h">    </span><span class="crayon-s">"""An advanced computation of Z-values of a string."""</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-4"><span class="crayon-h">    </span><span class="crayon-v">Z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-5"><span class="crayon-h">    </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-6"> </p><p class="crayon-line" id="crayon-56d59b397131e460267102-7"><span class="crayon-h">    </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-8"><span class="crayon-h">    </span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-10"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-11"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-12"><span class="crayon-h">            </span><span class="crayon-c"># If k is outside the current Z-box, do naive computation.</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-13"><span class="crayon-h">            </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-14"><span class="crayon-h">            </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-o">+</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-15"><span class="crayon-h">                </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-16"><span class="crayon-h">            </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">n</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-17"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-18"><span class="crayon-h">                </span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">k</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-19"><span class="crayon-h">                </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-o">+</span><span class="crayon-v">n</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-20"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-21"><span class="crayon-h">            </span><span class="crayon-c"># If k is inside the current Z-box, consider two cases.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-22"> </p><p class="crayon-line" id="crayon-56d59b397131e460267102-23"><span class="crayon-h">            </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lt</span><span class="crayon-h">  </span><span class="crayon-c"># Pair index.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-24"><span class="crayon-h">            </span><span class="crayon-v">right_part_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-25"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-26"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">right_part_len</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-27"><span class="crayon-h">                </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-28"><span class="crayon-h">            </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-29"><span class="crayon-h">                </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-30"><span class="crayon-h">                </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-31"><span class="crayon-h">                    </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-32"><span class="crayon-h">                </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">k</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-33"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-34"><span class="crayon-h">                </span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">k</span></p><p class="crayon-line" id="crayon-56d59b397131e460267102-35"><span class="crayon-h">                </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397131e460267102-36"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">Z</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p> </p>
<h4>Example</h4>
<p>Let’s consider the example: take the string <code>S = "ababxababyabaca"</code> and calculate Z-values by the described algorithm.<br/>
We’ll highlight the current Z-box with the blue color in the “Index” row and matching and non-matching characters of a potential Z-box with the green and the red color respectively in the “Character” row.</p>
<p class="small-margin-bottom"><code>Z<sub>0</sub> = |S| = 15</code>.</p>
<p class="small-margin-bottom">Start from <code>k = 1</code>. <code>lt = 0</code>, <code>rt = 0</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable ztable-mis">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=1 &gt; rt=0</code> and we must calculate <code>Z<sub>1</sub></code> explicitly. <code>S(1) ≠ S(0)</code>, so <code>Z<sub>1</sub> = 0</code>. We don’t treat empty Z-boxes as normal Z-boxes, so we just skip it, no updates of <code>lt</code> and <code>rt</code> are made.</p>
<p class="small-margin-bottom"><code>k = 2</code>, <code>lt = 0</code>, <code>rt = 0</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-match">b</td>
<td class="ztable ztable-mis">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p>Again, <code>k=1 &gt; rt=0</code> and we’re calculating <code>Z<sub>2</sub></code> explicitly. <code>S(2) = S(0)</code>, <code>S(3) = S(1)</code>, <code>S(4) ≠ S(2)</code>, so <code>Z<sub>2</sub> = 2</code>. This is a normal newly found Z-box and we update <code>lt := k = 2</code>, <code>rt := k + Z<sub>k</sub> - 1 = 2 + 2 - 1 = 3</code>.</p>
<p class="small-margin-bottom"><code>k = 3</code>, <code>lt = 2</code>, <code>rt = 3</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable ztable-zbox">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p>Here, <code>k=3 ≤ rt=3</code>. It has the pair index <code>p = k-lt = 3-2 = 1</code>. <code>Z<sub>p</sub>=Z<sub>1</sub>=0</code>. <code>Z<sub>1</sub> &lt; rt-k+1=1</code>, so we don’t need to examine any additional characters and can say that <code>Z<sub>3</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 4</code>, <code>lt = 2</code>, <code>rt = 3</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable ztable-zbox">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable ztable-mis">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=4 &gt; rt=3</code> and we’re calculating <code>Z<sub>4</sub></code> explicitly. <code>S(4) ≠ S(0)</code>, so <code>Z<sub>4</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 5</code>, <code>lt = 2</code>, <code>rt = 3</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable ztable-zbox">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-match">b</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-match">b</td>
<td class="ztable ztable-mis">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=5 &gt; rt=3</code> and we’re calculating <code>Z<sub>5</sub></code> explicitly. <code>Z<sub>5</sub> = 4</code>. This is a normal newly found Z-box and we update <code>lt := k=5</code>, <code>rt := k+Z<sub>k</sub>-1 = 5+4-1 = 8</code>.</p>
<p class="small-margin-bottom"><code>k = 6</code>, <code>lt = 5</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable ztable-zbox">5</td>
<td class="ztable ztable-zbox">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=6 ≤ rt=8</code>. The pair index <code>p = k-lt = 6-5 = 1</code>. <code>Z<sub>p</sub> = Z<sub>1</sub> = 0</code>. <code>Z<sub>1</sub> &lt; rt-k+1 = 3</code>, so we don’t need to examine any additional characters and can say that <code>Z<sub>6</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 7</code>, <code>lt = 5</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable ztable-zbox">5</td>
<td class="ztable ztable-zbox">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable ztable-mis">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=7 ≤ rt=8</code>. The pair index <code>p = k-lt = 7-5 = 2</code>. <code>Z<sub>p</sub> = Z<sub>2</sub> = 2</code>. <code>Z<sub>2</sub> ≥ rt-k+1=2</code>, so we need to examine characters starting from <code>rt+1=9</code> and compare them to characters starting from <code>rt+1-k=2</code>. <code>S(9) ≠ S(2)</code>, first not equal characters are at positions 2 and 9. So, <code>Z<sub>7</sub> = 9-k = 2</code>. Also, we need to update <code>lt := k=7</code>, <code>rt := k+Z<sub>k</sub>-1 = 7+2-1 = 8</code>.</p>
<p class="small-margin-bottom"><code>k = 8</code>, <code>lt = 7</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=8 ≤ rt=8</code>. The pair index <code>p = k-lt = 8-7 = 1</code>. <code>Z<sub>p</sub> = Z<sub>1</sub> = 0</code>. <code>Z<sub>1</sub> &lt; rt-k+1 = 1</code>, so we don’t need to examine any additional characters and can say that <code>Z<sub>8</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 9</code>, <code>lt = 7</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable ztable-mis">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=9 &gt; rt=8</code> and we’re calculating <code>Z<sub>9</sub></code> explicitly. <code>S(9) ≠ S(0)</code>, so <code>Z<sub>9</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 10</code>, <code>lt = 7</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-match">b</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-mis">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=10 &gt; rt=8</code> and we’re calculating <code>Z<sub>10</sub></code> explicitly. <code>S(10) = S(0)</code>, <code>S(11) = S(1)</code>, <code>S(12) = S(2)</code>, <code>S(13) ≠ S(3)</code>, so <code>Z<sub>10</sub> = 3</code>. Also, we need to update <code>lt := k=10</code>, <code>rt := k+Z<sub>k</sub>-1 = 10+3-1 = 12</code>.</p>
<p class="small-margin-bottom"><code>k = 11</code>, <code>lt = 10</code>, <code>rt = 12</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable ztable-zbox">10</td>
<td class="ztable ztable-zbox">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=11 ≤ rt=12</code>. The pair index <code>p = k-lt = 11-10 = 1</code>. <code>Z<sub>p</sub> = Z<sub>1</sub> = 0</code>. <code>Z<sub>1</sub> &lt; rt-k+1=2</code>, so we don’t need to examine any additional characters and can say that <code>Z<sub>11</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 12</code>, <code>lt = 10</code>, <code>rt = 12</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable ztable-zbox">10</td>
<td class="ztable ztable-zbox">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable ztable-mis">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable"/>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=12 ≤ rt=12</code>. The pair index <code>p = k-lt = 12-10 = 2</code>. <code>Z<sub>p</sub>=Z<sub>2</sub>=2 ≥ rt-k+1=1</code>, so we need to examine additional characters starting from <code>rt+1=13</code> and compare them to characters starting from <code>rt+1-k=1</code>. <code>S(13) ≠ S(1)</code>, first not equal characters are at positions 1 and 13. So, <code>Z<sub>12</sub> = 13-k = 1</code>. Also, we need to update <code>lt := k=12</code>, <code>rt := k+Z<sub>k</sub>-1 = 12+1-1 = 12</code>.</p>
<p class="small-margin-bottom"><code>k = 13</code>, <code>lt = 12</code>, <code>rt = 12</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable"/>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt<br/>
rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"/>
</tr>
</tbody>
</table>
<p><code>k=13 &gt; rt=12</code> and we’re calculating <code>Z<sub>13</sub></code> explicitly. <code>S(13) ≠ S(0)</code>, so <code>Z<sub>13</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 14</code>, <code>lt = 12</code>, <code>rt = 12</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">lt<br/>
rt</td>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
</tr>
<tr>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer"/>
<td class="ztable ztable-pointer">k</td>
</tr>
</tbody>
</table>
<p><code>k=14 &gt; rt=12</code> and we’re calculating <code>Z<sub>14</sub></code> explicitly. <code>S(14) = S(0)</code>, so <code>Z<sub>14</sub> = 1</code>.</p>
<p class="small-margin-bottom">Finally, we have:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
</tr>
</tbody>
</table>
<h4>Complexity</h4>
<p>Let’s find out (not very strictly) time and space complexity of the algorithm. We have <code>|S|</code> iterations. In each iteration we either already have got a Z-value or we have to do some comparisons. When we find <code>q</code> matches during the comparisons <code>rt</code> will be moved to the right: <code>rt<sub>k</sub> := rt<sub>k-1</sub>+q</code>. After each mismatch an iteration finishes, so there aren’t more than <code>|S|</code> mismatches. We have not more than <code>|S|</code> iterations with not more than <code>|S|</code> matches and mismatches as a whole. So, the algorithm has <code>O(|S|)</code> time complexity.<br/>
Obviously, it requires <code>O(|S|)</code> space to store Z-values.</p>
<h4>Search algorithm</h4>
<p>You could ask why we need these Z-values at all. This is an appropriate question :) We can use the idea of Z-values for doing a substring search.<br/>
Take a string <code>T</code> (for “text”) and a string <code>P</code> (for “pattern”), both built of characters of some alphabet <code>A</code>. Also, take character <code>'$'</code> which is not in <code>A</code>. This character is called <strong>the sentinel</strong>. Assemble all these things in the following way: <code>P$T</code>.</p>
<p>Compute Z-values of this composite string by the advanced algorithm described earlier. All this values will be limited to <code>|P|</code> (except <code>Z<sub>0</sub></code>, of course) because of the sentinel which can’t be found at any place in <code>P</code> or <code>T</code>. And when you see a <code>Z<sub>j</sub> = |P|</code> then you can be sure that substring <code>T(j..j+|P|-1)</code> is an occurrence of <code>P</code> in <code>T</code>. And vice versa: you can be confident that all occurrences will be marked in the list of Z-values.</p>
<p class="small-margin-bottom">Let’s consider an example. <code>P = "ab"</code>, <code>T = "xaybzabxaby"</code>:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable ztable-zbox">9</td>
<td class="ztable">10</td>
<td class="ztable ztable-zbox">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">$</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">y</td>
<td class="ztable">b</td>
<td class="ztable">z</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable">x</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable">y</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">14</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<p class="small-margin-bottom">Even with overlapping matches: <code>P = "aa"</code>, <code>T = "xaaay"</code>:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable ztable-zbox">4</td>
<td class="ztable ztable-zbox">5</td>
<td class="ztable ztable-zbox">6</td>
<td class="ztable">7</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">$</td>
<td class="ztable">x</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable">y</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">8</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<p>This search algorithm has the <code>O(|P|+|T|)</code> time and space complexity because it has the longest, dominating part – search of Z-values which is <code>O(|S|)</code>, <code>|S|=|P|+|T|</code>.</p>
<p>Good algorithm. But there is an obstacle for a general-purpose use: the choice of the sentinel. In some applications you have a short known alphabet. For example, in bioinformatics there are symbols <code>'A'</code>, <code>'C'</code>, <code>'G'</code> and <code>'T'</code> and we can simply use <code>'$'</code> as the sentinel. But what about general Unicode strings?</p>
<h4>Search algorithm without the sentinel</h4>
<p>Fortunately, there is search algorithm that doesn’t need to use sentinels. The idea is in calculating Z-values of a string <code>PT</code> with a simple modification: after each Z-value is calculated, limit it to the <code>|P|</code>, i.e., <code>Z<sub>k</sub> := min{|S|, Z<sub>k</sub>}</code>. This limitation plays role of the sentinel.</p>
<p>The Python code:</p>

		<div id="crayon-56d59b397135f067175898" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59b397135f067175898-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-2">2</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-4">4</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-6">6</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-8">8</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-10">10</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-12">12</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-14">14</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-16">16</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-18">18</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-20">20</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-22">22</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-24">24</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-26">26</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-28">28</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-30">30</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-32">32</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-34">34</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-36">36</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-38">38</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-40">40</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59b397135f067175898-42">42</p><p class="crayon-num" data-line="crayon-56d59b397135f067175898-43">43</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59b397135f067175898-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">search_without_sentinel</span><span class="crayon-sy">(</span><span class="crayon-v">pattern</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-2"><span class="crayon-h">    </span><span class="crayon-s">"""Search without the sentinel."""</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-4"><span class="crayon-h">    </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pattern</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">text</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-5"><span class="crayon-h">    </span><span class="crayon-v">Z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-6"><span class="crayon-h">    </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-8"><span class="crayon-h">    </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-9"><span class="crayon-h">    </span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-10"> </p><p class="crayon-line" id="crayon-56d59b397135f067175898-11"><span class="crayon-h">    </span><span class="crayon-v">occurrence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-12"> </p><p class="crayon-line" id="crayon-56d59b397135f067175898-13"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-14"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-15"><span class="crayon-h">            </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-16"><span class="crayon-h">            </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-o">+</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-17"><span class="crayon-h">                </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-18"><span class="crayon-h">            </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">n</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-19"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-20"><span class="crayon-h">                </span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">k</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-21"><span class="crayon-h">                </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-o">+</span><span class="crayon-v">n</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-22"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-23"><span class="crayon-h">            </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">lt</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-24"><span class="crayon-e">            </span><span class="crayon-v">right_part_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-25"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-26"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">right_part_len</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-27"><span class="crayon-h">                </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-28"><span class="crayon-h">            </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-29"><span class="crayon-h">                </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-30"><span class="crayon-h">                </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-31"><span class="crayon-h">                    </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-32"><span class="crayon-h">                </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">k</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-33"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-34"><span class="crayon-h">                </span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">k</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-35"><span class="crayon-h">                </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-36"> </p><p class="crayon-line" id="crayon-56d59b397135f067175898-37"><span class="crayon-h">        </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">min</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">pattern</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-38"> </p><p class="crayon-line" id="crayon-56d59b397135f067175898-39"><span class="crayon-h">        </span><span class="crayon-c"># An occurence found.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-40"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">pattern</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59b397135f067175898-41"><span class="crayon-h">            </span><span class="crayon-v">occurrence</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">pattern</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59b397135f067175898-42"> </p><p class="crayon-line" id="crayon-56d59b397135f067175898-43"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">occurrence</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p> </p>
<p>All the code can be found <a href="https://github.com/ivanyu/string-algorithms/blob/master/z_algorithm.py">here</a>.</p>
<p>Thank you.</p>
<p class="at-below-post addthis_default_style addthis_toolbox at-wordpress-hide" data-title="Z algorithm" data-url="https://ivanyu.me/blog/2013/10/15/z-algorithm/"/> <p class="at-below-post-recommended addthis_default_style addthis_toolbox at-wordpress-hide"/></div>
			</div></body></html>