<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-pyexperiment" class="anchor" href="#pyexperiment" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>pyexperiment</h1>
<p><a href="https://pypi.python.org/pypi/pyexperiment/"><img alt="Version" src="https://camo.githubusercontent.com/c73155153ec18a576f4c2c2caacefea106739439/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f70796578706572696d656e742e737667" data-canonical-src="https://img.shields.io/pypi/v/pyexperiment.svg"/>
</a> <a href="https://pypi.python.org/pypi/pyexperiment/"><img alt="Python Version" src="https://camo.githubusercontent.com/9f9c6eb780ebf4abf18ab74d17d9712ffa2f87ee/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d2d76657273696f6e2d322e37253230332e32253230332e33253230332e342d626c75652e737667" data-canonical-src="https://img.shields.io/badge/python--version-2.7%203.2%203.3%203.4-blue.svg"/>
</a> <a href="https://travis-ci.org/duerrp/pyexperiment"><img alt="Build Status" src="https://camo.githubusercontent.com/fa62a13411c427af32ac22ed141c90a90389e350/68747470733a2f2f7472617669732d63692e6f72672f6475657272702f70796578706572696d656e742e7376673f6272616e63683d6d6173746572" data-canonical-src="https://travis-ci.org/duerrp/pyexperiment.svg?branch=master"/></a> <a href="https://coveralls.io/r/duerrp/pyexperiment"><img alt="Coverage Status" src="https://camo.githubusercontent.com/3e7cad189130aef3a1eec1b65aab07c0ce9584cd/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6475657272702f70796578706572696d656e742f62616467652e737667" data-canonical-src="https://coveralls.io/repos/duerrp/pyexperiment/badge.svg"/>
</a></p>
<p>Pyexperiment facilitates the development of small, reproducible
experiments with minimal boilerplate code. Consider the following
example, implementing a simple program that stores numbers and
computes their sum:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> pyexperiment <span class="pl-k">import</span> experiment, state, conf, log

conf[<span class="pl-s"><span class="pl-pds">'</span>pyexperiment.save_state<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-c1">True</span>
conf[<span class="pl-s"><span class="pl-pds">'</span>pyexperiment.load_state<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-c1">True</span>
conf[<span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>The stored numbers are: <span class="pl-pds">"</span></span>

<span class="pl-k">def</span> <span class="pl-en">store</span>(<span class="pl-smi">number</span>):
    <span class="pl-s"><span class="pl-pds">"""</span>Store a number<span class="pl-pds">"""</span></span>
    <span class="pl-k">if</span> <span class="pl-s"><span class="pl-pds">'</span>numbers<span class="pl-pds">'</span></span> <span class="pl-k">not</span> <span class="pl-k">in</span> state:
        log.debug(<span class="pl-s"><span class="pl-pds">"</span>Initialize state['numbers'] to empty list<span class="pl-pds">"</span></span>)
        state[<span class="pl-s"><span class="pl-pds">'</span>numbers<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> []

    log.debug(<span class="pl-s"><span class="pl-pds">"</span>Store number: <span class="pl-c1">%s</span><span class="pl-pds">"</span></span>, number)
    state[<span class="pl-s"><span class="pl-pds">'</span>numbers<span class="pl-pds">'</span></span>].append(<span class="pl-c1">float</span>(number))

 <span class="pl-k">def</span> <span class="pl-en">show</span>():
     <span class="pl-s"><span class="pl-pds">"""</span>Show the stored numbers and compute their sum<span class="pl-pds">"""</span></span>
     <span class="pl-k">if</span> <span class="pl-k">not</span> <span class="pl-s"><span class="pl-pds">'</span>numbers<span class="pl-pds">'</span></span> <span class="pl-k">in</span> state:
         <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">'</span>No numbers stored yet<span class="pl-pds">'</span></span>)
         <span class="pl-k">return</span>

     <span class="pl-c1">print</span>(conf[<span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>] <span class="pl-k">+</span> <span class="pl-c1">str</span>(state[<span class="pl-s"><span class="pl-pds">'</span>numbers<span class="pl-pds">'</span></span>]))
     <span class="pl-k">with</span> log.timed(<span class="pl-s"><span class="pl-pds">"</span>sum<span class="pl-pds">"</span></span>):
             total <span class="pl-k">=</span> <span class="pl-c1">sum</span>(state[<span class="pl-s"><span class="pl-pds">'</span>numbers<span class="pl-pds">'</span></span>])
     <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">"</span>The total is: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">str</span>(total))

<span class="pl-k">if</span> <span class="pl-c1">__name__</span> <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span>__main__<span class="pl-pds">'</span></span>:
    experiment.main(<span class="pl-v">default</span><span class="pl-k">=</span>show,
                    <span class="pl-v">commands</span><span class="pl-k">=</span>[store, show])</pre></div>
<p>Pyexperiment makes it easy to experiment with this code from the
command line:</p>
<pre>$ ./numbers store 42
$ ./numbers store 3.14
$ ./numbers
The stored numbers are: [42.0, 3.14]
The total is: 45.14
$ ./numbers -o message "Numbers: "
Numbers: [42.0, 3.14]
The total is: 45.14
$ ./numbers -v
[DEBUG   ] [0.069s] Start: './numbers -v'
[DEBUG   ] [0.069s] Time: '2015-08-14 14:23:00.027378'
[INFO    ] [0.075s] Loading state from file 'experiment_state.h5f'
The stored numbers are: [42.0, 3.14]
[DEBUG   ] [0.076s] sum took 0.000025s
The total is: 45.14
[DEBUG   ] [0.078s] No need to save unchanged state
[DEBUG   ] [0.078s] End: './numbers -v show'
[DEBUG   ] [0.078s] Time: '2015-08-14 14:23:00.037124'
[DEBUG   ] [0.078s] Took: 0.010s
$ ./numbers -h
usage: numbers [-h] [-c CONFIG] [-o key value] [-i]
               [--verbosity {DEBUG,INFO,WARNING,ERROR,CRITICAL}] [-v]
               [-j PROCESSES]
               [{store,show,help,test,show_tests,show_config,save_config,show_state,show_commands}]
               [argument [argument ...]]

Thanks for using numbers.

positional arguments:
  {store,show,help,test,show_tests,show_config,save_config,show_state,show_commands}
                        choose a command to run, running show by default
  argument              argument to the command

optional arguments:
  -h, --help            show this help message and exit
  -c CONFIG, --config CONFIG
                        specify a configuration file
  -o key value, --option key value
                        override a configuration option
  -i, --interactive     drop to interactive prompt after COMMAND
  --verbosity {DEBUG,INFO,WARNING,ERROR,CRITICAL}
                        choose the console logger's verbosity
  -v                    shortcut for --verbosity DEBUG
  -j PROCESSES, --processes PROCESSES
                        set number of parallel processes used

available commands:

  store:                Store a number
  show (default):       Show the stored numbers and compute their sum
  help:                 Shows help for a specified command
  test:                 Run tests for the experiment
  show_tests:           Show available tests for the experiment
  show_config:          Print the configuration
  save_config:          Save a configuration file to a filename
  show_state:           Shows the contents of the state loaded by the configuration or from the file specified as an argument
  show_commands:        Print the available commands
</pre>
<a name="user-content-motivation"/>
<h2><a id="user-content-motivation" class="anchor" href="#motivation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Motivation</h2>
<p>There is no shortage of great Python libraries for command line
interfaces, logging, configuration file management, persistent state,
parallelism, or plotting. When writing small scripts for quick
experiments though, it's often too much effort to configure these
components, and one ends up rewriting the same setup code over and
over again.</p>
<p>Pyexperiment fixes this by providing a simple way to jump start short
experiments. Importing pyexperiment will give you:</p>
<ul>
<li>A basic <em>command line interface</em> that allows calling arbitrary
functions (and passing arguments) from the command prompt,
providing help text derived from the functions' docstrings and
zsh/bash autocompletion (based on the standard library's argparse
and argcomplete).</li>
<li>A simple <em>configuration management</em> with an easy way to provide
default values (based on the excellent configobj library).</li>
<li>A thread-safe <em>logger</em> with configurable logging levels, <em>timing
utilities</em> with statistics, and rotating log files (based on the
standard library's logging module).</li>
<li><em>Persistent state</em> with platform independent, configurable,
(optionally rotating) state files that are compatible with many other
programs (based on h5py).</li>
<li><em>Parallel</em> execution of replicates.</li>
<li>A sensible setup for <em>plotting</em> (based on matplotlib, and optionally
seaborn), with configurable defaults and asynchronous plotting.</li>
<li>Many other bits and pieces that might come in handy...</li>
</ul>
<p>As a design principle, pyexperiment's components come ready to use
without any further configuration. Inevitably then, the choices made in
this setup are opinionated and may or may not fit your personal taste.
Feel free to start a discussion on the
<a href="https://github.com/duerrp/pyexperiment/issues">issues</a> page.</p>
<p>For more documentation, see the automatically generated pages <a href="https://pyexperiment.readthedocs.org">here</a>. For more usage examples,
check the <a href="https://github.com/duerrp/pyexperiment/tree/master/examples">examples</a>
folder.</p>
<a name="user-content-installation"/>
<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>
<p>The easiest way to install pyexperiment is from pypi, just call <code>pip install
--user pyexperiment</code> (alternatively, use <code>pip install pyexperiment</code> in a
virtualenv, or prepend sudo for system wide installation).</p>
<p>The pyexperiment package has a few external dependencies (as you can
see in the <a href="https://github.com/duerrp/pyexperiment/blob/master/docker/requirements.txt">requirements.txt</a>):</p>
<ul>
<li>six</li>
<li>configobj</li>
<li>numpy</li>
<li>h5py</li>
<li>matplotlib</li>
<li>lockfile</li>
<li>toolz</li>
<li>IPython (optional, allows using IPython with the --interactive command)</li>
<li>argcomplete (optional, adds activate_autocompletion command)</li>
<li>seaborn (optional, adds more plotting options)</li>
</ul>
<p>If you install (the h5py dependency) from pypi, you may need to install
libhdf5 first, e.g., by running <code>sudo apt-get install libhdf5-dev</code>.
You may also find that you need to install cython first, e.g., by
running either <code>sudo apt-get install Cython</code> or <code>pip install
Cython</code>.</p>
<a name="user-content-reproducible-experiments"/>
<h2><a id="user-content-reproducible-experiments" class="anchor" href="#reproducible-experiments" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Reproducible experiments</h2>
<p>To keep your experiments reproducible and avoid dependency problems, it
is a good idea to automate the setup of your development environment,
e.g., using a Vagrant box, or - in many cases even better - a Docker
image. To get started with pyexperiment using Vagrant or Docker, you can
use the Vagrantfile and setup script
<a href="https://github.com/duerrp/pyexperiment/blob/master/vagrant">here</a>,
or the Dockerfile and setup scripts
<a href="https://github.com/duerrp/pyexperiment/blob/master/docker">here</a>.</p>
<a name="user-content-license"/>
<h2><a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>License</h2>
<p>The pyexperiment package is licensed under an MIT licence (see the
<a href="https://github.com/duerrp/pyexperiment/blob/master/LICENSE">LICENSE</a>).</p>

</article>
  </div></body></html>