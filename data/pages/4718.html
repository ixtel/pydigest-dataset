<html><body><div><div class="entry-content">
		<p>Make folders:</p>
<pre>mkdir -p favicons/icons ; cd favicons</pre>
<p>Get a list of Alexa Top 1000 sites:</p>
<pre>curl -s -O http://s3.amazonaws.com/alexa-static/top-1m.csv.zip ; unzip -q -o top-1m.csv.zip top-1m.csv ; head -1000 top-1m.csv | cut -d, -f2 | cut -d/ -f1 &gt; topsites.txt</pre>
<p>Former time-saving oneliner was found <a href="http://www.commandlinefu.com/commands/view/6934/get-a-list-of-top-1000-sites-from-alexa">here</a>.</p>
<pre>yum install python-gevent</pre>
<p><a href="http://www.gevent.org/">Gevent</a> is a high-performance network framework for Python built on top of libevent and greenlets.</p>
<p>Few modifications of an example shipped with gevent:</p>
<pre>#!/usr/bin/python
# Copyright (c) 2009 Denis Bilenko. See LICENSE for details.
"""Spawn multiple workers and wait for them to complete"""

ursl = []
urls = lines = ['http://www.' + line.strip() for line in open('topsites.txt')]

import gevent
from gevent import monkey

# patches stdlib (including socket and ssl modules) to cooperate with other greenlets
monkey.patch_all()

import urllib2
from socket import setdefaulttimeout
setdefaulttimeout(30)

def print_head(url):
     print ('Starting %s' % url)
     url = url + '/favicon.ico'
     try:
         data = urllib2.urlopen(url).read()
         except Exception, e:
         print 'error', url, e
         return

    fn = 'icons/' + url[+11:].replace("/", "-")
    myFile = file(fn, 'w')
    myFile.write(data)
    myFile.close()

jobs = [gevent.spawn(print_head, url) for url in urls]

gevent.joinall(jobs)</pre>
<pre>[dande@host favicons]$ time python ./get.py
...

real 0m50.644s
user 0m1.914s
sys 0m0.888s
[dande@host favicons]$</pre>
<pre>[dande@host favicons]$ ls icons/ | wc -l
889
[dande@host favicons]$</pre>
<p>Well, thereâ€™s no much sense except fooling around with Python.</p>





<noscript/>

		<p class="really_simple_share_clearfix"/>			</div>
	
	</div></body></html>