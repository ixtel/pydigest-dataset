<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-django-wham" class="anchor" href="#django-wham" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>django-wham</h1>

<p><strong>REST APIs disguised as Django ORM Models</strong></p>

<p>With django-wham you can query REST APIs in exactly the same way you query Django Models:</p>

<pre><code>&gt;&gt;&gt; artist = SpotifyArtist.objects.get(id='5Z1XZyEFY0dewG8faEIiEx')
fetching https://api.spotify.com/v1/artists/5Z1XZyEFY0dewG8faEIiEx
&gt;&gt;&gt; print artist.name
Django Reinhardt
</code></pre>

<pre><code>&gt;&gt;&gt; twitter_user = TwitterUser.objects.get(screen_name='djangoproject')
fetching https://api.twitter.com/1.1/users/show.json?screen_name=djangoproject
&gt;&gt;&gt; for tweet in twitter_user.tweets.all():
&gt;&gt;&gt;     print tweet.text
fetching https://api.twitter.com/1.1/statuses/user_timeline.json?user_id=191225303
Django 1.7 release candidate 2 - It's almost here! Today we're pleased to announce the second release-candidate pa...
Django 1.7 release candidate 1 - It's almost here! Tonight we're pleased to announce the first release-candidate p...
...
</code></pre>

<h3><a id="user-content-creating-django-wham-models" class="anchor" href="#creating-django-wham-models" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Creating Django Wham Models</h3>

<p>In order to query a REST API (eg: Twitter, Flickr, Youtube, etc), you need a Wham Model. A Wham Model corresponds to an API Endpoint and has a special inner WhamMeta class that describes how the REST API should map to the Django Model.</p>

<p>This simple Wham Model that enables you too look up a Spotify Artist by its Spotify ID and retrieve some information about that artist.
In this case the names of the fields match the property names of the retrieved JSON data, so very little configuration is required.</p>

<pre><code>from wham.models import WhamModel

class SpotifyArtist(WhamModel):

    id = CharField(max_length=100, primary_key=True) 
        # the primary key field should be of the same name and type as the API Endpoint ID
        # rather than the default auto-incrementing key Django provides. For example,
        # '5Z1XZyEFY0dewG8faEIiEx' is the Spotify ID for Django Reinhardt.
    name = TextField()
    href = TextField()
    popularity = IntegerField()
    uri = UriField()

    class WhamMeta(SpotifyMeta):
        base_url = 'https://api.spotify.com/v1/'
        endpoint = 'artists'
</code></pre>

<p>Now we add another Spotify Endpoint, this time both of the Models' WhamMeta class inherit from a single class,
to share commonalities between endpoints such as the base url</p>

<pre><code>class SpotifyWhamMeta:
    base_url = 'https://api.spotify.com/v1/'

class SpotifyArtist(WhamModel):
    ...

    class WhamMeta(SpotifyWhamMeta):
        endpoint = 'artists'

class SpotifyAlbum(WhamModel):

    id = WhamCharField(max_length=255, primary_key=True)
    name = WhamTextField()
    release_date = WhamTextField(null=True)
    popularity = WhamIntegerField(null=True, wham_detailed=True)

    class WhamMeta(SpotifyWhamMeta):
        endpoint = 'albums'

</code></pre>

<h3><a id="user-content-many-to-many-endpoints" class="anchor" href="#many-to-many-endpoints" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Many To Many Endpoints</h3>

<p>Django Wham supports many to many endpoints such as <code>https://api.spotify.com/v1/artists/{id}/albums</code>.
This is possible by specifying a WhamManyToMany field and doing a little configuration.</p>

<p>To create a many to many field between Artists and Albums:</p>

<pre><code>class SpotifyArtist(WhamModel):
    ...

    albums = WhamManyToManyField(
        'SpotifyAlbum',
        wham_endpoint='artists/{{id}}/albums', #django template syntax is used to substitue the value of thd id
        wham_results_path=['items'] 
            # This is the 'path' where to find the list of results in the retreived JSON data.
            # The list or tuple represents a path in the JSON tree. A hypothetical example might be ['photos', 'results']
    )

    ...

</code></pre>

<h3><a id="user-content-wham-model-repository" class="anchor" href="#wham-model-repository" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Wham Model Repository</h3>

<p>Have a look at <a href="https://github.com/mbylstra/django-wham/tree/master/wham/apis">https://github.com/mbylstra/django-wham/tree/master/wham/apis</a> for some more examples of Wham Models. We're hoping this will become an ever growing repository of Wham Models for the multitude of public REST APIs on the web, so you won't have to write your own. If you have ever wanted to contribute to open source, but have been too daunted, creating a Wham Model is a fun and easy way to get started. Only basic Django experience is required.</p>

<h3><a id="user-content-installation-and-use-of-wham-models" class="anchor" href="#installation-and-use-of-wham-models" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation and use of Wham Models</h3>

<p>django-wham can be installed via PyPI:</p>

<pre><code>    pip install django-wham

</code></pre>

<p>Add some entries to your INSTALLED_APPS in your settings.py file. See <a href="https://github.com/mbylstra/django-wham/tree/master/wham/apis">https://github.com/mbylstra/django-wham/tree/master/wham/apis</a> for a list of example apis.</p>

<pre><code>INSTALLED_APPS = (
    ...
    'wham', #required
    'wham.apis.spotify', #an optional provided API
    'wham.apis.twitter', #optional
    'your_custom_wham_app' #this should be a Django app with one or more Wham Models in its models.py file
    ...
)

</code></pre>

<p>You must then run syncdb before you can start using any wham models</p>

<pre><code>python manage.py syncdb

</code></pre>

<p>Django wham models can be used just like regular Django Models</p>

<pre><code>from wham.apis.spotify import SpotifyArtist
SpotifyArtist.objects.filter(name__icontains="green")
</code></pre>

<h3><a id="user-content-demo" class="anchor" href="#demo" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>demo</h3>

<p>This git repository also comes with a demo django project and some Ipython notebook examples that can be run with <code>django manage.py shell_plus --notebook</code>. Your environment must have the packages in ipython-requirements.txt installed for this to work. </p>

<h3><a id="user-content-more-info" class="anchor" href="#more-info" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>More Info</h3>



<h3><a id="user-content-disclaimer" class="anchor" href="#disclaimer" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Disclaimer</h3>

<p><em>Django Wham is currently in an Alpha/Proof-of-Concept stage. While I am using it to great success in my project <a href="http://kaleidoscope.fm">http://kaleidoscope.fm</a>, there are probably many edge cases that it does not handle very well. I would not recommend using this in production just yet. If you are interested in using this, please contact me and I won't hestitate to help out. Any kind of feedback would also be highly appreciated (bug reports, suggestions for improvements, requests for more APIs to be supported) - please submit a Git issue!</em></p>
</article>
  </div></body></html>