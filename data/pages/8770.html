<html><body><div><div class="post-text" itemprop="text">

<p>I have a simple Python server that uses <a href="https://docs.python.org/3/library/http.server.html#module-http.server"><code>http.server</code></a>. The goal is not to show the video in a html page, or to download the video file, but to display the video in the browser directly. This is what I have so far:</p>

<pre><code>import http.server

class SuperHandler(http.server.SimpleHTTPRequestHandler):
    def do_GET(self):
        path = self.path
        encodedFilePath = 'file.mp4'

        with open(encodedFilePath, 'rb') as videoFile:
            self.send_response(200)
            self.send_header('Content-type', 'video/mp4')
            self.end_headers()
            self.wfile.write(videoFile.read())
            print('File sent: ' + videoFile.name)

server_address = ('', 8000)
handler_class = SuperHandler
httpd = http.server.HTTPServer(server_address, handler_class)
httpd.serve_forever()
</code></pre>

<p>The problem that I have is that the response doesn't contain the full video. <code>file.mp4</code> is 50MB, but when I look in the network tab of either Chrome or Firefox, it says that the response is only 1MB. Is there a reason why the full file isn't transferred? Do I need to add some sort of HTTP header to make this work?</p>

<p><strong>EDIT:</strong></p>

<p>This is my code now:</p>

<pre><code>server_address = ('', 8000)
handler_class = http.server.SimpleHTTPRequestHandler
httpd = http.server.HTTPServer(server_address, handler_class)

httpd.serve_forever()
</code></pre>

<p>I am now using the default SimpleHTTPRequestHandler's <code>do_GET</code>, but it's still not working (although the response is now 40MB/30MB instead of 1MB).</p>

<p>When I request <code>file.mp4</code> on Chrome, the socket connexion is closed after ~7 seconds (~5 seconds on Firefox), which makes the script throw a <code>BrokenPipeError: [Errno 32] Broken pipe</code>, <a href="http://stackoverflow.com/questions/11866792/how-to-prevent-errno-32-broken-pipe">because the server is still trying to write the rest of the video file on a closed socket</a>.</p>

<p>So my question is: how can I make the browser download the full response before it closes the socket?</p>

<p><strong>Additional info</strong></p>

<p>HTTP Response headers sent to the client:</p>

<pre><code>HTTP/1.0 200 OK
Server: SimpleHTTP/0.6 Python/3.5.0
Date: Mon, 28 Dec 2015 02:36:39 GMT
Content-type: video/mp4
Content-Length: 53038876
Last-Modified: Fri, 25 Dec 2015 02:09:52 GMT
</code></pre>
    </div>
    </div></body></html>