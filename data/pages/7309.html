<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-sklearn-deap" class="anchor" href="#sklearn-deap" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>sklearn-deap</h1>

<p>Use evolutionary algorithms instead of gridsearch in scikit-learn. This allows you to exponentially reduce the time required to find the best parameters for your estimator. Instead of trying out every possible combination of parameters, evolve only the combinations that give the best results.</p>

<p><a href="https://github.com/rsteca/sklearn-deap/blob/master/notebooks/test.ipynb">Here</a> is an ipython notebook comparing EvolutionaryAlgorithmSearchCV against GridSearchCV and RandomizedSearchCV.</p>

<p>It's implemented using deap library: <a href="https://github.com/deap/deap">https://github.com/deap/deap</a></p>

<h2><a id="user-content-install" class="anchor" href="#install" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Install</h2>

<p>To install the library use pip:</p>

<pre><code>pip install sklearn-deap
</code></pre>

<p>or clone the repo and just type the following on your shell:</p>

<pre><code>python setup.py install
</code></pre>

<h2><a id="user-content-usage-examples" class="anchor" href="#usage-examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage examples</h2>

<p>Example of usage:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> sklearn.datasets
<span class="pl-k">import</span> numpy <span class="pl-k">as</span> np
<span class="pl-k">import</span> random

data <span class="pl-k">=</span> sklearn.datasets.load_digits()
<span class="pl-c1">X</span> <span class="pl-k">=</span> data[<span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>]
y <span class="pl-k">=</span> data[<span class="pl-s"><span class="pl-pds">"</span>target<span class="pl-pds">"</span></span>]

<span class="pl-k">from</span> sklearn.svm <span class="pl-k">import</span> <span class="pl-c1">SVC</span>
<span class="pl-k">from</span> sklearn.cross_validation <span class="pl-k">import</span> StratifiedKFold

paramgrid <span class="pl-k">=</span> {<span class="pl-s"><span class="pl-pds">"</span>kernel<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>rbf<span class="pl-pds">"</span></span>],
             <span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>     : np.logspace(<span class="pl-k">-</span><span class="pl-c1">9</span>, <span class="pl-c1">9</span>, <span class="pl-v">num</span><span class="pl-k">=</span><span class="pl-c1">25</span>, <span class="pl-v">base</span><span class="pl-k">=</span><span class="pl-c1">10</span>),
             <span class="pl-s"><span class="pl-pds">"</span>gamma<span class="pl-pds">"</span></span> : np.logspace(<span class="pl-k">-</span><span class="pl-c1">9</span>, <span class="pl-c1">9</span>, <span class="pl-v">num</span><span class="pl-k">=</span><span class="pl-c1">25</span>, <span class="pl-v">base</span><span class="pl-k">=</span><span class="pl-c1">10</span>)}

random.seed(<span class="pl-c1">1</span>)

<span class="pl-k">from</span> evolutionary_search <span class="pl-k">import</span> EvolutionaryAlgorithmSearchCV
cv <span class="pl-k">=</span> EvolutionaryAlgorithmSearchCV(<span class="pl-v">estimator</span><span class="pl-k">=</span>SVC(),
                                   <span class="pl-v">params</span><span class="pl-k">=</span>paramgrid,
                                   <span class="pl-v">scoring</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>accuracy<span class="pl-pds">"</span></span>,
                                   <span class="pl-v">cv</span><span class="pl-k">=</span>StratifiedKFold(y, <span class="pl-v">n_folds</span><span class="pl-k">=</span><span class="pl-c1">4</span>),
                                   <span class="pl-v">verbose</span><span class="pl-k">=</span><span class="pl-c1">1</span>,
                                   <span class="pl-v">population_size</span><span class="pl-k">=</span><span class="pl-c1">50</span>,
                                   <span class="pl-v">gene_mutation_prob</span><span class="pl-k">=</span><span class="pl-c1">0.10</span>,
                                   <span class="pl-v">gene_crossover_prob</span><span class="pl-k">=</span><span class="pl-c1">0.5</span>,
                                   <span class="pl-v">tournament_size</span><span class="pl-k">=</span><span class="pl-c1">3</span>,
                                   <span class="pl-v">generations_number</span><span class="pl-k">=</span><span class="pl-c1">5</span>,
                                   <span class="pl-v">n_jobs</span><span class="pl-k">=</span><span class="pl-c1">4</span>)
cv.fit(<span class="pl-c1">X</span>, y)</pre></div>

<p>Output:</p>

<pre><code>    Types [1, 2, 2] and maxint [0, 24, 24] detected
    --- Evolve in 625 possible combinations ---
    gen nevals  avg         min     max
    0   50      0.202404    0.10128 0.962716
    1   26      0.383083    0.10128 0.962716
    2   31      0.575214    0.155259    0.962716
    3   29      0.758308    0.105732    0.976071
    4   22      0.938086    0.158041    0.976071
    5   26      0.934201    0.155259    0.976071
    Best individual is: {'kernel': 'rbf', 'C': 31622.776601683792, 'gamma': 0.001}
    with fitness: 0.976071229827
</code></pre>
</article>
  </div></body></html>