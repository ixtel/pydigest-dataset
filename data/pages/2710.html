<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-pasm---a-python-assembler" class="anchor" href="#pasm---a-python-assembler" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>PASM - A Python assembler</h1>

<p>Pasm is a x86 assember for python. The goal of PASM is to create JIT compiled built-in python modules from assembly source. PASM is small, fast and do not require any external modules. PASM syntax is easy to grasp. It makes developping python built-in extensions as painless as writing assembly can be. PASM works only on Windows requires Python 3.4 or later and a 32bit interpreter. PASM supports GP (general purpose), MMX, SSE and SSE2 instruction set.</p>

<p>PASM is licensed under MIT</p>

<p>PASM is very experimental and is far from being a stable product.</p>

<h2><a id="user-content-how-to-use" class="anchor" href="#how-to-use" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How to use</h2>

<p>First install pasm with</p>

<pre><code>setup.py install
</code></pre>

<p>You can then use the PASM import hook by importing it.</p>

<pre><code>import pasm

#You can now import asm files as if they where python modules

import mymodule
</code></pre>

<p>You can also use the compile function directly</p>

<pre><code>from pasm.compiler import compile

mod = compile("mymodule.asm")
</code></pre>

<h2><a id="user-content-syntax-guide" class="anchor" href="#syntax-guide" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Syntax guide</h2>

<p>Due to being JIT compiled, PASM do not work like your average assembler, although, its syntax is heavily inspired from <a href="http://flatassembler.net/">FASM</a>.</p>

<h3><a id="user-content-pasm-basic-syntax" class="anchor" href="#pasm-basic-syntax" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Pasm basic syntax</h3>

<ul>
<li>In PASM, all reserved names must be UPPERCASE. That is, all instructions, registers and types.</li>
<li>An indirect argument is between brackets <code>[EAX]</code></li>
<li>A size can be specified for an indirect argument using a type name before the argument. <code>DWORD [EAX]</code>.  If not specified, PASM indirect shortcut is used...</li>
<li>PASM have "indirect shortcut". That is <code>[AL]</code> is actually interpreted as <code>BYTE [EAX]</code>. This work with any registers. <code>[XMM1]</code> is <code>XWORD [ECX]</code></li>
<li>A size can also be specified for IMM <code>BYTE 5</code></li>
<li>A comment starts with ";" and end at the end of the line</li>
<li>An instruction ends with a newline. </li>
<li>With preprocessors, the character  "\" can be used to span the preprocessor on multiple lines. </li>
<li>PASM do not have macros</li>
</ul>

<p>*</p>

<pre><code>;A comment
Some_Label:                   ;A Label
    MOV  EAX, DWORD 6         ;Argument with specified size
    MOV  ECX, 100             ;Size is inferred from ECX
    MOV  EAX, ECX             ;An instruction using direct registers
    INC  WORD [EAX+100]       ;An instruction using indirect address  + disp
    CALL [EAX+ECX*8+10]       ;That is valid too
    CALL [Imported_function]  ;Label or names can also be used
    CALL [1000]               ;This is also valid (ugh)
    MOV  BX, [AX]             ;This is the equivalent of using "BX, WORD [EAX]"
</code></pre>

<h3><a id="user-content-pasm-types--registers" class="anchor" href="#pasm-types--registers" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Pasm types &amp; Registers</h3>

<p>PASM has a few types available. You can use them to specify an operand size or with the static preprocessor.</p>



<h3><a id="user-content-pasm-preprocessors" class="anchor" href="#pasm-preprocessors" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Pasm Preprocessors</h3>

<p>PASM has a few preprocessors in order to make writing extensions possible. </p>

<p><code>!preprocessor_name: &lt;preprocessor args&gt;</code></p>

<ul>
<li><strong>name:</strong> Specify the module name in python. If ignored, the filename will be used.

</li>
<li><strong>docs:</strong> Specify the module docstring in python. If ignored, no docstring is set.

</li>
<li><strong>arch:</strong> Specify the processor acrchitecture required for this script. Only <strong>x86</strong> is supported. Can be ignored

</li>
<li><strong>enter:</strong> A label pointing to a procedure to execute when the module is imported. The procedure must have this signature: <code>void (*init)(PyObject* module)</code>. Can be ignored.

</li>
<li><strong>mdef:</strong> Define a method in the module that will be accessible from python.
<strong>See:</strong>  <a href="https://docs.python.org/3/c-api/structures.html#c.PyMethodDef">PyMethodDef</a> 

<ul>
<li><code>!mdef: &lt;LABEL&gt; &lt;NAME&gt; &lt;DOCS&gt; &lt;FLAGS&gt;</code></li>
<li><code>!mdef: FUNC, "hello", "Say hello", METH_NOARGS</code></li>
</ul></li>
<li><strong>rstatic:</strong> Reserve X static variable of type in memory. Values are zeroed. See <strong>Pasm types</strong>

<ul>
<li><code>!rstatic: &lt;TYPE&gt; &lt;NAME&gt; &lt;LENGTH&gt;</code> </li>
<li><code>!rstatic: DWORD hello 5</code></li>
</ul></li>
<li><strong>static:</strong> Alloc static variables with a default value. A type name can be followed by "[]" to indicate an array. An integral value can be ended with "u" to indicate an unsigned value. See <strong>Pasm types</strong>

<ul>
<li><code>!static: &lt;TYPE&gt; &lt;NAME&gt; &lt;VALUE&gt;</code> </li>
<li><code>!static: WORD[] foo 90, 20, 30</code> </li>
<li><code>!static: QWORD zoo 83436432u</code> </li>
<li><code>!static: DWORD bar 8.87</code> </li>
<li><code>!static: STRING poo "HELLO"</code> </li>
<li><code>!static: PYOBJECT NONE None</code> </li>
</ul></li>
<li><strong>extern:</strong> Access functions located in shared libraries (DLL or SO). A name to use can be specified to rename a function in the script. The value <code>"PYTHON"</code> is reserved to access the python C api.

<ul>
<li><code>!extern: &lt;LIBNAME&gt;, [&lt;FUNCNAME&gt; [&lt;LABELNAME&gt;], ...]</code></li>
<li><code>!extern: "USER32", "MessageBoxA" MsgBox, "GetDesktopWindow"</code></li>
<li><code>!extern: "PYTHON", "PyLong_AsLong"</code></li>
</ul></li>
<li><strong>include:</strong> Include another file content at this position

</li>
</ul>
</article>
  </div></body></html>