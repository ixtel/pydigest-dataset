<html><body><div><div class="entry-content">
		<p>When running a complex Python program that takes quite a long time to execute, you might want to improve its execution time. But how?</p>
<p>First of all, you need the tools to detect the bottlenecks of your code, i.e. which parts take longer to execute. This way, you can concentrate in speeding these parts first.</p>
<p>And also, you should also control the memory and CPU usage, as it can point you towards new portions of code that could be improved.</p>
<p>Therefore, in this post I’ll comment on 7 different Python tools that give you some insight about the execution time of your functions and the Memory and CPU usage.</p>
<p><span id="more-648"/></p>
<h2>1. Use a decorator to time your functions</h2>
<p>The simpler way to time a function is to define a decorator that measures the elapsed time in running the function, and prints the result:</p>

		<div id="crayon-56b069a81d9b2306351657" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81d9b2306351657-1"><span class="crayon-e">import </span><span class="crayon-e">time</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-2"><span class="crayon-e">from </span><span class="crayon-e">functools </span><span class="crayon-e">import </span><span class="crayon-e">wraps</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-3"> </p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-4"> </p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-5"><span class="crayon-e">def </span><span class="crayon-e">fn_timer</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-6"><span class="crayon-h">    </span><span class="crayon-sy">@</span><span class="crayon-e">wraps</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-7"><span class="crayon-h">    </span><span class="crayon-e">def </span><span class="crayon-e">function_timer</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-v">kwargs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-8"><span class="crayon-h">        </span><span class="crayon-v">t0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-9"><span class="crayon-h">        </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-v">kwargs</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-10"><span class="crayon-h">        </span><span class="crayon-v">t1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-11"><span class="crayon-h">        </span><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"Total time running %s: %s seconds"</span><span class="crayon-h"> </span><span class="crayon-o">%</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-12"><span class="crayon-h">               </span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">.</span><span class="crayon-v">func_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">t1</span><span class="crayon-o">-</span><span class="crayon-v">t0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-13"><span class="crayon-h">               </span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-14"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">result</span></p><p class="crayon-line" id="crayon-56b069a81d9b2306351657-15"><span class="crayon-e">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">function_timer</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
Then, you have to add this decorator before the function you want to measure, like</p>

		<div id="crayon-56b069a81d9cc493171721" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81d9cc493171721-1"><span class="crayon-sy">@</span><span class="crayon-e">fn_timer</span></p><p class="crayon-line" id="crayon-56b069a81d9cc493171721-2"><span class="crayon-e">def </span><span class="crayon-e">myfunction</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81d9cc493171721-3"><span class="crayon-h">    </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
For example, let’s measure how long it takes to sort an array of 2000000 random numbers:</p>

		<div id="crayon-56b069a81d9d7349537140" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81d9d7349537140-1"><span class="crayon-sy">@</span><span class="crayon-e">fn_timer</span></p><p class="crayon-line" id="crayon-56b069a81d9d7349537140-2"><span class="crayon-e">def </span><span class="crayon-e">random_sort</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81d9d7349537140-3"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sorted</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81d9d7349537140-4"> </p><p class="crayon-line" id="crayon-56b069a81d9d7349537140-5"> </p><p class="crayon-line" id="crayon-56b069a81d9d7349537140-6"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81d9d7349537140-7"><span class="crayon-h"> </span><span class="crayon-e">random_sort</span><span class="crayon-sy">(</span><span class="crayon-cn">2000000</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
If you run your script, you should see something like</p>

		<div id="crayon-56b069a81d9e2088644113" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81d9e2088644113-1"><span class="crayon-e">Total </span><span class="crayon-e">time </span><span class="crayon-e">running </span><span class="crayon-v">random_sort</span><span class="crayon-o">:</span> <span class="crayon-cn">1.41124916077</span><span class="crayon-h"> </span><span class="crayon-v">seconds</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
</p><h2>2. Using the timeit module</h2>
<p>Anther option is to use the <a href="https://docs.python.org/2/library/timeit.html" target="_blank">timeit</a> module, which gives you an average time measure.</p>
<p>To run it, execute the following command in your terminal:</p>

		<div id="crayon-56b069a81d9ee984133273" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81d9ee984133273-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">python</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">m</span><span class="crayon-h"> </span><span class="crayon-v">timeit</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">r</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-s">"import timing_functions"</span><span class="crayon-h"> </span><span class="crayon-s">"timing_functions.random_sort(2000000)"</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
where <span>timing_functions</span> is the name of your script.</p>
<p>At the end of the output, you should see something like:</p>

		<div id="crayon-56b069a81d9f8446309714" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81d9f8446309714-1"><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-v">loops</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">best </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2.08</span><span class="crayon-h"> </span><span class="crayon-e">sec </span><span class="crayon-e">per </span><span class="crayon-v">loop</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
indicating that of 4 times running the test (<span>-n 4</span>), and averaging 5 repetitions on each test (<span>-r 5</span>), the best test result was of 2.08 seconds.</p>
<p>If you don’t specify the number of tests or repetitions, it defaults to 10 loops and 5 repetitions.</p>
<h2>3. Using the time Unix command</h2>
<p>However, both the decorator and the timeit module are based on Python. This is why the unix time utility may be useful, as it is an external Python measure.</p>
<p>To run the time utility type:</p>

		<div id="crayon-56b069a81da03610298673" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da03610298673-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">timing_functions</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
which gives the output:</p>

		<div id="crayon-56b069a81da0e498971128" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da0e498971128-1"><span class="crayon-e">Total </span><span class="crayon-e">time </span><span class="crayon-e">running </span><span class="crayon-v">random_sort</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1.3931210041</span><span class="crayon-h"> </span><span class="crayon-e">seconds</span></p><p class="crayon-line" id="crayon-56b069a81da0e498971128-2"><span class="crayon-i">real</span><span class="crayon-h">         </span><span class="crayon-cn">1.49</span></p><p class="crayon-line" id="crayon-56b069a81da0e498971128-3"><span class="crayon-i">user</span><span class="crayon-h">         </span><span class="crayon-cn">1.40</span></p><p class="crayon-line" id="crayon-56b069a81da0e498971128-4"><span class="crayon-i">sys</span><span class="crayon-h">          </span><span class="crayon-cn">0.08</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
The first line comes from the decorator we defined, and the other three:</p>
<ul>
<li>Real indicates the total time spent executing the script.</li>
<li>User indicates the amount of time the CPU spent executing the script</li>
<li>Sys indicates the amount of time spent in kernel-level functions.</li>
</ul>
<p>Note: as defined in <a href="http://en.wikipedia.org/wiki/Kernel_(operating_system)" target="_blank">wikipedia</a>, <em>the kernel is a computer program that manages input/output requests from software, and translates them into data processing instructions for the central processing unit (CPU) and other electronic components of a computer</em>.</p>
<p>Therefore, the difference between the real time and the sum of user+sys may indicate the time spent waiting for input/output or that the system is busy running other external tasks.</p>
<h2>4. Using the cProfile module</h2>
<p>If you want to know how much time is spent on each function and method, and how many times each of them is called, you can use the <a href="https://docs.python.org/2/library/profile.html" target="_blank">cProfile</a> module:</p>

		<div id="crayon-56b069a81da17085228194" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da17085228194-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">python</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">m</span><span class="crayon-h"> </span><span class="crayon-v">cProfile</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-e">cumulative </span><span class="crayon-v">timing_functions</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
Now you’ll see a detailed description of how many times each function in your code is called, and it will be sorted by the cumulative time spent on each one (thanks to the <span>-s cumulative</span> option).</p>
<p><a href="http://www.marinamele.com/wp-content/uploads/2014/11/cprofile_python.png"><img class="aligncenter wp-image-655 size-full" src="http://www.marinamele.com/wp-content/uploads/2014/11/cprofile_python.png" alt="cprofile_python"/></a></p>
<p>You’ll see that the total amount of time spent on running your script is higher than before. This is the penalty we pay for measuring the time each function takes to execute.</p>
<h2>5. Using line_profiler module</h2>
<p>The <a href="https://github.com/rkern/line_profiler" target="_blank">line_profiler</a> module gives you information about the CPU time spent on each line in your code.</p>
<p>This module has to be installed first, with</p>

		<div id="crayon-56b069a81da2c380382832" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da2c380382832-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">line_profiler</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
Next, you need to specify which functions you want to evaluate using the <span>@profile</span> decorator (you don’t need to import it in your file):</p>

		<div id="crayon-56b069a81da39392723122" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da39392723122-1"><span class="crayon-sy">@</span><span class="crayon-e">profile</span></p><p class="crayon-line" id="crayon-56b069a81da39392723122-2"><span class="crayon-e">def </span><span class="crayon-e">random_sort2</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81da39392723122-3"><span class="crayon-h">    </span><span class="crayon-v">l</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56b069a81da39392723122-4"><span class="crayon-h">    </span><span class="crayon-v">l</span><span class="crayon-sy">.</span><span class="crayon-e">sort</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81da39392723122-5"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">l</span></p><p class="crayon-line" id="crayon-56b069a81da39392723122-6"> </p><p class="crayon-line" id="crayon-56b069a81da39392723122-7"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81da39392723122-8"><span class="crayon-h">    </span><span class="crayon-e">random_sort2</span><span class="crayon-sy">(</span><span class="crayon-cn">2000000</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
Finally, you can obtain a line by line description of the <span>random_sort2</span> function by typing:</p>

		<div id="crayon-56b069a81da45908487687" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da45908487687-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">kernprof</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">l</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">timing_functions</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
where the <span>-l</span> flag indicates line-by-line and the <span>-v</span> flag indicates verbose output. With this method, we see that the array construction takes about 44% of the computation time, whereas the <span>sort()</span> method takes the remaining 56%.</p>
<p><a href="http://www.marinamele.com/wp-content/uploads/2014/11/kernprof_line_profiler.png"><img class="aligncenter wp-image-654 size-full" src="http://www.marinamele.com/wp-content/uploads/2014/11/kernprof_line_profiler.png" alt="kernprof_line_profiler"/></a></p>
<p>You will also see that due to the time measurements, the script might take longer to execute.</p>
<h2>6. Use the memory_profiler module</h2>
<p>The <a href="https://pypi.python.org/pypi/memory_profiler" target="_blank">memory_profiler</a> module is used to measure memory usage in your code, on a line-by-line basis. However, it can make your code to run much more slower.</p>
<p>Install it with</p>

		<div id="crayon-56b069a81da51344595751" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da51344595751-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">memory_profiler</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
Also, it is recommended to install the <a href="https://github.com/giampaolo/psutil" target="_blank">psutil</a> package, so that the <span>memory_profile</span> runs faster:</p>

		

<p>
In a similar way as the <span>line_profiler</span>, use the <span>@profile</span> decorator to mark which functions to track. Next, type:</p>

		<div id="crayon-56b069a81da7e466116808" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da7e466116808-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">python</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">m</span><span class="crayon-h"> </span><span class="crayon-e">memory_profiler </span><span class="crayon-v">timing_functions</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
yes, the previous script takes longer than the 1 or 2 seconds that took before. And if you didn’t install the <span>psutil</span> package, maybe you’re still waiting for the results!</p>
<p><a href="http://www.marinamele.com/wp-content/uploads/2014/11/memory_profiler.png"><img class="aligncenter wp-image-653 size-full" src="http://www.marinamele.com/wp-content/uploads/2014/11/memory_profiler.png" alt="memory_profiler"/></a></p>
<p>Looking at the output, note that the memory usage is expressed in terms of MiB, which stand for mebibyte (1MiB = 1.05MB).</p>
<h2>7. Using the guppy package</h2>
<p>Finally, with this package you’ll be able to track how many objects of each type (str, tuple, dict, etc) are created at each stage in your code.</p>
<p>Install it with</p>

		

<p>
Next, add it in your code as:</p>

		<div id="crayon-56b069a81da99030076276" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81da99030076276-1"><span class="crayon-e">from </span><span class="crayon-e">guppy </span><span class="crayon-e">import </span><span class="crayon-e">hpy</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-2"> </p><p class="crayon-line" id="crayon-56b069a81da99030076276-3"> </p><p class="crayon-line" id="crayon-56b069a81da99030076276-4"><span class="crayon-e">def </span><span class="crayon-e">random_sort3</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-5"><span class="crayon-h">    </span><span class="crayon-v">hp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hpy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-6"><span class="crayon-h">    </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Heap at the beginning of the function\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">hp</span><span class="crayon-sy">.</span><span class="crayon-e">heap</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-7"><span class="crayon-h">    </span><span class="crayon-v">l</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-8"><span class="crayon-h">    </span><span class="crayon-v">l</span><span class="crayon-sy">.</span><span class="crayon-e">sort</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-9"><span class="crayon-h">    </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Heap at the end of the function\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">hp</span><span class="crayon-sy">.</span><span class="crayon-e">heap</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-10"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">l</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-11"> </p><p class="crayon-line" id="crayon-56b069a81da99030076276-12"> </p><p class="crayon-line" id="crayon-56b069a81da99030076276-13"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56b069a81da99030076276-14"><span class="crayon-h">    </span><span class="crayon-e">random_sort3</span><span class="crayon-sy">(</span><span class="crayon-cn">2000000</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
And run your code with:</p>

		<div id="crayon-56b069a81daa5643848686" class="crayon-syntax crayon-theme-my-crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-mouseover">
		
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56b069a81daa5643848686-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">timing_functions</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
You’ll see something like the following output:</p>
<p><a href="http://www.marinamele.com/wp-content/uploads/2014/11/Guppy_Python.png"><img class="aligncenter wp-image-652 size-full" src="http://www.marinamele.com/wp-content/uploads/2014/11/Guppy_Python.png" alt="Guppy_Python"/></a></p>
<p>By placing the heap at different places in your code, you can study the object creation and deletion in the script flow.</p>
<p>If you want to learn more about speeding your Python code, I recommend you the book <a href="http://www.amazon.com/High-Performance-Python-Performant-Programming/dp/1449361595/ref=sr_1_1?ie=UTF8&amp;qid=1416157131&amp;sr=8-1&amp;keywords=high+performance+python&amp;pebp=1416157123265" target="_blank">High Performance Python: Practical Performant Programming for Humans</a>, september 2014.</p>
<p>Hope it was useful! <img src="http://www.marinamele.com/wp-includes/images/smilies/simple-smile.png" alt=":-)" class="wp-smiley"/></p>
<p>Don’t forget to share it with your friends!</p>
			</div>

	</div></body></html>