<html><body><div><div class="content-inner">
			
						
						
		   
			<p>The Client Analytics Team at Novus helps our clients use Alpha, the Novus portfolio analysis platform, to find creative ways to extend the capabilities of our platform and databases to meet our clients’ exact needs and provide ongoing support to our customers. Novus analysts are power users of the Alpha platform, and extend its capabilities to their functional limit.</p>
<p>Very often, fulfilling these goals requires us to work in spreadsheets. Microsoft Excel is the primary language of our clients, and we use the platform’s Excel extracts on a regular basis. A very common workflow at Novus two years ago was to navigate through dozens of pages online, download an Excel extract from each, combine all of the files into one large spreadsheet, and complete an analysis based on all of the data.</p>
<div id="attachment_7377" class="wp-caption alignnone"><a href="http://www.novus.com/tech-blog/wp-content/uploads/2015/06/excel.jpg"><img class="wp-image-7377 size-full" src="http://www.novus.com/tech-blog/wp-content/uploads/2015/06/excel.jpg" alt="augmenting your excel workflow with python"/></a><p class="wp-caption-text">An Excel spreadsheet generated with Python.</p></div>
<p> </p>
<p>So, when we started writing Python on the Analytics desk at Novus, one of the primary use cases was managing a large number of Excel files. Given the amount of manual effort this required, we knew there must be a better way.</p>
<p>We have several VBA-enabled Excel models that hit our databases directly through the Excel SQL add-in, but these workbooks were slow, crashed often, and couldn’t make use of the analytics that the Scala-based platform layered on top of the raw data.</p>
<p>So we turned to Python.</p>
<p>Today, we run hundreds of Python scripts a month that combine the spreadsheets we (or another script) have extracted from the platform. We’ve experimented with several Python packages to both read and write xls and xlsx files and built an internal package, nvat, to manage the start-to-finish workflow.</p>
<h2 id="AugmentingyourExcelworkflowwithPython-Readingxls%2Fxfiles">Reading xls/x files</h2>
<p>To read data in, we typically turn to <a href="https://pypi.python.org/pypi/xlrd" class="external-link" target="_blank" rel="nofollow">xlrd</a>. xlrd is often mentioned alongside its companion writer package, <a href="https://pypi.python.org/pypi/xlwt" class="external-link" target="_blank" rel="nofollow">xlwt</a>, but as you’ll see, we’ve found the latter package was missing some features we needed. xlrd provides the ability to quickly read Excel data into a Python object. Critically, it supports both .xls and .xlsx files, which differentiated it from <a href="https://openpyxl.readthedocs.org/en/latest/" class="external-link" target="_blank" rel="nofollow">openpyxl</a>, in our eyes.</p>
<p>xlrd also provides several useful utility functions. The most common one we use, as we’re frequently dealing with timeseries data, is <a href="http://stackoverflow.com/questions/3727916/how-to-use-xlrd-xldate-as-tuple" class="external-link" target="_blank" rel="nofollow">xldate_as_tuple()</a>:</p>

		<div id="crayon-56d5c91098719528968554" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c91098719528968554-1"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">from </span><span class="crayon-e">datetime </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098719528968554-2"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">xlrd</span></p><p class="crayon-line" id="crayon-56d5c91098719528968554-3"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">datetime</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">xlrd</span><span class="crayon-sy">.</span><span class="crayon-e">xldate_as_tuple</span><span class="crayon-sy">(</span><span class="crayon-cn">42159</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098719528968554-4"><span class="crayon-v">Out</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">datetime</span><span class="crayon-sy">(</span><span class="crayon-cn">2015</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
Many of our analysts are beginning programmers, or unfamiliar with Python. For that reason, we built a few simple wrapper functions around xlrd to make it easier to deal with. In particular, we put together read_sheet(), which turns one worksheet of an xlrd workbook object into a simple list of lists. Since our data is in a predictable format, and our analysts are very used to Excel, referring to cells by index came very naturally to everyone, and was highly effective.</p>

		<div id="crayon-56d5c91098733499710206" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5c91098733499710206-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c91098733499710206-2">2</p><p class="crayon-num" data-line="crayon-56d5c91098733499710206-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c91098733499710206-4">4</p><p class="crayon-num" data-line="crayon-56d5c91098733499710206-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c91098733499710206-6">6</p><p class="crayon-num" data-line="crayon-56d5c91098733499710206-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c91098733499710206-8">8</p><p class="crayon-num" data-line="crayon-56d5c91098733499710206-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c91098733499710206-10">10</p><p class="crayon-num" data-line="crayon-56d5c91098733499710206-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c91098733499710206-12">12</p><p class="crayon-num" data-line="crayon-56d5c91098733499710206-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c91098733499710206-14">14</p><p class="crayon-num" data-line="crayon-56d5c91098733499710206-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c91098733499710206-16">16</p><p class="crayon-num" data-line="crayon-56d5c91098733499710206-17">17</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c91098733499710206-1"><span class="crayon-e">def </span><span class="crayon-e">read_sheet</span><span class="crayon-sy">(</span><span class="crayon-v">workbook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sheet_num</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098733499710206-2"><span class="crayon-h">    </span><span class="crayon-s">""</span><span class="crayon-s">"Returns a list of lists of the data in each row of one worksheet of an xlrd workbook object</span></p><p class="crayon-line" id="crayon-56d5c91098733499710206-3"><span class="crayon-s">    Arguments:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098733499710206-4"><span class="crayon-s">    workbook - an xlrd workbook object</span></p><p class="crayon-line" id="crayon-56d5c91098733499710206-5"><span class="crayon-s">    sheet_num - index of worksheet to read</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098733499710206-6"><span class="crayon-s">    "</span><span class="crayon-s">""</span></p><p class="crayon-line" id="crayon-56d5c91098733499710206-7"><span class="crayon-h">    </span><span class="crayon-e">import </span><span class="crayon-e">xlrd</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098733499710206-8"><span class="crayon-e">    </span><span class="crayon-v">worksheet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">workbook</span><span class="crayon-sy">.</span><span class="crayon-e">sheet_by_index</span><span class="crayon-sy">(</span><span class="crayon-v">sheet_num</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c91098733499710206-9"><span class="crayon-h">    </span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098733499710206-10"><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c91098733499710206-11"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">worksheet</span><span class="crayon-sy">.</span><span class="crayon-v">nrows</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># Loop through entire workbook and create array of values</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098733499710206-12"><span class="crayon-h">        </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5c91098733499710206-13"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">col </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">worksheet</span><span class="crayon-sy">.</span><span class="crayon-v">ncols</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098733499710206-14"><span class="crayon-h">            </span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">worksheet</span><span class="crayon-sy">.</span><span class="crayon-e">cell</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-v">col</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c91098733499710206-15"><span class="crayon-h">        </span><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098733499710206-16"><span class="crayon-h">  </span></p><p class="crayon-line" id="crayon-56d5c91098733499710206-17"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">output</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
We’ve also built a few other functions using xlrd to combine multiple workbooks, such as combine_sheet which takes a specific worksheet from multiple files and makes each of them a tab in a new file, and combine_stacked which takes multiple Excel files with the same number of sheets, and stacks the data from each on top of one another, adding a column indicating the source workbook.</p>
<h2 id="AugmentingyourExcelworkflowwithPython-Writingxls%2Fxfiles">Writing xls/x files</h2>
<p>We passed over xlwt due to its lack of ability to write an xlsx file. While we’re still consuming xls at Novus, we make it a point not to produce more of these files.</p>
<p>To create .xlsx, we’ve turned to two packages: xlsxwriter and openpyxl.</p>
<h3 id="AugmentingyourExcelworkflowwithPython-xlsxwriter">xlsxwriter</h3>
<p>We’ve had a rather small use case for this package, array formulas. Unfortunately, openpyxl does not appear to have the ability (as of 1.8.6) to make use of one of Excel’s most powerful features, which allow you to perform operations like compounding returns over ranges of cells. xlsxwriter, however, does. It makes an appearance in our stack whenever an array formula is necessary, as it was when we worked with a client to rebuild an Excel tool it uses on a daily basis to consume Novus data. On the other hand, <a href="https://pypi.python.org/pypi/XlsxWriter" class="external-link" target="_blank" rel="nofollow">xlsxwriter </a>can’t read existing files, disqualifying it from full-time use.</p>

		<div id="crayon-56d5c91098742541536973" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c91098742541536973-1"><span class="crayon-e">xlsxwriter</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098742541536973-2"><span class="crayon-v">workbook</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">xlsxwriter</span><span class="crayon-sy">.</span><span class="crayon-e">Workbook</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c91098742541536973-3"><span class="crayon-v">workbook</span><span class="crayon-sy">.</span><span class="crayon-e">add_worksheet</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c91098742541536973-4"><span class="crayon-v">worksheet</span><span class="crayon-sy">.</span><span class="crayon-e">write_array_formula</span><span class="crayon-sy">(</span><span class="crayon-s">'AK10'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-s">'{=IFERROR(IF(AI2&lt;&gt;0,(AVERAGE(B4:INDEX(B:B,MATCH(AF7,A:A,0))-H4:INDEX(H:H,MATCH(AF7,A:A,0)))/(SQRT(SUM(((B4:INDEX(B:B,MATCH(AF7,A:A,0))-H4:INDEX(H:H,MATCH(AF7,A:A,0)))-AVERAGE(B4:INDEX(B:B,MATCH(AF7,A:A,0))-H4:INDEX(H:H,MATCH(AF7,A:A,0))))^2)/(COUNT(B4:INDEX(B:B,MATCH(AF7,A:A,0)))-1))))*SQRT(12),""),"-")}'</span><span class="crayon-s">''</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
Like many Excel formulas, it’s not pretty, but it gets the job done.</p>
<h3 id="AugmentingyourExcelworkflowwithPython-openpyxl">openpyxl</h3>
<p>Probably our favorite package of the bunch, <a href="https://openpyxl.readthedocs.org/en/latest/" class="external-link" target="_blank" rel="nofollow">openpyxl </a>is as powerful as it is usable. The syntax is highly accessible to anyone familiar with VBA.</p>
<p>Like with xlrd, we have added some internal functionality to make openpyxl more accessible to young programmers. In particular, the write_to_excel() function for turning lists of lists into xlsx files. On the other hand, we’ve found openpyxl’s formatting syntax frustrating and time-consuming. When we need formatted output, we generally create a template in Excel and paste formating into an unformatted xlsx file generated by openpyxl.</p>

		<div id="crayon-56d5c9109874f423606444" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c9109874f423606444-1"><span class="crayon-e">def </span><span class="crayon-e">write_to_excel</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ws</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rows</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c9109874f423606444-2"><span class="crayon-h">    </span><span class="crayon-s">""</span><span class="crayon-s">"Takes a list of lists, an openpyxl workbook, and an excel address in cols and rows</span></p><p class="crayon-line" id="crayon-56d5c9109874f423606444-3"><span class="crayon-s">       Writes to workbook in-place data from list of lists"</span><span class="crayon-s">""</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c9109874f423606444-4"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5c9109874f423606444-5"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">item </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c9109874f423606444-6"><span class="crayon-h">            </span><span class="crayon-v">address</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'{0}{1}'</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-e">get_column_letter</span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">rows</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c9109874f423606444-7"><span class="crayon-h">            </span><span class="crayon-v">ws</span><span class="crayon-sy">[</span><span class="crayon-v">address</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">item</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
Why don’t we use openpyxl exclusively? Unlike xlrd, opnepyxl can only read xlsx files. Still, this package has been a workhorse for Novus . Its documentation is very solid and its features grow with every release.</p>
<h3 id="AugmentingyourExcelworkflowwithPython-CSVs">CSVs</h3>
<p>I’d be remiss if I left out Python’s built-in <a href="https://docs.python.org/3.4/library/csv.html" class="external-link" target="_blank" rel="nofollow">csv</a> module. While csv can’t help you read an existing Excel file, it shines at creating simple output into a workbook, if you don’t need formatting or additional tabs. We’ve also found that for highly complex data-presentation cases, dumping a two-column csv into a well-formatted Excel front-end that uses VLOOKUP or INDEX-MATCH to locate data by key into the correct cell is highly effective. That method allows analysts’ Excel formatting and formula skills to shine while providing predictable, repeatable, data extraction. We make use of this method often.</p>

		<div id="crayon-56d5c9109876a572986996" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c9109876a572986996-1"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">file_out</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'w'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">newline</span><span class="crayon-o">=</span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">fo</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c9109876a572986996-2"><span class="crayon-h">        </span><span class="crayon-v">cw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">csv</span><span class="crayon-sy">.</span><span class="crayon-e">writer</span><span class="crayon-sy">(</span><span class="crayon-v">fo</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c9109876a572986996-3"><span class="crayon-h">        </span><span class="crayon-v">cw</span><span class="crayon-sy">.</span><span class="crayon-e">writerows</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
</p><h3 id="AugmentingyourExcelworkflowwithPython-Pandas">Pandas</h3>
<p>As a financial data company, we of course make heavy use of <a href="http://pandas.pydata.org/" class="external-link" rel="nofollow">pandas</a>. And while we’ve found that while pandas is adept at reading and writing xls/x files (via openpyxl), for many of our needs it’s simply overkill. Remember, we control most of our inputs, so often heavy munging, where pandas shines, is unnecessary. In general, we only use pandas to read and write xlsx files when we are performing intermediate calculations in pandas as well. If you have an Excel file you’re planning to use in a DataFrame, pandas Excel support cannot be ignored.<a href="http://pbpython.com/" class="external-link" rel="nofollow"> Practical Business Python</a> has provided several tutorials on integrating pandas into your Excel workflow that we’ve found incredibly valuable.</p>
<h2 id="AugmentingyourExcelworkflowwithPython-Summary">Summary</h2>
<p>Including Python in our analytics stack at Novus has greatly changed, for the better, our overall workflow. As a company that makes heavy use of Excel spreadsheets, finding the correct packages for our specific cases has been critical.</p>
<table class="confluenceTable tablesorter">
<thead>
<tr class="sortableHeader">
<th class="confluenceTh sortableHeader" data-column="0">
<p class="tablesorter-header-inner"><strong>Package</strong></p>
</th>
<th class="confluenceTh sortableHeader" data-column="1">
<p class="tablesorter-header-inner"><strong>Uses</strong></p>
</th>
<th class="confluenceTh sortableHeader" data-column="2">
<p class="tablesorter-header-inner"><strong>Limitations</strong></p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="confluenceTd"><strong><a href="https://pypi.python.org/pypi/xlrd" class="external-link" rel="nofollow">xlrd</a></strong></td>
<td class="confluenceTd"><strong>Reads Excel xls and xlsx files</strong></td>
<td class="confluenceTd"><strong>Unable to write files</strong></td>
</tr>
<tr>
<td class="confluenceTd"><strong><a href="https://pypi.python.org/pypi/xlwt" class="external-link" rel="nofollow">xlwt</a></strong></td>
<td class="confluenceTd"><strong>Writes xls files</strong></td>
<td class="confluenceTd"><strong>Unable to write xlsx files</strong></td>
</tr>
<tr>
<td class="confluenceTd"><strong><a href="https://pypi.python.org/pypi/XlsxWriter" class="external-link" rel="nofollow">xlsxwriter</a></strong></td>
<td class="confluenceTd"><strong>Creates xlsx files; supports array formulas</strong></td>
<td class="confluenceTd"><strong>Unable to modify existing files</strong></td>
</tr>
<tr>
<td class="confluenceTd"><strong><a href="https://openpyxl.readthedocs.org/en/latest/" class="external-link" rel="nofollow">openpyxl</a></strong></td>
<td class="confluenceTd"><strong>Reads and writes xlsx files</strong></td>
<td class="confluenceTd"><strong>No support for array formulas; cannot read xls files</strong></td>
</tr>
<tr>
<td class="confluenceTd" colspan="1"><strong><a href="https://docs.python.org/3.4/library/csv.html" class="external-link" rel="nofollow">csv</a></strong></td>
<td class="confluenceTd" colspan="1"><strong>Easy to use; built-in python module</strong></td>
<td class="confluenceTd" colspan="1"><strong>Does not support formulas, formatting, multiple tabs, etc.</strong></td>
</tr>
<tr>
<td class="confluenceTd"><strong><a href="http://pandas.pydata.org/" class="external-link" rel="nofollow">pandas</a></strong></td>
<td class="confluenceTd"><strong>Very easy to read into dataframe</strong></td>
<td class="confluenceTd"><strong>Functionality is complex for those not familiar with the other features of the package</strong></td>
</tr>
</tbody>
</table>
<p>Want to learn more about this and other technologies used at Novus Partners? Why not do it on-the-job! <a href="https://boards.greenhouse.io/novus48" target="_blank">Check out our openings.</a></p>
			
			 				
		</div>
		
	</div></body></html>