<html><body><div><div class="post-body entry-content" id="post-body-5608181982513781894" itemprop="description articleBody">
<p>Python has many features which usually stay unknown to many programmers. </p>

<h3>List Comprehensions</h3>

<p>List comprehensions are much simpler way of creating lists. This is one feature which is rather widely used and I saw this in many examples and source of many libraries.</p>

<p>Imagine you have a function which returns a list of data. A good example of this is <code>xrange(start, end)</code> function which returns all numbers within the range <code>[start, end)</code>, so it excludes the end. This is a generator, so it doesn't return all numbers at once, but you need to call this function many times, and each time it returns the next number.</p>

<p>Getting all numbers from range <code>[1, 10]</code> using this function can be done like this:</p>

<pre class="brush:python">
numbers = []
for i in xrange(1, 10):
    numbers.append(i)
</pre>

<p>If you want to get only the even numbers, then you can write:</p>

<pre class="brush:python">
numbers = []
for i in xrange(1, 11):
    if i % 2 == 0:
      numbers.append(i)
</pre>

<p>List comprehensions can make the code much simpler.</p>

<p>The whole expression evalutes to a list, and the main syntax is:</p>

<pre class="brush:python">
[ expression for item in list if conditional ]
</pre>

<p>The first example can be then written as:</p>

<pre class="brush:python">
numbers = [i for i in xrange(1, 11)]
</pre>

<p>and the second:</p>

<pre class="brush:python">
numbers = [i for i in xrange(1, 11) if i % 2 == 0]
</pre>

<p>Of course this syntax can be a little bit strange at the very first moment, but you can get used to it, and then the code can be much easier.</p>

<h3>Removing Duplicates</h3>

<p>Another common usage of collections is to remove duplicates. And again there are plenty of ways to do it.</p>

<p>Consider a collection like this:</p>

<pre class="brush:python">
numbers = [i for i in xrange(1,11)] + [i for i in xrange(1,6)]
</pre>

<p>The most complicated way of removing duplicates I've ever seen was:</p>

<pre class="brush:python">
unique_numbers = []
for n in numbers:
    if n not in unique_numbers:
        unique_numbers.append(n)
</pre>

<p>Of course it works, but there is another much easier way, you can use a standard type like <code>set</code>. Set cannot have duplicates, so when converting a list to set, all duplicates are removed. However at the end there will be set, not list, if you want to have list, then you should convert it again:</p>

<pre class="brush:python">
unique_numbers = list(set(numbers))
</pre>

<h3>Removing Object Duplicates</h3>

<p>With objects, or dictionaries, the situation is a little bit different. You can have a list of dictionaries, where you use just one field for identity, this can look like:</p>

<pre class="brush:python">
data = [
  {'id': 10, 'data': '...'},
  {'id': 11, 'data': '...'},
  {'id': 12, 'data': '...'},
  {'id': 10, 'data': '...'},
  {'id': 11, 'data': '...'},
]
</pre>

<p>Removing duplicates, again, can be done using more or less code. Less is better, of course. With more code it can be:</p>

<pre class="brush:python">
unique_data = []
for d in data:
    data_exists = False
    for ud in unique_data:
        if ud['id'] == d['id']:
          data_exists = True
          break
    if not data_exists:
        unique_data.append(d)
</pre>

<p>And this can be done using a thing I discoverd a couple of days ago, this is dictionary comprehension. It has a similar syntax as list comprehension, however evaluates to dicionary:</p>

<pre class="brush:python">
{ key:value for item in list if conditional }
</pre>

<p>This can be used to make a list without all duplicates using a custom field:</p>

<pre class="brush:python">
{ d['id']:d for d in data }.values()
</pre>

<p>The above code creates a dictionary with key, which is the field I want to use for uniqueness, and the whole dictionary as value. The dictionary then contains only one entry for each key. The <code>values()</code> function is used to get only values, as I don't need the key:value mappings any more.</p>
<p/>
</div>
</div></body></html>