<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-pyperform" class="anchor" href="#pyperform" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>PyPerform</h1>

<p>An easy and convenient way to performance test blocks of python code.
Tired of writing separate scripts for your performance tests? Don't like coding in strings?
Using the pyperform decorators, you can easily implement timeit tests to your functions with just one line!</p>

<h2><a id="user-content-features" class="anchor" href="#features" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Features</h2>

<p>Features of pyperform include:</p>

<pre><code>- Quick, easy to implement in-code performance tests that run once when the function is defined
- Speed comparison of several functions.
- Validation of results between ComparisonBenchmarks
- Summary reports.
- Supports class functions as well as global functions.
- Performance tests can easily be disabled/enabled globally.
- Community-driven library of performance tests to learn from.
</code></pre>

<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>

<p>To install:</p>

<pre><code>pip install pyperform
</code></pre>

<h2><a id="user-content-compatibility" class="anchor" href="#compatibility" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Compatibility</h2>

<p>PyPerform was developed in Python 2.7 but has been tested with Python 3.4. Please report any compatibility issues or
send pull requests with your changes!</p>

<h2><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h2>

<p>To use pyperform to benchmark functions, you need to add one of the following decorators:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-en">@BenchmarkedFunction</span>(<span class="pl-v">setup</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                     <span class="pl-v">classname</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                     <span class="pl-v">largs</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                     <span class="pl-v">kwargs</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                     <span class="pl-v">timeit_repeat</span><span class="pl-k">=</span><span class="pl-c1">3</span>,
                     <span class="pl-v">timeit_number</span><span class="pl-k">=</span><span class="pl-c1">1000</span>)

<span class="pl-en">@BenchmarkedClass</span>(<span class="pl-v">setup</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                  <span class="pl-v">largs</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                  <span class="pl-v">kwargs</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                  <span class="pl-v">timeit_repeat</span><span class="pl-k">=</span><span class="pl-c1">3</span>,
                  <span class="pl-v">timeit_number</span><span class="pl-k">=</span><span class="pl-c1">1000</span>)

<span class="pl-en">@ComparisonBenchmark</span>(group,
                     <span class="pl-v">classname</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                     <span class="pl-v">setup</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                     <span class="pl-v">largs</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                     <span class="pl-v">kwargs</span><span class="pl-k">=</span><span class="pl-c1">None</span>,
                     <span class="pl-v">validation</span><span class="pl-k">=</span><span class="pl-c1">False</span>,
                     <span class="pl-v">timeit_repeat</span><span class="pl-k">=</span><span class="pl-c1">3</span>,
                     <span class="pl-v">timeit_number</span><span class="pl-k">=</span><span class="pl-c1">1000</span>)
</pre></div>

<p>where largs is a list of arguments to pass to the function and kwargs is a dictionary of keyword arguments to pass to the 
function. The setup argument is described in the following section. All decorators have timeit_repeat and timeit_number
arguments which are can be used to set the number of trials and repetitions to use with timeit. The ComparisonBenchmark
has a validation flag, which when set to True, will attempt to compare the results of the functions in the group.</p>

<h2><a id="user-content-imports-and-setup-code" class="anchor" href="#imports-and-setup-code" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Imports and Setup Code</h2>

<p>Sometimes your decorated function will require some setup code or imported modules. You can easily include any lines of 
code by by appending the tag <code>#!</code> to the end of the line. For functions and classes, you only need to tag the <code>def</code> or
<code>class</code> line and PyPerform will include the entire function/class definition as setup code.</p>

<p>For example:</p>

<div class="highlight highlight-source-python"><pre>    <span class="pl-k">from</span> pyperform <span class="pl-k">import</span> BenchmarkedFunction

    <span class="pl-k">import</span> math <span class="pl-c">#!</span>
    a <span class="pl-k">=</span> <span class="pl-c1">10</span>  <span class="pl-c">#!</span>


    <span class="pl-k">def</span> <span class="pl-en">do_calcuation</span>(<span class="pl-smi">a</span>, <span class="pl-smi">b</span>): <span class="pl-c">#!</span>
        <span class="pl-k">return</span> a <span class="pl-k">*</span> b


    <span class="pl-en">@BenchmarkedFunction</span>(<span class="pl-v">largs</span><span class="pl-k">=</span>(<span class="pl-c1">5</span>,))
    <span class="pl-k">def</span> <span class="pl-en">call_function</span>(<span class="pl-smi">b</span>):
        <span class="pl-c"># We can reference the `a` variable because it is tagged</span>
        result <span class="pl-k">=</span> a <span class="pl-k">*</span> b
        <span class="pl-k">assert</span> result <span class="pl-k">==</span> <span class="pl-c1">50</span>
        <span class="pl-c"># We can call the math module because it is tagged.</span>
        math.log10(<span class="pl-c1">100</span>)
        <span class="pl-c"># We can call this function because it is tagged.</span>
        calc_result <span class="pl-k">=</span> do_calcuation(a, b)
        <span class="pl-k">return</span> calc_result
</pre></div>

<p>Results in:</p>

<pre><code>call_function    6.214 us
</code></pre>

<h2><a id="user-content-the-setup-argument-optional" class="anchor" href="#the-setup-argument-optional" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>The setup argument (Optional)</h2>

<p>All decorators have a setup argument which can be either a function with no arguments, or string of code. If given a
function, the body of the function is executed in the global scope. This means that objects and variables instantiated 
in the body of the function are accessible from within the benchmarked function.</p>

<p>Example:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> pyperform <span class="pl-k">import</span> BenchmarkedFunction

<span class="pl-k">def</span> <span class="pl-en">_setup</span>():
    a <span class="pl-k">=</span> <span class="pl-c1">10</span>

<span class="pl-en">@BenchmarkedFunction</span>(<span class="pl-v">setup</span><span class="pl-k">=</span>_setup, <span class="pl-v">largs</span><span class="pl-k">=</span>(<span class="pl-c1">5</span>,))
<span class="pl-k">def</span> <span class="pl-en">multiply_by_a</span>(<span class="pl-smi">b</span>):
    result <span class="pl-k">=</span> a <span class="pl-k">*</span> b
    <span class="pl-k">assert</span> result <span class="pl-k">==</span> <span class="pl-c1">50</span>
    <span class="pl-k">return</span> result
</pre></div>

<p>Results in:</p>

<pre><code>multiply_by_a    3.445 us
</code></pre>

<h2><a id="user-content-class-method-benchmarking" class="anchor" href="#class-method-benchmarking" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Class-method Benchmarking</h2>

<p>Pyperform will also work on class methods, but in order to do so, we must instantiate an instance of the class.
This is done in <code>BenchmarkedClass</code>. Then once we have decorated the class with <code>BenchmarkedClass</code>, we can use
<code>ComparisonBenchmark</code> or <code>BenchmarkedFunction</code> to performance test the class's methods.</p>

<p><b>Note that when benchmarking class methods, the <code>classname</code> argument to ComparisonBenchmark must be provided.
This argument will hopefully be removed in the future.</b></p>

<p>In the BenchmarkedClass we instantiate a Person object and then run three benchmarked class-methods.
Two of the class-methods are <code>ComparisonBenchmarks</code> and will be compared with one another. To see the result, you must
call the <code>ComparisonBenchmark.summarize()</code> function. The third function is a duplicate of calculate_savings_method2 but
it is a BenchmarkedFunction instead. The result of BenchmarkedFunctions is printed when the script is run.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> pyperform <span class="pl-k">import</span> BenchmarkedClass, ComparisonBenchmark, BenchmarkedFunction

<span class="pl-en">@BenchmarkedClass</span>(<span class="pl-v">largs</span><span class="pl-k">=</span>(<span class="pl-s"><span class="pl-pds">'</span>Calvin<span class="pl-pds">'</span></span>, <span class="pl-c1">24</span>, <span class="pl-c1">1000</span>.,), <span class="pl-v">kwargs</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>height<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>165 cm<span class="pl-pds">'</span></span>})
<span class="pl-k">class</span> <span class="pl-en">Person</span>(<span class="pl-c1">object</span>):

    <span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">name</span>, <span class="pl-smi">age</span>, <span class="pl-smi">monthly_income</span>, <span class="pl-smi">height</span><span class="pl-k">=</span><span class="pl-c1">None</span>, <span class="pl-k">*</span><span class="pl-smi">args</span>, <span class="pl-k">**</span><span class="pl-smi">kwargs</span>):
        <span class="pl-v">self</span>.name <span class="pl-k">=</span> name
        <span class="pl-v">self</span>.age <span class="pl-k">=</span> age
        <span class="pl-v">self</span>.height <span class="pl-k">=</span> height
        <span class="pl-v">self</span>.monthly_income <span class="pl-k">=</span> monthly_income


    <span class="pl-en">@ComparisonBenchmark</span>(<span class="pl-s"><span class="pl-pds">'</span>Calculate Savings<span class="pl-pds">'</span></span>, <span class="pl-v">classname</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Person<span class="pl-pds">"</span></span>, <span class="pl-v">timeit_number</span><span class="pl-k">=</span><span class="pl-c1">100</span>,
                         <span class="pl-v">validation</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-v">largs</span><span class="pl-k">=</span>(<span class="pl-c1">55</span>,), <span class="pl-v">kwargs</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>monthly_spending<span class="pl-pds">'</span></span>: <span class="pl-c1">500</span>})
    <span class="pl-k">def</span> <span class="pl-en">calculate_savings_method1</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">retirement_age</span>, <span class="pl-smi">monthly_spending</span><span class="pl-k">=</span><span class="pl-c1">0</span>):
        savings <span class="pl-k">=</span> <span class="pl-c1">0</span>
        <span class="pl-k">for</span> y <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-v">self</span>.age, retirement_age):
            <span class="pl-k">for</span> m <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">12</span>):
                savings <span class="pl-k">+=</span> <span class="pl-v">self</span>.monthly_income <span class="pl-k">-</span> monthly_spending
        <span class="pl-k">return</span> savings

    <span class="pl-en">@ComparisonBenchmark</span>(<span class="pl-s"><span class="pl-pds">'</span>Calculate Savings<span class="pl-pds">'</span></span>, <span class="pl-v">classname</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Person<span class="pl-pds">"</span></span>, <span class="pl-v">timeit_number</span><span class="pl-k">=</span><span class="pl-c1">100</span>,
                         <span class="pl-v">validation</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-v">largs</span><span class="pl-k">=</span>(<span class="pl-c1">55</span>,), <span class="pl-v">kwargs</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>monthly_spending<span class="pl-pds">'</span></span>: <span class="pl-c1">500</span>})
    <span class="pl-k">def</span> <span class="pl-en">calculate_savings_method2</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">retirement_age</span>, <span class="pl-smi">monthly_spending</span><span class="pl-k">=</span><span class="pl-c1">0</span>):
        yearly_income <span class="pl-k">=</span> <span class="pl-c1">12</span> <span class="pl-k">*</span> (<span class="pl-v">self</span>.monthly_income <span class="pl-k">-</span> monthly_spending)
        n_years <span class="pl-k">=</span> retirement_age <span class="pl-k">-</span> <span class="pl-v">self</span>.age
        <span class="pl-k">if</span> n_years <span class="pl-k">&gt;</span> <span class="pl-c1">0</span>:
            <span class="pl-k">return</span> yearly_income <span class="pl-k">*</span> n_years

    <span class="pl-en">@BenchmarkedFunction</span>(<span class="pl-v">classname</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Person<span class="pl-pds">"</span></span>, <span class="pl-v">timeit_number</span><span class="pl-k">=</span><span class="pl-c1">100</span>,
                         <span class="pl-v">largs</span><span class="pl-k">=</span>(<span class="pl-c1">55</span>,), <span class="pl-v">kwargs</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>monthly_spending<span class="pl-pds">'</span></span>: <span class="pl-c1">500</span>})
    <span class="pl-k">def</span> <span class="pl-en">same_as_method_2</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">retirement_age</span>, <span class="pl-smi">monthly_spending</span><span class="pl-k">=</span><span class="pl-c1">0</span>):
        yearly_income <span class="pl-k">=</span> <span class="pl-c1">12</span> <span class="pl-k">*</span> (<span class="pl-v">self</span>.monthly_income <span class="pl-k">-</span> monthly_spending)
        n_years <span class="pl-k">=</span> retirement_age <span class="pl-k">-</span> <span class="pl-v">self</span>.age
        <span class="pl-k">if</span> n_years <span class="pl-k">&gt;</span> <span class="pl-c1">0</span>:
            <span class="pl-k">return</span> yearly_income <span class="pl-k">*</span> n_years
</pre></div>

<p>You can print the summary to file or if ComparisonBenchmark.summarize() is not given an fs parameter, it will print to
console.</p>

<div class="highlight highlight-source-python"><pre>report_file <span class="pl-k">=</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>report.txt<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>w<span class="pl-pds">'</span></span>)
ComparisonBenchmark.summarize(<span class="pl-v">group</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Calculate Savings<span class="pl-pds">'</span></span>, <span class="pl-v">fs</span><span class="pl-k">=</span>report_file)
</pre></div>

<p>This results in a file <code>report.txt</code> that contains the ComparisonBenchmark's results:</p>

<pre><code>Call statement:

    instance.calculate_savings_method2(55, monthly_spending=500)


Rank     Function Name                       Time         % of Fastest    timeit_repeat   timeit_number 
------------------------------------------------------------------------------------------------------------------------

1        Person.calculate_savings_method2    267.093 ns   100.0           3               100           
2        Person.calculate_savings_method1    35.623 us    0.7             3               100           
------------------------------------------------------------------------------------------------------------------------



Source Code:
------------------------------------------------------------------------------------------------------------------------


def calculate_savings_method2(self, retirement_age, monthly_spending=0):
    yearly_income = 12 * (self.monthly_income - monthly_spending)
    n_years = retirement_age - self.age
    if n_years &gt; 0:
        return yearly_income * n_years
------------------------------------------------------------------------------------------------------------------------


def calculate_savings_method1(self, retirement_age, monthly_spending=0):
    savings = 0
    for y in range(self.age, retirement_age):
        for m in range(12):
            savings += self.monthly_income - monthly_spending
    return savings
------------------------------------------------------------------------------------------------------------------------
</code></pre>

<p>and printed to the screen, the results of the BenchmarkedFunction</p>

<pre><code>same_as_method_2     262.827 ns
</code></pre>

<h2><a id="user-content-validation" class="anchor" href="#validation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Validation</h2>

<p>ComparisonBenchmark has a optional argument <code>validate</code>. When <code>validate=True</code>, the return value of each 
ComparisonBenchmark in a group is compared. If the results of the function are the not same, a ValidationError is raised.</p>

<p>Example:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> pyperform <span class="pl-k">import</span> ComparisonBenchmark
<span class="pl-k">from</span> math <span class="pl-k">import</span> sin  <span class="pl-c">#!</span>


<span class="pl-en">@ComparisonBenchmark</span>(<span class="pl-s"><span class="pl-pds">'</span>Group1<span class="pl-pds">'</span></span>, <span class="pl-v">validation</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-v">largs</span><span class="pl-k">=</span>(<span class="pl-c1">100</span>,))
<span class="pl-k">def</span> <span class="pl-en">list_append</span>(<span class="pl-smi">n</span>, <span class="pl-k">*</span><span class="pl-smi">args</span>, <span class="pl-k">**</span><span class="pl-smi">kwargs</span>):
    l <span class="pl-k">=</span> []
    <span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-v">xrange</span>(<span class="pl-c1">1</span>, n):
        l.append(sin(i))
    <span class="pl-k">return</span> l


<span class="pl-en">@ComparisonBenchmark</span>(<span class="pl-s"><span class="pl-pds">'</span>Group1<span class="pl-pds">'</span></span>, <span class="pl-v">validation</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-v">largs</span><span class="pl-k">=</span>(<span class="pl-c1">100</span>,))
<span class="pl-k">def</span> <span class="pl-en">list_comprehension</span>(<span class="pl-smi">n</span>, <span class="pl-k">*</span><span class="pl-smi">args</span>, <span class="pl-k">**</span><span class="pl-smi">kwargs</span>):
    <span class="pl-k">return</span> <span class="pl-c1">1</span>
</pre></div>

<p>Output:</p>

<pre><code>pyperform.ValidationError: Results of functions list_append and list_comprehension are not equivalent.
list_append:     [0.8414709848078965, 0.9092974268256817, 0.1411200080598672, -0.7568024953079282, -0.9589242746631385, -0.27941549819892586, 0.6569865987187891, 0.9893582466233818, 0.4121184852417566, -0.5440211108893698, -0.9999902065507035, -0.5365729180004349, 0.4201670368266409, 0.9906073556948704, 0.6502878401571168, -0.2879033166650653, -0.9613974918795568, -0.750987246771676, 0.14987720966295234, 0.9129452507276277, 0.8366556385360561, -0.008851309290403876, -0.8462204041751706, -0.9055783620066239, -0.13235175009777303, 0.7625584504796027, 0.956375928404503, 0.27090578830786904, -0.6636338842129675, -0.9880316240928618, -0.404037645323065, 0.5514266812416906, 0.9999118601072672, 0.5290826861200238, -0.428182669496151, -0.9917788534431158, -0.6435381333569995, 0.2963685787093853, 0.9637953862840878, 0.7451131604793488, -0.158622668804709, -0.9165215479156338, -0.8317747426285983, 0.017701925105413577, 0.8509035245341184, 0.9017883476488092, 0.123573122745224, -0.7682546613236668, -0.9537526527594719, -0.26237485370392877, 0.6702291758433747, 0.9866275920404853, 0.39592515018183416, -0.5587890488516163, -0.9997551733586199, -0.5215510020869119, 0.43616475524782494, 0.9928726480845371, 0.6367380071391379, -0.3048106211022167, -0.9661177700083929, -0.7391806966492228, 0.16735570030280691, 0.9200260381967906, 0.8268286794901034, -0.026551154023966794, -0.8555199789753223, -0.8979276806892913, -0.11478481378318722, 0.7738906815578891, 0.9510546532543747, 0.25382336276203626, -0.6767719568873076, -0.9851462604682474, -0.38778163540943045, 0.5661076368981803, 0.9995201585807313, 0.5139784559875352, -0.4441126687075084, -0.9938886539233752, -0.6298879942744539, 0.31322878243308516, 0.9683644611001854, 0.7331903200732922, -0.1760756199485871, -0.9234584470040598, -0.8218178366308225, 0.03539830273366068, 0.8600694058124533, 0.8939966636005579, 0.10598751175115685, -0.7794660696158047, -0.9482821412699473, -0.24525198546765434, 0.683261714736121, 0.9835877454343449, 0.3796077390275217, -0.5733818719904229, -0.9992068341863537]
list_comprehension: 1
</code></pre>
</article>
  </div></body></html>