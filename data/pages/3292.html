<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-rdpy--" class="anchor" href="#rdpy--" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>RDPY <a href="https://travis-ci.org/citronneur/rdpy"><img src="https://camo.githubusercontent.com/3be58afe4e3143f94ce45a3d662367e386ec1dcb/68747470733a2f2f7472617669732d63692e6f72672f636974726f6e6e6575722f726470792e7376673f6272616e63683d646576" alt="Build Status" data-canonical-src="https://travis-ci.org/citronneur/rdpy.svg?branch=dev"/></a> <a href="http://badge.fury.io/py/rdpy"><img src="https://camo.githubusercontent.com/0a0b8ab1d44cd45e660fe076b548004caee20672/68747470733a2f2f62616467652e667572792e696f2f70792f726470792e706e67" alt="PyPI version" data-canonical-src="https://badge.fury.io/py/rdpy.png"/></a></h1>

<p>Remote Desktop Protocol in twisted python.</p>

<p>RDPY is a pure Python implementation of the Microsoft RDP (Remote Desktop Protocol) protocol (client and server side). RDPY is built over the event driven network engine Twisted. RDPY support standard RDP security layer, RDP over SSL and NLA authentication (through ntlmv2 authentication protocol).</p>

<p>RDPY provides the following RDP and VNC binaries :</p>

<ul>
<li>RDP Man In The Middle proxy which record session</li>
<li>RDP Honeypot</li>
<li>RDP screenshoter</li>
<li>RDP client</li>
<li>VNC client</li>
<li>VNC screenshoter</li>
<li>RSS Player</li>
</ul>

<h2><a id="user-content-build" class="anchor" href="#build" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Build</h2>

<p>RDPY is fully implemented in python, except the bitmap decompression algorithm which is implemented in C for performance purposes.</p>

<h3><a id="user-content-dependencies" class="anchor" href="#dependencies" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Dependencies</h3>

<p>Dependencies are only needed for pyqt4 binaries :</p>

<ul>
<li>rdpy-rdpclient</li>
<li>rdpy-rdpscreenshot</li>
<li>rdpy-vncclient</li>
<li>rdpy-vncscreenshot</li>
<li>rdpy-rssplayer</li>
</ul>

<h4><a id="user-content-linux" class="anchor" href="#linux" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Linux</h4>

<p>Example for Debian based systems :</p>

<pre><code>sudo apt-get install python-qt4
</code></pre>

<h4><a id="user-content-os-x" class="anchor" href="#os-x" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>OS X</h4>

<p>Example for OS X to install PyQt with homebrew</p>

<pre><code>$ brew install qt sip pyqt
</code></pre>

<h4><a id="user-content-windows" class="anchor" href="#windows" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Windows</h4>



<h3><a id="user-content-build-1" class="anchor" href="#build-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Build</h3>

<pre><code>$ git clone https://github.com/citronneur/rdpy.git rdpy
$ pip install twisted pyopenssl qt4reactor service_identity rsa pyasn1
$ python rdpy/setup.py install
</code></pre>

<p>Or use PIP:</p>

<pre><code>$ pip install rdpy
</code></pre>

<p>For virtualenv, you will need to link the qt4 library to it:</p>

<pre><code>$ ln -s /usr/lib/python2.7/dist-packages/PyQt4/ $VIRTUAL_ENV/lib/python2.7/site-packages/
$ ln -s /usr/lib/python2.7/dist-packages/sip.so $VIRTUAL_ENV/lib/python2.7/site-packages/
</code></pre>

<h2><a id="user-content-rdpy-binaries" class="anchor" href="#rdpy-binaries" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>RDPY Binaries</h2>

<p>RDPY comes with some very useful binaries. These binaries are linux and windows compatible.</p>

<h3><a id="user-content-rdpy-rdpclient" class="anchor" href="#rdpy-rdpclient" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>rdpy-rdpclient</h3>

<p>rdpy-rdpclient is a simple RDP Qt4 client.</p>

<pre><code>$ rdpy-rdpclient.py [-u username] [-p password] [-d domain] [-r rss_ouput_file] [...] XXX.XXX.XXX.XXX[:3389]
</code></pre>

<p>You can use rdpy-rdpclient in a Recorder Session Scenario, used in rdpy-rdphoneypot.</p>

<h3><a id="user-content-rdpy-vncclient" class="anchor" href="#rdpy-vncclient" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>rdpy-vncclient</h3>

<p>rdpy-vncclient is a simple VNC Qt4 client .</p>

<pre><code>$ rdpy-vncclient.py [-p password] XXX.XXX.XXX.XXX[:5900]
</code></pre>

<h3><a id="user-content-rdpy-rdpscreenshot" class="anchor" href="#rdpy-rdpscreenshot" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>rdpy-rdpscreenshot</h3>

<p>rdpy-rdpscreenshot saves login screen in file.</p>

<pre><code>$ rdpy-rdpscreenshot.py [-w width] [-l height] [-o output_file_path] XXX.XXX.XXX.XXX[:3389]
</code></pre>

<h3><a id="user-content-rdpy-vncscreenshot" class="anchor" href="#rdpy-vncscreenshot" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>rdpy-vncscreenshot</h3>

<p>rdpy-vncscreenshot saves the first screen update in file.</p>

<pre><code>$ rdpy-vncscreenshot.py [-p password] [-o output_file_path] XXX.XXX.XXX.XXX[:5900]
</code></pre>

<h3><a id="user-content-rdpy-rdpmitm" class="anchor" href="#rdpy-rdpmitm" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>rdpy-rdpmitm</h3>

<p>rdpy-rdpmitm is a RDP proxy allows you to do a Man In The Middle attack on RDP protocol.
Record Session Scenario into rss file which can be replayed by rdpy-rssplayer.</p>

<pre><code>$ rdpy-rdpmitm.py -o output_dir [-l listen_port] [-k private_key_file_path] [-c certificate_file_path] [-r (for XP or server 2003 client)] target_host[:target_port]
</code></pre>

<p>Output directory is used to save the rss file with following format (YYYYMMDDHHMMSS_ip_index.rss)
The private key file and the certificate file are classic cryptographic files for SSL connections. The RDP protocol can negotiate its own security layer If one of both parameters are omitted, the server use standard RDP as security layer.</p>

<h3><a id="user-content-rdpy-rdphoneypot" class="anchor" href="#rdpy-rdphoneypot" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>rdpy-rdphoneypot</h3>

<p>rdpy-rdphoneypot is an RDP honey Pot. Use Recorded Session Scenario to replay scenario through RDP Protocol.</p>

<pre><code>$ rdpy-rdphoneypot.py [-l listen_port] [-k private_key_file_path] [-c certificate_file_path] rss_file_path_1 ... rss_file_path_N
</code></pre>

<p>The private key file and the certificate file are classic cryptographic files for SSL connections. The RDP protocol can negotiate its own security layer. If one of both parameters are omitted, the server use standard RDP as security layer.
You can specify more than one files to match more common screen size.</p>

<h3><a id="user-content-rdpy-rssplayer" class="anchor" href="#rdpy-rssplayer" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>rdpy-rssplayer</h3>

<p>rdpy-rssplayer is use to replay Record Session Scenario (rss) files generates by either rdpy-rdpmitm or rdpy-rdpclient binaries.</p>

<pre><code>$ rdpy-rssplayer.py rss_file_path
</code></pre>

<h2><a id="user-content-rdpy-qt-widget" class="anchor" href="#rdpy-qt-widget" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>RDPY Qt Widget</h2>

<p>RDPY can also be used as Qt widget through rdpy.ui.qt4.QRemoteDesktop class. It can be embedded in your own Qt application. qt4reactor must be used in your app for Twisted and Qt to work together. For more details, see sources of rdpy-rdpclient.</p>

<h2><a id="user-content-rdpy-library" class="anchor" href="#rdpy-library" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>RDPY library</h2>

<p>In a nutshell RDPY can be used as a protocol library with a twisted engine.</p>

<h3><a id="user-content-simple-rdp-client" class="anchor" href="#simple-rdp-client" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Simple RDP Client</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> rdpy.protocol.rdp <span class="pl-k">import</span> rdp

<span class="pl-k">class</span> <span class="pl-en">MyRDPFactory</span>(<span class="pl-e">rdp</span>.<span class="pl-e">ClientFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">clientConnectionLost</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">connector</span>, <span class="pl-smi">reason</span>):
        reactor.stop()

    <span class="pl-k">def</span> <span class="pl-en">clientConnectionFailed</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">connector</span>, <span class="pl-smi">reason</span>):
        reactor.stop()

    <span class="pl-k">def</span> <span class="pl-en">buildObserver</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">controller</span>, <span class="pl-smi">addr</span>):

        <span class="pl-k">class</span> <span class="pl-en">MyObserver</span>(<span class="pl-e">rdp</span>.<span class="pl-e">RDPClientObserver</span>):

            <span class="pl-k">def</span> <span class="pl-en">onReady</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Call when stack is ready</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>
                <span class="pl-c">#send 'r' key</span>
                <span class="pl-v">self</span>._controller.sendKeyEventUnicode(<span class="pl-c1">ord</span>(<span class="pl-v">unicode</span>(<span class="pl-s"><span class="pl-pds">"</span>r<span class="pl-pds">"</span></span>.toUtf8(), <span class="pl-v">encoding</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>)), <span class="pl-c1">True</span>)
                <span class="pl-c">#mouse move and click at pixel 200x200</span>
                <span class="pl-v">self</span>._controller.sendPointerEvent(<span class="pl-c1">200</span>, <span class="pl-c1">200</span>, <span class="pl-c1">1</span>, true)

            <span class="pl-k">def</span> <span class="pl-en">onUpdate</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">destLeft</span>, <span class="pl-smi">destTop</span>, <span class="pl-smi">destRight</span>, <span class="pl-smi">destBottom</span>, <span class="pl-smi">width</span>, <span class="pl-smi">height</span>, <span class="pl-smi">bitsPerPixel</span>, <span class="pl-smi">isCompress</span>, <span class="pl-smi">data</span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Notify bitmap update</span>
<span class="pl-s">                @param destLeft: xmin position</span>
<span class="pl-s">                @param destTop: ymin position</span>
<span class="pl-s">                @param destRight: xmax position because RDP can send bitmap with padding</span>
<span class="pl-s">                @param destBottom: ymax position because RDP can send bitmap with padding</span>
<span class="pl-s">                @param width: width of bitmap</span>
<span class="pl-s">                @param height: height of bitmap</span>
<span class="pl-s">                @param bitsPerPixel: number of bit per pixel</span>
<span class="pl-s">                @param isCompress: use RLE compression</span>
<span class="pl-s">                @param data: bitmap data</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onSessionReady</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Windows session is ready</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onClose</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Call when stack is close</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

        <span class="pl-k">return</span> MyObserver(controller)

<span class="pl-k">from</span> twisted.internet <span class="pl-k">import</span> reactor
reactor.connectTCP(<span class="pl-s"><span class="pl-pds">"</span>XXX.XXX.XXX.XXX<span class="pl-pds">"</span></span>, <span class="pl-c1">3389</span>, MyRDPFactory())
reactor.run()</pre></div>

<h3><a id="user-content-simple-rdp-server" class="anchor" href="#simple-rdp-server" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Simple RDP Server</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> rdpy.protocol.rdp <span class="pl-k">import</span> rdp

<span class="pl-k">class</span> <span class="pl-en">MyRDPFactory</span>(<span class="pl-e">rdp</span>.<span class="pl-e">ServerFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">buildObserver</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">controller</span>, <span class="pl-smi">addr</span>):

        <span class="pl-k">class</span> <span class="pl-en">MyObserver</span>(<span class="pl-e">rdp</span>.<span class="pl-e">RDPServerObserver</span>):

            <span class="pl-k">def</span> <span class="pl-en">onReady</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Call when server is ready</span>
<span class="pl-s">                to send and receive messages</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onKeyEventScancode</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">code</span>, <span class="pl-smi">isPressed</span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Event call when a keyboard event is catch in scan code format</span>
<span class="pl-s">                @param code: scan code of key</span>
<span class="pl-s">                @param isPressed: True if key is down</span>
<span class="pl-s">                @see: rdp.RDPServerObserver.onKeyEventScancode</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onKeyEventUnicode</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">code</span>, <span class="pl-smi">isPressed</span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Event call when a keyboard event is catch in unicode format</span>
<span class="pl-s">                @param code: unicode of key</span>
<span class="pl-s">                @param isPressed: True if key is down</span>
<span class="pl-s">                @see: rdp.RDPServerObserver.onKeyEventUnicode</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onPointerEvent</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">x</span>, <span class="pl-smi">y</span>, <span class="pl-smi">button</span>, <span class="pl-smi">isPressed</span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Event call on mouse event</span>
<span class="pl-s">                @param x: x position</span>
<span class="pl-s">                @param y: y position</span>
<span class="pl-s">                @param button: 1, 2 or 3 button</span>
<span class="pl-s">                @param isPressed: True if mouse button is pressed</span>
<span class="pl-s">                @see: rdp.RDPServerObserver.onPointerEvent</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onClose</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Call when human client close connection</span>
<span class="pl-s">                @see: rdp.RDPServerObserver.onClose</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

        <span class="pl-k">return</span> MyObserver(controller)

<span class="pl-k">from</span> twisted.internet <span class="pl-k">import</span> reactor
reactor.listenTCP(<span class="pl-c1">3389</span>, MyRDPFactory())
reactor.run()</pre></div>

<h3><a id="user-content-simple-vnc-client" class="anchor" href="#simple-vnc-client" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Simple VNC Client</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> rdpy.protocol.rfb <span class="pl-k">import</span> rfb

<span class="pl-k">class</span> <span class="pl-en">MyRFBFactory</span>(<span class="pl-e">rfb</span>.<span class="pl-e">ClientFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">clientConnectionLost</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">connector</span>, <span class="pl-smi">reason</span>):
        reactor.stop()

    <span class="pl-k">def</span> <span class="pl-en">clientConnectionFailed</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">connector</span>, <span class="pl-smi">reason</span>):
        reactor.stop()

    <span class="pl-k">def</span> <span class="pl-en">buildObserver</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">controller</span>, <span class="pl-smi">addr</span>):
        <span class="pl-k">class</span> <span class="pl-en">MyObserver</span>(<span class="pl-e">rfb</span>.<span class="pl-e">RFBClientObserver</span>):

            <span class="pl-k">def</span> <span class="pl-en">onReady</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Event when network stack is ready to receive or send event</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onUpdate</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">width</span>, <span class="pl-smi">height</span>, <span class="pl-smi">x</span>, <span class="pl-smi">y</span>, <span class="pl-smi">pixelFormat</span>, <span class="pl-smi">encoding</span>, <span class="pl-smi">data</span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Implement RFBClientObserver interface</span>
<span class="pl-s">                @param width: width of new image</span>
<span class="pl-s">                @param height: height of new image</span>
<span class="pl-s">                @param x: x position of new image</span>
<span class="pl-s">                @param y: y position of new image</span>
<span class="pl-s">                @param pixelFormat: pixefFormat structure in rfb.message.PixelFormat</span>
<span class="pl-s">                @param encoding: encoding type rfb.message.Encoding</span>
<span class="pl-s">                @param data: image data in accordance with pixel format and encoding</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onCutText</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">text</span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: event when server send cut text event</span>
<span class="pl-s">                @param text: text received</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onBell</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: event when server send biiip</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

            <span class="pl-k">def</span> <span class="pl-en">onClose</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
                <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">                @summary: Call when stack is close</span>
<span class="pl-s">                <span class="pl-pds">"""</span></span>

        <span class="pl-k">return</span> MyObserver(controller)

<span class="pl-k">from</span> twisted.internet <span class="pl-k">import</span> reactor
reactor.connectTCP(<span class="pl-s"><span class="pl-pds">"</span>XXX.XXX.XXX.XXX<span class="pl-pds">"</span></span>, <span class="pl-c1">3389</span>, MyRFBFactory())
reactor.run()</pre></div>
</article>
  </div></body></html>