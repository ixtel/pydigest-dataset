<html><body><div><section class="entry">
<p class="fsb-clear"/><p><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_osx_vs_ubuntu.jpg"><img class="aligncenter wp-image-2663" src="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_osx_vs_ubuntu.jpg" alt="matplotlib_osx_vs_ubuntu" srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_osx_vs_ubuntu-300x121.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_osx_vs_ubuntu.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a></p>
<p>I think a better title for this blog post might be: <em><strong>How I lost a day of productivity to Ubuntu, virtual environments, matplotlib, and rendering backends.</strong></em></p>
<p>Over the weekend I was playing around with deep learning on my Ubuntu system and went to plot the accuracy scores of my classifier. I coded up a quick Python script using <a href="http://matplotlib.org/" target="_blank">matplotlib</a>, executed the script, <strong>only to not have the figure displayed to my screen</strong>.</p>
<p>My script executed just fine. No error messages. No warnings. <em><strong>But there was still no plot to be found!</strong></em></p>
<p>This is actually a common problem I’ve ran into over the past few months, <em>especially</em> when working with Debian based operating systems such as Ubuntu and Raspbian. This issue is only further compounded when utilizing virtual environments via the <a href="https://virtualenv.pypa.io/en/latest/" target="_blank">virtualenv</a> and <a href="https://virtualenvwrapper.readthedocs.org/en/latest/" target="_blank">virtualenvwrapper</a> packages.</p>
<p>The issue actually stems from the <a href="http://matplotlib.org/faq/usage_faq.html#what-is-a-backend" target="_blank">matplotlib backend</a> not being properly set, or from a missing dependency when compiling and installing matplotlib. Luckily, after a lot of trial and error (and spending an entire day trying to come up with a solution), I have been able to resolve the problem and get matplotlib figures to show up and display on my screen on both the Ubuntu and Raspbian operating systems (and when using Python virtual environments).</p>
<p>While this post is not exactly related to computer vision or OpenCV, I still want to share my experience and solution with other PyImageSearch readers. Matplotlib is a heavily used package in the Python scientific community and I hope that this article helps other readers resolve this strange and hard to pinpoint issue.</p>
<h1>Setting the stage</h1>
<p>Let’s go ahead and set the stage.</p>
<ul>
<li>We’re using a Debian based operating system such as Ubuntu or Raspbian.</li>
<li>We’re (optionally) utilizing Python virtual environments via virtualenv and virtualenvwrapper.</li>
<li>And our goal is to take the following image <em>(left)</em> and compute a grayscale pixel intensity histogram for it using matplotlib <em>(right)</em>:</li>
</ul>
<div id="attachment_2667" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_histogram_example.jpg"><img class="wp-image-2667" src="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_histogram_example.jpg" alt="Figure 1: Our end goal is to utilize matplotlib to display a grayscale pixel intensity for the image on the left." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_histogram_example-300x141.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_histogram_example.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 1:</strong> Our end goal is to utilize matplotlib to display a grayscale pixel intensity for the image on the left.</p></div>
<p>Since we are using <a href="http://matplotlib.org/" target="_blank">matplotlib</a>, let’s create a new virtual environment called 
			<span id="crayon-56d581d308e24887543144" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">plotting</span></span></span> :</p>

		

<p>Now that we’re in the 
			<span id="crayon-56d581d308e31759548731" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">plotting</span></span></span>  environment, let’s install 
			<span id="crayon-56d581d308e34612929369" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">numpy</span></span></span> , 
			<span id="crayon-56d581d308e38962519908" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">scipy</span></span></span> , and 
			<span id="crayon-56d581d308e3b441656364" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span> :</p>

		<div id="crayon-56d581d308e3e554032647" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308e3e554032647-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-i">numpy</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e3e554032647-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-i">scipy</span></p><p class="crayon-line" id="crayon-56d581d308e3e554032647-3"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">matplotlib</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Awesome — all of our Python dependencies are installed. Now, let’s write a few lines of code to load the image, convert it to grayscale, compute a histogram over the grayscale image, and finally display it to our screen. I’ll throw all this code into a file named 
			<span id="crayon-56d581d308e42149931738" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">grayscale_histogram</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> :</p>

		<div id="crayon-56d581d308e45369347063" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d581d308e45369347063-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-2">2</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-4">4</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-6">6</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-8">8</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-10">10</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-12">12</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-14">14</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-16">16</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-18">18</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-20">20</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d581d308e45369347063-22">22</p><p class="crayon-num" data-line="crayon-56d581d308e45369347063-23">23</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308e45369347063-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">matplotlib </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-4"> </p><p class="crayon-line" id="crayon-56d581d308e45369347063-5"><span class="crayon-c"># load the image, convert it to grayscale, and show it</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-6"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-s">"raptors.jpg"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-7"><span class="crayon-v">gray</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_BGR2GRAY</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-8"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-9"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Gray"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gray</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-10"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-12"><span class="crayon-c"># construct a grayscale histogram</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-13"><span class="crayon-v">hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">calcHist</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">gray</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">256</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">256</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-14"> </p><p class="crayon-line" id="crayon-56d581d308e45369347063-15"><span class="crayon-c"># plot the histogram</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-17"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">"Grayscale Histogram"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-18"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">"Bins"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-19"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">"# of Pixels"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-20"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">hist</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-21"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlim</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">256</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e45369347063-22"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e45369347063-23"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The code here is fairly straightforward. <strong>Lines 1 and 2</strong> import 
			<span id="crayon-56d581d308e49651223530" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  and 
			<span id="crayon-56d581d308e4d841077949" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span></span></span> . We then load our image and convert it to grayscale (<strong>Lines 4-9</strong>). From there the 
			<span id="crayon-56d581d308e50363590805" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">calcHist</span></span></span>  function is used to compute a histogram over the grayscale pixel intensities. Finally, <strong>Lines 14-22</strong> plot the histogram using 
			<span id="crayon-56d581d308e54264079182" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span> .</p>
<p>To execute our script, all we need to do is fire up and shell and issue the following command:</p>

		<div id="crayon-56d581d308e57901963850" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308e57901963850-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">grayscale_histogram</span><span class="crayon-e">.py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>When I execute the code on my OSX machine in the 
			<span id="crayon-56d581d308e5b317710687" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">plotting</span></span></span>  virtual environment, the histogram is computed and both the grayscale image and histogram are displayed to my screen:</p>
<div id="attachment_2660" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_osx_plotting.jpg"><img class="wp-image-2660" src="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_osx_plotting.jpg" alt="Figure 2: Using OSX, I can successfully plot and display my grayscale histogram using matplotlib." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_osx_plotting-300x188.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_osx_plotting.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 2:</strong> Using OSX, I can successfully plot and display my grayscale histogram using matplotlib.</p></div>
<p>However, when I go over to my Ubuntu 14.04 machine and execute <em>the exact same code </em>all I see are my images:</p>
<div id="attachment_2662" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_ubuntu_not_showing.jpg"><img class="wp-image-2662" src="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_ubuntu_not_showing.jpg" alt="Figure 3: I have executed the *exact same* code on my Ubuntu system in the plotting virtual environment. All I see are my images -- where did my histogram go? Why is there no error message?" srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_ubuntu_not_showing-300x229.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_ubuntu_not_showing.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 3:</strong> I have executed the <em>exact same</em> code on my Ubuntu system in the plotting virtual environment. All I see are my images — <em>where did my histogram go?</em> Why is there no error message?</p></div>
<p>Which leads to the question: <em>“<strong>Where is the histogram?”</strong></em></p>
<p>As we can see from the terminal output, the script executed just fine. No errors were displayed. No warning messages printed to my console. <em><strong>But yet there is not plot!</strong></em></p>
<h1>Resolved: Matplotlib figures not showing up or displaying</h1>
<p>As I hinted at earlier in this post, the missing figure issue is related to the <a href="http://matplotlib.org/faq/usage_faq.html#what-is-a-backend" target="_blank">matplotlib backend</a> that does all the heavy lifting behind the scenes to prepare the figure.</p>
<p>Popping into a shell, I can access the matplotlib backend using the 
			<span id="crayon-56d581d308e60462382998" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">get_backend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span> :</p>

		<div id="crayon-56d581d308e63860570317" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308e63860570317-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e63860570317-2"><span class="crayon-i">Python</span><span class="crayon-h"> </span><span class="crayon-cn">3.4.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">Apr</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-cn">2014</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-o">:</span><span class="crayon-cn">05</span><span class="crayon-o">:</span><span class="crayon-cn">11</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d581d308e63860570317-3"><span class="crayon-sy">[</span><span class="crayon-i">GCC</span><span class="crayon-h"> </span><span class="crayon-cn">4.8.2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">on </span><span class="crayon-e">linux</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e63860570317-4"><span class="crayon-r">Type</span><span class="crayon-h"> </span><span class="crayon-s">"help"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"copyright"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"credits"</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-s">"license"</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r">more</span><span class="crayon-h"> </span><span class="crayon-v">information</span><span class="crayon-sy">.</span></p><p class="crayon-line" id="crayon-56d581d308e63860570317-5"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e63860570317-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-e">.get_backend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e63860570317-7"><span class="crayon-s">'agg'</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>On my Ubuntu machine this gives me a value of 
			<span id="crayon-56d581d308e67740790129" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">agg</span></span></span> ; however, through my testing and debugging, this value needs to be 
			<span id="crayon-56d581d308e6a491078545" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">TkAgg</span></span></span>  for the TkInter windowing system (at least when using Ubuntu and Raspbian).</p>
<p>Luckily, we can resolve this issue by using 
			<span id="crayon-56d581d308e6d290615363" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-v">get</span></span></span>  to install a few libraries:</p>

		<div id="crayon-56d581d308e71418326973" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308e71418326973-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-r">get</span><span class="crayon-h"> </span><span class="crayon-e">install </span><span class="crayon-v">tcl</span><span class="crayon-o">-</span><span class="crayon-e">dev </span><span class="crayon-v">tk</span><span class="crayon-o">-</span><span class="crayon-e">dev </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-e">tk </span><span class="crayon-v">python3</span><span class="crayon-o">-</span><span class="crayon-v">tk</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>But we’re not quite done yet. In order to get matplotlib to recognize the TkInter GUI library, we need to:</p>
<ul>
<li><strong>Step 1: </strong>Access our 
			<span id="crayon-56d581d308e74272805334" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">plotting</span></span></span>  virtual environment via 
			<span id="crayon-56d581d308e78127660380" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-e">workon </span><span class="crayon-v">plotting</span></span></span> .</li>
<li><strong>Step 2: </strong>Use pip to <em><strong>uninstall</strong></em> 
			<span id="crayon-56d581d308e7b246607558" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span> (since we installed it via pip earlier in this article).</li>
<li><strong>Step 3: </strong>Pull down <a href="https://github.com/matplotlib/matplotlib.git" target="_blank">matplotlib from the GitHub repo</a>.</li>
<li><strong>Step 4: </strong>Install 
			<span id="crayon-56d581d308e7f046735408" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  from source using 
			<span id="crayon-56d581d308e82937414497" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">setup</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> .</li>
</ul>
<p>I can accomplish these steps using the following commands:</p>

		<div id="crayon-56d581d308e85918661333" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308e85918661333-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">workon </span><span class="crayon-i">plotting</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e85918661333-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">uninstall </span><span class="crayon-i">matplotlib</span></p><p class="crayon-line" id="crayon-56d581d308e85918661333-3"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">git </span><span class="crayon-r">clone</span><span class="crayon-h"> </span><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">github</span><span class="crayon-e">.com</span><span class="crayon-o">/</span><span class="crayon-v">matplotlib</span><span class="crayon-o">/</span><span class="crayon-v">matplotlib</span><span class="crayon-e">.git</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e85918661333-4"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">cd</span><span class="crayon-h"> </span><span class="crayon-i">matplotlib</span></p><p class="crayon-line" id="crayon-56d581d308e85918661333-5"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">setup</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-v">install</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Again, you’ll want to ensure that you have installed TkInter via 
			<span id="crayon-56d581d308e89161598794" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-v">get</span></span></span>  before performing these steps.</p>
<p>After 
			<span id="crayon-56d581d308e8c489091223" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  has been installed via source, let’s execute the 
			<span id="crayon-56d581d308e90320642611" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-e">get_backend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span>  function again:</p>

		<div id="crayon-56d581d308e93110666421" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308e93110666421-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e93110666421-2"><span class="crayon-i">Python</span><span class="crayon-h"> </span><span class="crayon-cn">3.4.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">Apr</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-cn">2014</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-o">:</span><span class="crayon-cn">05</span><span class="crayon-o">:</span><span class="crayon-cn">11</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d581d308e93110666421-3"><span class="crayon-sy">[</span><span class="crayon-i">GCC</span><span class="crayon-h"> </span><span class="crayon-cn">4.8.2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">on </span><span class="crayon-e">linux</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e93110666421-4"><span class="crayon-r">Type</span><span class="crayon-h"> </span><span class="crayon-s">"help"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"copyright"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"credits"</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-s">"license"</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r">more</span><span class="crayon-h"> </span><span class="crayon-v">information</span><span class="crayon-sy">.</span></p><p class="crayon-line" id="crayon-56d581d308e93110666421-5"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d581d308e93110666421-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-e">.get_backend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d581d308e93110666421-7"><span class="crayon-s">'TkAgg'</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Sure enough, we now see the 
			<span id="crayon-56d581d308e97317860340" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">TkAgg</span></span></span>  is being used as the 
			<span id="crayon-56d581d308e9a320086124" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  backend.</p>
<p><strong><em>Note: </em></strong><em>You can explicitly instruct 
			<span id="crayon-56d581d308e9d463700258" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  to use the 
			<span id="crayon-56d581d308ea1792368356" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">TkAgg</span></span></span>  backend by making a call to 
			<span id="crayon-56d581d308ea4993228897" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-s">"TkAgg"</span><span class="crayon-sy">)</span></span></span> ; however, this won’t do you much good if the TkInter dependencies are not installed.</em></p>
<p>And now when we execute our 
			<span id="crayon-56d581d308ea7133532257" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">grayscale_histogram</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  script, just like above:</p>

		<div id="crayon-56d581d308eab086295050" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308eab086295050-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">grayscale_histogram</span><span class="crayon-e">.py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><em><strong>We should now see both our grayscale image along with our histogram:</strong></em></p>
<div id="attachment_2665" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_ubuntu_showing.jpg"><img class="wp-image-2665" src="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_ubuntu_showing.jpg" alt="Figure 4: Success! Our matplotlib figure is now showing up! All we need to do was change the matplotlib backend." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_ubuntu_showing-300x229.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/07/matplotlib_ubuntu_showing.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 4:</strong> Success! Our matplotlib figure is now showing up! All we need to do was change the matplotlib backend.</p></div>
<p>We have now fixed our issue — matplotlib figures are successfully being displayed on our screen!</p>
<p>Granted, this solution is a bit of a pain in the ass, but it’s fairly straightforward and gets the job done. If you have any other suggestions or comments, please feel free to leave them in the comments section.</p>
<h1>What about the Raspberry Pi?</h1>
<p>The Raspbian operating system, which many Raspberry Pi’s run, is Debian based just like Ubuntu. If you are having the same problems with matplotlib figures not displaying on your Raspberry Pi, the fix detailed in this blog post will resolve your plotting woes.</p>
<h1>Can’t you just install matplotlib via apt-get?</h1>
<p>The astute Debian user may be wondering why I didn’t simply install 
			<span id="crayon-56d581d308eaf074858399" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  via 
			<span id="crayon-56d581d308eb3660580656" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-v">get</span></span></span> , like this:</p>

		<div id="crayon-56d581d308eb6364668589" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d581d308eb6364668589-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-r">get</span><span class="crayon-h"> </span><span class="crayon-e">install </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-v">matplotlib</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The reason is because I’m a <em><strong>heavy user of Python virtual environments </strong></em>and strictly believe in keeping my Python environments sequestered and independent of each other. If you use 
			<span id="crayon-56d581d308eba356028876" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-v">get</span></span></span>  to install 
			<span id="crayon-56d581d308ebd692608267" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  you lose control over what version of 
			<span id="crayon-56d581d308ec0474209270" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  you want to install — you simply have to use with whatever version is in the 
			<span id="crayon-56d581d308ec4053273855" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-v">get</span></span></span>  repository. This also muddles your system install of Python which I try to keep as clean as possible.</p>
<p>All that said, every time I have installed 
			<span id="crayon-56d581d308ec7476391155" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  via 
			<span id="crayon-56d581d308ecb031404639" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-v">get</span></span></span>  all of my dependencies were correctly installed and I was able to display my figures without a problem, so if you do not care about Python virtual environments, then the 
			<span id="crayon-56d581d308ece376768151" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-v">get</span></span></span>  solution is a good way to go. But again, I really recommend using virtual environments.</p>
<h1>Summary</h1>
<p>In this blog post I detailed how to resolve a pesky issue where 
			<span id="crayon-56d581d308ed2505283735" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  figures are not displayed to your screen. Symptoms of this problem include clean script execution (i.e. no error messages and no warnings) printed to your terminal, and yet your plot is not displayed. I have regularly encountered this problem when using Debian based operating systems such as Ubuntu and Raspbian. The problem is only further compounded when using Python virtual environments.</p>
<p>Resolving this 
			<span id="crayon-56d581d308ed5313862294" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  issue involves manually installing dependencies via 
			<span id="crayon-56d581d308ed9954668498" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-v">get</span></span></span>  and adjusting the <a href="http://matplotlib.org/faq/usage_faq.html#what-is-a-backend" target="_blank">matplotlib backend</a> to use 
			<span id="crayon-56d581d308edc260834825" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">TkAgg</span></span></span> , followed by compiling and installing 
			<span id="crayon-56d581d308ee0187608708" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  from source. Afterwards, the issue seems to be resolved.</p>
<p>While this post wasn’t related to computer vision, the 
			<span id="crayon-56d581d308ee3388078426" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  library is heavily used in the scientific Python community, so not having your 
			<span id="crayon-56d581d308ee6458946776" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">matplotlib</span></span></span>  figures displayed can be extremely frustrating and annoying. I hope this post helps other readers who encounter a similar problem.</p>
<p>I’ll be back next week with more computer vision posts!</p>
	</section>
	</div></body></html>