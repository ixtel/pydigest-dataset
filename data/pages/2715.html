<html><body><div><div class="text-content">

								
								


<p><a href="http://i1.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/7.jpg"><img class="alignnone size-large wp-image-11987" src="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/7-1024x576.jpg?resize=1024%2C576" alt="7" srcset="http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/7.jpg?resize=300%2C169 300w, http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/7.jpg?resize=1024%2C576 1024w" sizes="(max-width: 1024px) 100vw, 1024px" data-recalc-dims="1"/></a></p>
<p>No doubt, the above picture looks like one of the in-built desktop backgrounds. All credits to my sister, who clicks weird things which somehow become really tempting to eyes. However, we have been born in an era of digital photography, we rarely wonder how are these pictures stored in memory or how are the various transformations made in a photograph.</p>
<p>In this article, I will take you through some of the basic features of image processing. The ultimate goal of this data massaging remains the same : feature extraction. But here we need more intensive data cleaning. But data cleaning is done on datasets , tables , text etc. How is this done on an image? We will look at how an image is stored on a disc and how we can manipulate an image using this underlying data?</p>
<h3><strong>Importing an Image</strong></h3>
<p>Importing an image in python is easy. Following code will help you import an image on Python :</p>
<p><a href="http://i1.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/1.png"><img class="alignnone size-full wp-image-11988" src="http://i1.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/1.png?resize=620%2C401" alt="1" srcset="http://i0.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/1.png?resize=300%2C194 300w, http://i0.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/1.png?w=620 620w" sizes="(max-width: 620px) 100vw, 620px" data-recalc-dims="1"/></a></p>
<h3><strong>Understanding the underlying data</strong></h3>
<p>This image has several colors and many pixels. To visualize how this image is stored, think of every pixel as a cell in matrix. Now this cell contains three different intensity information, catering to the color Red, Green and Blue. So a RGB image becomes a 3-D matrix. Each number is the intensity of Red, Blue and Green colors.</p>
<p>Let’s look at a few transformations:</p>
<p><a href="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/2.png"><img class="alignnone size-full wp-image-11989" src="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/2.png?resize=721%2C357" alt="2" srcset="http://i2.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/2.png?resize=300%2C149 300w, http://i2.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/2.png?w=721 721w" sizes="(max-width: 721px) 100vw, 721px" data-recalc-dims="1"/></a></p>
<p>As you can see in the above image, we manipulated the third dimension and got the transformation done. Yellow is not a direct color available in our dictionary but comes out as combination of red and green. We got the transformation done by setting up intensity of other colors as zero.</p>
<h3><strong>Converting Images to a 2-D matrix</strong></h3>
<p>Handling the third dimension of images sometimes can be complex and redundant. In feature extraction, it becomes much simpler if we compress the image to a 2-D matrix. This is done by Gray-scaling or Binarizing. Gray scaling is richer than Binarizing as it shows the image as a combination of different intensities of Gray. Whereas binarzing simply builds a matrix full of 0s and 1s.</p>
<p>Here is how you convert a RGB image to Gray scale:</p>
<p><a href="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/3.png"><img class="alignnone size-full wp-image-11990" src="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/3.png?resize=725%2C419" alt="3" srcset="http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/3.png?resize=300%2C173 300w, http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/3.png?w=725 725w" sizes="(max-width: 725px) 100vw, 725px" data-recalc-dims="1"/></a></p>
<p>As you can see, the dimension of the image has been reduced to two in Grayscale. However, the features are equally visible in the two images. This is the reason why Grayscale takes much lesser space when stored on Disc.</p>
<p>Now let’s try to binarize this Grayscale image. This is done by finding a threshold and flagging the pixels of Grayscale. In this article I have used Otsu’s method to find the threshold. Otsu’s method calculates an “optimal” threshold by maximizing the variance between two classes of pixels, which are separated by the threshold. Equivalently, this threshold minimizes the intra-class variance.</p>
<p>Following is a code to do this transformation:</p>
<p><a href="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/4.png"><img class="alignnone size-full wp-image-11991" src="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/4.png?resize=708%2C328" alt="4" srcset="http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/4.png?resize=300%2C139 300w, http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/4.png?w=708 708w" sizes="(max-width: 708px) 100vw, 708px" data-recalc-dims="1"/></a></p>
<h3><strong>Blurring an Image</strong></h3>
<p>Last part we will cover in this article is more relevant for feature extraction : Blurring of images. Grayscale or binary image sometime captures more than required image and blurring comes very handy in such scenarios. For instance, in this image if the shoe was of lesser interest than the railway track, blurring would have added a lot of value. This will become clear from this example. Blurring algorithm takes weighted average of neighbouring pixels to incorporate surroundings color into every pixel. Following is an example of blurring :</p>
<p><a href="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/5.png"><img class="alignnone size-full wp-image-11992" src="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2015/01/5.png?resize=723%2C338" alt="5" srcset="http://i0.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/5.png?resize=300%2C140 300w, http://i0.wp.com/www.analyticsvidhya.com/wp-content/uploads/2015/01/5.png?w=723 723w" sizes="(max-width: 723px) 100vw, 723px" data-recalc-dims="1"/></a></p>
<p>In the above picture, after blurring we clearly see that the shoe has now gone to the same intensity level as that of rail track. Hence, this technique comes in very handy in many scenarios of image processing.</p>
<p>Let’s take a practical example of such application in analytics industry. We wish to count the number of people in a town’s photograph. But this image has a few buildings also. Now the intensity of the people behind the buildings will be lower than building itself. Hence, it becomes difficult for us to count these poeple. Blurring in such scenarios can be done to equalize the intensities of buildings and people in the image.</p>
<h3><strong>Complete Code</strong></h3>
<p>Here is the complete code :</p>
<div id="stb-container-9684" class="stb-container-css stb-grey-container stb-image-none stb-ltr stb-corners stb-side-none"><aside class="stb-icon"><img src="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/plugins/wp-special-textboxes/images/gears-b.png" data-recalc-dims="1"/></aside><div id="stb-box-9684" class="stb-grey_box stb-box">
<pre>image = imread(r"C:\Users\Tavish\Desktop\7.jpg")
show_img(image)</pre>
<pre>red, yellow =   image.copy(), image.copy()
red[:,:,(1,2)] = 0
yellow[:,:,2]=0
show_images(images=[red,yellow], titles=['Red Intensity','Yellow Intensity'])

from skimage.color import rgb2gray
gray_image = rgb2gray(image)
show_images(images=[image,gray_image],titles=["Color","Grayscale"])
print "Colored image shape:", image.shape
print "Grayscale image shape:", gray_image.shape

from skimage.filter import threshold_otsu
thresh = threshold_otsu(gray_image)
binary = gray_image &gt; thresh
show_images(images=[gray_image,binary_image,binary],titles=["Grayscale","Otsu Binary"])

from skimage.filter import gaussian_filter
blurred_image = gaussian_filter(gray_image,sigma=20)
show_images(images=[gray_image,blurred_image],titles=["Gray Image","20 Sigma Blur"])</pre>
</div></div>
<h3><strong>End Notes</strong></h3>
<p>The world of image processing is already so rich that multi-billion dollar companies today rely on these image processing tools for various purposes. These image processing techniques are being used heavily in researches and automization of industry processes. In few of the coming articles we will take a deep dive into feature extraction from an image. This will include detecting corners, segmenting the image, seperating object from the background etc.</p>
<p>Did you find the article useful? Share with us any practical application of image processing you have worked on.  Do let us know your thoughts about this article in the box below.</p>
<p>–</p>
<p><strong>P.S. Have you joined <a href="http://discuss.analyticsvidhya.com" target="_blank">Analytics Vidhya Discuss</a> yet? If not, you are missing out on awesome data science discussions. Here are 2 of my best picks among recent discussions:</strong></p>
<p>1. <a href="http://discuss.analyticsvidhya.com/t/feature-selection/97" target="_blank">How to do feature selection and transformation?</a></p>
<p>2. <a href="http://discuss.analyticsvidhya.com/t/algorithms-for-time-series-forecasting/81" target="_blank">Algorithm for time series forecasting</a></p>


<p/>
<p id="jp-relatedposts" class="jp-relatedposts">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</p>
															</div>

							</div></body></html>