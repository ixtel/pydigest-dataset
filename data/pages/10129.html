<html><body><div><div id="usage">
<h2>Usage</h2>
<p>Itâ€™s recommended to install <tt>urllib3[secure]</tt> before installing <tt>httplib2shim</tt>:</p>
<pre>pip install urllib3<span class="o">[</span>secure<span class="o">]</span> httplib2shim
</pre>
<p>Usage is straightforward. You can substitute <tt>httplib2shim.Http</tt> anywhere <tt>httplib2.Http</tt> is used:</p>
<pre><span class="kn">import</span> <span class="nn">httplib2shim</span>
<span class="kn">from</span> <span class="nn">oauth2client.client</span> <span class="kn">import</span> <span class="n">GoogleCredentials</span>


<span class="n">credentials</span> <span class="o">=</span> <span class="n">GoogleCredentials</span><span class="o">.</span><span class="n">get_application_default</span><span class="p">()</span>
<span class="n">http</span> <span class="o">=</span> <span class="n">httplib2shim</span><span class="o">.</span><span class="n">Http</span><span class="p">()</span>
<span class="n">credentials</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">http</span><span class="p">)</span>

<span class="c1"># http is now authorized with OAuth2 credentials and uses urllib3 under</span>
<span class="c1"># the covers.</span>
</pre>
<p>Alternatively, if you do not control the construction of the <tt>Http</tt> object, you can use <tt>httplib2shim.patch()</tt> to monkey-patch the <tt>httplib2.Http</tt> class to point to <tt>httplib2shim.Http()</tt>:</p>
<pre><span class="kn">import</span> <span class="nn">httplib2shim</span>
<span class="n">httplib2shim</span><span class="o">.</span><span class="n">patch</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">googleapiclient.discovery</span> <span class="kn">import</span> <span class="n">build</span>
<span class="kn">from</span> <span class="nn">oauth2client.client</span> <span class="kn">import</span> <span class="n">GoogleCredentials</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">GoogleCredentials</span><span class="o">.</span><span class="n">get_application_default</span><span class="p">()</span>

<span class="c1"># build constructs its own httplib2.Http instance.</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">'compute'</span><span class="p">,</span> <span class="s1">'v1'</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

<span class="c1"># service.http is now a httplib2shim.Http object.</span>
</pre>
</div>
</div></body></html>