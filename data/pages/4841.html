<html><body><div><section class="post-content">
                <p>Cohin University of Science and Technology release results for <a href="http://cusatresults.nic.in">CAT</a> examination few days ago but when I visited the site I noticed that results were posted without any secondary authentication for security.</p>

<p><img src="http://i.imgur.com/74xTArQ.png" alt="Entry"/></p>

<p>Now after seeing this I was tempted to write a script in python that could scrape student details from this site.Hence, I downloaded <a href="https://addons.mozilla.org/en-us/firefox/addon/live-http-headers">Live HTTP Headers</a> plugin for firefox to see http headers going through so that I can send similar request using python in order to extract the data. For demonstration purpose I am going to use my roll number.</p>

<p><img src="http://i.imgur.com/wkFxeZY.png" alt="Headers"/></p>

<p>we can see that it's sending HTTP POST request to <strong>cusatresult13.asp</strong> with parameter <strong>rollno</strong> and <strong>B1</strong>.</p>

<p>Now let's write python code to send that request and see if it works.  </p>

<pre><code class="language-python">import requests  
payload = {'rollno':38323 ,'B1':'Submit'} #Our POST data  
url="http://www.cusatresults.nic.in/cusatresult13.asp"  
r=requests.post(url, data =payload) #post request  
print r.content #print html of page  
</code></pre>

<p>I used requests library to send POST request to the server.Our script should work as expected because we're sending same post request as send by browser but it doesn't. <strong>r.content</strong> returns the html sent by server to us , html returned to us renders this</p>

<p><img src="http://i.imgur.com/SfrzqWm.png" alt="render"/></p>

<p>Uhhh? What the hell? This is possibly because we haven't fully "mimicked" to be browser , There is also a possibility that server is checking if request came from their server using "refer" in http headers. we need to send headers to server like the one sent by our browser , thankfully with <strong>requests</strong> we can easily do that.</p>

<p>We can write all header in a dictionary and send it along with <strong>requests.post</strong></p>

<pre><code class="language-python">headerdata = {  
'Host':'cusatresults.nic.in',  
'Connection': 'keep-alive',  
'Content-Length': 22,  
'Cache-Control': 'max-age=0',  
'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',  
'Content-Type': 'application/x-www-form-urlencoded',  
'Referer': 'http://cusatresults.nic.in',  
'Accept-Encoding': 'gzip, deflate',  
'Accept-Language': 'en-US,en;q=0.8'  
}
</code></pre>

<p>What a long messy header -_- huh !</p>

<pre><code class="language-python">r=requests.post(url , data =payload , headers=headerdata)  
</code></pre>

<p>Now when I do  </p>

<pre><code class="language-python">print r.content  
</code></pre>

<p>HTML given out by that statement renders this <br/>
<img src="http://i.imgur.com/K6iXSJ1.png" alt="render2"/></p>

<p>Hah , Now that we can "login" into the website , our half the work is done .Moving to the actual scraping part , I am going to use BeautifulSoup to do this task , You can use us lxml too for this purpose but here I am going to stick with BeautifulSoup.</p>

<p>On inspecting elements we see that our target data(Couse/Category and Rank) is stored within "font" tag with a specific attribute which used only for that text only.</p>

<p><img src="http://i.imgur.com/EVsWTCv.png?1" alt="Elements"/></p>

<p>This detail is going to useful when we pull out text targeting text details using BeautifulSoup</p>

<pre><code class="language-python">from bs4 import BeautifulSoup  
import requests

headerdata = {  
'Host':'cusatresults.nic.in',  
'Connection': 'keep-alive',  
'Content-Length': 22,  
'Cache-Control': 'max-age=0',  
'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',  
'Content-Type': 'application/x-www-form-urlencoded',  
'Referer': 'http://cusatresults.nic.in',  
'Accept-Encoding': 'gzip, deflate',  
'Accept-Language': 'en-US,en;q=0.8'  
}

payload={'rollno':38323 ,'B1':'Submit'} #Our POST data

url="http://www.cusatresults.nic.in/cusatresult13.asp" 

r=requests.post(url , data =payload , headers=headerdata)

soup=BeautifulSoup(r.content) #Giving beautifulsoup html

rank=soup.findAll('font', {'face':"Arial, Helvetica, sans-serif" , 'size':2 }) 

counter=0

for link in rank: #Transversing through searched data  
    if counter &lt; 2:
        print link.contents[0].strip()
        counter=counter+1
</code></pre>

<p><strong>soup.findAll()</strong> searches for specific tag , We can also define attributes for that tag using a dictionary(which I did)</p>

<p>Note that I have used a variable named <strong>counter</strong> because if let loop run more than 2 times it tends to print out newline probably because site has stored data that way.</p>

<p>This code prints out category and rank of the candidate , all that left is to also print out name of the candidate and roll number</p>

<p>Again inspecting elements we see that candidate name is stored in "font" tag with color "#000000" </p>

<p><img src="http://i.imgur.com/IPRVLue.png?1" alt="tag"/>
let's extract it out with <strong>findAll</strong></p>

<pre><code class="language-python">names=soup.findAll('font', {'color':"#000000"})  
counter=0  
for name in names:  
    if counter &lt;2:
        print name.contents[0]
        counter=counter+1
    else
        break
</code></pre>

<p><img src="http://i.imgur.com/SHWPy5C.png" alt="clean up"/></p>

<p>but that also prints out html inside "font" tag , let's strip that away using <strong>re</strong> library</p>

<pre><code class="language-python">import re

names=soup.findAll('font', {'color':"#000000"})  
counter=0  
for name in names:  
    if counter &lt;2:
        result = re.sub("&lt;.*?&gt;", "", store)
        print result.strip().strip(':')
        counter=counter+1
    else
        break
</code></pre>

<p>Now we are able to extract Roll number , name , rank and category from the website. Full code for our objective is</p>

<pre><code class="language-python">from bs4 import BeautifulSoup  
import requests  
import re  
headerdata = {  
'Host':'cusatresults.nic.in',  
'Connection': 'keep-alive',  
'Content-Length': 22,  
'Cache-Control': 'max-age=0',  
'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',  
'Content-Type': 'application/x-www-form-urlencoded',  
'Referer': 'http://cusatresults.nic.in',  
'Accept-Encoding': 'gzip, deflate',  
'Accept-Language': 'en-US,en;q=0.8'  
}

payload={'rollno':38323 ,'B1':'Submit'} #Our POST data

url="http://www.cusatresults.nic.in/cusatresult13.asp" 

r=requests.post(url , data =payload , headers=headerdata)

soup=BeautifulSoup(r.content) #Giving beautifulsoup html

rank=soup.findAll('font', {'face':"Arial, Helvetica, sans-serif" , 'size':2 }) 

counter=0

for link in rank: #Transversing through searched data  
    if counter &lt; 2:
        print link.contents[0].strip()
        counter=counter+1
names=soup.findAll('font', {'color':"#000000"})  
counter=0  
for name in names:  
    store=str(name.contents[0])
    if counter &lt;2:
        result = re.sub("&lt;.*?&gt;", "", store)
        print result.strip().strip(':')
        counter=counter+1
    else
        break
</code></pre>

<p>Now that we've pulled required data , we can store data in CSV file if we like . Worst part is that roll numbers are linear hence anyone can use loop and extract data of every student that took part in examination. Unfortunately site didn't display any other details like score in specific subjects , Which could have been useful for statistical study. </p>
                        <aside class="tags fi-pricetag-multiple">Posted on <a href="/tag/python/">python</a>, <a href="/tag/programming/">programming</a></aside>
            </section>
            </div></body></html>