<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-pygeoipmap" class="anchor" href="#pygeoipmap" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>PyGeoIpMap</h1>

<p>A Python script to show where IP addresses are coming from by plotting them on a World map.</p>

<p><a href="https://camo.githubusercontent.com/29d12a938d279876b49075ae93856f091c8a3da8/687474703a2f2f692e696d6775722e636f6d2f494749614b44622e6a7067" target="_blank"><img src="https://camo.githubusercontent.com/29d12a938d279876b49075ae93856f091c8a3da8/687474703a2f2f692e696d6775722e636f6d2f494749614b44622e6a7067" alt="evil_hackers.jpg" data-canonical-src="http://i.imgur.com/IGIaKDb.jpg"/></a></p>

<h2><a id="user-content-requirements" class="anchor" href="#requirements" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Requirements</h2>



<p>PyGeoIpMap can be installed along with its dependencies easily on Ubuntu Linux with the following command:</p>

<div class="highlight highlight-source-shell"><pre>sudo apt-get install python-numpy python-matplotlib python-mpltoolkits.basemap python-geoip</pre></div>

<p>Unfortunately, there is no Python3 version of <code>python-mpltoolkits.basemap</code> for the moment so this script is Python 2.7+ only.</p>

<h2><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h2>

<pre><code>usage: pygeoipmap.py [-h] [-o OUTPUT] [-f {ip,csv}] [-s {f,m}] [-db DB] input

Visualize community on a map.

positional arguments:
  input                 Input file. One IP per line or, if FORMAT set to
                        'csv', CSV formatted file ending with latitude and
                        longitude positions

optional arguments:
  -h, --help            show this help message and exit
  -o OUTPUT, --output OUTPUT
                        Path to save the file (e.g. /tmp/output.png)
  -f {ip,csv}, --format {ip,csv}
                        Format of the input file.
  -s {f,m}, --service {f,m}
                        Geolocation service (f=FreeGeoIP, m=MaxMind local
                        database)
  -db DB, --db DB       Full path to MaxMind database file (default =
                        ./GeoLiteCity.dat)
  --extents W/E/S/N     Spatial extents for the figure
                        (west/east/south/north). Defaults to global.
</code></pre>

<h2><a id="user-content-examples" class="anchor" href="#examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Examples</h2>

<h3><a id="user-content-using-a-list-of-ip-addresses-and-the-freegeoip-web-service" class="anchor" href="#using-a-list-of-ip-addresses-and-the-freegeoip-web-service" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using a list of IP addresses (and the FreeGeoIp web service)</h3>

<p>A World map can be generated from a list of IP addresses by running the following command:</p>

<div class="highlight highlight-source-shell"><pre>python pygeoipmap.py /tmp/ip.txt</pre></div>

<p>The list of IP address must be saved to a text file with each IP
address separated by a newline as shown below:</p>

<pre><code>218.60.148.32
59.63.175.24
109.207.56.22
59.63.175.25
59.39.71.222
222.186.62.17
72.80.16.100
60.199.196.144
â€¦
</code></pre>

<p>In that example above, the program will use data available from
<a href="http://freegeoip.net/">FreeGeoIp</a> to find the location of each IP address and generate a World map called <code>output.png</code>.</p>

<h3><a id="user-content-using-a-maxmind-offline-database" class="anchor" href="#using-a-maxmind-offline-database" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using a MaxMind offline database</h3>

<p>Local <a href="http://dev.maxmind.com/geoip/legacy/geolite/">MaxMind</a> database files can be used with the MaxMind <a href="https://github.com/maxmind/geoip-api-python">GeoIP</a> library with the <code>--service</code> option:</p>

<div class="highlight highlight-source-shell"><pre>python pygeoipmap.py /tmp/ip.txt --service m --db /path/to/GeoLiteCity.dat</pre></div>

<h3><a id="user-content-specifying-a-region-for-the-plot" class="anchor" href="#specifying-a-region-for-the-plot" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Specifying a region for the plot</h3>

<div class="highlight highlight-source-shell"><pre>python pygeoipmap.py /tmp/ip.txt --extents=-12/45/30/65 --output=ip.png</pre></div>

<p>This limits the plot to Europe.</p>

<h3><a id="user-content-using-a-csv-file-already-containing-latitude-and-longitude-data" class="anchor" href="#using-a-csv-file-already-containing-latitude-and-longitude-data" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using a CSV file already containing latitude and longitude data</h3>

<p>PyGeoIpMap can generate a World map without connecting to FreeGeoIp if the latitude and longitude data are available.
A CSV file where the two last columns are the IP address' corresponding latitude and longitude values.</p>

<p>An example of a CSV file with each IP address' latitude and longitude values provided:</p>

<pre><code>198.23.67.201, Dallas, United States, 32.9299, -96.8353
223.4.240.25, Hangzhou, China, 30.2936, 120.1614
74.208.213.28, Wayne, United States, 40.0548, -75.4083
119.80.39.54, Beijing, China, 39.9289, 116.3883
101.44.1.135, Shanghai, China, 31.0456, 121.3997
219.144.17.74, Xian, China, 34.2583, 108.9286
64.27.26.7, Los Angeles, United States, 34.053, -118.2642
</code></pre>

<p>The World map can be generated from the CSV file by running the following command:</p>

<div class="highlight highlight-source-shell"><pre>python pygeoipmap.py -o /tmp/evil_hackers.jpg -f csv data.csv</pre></div>

<p>PyGeoIpMap will output the World map <code>/tmp/evil_hackers.jpg</code> as seen below.</p>

<p><a href="https://camo.githubusercontent.com/29d12a938d279876b49075ae93856f091c8a3da8/687474703a2f2f692e696d6775722e636f6d2f494749614b44622e6a7067" target="_blank"><img src="https://camo.githubusercontent.com/29d12a938d279876b49075ae93856f091c8a3da8/687474703a2f2f692e696d6775722e636f6d2f494749614b44622e6a7067" alt="evil_hackers.jpg" data-canonical-src="http://i.imgur.com/IGIaKDb.jpg"/></a></p>
</article>
  </div></body></html>