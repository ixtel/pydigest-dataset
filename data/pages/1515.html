<html><body><div><section class="entry">
<p class="fsb-clear"/><p><iframe src="http://www.youtube.com/embed/E9ZPD_T639c?feature=oembed" frameborder="0" allowfullscreen="">VIDEO</iframe></p>
<p><strong>Update – January 27, 2015:</strong> Based on the feedback from commenters, I have updated the source code in the download to include the original MNIST dataset! No external downloads required!</p>
<p><strong>Update – March 2015, 2015:</strong> The nolearn package has now deprecated and removed the 
			<span id="crayon-56d59d9065890333871342" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">dbn</span></span></span>  module. When you go to install the <a href="https://github.com/dnouri/nolearn" target="_blank">nolearn</a> package, be sure to clone down the repository, checkout the 0.5b1 version, and then install it. <em><strong>Do not install the current version without first checking out the 0.5b1 version!</strong></em> <strong>In the future I will post an update on how to use the updated nolearn package!</strong></p>
<p>Deep learning.</p>
<p>This probably isn’t the first time you’ve heard of it. <em>It’s everywhere.</em> In academic papers. On /r/machinelearning. On DataTau. On Hacker News. And even on primetime TV.</p>
<p>Now I’m not exactly a wagering man, but I bet that after my long-winded rant on <a title="Get off the deep learning bandwagon and get some perspective" href="http://www.pyimagesearch.com/2014/06/09/get-deep-learning-bandwagon-get-perspective/" target="_blank">getting off the deep learning bandwagon</a>, the last thing you would expect me to do is write a post on Deep Learning, right?</p>
<p>Well. Let’s back up a step.</p>
<p>Remember, that post wasn’t saying that deep learning is <em>bad</em> or should be <em>avoided </em>— in fact, quite the contrary!</p>
<p>Instead, the post was simply a reminder that deep learning is still <em>just a tool</em>.</p>
<p>And with every tool, there is a time and a place to use it. Just because you have a “hammer”, doesn’t mean that every problem you come across will be a “nail”. It takes a <em>conscientious effort</em> to pick the right tool for the job.</p>
<p>Anyway, one of my favorite deep learning packages for Python is <a href="https://pythonhosted.org/nolearn/index.html" target="_blank">nolearn</a>.</p>
<p>It’s beautiful. It’s simple. And if you’re familiar with <a href="http://scikit-learn.org/stable/" target="_blank">scikit-learn</a>, then you’ll feel right at home. The models included in 
			<span id="crayon-56d59d906589b052204319" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">nolearn</span></span></span>  have implemented the 
			<span id="crayon-56d59d906589f610497187" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">fit</span></span></span>  and 
			<span id="crayon-56d59d90658a3092191840" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">predict</span></span></span> functions just like scikit-learn, and the output predictions are even compatible with the scikit-learn 
			<span id="crayon-56d59d90658a7703624764" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">metric</span></span></span>  functions.</p>
<p>Really cool, right?</p>
<p>Read on to find out how to utilize the 
			<span id="crayon-56d59d90658aa016528432" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">nolearn</span></span></span>  package to construct a Deep Belief Network.</p>

<p><strong>OpenCV and Python versions:</strong><br/>
This example will run on<strong> Python 2.7</strong> and <strong>OpenCV 2.4.X/OpenCV 3.0+</strong>.</p>
<h1>Getting Started with Deep Learning and Python</h1>
<div id="attachment_925" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/06/mnist_sample.jpg"><img class="size-full wp-image-925" src="http://www.pyimagesearch.com/wp-content/uploads/2014/06/mnist_sample.jpg" alt="Figure 1: MNIST digit recognition sample"/></a><p class="wp-caption-text"><strong>Figure 1:</strong> MNIST digit recognition sample</p></div>
<p>So in this blog post we’ll review an example of using a Deep Belief Network to classify images from the <a href="http://yann.lecun.com/exdb/mnist/" target="_blank">MNIST dataset</a>, a dataset consisting of handwritten digits. The MNIST dataset is extremely well studied and serves as a benchmark for new models to test themselves against.</p>
<p>However, in my opinion, this benchmark doesn’t necessarily translate into real-world viability. And this is mainly due to the dataset itself where each and every image has been pre-processed — including cropping, clean thresholding, and centering.</p>
<p>In the real-world, your dataset will not be as “nice” as the MNIST dataset. Your digits won’t be as cleanly pre-processed.</p>
<p>Still, this is a great starting point to get our feet wet utilizing Deep Belief Networks and 
			<span id="crayon-56d59d90658af079993014" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">nolearn</span></span></span> .</p>
<h1>Deep Learning Concepts and Assumptions</h1>
<p>Deep learning is all about hierarchies and abstractions. These hierarchies are controlled by the number of layers in the network along with the number of nodes per layer. Adjusting the number of layers and nodes per layer can be used to provide varying levels of abstraction.</p>
<p>In general, the goal of deep learning is to take low level inputs (feature vectors) and then construct higher and higher level abstract “concepts” through the composition of layers. The assumption here is that the data follows some sort of <em>underlying pattern</em> generated by many interactions between different nodes on many different layers of the network.</p>
<p>Now that we have a high level understanding of Deep Learning concepts and assumptions, let’s look at some definitions to aide us in our learning.</p>
<h1>The Input Layer, Hidden Layers, and Output Layer</h1>
<div id="attachment_1242" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_example.png"><img class="size-full wp-image-1242" src="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_example.png" alt="Figure 2: Example of training a Deep Belief Network by constructing multiple Restricted Boltzmann Machines stacked on top of each other." srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_example-300x145.png 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_example.png 620w" sizes="(max-width: 620px) 100vw, 620px"/></a><p class="wp-caption-text"><strong>Figure 2:</strong> Example of training a Deep Belief Network by constructing multiple Restricted Boltzmann Machines stacked on top of each other. Each <em>layer</em> consists of multiple <em>nodes</em> which feed into the next layer.  (<a href="http://www.iro.umontreal.ca/~lisa/twiki/bin/view.cgi/Public/DeepBeliefNetworks" target="_blank">source</a>)</p></div>
<p>Before we get to the code, let’s quickly discuss what Deep Belief Networks are, along with a bit of terminology.</p>
<p>This review is by no means meant to be complete and exhaustive. And in some cases I am <strong><em>greatly simplifying</em></strong> the details. But that’s okay. This is meant to be a gentle introduction to DBNs and not a hardcore review with tons of mathematical notation. If that’s what you’re looking for, then sorry, this isn’t the post for you. I would suggest reading up on the <a href="http://www.deeplearning.net/tutorial/" target="_blank">DeepLearning.net Tutorials</a> (trust me, they are really good, but if this is your first exposure to deep learning, you might want to get through this post first).</p>
<p>Deep Belief Networks consist of multiple layers, or more concretely, a hierarchy of unsupervised Restricted Boltzmann Machines (RBMs) where the output of each RBM is used as input to the next.</p>
<p>The major breakthrough came in 2006 when Hinton et al. published their <em><a href="https://www.cs.toronto.edu/~hinton/absps/fastnc.pdf" target="_blank">A Fast Learning Algorithm for Deep Belief Networks</a> </em>paper. Their seminal work demonstrated that each of the hidden layers in a neural net can be treated as an unsupervised Restricted Boltzmann Machine with a supervised back-propagation step for fine-tuning. Furthermore, these RBMs can be trained greedily — and thus were feasible as highly scalable and efficient machine learning models.</p>
<p>This notion of efficiency was further demonstrated in the coming years where Deep Nets have been trained on <em>GPUs</em> rather than <em>CPUs</em> leading to a reduction of training time by <em>over an order of magnitude</em>. What once took <strong>weeks</strong>, now takes only <strong>days.</strong></p>
<p>From there, deep learning has taken off.</p>
<p>But before we get too far, let’s quickly discuss this concept of “layers” in our DBN.</p>
<h2>Input Layer</h2>
<p>The first layer is our is a type of <b><i>visible layer</i></b> called an <strong><em>input layer</em></strong>. This layer contains an <strong><em>input node</em></strong> for each of the entries in our feature vector.</p>
<p>For example, in the MNIST dataset each image is <em>28 x 28</em> pixels. If we use the raw pixel intensities for the images, our feature vector would be of length <em>28 x 28 = 784</em>, thus there would be 784 nodes in the input layer.</p>
<h2>Hidden Layer</h2>
<p>From there, these nodes connect to a series of <strong><em>hidden layers</em></strong>. In the most simple terms, each hidden layer is an unsupervised Restricted Boltzmann Machine where the output of each RBM in the hidden layer sequence is used as input to the next.</p>
<p>The final hidden layer then connects to an <strong><em>output layer</em></strong>.</p>
<h2>Output Layer</h2>
<p>Finally, we have our another <strong><em>visible layer</em></strong> called the <strong><em>output layer</em></strong>. This layer contains the output probabilities for each class label. For example, in our MNIST dataset we have 10 possible class labels (one for each of the digits 1-9). The output node that produces the largest probability is chosen as the overall classification.</p>
<p>Of course, we could always sort the output probabilities and choose all class labels that fall within some epsilon of the largest probability — doing this is a good way to find <em>the most likely class labels</em> rather than simply choosing the one with the largest probability. In fact, this is exactly what is done for many of the popular deep learning challenges, including <a href="http://www.image-net.org/challenges/LSVRC/2014/" target="_blank">ImageNet</a>.</p>
<p>Now that we have some terminology, we can jump into the code.</p>
<h1>Utilizing a Deep Belief Network in Python</h1>
<p>Alright, time for the fun part — let’s write some code.</p>
<p>It is important to note that this tutorial (by in large) is based on the excellent example on the <a href="https://pythonhosted.org/nolearn/dbn.html#example-mnist" target="_blank">nolearn</a> website. My goal here is to simply take the example, tweak it slightly, as well as throw in a few extra demonstrations — and provide a detailed review of the code, of course.</p>
<p>Anyway, open up a new file, name it 
			<span id="crayon-56d59d90658b5350642497" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">dbn</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> , and let’s get started.</p>

		<div id="crayon-56d59d90658b9700524993" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d90658b9700524993-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658b9700524993-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">cross_validation </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span></p><p class="crayon-line" id="crayon-56d59d90658b9700524993-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">classification_report</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658b9700524993-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">sklearn </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">datasets</span></p><p class="crayon-line" id="crayon-56d59d90658b9700524993-5"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">nolearn</span><span class="crayon-sy">.</span><span class="crayon-e">dbn </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">DBN</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658b9700524993-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></p><p class="crayon-line" id="crayon-56d59d90658b9700524993-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We’ll start by importing the packages that we’ll need. We’ll import 
			<span id="crayon-56d59d90658bd698506365" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">train_test_split</span></span></span>  (to generate our training and testing splits of the MNIST dataset) and 
			<span id="crayon-56d59d90658c0530636597" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">classification_report</span></span></span>  (to display a nicely formatted table of accuracies) from the scikit-learn package. We’ll import the 
			<span id="crayon-56d59d90658c4063917807" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">dataset</span></span></span>  module from scikit-learn to download the MNIST dataset.</p>
<p>Next up, we’ll import our Deep Belief Network implementation from the 
			<span id="crayon-56d59d90658c7979532608" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">nolearn</span></span></span>  package.</p>
<p>And finally we’ll wrap up our 
			<span id="crayon-56d59d90658ca591156316" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">import</span></span></span>  statements by importing NumPy for numerical processing and 
			<span id="crayon-56d59d90658ce216411959" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span></span></span>  for our OpenCV bindings.</p>
<p>Let’s go ahead and download the MNIST dataset:</p>

		<div id="crayon-56d59d90658d1663250941" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d90658d1663250941-9"><span class="crayon-c"># grab the MNIST dataset (if this is the first time you are running</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658d1663250941-10"><span class="crayon-c"># this script, this make take a minute -- the 55mb MNIST digit dataset</span></p><p class="crayon-line" id="crayon-56d59d90658d1663250941-11"><span class="crayon-c"># will be downloaded)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658d1663250941-12"><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"[X] downloading data..."</span></p><p class="crayon-line" id="crayon-56d59d90658d1663250941-13"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">datasets</span><span class="crayon-sy">.</span><span class="crayon-e">fetch_mldata</span><span class="crayon-sy">(</span><span class="crayon-s">"MNIST Original"</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We make a call to the 
			<span id="crayon-56d59d90658d5244192227" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">fetch_mldata</span></span></span>  function on <strong>Line 13</strong> that downloads the original MNIST dataset from the <a href="http://mldata.org" target="_blank">mldata.org</a> repository.</p>
<p>The actual dataset is roughly 55mb so it may take a few seconds to download. However, once the dataset is downloaded it is cached locally on your machine so you will not have to download it again.</p>
<p>If you take the time to examine the data, you’ll notice that each feature vector contains 784 entries in the range <em>[0, 255]</em>. These values are the grayscale pixel intensities of the flattened <em>28 x 28</em> image. Background pixels are black (0) whereas foreground pixels appear to be lighter shades of gray or white.</p>
<p>Time to generate our training and testing splits:</p>

		<div id="crayon-56d59d90658d9411335346" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d90658d9411335346-15"><span class="crayon-c"># scale the data to the range [0, 1] and then construct the training</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658d9411335346-16"><span class="crayon-c"># and testing splits</span></p><p class="crayon-line" id="crayon-56d59d90658d9411335346-17"><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658d9411335346-18"><span class="crayon-h">	</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">target</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"int0"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.33</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>In order to train our Deep Belief network, we’ll need two sets of data — a set for <em>training</em> our algorithm and a set for <em>evaluating</em> or <em>testing</em> the performance of the classifier.</p>
<p>We perform the split on <strong>Lines 17 and 18</strong> by making call to 
			<span id="crayon-56d59d90658dd055144895" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">train_test_split</span></span></span>. The first argument we specify is the data itself, which we scale to be in range <em>[0, 1.0]</em>. The Deep Belief Network assumes that our data is scaled in the range <em>[0, 1.0]</em> so this is a necessary step.</p>
<p>We then specify the “target” or the “class labels” for each feature vector as the second argument.</p>
<p>The last argument to 
			<span id="crayon-56d59d90658e0117990977" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">train_test_split</span></span></span>  is the size of our testing set. We’ll utilize 33% of the data for testing, while the remaining 67% will be utilized for training our Deep Belief Network.</p>
<p>Speaking of training the Deep Belief Network, let’s go ahead and do that:</p>

		<div id="crayon-56d59d90658e4312591571" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658e4312591571-20"><span class="crayon-c"># train the Deep Belief Network with 784 input units (the flattened,</span></p><p class="crayon-line" id="crayon-56d59d90658e4312591571-21"><span class="crayon-c"># 28x28 grayscale image), 300 hidden units, 10 output units (one for</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658e4312591571-22"><span class="crayon-c"># each possible output classification, which are the digits 1-10)</span></p><p class="crayon-line" id="crayon-56d59d90658e4312591571-23"><span class="crayon-v">dbn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DBN</span><span class="crayon-sy">(</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658e4312591571-24"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d59d90658e4312591571-25"><span class="crayon-h">	</span><span class="crayon-v">learn_rates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658e4312591571-26"><span class="crayon-h">	</span><span class="crayon-v">learn_rate_decays</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d59d90658e4312591571-27"><span class="crayon-h">	</span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658e4312591571-28"><span class="crayon-h">	</span><span class="crayon-v">verbose</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d90658e4312591571-29"><span class="crayon-v">dbn</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We initialize our Deep Belief Network on <strong>Lines 23-28</strong>.</p>
<p>The first argument details the structure of our network, represented as a list. The first entry in the list is the number of nodes in our <strong><em>input layer</em></strong>. We’ll want to have an input node for each entry in our feature vector list, so we’ll specify the length of the feature vector for this value.</p>
<p>Our <strong><em>input layer</em></strong> will now feed forward into our second entry in the list, a <strong><em>hidden layer</em></strong>. This hidden layer will be represented as RBM with 300 nodes.</p>
<p>Finally, the output of the 300 node hidden layer will be fed into the <strong><em>output layer</em></strong>, which consists of an output for each of the class labels.</p>
<p>We can then define our 
			<span id="crayon-56d59d90658e9211885278" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">learn_rate</span></span></span> , which is the learning rate of the algorithm, the decay of the learn rate (
			<span id="crayon-56d59d90658ec291098711" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">learn_rate_decays</span></span></span> ), the number of 
			<span id="crayon-56d59d90658f0300680409" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">epochs</span></span></span> , or iterations of the training data, and the verbosity level.</p>
<p>Both 
			<span id="crayon-56d59d90658f3242550146" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">learn_rates</span></span></span>  and 
			<span id="crayon-56d59d90658f6783888575" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">learn_rates_decays</span></span></span>  can be specified as a single floating point values or a <em>list</em> of floating point values. If you specify only a single value, this learning rate/decay rate will be applied to all layers in the network. If you specify a list of values, the the corresponding learning rate and decay rate will be used for the respective layers.</p>
<p>Training the actual algorithm takes place on <strong>Line 29</strong>. If you have a slow machine, you way want to make a cup of coffee or go for a quick walk during this time.</p>
<p>Now that our Deep Belief Network is trained, let’s go ahead and evaluate it:</p>

		<div id="crayon-56d59d90658fa348410932" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d90658fa348410932-31"><span class="crayon-c"># compute the predictions for the test data and show a classification</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658fa348410932-32"><span class="crayon-c"># report</span></p><p class="crayon-line" id="crayon-56d59d90658fa348410932-33"><span class="crayon-v">preds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dbn</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d90658fa348410932-34"><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-e">classification_report</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">preds</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Here we make a call to the 
			<span id="crayon-56d59d90658fe377542045" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">predict</span></span></span> method of the network on <strong>Line 33</strong> which takes our testing data and makes <em>predictions</em> regarding which digit each image contains. If you have worked with scikit-learn at all, then this should feel very natural and comfortable.</p>
<p>We then present a table of accuracies on <strong>Line 34</strong>.</p>
<p>Finally, I thought it might be interesting to inspect images <em>individually</em> rather than on aggregate as a further demonstration of the network:</p>

		<div id="crayon-56d59d9065902961993446" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9065902961993446-36">36</p><p class="crayon-num" data-line="crayon-56d59d9065902961993446-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9065902961993446-38">38</p><p class="crayon-num" data-line="crayon-56d59d9065902961993446-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9065902961993446-40">40</p><p class="crayon-num" data-line="crayon-56d59d9065902961993446-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9065902961993446-42">42</p><p class="crayon-num" data-line="crayon-56d59d9065902961993446-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9065902961993446-44">44</p><p class="crayon-num" data-line="crayon-56d59d9065902961993446-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9065902961993446-46">46</p><p class="crayon-num" data-line="crayon-56d59d9065902961993446-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9065902961993446-48">48</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d59d9065902961993446-36"><span class="crayon-c"># randomly select a few of the test instances</span></p><p class="crayon-line" id="crayon-56d59d9065902961993446-37"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">choice</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">arange</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9065902961993446-38"><span class="crayon-h">	</span><span class="crayon-c"># classify the digit</span></p><p class="crayon-line" id="crayon-56d59d9065902961993446-39"><span class="crayon-h">	</span><span class="crayon-v">pred</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dbn</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">atleast_2d</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9065902961993446-40"> </p><p class="crayon-line" id="crayon-56d59d9065902961993446-41"><span class="crayon-h">	</span><span class="crayon-c"># reshape the feature vector to be a 28x28 pixel image, then change</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9065902961993446-42"><span class="crayon-h">	</span><span class="crayon-c"># the data type to be an unsigned 8-bit integer</span></p><p class="crayon-line" id="crayon-56d59d9065902961993446-43"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9065902961993446-44"> </p><p class="crayon-line" id="crayon-56d59d9065902961993446-45"><span class="crayon-h">	</span><span class="crayon-c"># show the image and prediction</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9065902961993446-46"><span class="crayon-h">	</span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"Actual digit is {0}, predicted {1}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pred</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9065902961993446-47"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Digit"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9065902961993446-48"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>On <strong>Line 37</strong> we loop over 10 randomly chosen feature vectors from the test data.</p>
<p>We then predict the digit in the image on <strong>Line 39</strong>.</p>
<p>To display our image on screen, we need to reshape it on <strong>Line 43</strong>. Since our data is in the range <em>[0, 1.0]</em>, we first multiply by 255 to put it back in the range <em>[0, 255]</em>, change the shape to be a <em>28 x 28</em> pixel image, and then change the data type from floating point to an unsigned 8-bit integer.</p>
<p>Finally, we display the results of the prediction on <strong>Lines 46-48</strong>.</p>
<h1>Results</h1>
<p>Now that the code is done, let’s look at the results.</p>
<p>Fire up a shell, navigate to your 
			<span id="crayon-56d59d9065908082072172" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">dbn</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  file, and issue the following command:</p>

		

<p>If all goes well, you should have something similar to my output below:</p>

		<div id="crayon-56d59d906590f531547484" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59d906590f531547484-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-2">2</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-4">4</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-6">6</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-8">8</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-10">10</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-12">12</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-14">14</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-16">16</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-18">18</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-20">20</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-22">22</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-24">24</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-26">26</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-28">28</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-30">30</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-32">32</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-34">34</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-36">36</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-38">38</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-40">40</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-42">42</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-44">44</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-46">46</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-48">48</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-50">50</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-52">52</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-54">54</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-55">55</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-56">56</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-57">57</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-58">58</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-59">59</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-60">60</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-61">61</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-62">62</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-63">63</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-64">64</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-65">65</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-66">66</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-67">67</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-68">68</p><p class="crayon-num" data-line="crayon-56d59d906590f531547484-69">69</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d906590f531547484-70">70</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d906590f531547484-1"><span class="crayon-sy">(</span><span class="crayon-v">deeplearning</span><span class="crayon-sy">)</span><span class="crayon-v">annalee</span><span class="crayon-o">:</span><span class="crayon-v">deep</span><span class="crayon-o">-</span><span class="crayon-v">belief</span><span class="crayon-o">-</span><span class="crayon-e">network </span><span class="crayon-v">adrianrosebrock</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">dbn</span><span class="crayon-sy">.</span><span class="crayon-e">py </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-2"><span class="crayon-v">gnumpy</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">failed </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-v">cudamat</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">Using </span><span class="crayon-e">npmat </span><span class="crayon-v">instead</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">No </span><span class="crayon-e">GPU </span><span class="crayon-e">will </span><span class="crayon-e">be </span><span class="crayon-v">used</span><span class="crayon-sy">.</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-3"><span class="crayon-sy">[</span><span class="crayon-v">X</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">downloading </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-4"><span class="crayon-sy">[</span><span class="crayon-v">DBN</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">fitting</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">46900</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">784</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-5"><span class="crayon-sy">[</span><span class="crayon-v">DBN</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">layers</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">784</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-6"><span class="crayon-sy">[</span><span class="crayon-v">DBN</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">Fine</span><span class="crayon-o">-</span><span class="crayon-v">tune</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-7"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-8"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-9"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.288535176023</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-10"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.0842298497268</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-11"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">04</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-12"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-13"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-14"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.170946833078</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-15"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.0495645491803</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-16"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">05</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-17"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-18"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-19"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.127217275595</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-20"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.0362662226776</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-21"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">04</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-22"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-23"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-24"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.0930059491925</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-25"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.0268954918033</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-26"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">05</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-27"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-28"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-29"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.0732877224143</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-30"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.0234161543716</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-31"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">04</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-32"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-33"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-34"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.0563644782051</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-35"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.0173539959016</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-36"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">04</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-37"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-38"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-39"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.0383996891073</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-40"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.012487192623</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-41"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">05</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-42"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-43"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-44"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.027456679965</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-45"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.00817537568306</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-46"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">05</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-47"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-48"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-49"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.0208912373799</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-50"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.00589139344262</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-51"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">05</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-52"><span class="crayon-cn">100</span><span class="crayon-o">%</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-53"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-54"><span class="crayon-h">  </span><span class="crayon-i">loss</span><span class="crayon-h"> </span><span class="crayon-cn">0.0203280455254</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-55"><span class="crayon-h">  </span><span class="crayon-i">err</span><span class="crayon-h">  </span><span class="crayon-cn">0.00616888661202</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-56"><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">00</span><span class="crayon-o">:</span><span class="crayon-cn">05</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-57"><span class="crayon-h">             </span><span class="crayon-e">precision    </span><span class="crayon-e">recall  </span><span class="crayon-v">f1</span><span class="crayon-o">-</span><span class="crayon-e">score   </span><span class="crayon-i">support</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-58"> </p><p class="crayon-line" id="crayon-56d59d906590f531547484-59"><span class="crayon-h">          </span><span class="crayon-cn">0</span><span class="crayon-h">       </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.99</span><span class="crayon-h">      </span><span class="crayon-cn">0.99</span><span class="crayon-h">      </span><span class="crayon-cn">2280</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-60"><span class="crayon-h">          </span><span class="crayon-cn">1</span><span class="crayon-h">       </span><span class="crayon-cn">0.99</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.99</span><span class="crayon-h">      </span><span class="crayon-cn">2617</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-61"><span class="crayon-h">          </span><span class="crayon-cn">2</span><span class="crayon-h">       </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">2285</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-62"><span class="crayon-h">          </span><span class="crayon-cn">3</span><span class="crayon-h">       </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">2356</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-63"><span class="crayon-h">          </span><span class="crayon-cn">4</span><span class="crayon-h">       </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">2268</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-64"><span class="crayon-h">          </span><span class="crayon-cn">5</span><span class="crayon-h">       </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">2133</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-65"><span class="crayon-h">          </span><span class="crayon-cn">6</span><span class="crayon-h">       </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">2217</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-66"><span class="crayon-h">          </span><span class="crayon-cn">7</span><span class="crayon-h">       </span><span class="crayon-cn">0.99</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">2430</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-67"><span class="crayon-h">          </span><span class="crayon-cn">8</span><span class="crayon-h">       </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">2255</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-68"><span class="crayon-h">          </span><span class="crayon-cn">9</span><span class="crayon-h">       </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">0.97</span><span class="crayon-h">      </span><span class="crayon-cn">2259</span></p><p class="crayon-line" id="crayon-56d59d906590f531547484-69"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d906590f531547484-70"><span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">total</span><span class="crayon-h">       </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">      </span><span class="crayon-cn">0.98</span><span class="crayon-h">     </span><span class="crayon-cn">23100</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Here you can see that our Deep Belief Network is trained over 10 epochs (iterations over the training data). At each iteration our our loss function is minimized and the error on the training set is lower.</p>
<p>Taking a look at our classification report we see that we have obtained <strong>98% accuracy</strong> (the precision column) on our testing set. As you can see, the “1” and “7” digits was accurately classified 99% of the time. We could have perhaps obtained higher accuracy for the other digits had we let our network train for more epochs.</p>
<p>And below we can see some screenshots of our Deep Belief Network correctly classifying the digit in their respective images.</p>
<p><strong><em>Note:</em></strong> <em>You’ll notice that the loss, error, and accuracy values do not 100% match the output above. That is because I gathered these sample images on a separate run of the algorithm. Deep Belief Networks are <b>stochastic algorithms</b>, meaning that the algorithm utilizes random variables; thus, it is normal to obtain slightly different results when running the learning algorithm multiple times. To account for this, it is normal to obtain </em><em>multiple sets of results and average them together prior to reporting final accuracies.</em></p>
<div id="attachment_1247" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_1.jpg"><img class="wp-image-1247" src="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_1.jpg" alt="Figure 3: Correctly classifying a &quot;1&quot; digit using our Deep Belief Network." srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_1-300x193.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_1.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 3:</strong> Correctly classifying a “1” digit using our Deep Belief Network.</p></div>
<p>Here we can see that we have correctly classified the “1” digit.</p>
<div id="attachment_1248" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_4.jpg"><img class="wp-image-1248" src="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_4.jpg" alt="Figure 4: Correctly classifying a &quot;4&quot; digit using our Deep Belief Network." srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_4-300x192.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_4.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 4:</strong> Correctly classifying a “4” digit using our Deep Belief Network.</p></div>
<p>Again, we can see that our digit is correctly classified.</p>
<p>But take a look at this “8” digit below. This is far from a “legible digit”, but the Deep Belief Network is still able to sort it out:</p>
<div id="attachment_1249" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_8.jpg"><img class="wp-image-1249" src="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_8.jpg" alt="Figure 5: Correctly classifying a &quot;8&quot; digit using our Deep Belief Network." srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_8-300x192.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_8.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 5:</strong> Correctly classifying a “8” digit using our Deep Belief Network.</p></div>
<p>Finally, let’s try a “7”:</p>
<div id="attachment_1250" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_7.jpg"><img class="wp-image-1250" src="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_7.jpg" alt="Figure 6: Correctly classifying a &quot;7&quot; digit using our Deep Belief Network." srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_7-300x191.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/09/deep_belief_network_predict_7.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 6:</strong> Correctly classifying a “7” digit using our Deep Belief Network.</p></div>
<p>Yep, that one is correctly classified as well!</p>
<h1>Summary</h1>
<p>So there you have it — an brief, gentle introduction to Deep Belief Networks.</p>
<p>In this post we reviewed the structure of a Deep Belief Network (at a very high level) and looked at the <a href="https://pythonhosted.org/nolearn/" target="_blank">nolearn</a> Python package.</p>
<p>We then utilized 
			<span id="crayon-56d59d9065916551137521" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">nolearn</span></span></span>  to train and evaluate a Deep Belief Network on the MNIST dataset.</p>
<p>If this is your first experience with DBNs, I <em>highly recommend</em> that you spend the next few days researching and reading up on Artificial Neural Networks (ANNs); specifically, <strong>feed-forward networks</strong>, <strong>the back-propagation algorithm</strong>, and <strong>Restricted Boltzmann Machines</strong>.</p>
<p>Honestly, if you are serious about exploring Deep Learning, the algorithms I mentioned above are <em><strong>required</strong></em><strong><em>, non-optional reading!</em></strong></p>
<p>You won’t get very far into deep learning without reading up on these techniques. And don’t be afraid of the academic papers either! That’s where you’ll find all the gory details.</p>
<h1>What’s Next?</h1>
<p>Training a Deep Belief Network on a CPU can take a long, <em>long</em> time.</p>
<p>Luckily, we can speed up the training process using our GPUs, leading to training times being reduced by an order of magnitude or more.</p>
<p>In my next post I’ll show you how to setup your system to train a Deep Belief Network on your GPU. I think the speedup in training time will be quite surprising…</p>
<p>Be sure to enter your email address in the form at the bottom of this post to be updated when the next post goes live! You definitely won’t want to miss it.</p>
<h1>Interested in Handwriting Recognition?</h1>

<p>Did you enjoy this post on handwriting recognition?</p>
<p>If so, you’ll definitely want to check out my <em><a href="https://www.pyimagesearch.com/practical-python-opencv/" target="_blank">Practical Python and OpenCV</a> </em>book!</p>
<p>Chapter 6, <em>Handwriting Recognition with HOG</em> details the techniques the pro’s use…<strong><em>allowing you to become a pro yourself!</em></strong> From pre-processing the digit images, utilizing the Histogram of Oriented Gradients (HOG) image descriptor, and training a Linear SVM, this chapter covers handwriting recognition from front-to-back.</p>
<p>Simply put — if you loved this blog post, <em>you’ll love this book.</em></p>
<p>Sound interesting?</p>
<p><strong><a href="https://www.pyimagesearch.com/practical-python-opencv/" target="_blank">Click here to pickup a copy of the </a><i><a href="https://www.pyimagesearch.com/practical-python-opencv/" target="_blank">Practical Python and OpenCV</a></i></strong></p>
<h1 id="post_downloads">Downloads:</h1>

	</section>
	</div></body></html>