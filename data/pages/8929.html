<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-the-elements-of-python-style" class="anchor" href="#the-elements-of-python-style" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>The Elements of Python Style</h1>

<p>This document goes beyond PEP8 to cover the core of what I think of as great Python style. It is opinionated, but not too opinionated. It goes beyond mere issues of syntax and module layout, and into areas of paradigm, organization, and architecture. I hope it can be a kind of condensed <a href="https://en.wikipedia.org/wiki/The_Elements_of_Style">"Strunk &amp; White"</a> for Python code.</p>

<h1><a id="user-content-table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Table of Contents</h1>





<p>... but, be flexible on naming and line length.</p>

<p>PEP8 covers lots of mundane stuff like whitespace, line breaks between functions/classes/methods, imports, and warning against use of deprecated functionality. Pretty much everything in there is good.</p>

<p>The best tool to enforce these rules, while also helping you catch silly Python syntax errors, is <a href="https://flake8.readthedocs.org">flake8</a>.</p>

<p>PEP8 is meant as a set of guidelines, not rules to be strictly, or religiously, followed. Make sure to read the section of PEP8 that is titled: "A Foolish Consistency is the Hobgoblin of Little Minds." Also see Raymond Hettinger's excellent talk, <a href="https://www.youtube.com/watch?v=wf-BqAjZb8M">"Beyond PEP8"</a> for more on this.</p>

<p>The only set of rules that seem to cause a disproportionate amount of controversy are around the line length and naming. These can be easily tweaked.</p>

<h2><a id="user-content-flexibility-on-line-length" class="anchor" href="#flexibility-on-line-length" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Flexibility on Line Length</h2>

<p>If the strict 79-character line length rule in <code>flake8</code> bothers you, feel free to ignore or adjust that rule. It's probably still a good rule-of-thumb -- like a "rule" that says English sentences should have 50 or fewer words, or that paragraphs should have fewer than 10 sentences. Here's the link to <a href="https://flake8.readthedocs.org/en/latest/config.html">flake8 config</a>, see the <code>max-line-length</code> config option. Note also that often a <code># noqa</code> comment can be added to a line to have a <code>flake8</code> check ignored, but please use these sparingly.</p>

<p>90%+ of your lines should be 79 characters or fewer, though, for the simple reason that "Flat is better than nested". If you find a function where all the lines are longer than this, something else is wrong, and you should look at your code rather than at your flake8 settings.</p>

<h2><a id="user-content-consistent-naming" class="anchor" href="#consistent-naming" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Consistent Naming</h2>

<p>On naming, following some simple rules can prevent a whole lot of team-wide grief.</p>

<h3><a id="user-content-preferred-naming-rules" class="anchor" href="#preferred-naming-rules" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Preferred Naming Rules</h3>

<p>Many of these were adapted from <a href="http://www.pocoo.org/internal/styleguide/">the Pocoo team</a>.</p>

<ul>
<li>Class names: <code>CamelCase</code>, and capitalize acronyms: <code>HTTPWriter</code>, not <code>HttpWriter</code>.</li>
<li>Variable names: <code>lower_with_underscores</code>.</li>
<li>Method and function names: <code>lower_with_underscores</code>.</li>
<li>Modules: <code>lower_with_underscores.py</code>. (But, prefer names that don't need underscores!)</li>
<li>Constants: <code>UPPER_WITH_UNDERSCORES</code>.</li>
<li>Precompiled regular expressions: <code>name_re</code>.</li>
</ul>

<p>You should generally follow these rules, unless you are mirroring some other tool's naming convention, like a database schema or message format.</p>

<p>You can also choose to use <code>CamelCase</code> for things that are class-like but not quite classes -- the main benefit of <code>CamelCase</code> is calling attention to something as a "global noun", rather than a local label or a verb. Notice that Python names <code>True</code>, <code>False</code>, and <code>None</code> use <code>CamelCase</code> even though they are not classes.</p>

<h3><a id="user-content-avoid-name-adornments" class="anchor" href="#avoid-name-adornments" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Avoid Name Adornments</h3>

<p>... like <code>_prefix</code> or <code>suffix_</code>. Functions and methods can have a <code>_prefix</code> notation to indicate "private", but this should be used sparingly and only for APIs that are expected to be widely used, and where the <code>_private</code> indicator assists with <a href="http://c2.com/cgi/wiki?InformationHiding">information hiding</a>.</p>

<p>PEP8 suggests using a trailing underscore to avoid aliasing a built-in, e.g.</p>

<div class="highlight highlight-source-python"><pre>sum_ <span class="pl-k">=</span> <span class="pl-c1">sum</span>(some_long_list)
<span class="pl-c1">print</span>(sum_)</pre></div>

<p>This is OK in a pinch, but it might be better to just choose a different name.</p>

<p>You should rarely use <code>__mangled</code> double-underscore prefixes for class/instance/method labels, which have special <a href="https://docs.python.org/2/tutorial/classes.html#private-variables-and-class-local-references">name mangling behavior</a> -- it's rarely necessary. Never create your own names using <code>__dunder__</code> adornments unless you are implementing a Python standard protocol, like <code>__len__</code>; this is a namespace specifically reserved for Python's internal protocols and shouldn't be co-opted for your own stuff.</p>

<h3><a id="user-content-avoid-one-character-names" class="anchor" href="#avoid-one-character-names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Avoid One-Character Names</h3>

<p>There are some one-character label names that are common and acceptable.</p>

<p>With <code>lambda</code>, using <code>x</code> for single-argument functions is OK. For example:</p>

<div class="highlight highlight-source-python"><pre>encode <span class="pl-k">=</span> <span class="pl-k">lambda</span> <span class="pl-smi">x</span>: x.encode(<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>ignore<span class="pl-pds">"</span></span>)</pre></div>

<p>With tuple unpacking, using <code>_</code> as a throwaway label is also OK. For example:</p>



<p>This basically means, "ignore the first element."</p>

<p>Similar to <code>lambda</code>, inside list/dict/set comprehensions, generator expressions, or very short (1-2 line) for loops, a single-char iteration label can be used. This is also typically <code>x</code>, e.g.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c1">sum</span>(x <span class="pl-k">for</span> x <span class="pl-k">in</span> items <span class="pl-k">if</span> x <span class="pl-k">&gt;</span> <span class="pl-c1">0</span>)</pre></div>

<p>to sum all positive integers in the sequence <code>items</code>.</p>

<p>It is also very common to use <code>i</code> as shorthand for "index", and commonly with the <code>enumerate</code> built-in. For example:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">for</span> i, item <span class="pl-k">in</span> <span class="pl-c1">enumerate</span>(items):
    <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-c1">%4s</span>: <span class="pl-c1">%s</span><span class="pl-pds">"</span></span> <span class="pl-k">%</span> (i, item))</pre></div>

<p>Outside of these cases, you should rarely, perhaps <strong>never</strong>, use single-character label/argument/method names. This is because it just makes it impossible to <code>grep</code> for stuff.</p>

<h3><a id="user-content-use-self-and-similar-conventions" class="anchor" href="#use-self-and-similar-conventions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Use <code>self</code> and similar conventions</h3>

<p>You should:</p>

<ul>
<li>always name a method's first argument <code>self</code></li>
<li>always name <code>@classmethod</code>'s first argument <code>cls</code></li>
<li>always use <code>*args</code> and <code>**kwargs</code> for variable argument lists</li>
</ul>

<h2><a id="user-content-nitpicks-that-arent-worth-it" class="anchor" href="#nitpicks-that-arent-worth-it" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Nitpicks That Aren't Worth It</h2>

<p>There's nothing to gain from not following these rules, so you should just follow them.</p>



<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
<span class="pl-k">class</span> <span class="pl-en">JSONWriter</span>:
    <span class="pl-k">pass</span>

<span class="pl-c"># good</span>
<span class="pl-k">class</span> <span class="pl-en">JSONWriter</span>(<span class="pl-c1">object</span>):
    <span class="pl-k">pass</span></pre></div>

<p>In Python 2, it's important to follow this rule. In Python 3, all classes implicitly inherit from <code>object</code> and this rule isn't necessary any longer.</p>

<h3><a id="user-content-dont-repeat-instance-labels-in-the-class" class="anchor" href="#dont-repeat-instance-labels-in-the-class" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Don't repeat instance labels in the class</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
<span class="pl-k">class</span> <span class="pl-en">JSONWriter</span>(<span class="pl-c1">object</span>):
    handler <span class="pl-k">=</span> <span class="pl-c1">None</span>
    <span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">handler</span>):
        <span class="pl-v">self</span>.handler <span class="pl-k">=</span> handler

<span class="pl-c"># good</span>
<span class="pl-k">class</span> <span class="pl-en">JSONWriter</span>(<span class="pl-c1">object</span>):
    <span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">handler</span>):
        <span class="pl-v">self</span>.handler <span class="pl-k">=</span> handler</pre></div>



<div class="highlight highlight-source-python"><pre> <span class="pl-c"># bad</span>
<span class="pl-c1">map</span>(truncate, <span class="pl-c1">filter</span>(<span class="pl-k">lambda</span> <span class="pl-smi">x</span>: <span class="pl-c1">len</span>(x) <span class="pl-k">&gt;</span> <span class="pl-c1">30</span>, items))

 <span class="pl-c"># good</span>
[truncate(x) <span class="pl-k">for</span> x <span class="pl-k">in</span> items <span class="pl-k">if</span> <span class="pl-c1">len</span>(x) <span class="pl-k">&gt;</span> <span class="pl-c1">30</span>]</pre></div>

<p>Though you should prefer comprehensions for most of the simple cases, there are occasions where <code>map()</code> or <code>filter()</code> will be more readable, so use your judgment.</p>

<h3><a id="user-content-use-parens--for-continuations" class="anchor" href="#use-parens--for-continuations" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Use parens <code>(...)</code> for continuations</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
<span class="pl-k">from</span> itertools <span class="pl-k">import</span> groupby, chain, \
                      izip, islice

<span class="pl-c"># good</span>
<span class="pl-k">from</span> itertools <span class="pl-k">import</span> (groupby, chain,
                       izip, islice)</pre></div>

<h3><a id="user-content-use-parens--for-fluent-apis" class="anchor" href="#use-parens--for-fluent-apis" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Use parens <code>(...)</code> for fluent APIs</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
response <span class="pl-k">=</span> Search(<span class="pl-v">using</span><span class="pl-k">=</span>client) \
           .filter(<span class="pl-s"><span class="pl-pds">"</span>term<span class="pl-pds">"</span></span>, <span class="pl-v">cat</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>search<span class="pl-pds">"</span></span>) \
           .query(<span class="pl-s"><span class="pl-pds">"</span>match<span class="pl-pds">"</span></span>, <span class="pl-v">title</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>python<span class="pl-pds">"</span></span>)

<span class="pl-c"># good</span>
response <span class="pl-k">=</span> (Search(<span class="pl-v">using</span><span class="pl-k">=</span>client)
            .filter(<span class="pl-s"><span class="pl-pds">"</span>term<span class="pl-pds">"</span></span>, <span class="pl-v">cat</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>search<span class="pl-pds">"</span></span>)
            .query(<span class="pl-s"><span class="pl-pds">"</span>match<span class="pl-pds">"</span></span>, <span class="pl-v">title</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>python<span class="pl-pds">"</span></span>))</pre></div>

<h3><a id="user-content-use-implicit-continuations-in-function-calls" class="anchor" href="#use-implicit-continuations-in-function-calls" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Use implicit continuations in function calls</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad -- simply unnecessary backslash</span>
<span class="pl-k">return</span> <span class="pl-c1">set</span>((key.lower(), val.lower()) \
           <span class="pl-k">for</span> key, val <span class="pl-k">in</span> mapping.iteritems())

<span class="pl-c"># good</span>
<span class="pl-k">return</span> <span class="pl-c1">set</span>((key.lower(), val.lower())
           <span class="pl-k">for</span> key, val <span class="pl-k">in</span> mapping.iteritems())</pre></div>

<h3><a id="user-content-use-isinstanceobj-cls-not-typeobj--cls" class="anchor" href="#use-isinstanceobj-cls-not-typeobj--cls" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Use <code>isinstance(obj, cls)</code>, not <code>type(obj) == cls</code></h3>

<p>This is because <code>isinstance</code> covers way more cases, including sub-classes and ABC's. Also, rarely use <code>isinstance</code> at all, since you should usually be doing duck typing, instead!</p>

<h3><a id="user-content-use-with-for-files-and-locks" class="anchor" href="#use-with-for-files-and-locks" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Use <code>with</code> for files and locks</h3>

<p>The <code>with</code> statement subtly handles file closing and lock releasing even in the case of exceptions being raised. So:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
somefile <span class="pl-k">=</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">"</span>somefile.txt<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>w<span class="pl-pds">"</span></span>)
somefile.write(<span class="pl-s"><span class="pl-pds">"</span>sometext<span class="pl-pds">"</span></span>)
<span class="pl-k">return</span>

<span class="pl-c"># good</span>
<span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">"</span>somefile.txt<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>w<span class="pl-pds">"</span></span>) <span class="pl-k">as</span> somefile:
    somefile.write(<span class="pl-s"><span class="pl-pds">"</span>sometext<span class="pl-pds">"</span></span>)
<span class="pl-k">return</span></pre></div>

<h3><a id="user-content-use-is-when-comparing-to-none" class="anchor" href="#use-is-when-comparing-to-none" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Use <code>is</code> when comparing to <code>None</code></h3>

<p>The <code>None</code> value is a singleton but when you're checking for <code>None</code>, you rarely want to actually call <code>__eq__</code> on the LHS argument. So:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
<span class="pl-k">if</span> item <span class="pl-k">==</span> <span class="pl-c1">None</span>:
    <span class="pl-k">continue</span>

<span class="pl-c"># good</span>
<span class="pl-k">if</span> item <span class="pl-k">is</span> <span class="pl-c1">None</span>:
   <span class="pl-k">continue</span></pre></div>

<p>Not only is the good form faster, it's also more correct. It's no more concise to use <code>==</code>, so just remember this rule!</p>

<h3><a id="user-content-avoid-syspath-hacks" class="anchor" href="#avoid-syspath-hacks" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Avoid <code>sys.path</code> hacks</h3>

<p>It can be tempting to do <code>sys.path.insert(0, "../")</code> and similar to control Python's import approach, but you should avoid these like the plague.</p>

<p>Python has a somewhat-complex, but very comprehensible, approach to module path resolution. You can adjust how Python loads modules via <code>PYTHONPATH</code> or via tricks like <code>setup.py develop</code>. You can also run Python using <code>-m</code> to good effect, e.g. <code>python -m mypkg.mymodule</code> rather than <code>python mypkg/mymodule.py</code>. You should not rely upon the current working directory that you run python out of for your code to work properly. David Beazley saves the day once more with his PDF slides which are worth a skim, <a href="http://www.dabeaz.com/modulepackage/ModulePackage.pdf">"Modules and Packages: Live and Let Die!"</a></p>



<p>... and when you must, don't make too many.</p>

<div class="highlight highlight-source-python"><pre> <span class="pl-c"># bad</span>
 <span class="pl-k">class</span> <span class="pl-en">ArgumentError</span>(<span class="pl-c1">Exception</span>):
     <span class="pl-k">pass</span>
 <span class="pl-c1">...</span>
 <span class="pl-k">raise</span> ArgumentError(url)

 <span class="pl-c"># good</span>
 <span class="pl-k">raise</span> <span class="pl-c1">ValueError</span>(<span class="pl-s"><span class="pl-pds">"</span>bad value for url: <span class="pl-c1">%s</span><span class="pl-pds">"</span></span> <span class="pl-k">%</span> url)</pre></div>

<p>Note that Python includes <a href="https://docs.python.org/2/library/exceptions.html#exception-hierarchy">a rich set of built-in exception classes</a>. Leverage these appropriately, and you should "customize" them simply by instantiating them with string messages that describe the specific error condition you hit. It is most common to raise <code>ValueError</code> (bad argument), <code>LookupError</code> (bad key), or <code>AssertionError</code> (via the <code>assert</code> statement) in user code.</p>

<p>A good rule of thumb for whether you should create your own exception type is to figure out whether a caller should catch it <strong>every time</strong> they call your function. If so, you probably <strong>should</strong> make your own type. But this is relatively rare. A good example of an exception type that clearly had to exist is <a href="http://www.tornadoweb.org/en/stable/web.html#tornado.web.HTTPError">tornado.web.HTTPError</a>. But notice how Tornado did not go overboard: there is one exception class for <strong>all</strong> HTTP errors raised by the framework or user code.</p>

<h3><a id="user-content-short-docstrings-are-proper-one-line-sentences" class="anchor" href="#short-docstrings-are-proper-one-line-sentences" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Short docstrings are proper one-line sentences</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
<span class="pl-k">def</span> <span class="pl-en">reverse_sort</span>(<span class="pl-smi">items</span>):
    <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">    sort items in reverse order</span>
<span class="pl-s">    <span class="pl-pds">"""</span></span>

<span class="pl-c"># good</span>
<span class="pl-k">def</span> <span class="pl-en">reverse_sort</span>(<span class="pl-smi">items</span>):
    <span class="pl-s"><span class="pl-pds">"""</span>Sort items in reverse order.<span class="pl-pds">"""</span></span></pre></div>

<p>Keep the triple-quote's on the same line <code>"""</code>, capitalize the first letter, and include a period. Four lines become two, the <code>__doc__</code> attribute doesn't have crufty newlines, and the pedants are pleased!</p>



<p>It's done by the stdlib and most open source projects. It's supported out-of-the-box by Sphinx. Just do it! The Python <code>requests</code> module uses these to extremely good effect. See the <a href="https://github.com/kennethreitz/requests/blob/master/requests/api.py"><code>requests.api</code></a> module, for example.</p>

<h3><a id="user-content-strip-trailing-whitespace" class="anchor" href="#strip-trailing-whitespace" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Strip trailing whitespace</h3>

<p>This is perhaps the ultimate nitpick, but if you don't do it, it will drive people crazy. There are no shortage of tools that will do this for you in your text editor automatically; here's <a href="https://github.com/amontalenti/home/blob/master/.vim/bundle/whitespace/plugin/whitespace.vim">a link to the one I use for vim</a>.</p>

<h2><a id="user-content-writing-good-docstrings" class="anchor" href="#writing-good-docstrings" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Writing Good Docstrings</h2>

<p>Here's a quick reference to using Sphinx-style reST in your function docstrings:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">get</span>(<span class="pl-smi">url</span>, <span class="pl-smi">qsargs</span><span class="pl-k">=</span><span class="pl-c1">None</span>, <span class="pl-smi">timeout</span><span class="pl-k">=</span><span class="pl-c1">5.0</span>):
    <span class="pl-s"><span class="pl-pds">"""</span>Send an HTTP GET request.</span>
<span class="pl-s"/>
<span class="pl-s">    :param url: URL for the new request.</span>
<span class="pl-s">    :type url: str</span>
<span class="pl-s">    :param qsargs: Converted to query string arguments.</span>
<span class="pl-s">    :type qsargs: dict</span>
<span class="pl-s">    :param timeout: In seconds.</span>
<span class="pl-s">    :rtype: mymodule.Response</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-k">return</span> request(<span class="pl-s"><span class="pl-pds">'</span>get<span class="pl-pds">'</span></span>, url, <span class="pl-v">qsargs</span><span class="pl-k">=</span>qsargs, <span class="pl-v">timeout</span><span class="pl-k">=</span>timeout)</pre></div>

<p>Don't document for the sake of documenting. The way to think about this is:</p>

<div class="highlight highlight-source-python"><pre>good_names <span class="pl-k">+</span> explicit_defaults <span class="pl-k">&gt;</span> verbose_docs <span class="pl-k">+</span> type_specs</pre></div>

<p>That is, in the example above, there is no need to say <code>timeout</code> is a <code>float</code>, because the default value is <code>5.0</code>, which is clearly a <code>float</code>. It is useful to indicate in the documentation that the semantic meaning is "seconds", thus <code>5.0</code> means 5 seconds. Meanwhile, the caller has no clue what <code>qsargs</code> should be, so we give a hint with the <code>type</code> annotation, and the caller also has no clue what to expect back from the function, so an <code>rtype</code> annotation is appropriate.</p>

<p>One last point. Guido once said that his key insight for Python is that, "code is read much more often than it is written." Well, a corollary of this is that <strong>some documentation helps, but too much documentation hurts</strong>.</p>

<p>You should basically only document functions you expect to be widely re-used. If you document every function in an internal module, you'll just end up with a less maintainable module, since the documentation needs to be refactored when the code is refactored. Don't "cargo cult" your docstrings and definitely don't auto-generate them with tooling!</p>

<h2><a id="user-content-paradigms-and-patterns" class="anchor" href="#paradigms-and-patterns" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Paradigms and Patterns</h2>

<h3><a id="user-content-functions-vs-classes" class="anchor" href="#functions-vs-classes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Functions vs classes</h3>

<p>You should usually prefer functions to classes. Functions and modules are the basic units of code re-use in Python, and they are the most flexible form. Classes are an "upgrade path" for certain Python facilities, such as implementing containers, proxies, descriptors, type systems, and more. But usually, functions are a better option.</p>

<p>Some might like the code organization benefits of grouping related functions together into classes. But this is a mistake. You should group related functions together into <strong>modules</strong>.</p>

<p>Though sometimes classes can act as a helpful "mini namespace" (e.g. with <code>@staticmethod</code>), more often a group of methods should be contributing to the internal operation of an object, rather than merely being a behavior grouping.</p>

<p>It's always better to have a <code>lib.time</code> module for time-related functions than to have a <code>TimeHelper</code> class with a bunch of methods you are forced to subclass in order to use! Classes proliferate other classes, which proliferates complexity and decreases readability.</p>

<h3><a id="user-content-generators-and-iterators" class="anchor" href="#generators-and-iterators" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Generators and iterators</h3>

<p>Generators and iterators are Python's most powerful features -- you should master the iterator protocol, the <code>yield</code> keyword, and generator expressions.</p>

<p>Not only are generators important for any function that needs to be called over a large stream of data, but they also have the effect of simplifying code by making it easy for you to write your own iterators. Refactoring code to generators often simplifies it while making it work in more scenarios.</p>

<p>Luciano Ramalho, author of "Fluent Python", has a 30-minute presentation, <a href="https://www.youtube.com/watch?v=z4P6hSa6K9g">"Iterators &amp; Generators: the Python Way"</a>, which gives an excellent, fast-paced overview. David Beazley, author of "Python Essential Reference" and "Python Cookbook", has a mind-bending three-hour video tutorial entitled <a href="https://www.youtube.com/watch?v=5-qadlG7tWo">"Generators: The Final Frontier"</a> that is a satisfying exposition of generator use cases. Mastering this topic is worth it because it applies everywhere.</p>

<h3><a id="user-content-declarative-vs-imperative" class="anchor" href="#declarative-vs-imperative" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Declarative vs imperative</h3>

<p>You should prefer declarative to imperative programming. This is code that says  <strong>what</strong> you want to do, rather than code that describes <strong>how</strong> to do it. Python's <a href="https://docs.python.org/3/howto/functional.html">functional programming guide</a> includes some good details and examples of how to use this style effectively.</p>

<p>You should use lightweight data structures like <code>list</code>, <code>dict</code>, <code>tuple</code>, and <code>set</code> to your advantage. It's always better to lay out your data, and then write some code to transform it, than to build up data by repeatedly calling mutating functions/methods.</p>

<p>An example of this is the common list comprehension refactoring:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
filtered <span class="pl-k">=</span> []
<span class="pl-k">for</span> x <span class="pl-k">in</span> items:
    <span class="pl-k">if</span> x.endswith(<span class="pl-s"><span class="pl-pds">"</span>.py<span class="pl-pds">"</span></span>):
        filtered.append(x)
<span class="pl-k">return</span> filtered</pre></div>

<p>This should be rewritten as:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># good</span>
<span class="pl-k">return</span> [x
        <span class="pl-k">for</span> x <span class="pl-k">in</span> items
        <span class="pl-k">if</span> x.endswith(<span class="pl-s"><span class="pl-pds">"</span>.py<span class="pl-pds">"</span></span>)]</pre></div>

<p>But another good example is rewriting an <code>if</code>/<code>elif</code>/<code>else</code> chain as a <code>dict</code> lookup.</p>

<h3><a id="user-content-prefer-pure-functions-and-generators" class="anchor" href="#prefer-pure-functions-and-generators" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Prefer "pure" functions and generators</h3>

<p>This is a concept that we can borrow from the functional programming community.  These kinds of functions and generators are alternatively described as "side-effect free", "referentially transparent", or as having "immutable inputs/outputs".</p>

<p>As a simple example, you should avoid code like this:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
<span class="pl-k">def</span> <span class="pl-en">dedupe</span>(<span class="pl-smi">items</span>):
    <span class="pl-s"><span class="pl-pds">"""</span>Remove dupes in-place, return items and # of dupes.<span class="pl-pds">"""</span></span>
    seen <span class="pl-k">=</span> <span class="pl-c1">set</span>()
    dupe_positions <span class="pl-k">=</span> []
    <span class="pl-k">for</span> i, item <span class="pl-k">in</span> <span class="pl-c1">enumerate</span>(items):
        <span class="pl-k">if</span> item <span class="pl-k">in</span> seen:
            dupe_positions.append(i)
        <span class="pl-k">else</span>:
            seen.add(item)
    num_dupes <span class="pl-k">=</span> <span class="pl-c1">len</span>(dupe_positions)
    <span class="pl-k">for</span> idx <span class="pl-k">in</span> <span class="pl-c1">reversed</span>(dupe_positions):
        items.pop(idx)
    <span class="pl-k">return</span> items, num_dupes</pre></div>

<p>This same function can be written as follows:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># good</span>
<span class="pl-k">def</span> <span class="pl-en">dedupe</span>(<span class="pl-smi">items</span>):
    <span class="pl-s"><span class="pl-pds">"""</span>Return deduped items and # of dupes.<span class="pl-pds">"""</span></span>
    deduped <span class="pl-k">=</span> <span class="pl-c1">set</span>(items)
    num_dupes <span class="pl-k">=</span> <span class="pl-c1">len</span>(items) <span class="pl-k">-</span> <span class="pl-c1">len</span>(deduped)
    <span class="pl-k">return</span> deduped, num_dupes</pre></div>

<p>This is a somewhat shocking example. In addition to making this function pure, we also made it much, much shorter. It's not only shorter: it's better. Its purity means <code>assert dedupe(items) == dedupe(items)</code> always holds true for the "good" version. In the "bad" version, <code>num_dupes</code> will <strong>always</strong> be <code>0</code> on the second call, which can lead to subtle bugs when using the function.</p>

<p>This also illustrates imperative vs declarative style: the function now reads like a description of what we need, rather than a set of instructions to build up what we need.</p>

<h3><a id="user-content-prefer-simple-argument-and-return-types" class="anchor" href="#prefer-simple-argument-and-return-types" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Prefer simple argument and return types</h3>

<p>Functions should operate on data, rather than on custom objects, wherever possible. Prefer simple argument types like <code>dict</code>, <code>set</code>, <code>tuple</code>, <code>list</code>, <code>int</code>, <code>float</code>, and <code>bool</code>. Upgrade from there to standard library types like <code>datetime</code>, <code>timedelta</code>, <code>array</code>, <code>Decimal</code>, and <code>Future</code>. Only upgrade to your own custom types when absolutely necessary.</p>

<p>As a good rule of thumb for whether your function is simple enough, ask yourself whether its arguments and return values could always be JSON-serializable. It turns out, this rule of thumb matters more than you might think: JSON-serializability is often a prerequisite to make the functions usable in parallel computing contexts. But, for the purpose of this document, the main benefits are: readability, testability, and overall function simplicity.</p>

<h3><a id="user-content-avoid-traditional-oop" class="anchor" href="#avoid-traditional-oop" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Avoid "traditional" OOP</h3>

<p>In "traditional OOP languages" like Java and C++, code re-use is achieved through class hierarchies and polymorphism, or so those languages claim. In Python, though we have the ability to subclass and to do class-based polymorphism, in practice, these capabilities are used rarely in idiomatic Python programs.</p>

<p>It's more common to achieve re-use through modules and functions, and it's more common to achieve dynamic dispatch through duck typing. If you find yourself using super classes as a form of code re-use, stop what you're doing and reconsider. If you find yourself using lots of polymorphism, consider whether one of Python's dunder protocols or duck typing strategies might apply better.</p>

<p>See also the excellent Python talk, <a href="https://www.youtube.com/watch?v=o9pEzgHorH0">"Stop Writing Classes"</a>, by a Python core contributor. In it, the presenter suggests that if you have built a class with a single method that is named like a class (e.g. <code>Runnable.run()</code>), then what you've done is modeled a function as a class, and you should just stop. Since in Python, functions are "first-class", there is <strong>no reason</strong> to do this!</p>

<h3><a id="user-content-mixins-are-sometimes-ok" class="anchor" href="#mixins-are-sometimes-ok" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Mixins are sometimes OK</h3>

<p>One way to do class-based re-use without going overboard on type hierarchies is to use Mixins. Don't overuse these, though. "Flat is better than nested" applies to type hierarchies, too, so you should avoid introducing needless required layers of hierarchy just to decompose behavior.</p>

<p>Mixins are not actually a Python language feature, but are possible thanks to its support for multiple inheritance. You can create base classes that "inject" functionality into your subclass without forming an "important" part of a type hierarchy, simply by listing that base class as the first entry in the <code>bases</code> list. An example:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">class</span> <span class="pl-en">APIHandler</span>(<span class="pl-e">AuthMixin</span>, <span class="pl-e">RequestHandler</span>):
    <span class="pl-s"><span class="pl-pds">"""</span>Handle HTTP/JSON requests with security.<span class="pl-pds">"""</span></span></pre></div>

<p>The order matters, so may as well remember the rule: <code>bases</code> forms a hierarchy bottom-to-top. One readability benefit here is that everything you need to know about this class is contained in the <code>class</code> definition itself: "it mixes in auth behavior and is a specialized Tornado RequestHandler."</p>

<h3><a id="user-content-be-careful-with-frameworks" class="anchor" href="#be-careful-with-frameworks" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Be careful with frameworks</h3>

<p>Python has a slew of frameworks for web, databases, and more. One of the joys of the language is that it's easy to create your own frameworks. When using an open source framework, you should be careful not to couple your "core code" too closely to the framework itself.</p>

<p>When considering building your own framework for your code, you should err on the side of caution. The standard library has a lot of stuff built-in, PyPI has even more, and usually, <a href="http://c2.com/cgi/wiki?YouArentGonnaNeedIt">YAGNI applies</a>.</p>

<h3><a id="user-content-respect-metaprogramming" class="anchor" href="#respect-metaprogramming" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Respect metaprogramming</h3>

<p>Python supports "metaprogramming" via a number of features, including decorators, context managers, descriptors, import hooks, metaclasses and AST transformations.</p>

<p>You should feel comfortable using and understanding these features -- they are a core part of the language and are fully supported by it. But you should realize that when you use these features, you are opening yourself up to complex failure scenarios. Thus, treat the creation of metaprogramming facilities for your code similarly to the decision to "build your own framework". They amount to the same thing. When and if you do it, make the facilities into their own modules and document them well!</p>

<h3><a id="user-content-dont-be-afraid-of-dunder-methods" class="anchor" href="#dont-be-afraid-of-dunder-methods" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Don't be afraid of "dunder" methods</h3>

<p>Many people conflate Python's metaprogramming facilities with its support for "double-underscore" or "dunder" methods, such as <code>__getattr__</code>.</p>

<p>As described in  the blog post, <a href="http://www.pixelmonkey.org/2013/04/11/python-double-under-double-wonder">"Python double-under, double-wonder"</a>, there is nothing "special" about dunders. They are nothing more than a lightweight namespace the Python core developers picked for all of Python's internal protocols. After all, <code>__init__</code> is a dunder, and there's nothing magic about it.</p>

<p>It's true that some dunders can create more confusing results than others -- for example, it's probably not a good idea to overload operators without good reason. But many of them, such as <code>__repr__</code>,  <code>__str__</code>, <code>__len__</code>, and <code>__call__</code> are really full parts of the language you should be leveraging in idiomatic Python code. Don't shy away!</p>

<h2><a id="user-content-a-little-zen-for-your-code-style" class="anchor" href="#a-little-zen-for-your-code-style" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>A Little Zen for Your Code Style</h2>

<p>Barry Warsaw, one of the core Python developers, once said that it frustrated him that "The Zen of Python" (<a href="https://www.python.org/dev/peps/pep-0020/">PEP 20</a>) is used as a style guide for Python code, since it was originally written as a poem about Python's <strong>internal</strong> design. That is, the design of the language and language implementation itself. One can acknowledge that, but a few of the lines from PEP 20 serve as pretty good guidelines for idiomatic Python code, so we'll just go with it.</p>

<h3><a id="user-content-beautiful-is-better-than-ugly" class="anchor" href="#beautiful-is-better-than-ugly" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Beautiful is better than ugly</h3>

<p>This one is subjective, but what it usually amounts to is this: will the person who inherits this code from you be impressed or disappointed? What if that person is you, three years later?</p>

<h3><a id="user-content-explicit-is-better-than-implicit" class="anchor" href="#explicit-is-better-than-implicit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Explicit is better than implicit</h3>

<p>Sometimes in the name of refactoring out repetition in our code, we also get a little bit abstract with it. It should be possible to translate the code into plain English and basically understand what's going on. There shouldn't be an excessive amount of "magic".</p>

<h3><a id="user-content-flat-is-better-than-nested" class="anchor" href="#flat-is-better-than-nested" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Flat is better than nested</h3>

<p>This one is really easy to understand. The best functions have no nesting, neither by loops nor <code>if</code> statements. Second best is one level of nesting. Two or more levels of nesting, and you should probably start refactoring to smaller functions.</p>

<p>Also, don't be afraid to refactor a nested if statement into a multi-part boolean conditional. For example:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># bad</span>
<span class="pl-k">if</span> response:
    <span class="pl-k">if</span> response.get(<span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>):
        <span class="pl-k">return</span> <span class="pl-c1">len</span>(response[<span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>])</pre></div>

<p>is better written as:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># good</span>
<span class="pl-k">if</span> response <span class="pl-k">and</span> response.get(<span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>):
    <span class="pl-k">return</span> <span class="pl-c1">len</span>(response[<span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>])</pre></div>

<h3><a id="user-content-readability-counts" class="anchor" href="#readability-counts" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Readability counts</h3>

<p>Don't be afraid to add line-comments with <code>#</code>. Don't go overboard on these or over-document, but a little explanation, line-by-line, often helps a whole lot. Don't be afraid to pick a slightly longer name because it's more descriptive. No one wins any points for shortening "<code>response</code>" to "<code>rsp</code>". Use doctest-style examples to illustrate edge cases in docstrings. Keep it simple!</p>

<h3><a id="user-content-errors-should-never-pass-silently" class="anchor" href="#errors-should-never-pass-silently" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Errors should never pass silently</h3>

<p>The biggest offender here is the bare <code>except: pass</code> clause. Never use these. Suppressing <strong>all</strong> exceptions is simply dangerous. Scope your exception handling to single lines of code, and always scope your <code>except</code> handler to a specific type. Also, get comfortable with the <code>logging</code> module and <code>log.exception(...)</code>.</p>

<h3><a id="user-content-if-the-implementation-is-hard-to-explain-its-a-bad-idea" class="anchor" href="#if-the-implementation-is-hard-to-explain-its-a-bad-idea" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>If the implementation is hard to explain, it's a bad idea</h3>

<p>This is a general software engineering principle -- but applies very well to Python code. Most Python functions and objects can have an easy-to-explain implementation. If it's hard to explain, it's probably a bad idea. Usually you can make a hard-to-explain function easier-to-explain via "divide and conquer" -- split it into several functions.</p>

<h3><a id="user-content-testing-is-one-honking-great-idea" class="anchor" href="#testing-is-one-honking-great-idea" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Testing is one honking great idea</h3>

<p>OK, we took liberty on this one -- in "The Zen of Python", it's actually "namespaces" that's the honking great idea.</p>

<p>But seriously: beautiful code without tests is simply worse than even the ugliest tested code. At least the ugly code can be refactored to be beautiful, but the beautiful code can't be refactored to be verifiably correct, at least not without writing the tests! So, write tests! Please!</p>

<h2><a id="user-content-six-of-one-half-a-dozen-of-the-other" class="anchor" href="#six-of-one-half-a-dozen-of-the-other" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Six of One, Half a Dozen of the Other</h2>

<p>This is a section for arguments we'd rather not settle. Don't rewrite other people's code because of this stuff. Feel free to use these forms interchangeably.</p>

<h3><a id="user-content-strformat-vs-overloaded-format-" class="anchor" href="#strformat-vs-overloaded-format-" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a><code>str.format</code> vs overloaded format <code>%</code></h3>

<p><code>str.format</code> is more robust, yet <code>%</code> with <code>"%s %s"</code> printf-style strings is more concise. Both will be around forever.</p>

<p>Remember to use unicode strings for your format pattern, if you need to preserve unicode:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-s"><span class="pl-k">u</span><span class="pl-pds">"</span><span class="pl-c1">%s</span> <span class="pl-c1">%s</span><span class="pl-pds">"</span></span> <span class="pl-k">%</span> (dt.datetime.utcnow().isoformat(), line)</pre></div>

<p>If you do end up using <code>%</code>, you should consider the <code>"%(name)s"</code> syntax which allows you to use a dictionary rather than a tuple, e.g.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-s"><span class="pl-k">u</span><span class="pl-pds">"</span><span class="pl-c1">%(time)s</span> <span class="pl-c1">%(line)s</span><span class="pl-pds">"</span></span> <span class="pl-k">%</span> {<span class="pl-s"><span class="pl-pds">"</span>time<span class="pl-pds">"</span></span>: dt.datetime.utcnow().isoformat(), <span class="pl-s"><span class="pl-pds">"</span>line<span class="pl-pds">"</span></span>: line}</pre></div>

<p>Also, don't re-invent the wheel. One thing <code>str.format</code> does unequivocally better is support various <a href="https://docs.python.org/2/library/string.html#formatspec">formatting modes</a>, such as humanized numbers and percentages. Use them.</p>

<p>But use whichever one you please. We choose not to care.</p>

<h3><a id="user-content-if-item-vs-if-item-is-not-none" class="anchor" href="#if-item-vs-if-item-is-not-none" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a><code>if item</code> vs <code>if item is not None</code></h3>

<p>This is unrelated to the earlier rule on <code>==</code> vs <code>is</code> for <code>None</code>. In this case, we are actually taking advantage of Python's "truthiness rules" to our benefit in <code>if item</code>, e.g. as a shorthand "item is not None or empty string."</p>

<p>Truthiness is a <a href="https://docs.python.org/2/library/stdtypes.html#truth-value-testing">tad complicated</a> in Python and certainly the latter is safer against some classes of bugs. The former, however, is very common in much Python code, and it's shorter. We choose not to care.</p>

<h3><a id="user-content-implicit-multi-line-strings-vs-triple-quote-" class="anchor" href="#implicit-multi-line-strings-vs-triple-quote-" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Implicit multi-line strings vs triple-quote <code>"""</code></h3>

<p>Python's compiler will automatically join multiple quoted strings together into a single string during the parse phase if it finds nothing in between them, e.g.</p>

<div class="highlight highlight-source-python"><pre>msg <span class="pl-k">=</span> (<span class="pl-s"><span class="pl-pds">"</span>Hello, wayward traveler!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>
       <span class="pl-s"><span class="pl-pds">"</span>What shall we do today?<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>
       <span class="pl-s"><span class="pl-pds">"</span>=&gt;<span class="pl-pds">"</span></span>)
<span class="pl-c1">print</span>(msg)</pre></div>

<p>This is roughly equivalent to:</p>

<div class="highlight highlight-source-python"><pre>msg <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>Hello, wayward traveler!</span>
<span class="pl-s">What shall we do today?</span>
<span class="pl-s">=&gt;<span class="pl-pds">"""</span></span>
<span class="pl-c1">print</span>(msg)</pre></div>

<p>In the former's case, you keep the indentation clean, but need the ugly newline characters. In the latter case, you don't need the newlines, but break indentation. We choose not to care.</p>

<h3><a id="user-content-using-raise-with-classes-vs-instances" class="anchor" href="#using-raise-with-classes-vs-instances" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using <code>raise</code> with classes vs instances</h3>

<p>It turns out Python lets you pass either an exception <strong>class</strong> or an exception <strong>instance</strong> to the <code>raise</code> statement. For example, these two lines are roughly equivalent:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">raise</span> <span class="pl-c1">ValueError</span>
<span class="pl-k">raise</span> <span class="pl-c1">ValueError</span>()</pre></div>

<p>Essentially, Python turns the <a href="https://docs.python.org/2.7/reference/simple_stmts.html#the-raise-statement">first line into the second automatically</a>. You should probably prefer the second form, if for no other reason than to <strong>actually provide a useful argument</strong>, like a helpful message about why the <code>ValueError</code> occurred. But these two lines <strong>are</strong> equivalent and you shouldn't rewrite one style into the other just because. We choose not to care.</p>

<h2><a id="user-content-standard-tools-and-project-structure" class="anchor" href="#standard-tools-and-project-structure" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Standard Tools and Project Structure</h2>

<p>We've made some choices on "best-of-breed" tools for things, as well as the very minimal starting structure for a proper Python project.</p>

<h3><a id="user-content-the-standard-library" class="anchor" href="#the-standard-library" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>The Standard Library</h3>

<ul>
<li><code>import datetime as dt</code>: always import <code>datetime</code> this way</li>
<li><code>dt.datetime.utcnow()</code>: preferred to <code>.now()</code>, which does local time</li>
<li><code>import json</code>: the standard for data interchange</li>
<li><code>from collections import namedtuple</code>: use for lightweight data types</li>
<li><code>from collections import defaultdict</code>: use for counting/grouping</li>
<li><code>from collections import deque</code>: a fast double-ended queue</li>
<li><code>from itertools import groupby, chain</code>: for declarative style</li>
<li><code>from functools import wraps</code>: use for writing well-behaved decorators</li>
<li><code>argparse</code>: for "robust" CLI tool building</li>
<li><code>fileinput</code>: to create quick UNIX pipe-friendly tools</li>
<li><code>log = logging.getLogger(__name__)</code>: good enough for logging</li>
<li><code>from __future__ import absolute_import</code>: fixes import aliasing</li>
</ul>

<h3><a id="user-content-common-third-party-libraries" class="anchor" href="#common-third-party-libraries" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Common Third-Party Libraries</h3>

<ul>
<li><code>python-dateutil</code> for datetime parsing and calendars</li>
<li><code>pytz</code> for timezone handling</li>
<li><code>tldextract</code> for better URL handling</li>
<li><code>msgpack-python</code> for a more compact encoding than JSON</li>
<li><code>futures</code> for Future/pool concurrency primitives</li>
<li><code>docopt</code> for quick throwaway CLI tools</li>
<li><code>py.test</code> for unit tests, along with <code>mock</code> and <code>hypothesis</code></li>
</ul>

<h3><a id="user-content-local-development-project-skeleton" class="anchor" href="#local-development-project-skeleton" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Local Development Project Skeleton</h3>

<p>For all Python packages and libraries:</p>

<ul>
<li>no <code>__init__.py</code> in root folder: give your package a folder name!</li>
<li><code>mypackage/__init__.py</code> preferred to <code>src/mypackage/__init__.py</code></li>
<li><code>mypackage/lib/__init__.py</code> preferred to <code>lib/__init__.py</code></li>
<li><code>mypackage/settings.py</code> preferred to <code>settings.py</code></li>
<li><code>README.rst</code> describes the repo for a newcomer; use reST</li>
<li><code>setup.py</code> for simple facilities like <code>setup.py develop</code></li>
<li><code>requirements.txt</code> describes package dependencies for <code>pip</code></li>
<li><code>dev-requirements.txt</code> additional dependencies for tests/local</li>
<li><code>Makefile</code> for simple (!!!) build/lint/test/run steps</li>
</ul>

<p>Also, always <a href="http://nvie.com/posts/better-package-management/">pin your requirements</a>.</p>

<h2><a id="user-content-some-inspiration" class="anchor" href="#some-inspiration" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Some Inspiration</h2>

<p>The following links may give you some inspiration about the core of writing Python code with great style and taste.</p>



<p>Go forth and be Pythonic!</p>

<pre><code>$ python
&gt;&gt;&gt; import antigravity
</code></pre>

<h2><a id="user-content-contributors" class="anchor" href="#contributors" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Contributors</h2>

<ul>
<li>Andrew Montalenti (<a href="http://twitter.com/amontalenti">@amontalenti</a>): original author</li>
<li>Vincent Driessen (<a href="http://twitter.com/nvie">@nvie</a>): edits and suggestions</li>
</ul>

<hr/>

<p>Like good Python style? Then perhaps you'd like to <a href="https://twitter.com/amontalenti/status/682968375702716416">work on our team of Pythonistas</a> at Parse.ly!</p>
</article>
  </div></body></html>