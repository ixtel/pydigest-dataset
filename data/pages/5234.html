<html><body><div><div id="example">
<h2>Example</h2>
<p>Here is the most simple example of use, sending a message with the BlockingConnection adapter:</p>
<pre><span class="kn">import</span> <span class="nn">pika</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">pika</span><span class="o">.</span><span class="n">BlockingConnection</span><span class="p">()</span>
<span class="n">channel</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">channel</span><span class="p">()</span>
<span class="n">channel</span><span class="o">.</span><span class="n">basic_publish</span><span class="p">(</span><span class="n">exchange</span><span class="o">=</span><span class="s1">'example'</span><span class="p">,</span>
                      <span class="n">routing_key</span><span class="o">=</span><span class="s1">'test'</span><span class="p">,</span>
                      <span class="n">body</span><span class="o">=</span><span class="s1">'Test Message'</span><span class="p">)</span>
<span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre>
<p>And an example of writing a blocking consumer:</p>
<pre><span class="kn">import</span> <span class="nn">pika</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">pika</span><span class="o">.</span><span class="n">BlockingConnection</span><span class="p">()</span>
<span class="n">channel</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">channel</span><span class="p">()</span>

<span class="k">for</span> <span class="n">method_frame</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">channel</span><span class="o">.</span><span class="n">consume</span><span class="p">(</span><span class="s1">'test'</span><span class="p">):</span>

    <span class="c1"># Display the message parts and ack the message</span>
    <span class="k">print</span> <span class="n">method_frame</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">body</span>
    <span class="n">channel</span><span class="o">.</span><span class="n">basic_ack</span><span class="p">(</span><span class="n">method_frame</span><span class="o">.</span><span class="n">delivery_tag</span><span class="p">)</span>

    <span class="c1"># Escape out of the loop after 10 messages</span>
    <span class="k">if</span> <span class="n">method_frame</span><span class="o">.</span><span class="n">delivery_tag</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>

<span class="c1"># Cancel the consumer and return any pending messages</span>
<span class="n">requeued_messages</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
<span class="k">print</span> <span class="s1">'Requeued </span><span class="si">%i</span><span class="s1"> messages'</span> <span class="o">%</span> <span class="n">requeued_messages</span>
<span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre>
</div>
<div id="contributing">
<h2>Contributing</h2>
<p>To contribute to pika, please make sure that any new features or changes
to existing functionality include test coverage. Additionally, please format
your code using <a href="http://pypi.python.org/pypi/yapf" rel="nofollow">yapf</a> with <tt>google</tt> style
prior to issuing your pull request.</p>
</div>


</div></body></html>