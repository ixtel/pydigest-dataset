<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-highlander-there-can-be-only-one" class="anchor" href="#highlander-there-can-be-only-one" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Highlander: There can be only one...</h1>

<p><a href="https://travis-ci.org/chriscannon/highlander"><img src="https://camo.githubusercontent.com/ac3e777861bbec268e01481eaac8658b7e6f0649/68747470733a2f2f7472617669732d63692e6f72672f636872697363616e6e6f6e2f686967686c616e6465722e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/chriscannon/highlander.svg?branch=master"/></a>
<a href="https://coveralls.io/r/chriscannon/highlander"><img src="https://camo.githubusercontent.com/f36b784af70eae8898614469ea304344253b9977/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f636872697363616e6e6f6e2f686967686c616e6465722f62616467652e737667" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/chriscannon/highlander/badge.svg"/></a></p>

<h1><a id="user-content-about" class="anchor" href="#about" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>About</h1>

<p>Highlander is a decorator to help developers ensure that their python
process is only running once. This is helpful when you have
a python program running on a set schedule (i.e., a cron) and you do
not want one run of the program to overlap with another run. Highlander
accomplishes this by creating a directory containing a file
on disk that contains the current process identifier (PID) and
creation time. If Highlander detects that the PID directory currently
exists it reads the PID file inside it for the PID and creation time
and checks to see if that process exists. If it does exist, it ends the program
and logs that the program was already running. If it does not exist,
Highlander removes the old process information directory and file, creates new ones, and
executes the function associated with the decorator.</p>

<h1><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h1>

<pre><code>pip install highlander-one
</code></pre>

<h1><a id="user-content-examples" class="anchor" href="#examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Examples</h1>

<p>An example using the default directory (i.e., current working directory):</p>

<pre><code>from highlander import one

@one()
def run():
    ...

if __name__ == '__main__':
    run()
</code></pre>

<p>An example using a user-specified directory:</p>

<pre><code>from highlander import one

@one('/tmp/my_app/.pid')
def run():
    ...

if __name__ == '__main__':
    run()
</code></pre>

<h1><a id="user-content-faq" class="anchor" href="#faq" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>F.A.Q.</h1>

<p><strong>Why not use flock? Stop reinventing Unix dumb dumb!</strong></p>

<p>There are three reasons I did not use flock:</p>

<ol>
<li><p>I knew there was no way that <code>fcntl.flock</code> would work the same on all operating systems
and I found a lot of articles on the web stating just that.
What I use in its stead is directory creation, which I believe is a much
more reliable way to do locking across all operating systems and still
only dependent on the file system to ensure it's atomic.</p></li>
<li><p>If a process is killed abruptly (e.g., kill -9) with flock the file
remains exclusively locked even though the process is not running. This
occurs because the process did not have enough time to clean up the exclusive handle on the lock file. What
this means is that when you attempt to run your program it will be unable to
acquire the lock and your program will not run until you manually intervene and
delete the lock file. My solution does not have this problem.</p></li>
<li><p>If you are using the flock Unix tool in conjunction with your program its
default behavior is to hang until the lock file is free and then execute the command.
In my opinion, this is not ideal default behaviour because you could have a ton of
processes build up over time and waste resources. What Highlander does is essentially skip
that run of the program by returning immediately.</p></li>
</ol>
</article>
  </div></body></html>