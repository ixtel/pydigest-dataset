<html><body><div><div class="ibm-col-1-1">

<h2 id="N1004E">Введение</h2><p>В этой статье мы рассмотрим ещё одну библиотеку для создания GUI-приложений в Python – wxPython и 
обратимся к двум смежным вопросам: работе с 2D графикой с помощью библиотеки PyGame и автоматизации 
GUI-приложения с помощью сценариев PyZenity.</p><p class="ibm-alternate-rule"><hr/></p><p class="ibm-ind-link ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">В начало</a></p><h2 id="N10054">wxPython</h2><p>Проект wxPython происходит от известного проекта wxWidgets. В основе wxWidgets лежит GUI-библиотека, 
реализованная на языке C++, также проект содержит набор классов C++ с богатыми возможностями 
(высокоуровневые структуры данных и др.). А wxPython в свою очередь предлагает "<strong>обертки</strong>" 
для классов wxWidgets связанных с GUI.</p><p>Библиотека wxWidgets не настолько популярна в Linux, как GTK+ или Ot, потому всё необходимое для 
использования wxPython потребуется установить отдельно:</p><div class="codesection"><pre class="displaycode"><strong>$ aptitude search python-wx</strong>
p   python-wxglade      - GUI designer written in Python with wxPython
p   python-wxgtk2.8     - wxWidgets Cross-platform C++ GUI toolkit (wxPython binding)
p   python-wxgtk2.8-dbg - wxWidgets Cross-platform C++ GUI toolkit (wxPython binding...
p   python-wxmpl        - Painless matplotlib embedding in wxPython
p   python-wxtools      - wxWidgets Cross-platform C++ GUI toolkit (wxPython common...
p   python-wxversion    - wxWidgets Cross-platform C++ GUI toolkit (wxPython version...</pre></div><p>Достаточно будет установить пакет <strong><code>python-wxgtk2</code></strong>, и все 
остальные пакеты он инсталлирует самостоятельно:</p><div class="codesection"><pre class="displaycode"><strong>$ sudo apt-get install python-wxgtk2.8</strong>
...</pre></div><p>В листинге 1 показано простое приложение, использующее wxPython (файл <strong>bare.py</strong> из архива 
<strong>python_gui.tgz</strong> в разделе "Материалы для скачивания"):</p><h5 id="listing1">Листинг 1. Пример wxPython-приложения</h5><div class="codesection"><pre class="displaycode">import wx

class App( wx.App ):

    def OnInit(self):
        frame = wx.Frame( parent=None, title='Bare' )
        frame.Show()
        return True
    
app = App()
app.MainLoop()</pre></div><p>В этом примере создаётся пустое окно GUI-приложения, которое под контролем оконного менеджера Linux 
может перемещаться, менять размер, сворачиваться и разворачиваться во весь экран:</p><img alt="Рисунок 1. Пример GUI-приложения, основанного на библиотеке wxPython" src="fig_01.jpg"/><p>В листинге 2 показано ещё одно wxPython-приложение, использующее возможности API wxPython в 
терминологии классов Python. Это приложение позволяет из Python-кода перенаправить потоки 
<strong><code>SYSOUT</code></strong> и <strong><code>SYSERR</code></strong> 
в созданное окно (примеры для wxPython можно найти в соответствующем учебнике в разделе "Ресурсы"):</p><h5 id="N1009D">Листинг 2. Перенаправление потоков вывода (файл sysout.py)</h5><div class="codesection"><pre class="displaycode">import wx
import sys

class Frame(wx.Frame):

    def __init__(self, parent, id, title):
        print "Frame __init__"
        wx.Frame.__init__(self, parent, id, title)

class App(wx.App):

    def __init__(self, redirect=True, filename=None):
        print "App __init__"
        wx.App.__init__(self, redirect, filename)

    def OnInit(self):
        print "OnInit"                        <strong> # вывод в поток stdout
        # создание окна</strong>
        self.frame = Frame(parent=None, id=-1, title='Startup')
        self.frame.Show()
        self.SetTopWindow(self.frame)
        print &gt;&gt; sys.stderr, "A pretend error message"  <strong># вывод в поток stderr</strong>
        return True

    def OnExit(self):
        print "OnExit"

if __name__ == '__main__':
    app = App(redirect=True) <strong># здесь происходит перенаправление вывода</strong>
    print "before MainLoop"  <strong># здесь запускается основной цикл обработки событий</strong>
    app.MainLoop()
    print "after MainLoop"</pre></div><p>Запустим приложение и посмотрим, какие сообщения <strong><code>print</code></strong> 
будут отправлены в окно приложения, а какие — в терминал запуска:</p><div class="codesection"><pre class="displaycode"><strong>$ python sysout.py</strong>
App __init__
after MainLoop</pre></div><p>На рисунке 2 представлен пример работы приложения:</p><img alt="Рисунок 2. Пример GUI-приложения с перенаправлением ввода/вывода." src="fig_02.jpg"/><p><strong>Примечание.</strong> Все примеры, показанные в этой статье и в руководстве для wxPython, 
используют синтаксис Python 2. Это объясняется тем, что только в середине 2012 года создатель wxPython Робин 
Данн (Robin Dunn) в своём блоге сообщал об <strong>экспериментах</strong> по сборке wxPython для Python 3. 
На сайте проекта в августе 2013 г, в качестве последних стабильных версий указывались реализации для 
Python 2.7.</p><p>Высказываются мнения, что реализация wxPython могла бы стать стандартной GUI-библиотекой для Python, 
если бы эта позиция уже не была занята Tkinter. Тем не менее WxPython используется во многих открытых 
проектах.</p><p class="ibm-alternate-rule"><hr/></p><p class="ibm-ind-link ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">В начало</a></p><h2 id="N100CD">Pygame</h2><p>В отличие от ранее рассмотренных библиотек, Pygame — это инструмент для реализации разнообразных 
игровых стратегий внутри графических окон. Поэтому, помимо инструментов для отображения GUI, он содержит 
и некоторые средства для рисования в этих окнах, создания анимации и ограниченные возможности для 
воспроизведения аудио-потоков.</p><p>Этот пакет не относится к стандартной библиотеки модулей Python, поэтому его потребуется установить 
отдельно.</p><div class="codesection"><pre class="displaycode"><strong>$ yum list pygame*</strong>
...
Доступные пакеты
pygame.i686                        1.9.1-11.fc17      updates
pygame-devel.i686                  1.9.1-11.fc17      updates
<strong># yum install pygame*</strong>
...</pre></div><p><strong>Примечание.</strong> Из-за указанных выше расширений функциональности, инсталляция данного 
пакета приведёт к последующей установке большого числа зависимых пакетов: 
<strong><code>pulseaudio-esound-compat</code></strong>, <strong><code>oss-compat</code></strong>, 
<strong><code>libsmpeg</code></strong> и т.д. Но это стандартное поведение для всех 
GUI-инструментов, так как они используют много дополнительных пакетов (главным образом, библиотек).</p><p>В листинге 3 представлен простейший пример использования PyGame.</p><h5 id="N100F2">Листинг 3. Пример PyGame-приложения (файл hwpg.py)</h5><div class="codesection"><pre class="displaycode">#!/usr/bin/python
# -*- coding: utf-8 -*-

import pygame, sys
from pygame.locals import *

pygame.init()
DISPLAYSURF = pygame.display.set_mode((400, 300))
pygame.display.set_caption( 'привет Вася!' )

while True: # main game loop
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    pygame.display.update()</pre></div><p>Здесь в очередной раз демонстрируется классическая схема GUI-приложения, так явно видно как 
поступившие события, в порядке очереди, обрабатываются в цикле. Запустим приложение в среде Python 2 
(автор нигде не встречал упоминаний о использовании Pygame с Python 3). Результат должен выглядеть как на 
рисунке 3 (здесь не делается ничего сверх создания окна и присвоения ему заголовка).</p><img alt="Рисунок 3. Пример PyGame-приложения." src="fig_03.jpg"/><p>В листинге 4 показан пример рисования в поле окна, также рисовать можно не только в самом окне, но и в 
разнообразных оконных фреймах.</p><h5 id="N1010B">Листинг 4. Пример PyGame-приложения (файл drawing.py)</h5><div class="codesection"><pre class="displaycode">import pygame, sys
from pygame.locals import *

pygame.init()

DISPLAYSURF = pygame.display.set_mode((400, 300), 0, 32)   <strong># настройка окна</strong>
pygame.display.set_caption('Drawing')

BLACK = (  0,   0,   0)    <strong># определение цветов</strong>
WHITE = (255, 255, 255)
RED   = (255,   0,   0)
GREEN = (  0, 255,   0)
BLUE  = (  0,   0, 255)

DISPLAYSURF.fill(WHITE)   <strong> # рисование</strong>
pygame.draw.polygon(DISPLAYSURF, GREEN, ((146, 0), (291, 106), (236, 277),
                                         (56, 277), (0, 106)))
pygame.draw.line(DISPLAYSURF, BLUE, (60, 60), (120, 60), 4)
pygame.draw.line(DISPLAYSURF, BLUE, (120, 60), (60, 120))
pygame.draw.line(DISPLAYSURF, BLUE, (60, 120), (120, 120), 4)
pygame.draw.circle(DISPLAYSURF, BLUE, (300, 50), 20, 0)
pygame.draw.ellipse(DISPLAYSURF, RED, (300, 200, 40, 80), 1)
pygame.draw.rect(DISPLAYSURF, RED, (200, 150, 100, 50))

pixObj = pygame.PixelArray(DISPLAYSURF)
pixObj[380][280] = BLACK
pixObj[382][282] = BLACK
pixObj[384][284] = BLACK
pixObj[386][286] = BLACK
pixObj[388][288] = BLACK
del pixObj

while True:      <strong># основной цикл обработки событий</strong>
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    pygame.display.update()</pre></div><p>На рисунке 4 показан результат запуска приложения:</p><img alt="Рисунок 4. Пример PyGame-приложения для рисования 2D-графики." src="fig_04.jpg"/><p>Также PyGame обладает ограниченной функциональностью для работы с некоторыми распространёнными 
аудио-форматами (запуск, остановка, фоновое воспроизведение). Например, вот как можно воспроизвести 
.wav-файл:</p><div class="codesection"><pre class="displaycode">import sys
import pygame
import time

file = ( lambda : ( len( sys.argv ) &gt; 1 and str( sys.argv[ 1 ] ) ) or 'badswap.wav' )()
pygame.init()
soundObj = pygame.mixer.Sound( file )
soundObj.play()
time.sleep( 1 )   <strong># проигрывать звуковой файл в течение 1 секунды.</strong>
soundObj.stop()</pre></div><p>В простых сценариях подобная функциональность может оказаться востребованной. Но в более сложных 
случаях для подобных задач стоит использовать специализированные свободные проекты, например, SoX, 
Ogg, Vorbis, Speex, FLAC и их кодеки.</p><p class="ibm-alternate-rule"><hr/></p><p class="ibm-ind-link ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">В начало</a></p><h2 id="N10131">Автоматизация GUI-приложений с помощью PyZenity</h2><p>Иногда приложению требуется простейший GUI-интерфейс, например, набор некоторых диалоговых окон, 
в которых запрашивается имя пользователя и пароль или выбирается имя файла. В подобных сценариях 
возможности описанных ранее библиотек являются избыточными. Но специально для задач подобного рода 
существует консольная утилита Zenity, предназначенная для формирования GUI-интерфейсов из языка 
командного интерпретатора. Конечно же, к ней существует интерфейс из Python, реализуемый в проекте 
PyZenity.</p><p>Архив с модулем PyZenity необходимо скачать с сайта автора этого модуля (см. раздел "Ресурсы") и 
установить в библиотеку в Python 2:</p><div class="codesection"><pre class="displaycode"><strong>$ tar -xzvf PyZenity-0.1.7.tar.gz</strong>
PyZenity-0.1.7/
PyZenity-0.1.7/PyZenity.py
PyZenity-0.1.7/PKG-INFO
PyZenity-0.1.7/setup.py
<strong>$ cd PyZenity-0.1.7
# sudo python setup.py install</strong>
running install
running build
running build_py
running install_lib
copying build/lib.linux-i686-2.7/PyZenity.py -&gt; /usr/local/lib/python2.7/dist-packages
byte-compiling /usr/local/lib/python2.7/dist-packages/PyZenity.py to PyZenity.pyc
running install_egg_info
Writing /usr/local/lib/python2.7/dist-packages/PyZenity-0.1.7.egg-info</pre></div><p>Этот же архив можно использовать и для Python 3:</p><div class="codesection"><pre class="displaycode"><strong># sudo python3 setup.py install</strong>
...</pre></div><p>После установки мы сможем создать простейшее приложение (см. файл <strong>enter.py</strong> в 
архиве <strong>python_gui.tgz</strong>):</p><div class="codesection"><pre class="displaycode">import PyZenity
a = PyZenity.GetText( text="Enter the string : ", entry_text="", password=False )
print( a )</pre></div><p>И запустить его:</p><div class="codesection"><pre class="displaycode"><strong>$ python enter.py</strong>
...
map</pre></div><p>В результате получив такое окно:</p><img alt="Рисунок 5. Пример PyZenity-приложения." src="fig_05.jpg"/><p>Также можно подготовить сценарий для выбора одного значения из списка возможных (см. файл 
<strong>select.py</strong> в архиве <strong>python_gui.tgz</strong>).</p><div class="codesection"><pre class="displaycode">import PyZenity

x = PyZenity.List( ["choices","test1","test2"], title="selection", boolstyle="checklist",
                   editable=False, select_col="ALL", sep='|',
                   data=[["","hello","hi"],["","1","2"]])
print( x )</pre></div><p>Результат запуска этого приложения показан на рисунке 6:</p><div class="codesection"><pre class="displaycode"><strong>$  python select.py</strong>
...
['1', '2']</pre></div><img alt="Рисунок 6. Пример PyZenity-приложения." src="fig_06.jpg"/><p class="ibm-alternate-rule"><hr/></p><p class="ibm-ind-link ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">В начало</a></p><h2 id="N10184">Заключение</h2><p>В этой и предыдущей статьях был представлен обзор некоторых инструментов для Python, которые можно 
использовать для создания графических приложений. Также были сформулировали и показаны на примерах 
общие принципы построения GUI-приложений (схема событийно управляемых приложений), которые постоянны и 
независят от библиотеки, выбранной для отображения виджетов.</p><p>На практике были рассмотрены примеры кода, использующие различные технологии для создания 
GUI-интерфейсов к приложениям на языке Python. Надо понимать, что показанные в обзоре инструменты — это 
далеко не все возможности, доступные в Python для создания GUI-приложений. Существует ещё ряд 
независимых проектов, которые не упоминались в этих двух статьях.</p><p>Но независимо от используемого инструмента, логика и структура таких приложений будут строиться вокруг 
обработки событий пользовательского интерфейса. А различные инструменты будут обладать специфическими 
возможностями, например поддержкой 2D и 3D-графики, анимации или мультимедиа форматов, которые и 
помогут выбрать инструмент, подходящий для решения конкретной задачи.</p>
<p class="ibm-alternate-rule"><hr/></p><p class="ibm-ind-link ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">В начало</a></p><h2 id="download">Загрузка</h2>

</div>
</div></body></html>