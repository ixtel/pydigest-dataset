<html><body><div><div class="post-text" itemprop="text">

<p>I have a site that has PKI security enabled.  Each client used either a card reader to load their certificate, or the certificate is installed in the IE certificate storage on their box.  </p>

<p>So my question are:</p>

<ol>
<li>How can I use either the card reader certificate or the certificate stored on the system to verify the system?</li>
<li>How do I pass the credentials onto the site to say, hey I'm me and I can access the service?  They example can be using soft certificates.  I can figure out the card reader part later.</li>
</ol>

<p>I've been searching around, and I haven't come up with anything to help me in this situation.  Django has a bunch of modules, but this isn't an option because I'm only concerned of the client side of things.  I'm not creating a site to host the service.  I need to just access these services.</p>

<p>I have this code working sort of.  I just do not know how to handle the redirect I am getting:</p>

<pre><code>import httplib
KEYFILE = r"C:\cert\my.key"
CERTFILE = r"c:\cert\my.pem"
HOSTNAME = 'machine.com'

conn = httplib.HTTPSConnection(
    HOSTNAME,
    key_file = KEYFILE,
    cert_file = CERTFILE
)

conn.putrequest('GET', '/arcgis/sharing/rest?f=json')
conn.endheaders()
response = conn.getresponse()
print response.read()
</code></pre>

<p>The result of all of this is:</p>

<pre><code>&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;302 Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Found&lt;/h1&gt;
&lt;p&gt;The document has moved &lt;a href="https://machine.com/pki?https://machine.com/arcgis/sharing/rest%3f&amp;amp;f=json"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>

<p>Any help provided would be great!</p>

<p>Software specs: python 2.7.8, Windows 2012 R2</p>
    </div>
    </div></body></html>