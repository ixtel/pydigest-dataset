<html><body><div><div class="entry-inner"> <p> <br/>  <ins class="adsbygoogle" data-ad-client="ca-pub-9884802040061842" data-ad-slot="1461280014" data-ad-format="auto"/> <br/></p><p>Hi all,</p><p>Itâ€™s been a while since I posted a new article. This is because I have ventured into the exciting field of Machine Learning and have been doing some competitions on <a title="Kaggle" href="http://kaggle.com" target="_blank">Kaggle</a>.</p><p>In this quick post I just wanted to share some Python code which can be used to benchmark, test, and develop Machine Learning algorithms with any size of data.</p><p>In other words: this dataset generation can be used to do emperical measurements of Machine Learning algorithms.</p><p>The code has been commented and I will include a <a title="Theano Deep Learning Library for Python" href="https://github.com/Theano/Theano">Theano</a> version and a numpy-only version of the code.</p> <p> <br/>  <ins class="adsbygoogle" data-ad-client="ca-pub-9884802040061842" data-ad-slot="2966536015" data-ad-format="auto"/> <br/></p><h3>Numpy dataset generator</h3><pre class="brush:python">def load_testing(size=5, length=10000, classes=3):
    # Super-duper important: set a seed so you always have the same data over multiple runs.
    np.random.seed(123)
    
    # Generate random data between 0 and 1 as a numpy array.
    # The size determines the amount of input values.
    x=[]
    for i in range (0, length):
        x.append(np.asarray(np.random.uniform(low=0, high=1, size=size), dtype='float64'))
    
    # Split up the input array into training/test/validation sets.
    train_set_x = x[:int(len(x)*0.6)]
    test_set_x = x[int(len(x)*0.6):int(len(x)*0.8)]
    valid_set_x = x[int(len(x)*0.8):]      
        
    # For each input in x, we will generate a class for y.
    # If classes is set to less than or equal to 1, it will output real numbers
    # for regression.
    y=[]
    for row in x:
        row_tmp = list()
        for i in range(0, len(row)):
            row_tmp.append(row[i] * 2. - 1)
            row_tmp[i] = (np.tanh(row_tmp[i])) * (i+1)
            
        output = np.sin(np.mean(row_tmp))
        
        # If classes &gt; 1 we will output classes, else we output real numbers.
        if (classes &gt; 1):
            classnum = 0
            
            # Generate class limits depending on the amount of classes you want.
            classranges = np.arange(-1,1,(2./float(classes)))[::-1]
            for i in classranges:
                if (output &gt;= i):
                    y.append(classnum)
                    break
                classnum = classnum + 1
        else:
            y.append(output)
        
    # Convert Y to a numpy array and split it up into train/test/validation sets.
    y = np.asarray(y)    
    train_set_y = y[:int(len(x)*0.6)]
    test_set_y = y[int(len(x)*0.6):int(len(x)*0.8)]
    valid_set_y = y[int(len(x)*0.8):]  
    
    # Return the dataset in pairs of x,y for train/test/validation sets.
    rval = [(train_set_x, train_set_y), (valid_set_x, valid_set_y),
            (test_set_x, test_set_y)]
    return rval

</pre><h3>Theano dataset generator</h3><pre class="brush:python">import numpy as np
import theano
import theano.tensor as T
 
def load_testing(size=5, length=10000, classes=3):
    # Super-duper important: set a seed so you always have the same data over multiple runs.
    np.random.seed(123)
    
    # Generate random data between 0 and 1 as a numpy array.
    # The size determines the amount of input values.
    x=[]
    for i in range (0, length):
        x.append(np.asarray(np.random.uniform(low=0, high=1, size=size), dtype='float64'))
    
    # Split up the input array into training/test/validation sets.
    train_set_x = x[:int(len(x)*0.6)]
    test_set_x = x[int(len(x)*0.6):int(len(x)*0.8)]
    valid_set_x = x[int(len(x)*0.8):]      
        
    # For each input in x, we will generate a class for y.
    # If classes is set to less than or equal to 1, it will output real numbers
    # for regression.
    y=[]
    for row in x:
        row_tmp = list()
        for i in range(0, len(row)):
            # Normalize from -1 to 1 and take the hyperbolic tangent of the separate values.
            # Note: we do "* (i+1)" on each value to give a different importance to the input variables.
            row_tmp.append(row[i] * 2. - 1)
            row_tmp[i] = (np.tanh(row_tmp[i])) * (i+1)
            
        output = np.sin(np.mean(row_tmp))
        
        # If classes &gt; 1 we will output classes, else we output real numbers.
        if (classes &gt; 1):
            classnum = 0
            
            # Generate class limits depending on the amount of classes you want.
            classranges = np.arange(-1,1,(2./float(classes)))[::-1]
            for i in classranges:
                if (output &gt;= i):
                    y.append(classnum)
                    break
                classnum = classnum + 1
        else:
            y.append(output)
        
    # Convert Y to a numpy array and split it up into train/test/validation sets.
    y = np.asarray(y)    
    train_set_y = y[:int(len(x)*0.6)]
    test_set_y = y[int(len(x)*0.6):int(len(x)*0.8)]
    valid_set_y = y[int(len(x)*0.8):]  
    
    def shared_dataset(data_xy, borrow=True):
        #Create a shared dataset. This is only if you are using Theano
        data_x, data_y = data_xy
        shared_x = theano.shared(np.asarray(data_x,
                                               dtype=theano.config.floatX),
                                 borrow=borrow)
        shared_y = theano.shared(np.asarray(data_y,
                                               dtype=theano.config.floatX),
                                 borrow=borrow)

        return shared_x, T.cast(shared_y, 'int32')
        
    if (use_theano):
        # Convert the numpy arrays into theano datasets, IF using theano.
        train_set_x, train_set_y = shared_dataset((train_set_x, train_set_y))
        test_set_x, test_set_y = shared_dataset((test_set_x, test_set_y))
        valid_set_x, valid_set_y = shared_dataset((valid_set_x, valid_set_y))
    
    # Return the dataset in pairs of x,y for train/test/validation sets.
    rval = [(train_set_x, train_set_y), (valid_set_x, valid_set_y),
            (test_set_x, test_set_y)]
    return rval</pre><p>Have fun with these snippets!</p><p/><div class="ssba ssba-wrap"><div><span>Share the knowledge!</span><a class="ssba_facebook_share" href="http://www.facebook.com/sharer.php?u=http://creative-punch.net/2014/08/artificial-dataset-machine-learning-python/" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/facebook.png" title="Facebook" class="ssba ssba-img" alt="Share on Facebook"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/facebook.png" title="Facebook" class="ssba ssba-img" alt="Share on Facebook"/></noscript></a><span class="ssba_sharecount">42</span><a class="ssba_twitter_share" href="http://twitter.com/share?url=http://creative-punch.net/2014/08/artificial-dataset-machine-learning-python/&amp;text=Artificial+Dataset+Generation+for+Machine+Learning+with+Python+and+Numpy+%2F+Theano+by+%40creative_punch" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/twitter.png" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/twitter.png" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter"/></noscript></a><span class="ssba_sharecount">0</span><a class="ssba_google_share" href="https://plus.google.com/share?url=http://creative-punch.net/2014/08/artificial-dataset-machine-learning-python/" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/google.png" title="Google+" class="ssba ssba-img" alt="Share on Google+"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/google.png" title="Google+" class="ssba ssba-img" alt="Share on Google+"/></noscript></a><span class="ssba_sharecount">45</span><a class="ssba_stumbleupon_share ssba_share_link" href="http://www.stumbleupon.com/submit?url=http://creative-punch.net/2014/08/artificial-dataset-machine-learning-python/&amp;title=Artificial Dataset Generation for Machine Learning with Python and Numpy / Theano" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/stumbleupon.png" title="StumbleUpon" class="ssba ssba-img" alt="Share on StumbleUpon"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/stumbleupon.png" title="StumbleUpon" class="ssba ssba-img" alt="Share on StumbleUpon"/></noscript></a><span class="ssba_sharecount">203</span><a class="ssba_reddit_share" href="http://reddit.com/submit?url=http://creative-punch.net/2014/08/artificial-dataset-machine-learning-python/&amp;title=Artificial Dataset Generation for Machine Learning with Python and Numpy / Theano" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/reddit.png" title="Reddit" class="ssba ssba-img" alt="Share on Reddit"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/reddit.png" title="Reddit" class="ssba ssba-img" alt="Share on Reddit"/></noscript></a><span class="ssba_sharecount">5</span><a class="ssba_linkedin_share ssba_share_link" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://creative-punch.net/2014/08/artificial-dataset-machine-learning-python/" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/linkedin.png" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/linkedin.png" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn"/></noscript></a><span class="ssba_sharecount">0</span><a class="ssba_tumblr_share" href="http://www.tumblr.com/share/link?url=creative-punch.net/2014/08/artificial-dataset-machine-learning-python/&amp;name=Artificial Dataset Generation for Machine Learning with Python and Numpy / Theano" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/tumblr.png" title="tumblr" class="ssba ssba-img" alt="Share on Tumblr"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/tumblr.png" title="tumblr" class="ssba ssba-img" alt="Share on Tumblr"/></noscript></a><a class="ssba_buffer_share" href="https://bufferapp.com/add?url=http://creative-punch.net/2014/08/artificial-dataset-machine-learning-python/&amp;text= Artificial Dataset Generation for Machine Learning with Python and Numpy / Theano" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/buffer.png" title="Buffer" class="ssba ssba-img" alt="Buffer this page"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/buffer.png" title="Buffer" class="ssba ssba-img" alt="Buffer this page"/></noscript></a><a class="ssba_diggit_share ssba_share_link" href="http://www.digg.com/submit?url=http://creative-punch.net/2014/08/artificial-dataset-machine-learning-python/" target="_blank"><img src="http://creative-punch.net/wp-content/plugins/speed-booster-pack/inc/images/1x1.trans.gif" data-lazy-src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/diggit.png" title="Digg" class="ssba ssba-img" alt="Digg this"/><noscript><img src="http://creative-punch.net/wp-content/plugins/simple-share-buttons-adder/buttons/simple/diggit.png" title="Digg" class="ssba ssba-img" alt="Digg this"/></noscript></a></div></div></div></div></body></html>