<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-django-python3-ldap" class="anchor" href="#django-python3-ldap" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>django-python3-ldap</h1>
<p><strong>django-python3-ldap</strong> provides a Django LDAP user authentication backend for Python 3.</p>
<a name="user-content-features"/>
<h2><a id="user-content-features" class="anchor" href="#features" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Features</h2>
<ul>
<li>Authenticate users with an LDAP server.</li>
<li>Sync LDAP users with a local Django database.</li>
<li>Supports custom Django user models.</li>
<li>Works in Python 3!</li>
</ul>
<a name="user-content-installation"/>
<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>
<ol>
<li>Install using <code>pip install django-python3-ldap</code>.</li>
<li>Add <code>'django_python3_ldap'</code> to your <code>INSTALLED_APPS</code> setting.</li>
<li>Set your <code>AUTHENTICATION_BACKENDS</code> setting to <code>("django_python3_ldap.auth.LDAPBackend",)</code></li>
<li>Configure the settings for your LDAP server (see Available settings, below).</li>
<li>Optionally, run <code>./manage.py ldap_sync_users</code> to perform an initial sync of LDAP users.</li>
<li>Optionally, run <code>./manage.py ldap_promote &lt;username&gt;</code> to grant superuser admin access to a given user.</li>
</ol>
<a name="user-content-available-settings"/>
<h2><a id="user-content-available-settings" class="anchor" href="#available-settings" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Available settings</h2>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># The URL of the LDAP server.</span>
<span class="pl-c1">LDAP_AUTH_URL</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ldap://localhost:389<span class="pl-pds">"</span></span>

<span class="pl-c"># Initiate TLS on connection.</span>
<span class="pl-c1">LDAP_AUTH_USE_TLS</span> <span class="pl-k">=</span> <span class="pl-c1">False</span>

<span class="pl-c"># The LDAP search base for looking up users.</span>
<span class="pl-c1">LDAP_AUTH_SEARCH_BASE</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ou=people,dc=example,dc=com<span class="pl-pds">"</span></span>

<span class="pl-c"># The LDAP class that represents a user.</span>
<span class="pl-c1">LDAP_AUTH_OBJECT_CLASS</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>inetOrgPerson<span class="pl-pds">"</span></span>

<span class="pl-c"># User model fields mapped to the LDAP</span>
<span class="pl-c"># attributes that represent them.</span>
<span class="pl-c1">LDAP_AUTH_USER_FIELDS</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">"</span>username<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>first_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>givenName<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>last_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>sn<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>email<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>mail<span class="pl-pds">"</span></span>,
}

<span class="pl-c"># A tuple of django model fields used to uniquely identify a user.</span>
<span class="pl-c1">LDAP_AUTH_USER_LOOKUP_FIELDS</span> <span class="pl-k">=</span> (<span class="pl-s"><span class="pl-pds">"</span>username<span class="pl-pds">"</span></span>,)

<span class="pl-c"># Path to a callable that takes a dict of {model_field_name: value},</span>
<span class="pl-c"># returning a dict of clean model data.</span>
<span class="pl-c"># Use this to customize how data loaded from LDAP is saved to the User model.</span>
<span class="pl-c1">LDAP_AUTH_CLEAN_USER_DATA</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>django_python3_ldap.utils.clean_user_data<span class="pl-pds">"</span></span>

<span class="pl-c"># Path to a callable that takes a user model and a dict of {ldap_field_name: [value]},</span>
<span class="pl-c"># and saves any additional user relationships based on the LDAP data.</span>
<span class="pl-c"># Use this to customize how data loaded from LDAP is saved to User model relations.</span>
<span class="pl-c"># For customizing non-related User model fields, use LDAP_AUTH_CLEAN_USER_DATA.</span>
<span class="pl-c1">LDAP_AUTH_SYNC_USER_RELATIONS</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>django_python3_ldap.utils.sync_user_relations<span class="pl-pds">"</span></span>

<span class="pl-c"># Path to a callable that takes a dict of {ldap_field_name: value},</span>
<span class="pl-c"># returning a list of [ldap_search_filter]. The search filters will then be AND'd</span>
<span class="pl-c"># together when creating the final search filter.</span>
<span class="pl-c1">LDAP_AUTH_FORMAT_SEARCH_FILTERS</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>django_python3_ldap.utils.format_search_filters<span class="pl-pds">"</span></span>

<span class="pl-c"># Path to a callable that takes a dict of {model_field_name: value}, and returns</span>
<span class="pl-c"># a string of the username to bind to the LDAP server.</span>
<span class="pl-c"># Use this to support different types of LDAP server.</span>
<span class="pl-c1">LDAP_AUTH_FORMAT_USERNAME</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>django_python3_ldap.utils.format_username_openldap<span class="pl-pds">"</span></span>

<span class="pl-c"># Sets the login domain for Active Directory users.</span>
<span class="pl-c1">LDAP_AUTH_ACTIVE_DIRECTORY_DOMAIN</span> <span class="pl-k">=</span> <span class="pl-c1">None</span>

<span class="pl-c"># The LDAP username and password of a user for authenticating the `ldap_sync_users`</span>
<span class="pl-c"># management command. Set to None if you allow anonymous queries.</span>
<span class="pl-c1">LDAP_AUTH_CONNECTION_USERNAME</span> <span class="pl-k">=</span> <span class="pl-c1">None</span>
<span class="pl-c1">LDAP_AUTH_CONNECTION_PASSWORD</span> <span class="pl-k">=</span> <span class="pl-c1">None</span></pre></div>
<a name="user-content-microsoft-active-directory-support"/>
<h2><a id="user-content-microsoft-active-directory-support" class="anchor" href="#microsoft-active-directory-support" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Microsoft Active Directory support</h2>
<p>django-python3-ldap is configured by default to support login via OpenLDAP. To connect to
a Microsoft Active Directory, add the following line to your settings file.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c1">LDAP_AUTH_FORMAT_USERNAME</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>django_python3_ldap.utils.format_username_active_directory<span class="pl-pds">"</span></span></pre></div>
<p>If your Active Directory server requires a domain to be supplied with the username,
then also specify:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c1">LDAP_AUTH_ACTIVE_DIRECTORY_DOMAIN</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>your_domain<span class="pl-pds">"</span></span></pre></div>
<a name="user-content-custom-user-filters"/>
<h2><a id="user-content-custom-user-filters" class="anchor" href="#custom-user-filters" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Custom user filters</h2>
<p>By default, any users within <code>LDAP_AUTH_SEARCH_BASE</code> and of the correct <code>LDAP_AUTH_OBJECT_CLASS</code>
will be considered a valid user. You can apply further filtering by setting a custom <code>LDAP_AUTH_FORMAT_SEARCH_FILTERS</code>
callable.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># settings.py</span>
<span class="pl-c1">LDAP_AUTH_FORMAT_SEARCH_FILTERS</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>path.to.your.custom_format_search_filters<span class="pl-pds">"</span></span>

<span class="pl-c"># pay/to/your.py</span>
<span class="pl-k">from</span> django_python3_ldap.utils <span class="pl-k">import</span> format_search_filters

<span class="pl-k">def</span> <span class="pl-en">custom_format_search_filters</span>(<span class="pl-smi">ldap_fields</span>):
    <span class="pl-c"># Add in simple filters.</span>
    ldap_fields[<span class="pl-s"><span class="pl-pds">"</span>memberOf<span class="pl-pds">"</span></span>] <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>
    <span class="pl-c"># Call the base format callable.</span>
    search_filters <span class="pl-k">=</span> format_search_filters(ldap_fields)
    <span class="pl-c"># Advanced: apply custom LDAP filter logic.</span>
    search_filters.append(<span class="pl-s"><span class="pl-pds">"</span>(|(memberOf=groupA)(memberOf=GroupB))<span class="pl-pds">"</span></span>)
    <span class="pl-c"># All done!</span>
    <span class="pl-k">return</span> search_filters</pre></div>
<p>The returned list of search filters will be AND'd together to make the final search filter.</p>
<a name="user-content-how-it-works"/>
<h2><a id="user-content-how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How it works</h2>
<p>When a user attempts to authenticate, a connection is made to the LDAP
server, and the application attempts to bind using the provided username and password.</p>
<p>If the bind attempt is successful, the user details are loaded from the LDAP server
and saved in a local Django <code>User</code> model. The local model is only created once,
and the details will be kept updated with the LDAP record details on every login.</p>
<p>To perform a full sync of all LDAP users to the local database, run <code>./manage.py ldap_sync_users</code>.
This is not required, as the authentication backend will create users on demand. Syncing users has
the advantage of allowing you to assign permissions and groups to the existing users using the Django
admin interface.</p>
<p>Running <code>ldap_sync_users</code> as a background cron task is another optional way to
keep all users in sync on a regular basis.</p>
<a name="user-content-support-and-announcements"/>
<h2><a id="user-content-support-and-announcements" class="anchor" href="#support-and-announcements" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Support and announcements</h2>
<p>Downloads and bug tracking can be found at the <a href="http://github.com/etianen/django-python3-ldap">main project
website</a>.</p>
<a name="user-content-more-information"/>
<h2><a id="user-content-more-information" class="anchor" href="#more-information" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>More information</h2>
<p>The django-python3-ldap project was developed by Dave Hall. You can get the code
from the <a href="http://github.com/etianen/django-python3-ldap">django-python3-ldap project site</a>.</p>
<p>Dave Hall is a freelance web developer, based in Cambridge, UK. You can usually
find him on the Internet in a number of different places:</p>


</article>
  </div></body></html>