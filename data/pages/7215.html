<html><body><div><div class="post-text" itemprop="text">

<p>I am very new to python, so please be gentle. </p>

<p>I have a .csv file, reported to me in this format, so I cannot do much about it:</p>

<pre><code>ClientAccountID   AccountAlias   CurrencyPrimary    FromDate
         SomeID      SomeAlias          SomeCurr    SomeDate
        OtherID     OtherAlias         OtherCurr   OtherDate
ClientAccountID   AccountAlias   CurrencyPrimary    AssetClass
         SomeID      SomeAlias          SomeCurr     SomeClass
        OtherID     OtherAlias         OtherCurr     OtherDate
      AnotherID   AnotherAlias       AnotherCurr   AnotherDate
</code></pre>

<p>I am using the csv package in python, so i have:</p>

<pre><code>with open(theFile, 'rb') as csvfile:
    theReader = csv.DictReader(csvfile, delimiter = ',')
</code></pre>

<p>Which, as I understand it, creates the dictionary 'theReader'. How do I subset this dictionary, into several dictionaries, splitting them by the header rows in the original csv file? Is there a simple, elegant, non-loop way to create a list of dictionaries (or even a dictionary of dictionaries, with account IDs as keys)?  Does that make sense?</p>

<p>Oh. Please note the header rows are not equivalent, but the header rows will always begin with 'ClientAccountID'.</p>

<p>Thanks to @ codie, I am now using the following to split the csv into several dicts, based on using the '\t' delimiter. </p>

<pre><code>with open(theFile, 'rb') as csvfile:
    theReader = csv.DictReader(csvfile, delimiter = '\t')
</code></pre>

<p>However, I now get the entire header row as a key, and each other row as a value. How do I further split this up?</p>

<p>Thanks to @Benjamin Hodgson below, I have the following:</p>

<pre><code>from csv import DictReader
from io import BytesIO

stringios = []

with open('file.csv', 'r') as f:
    stringio = None
    for line in f:
        if line.startswith('ClientAccountID'):
            if stringio is not None:
                stringios.append(stringio)
            stringio = BytesIO()
        stringio.write(line)
        stringio.write("\n")
    stringios.append(stringio)

data = [list(DictReader(x.getvalue(), delimiter=',')) for x in stringios]
</code></pre>

<p>If I print the first item in stringios, I get what I would expect. It looks like a single csv. However, if I print the first item in data, using below, i get something odd:</p>

<pre><code>for row in data[0]:
    print row
</code></pre>

<p>It returns:</p>

<pre><code>{'C':'U'}
{'C':'S'}
{'C':'D'}
...
</code></pre>

<p>So it appears it is splitting every character, instead of using the comma delimiter.</p>
    </div>
    </div></body></html>