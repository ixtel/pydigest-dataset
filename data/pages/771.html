<html><body><div><div class="entry-content">
		<p>In this post I’ll discuss building a Windows executable from a Python script for 32-bit and 64-bit Windows. Producing a 64-bit executable on a 64-bit machine in Windows is easy using <a href="http://www.pyinstaller.org/">PyInstaller</a>, but producing a 32-bit executable on a 64-bit machine takes some tinkering. I ended up setting up a <a href="https://help.ubuntu.com/community/BasicChroot">chroot</a> environment on <a href="http://www.ubuntu.com/">Ubuntu</a> for this task.</p>
<p><span id="more-491"/></p>
<h1>64-bit Executable on 64-bit Host</h1>
<p>This is relatively easy. You download and install PyInstaller, and for a windowed GUI application you run</p>
<pre class="brush: bash; title: ; notranslate" title="">
pyinstaller -F -w --name=executable gui_script.py
</pre>
<p>And for a regular script you run,</p>
<pre class="brush: bash; title: ; notranslate" title="">
pyinstaller -F --name=executable script.py
</pre>
<h1>32-bit Executable on 64-bit Host</h1>
<p>First, you need to have PyInstaller downloaded and unzipped somewhere, like your <code>Downloads</code> folder. Next, you need to produce an <em>almost</em> virtual environment on your linux machine. This will be a minimal installation that is separated from the rest of your system. This can be used for developing applications, or for trying out untrusted software. I used <a href="https://help.ubuntu.com/community/DebootstrapChroot">this</a> resource for the next few steps. First, install some stuff.</p>
<pre class="brush: bash; title: ; notranslate" title="">
sudo apt-get install debootstrap
sudo apt-get install schroot
</pre>
<p>Next create a configuration file for <code>schroot</code> at <code>/etc/schroot/chroot.d/precise_i386.conf</code></p>
<pre class="brush: plain; title: ; notranslate" title="">
[precise_i386]
description=Ubuntu 10.04 Precise for i386
location=/srv/chroot/precise_i386
personality=linux32
root-users=bob
run-setup-scripts=true
run-exec-scripts=true
type=directory
users=alice,bob
</pre>
<p>Then make a directory for <code>chroot</code>, and run <code>debootstrap</code>,</p>
<pre class="brush: bash; title: ; notranslate" title="">
sudo mkdir -p /srv/chroot/precise_i386
sudo debootstrap --variant=buildd --arch=i386 precise /srv/chroot/precise_i386 http://archive.ubuntu.com/ubuntu/
</pre>
<p>Now you can enter this alternate linuxverse as root by running,</p>
<pre class="brush: bash; title: ; notranslate" title="">
schroot -c precise_i386 -u root
</pre>
<p>Or you can enter it as a normal user by leaving off the <code>-u root</code>, which we will do later. When I ran this, I got a handful of warnings about blah blah blah, but everything worked out in the end. Next I used <a href="https://help.ubuntu.com/community/BasicChroot">this</a> resource for these commands that seemed to help.</p>
<pre class="brush: bash; title: ; notranslate" title="">
sudo mount -o bind /proc /srv/chroot/precise_i386/proc
sudo cp /etc/resolv.conf /srv/chroot/precise_i386/etc/resolv.conf
</pre>
<p>Finally, we should have a working little <code>chroot</code> thingy. We can log in as root,</p>
<pre class="brush: bash; title: ; notranslate" title="">
schroot -c precise_i386 -u root
</pre>
<p>To make sure you did everything right, you can do a sanity-check to see if you’re really using 32-bit tools. Call Python from the command line and type the following,</p>
<pre class="brush: python; title: ; notranslate" title="">
import ss
sys.maxsize &gt; 2**32
</pre>
<p>You should get <strong><code>False</code></strong> if the Python interpreter is 32-bit. Now <code>Ctrl-Z</code> to get out of the Python interpreter and install <code>python-dev</code> and <code>setuptools</code> to get PyInstaller working,</p>
<pre class="brush: bash; title: ; notranslate" title="">
apt-get install curl
apt-get install python-dev
curl https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py -o - | python
</pre>
<p>Now close out of that terminal session and log back into <code>chroot</code> as a regular user, not as root as we have been previously,</p>
<pre class="brush: python; title: ; notranslate" title="">
schroot -c precise_i386
</pre>
<p>Now we can run PyInstaller for a GUI application as we did in 64-bit land,</p>
<pre class="brush: bash; title: ; notranslate" title="">
pyinstaller -F -w --name=executable gui_script.py
</pre>
<p>Or for a console application</p>
<pre class="brush: bash; title: ; notranslate" title="">
pyinstaller -F --name=executable script.py
</pre>
<p>Now you can test your 32-bit executable out on your 64-bit machine. (J/k, if you could do that, you wouldn’t be here in the first place.)</p>
	</div>
	
	</div></body></html>