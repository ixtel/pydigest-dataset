<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-sentryturret" class="anchor" href="#sentryturret" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>SentryTurret</h1>

<p>This project licensed under GNU GENERAL PUBLIC LICENSE
<a href="https://www.gnu.org/licenses/gpl.txt">https://www.gnu.org/licenses/gpl.txt</a></p>

<p>Attach the Raspberry pi servo hat to the Raspberry pi, x-axis servo on 0 and y-axis servo on 3 </p>

<p>connect the relay board to gnd and vin and gpio 24</p>

<p><a href="https://camo.githubusercontent.com/f7cac74f838586de20ee1202f45cead9ff995a4a/687474703a2f2f692e696d6775722e636f6d2f4c5a6b59764e4a2e6a7067" target="_blank"><img src="https://camo.githubusercontent.com/f7cac74f838586de20ee1202f45cead9ff995a4a/687474703a2f2f692e696d6775722e636f6d2f4c5a6b59764e4a2e6a7067" alt="Raspberry pi and Relay" title="Connected" data-canonical-src="http://i.imgur.com/LZkYvNJ.jpg"/></a> 
<a href="https://camo.githubusercontent.com/cf41650d9250a428eb4655273629ce6149d0a26d/687474703a2f2f692e696d6775722e636f6d2f62344a5177595a2e6a7067" target="_blank"><img src="https://camo.githubusercontent.com/cf41650d9250a428eb4655273629ce6149d0a26d/687474703a2f2f692e696d6775722e636f6d2f62344a5177595a2e6a7067" alt="Side View" title="side view" data-canonical-src="http://i.imgur.com/b4JQwYZ.jpg"/></a></p>

<p>A sentry turret style robot which will detect motion, then track and fire at the object. The robot's "turret" is rotated by two servos (X/pan axis and Y/tilt axis). The "eye"(webcam) and "gun" of the robot should be mounted on the turret. </p>

<p><a href="https://camo.githubusercontent.com/035950a01a25c69760fea6a5417fcbc19e9bc329/687474703a2f2f692e696d6775722e636f6d2f584246525079562e6a7067" target="_blank"><img src="https://camo.githubusercontent.com/035950a01a25c69760fea6a5417fcbc19e9bc329/687474703a2f2f692e696d6775722e636f6d2f584246525079562e6a7067" alt="Raspberry pi Display" title="Display" data-canonical-src="http://i.imgur.com/XBFRPyV.jpg"/></a> </p>

<p>When activated, the robot will initialize an average image and wait to detect motion above a threshold size. It will target the mean HSV of a moving object and begin blob detection to center the camera's view (using turret servos) on the object. When the object is centered, it will fire by using a relay board.</p>

<p>See main.py for further comments.</p>

<p>To run with display: $python main.py 1</p>

<p>The program starts a thread for the turret which is continually updated with target coordinates by the OpenCV frame processing. A separate thread handles terminal keyboard input:</p>

<ul>
<li>q = quit</li>
<li>' ' = reset</li>
<li>1 = start motion detect</li>
<li>2 = sample center for target</li>
<li>f/v = +/- threshhold area</li>
<li>a,s,d/z,x,c = +/- H,S,V</li>
<li>p = toggle armed</li>
<li>l/m = +/- target sensitivity</li>
<li>f = fire</li>
</ul>

<hr/>

<p>To use manual control run go to the driver folder and run sudo python manual.py
before you run it make sure to install motion and configure it using motion.conf provided</p>

<p>sudo apt-get install motion</p>

<p>sudo nano /etc/default/motion   set start_motion_daemon=yes</p>

<p>then copy the motion.conf file to /etc/motion/motion.conf</p>

<p>motion will run on port 8081</p>

<p>Manual Control for Sentry Turret</p>

<p>' ' = reset</p>

<p>w = move up</p>

<p>a = move left</p>

<p>s = move down</p>

<p>d = move right</p>

<p>f = fire</p>

<p>x = trigger buzzers</p>

<p>b = fire left</p>

<p>n = fire right</p>

<p>p = Spray</p>

<p>Add a joystick or xbox contoller for added enjoyment use JoyToKey <a href="http://joytokey.net/en/">http://joytokey.net/en/</a> 
<a href="https://camo.githubusercontent.com/d754a4622b1f3516cb98997221dbd7641793f527/68747470733a2f2f73636f6e74656e742d6c67612e78782e666263646e2e6e65742f6870686f746f732d786670312f762f74312e302d392f31303535313131315f31303130323034303434393335393933395f313139333630363739333437383336383635355f6e2e6a70673f6f683d3461666239643265333836343566316564613535623166653935383461303030266f653d3535384141444531" target="_blank"><img src="https://camo.githubusercontent.com/d754a4622b1f3516cb98997221dbd7641793f527/68747470733a2f2f73636f6e74656e742d6c67612e78782e666263646e2e6e65742f6870686f746f732d786670312f762f74312e302d392f31303535313131315f31303130323034303434393335393933395f313139333630363739333437383336383635355f6e2e6a70673f6f683d3461666239643265333836343566316564613535623166653935383461303030266f653d3535384141444531" alt="image" data-canonical-src="https://scontent-lga.xx.fbcdn.net/hphotos-xfp1/v/t1.0-9/10551111_10102040449359939_1193606793478368655_n.jpg?oh=4afb9d2e38645f1eda55b1fe9584a000&amp;oe=558AADE1"/></a></p>

<p>The working example was built on RaspberryPi2 with Raspian and OpenCV(python) 2.4, using GPIO pins connected to a servo hat from adafruit. <a href="https://learn.adafruit.com/adafruit-16-channel-pwm-servo-hat-for-raspberry-pi/overview">https://learn.adafruit.com/adafruit-16-channel-pwm-servo-hat-for-raspberry-pi/overview</a> . The 5v relay board is the fire control system</p>
</article>
  </div></body></html>