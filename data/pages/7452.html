<html><body><div><div class="post-text" itemprop="text">
<p>This is how we do it in order to use custom authentication.</p>

<p>Custom handler in <strong>app.yaml</strong></p>

<pre><code>- url: /remoteapi.*
  script: remote_api.app
</code></pre>

<p>Custom wsgi app in <strong>remote_api.py</strong> to override <code>CheckIsAdmin</code></p>

<pre><code>from google.appengine.ext.remote_api import handler
from google.appengine.ext import webapp
import re

MY_SECRET_KEY = 'MAKE UP PASSWORD HERE'  # make one up, use the same one in the shell command
cookie_re = re.compile('^"?([^:]+):.*"?$')


class ApiCallHandler(handler.ApiCallHandler):
    def CheckIsAdmin(self):
        """Determine if admin access should be granted based on the
           auth cookie passed with the request."""
        login_cookie = self.request.cookies.get('dev_appserver_login', '')
        match = cookie_re.search(login_cookie)
        if (match and match.group(1) == MY_SECRET_KEY
            and 'X-appcfg-api-version' in self.request.headers):
            return True
        else:
            self.redirect('/_ah/login')
            return False


app = webapp.WSGIApplication([('.*', ApiCallHandler)])
</code></pre>

<p>From here we script the uploading of data that was exported from our live app. Use the same password that you made up in the python script above.</p>

<pre><code>echo "MAKE UP PASSWORD HERE" | appcfg.py upload_data --email=some@example.org --passin --url=http://localhost:8080/remoteapi --num_threads=4 --kind=WebHook --filename=webhook.data --db_filename=bulkloader-progress-webhook.sql3
</code></pre>

<p><code>WebHook</code> and <code>webhook.data</code> are specific to the <code>Kind</code> that we exported from production.</p>
    </div>
    </div></body></html>