<html><body><div><div class="post-text" itemprop="text">
<h1>explicit import machinery</h1>

<blockquote>
  <p>I don't like it if the order of imports is important, or if there is code between the import statements at the top of a file. I like cleaning up my code with automated tools and this can break stuff.</p>
</blockquote>

<p>If you want something to happen <strong>first</strong>, then execute it <strong>first</strong>. If you want to modify how <code>import</code> work, you would need to do it before <code>import</code> is called. If your problem is caused by your editor, then either change it, find how not to reorder the clauses, or put the code in a module whose name comes first, e.g. <code>import aaaaaa_logging_overrides</code>.</p>

<p>Say your code looks like the solution @zvone has; and your editor reorders the imports from:</p>

<pre><code>import siteconfiguration
siteconfiguration.configure_site()  # This must be done before any other import

import application
</code></pre>

<p>to </p>

<pre><code>import application
import siteconfiguration
siteconfiguration.configure_site()  # This must be done before any other import
</code></pre>

<p>I would probable change editors. This is very similar to having it screw up the code below, where it is obvious an editor should not reorder imports and put them before path manipulation:</p>

<pre><code>import sys
sys.path.append('/nfs/some/corp/dir')
import corp.module
</code></pre>

<h2>using sitecustomize</h2>

<p>Your python stuff is located under <code>sys.prefix</code>. There should be:</p>

<ul>
<li><code>lib/python-*/site.py</code></li>
<li><code>lib/python-*/site-packages</code></li>
<li><code>lib/python-*/sitecustomize.py</code> (optional, depends if your admin used one)</li>
</ul>

<p>e.g.</p>

<pre><code>(test)/tmp/test &gt; (4) cat lib/python2.7/sitecustomize.py
print 'imported sitecustomize'
(test)/tmp/test &gt; (4) cat foo.py 
print 'executing foo'
</code></pre>

<p>running the example:</p>

<pre><code>(test)/tmp/test &gt; (4) python foo.py 
imported sitecustomize
executing foo
</code></pre>

<p>As you said, this is black magic; as a user running a script may not expect some other random code (read: possibly not under their control, and not part of the standard distribution) to run and alter the behavior.</p>
    </div>
    </div></body></html>