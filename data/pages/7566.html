<html><body><div><div class="section">
              <h1>controlspeed 2.3</h1>

              


<p>Control function call speed ,support network mode by redis</p><p>








# ControlSpeed  </p><p>这项目是用来控制函数调用的频率, 不仅支持本地的同步线程模式, 而且支持分布式模式.   </p><p>[更多开发描述,请点击链接](http://xiaorui.cc)</p><p>ControlSpeed(本地版)还不兼容多进程多线程的场景, 当然你可以用ControlSpeedNetwork分布式版解决. 缺点是每次访问都会有一次网络io消耗.</p><p>#Usage:</p><p>装饰器使用方法</p><p>```</p><p>from controlspeed import ControlSpeed</p><p>@ControlSpeed(max_calls=10, period=1.0)</p><p>def do_something():</p><p>    pass</p><p>```</p><p>with关键词控制上下文</p><p>```</p><p>from controlspeed import ControlSpeed</p><p>rate = ControlSpeed(max_calls=10, period=1.0)</p><p>for i in range(100):</p><p>    with rate:</p><p>        do_something()</p><p>```</p><p>支持回调函数的控速</p><p>```</p><p>from controlspeed import ControlSpeed</p><p>import time</p><p>def limited(until):</p><p>    duration = int(round(until - time.time()))</p><p>    print 'Speed limited, sleeping for %d seconds' % duration</p><p>rate = ControlSpeed(max_calls=2, period=3, callback=limited)</p><p>for i in range(3):</p><p>    with rate:</p><p>        print i</p><p>```</p><p>在2.1加入了分布式限频, 借助于redis实现.</p><p>```</p><p>import redis</p><p>redis_conn = redis.StrictRedis()</p><p>key = 'xiaorui.cc'</p><p>@ControlSpeedNetwork(redis_conn, key, max_calls=10, period=3.0)</p><p>def do_something(args):</p><p>    print args</p><p>    time.sleep(0.1)</p><p>for i in xrange(20):</p><p>    do_something(i)</p><p>```

</p><a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>25</span> downloads in the last week
  </li>
  <li>
    <span>229</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>