<html><body><div><div class="blog-entry-content">
        <p>
    Every now and then, I see it come up that Python should have private or protected methods on its classes.  This typically comes from someone that is used to programming in Java or C++ or the like, who misses them and insists they are important for any programming language.  But python does not have them and never will.  Private methods are a solution to a problem that works in statically typed languages.  It is not the solution for a highly dynamic language like Python.
</p>

<p>
    <strong>tl;dr Python has a dynamic way of fixing this problem, just scroll down to the end to see the code.</strong>
</p>

<p>
    But let us look at the problem starting with an example class.  Lets do something non trivial, that might actually be used in the real world: a class that handles colour manipulation, maybe because I am building a <a href="http://colorpicker.net/">colour picker</a>, or doing some else cool with colours.  So my code might start out like this.
</p>

<table class="highlighttable"><tr><td class="linenos"/><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Colour</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""A colour wrangler class"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hexcode</span><span class="o">=</span><span class="s">"ff0000"</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hexcode</span> <span class="o">=</span> <span class="n">hexcode</span>
</pre></div>
</td></tr></table><p>
    I would then go add add a pile of other methods that will be needed, but let us focus on this.  The class has this <code>hexcode</code> attribute, that anyone can now access.  So I build the rest of my project around this, and access the <code>hexcode</code> in a lot of places in my code, and also others start doing it in theirs as well.
</p>

<p>
    But then I hit a problem, storing the colour as a hex string is both clumsy, since I have to keep getting out the RGB components any time I want to manipulate it, and also when trying to convert to other colour spaces and back I get rounding errors.  I now want to store it as three floats.  So I update my code.
</p>

<table class="highlighttable"><tr><td class="linenos"/><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Colour</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""A colour wrangler class"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hexcode</span><span class="o">=</span><span class="s">"ff0000"</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
</pre></div>
</td></tr></table><p>
    Now everyone else's code that depended on the <code>hexcode</code> attribute is broken.  At this point the the Java/C++ people would say I told you so, if only you had static methods, you could have had getter and setter methods, and kept the attribute private.  But that is never going to happen in Python.  Python is too dynamic to check this at compile time, and run time checking would be far to expensive.  But python does have an elegant solution to this.  It is the build in <code>property</code> function.  This is how I would now fix my code using it.
</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Colour</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""A colour wrangler class"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hexcode</span><span class="o">=</span><span class="s">"ff0000"</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hexcode</span> <span class="o">=</span> <span class="n">hexcode</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hexcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""Return the colour as a hex string"""</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">"{:02x}"</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span>
    
    <span class="nd">@hexcode.setter</span>
    <span class="k">def</span> <span class="nf">hexcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hexcode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
</pre></div>
</td></tr></table><p>
    I can now get and set the <code>hexcode</code> attribute as before, and it will all get transparently handled.  I have even used it as a setter in my <code>__init__</code> method, so I don't have to repeat the conversion.  
</p>

<p>
    Note that <code>@property</code> is put first, before the function that acts as the getter, and then <code>@hexcode.setter</code> not <code>@property.setter</code> is used to define the setter.  You can't change the order and expect it to still work. Also note that the two functions have the same name.  And the doc string from the getter will be given if you do <code>help(Colour.hexcode)</code>.
</p>

<p>
    There is also an alternative way of doing the same thing, this time not using <code>property</code> as a decorator.
</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Colour</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""A colour wrangler class"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hexcode</span><span class="o">=</span><span class="s">"ff0000"</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hexcode</span> <span class="o">=</span> <span class="n">hexcode</span>
    
    <span class="k">def</span> <span class="nf">gethexcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">"{:02x}"</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">sethexcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hexcode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
    
    <span class="n">hexcode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">gethexcode</span><span class="p">,</span> <span class="n">sethexcode</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">"Return the colour as a hex string"</span><span class="p">)</span>
</pre></div>
</td></tr></table><p>
    This gives the same result, except it also exposes the two functions as an alternative way of getting/setting the value.  Also for completeness, I guess I should mention there is a deleter as well, which can be passed as the third argument to <code>property</code>, or used as <code>@hexcode.deleter</code>, but that seems less useful to me.
</p>

<p>
    I would say I kind of prefer the python way of doing it.  It means I only have to define the getter and setter functions after the fact of an API change, not as some pre-emptive move just in case it changes later.  Also it looks cleaner to me to access attributes then call methods.
</p>

<p>
    This can also be used to create read only attributes by leaving out the setter (you will get an <code>AttributeError</code>) or to add some validation in around an attribute to prevent some invalid values be added in.  I could in this case make the <code>self.r</code> etc. into attributes as well to make sure they are in the correct range of 0 to 255.
</p>

<p>
    This however is not going stop people messing with variables that you wanted to be protected (indicated by putting an underscore before it).  But you told them they are playing with fire, if they get burned, that can't be helped.  So this solution of python does not cover all use cases that private and protected methods are supposed to, but it covers enough that I think the need for them is not great in Python.  Instead Python has its own and very powerful and flexible solution.
</p>
    </div>
    </div></body></html>