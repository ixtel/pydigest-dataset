<html><body><div><div role="main">
        
<h2>Security releases issued</h2>

<span class="meta">Posted by <strong>James Bennett</strong> on August 20, 2014 </span>

<p>Today the Django team is issuing multiple releases -- Django 1.4.14,
Django 1.5.9, Django 1.6.6, and Django 1.7 release candidate 3 -- as
part of <a class="reference external" href="https://www.djangoproject.com/security/">our security process</a>. These releases are now
available on <a class="reference external" href="https://pypi.python.org/pypi/Django">PyPI</a> and <a class="reference external" href="https://www.djangoproject.com/download/">our
download page</a>.</p>
<p>These releases address an issue with <tt class="docutils literal">reverse()</tt> generating external
URLs; a denial of service involving file uploads; a potential session
hijacking issue in the remote-user middleware; and a data leak in the
administrative interface. We encourage all users of Django to upgrade
as soon as possible.</p>
<div class="section" id="s-issue-reverse-can-generate-urls-pointing-to-other-hosts-cve-2014-0480">
<h4>Issue: reverse() can generate URLs pointing to other hosts (CVE-2014-0480)</h4>
<p>Django includes the helper function
<tt class="docutils literal">django.core.urlresolvers.reverse</tt>, typically used to generate a URL
from a reference to a view function or URL pattern name. However, when
presented with input beginning with two forward-slash characters
(<tt class="docutils literal">//</tt>), <tt class="docutils literal">reverse()</tt> could generate scheme-relative URLs to other
hosts, allowing an attacker who is aware of unsafe use of
<tt class="docutils literal">reverse()</tt> (i.e., in a situation where an end user can control the
target of a redirect, to take a common example) to generate links to
sites of their choice, enabling phishing and other attacks.</p>
<p>To remedy this, URL reversing now ensures that no URL starts with two
slashes (<tt class="docutils literal">//</tt>), replacing the second slash with its URL encoded
counterpart (<tt class="docutils literal">%2F</tt>). This approach ensures that semantics stay the
same, while making the URL relative to the domain and not to the
scheme.</p>
<p>Thanks to Florian Apolloner for reporting this issue.</p>
</div>
<div class="section" id="s-issue-file-upload-denial-of-service-cve-2014-0481">
<h4>Issue: file upload denial of service (CVE-2014-0481)</h4>
<p>In the default configuration, when Django's file upload handling
system is presented with a file that would have the same on-disk path
and name as an existing file, it attempts to generate a new unique
filename by appending an underscore and an integer to the end of the
(as stored on disk) filename, incrementing the integer (i.e., <tt class="docutils literal">_1</tt>,
<tt class="docutils literal">_2</tt>, etc.) until it has generated a name which does not conflict
with any existing file.</p>
<p>An attacker with knowledge of this can exploit the sequential behavior
of filename generation by uploading many tiny files which all share a
filename; Django will, in processing them, generate ever-increasing
numbers of <tt class="docutils literal">os.stat()</tt> calls as it attempts to generate a unique
filename. As a result, even a relatively small number of such uploads
can significantly degrade performance.</p>
<p>To remedy this, Django's file-upload system will no longer use
sequential integer names to avoid filename conflicts on disk; instead,
a short random alphanumeric string will be appended, removing the
ability to reliably generate many repeatedly-conflicting filenames.</p>
<p>Thanks to David Wilson for reporting this issue.</p>
</div>
<div class="section" id="s-issue-remoteusermiddleware-session-hijacking-cve-2014-0482">
<h4>Issue: RemoteUserMiddleware session hijacking (CVE-2014-0482)</h4>
<p>Django provides a middleware --
<tt class="docutils literal">django.contrib.auth.middleware.RemoteUserMiddleware</tt> -- and an
authentication backend,
<tt class="docutils literal">django.contrib.auth.backends.RemoteUserBackend</tt>, which use the
<tt class="docutils literal">REMOTE_USER</tt> header for authentication purposes.</p>
<p>In some circumstances, use of this middleware and backend could result
in one user receiving another user's session, if a change to the
<tt class="docutils literal">REMOTE_USER</tt> header occurred without corresponding logout/login
actions.</p>
<p>To remedy this, the middleware will now ensure that a change to
<tt class="docutils literal">REMOTE_USER</tt> without an explicit logout will force a logout and
subsequent login prior to accepting the new <tt class="docutils literal">REMOTE_USER</tt>.</p>
<p>Thanks to David Greisen for reporting this issue.</p>
</div>
<div class="section" id="s-issue-data-leakage-via-querystring-manipulation-in-admin-cve-2014-0483">
<h4>Issue: data leakage via querystring manipulation in admin (CVE-2014-0483)</h4>
<p>Django's administrative interface, <tt class="docutils literal">django.contrib.admin</tt>, offers a
feature whereby related objects can be displayed for selection in a
popup window. The mechanism for this relies on placing values in the
URL and querystring which specify the related model to display and the
field through which the relationship is implemented. This mechanism
does perform permission checks at the level of the model class as a
whole.</p>
<p>This mechanism did not, however, verify that the specified field
actually represents a relationship between models. Thus a user with
access to the admin interface, and with sufficient knowledge of model
structure and the appropriate URLs, could construct popup views
which would display the values of non-relationship fields, including
fields the application developer had not intended to expose in such a
fashion.</p>
<p>To remedy this, the admin interface will now, in addition to its
normal permission checks, verify that the specified field does indeed
represent a relationship, to a model registered with the admin, and
will raise an exception if either condition is not true.</p>
<p>Thanks to Collin Anderson for reporting this issue.</p>
</div>
<div class="section" id="s-affected-versions">
<h4>Affected versions</h4>
<ul class="simple">
<li>Django master development branch (currently at pre-alpha status)</li>
<li>Django 1.7 (currently at release candidate status)</li>
<li>Django 1.6</li>
<li>Django 1.5</li>
<li>Django 1.4</li>
</ul>
</div>
<div class="section" id="s-resolution">
<h4>Resolution</h4>
<p>Patches have been applied to Django's master development branch, and
to the 1.4, 1.5, 1.6 and 1.7 release branches, which resolve the
issues described above. The patches may be obtained directly from the
following changesets:</p>
<p>On the development master branch:</p>

<p>On the 1.7 release branch:</p>

<p>On the 1.6 release branch:</p>

<p>On the 1.5 release branch:</p>

<p>On the 1.4 release branch:</p>

<p>The following new releases have been issued:</p>

</div>
<div class="section" id="s-general-notes-regarding-security-reporting">
<h4>General notes regarding security reporting</h4>
<p>As always, we ask that potential security issues be reported via
private email to <tt class="docutils literal">security@djangoproject.com</tt>, and not via Django's
Trac instance or the django-developers list. Please see <a class="reference external" href="https://www.djangoproject.com/security/">our security
policies</a> for further
information.</p>
</div>


        <a href="#top" class="backtotop"><i class="icon icon-chevron-up"/> Back to Top</a>
      </div>

      
  </div></body></html>