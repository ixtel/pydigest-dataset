<html><body><div><div class="content html_format">
      <img src="https://habrastorage.org/getpro/habr/post_images/495/e99/95b/495e9995bd0ea30db9d19a68fd183487.png"/><p>
Любой проект за годы разработки обрастает большой и сложной инфраструктурой. Множество скриптов сборки, хуков и самописных утилиток со временем превращаются в целый ворох проблем. Этого сложно избежать полностью, но вполне реально сократить количество возможных неприятностей. Об одном инструменте, который может Вам в этом помочь, я сегодня и расскажу.
</p><a name="habracut"/>
<h1>Buildbot? Не, не слышал.</h1><p>
На хабре почти нет упоминаний об этом замечательном тулките. Значит ли это, что им никто не пользуется? Отнюдь.</p><p>
Сhromium, python, blender и </p><a href="http://trac.buildbot.net/wiki/SuccessStories">множество других больших проектов</a><p> собираются и даже релизятся с помощью buildbot.
</p><img src="https://habrastorage.org/getpro/habr/post_images/97e/798/041/97e798041786c3596024cf7158c0c99f.png"/><p>
Большой и страшный </p><a href="http://build.chromium.org/p/chromium/waterfall">waterfall</a><p> проекта chromium

</p><h1>Что за зверь такой?</h1><p>
Стоит отметить главную особенность: buildbot — это фреймворк. Кто-то может посчитать это минусом, но для серьезных проектов это несомненный плюс. Ведь давно известно, что если хочешь сделать что-то годное, то лучше сделать это самому.</p><p>
Конфиг, содержащий в себе инструкции что как и где собирать, представляет из себя код на python. Оттого я надеюсь, что Вы с этим языком знакомы.

</p><h1>В бой!</h1><p>
Лучше один раз увидеть, чем сто раз услышать, так что давайте сразу перейдем к действию.

</p><b>Нам потребуется:</b>
<ul>
<li><a href="http://python.org">Python</a> в купе с его dev пакетами(для сборки twisted)</li>
<li><a href="http://pypi.python.org/pypi/virtualenv">Virtualenv</a> для создания виртуального окружения</li>
<li><a href="http://git-scm.com">Git</a></li>
</ul> 
<b>Создадим виртуальное окружение</b>
<pre><code class="bash">mkdir -p buildbot
cd buildbot
virtualenv --no-site-packages sandbox
source sandbox/bin/activate
easy_install sqlalchemy==0.7.10
easy_install buildbot buildbot-slave
</code></pre>
<b>Создадим мастер-сервер</b>
<pre><code class="bash">buildbot create-master master
</code></pre>
<b>Переименуем дефолтный конфиг</b>
<pre><code class="bash">mv master/master.cfg.sample master/master.cfg
</code></pre>
<b>А теперь запустим мастер</b>
<pre><code class="bash">buildbot start master
</code></pre>
<b>Можно проверить хорошо ли все работает посмотрев лог</b>
<pre><code class="bash">tail -f master/twistd.log
</code></pre>

<b>А теперь, не отходя от кассы, создадим слейв</b><p>
Размещение слейва рядом с мастером нельзя назвать хорошей практикой, но в нашем случае это позволительно
</p><pre><code class="bash">buildslave create-slave slave localhost:9989 example-slave pass
</code></pre>
<b>Запускаем</b>
<pre><code class="bash">buildslave start slave
</code></pre><p>
Слейв ругнется на развернутый по-соседству твистедовский сервер мастера. Не обращаем внимания.</p><p>
Если есть особое желание, то можем проверить, как все прошло, заглянув в лог
</p><pre><code class="bash">tail -f slave/twistd.log
</code></pre>
<p>
Если мы сделали все правильно, то на </p><a href="http://localhost:8010">8010</a><p> порту нашего localhost'а будет красоваться вот такая приветственная страничка:
</p><img src="https://habrastorage.org/getpro/habr/post_images/9cf/fc4/ea5/9cffc4ea5385e4001ec9779bc6e70229.png"/>

<h1>Проверяем</h1><p>
Логинимся. user: pyflakes, password: pyflakes.</p><p>
Идем на </p><a href="http://localhost:8010/builders/runtests">localhost:8010/builders/runtests</a><p> и видим примерно следующее:
</p><img src="https://habrastorage.org/getpro/habr/post_images/e27/ce2/f9f/e27ce2f9f37f8a344f51314fc7eb21d2.png"/><p>
Смело жмякаем «Force Build»
</p><p>
Наш первый билд готов. Нажимаем F5 и переходим на страницу сборки. Все шаги зеленые? Значит, тесты прошли успешно.
</p><img src="https://habrastorage.org/getpro/habr/post_images/735/3ea/091/7353ea0916a17e6143d8ec342478b996.png"/><p>
Нажав на stdout конкретного шага сборки, можно увидеть вывод консоли с подробным описанием того что, как и где запускалось.

</p><h1>Конец</h1><p>
Вот и все, на этом я закончу введение в buildbot. Если у хабрасообщества есть желание, то я с удовольствием продолжу повествование, расскажу о тонкостях и граблях на которые я наступил при внедрении билдбота.
      </p><p class="clear"/>
    </div>

    
  </div></body></html>