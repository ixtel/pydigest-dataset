<html><body><div><div class="col-sm-12">
    
    <p>If you look at modern code deployment practices, like in the 12 factor app, environment variables are very important for keeping secret information secret, or server specific information set for that server. All while not having long crazy settings in a settings file for every single server and computer. It helps keep things slimmer in your code along with the following quoted from the 12factorapp site:</p>

<pre><code>    * Resource handles to the database, Memcached, and other backing services
    * Credentials to external services such as Amazon S3 or Twitter
    * Per-deploy values such as the canonical hostname for the deploy
</code></pre>
<h2>What Are Environment Variables?</h2>
<p>Environment variables are a key value pairs that can affect how a program runs. They need to be set at some point before a process is run so the process can read them in and act accordingly. A lot of times in production environments your database name and password are set as environment variables so that information does not end up in a code repository somewhere.</p>
<p>By relying on an environment variable your code doesn't care what a setting is because you can set that at some other point. Actually working with environment variables is really simple. All you need to start is import os and you are off to the races.</p>
<h2>Get Environment Variable with Python:</h2>
<div class="highlight"><pre><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'DATABASE_NAME'</span><span class="p">)</span>
</pre></div>
<p>The <code>environ</code> part of this call is like a dictionary of all the environment variables. So we just get the one we are after and go about our business. You might even see something like below for your database settings, in your django settings file. You are either getting the environment variable, or you are getting back an empty string.</p>
<div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'default'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'ENGINE'</span><span class="p">:</span> <span class="s">'django.db.backends.postgresql_psycopg2'</span><span class="p">,</span>
        <span class="s">'NAME'</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'DATABASE_NAME'</span><span class="p">,</span> <span class="s">''</span><span class="p">),</span>
        <span class="s">'USER'</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'DATABASE_USER'</span><span class="p">,</span> <span class="s">''</span><span class="p">),</span>
        <span class="s">'PASSWORD'</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'DATABASE_PASSWORD'</span><span class="p">,</span> <span class="s">''</span><span class="p">),</span>
        <span class="s">'HOST'</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'DATABASE_HOST'</span><span class="p">,</span> <span class="s">''</span><span class="p">),</span>
        <span class="s">'PORT'</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'DATABASE_PORT'</span><span class="p">,</span> <span class="s">''</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2>Running <code>django-admin.py/manage.py</code> with environment variables</h2>
<p>A common use of environment variables in django is the <code>DJANGO_SETTINGS_MODULE</code>. It tells <code>django-admin.py</code> what settings file to load for a project.</p>
<div class="highlight"><pre><span class="nv">DJANGO_SETTINGS_MODULES</span><span class="o">=</span><span class="s1">'project.settings'</span> django-admin.py
</pre></div>
<p><code>manage.py</code> is basically a shortcut to this command. We are setting the location of our <code>settings.py</code> file and running <code>django-admin.py</code> command. There has been a lot debate about <code>manage.py</code> since the above is all it really does. You can read and learn more on a ticket about it: <a href="https://code.djangoproject.com/ticket/19737">Deprecate and then remove "shell" management command</a></p>
<h2>Set environment variable in bashrc</h2>
<p>Finally, depending on your environment you might want to setup environment variables in your <code>bashrc</code> or <code>bash_profile</code> so every time you start a command line environment they are set. To do this add something like the following to your <code>bashrc</code> or <code>bash_profile</code></p>
<div class="highlight"><pre><span class="nb">export </span><span class="nv">PROGRAMMING_FOLDER</span><span class="o">=</span><span class="s1">'/home/user/programming/'</span>
</pre></div>
<p>The export command is built into shell and sets <code>PROGRAMMING_FOLDER</code> to <code>/home/user/programming</code> for the current environment. You can verify this running <code>env</code> in your shell, or even <code>env | grep PROGRAMMING</code> to get just that environment variable.</p>
<h2>Common Places to Set Environment Variables in Production</h2>

<p>First link is how to set environment variables with supervisord which is a recommended way to run your server side code, generally running gunicorn or uWSGI. uWSGI is linked to because a lot of people run it outside of supervisord. However, it is recommended if you use gunicorn to use supervisord so set environment variables inside that config.</p>
<h2>Conclusion</h2>
<p>Environment variables are extremely useful, but can be a huge pain to work with. I really suggest playing with them in different environments to get used to working with them. When I first started setting them in production environments it was tough to first learn how to set them, and run my code. However, once I got environment variables working locally in my dev environment, and in production it became super convenient. I am super glad I took the extra effort to learn a process to work with them, and I think you will too.</p>

  </div>
</div></body></html>