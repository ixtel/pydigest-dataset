<html><body><div><div class="entry-content">
		<p>In our previous examples we learned how to scrape data from public organization/company pages with no authentication. This limited the data we could retrieve from Facebook pages to only high level page information: likes, talking about counts etc.</p>
<p>In this series of tutorials we will build off of our previous example of scraping simple public data, and learn how to pull more rich post and comment data. In Part 1 of this tutorial we will learn how to extract post data and print it to our console.</p>
<p><strong>Prerequisites</strong></p>
<ul>
<li>Completion of Simple Python Facebook Scraper Part <a title="Simple Python Facebook Scraper: Part 1" href="http://simplebeautifuldata.com/2014/08/25/simple-python-facebook-scraper-part-1/">1</a> and <a title="Simple Python Facebook Scraper: Part 2" href="http://simplebeautifuldata.com/2014/09/01/simple-python-facebook-scraper-part-2/">2</a></li>
<li>Python 2.7</li>
<li>MySQL 5.6</li>
</ul>
<p><strong>1. Become a Facebook App Developer</strong></p>
<p>Before we begin to start coding you need to become Facebook application developer. Navigate to the link <a title="Directions to become a Facebook Developer" href="https://developers.facebook.com/docs/create-developer-account">here</a>, and follow the instructions to sign up your Facebook account as an App Developer.</p>
<p>Once you have become a Facebook developer, we will now create a new application. In the upper ribbon select <em>Apps -&gt; Create a New App</em>. Now fill out the form. All you need to do is fill out is your app name, choose a category and press create app. I am going to call mine <em>Simple Data Pull, </em>but feel free to call it whatever you want.</p>
<div id="attachment_63" class="wp-caption aligncenter"><a href="http://simplebeautifuldata.com/wp-content/uploads/2014/09/Selection_002.png"><img class="wp-image-63 size-medium" src="http://simplebeautifuldata.com/wp-content/uploads/2014/09/Selection_002-300x167.png" alt="Create Facebook App"/></a><p class="wp-caption-text">Create Facebook App</p></div>
<p>Now that we have created our Facebook App, we will once again select the Apps drop down and select <em>Simple Data Pull</em>, or whatever you named it.</p>
<p>On this view we are interested in grabbing 2 pieces of information, the App ID and App Secret. We will use this info below for our authentication of our Graph API calls. Do not share with others your App ID and App Secret, treat this like your username and password.</p>
<div id="attachment_64" class="wp-caption aligncenter"><a href="http://simplebeautifuldata.com/wp-content/uploads/2014/09/Selection_005.png"><img class="size-medium wp-image-64" src="http://simplebeautifuldata.com/wp-content/uploads/2014/09/Selection_005-300x83.png" alt="App ID and App Secret"/></a><p class="wp-caption-text">App ID and App Secret</p></div>
<p><strong>2. Simple Authentication</strong></p>
<p>In our Simple Python Facebook Scraper tutorial, we established our graph URL that we manipulated and opened to receive JSON object responses containing data about Likes, talking about etc. To collect JSON objects of posts we will have to change our URL that we were manipulating so that it is secure, and able to pull the Post data. So let’s first go to our <em>graph_url</em> variable, and change the assignment value to “https://graph.facebook.com/”. Though it may seem like a small change, it is a necessary requirement to pull post data using SSL.</p>

		<div id="crayon-56d598a34d339489329164" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d598a34d339489329164-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d339489329164-2"><span class="crayon-h">    </span><span class="crayon-c">#to find go to page's FB page, at the end of URL find username</span></p><p class="crayon-line" id="crayon-56d598a34d339489329164-3"><span class="crayon-h">    </span><span class="crayon-c">#e.g. http://facebook.com/walmart, walmart is the username</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d339489329164-4"><span class="crayon-h">    </span><span class="crayon-v">list_companies</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"walmart"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"cisco"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"pepsi"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"facebook"</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d598a34d339489329164-5"><span class="crayon-h">    </span><span class="crayon-v">graph_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://graph.facebook.com/"</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Don’t worry, our original calls to the graph API we used to collect public information, will still work.</p>
<p>Now we will create a small function that we will use to create turn our <em>graph_url</em> into a url that will pull post data. Above our main function let’s create a function called <em>create_post_url</em>. Go ahead and copy the following code.</p>

		<div id="crayon-56d598a34d34a655950404" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d598a34d34a655950404-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">create_post_url</span><span class="crayon-sy">(</span><span class="crayon-v">graph_url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_ID</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_SECRET</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d34a655950404-2"><span class="crayon-h">    </span><span class="crayon-c">#method to return </span></p><p class="crayon-line" id="crayon-56d598a34d34a655950404-3"><span class="crayon-h">    </span><span class="crayon-v">post_args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"/posts/?key=value&amp;access_token="</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">APP_ID</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"|"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">APP_SECRET</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d34a655950404-4"><span class="crayon-e">    </span><span class="crayon-v">post_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">graph_url</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">post_args</span></p><p class="crayon-line" id="crayon-56d598a34d34a655950404-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d34a655950404-6"><span class="crayon-e">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">post_url</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Let’s go through this function line by line. As you can see in the top of the function we are passing in variables graph_url, which we just changed, and the APP_ID and APP_SECRET which we received from Facebook when we created our app. The line post_args is the addition we need to our original graph call to pull the post data. In adding the APP_ID and APP_SECRET it allows Facebook to know we are ok to retrieve post information.</p>
<p>The next line simply combines the graph_url with the post_args from the previous line and creates the URL with the credentials needed to access the data. Finally, our function returns our post data URL.</p>
<p><strong>3. Harvesting Post Data</strong></p>
<p>Okay, now that we have created the function that will pass us our secure URL for post data, let’s actually put this to use and start collecting some posts. Before we have our script start pulling data, let’s view what we are about to collect in our web browser. Let’s make the URL, for the first iteration of the for loop. Simply paste your APP_SECRET and APP_ID in the URL below.</p>

		<div id="crayon-56d598a34d351404881148" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d598a34d351404881148-1"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//graph.facebook.com/walmart/posts/?key=value&amp;access_token=APP_ID|APP_SECRET</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Navigate to the page and you should see the following in your browser:</p>
<div id="attachment_56" class="wp-caption aligncenter"><a href="http://simplebeautifuldata.com/wp-content/uploads/2014/09/Selection_004.png"><img class="size-full wp-image-56" src="http://simplebeautifuldata.com/wp-content/uploads/2014/09/Selection_004.png" alt="Walmart Post Data"/></a><p class="wp-caption-text">Walmart Post Data</p></div>
<p>Similar to when we looked at the JSON object in our browser in Simple Python Facebook Scraper Part 1, our results look like a mess of information… If you look closely at the data that is displayed in our browser, you will see that all this mess of information is actually nested under the “data” key in our JSON object. In fact, you can see that there are other nested values within such as “from” and “properties”.</p>
<p>We will get into more detail on how to extract some of these pieces of data in some subsequent tutorials. In Part 1 of Harvesting Facebook Posts and Comments with Python, we are going to start simple, and tackle some of the more advanced stuff in subsequent posts.</p>
<p>Okay, let’s copy the below snippet of code in our main function, below where we are printing our page_data to console.</p>

		<div id="crayon-56d598a34d358942426503" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d598a34d358942426503-1"><span class="crayon-h">        </span><span class="crayon-c">#extract post data</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d358942426503-2"><span class="crayon-h">        </span><span class="crayon-v">post_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_post_url</span><span class="crayon-sy">(</span><span class="crayon-v">current_page</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_ID</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_SECRET</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d358942426503-3"><span class="crayon-h">        </span><span class="crayon-v">web_response</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">urllib2</span><span class="crayon-sy">.</span><span class="crayon-e">urlopen</span><span class="crayon-sy">(</span><span class="crayon-v">post_url</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d358942426503-4"><span class="crayon-h">        </span><span class="crayon-v">readable_page</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">web_response</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d358942426503-5"><span class="crayon-h">        </span><span class="crayon-v">json_postdata</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">json</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-v">readable_page</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d358942426503-6"><span class="crayon-h">        </span><span class="crayon-v">json_fbposts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">json_postdata</span><span class="crayon-sy">[</span><span class="crayon-s">'data'</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d598a34d358942426503-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d358942426503-8"><span class="crayon-h">        </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">json_fbposts</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Let’s go through this snippet of code line by line. Adopting a similar methodology as we did with Simple Python Facebook Scraper: Part 1, we open the URL, and receive the response. Then we use the read method to convert this response to a readable page.</p>
<p>Next, we load the readable page into a JSON object called json_postdata. The contents in this variable represents all of the key value pairs that we saw above when we opened the page in our browser.</p>
<p>To make our manipulation of this data a little more palatable, we assign the json_fbposts equal to the data within the “data” key. This is so all of the data we saw before is no longer nested within the “data” key. If you are eager to check if it works, go ahead and save and run the script. You should see a huge jumbled glob of data.</p>
<p><em>Before we Move On Let’s Simplify Our Code!</em></p>
<p>Since we have done this procedure of opening a URL, then converting the response multiple times already in our code, let’s create function that we can call so that we no longer have to type all of these lines out. Above our main function let’s create a function called render_to_json.</p>

		<div id="crayon-56d598a34d35e817265063" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d598a34d35e817265063-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">render_to_json</span><span class="crayon-sy">(</span><span class="crayon-v">graph_url</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d35e817265063-2"><span class="crayon-h">    </span><span class="crayon-c">#render graph url call to JSON</span></p><p class="crayon-line" id="crayon-56d598a34d35e817265063-3"><span class="crayon-h">    </span><span class="crayon-v">web_response</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">urllib2</span><span class="crayon-sy">.</span><span class="crayon-e">urlopen</span><span class="crayon-sy">(</span><span class="crayon-v">graph_url</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d35e817265063-4"><span class="crayon-h">    </span><span class="crayon-v">readable_page</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">web_response</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d35e817265063-5"><span class="crayon-h">    </span><span class="crayon-v">json_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">json</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-v">readable_page</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d35e817265063-6"><span class="crayon-h">    </span></p><p class="crayon-line" id="crayon-56d598a34d35e817265063-7"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">json_data</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now let’s replace the 4 lines of code below in our main function, with this simple function render_to_json. Our code should now look something like the below. I know, a small gain, but as we progress through this set of tutorials it will save us considerable lines of code… and our own sanity! If you want brownie points, incorporate our new function on the same for lines of code rendering the page level response to a JSON object.</p>

		<div id="crayon-56d598a34d363972383075" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d598a34d363972383075-1"><span class="crayon-h">        </span><span class="crayon-c">#extract post data</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d363972383075-2"><span class="crayon-h">        </span><span class="crayon-v">post_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_post_url</span><span class="crayon-sy">(</span><span class="crayon-v">current_page</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_ID</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_SECRET</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d363972383075-3"><span class="crayon-h">        </span><span class="crayon-v">json_postdata</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">render_to_json</span><span class="crayon-sy">(</span><span class="crayon-v">post_url</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d363972383075-4"><span class="crayon-h">        </span><span class="crayon-v">json_fbposts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">json_postdata</span><span class="crayon-sy">[</span><span class="crayon-s">'data'</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d598a34d363972383075-5"><span class="crayon-h">        </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d363972383075-6"><span class="crayon-h">        </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">json_fbposts</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Okay, now that we have our glob of data successfully printing to console, let’s pick out some data we are actually interested in. First, let’s comment out the print json_fbposts. Next copy the code, and paste it into your code, below where we were printing our blob of post data.</p>

		<div id="crayon-56d598a34d369380807470" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d598a34d369380807470-1"><span class="crayon-h">        </span><span class="crayon-c">#print json_fbposts</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d369380807470-2"><span class="crayon-h">        </span></p><p class="crayon-line" id="crayon-56d598a34d369380807470-3"><span class="crayon-h">        </span><span class="crayon-c">#print post messages and ids</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d369380807470-4"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">post </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">json_fbposts</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d598a34d369380807470-5"><span class="crayon-h">            </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d369380807470-6"><span class="crayon-h">            </span><span class="crayon-st">try</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d598a34d369380807470-7"><span class="crayon-h">                </span><span class="crayon-c">#try to print out data</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d369380807470-8"><span class="crayon-h">                </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">post</span><span class="crayon-sy">[</span><span class="crayon-s">"id"</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d598a34d369380807470-9"><span class="crayon-h">                </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">post</span><span class="crayon-sy">[</span><span class="crayon-s">"message"</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d369380807470-10"><span class="crayon-h">                </span></p><p class="crayon-line" id="crayon-56d598a34d369380807470-11"><span class="crayon-h">            </span><span class="crayon-st">except</span><span class="crayon-h"> </span><span class="crayon-k ">Exception</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d369380807470-12"><span class="crayon-h">                </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"Error"</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now going through our block of code line by line, we are first looping through every post on the JSON page. Then for each post, we try to open up the object and read its value for “id” and “message” if it fails to print this information, it will simply print a very general error message.</p>
<p>We have included this try except, because there are several errors that you can receive while pulling data from the Facebook Graph API. If we hit an unforeseen error, we want our script to keep going.</p>
<p><strong>5. What our Code Should Look Like Thus Far<br/>
</strong></p>
<p>At the close of Part 1 of Harvesting Facebook Posts and Comments with Python, our code should look something like the following:</p>

		<div id="crayon-56d598a34d36e945527737" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-2">2</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-4">4</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-6">6</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-8">8</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-10">10</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-12">12</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-14">14</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-16">16</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-18">18</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-20">20</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-22">22</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-24">24</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-26">26</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-28">28</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-30">30</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-32">32</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-34">34</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-36">36</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-38">38</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-40">40</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-42">42</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-44">44</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-46">46</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-48">48</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-50">50</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-52">52</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-54">54</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-55">55</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-56">56</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-57">57</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-58">58</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-59">59</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-60">60</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-61">61</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-62">62</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-63">63</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-64">64</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-65">65</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-66">66</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-67">67</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-68">68</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-69">69</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-70">70</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-71">71</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-72">72</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-73">73</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-74">74</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-75">75</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-76">76</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-77">77</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-78">78</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-79">79</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-80">80</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-81">81</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-82">82</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-83">83</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-84">84</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-85">85</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-86">86</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-87">87</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d598a34d36e945527737-88">88</p><p class="crayon-num" data-line="crayon-56d598a34d36e945527737-89">89</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d598a34d36e945527737-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">urllib2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">json</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">mysql</span><span class="crayon-sy">.</span><span class="crayon-e">connector</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-4"> </p><p class="crayon-line" id="crayon-56d598a34d36e945527737-5"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">connect_db</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-6">  <span class="crayon-h"> </span> <span class="crayon-c">#fill this out with your db connection info</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-7">  <span class="crayon-h"> </span> <span class="crayon-v">connection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mysql</span><span class="crayon-sy">.</span><span class="crayon-v">connector</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-k ">user</span><span class="crayon-o">=</span><span class="crayon-s">'JohnDoe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-o">=</span><span class="crayon-s">'abc123'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-8">  <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>     <span class="crayon-h"> </span><span class="crayon-v">host</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'127.0.0.1'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-9">  <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>   <span class="crayon-h"> </span>                     <span class="crayon-h"> </span><span class="crayon-v">database</span><span class="crayon-o">=</span><span class="crayon-s">'facebook_data'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-10">  <span class="crayon-h"> </span> <span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">connection</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-12"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">create_post_url</span><span class="crayon-sy">(</span><span class="crayon-v">graph_url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_ID</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_SECRET</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-13"><span class="crayon-h">    </span><span class="crayon-c">#create authenticated post URL</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-14"><span class="crayon-h">    </span><span class="crayon-v">post_args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"/posts/?key=value&amp;access_token="</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">APP_ID</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"|"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">APP_SECRET</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-15"><span class="crayon-e">    </span><span class="crayon-v">post_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">graph_url</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">post_args</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-16"> </p><p class="crayon-line" id="crayon-56d598a34d36e945527737-17"><span class="crayon-e">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">post_url</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-18"><span class="crayon-e">    </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-19"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">render_to_json</span><span class="crayon-sy">(</span><span class="crayon-v">graph_url</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-20"><span class="crayon-h">    </span><span class="crayon-c">#render graph url call to JSON</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-21"><span class="crayon-h">    </span><span class="crayon-v">web_response</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">urllib2</span><span class="crayon-sy">.</span><span class="crayon-e">urlopen</span><span class="crayon-sy">(</span><span class="crayon-v">graph_url</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-22"><span class="crayon-h">    </span><span class="crayon-v">readable_page</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">web_response</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-23"><span class="crayon-h">    </span><span class="crayon-v">json_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">json</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-v">readable_page</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-24"><span class="crayon-h">    </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-25"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">json_data</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-26"> </p><p class="crayon-line" id="crayon-56d598a34d36e945527737-27"><span class="crayon-e">    </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-28"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-29"><span class="crayon-h">    </span><span class="crayon-c">#simple data pull App Secret and App ID</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-30"><span class="crayon-h">    </span><span class="crayon-v">APP_SECRET</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"YOUR APP SECRET"</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-31"><span class="crayon-h">    </span><span class="crayon-v">APP_ID</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"YOUR APP ID"</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-32"><span class="crayon-h">    </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-33"><span class="crayon-h">    </span><span class="crayon-c">#to find go to page's FB page, at the end of URL find username</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-34"><span class="crayon-h">    </span><span class="crayon-c">#e.g. http://facebook.com/walmart, walmart is the username</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-35"><span class="crayon-h">    </span><span class="crayon-v">list_companies</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"walmart"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"cisco"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"pepsi"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"facebook"</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-36"><span class="crayon-h">    </span><span class="crayon-v">graph_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://graph.facebook.com/"</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-37"><span class="crayon-h">    </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-38"> </p><p class="crayon-line" id="crayon-56d598a34d36e945527737-39"><span class="crayon-h">    </span><span class="crayon-c">#create db connection</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-40"><span class="crayon-h">    </span><span class="crayon-v">connection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">connect_db</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-41"><span class="crayon-h">    </span><span class="crayon-v">cursor</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">connection</span><span class="crayon-sy">.</span><span class="crayon-e">cursor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-42"><span class="crayon-h">    </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-43"><span class="crayon-h">    </span><span class="crayon-c">#SQL statement for adding Facebook page data to database</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-44"><span class="crayon-h">    </span><span class="crayon-v">insert_info</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"INSERT INTO page_info "</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-45"><span class="crayon-h">                    </span><span class="crayon-s">"(fb_id, likes, talking_about, username)"</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-46"><span class="crayon-h">                    </span><span class="crayon-s">"VALUES (%s, %s, %s, %s)"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-47"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-48"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">company </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">list_companies</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-49"><span class="crayon-h">        </span><span class="crayon-c">#make graph api url with company username</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-50"><span class="crayon-h">        </span><span class="crayon-v">current_page</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">graph_url</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">company</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-51"><span class="crayon-h">        </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-52"><span class="crayon-h">        </span><span class="crayon-c">#open public page in facebook graph api</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-53"><span class="crayon-h">        </span><span class="crayon-v">json_fbpage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">render_to_json</span><span class="crayon-sy">(</span><span class="crayon-v">current_page</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-54"><span class="crayon-h">        </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-55"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-56"><span class="crayon-h">        </span><span class="crayon-c">#gather our page level JSON Data</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-57"><span class="crayon-h">        </span><span class="crayon-v">page_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">json_fbpage</span><span class="crayon-sy">[</span><span class="crayon-s">"id"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">json_fbpage</span><span class="crayon-sy">[</span><span class="crayon-s">"likes"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-58"><span class="crayon-h">                     </span><span class="crayon-v">json_fbpage</span><span class="crayon-sy">[</span><span class="crayon-s">"talking_about_count"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-59"><span class="crayon-h">                     </span><span class="crayon-v">json_fbpage</span><span class="crayon-sy">[</span><span class="crayon-s">"username"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-60"><span class="crayon-h">        </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">page_data</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-61"><span class="crayon-h">        </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-62"><span class="crayon-h">        </span><span class="crayon-c">#extract post data</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-63"><span class="crayon-h">        </span><span class="crayon-v">post_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_post_url</span><span class="crayon-sy">(</span><span class="crayon-v">current_page</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_ID</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">APP_SECRET</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-64"><span class="crayon-h">        </span><span class="crayon-v">json_postdata</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">render_to_json</span><span class="crayon-sy">(</span><span class="crayon-v">post_url</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-65"><span class="crayon-h">        </span><span class="crayon-v">json_fbposts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">json_postdata</span><span class="crayon-sy">[</span><span class="crayon-s">'data'</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-66"><span class="crayon-h">        </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-67"><span class="crayon-h">        </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-68"><span class="crayon-h">        </span><span class="crayon-c">#print post messages and ids</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-69"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">post </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">json_fbposts</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-70"><span class="crayon-h">            </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-71"><span class="crayon-h">            </span><span class="crayon-st">try</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-72"><span class="crayon-h">                </span><span class="crayon-c">#try to print out data</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-73"><span class="crayon-h">                </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">post</span><span class="crayon-sy">[</span><span class="crayon-s">"id"</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-74"><span class="crayon-h">                </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">post</span><span class="crayon-sy">[</span><span class="crayon-s">"message"</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-75"><span class="crayon-h">                </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-76"><span class="crayon-h">            </span><span class="crayon-st">except</span><span class="crayon-h"> </span><span class="crayon-k ">Exception</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-77"><span class="crayon-h">                </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"Key error"</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-78"><span class="crayon-h">            </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-79"><span class="crayon-h">            </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-80"><span class="crayon-h">        </span><span class="crayon-c">#insert the data we pulled into db</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-81"><span class="crayon-h">        </span><span class="crayon-v">cursor</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-v">insert_info</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">page_data</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-82"><span class="crayon-h">        </span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-83"><span class="crayon-h">        </span><span class="crayon-c">#commit the data to the db</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-84"><span class="crayon-h">        </span><span class="crayon-v">connection</span><span class="crayon-sy">.</span><span class="crayon-e">commit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-85"><span class="crayon-h">        </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-86"><span class="crayon-h">    </span><span class="crayon-v">connection</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-87"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d598a34d36e945527737-88"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d598a34d36e945527737-89"><span class="crayon-h">    </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">    </span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Summary and Next Steps:</strong></p>
<p>In this tutorial we built upon our Simple Python Facebook Scraper, and learned how to scrape public post data from Facebook. In our next post in this series, we will learn how to navigate deeper into the post data to collect data points like Likes and Shares, and make updates to our database for this new data.</p>

<p class="chitika-adspace below">


</p>			</div>

	</div></body></html>