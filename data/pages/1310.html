<html><body><div><div class="post-content">
        <p><strong>EDIT</strong></p>

<p>So, it's been about a year since I posted this.
I still use the project from time to time. Mostly for my own
python CLIs (i tool everything).</p>

<p>For larger projects I gave <a href="https://virtualenvwrapper.readthedocs.org/en/latest/">virtualenvwrapper</a> another go,
and so far is sticking to it.</p>

<hr/>

<p>I - like most python hackers - use virtualenv on a daily basis.
I love virtualenv. It allows me to install packages in a local context,
without isolating my development environment completely.</p>

<hr/>



<p>Vpython is a tiny(-ish) bash script to help with your daily virtualenv needs.</p>

<ul>
<li>You don't have to worry about sourcing the <code>activate</code> script.</li>
<li>You don't have to point to your virtualenv path.</li>
</ul>

<p>just use <code>vpython</code> instead of <code>python</code> to invoke scripts "inside" a virtualenv.</p>

<h3>How</h3>

<p>Vpython works by looking for at virtualenv directory in the directory of the script you invoke.
If not found, it will go up one directory and search in the parent.
When vpython detects a virtualenv folder, it will use that folder's configuration
to run whatever you asked vpython to run, just like had it been <code>python</code>.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$&gt; vpython path/to/project/script.py
</code></pre></div>
<p>Running <code>vpython</code> with first argument being a directory, it will
search for a virtualenv directory, just like when invoking it with a script path.
When a virtualenv is found, vpython will invoke the virtualenv's <code>python</code>,
handing you a python shell for that virtualenv.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$&gt; vpython path/to/project/
</code></pre></div>
<p>If no arguments are given to <code>vpython</code>, it will use you current working directory
to search for a virtualenv path.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$&gt; pwd
/home/tbug/src/demo-project
&gt; vpython
Using virtualenv at "/home/tbug/src/demo-project/.virtualenv"
Python 2.7.1+ (r271:86832, Sep 27 2012, 21:12:17)
[GCC 4.5.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;
</code></pre></div>
<p>Use <code>vpython --help</code> to see full help text.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$&gt; vpython --help
Usage:
    vpython --help                                this help
    vpython --pip &lt;/path/to/env&gt; [&lt;pip_ags&gt;...]   call the virtualenv pip
    vpython --install &lt;/path/to/new/env&gt;          install a new virtualenv
    vpython --find &lt;/path/to/search/for/env&gt;      return virtualenv path if found, else exits with non-0
    vpython &lt;python_file&gt;                         call a python file inside a virtualenv
    vpython &lt;directory&gt;                           start a python shell inside a virtualenv
</code></pre></div>
<h2>Usecase</h2>

<p>This is our folder structure:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/home/tbug/src/demo-project/
|-- .virtualenv
|   +-- { regular virtualenv directory structure here }
+-- script.py
</code></pre></div>
<p>With regular virtualenv, we would do something like</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/home/tbug/src/demo-project $&gt; source .virtualenv/bin/activate
/home/tbug/src/demo-project $&gt; python script.py
/home/tbug/src/demo-project $&gt; deactivate
</code></pre></div>
<p>and with vpython</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/home/tbug/src/demo-project $&gt; vpython script.py
</code></pre></div>
<p>It might not seem like much to save a line (noone deactivates a virtualenv, right?)
and you are right.<br/>
The strength of vpython is the ability to look up the virtualenv
no matter what path is your current working directory, and even if that script
is behind a symlink.</p>

<p>Say our <code>script.py</code> is some utility that we want to use all the time.
We might link it somewhere on our path, like <code>/usr/local/bin</code>.</p>

<p>But we still need the virtualenv to activate before the script is run?! What do?!</p>

<p>If we use vpython, the virtualenv configuration will be correctly loaded before
running our script.</p>

<p>We can even use <code>vpython</code> in the script's shebang.<br/>
Pretend this is our <code>script.py</code>, and that it contains something very useful:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!vpython</span>
<span class="c">#imaging that we import something useful from our virtualenv site-packages</span>
<span class="k">print</span> <span class="s">"hello vpython world"</span></code></pre></div>

<p>Now, if you make that script executable, no matter where you run it from, it will
use the correct virtualenv directory. As long as <code>script.py</code> is inside a folder
(or subfolder) of a virtualenv directory, it will work.</p>

<p>Let's try symlinking <code>script.py</code> to <code>/usr/local/bin</code>, or wherever
you put your stuff:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/home/tbug/src/demo-project $&gt; ln -s `pwd`/script.py /usr/local/bin/script
/home/tbug/src/demo-project $&gt; #it is now liked to our path as "script"
/home/tbug/src/demo-project $&gt; script
Using virtualenv at "/home/tbug/src/demo-project/.virtualenv"
hello vpython world
</code></pre></div>
<p><strong>Note</strong> that vpython always tell you where it found the running virtualenv.
If you don't want that, you can invoke vpython with the <code>-q</code> or <code>--quiet</code> flag.</p>

<h2>Installing vpython</h2>

<p>Make sure you have a working python and virtualenv installed
(vpython will warn you if they are missing, so don't worry).</p>

<ol>
<li>Clone the <a href="https://github.com/tbug/vpython">repository from github</a> (<code>https://github.com/tbug/tbug.github.io.git</code>).</li>
<li>Run the installer script (<code>vpython/install.sh</code>).</li>
<li>There is no step 3.</li>
</ol>

<p>The installer will try to place symlinks to the vpython and vpip scripts
in <code>~/bin</code> if it exists, otherwise it will install it to <code>/usr/bin</code>.</p>

<p><strong>Note</strong> that if <code>~/bin</code> exists, it is assumed that it is also on your <code>$PATH</code>.</p>

<h2>Updating vpython</h2>

<ol>
<li><code>cd</code> to the path of the <code>vpython</code> repo clone.</li>
<li>run <code>git pull</code>.</li>
<li>Once again; no step 3.</li>
</ol>

<h2>Starting a new environment</h2>

<p>Vpython also contains wrappers for creating and installing packages inside
a virtualenv.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/home/tbug/src/demo-project $&gt; vpython --install .
New python executable in /home/tbug/src/demo-project/.virtualenv/bin/python
Installing setuptools, pip...done.
</code></pre></div>
<p>By default, vpython will install the virtualenv to a folder called <code>virtualenv</code>.
You can change this by setting the <code>ENV_NAME</code> environment variable like this:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/home/tbug/src/demo-project $&gt; ENV_NAME=env vpython --install .
New python executable in /home/tbug/src/demo-project/env/bin/python
Installing setuptools, pip...done.
</code></pre></div>
<p>It is only necessary to set this when installing a new environment.
When using an existing environment, vpython doesn't care about the environment name.</p>

<p>Now that you have a new environment, it is time to install some packages.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/home/tbug/src/demo-project $&gt; vpython --pip . install asynckit
</code></pre></div>
<p>The syntax here is:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">vpython --pip (virtualenv lookup path) (pip arguments...)
</code></pre></div>
<p>This is a bit cumbersome, so vpython ships with the <code>vpip</code> helper.</p>

<p><code>vpip</code> assumes your current directory is where you want to look for a virtualenv,
so if your current working directory is somewhere within a virtualenv, you can
use <code>vpip</code> just as regular <code>pip</code>:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/home/tbug/src/demo-project $&gt; vpip install asynckit
Using virtualenv at "/home/tbug/src/demo-project/.virtualenv"
Downloading/unpacking asynckit
..............................
Successfully installed asynckit
Cleaning up...
</code></pre></div>
<h2>Something broke!</h2>

<p>Oh dear!
If you find an error, open an <a href="https://github.com/tbug/vpython/issues">issue</a>, or send me a pull request with a fix.</p>

    </div>
</div></body></html>