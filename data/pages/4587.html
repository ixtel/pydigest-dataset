<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-snake-snaaaaaaaakkke" class="anchor" href="#snake-snaaaaaaaakkke" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Snake (SNAAAAAAAAKKKE)</h1>

<p><a href="https://travis-ci.org/amoffat/snake"><img src="https://camo.githubusercontent.com/3be376dc4c88076eaba0280f6073ce5c7240ab3d/68747470733a2f2f7472617669732d63692e6f72672f616d6f666661742f736e616b652e7376673f6272616e63683d6d6173746572" alt="Build&#10;Status" data-canonical-src="https://travis-ci.org/amoffat/snake.svg?branch=master"/></a></p>

<p>Snake lets you use Python to its fullest extent to write Vim plugins:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>

<span class="pl-en">@key_map</span>(<span class="pl-s"><span class="pl-pds">"</span>&lt;leader&gt;c<span class="pl-pds">"</span></span>)
<span class="pl-k">def</span> <span class="pl-en">toggle_snake_case_camel_case</span>():
    <span class="pl-s"><span class="pl-pds">"""</span> toggles a word between snake case (some_function) and camelcase</span>
<span class="pl-s">    (someFunction) <span class="pl-pds">"""</span></span>
    word <span class="pl-k">=</span> get_word()

    <span class="pl-c"># it's snake case</span>
    <span class="pl-k">if</span> <span class="pl-s"><span class="pl-pds">"</span>_<span class="pl-pds">"</span></span> <span class="pl-k">in</span> word:
        chunks <span class="pl-k">=</span> word.split(<span class="pl-s"><span class="pl-pds">"</span>_<span class="pl-pds">"</span></span>)
        camel_case <span class="pl-k">=</span> chunks[<span class="pl-c1">0</span>] <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>.join([chunk.capitalize() <span class="pl-k">for</span> chunk <span class="pl-k">in</span>
            chunks[<span class="pl-c1">1</span>:]])
        replace_word(camel_case)

    <span class="pl-c"># it's camel case</span>
    <span class="pl-k">else</span>:
        <span class="pl-c"># split our word on capital letters followed by non-capital letters</span>
        chunks <span class="pl-k">=</span> <span class="pl-c1">filter</span>(<span class="pl-c1">None</span>, re.split(<span class="pl-s"><span class="pl-pds">"</span>([A-Z][^A-Z]*)<span class="pl-pds">"</span></span>, word))
        snake_case <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>_<span class="pl-pds">"</span></span>.join([chunk.lower() <span class="pl-k">for</span> chunk <span class="pl-k">in</span> chunks])
        replace_word(snake_case)</pre></div>

<p>Pressing "&lt;leader&gt;c" will then toggle between snake and camel case for the
current word!</p>

<p><a href="https://camo.githubusercontent.com/820b1196ed5ab642011b82efd745e4ad37ce7d8f/687474703a2f2f692e696d6775722e636f6d2f5a4672337658472e676966" target="_blank"><img src="https://camo.githubusercontent.com/820b1196ed5ab642011b82efd745e4ad37ce7d8f/687474703a2f2f692e696d6775722e636f6d2f5a4672337658472e676966" alt="Metal Gear Solid Snake Success" data-canonical-src="http://i.imgur.com/ZFr3vXG.gif"/></a></p>



<h1><a id="user-content-why-do-you-want-this" class="anchor" href="#why-do-you-want-this" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Why do you want this?</h1>

<p>Vim is great, but vimscript is painful as a programming language.  Let's use
Python instead.  Here's some cool things you can do:</p>

<h2><a id="user-content-bind-a-function-to-a-key" class="anchor" href="#bind-a-function-to-a-key" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Bind a function to a key</h2>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>

<span class="pl-en">@key_map</span>(<span class="pl-s"><span class="pl-pds">"</span>&lt;leader&gt;r<span class="pl-pds">"</span></span>)
<span class="pl-k">def</span> <span class="pl-en">reverse</span>():
    replace_word(get_word()[::<span class="pl-k">-</span><span class="pl-c1">1</span>])</pre></div>

<h2><a id="user-content-use-a-function-for-an-abbreviation" class="anchor" href="#use-a-function-for-an-abbreviation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Use a function for an abbreviation</h2>

<p>A Python function can be expanded dynamically as you type an abbreviation in
insert mode.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>
<span class="pl-k">import</span> time

abbrev(<span class="pl-s"><span class="pl-pds">"</span>curtime<span class="pl-pds">"</span></span>, time.ctime)</pre></div>

<h2><a id="user-content-have-a-function-run-for-a-file-type" class="anchor" href="#have-a-function-run-for-a-file-type" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Have a function run for a file type</h2>

<p>Sometimes it is convenient to run some code when the buffer you open is of a
specific file type.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>

<span class="pl-en">@when_buffer_is</span>(<span class="pl-s"><span class="pl-pds">"</span>python<span class="pl-pds">"</span></span>)
<span class="pl-k">def</span> <span class="pl-en">setup_python_folding</span>(<span class="pl-smi">ctx</span>):
    ctx.set_option(<span class="pl-s"><span class="pl-pds">"</span>foldmethod<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>indent<span class="pl-pds">"</span></span>)
    ctx.set_option(<span class="pl-s"><span class="pl-pds">"</span>foldnestmax<span class="pl-pds">"</span></span>, <span class="pl-c1">2</span>)
    ctx.key_map(<span class="pl-s"><span class="pl-pds">"</span>&lt;space&gt;<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>za<span class="pl-pds">"</span></span>)</pre></div>

<p>A context object is passed into the function you wrap.  This context allows you
to set options, let variables, and create abbreviations and keymaps that apply
only to the buffer you just opened, not globally.</p>

<h2><a id="user-content-press-arbitrary-keys-as-if-you-typed-them" class="anchor" href="#press-arbitrary-keys-as-if-you-typed-them" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Press arbitrary keys as if you typed them</h2>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>

<span class="pl-k">def</span> <span class="pl-en">uppercase_second_word</span>():
    keys(<span class="pl-s"><span class="pl-pds">"</span>gg<span class="pl-pds">"</span></span>) <span class="pl-c"># go to top of file, first character</span>
    keys(<span class="pl-s"><span class="pl-pds">"</span>w<span class="pl-pds">"</span></span>) <span class="pl-c"># next word</span>
    keys(<span class="pl-s"><span class="pl-pds">"</span>viw<span class="pl-pds">"</span></span>) <span class="pl-c"># select inner word</span>
    keys(<span class="pl-s"><span class="pl-pds">"</span>~<span class="pl-pds">"</span></span>) <span class="pl-c"># uppercase it</span></pre></div>

<h1><a id="user-content-how-do-i-get-it" class="anchor" href="#how-do-i-get-it" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How do I get it?</h1>

<p>Your Vim version must include <a href="http://vimdoc.sourceforge.net/htmldoc/various.html#+python"><code>+python</code></a> to use Snake. You can check with <code>:version</code>.</p>

<h2><a id="user-content-vundle" class="anchor" href="#vundle" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Vundle</h2>

<p>Add the following line to your Vundle plugin block of your <code>.vimrc</code>:</p>

<pre><code>Plugin 'amoffat/snake'
</code></pre>

<p>Re-source your <code>.vimrc</code>.  Then <code>:PluginInstall</code></p>

<h2><a id="user-content-pathogen" class="anchor" href="#pathogen" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Pathogen</h2>

<p>TODO</p>

<h2><a id="user-content-neobundle" class="anchor" href="#neobundle" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Neobundle</h2>

<p>Add the following line to your Neobundle plugin block of your <code>.vimrc</code>:</p>

<pre><code>NeoBundle 'amoffat/snake'
</code></pre>

<p>Re-source your <code>.vimrc</code>. Then <code>NeoBundleInstall</code></p>

<h1><a id="user-content-where-do-i-write-my-snake-code" class="anchor" href="#where-do-i-write-my-snake-code" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Where do I write my Snake code?</h1>

<p><code>.vimrc.py</code> is intended to be the python equivalent of <code>.vimrc</code>.  Snake.vim will
load it on startup.  It should contain all of your Snake initialization code and
do any imports of other Snake plugins.  If were so inclined, you could move all
of your vim settings and options into <code>.vimrc.py</code> as well:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>

multi_set_option(
    <span class="pl-s"><span class="pl-pds">"</span>nocompatible<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>exrc<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>secure<span class="pl-pds">"</span></span>,

    (<span class="pl-s"><span class="pl-pds">"</span>background<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>dark<span class="pl-pds">"</span></span>),
    (<span class="pl-s"><span class="pl-pds">"</span>textwidth<span class="pl-pds">"</span></span>, <span class="pl-c1">80</span>),

    (<span class="pl-s"><span class="pl-pds">"</span>shiftwidth<span class="pl-pds">"</span></span>, tab),
    (<span class="pl-s"><span class="pl-pds">"</span>softtabstop<span class="pl-pds">"</span></span>, tab),
    (<span class="pl-s"><span class="pl-pds">"</span>tabstop<span class="pl-pds">"</span></span>, tab),
    <span class="pl-s"><span class="pl-pds">"</span>expandtab<span class="pl-pds">"</span></span>,
)

let(<span class="pl-s"><span class="pl-pds">"</span>mapleader<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>,<span class="pl-pds">"</span></span>)

multi_command(
    <span class="pl-s"><span class="pl-pds">"</span>nohlsearch<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>syntax on<span class="pl-pds">"</span></span>,
)

<span class="pl-k">from</span> snake.plugins <span class="pl-k">import</span> my_rad_plugin</pre></div>

<h1><a id="user-content-design-philosophy" class="anchor" href="#design-philosophy" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Design Philosophy</h1>

<p>Vim is powerful, but its commands and key-bindings are built for seemingly every
use case imaginable.  It doesn't distinguish between commonly-used and
rarely-used.  Snake should use that existing foundation of functionality to add
structure for commonly-needed operations.  For example, many vim users know that
<code>yiw</code> yanks the word you're on into a register.  This is a common operation, and
so it should be mapped to a simple function:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-en">@preserve_state</span>()
<span class="pl-k">def</span> <span class="pl-en">get_word</span>():
    keys(<span class="pl-s"><span class="pl-pds">"</span>yiw<span class="pl-pds">"</span></span>)
    <span class="pl-k">return</span> get_register(<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span>)</pre></div>

<p>Now instead of your plugin containing <code>execute "normal! yiw"</code>, it can contain
<code>word = get_word()</code></p>

<h1><a id="user-content-how-do-i-write-a-plugin" class="anchor" href="#how-do-i-write-a-plugin" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How do I write a plugin?</h1>

<p>If your plugin is a package, create (or symlink) a directory inside
<code>~/.vim/bundle</code> for your plugin.  Make this directory a Python package by
creating a <code>__init__.py</code></p>

<p>If your plugin is a simple one-file module, just create or symlink that file
into your <code>~/.vim/bundle</code> directory.</p>

<p>Next Add <code>from snake.plugins import &lt;your_plugin&gt;</code> to <code>~/.vimrc.py</code>.  Finally,
Re-source your <code>~/.vimrc</code></p>

<p>For plugin API reference, check out <a href="/amoffat/snake/blob/master/docs/api_reference.md">api_reference.md</a>.</p>

<h1><a id="user-content-can-i-use-a-virtualenv-for-my-plugin" class="anchor" href="#can-i-use-a-virtualenv-for-my-plugin" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Can I use a virtualenv for my plugin?</h1>

<p>Yes!  But it's crazy!</p>

<p>Just include a <code>requirements.txt</code> file in your package directory that contains
the <code>pip freeze</code> output of all the dependencies you wish to include.  When your
module is imported from <code>.vimrc.py</code>, a virtualenv will be automatically created
for your plugin if it does not exist, and your plugin dependencies automatically
installed.</p>

<p>Virtualenvs that are created automatically will use your virtualenv_wrapper
<code>WORKON_HOME</code> environment variable, if one exists, otherwise <code>~/.virtualenvs</code>.
And virtualenvs take the name <code>snake_plugin_&lt;your_plugin_name&gt;</code>.</p>

<h2><a id="user-content-gotchas" class="anchor" href="#gotchas" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Gotchas</h2>

<p>You may be wondering how snake can allow for different virtualenvs for different
plugins within a single Python process.  There's a little magic going on, and as
such, there are some gotchas.</p>

<p>When a plugin with a virtualenv is imported, it is imported automatically within
that plugin's virtualenv.  Then the virtualenv is exited.  This process is
repeated for each plugin with a virtualenv.</p>

<p>What this means is that all of your plugin's imports <em>must</em> occur at your
plugin's import time:</p>

<p>GOOD:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>
<span class="pl-k">import</span> requests

<span class="pl-k">def</span> <span class="pl-en">stuff</span>():
    <span class="pl-k">return</span> requests.get(<span class="pl-s"><span class="pl-pds">"</span>http://google.com<span class="pl-pds">"</span></span>).text</pre></div>

<p>BAD:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>

<span class="pl-k">def</span> <span class="pl-en">stuff</span>():
    <span class="pl-k">import</span> requests
    <span class="pl-k">return</span> requests.get(<span class="pl-s"><span class="pl-pds">"</span>http://google.com<span class="pl-pds">"</span></span>).text</pre></div>

<p>The difference here is that in the first example, your plugin will have a
reference to the correct <code>requests</code> module, because it was imported while your
plugin was being imported inside its virtualenv.  In the second example, when
<code>stuff()</code> runs, it is no longer inside of your plugin's virtualenv, so when it
imports <code>requests</code>, it will not get the correct module or any module at all.</p>

<p>There is also the problem of different plugins having different dependency
versions.  For example, if Snake plugin <code>A</code> depends on <code>sh==1.10</code> and plugin <code>B</code>
depends on <code>sh==1.11</code>, whichever plugin gets loaded first in <code>.vimrc.py</code> will
put <em>their</em> <code>sh</code> module into <code>sys.modules</code>.  Then, when the other plugin loads,
it will attempt to load <code>sh</code>, see it is in <code>sys.modules</code>, and use that instead,
instead of looking in its virtualenv.</p>

<p>All of this obviously isn't great, and something better needs to be built to
more thoroughly separate virtualenvs from under a single Python process.  I
think what can happen is, for the <code>SnakePluginHook</code>, if a <code>fullname</code> has more
than 3 paths, drop into the virtualenv for the plugin and run <code>imp.find_module</code>.
If the module exists, return <code>self</code> as the loader.  Repeat the process in
<code>load_module</code> except actually <code>imp.load_module</code>.  This way, the dependency
should be loaded into <code>sys.modules</code> prefixed by the full plugin name
<code>snake.plugins.whatever.sh</code>.</p>

<h1><a id="user-content-contributing" class="anchor" href="#contributing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Contributing</h1>

<p>Read <a href="/amoffat/snake/blob/master/docs/development.md">development.md</a> for technical info.</p>

<h2><a id="user-content-pull-requests" class="anchor" href="#pull-requests" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Pull requests</h2>

<p>Although Snake is meant to make Vim more scriptable in Python, it is <em>not</em> meant
to provide all the nuanced functionality of Vim.  PRs for new features will be
screened by the value-add of the feature weighed against the complexity added to
the api, with favor towards keeping the api simple.</p>

<h2><a id="user-content-snake-needs-a-vundle-equivalent" class="anchor" href="#snake-needs-a-vundle-equivalent" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Snake needs a vundle equivalent</h2>

<p>I would like to see an import hook that allows this in your <code>.vimrc.py</code>:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> snake <span class="pl-k">import</span> <span class="pl-k">*</span>

something_awesome <span class="pl-k">=</span> <span class="pl-c1">__import__</span>(<span class="pl-s"><span class="pl-pds">"</span>snake.plugins.tpope/something_awesome<span class="pl-pds">"</span></span>)</pre></div>

<p>Where the import hook checks if the plugin exists in <code>~/.vim/snake</code>, and if it
doesn't, looks for a repo to clone at
<code>https://github.com/tpope/something_awesome</code></p>
</article>
  </div></body></html>