<html><body><div><div class="postentry">
				
<p>Подошло время выкладывать очередную <a href="http://jenyay.net/Outwiker/Unstable">нестабильную версию OutWiker</a>. За прошедший месяц была проделана большая работа, как заметная пользователям, так и невидимая для них, связанная с переделкой внутренностей программы и добавлением новых возможностей для плагинов. Но обо всем по порядку.</p>
<p>Как вы знаете, в одной из версий OutWiker 1.9.0.xxx появилась возможность добавления пользовательских иконок для страниц. После чего возникло желание сделать группу сразу со всеми иконками из наборов <a href="http://www.famfamfam.com/">famfamfam</a>, <a href="http://p.yusukekamiyamane.com/">Fugue icons</a> и <a href="http://www.fatcow.com/free-icons">FatCow</a>. Всего получилось больше 7000 иконок. До текущей версии такое количество иконок в диалоге свойств страницы OutWiker отображал бы, мягко говоря, долго, а под Windows скорее всего даже и упал бы из-за нехватки ресурсов. Так вот, начиная с версии 1.9.0.778, теперь такой проблемы нет, и отображение такого количества иконок происходит очень быстро и с небольшим потреблением ресурсов.</p>
<p><span id="more-5328"/></p>
<p>После этого я принялся за плагины, точнее за добавление возможностей для них. Начал с того, что планировал очень давно, практически с момента появления викистраниц в OutWiker (да, старожилы помнят, что когда-то этого типа страниц еще не существовало в программе), а именно с добавления возможности плагинам не только добавлять викикоманды вида (:…:), но и произвольную викинотацию. Также, когда в викистраницы я добавлял команду {$…$} для вставки формул, я планировал при первом же удобном случае эту возможность перенести в плагин, поскольку далеко не всем нужны формулы, да еще в формате TeX.</p>
<p>Как вы уже поняли, больше в OutWiker викикоманды больше {$…$} нет… Зато появился плагин <a href="http://jenyay.net/Outwiker/TexEquation">TeXEquation</a>, который возвращает ту самую викикоманду {$…$}.</p>


<p>Это повлекло за собой следующие последствия. Во-первых, в зависимостях OutWiker под Linux больше не числится программа mimetex, с помощью которой рендерились формулы, из дистрибутива под Windows эту программу тоже убрал. Если вы — пользователь Windows, и вам нужны формулы, то особо заботиться вам не о чем, устанавливайте плагин <a href="http://jenyay.net/Outwiker/TexEquation">TeXEquation</a> как обычно, и все будет работать, как прежде, к этому плагину прилагается mimetex.exe. А вот пользователи Linux должны mimetex установить в систему самостоятельно, но, думаю, что это не проблема, mimetex есть для всех популярных дистрибутивов.</p>
<hr/>
<p>Убедившись на примере плагина <a href="http://jenyay.net/Outwiker/TexEquation">TeXEquation</a>, что викинотация теперь более расширяема, я принялся за третью поставленную себе в этой версии задаче — сделать так, чтобы плагины могли влиять на диалог создания страницы и редактирования ее свойств. Это нужно, например, если плагин добавляет новый тип страниц, для которого необходимо добавить новую вкладку с параметрами. Рефакторинг (для не программистов — это изменение текста программы без видимых изменений для пользователя) длился неделю. За эту неделю плодились и умирали классы, функции переезжали из одного класса в другой, классы становились абстрактными и не очень. В общем, в конце этой эволюции я удовлетворился результатом (пока), код стал заметно чище, классы тоньше, хотя их стало несколько больше. Тут же появилась возможность поправить одну казалось бы мелочь, которая меня давно смущала. Дело в том, что в окне свойств страницы есть вкладка «Внешний вид», где можно выбрать стиль страницы, но этот стиль используют только вики- и HTML-страницы. Возникает вопрос, зачем эту вкладку показывать для текстовой страницы и для страницы поиска? Теперь появилась возможность сделать так, чтобы эта вкладка была видна только для тех страниц, которым она нужна (хотел еще написать, как это теперь работает, но вспомнил, что я тут пишу не документацию по внутренностям OutWiker).</p>
<p>После этого появилась возможность сделать еще один плагин под названием <a href="http://jenyay.net/Outwiker/PageTypeColor">PageTypeColor</a>, но прежде чем говорить о том, что он делает, нужно описать существовавшую до данной версии проблему. Не знаю как вы, а я в повседневном использовании OutWiker использую в основном один тип страниц — викистраницы, поэтому когда я создаю новую страницу, я даже не обращаю внимание на поле для выбора ее типа, поскольку OutWiker всегда сохраняет последний используемый тип, и предлагает по умолчанию именно его. Однако иногда я создаю HTML-страницы, но после этого OutWiker по умолчанию начинает предлагать уже HTML-страницы. А поскольку, как я уже писал, на поле выбора типа страницы я почти не обращаю внимания, то вместо ожидаемой викистраницы я иногда создаю HTML-страницу. В этом нет ничего ужасного, просто приходится удалять страницу и создавать ее заново, однако это немного раздражало.</p>
<p>Именно так родилась идея для плагина <a href="http://jenyay.net/Outwiker/PageTypeColor">PageTypeColor</a>. Этот плагин раскрашивает поле ввода заголовка страницы различными цветами в зависимости от типа страницы, и если вы привыкнете, что, например, для викистраницы это поле будет всегда голубым (цвет по умолчанию для викистраниц), а в следующий раз оно станет желтым (цвет по умолчанию для HTML-страниц), то вы скорее всего обратите на это внимание. На следующих скриншотах показаны цвета для разных типов страниц, установленные по умолчанию:</p>

<p>Цвета меняются, когда вы переключаете тип страницы. Однако за неделю использования этого плагина для себя я понял, как этот плагин можно сделать еще более удобным. Для этого достаточно открыть настройки этого плагина через меню <b>Правка — Параметры… — PageTypeColor [плагин]</b> и установить для наиболее часто используемого вами типа страницы белый цвет. Поскольку все поля ввода по умолчанию белые, то изменение этого цвета вы наверняка заметите.</p>

<hr/>
<p>Вышеперечисленные плагины <a href="http://jenyay.net/Outwiker/TexEquation">TeXEquation</a> и <a href="http://jenyay.net/Outwiker/PageTypeColor">PageTypeColor</a> будут работать только начиная с OutWiker 1.9.0.778 (последней на данный момент версии).</p>
<p>А теперь немного о грустном. Как вы знаете, я стараюсь выкладывать новые <b>стабильные</b> версии ближе к концу года (эта традиция взята просто так, с потолка, чтобы мне самому было легче оценивать, как давно не было релиза), но изменения, которые произошли в данной версии открывают путь к плагинам, которые я уже давно обещал написать — это, в первую очередь, возможность скачивать страницы из интернета, и, во-вторых, шаблоны для страниц. Пожалуй, я начну делать плагин для создания страниц из веб-страниц, что позволит лучше протестировать внесенные изменения, но скорее всего задержит релиз на месяц. Плагин для шаблонов можно будет сделать уже после релиза (но я еще подумаю на этот счет).</p>
<p><b>PS.</b> В последнее время многие просят сделать плагин для страниц в формате Markdown, хоть я данный формат и недолюбливаю, но для его появления теперь тоже препятствий не вижу, скорее всего примусь за него после плагина для шаблонов.</p>
							</div>
			</div></body></html>