<html><body><div><div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-solution-algorithm">The solution algorithm<a class="anchor-link" href="#The-solution-algorithm">Â¶</a></h3><p><a href="http://www.jstor.org/stable/2297923">It is known</a> that the above system of equations has a solution of the form $p_t = \phi(s_t)$. However there is generally no analytical solution and the function $\phi(\cdot)$ must be computed numerically.</p>
<p>Suppose we expect that prices next period are governed by the function $f(s_{t+1})$. Then the price function this period, say $g(s_{t})$, will be a function of this expectation through our equilibrium conditions above. We express this relationship in the form</p><p>
$$g = Tf$$</p><p>where $T$ is an abstract operator representing the working of the equilibrium conditions. It is precisely the property of a stationary rational equations solution that it is a fixed-point of this operator</p><p>
$$\phi = T\phi$$</p><p>i.e., the expected law of prices is such as to produce behaviour which confirms the expect law of prices.</p>
<p>In order to find an approximate solution to this fixed-point equation we restrict our search to the finite dimensional space of <a href="https://en.wikipedia.org/wiki/Chebyshev_polynomials">Chebyshev polynomials</a> of a given degree. The true solution may not lie in this space and thus no function in this space may satisfy the fixed-point equation at all points. In order to nonetheless get a good approximation to the true solution the collocation method we use in this notebook requires that the function come close to satising the fixed-point equation at a given finite set of points. In this notebook we take these points to be <a href="https://en.wikipedia.org/wiki/Chebyshev_nodes">Chebyshev nodes</a>. The task of finding the Chebyshev polynomial which satisfies this condition is carried out through successive approximation: starting from an initial guess $f_0$ we calculate $y_n = (Tf_0)(x_n)$ at our chosen Chebyshev nodes $x_n$. Then $f_1$ is then taken to be a Chebyshev polynomial that passes through the points $(x_n,y_n)$. This is continued until we reach a fixed point.</p>
<p>There are two more technical difficulties. The operator $T$ involves computing a conditional expectation in order to find expected profits. For arbitrary functions this cannot be done exactly and we have to make a numerical approximation. In this notebook we use <a href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Hermite_quadrature">Gauss-Hermite quadrature</a> to replace the continuous distribution of the shocks $z_t$ by a discrete approximation.</p>
<p>Finally, we need to work with a bounded state space for our calculations. If $\lambda&gt;0$ and $\bar z$ the maximum possible realization of the shock then the beginning-of-period stock can never exceed $\bar z/\lambda$. This however does not work when $\lambda=0$. Also using this bound is harmful even when $\lambda&gt;0$ since this forces us to consider very large values of stock which are not reached in equilibrium, thereby wasting computational resources. We therefore follow the literature in arbitrarily assuming that there is an upper abound $x_{max}$ on end-of-period stocks. The value of this parameter is adjusted to be large enought that it is never reached in equilibrium.</p>
<p>See Judd, <em>Numerical Methods in Economics</em>, Chapter 11 and 17 for more details as well as alternative algorithms. Section 17.4 discusses the competitive storage model.</p>

</div>
</div></body></html>