<html><body><div><div class="row">
<p>I wanted to code my first android app for a long time but I didn’t really know where to start. I wasn’t really excited at the idea of having to learn Java and was worried that my current level of C++ wouldn’t be enough. So I began to look for a way to code the app in my go-to language : Python. Using Python allows for reuse of the native libraries, which can come in very handy. And it obviously comes with the usual Python magic and agility.</p>
<p><span id="more-385"/></p>
<p>In the following tutorial, I will explain how to code and deploy a simple app on Android : the classic snake game that we all played on the famous and indestructible nokia 3210 (well, my version of it anyway). I personally code on Ubuntu 14.10 with Python 2.7, so this tutorial assumes a similar set-up on your side. </p>
<h3>Table of contents</h3>

<h2>The Kivy framework</h2>
<p>After a few research on stack overflow, I discovered <a href="http://kivy.org/#home">Kivy</a>, an open source Python library made for cross platform development, just what I needed. The fact that they are a young open source project with a great documentation and community convinced me to give it a go.</p>
<p>As for the performances concerns that might arise at the idea of using Python to build an app, Kivy answers by using Cython so that the most intensive parts of the code are compiled down to the C level. Plus, it uses the GPU as much as possible for graphics-oriented calculations, freeing up CPU resources for other tasks.</p>
<p>There is a great deal of resources available to start with Kivy :</p>
<ul>
<li><a href="http://kivy.org/docs/gettingstarted/intro.html">The official documentation</a></li>
<li><a href="https://github.com/kivy/kivy/wiki">Kivy’s Wiki</a>, where you’ll be able to find pretty much everything that wasn’t covered in the doc (examples, code snippets, tutorials, talks, widgets developed by the community etc.)</li>
<li>You can find an <em>/example</em> folder on <a href="https://github.com/kivy/kivy/tree/master/examples">their repository</a>. Try to run them all at least once and you’ll see that most situations you will encounter are covered there (I especially like the demo showcase. It became as useful to me as the bootstrap doc is for web dev tasks).</li>
</ul>
<p>Well that’s that. Let’s get down to it shall we ?</p>
<h2>Setting up the environment</h2>
<p>We will see how to set up <a href="http://www.sublimetext.com/3">SublimeText</a>, add the corresponding packages and syntax highlighting so that it’ll be tailored to our needs. If you are more comfortable using another editor, just skip this part.</p>
<p>The mains things we will need are :</p>
<ul>
<li>Sublime Text 3</li>
<li>Package Control : a package manager that will allow us to easily add functionalities to our editor</li>
<li>Anaconda : an awesome Python package adding auto-completion, code linting (super useful to easily format the code so that it follows PEP8 standard) and more.</li>
</ul>
<p>Everything you need in order to do that is explained in this great tutorial : <a href="https://realpython.com/blog/python/setting-up-sublime-text-3-for-full-stack-python-development/">setting up sublime text 3 for full stack python development.</a></p>
<p>One more thing : kivy uses its own templating language in order to separate the front-end logic from the back-end. Its syntax is not natively recognized by ST3 so we need to add a custom syntax highlight file.</p>
<p>The procedure is quite simple :</p>
<ul>
<li>Download to following syntax definition : <a href="https://github.com/kivy/kivy/blob/master/kivy/tools/highlight/kivy.tmLanguage">kivy.tmLanguage</a></li>
<li>In ST3, click on Preferences/Browse Packages…</li>
<li>There should be a <em>/User</em> folder in the directory. Copy your .tmLanguage file here, restart ST3 and you’ll be all set!</li>
</ul>
<h2>Intalling Kivy</h2>
<h4>Dependencies</h4>
<p>To run properly, kivy needs 3 main dependencies : <a href="http://cython.org/">Cython</a>, <a href="http://pygame.org/">pygame</a> and the python-dev package. If you’re using Ubuntu, you may also need the gstreamer library which is used to support some of the video capacities of the framework.</p>

		<div id="crayon-56d59bdf444a9892041808" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59bdf444a9892041808-1"><span class="crayon-p"># install cython package</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444a9892041808-2"><span class="crayon-e">sudo </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">cython</span></p><p class="crayon-line" id="crayon-56d59bdf444a9892041808-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444a9892041808-4"><span class="crayon-p"># install dependencies for pygame</span></p><p class="crayon-line" id="crayon-56d59bdf444a9892041808-5"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-v">build</span><span class="crayon-o">-</span><span class="crayon-e">dep </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-e">pygame</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444a9892041808-6"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-e">dev </span><span class="crayon-v">build</span><span class="crayon-o">-</span><span class="crayon-v">essential</span></p><p class="crayon-line" id="crayon-56d59bdf444a9892041808-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444a9892041808-8"><span class="crayon-p"># install pygame (you need mercurial to use the hg+ command)</span></p><p class="crayon-line" id="crayon-56d59bdf444a9892041808-9"><span class="crayon-e">sudo </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">hg</span><span class="crayon-o">+</span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//bitbucket.org/pygame/pygame </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444a9892041808-10"> </p><p class="crayon-line" id="crayon-56d59bdf444a9892041808-11"><span class="crayon-p"># install gstreamer </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444a9892041808-12"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-v">gstreamer1</span><span class="crayon-sy">.</span><span class="crayon-cn">0</span><span class="crayon-o">-</span><span class="crayon-v">libav</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h4>Kivy</h4>
<p/>

		<div id="crayon-56d59bdf444bf484738865" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59bdf444bf484738865-1"><span class="crayon-p"># add kivy's repo to the list iof usable repositories </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444bf484738865-2"><span class="crayon-e">sudo </span><span class="crayon-v">add</span><span class="crayon-o">-</span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">repository </span><span class="crayon-v">ppa</span><span class="crayon-o">:</span><span class="crayon-v">kivy</span><span class="crayon-o">-</span><span class="crayon-v">team</span><span class="crayon-o">/</span><span class="crayon-e">kivy</span></p><p class="crayon-line" id="crayon-56d59bdf444bf484738865-3"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-v">update</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444bf484738865-4"> </p><p class="crayon-line" id="crayon-56d59bdf444bf484738865-5"><span class="crayon-p"># install kivy</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444bf484738865-6"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-v">kivy</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h4>Buildozer</h4>
<p>We’re going to use it to package our app and deploy it on an Android smartphone. Just plug your phone, type the magic words in the console and that’s it, you app is installed! Pretty neat.</p>

		<div id="crayon-56d59bdf444c3279502043" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59bdf444c3279502043-1"><span class="crayon-e">sudo </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">buildozer</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>To quote their <a href="https://github.com/kivy/buildozer">readme</a> :</p>
<blockquote><p>Buildozer is a tool for creating application packages easily.</p>
<p>The goal is to have one “buildozer.spec” file in your app directory, describing your application requirements and settings such as title, icon, included modules etc. Buildozer will use that spec to create a package for Android, iOS, Windows, OSX and/or Linux.</p></blockquote>
<p>Note : you will also need a java jdk. If you don’t have one installed, openjdk7 should be good. Furthermore if you’re on a 64bit system, you’ll need the 32bit versions of your dependencies (I got the tip from <a href="https://groups.google.com/forum/#!topic/kivy-dev/3hHnRJfAMC8">there</a>).</p>

		<div id="crayon-56d59bdf444c7782039922" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59bdf444c7782039922-1"><span class="crayon-p"># install java jdk</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444c7782039922-2"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-v">openjdk</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-o">-</span><span class="crayon-v">jdk</span></p><p class="crayon-line" id="crayon-56d59bdf444c7782039922-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444c7782039922-4"><span class="crayon-p"># install 32bit dependencies</span></p><p class="crayon-line" id="crayon-56d59bdf444c7782039922-5"><span class="crayon-e">sudo </span><span class="crayon-v">dpkg</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">add</span><span class="crayon-o">-</span><span class="crayon-e">architecture </span><span class="crayon-e">i386</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444c7782039922-6"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">update</span></p><p class="crayon-line" id="crayon-56d59bdf444c7782039922-7"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-v">libncurses5</span><span class="crayon-o">:</span><span class="crayon-e">i386 </span><span class="crayon-v">libstdc</span><span class="crayon-o">++</span><span class="crayon-cn">6</span><span class="crayon-o">:</span><span class="crayon-e">i386 </span><span class="crayon-v">zlib1g</span><span class="crayon-o">:</span><span class="crayon-i">i386</span><span class="crayon-h"> </span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Is it working ?</h2>
<p>Before we start to make our snake, let’s take a few minutes to check if everything is working as it is supposed to. Nothing is more annoying than discovering a new technology, jumping right into the code only to find several hours later that it can’t compile because of some damned dependency.</p>
<p>To prevent that from happening, we will build and deploy the illustrious ‘Hello World’. I won’t explain much since I would only be poorly paraphrasing their <a href="https://github.com/kivy/kivy/wiki">wiki</a>, so if you need a more basic understanding I can only direct you there.</p>
<p>First let’s initiate buildozer in our directory from the terminal :</p>

		

<p>Edit the buildozer .spec file (only the lines written here):</p>

		<div id="crayon-56d59bdf444cf931437041" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59bdf444cf931437041-1"><span class="crayon-p"># (str) Title of your application</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444cf931437041-2"><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Hello </span><span class="crayon-v">World</span></p><p class="crayon-line" id="crayon-56d59bdf444cf931437041-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444cf931437041-4"><span class="crayon-p"># (str) Package name</span></p><p class="crayon-line" id="crayon-56d59bdf444cf931437041-5"><span class="crayon-t">package</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">helloworldapp</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444cf931437041-6"> </p><p class="crayon-line" id="crayon-56d59bdf444cf931437041-7"><span class="crayon-p"># (str) Package domain (needed for android/ios packaging)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444cf931437041-8"><span class="crayon-t">package</span><span class="crayon-sy">.</span><span class="crayon-v">domain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">helloworldapp</span></p><p class="crayon-line" id="crayon-56d59bdf444cf931437041-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444cf931437041-10"><span class="crayon-p"># comment these two</span></p><p class="crayon-line" id="crayon-56d59bdf444cf931437041-11"><span class="crayon-p"># (str) Application versioning (method 1)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444cf931437041-12"><span class="crayon-p"># version.regex = __version__ = ['"](.*)['"]</span></p><p class="crayon-line" id="crayon-56d59bdf444cf931437041-13"><span class="crayon-p"># version.filename = %(source.dir)s/main.py</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444cf931437041-14"> </p><p class="crayon-line" id="crayon-56d59bdf444cf931437041-15"><span class="crayon-p"># uncomment that one</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444cf931437041-16"><span class="crayon-v">version</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1.0.0</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Our ‘Hello World’ App :</p>

		<div id="crayon-56d59bdf444d3198682687" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59bdf444d3198682687-1"><span class="crayon-e">import </span><span class="crayon-e">kivy</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444d3198682687-2"><span class="crayon-v">kivy</span><span class="crayon-sy">.</span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'1.8.0'</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># update with your current version</span></p><p class="crayon-line" id="crayon-56d59bdf444d3198682687-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444d3198682687-4"><span class="crayon-e">from </span><span class="crayon-v">kivy</span><span class="crayon-sy">.</span><span class="crayon-e">app </span><span class="crayon-e">import </span><span class="crayon-e">App</span></p><p class="crayon-line" id="crayon-56d59bdf444d3198682687-5"><span class="crayon-e">from </span><span class="crayon-v">kivy</span><span class="crayon-sy">.</span><span class="crayon-v">uix</span><span class="crayon-sy">.</span><span class="crayon-e">button </span><span class="crayon-e">import </span><span class="crayon-e">Button</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444d3198682687-6"> </p><p class="crayon-line" id="crayon-56d59bdf444d3198682687-7"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">DummyApp</span><span class="crayon-sy">(</span><span class="crayon-v">App</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444d3198682687-8"> </p><p class="crayon-line" id="crayon-56d59bdf444d3198682687-9"><span class="crayon-h">    </span><span class="crayon-e">def </span><span class="crayon-e">build</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444d3198682687-10"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">Button</span><span class="crayon-sy">(</span><span class="crayon-v">text</span><span class="crayon-o">=</span><span class="crayon-s">"Hello World"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59bdf444d3198682687-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444d3198682687-12"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'__main__'</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59bdf444d3198682687-13"><span class="crayon-h">    </span><span class="crayon-e">DummyApp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The code is available on the <a href="https://github.com/amatelin/Kivy-snake-tutorial/commit/1320eefb4f2cb959980ed9aa35af4a3e91f096c7">repository</a>. Each successive commit will correspond to a stage of progress in our tutorial.</p>
<p>We’re now ready to build the app and deploy it. Back to the terminal :</p>

		<div id="crayon-56d59bdf444d6727952468" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59bdf444d6727952468-1"><span class="crayon-e">buildozer </span><span class="crayon-e">android </span><span class="crayon-v">debug</span><span class="crayon-h"> </span><span class="crayon-p"># will create the apk file in a ./bin folder</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59bdf444d6727952468-2"> </p><p class="crayon-line" id="crayon-56d59bdf444d6727952468-3"><span class="crayon-e">buildozer </span><span class="crayon-e">android </span><span class="crayon-e">debug </span><span class="crayon-v">deploy</span><span class="crayon-h"> </span><span class="crayon-p"># if you want to install the apk directly on your phone</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Yay, your first app on a smartphone! How does it feel ?<br/>
We’re finally ready to start our Snake.</p>
<p><a href="http://digitaljunky.io/make-a-snake-game-for-android-written-in-python-part-2/" title="Make a Snake game for Android written in Python – Part 2">Go to part 2</a>.</p>
<p>(“Nay, it didn’t work.” Feel free to ask about any issue in the comments, but be warned that my knowledge is directly proportional to my ability to phrase questions on stackoverflow ^^).</p>
<p>Note : buildozer and adb sometimes make a great couple…sometimes they don’t. Don’t ask me why. So if buildozer gets stuck on <mark># Deploy on adb</mark>, use adb directly : go in the /bin folder of your app where the apk file was compiled and use <mark>adb install <em>YourApp</em>.apk</mark>. If it still doesn’t work (adb doesn’t recognize your device, or your device is unauthorized) : <mark>adb kill-server</mark>. Then make sure you restart it as root : <mark>sudo adb start-server</mark>. And if it still doesn’t work…tough life eh!
</p></div>
</div></body></html>