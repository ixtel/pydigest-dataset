<html><body><div><article class="markdown-body entry-content" itemprop="text"><h2><a id="user-content-ultralite" class="anchor" href="#ultralite" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Ultralite</h2>

<p><em>For when portability is critical, but you still need some HTTP convenience</em></p>

<h3><a id="user-content-author" class="anchor" href="#author" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Author</h3>

<p>by Cathal Garvey, copyright 2014, proudly licensed under the
<a href="https://www.gnu.org/licenses/agpl-3.0.txt">GNU Affero General Public License</a>.</p>



<h3><a id="user-content-about" class="anchor" href="#about" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>About</h3>

<p>Anyone who's coded in Python for long will have discovered <a href="http://docs.python-requests.org/en/latest/">Kenneth Reitz's
"Requests" library</a>, which makes
HTTP operations far more clean and straightforward than provided for by the
Python standard library (though things are improving on that score).</p>

<p>Requests is as simple to install as <code>pip install requests</code>, and as pip comes
installed with newer distributions of Python, this is really the best way you
can get good HTTP in Python.</p>

<p>However, there are times when you want your code to be portable and not to
depend on even the easiest third-party libraries, and for that there's
Ultralite.</p>

<p>The goal is to support 90% of the convenience of requests, while remaining
short and in-lineable, so you can literally copy/paste all of the code in this
module and drop it into your own code to get a taste of requests, anywhere.
And all of this while passing flake8 and pyflakes.</p>

<h3><a id="user-content-how-do-i-use-this" class="anchor" href="#how-do-i-use-this" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How do I use this?</h3>

<p>The intended use-case is to copy/paste this into your own modules or libraries.
You can also use <code>pip install ultralight</code> to install for use in the interactive
interpreter or to list it as a dependency in setup.py.</p>

<p>When copy/pasting, just copy the entire Ultralite class from this module, and
import the standard library modules it requires. Default headers can be added
to the class attribute "_default_headers"; these will be added to <em>all</em>
requests' header dictionaries, with user-provided headers overwriting them.</p>

<p>At present this only supports HEAD and GET requests, but will handle
POST/PUT/DELETE in the near future also in a manner similar to requests
(enabled by improvements in the standard library).</p>

<p>Features provided that mimic requests:</p>

<ul>
<li>Ultralite methods "get"/"head"/"put"/"post"/"delete" (not all implemented)</li>
<li>Headers can be provided as a dictionary</li>
<li>GET url parameters can be provided as a dictionary</li>
<li>Cookies are preserved, and can be provided as "cookies" arg (cookiejars only)</li>
<li>SSL is attempted automatically for URLs beginning with "https", and raises
a UltraliteSSLError (distinct from and not deriving from UltraliteError)
if an SSL handler cannot be successfully constructed; no silent SSL failures!</li>
<li>Methods return Ultralite.UltraliteResponse objects which are requests-like:

<ul>
<li>UltraliteResponse.headers -&gt; dict</li>
<li>UltraliteResponse.status_code -&gt; int</li>
<li>UltraliteResponse.reason -&gt; str</li>
<li>UltraliteResponse.cookies -&gt; http.cookiejar.CookieJar</li>
<li>UltraliteResponse.content -&gt; bytes</li>
<li>UltraliteResponse.text -&gt; unicode decoding of UltraliteResponse.content</li>
<li>UltraliteResponse.raw -&gt; http.client.HTTPResponse / urllib.error.XXX</li>
<li>UltraliteResponse.request -&gt; urllib.request.Request</li>
<li>UltraliteResponse.raise_for_status() -&gt; Raise Ultralite.UltraliteError if
http response code is not within 2XX range, otherwise do nothing.</li>
<li>UltraliteResponse.json() -&gt; attempt json-decoding UltraliteResponse.text</li>
</ul></li>
</ul>

<p>Additional features:</p>

<ul>
<li>UltraliteResponse.request_context -&gt; urllib.request.OpenerDirector used to
make the original request; can be re-used for subsequent manual requests,
in future this may be streamlined to allow request chaining.</li>
<li>UltraliteResponse.cookies_dict is a dictionary of name:value cookie pairs.</li>
<li>UltraliteResponse objects support request chaining (with preserved context),
so you can do (I'm aware this example has no clear use):
<code>ultralite.get("http://twitter.com").get("http://twitter.com/me")</code></li>
<li>Chained requests that begin with HTTPS enforce it for subsequent calls:
<code>ultralite.get("https://twitter.com").get("http://twitter.com/me") -&gt; Error</code></li>
</ul>

<h3><a id="user-content-known-bugs" class="anchor" href="#known-bugs" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Known Bugs</h3>

<ul>
<li>SSL is not yet tested by the doctests suite; desired tests include:

<ul>
<li>SSL verification of a known-good (pinned?) certificate.</li>
<li>SSL failure on a self-signed cert.</li>
<li>SSL failure on a falsely signed cert.</li>
<li>SSL failure on no cert.</li>
<li>SSL failure on expired or premature cert.</li>
</ul></li>
<li>Cookies either don't work at all (?) or get lost on 30X redirects, because
httpbin.org's cookies API seems to fail to set cookies, but features a redir.</li>
</ul>

<h3><a id="user-content-desired-features" class="anchor" href="#desired-features" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Desired Features</h3>

<ul>
<li>POST / PUT / DELETE!</li>
<li>POST with streaming upload</li>
<li>Get with streaming download</li>
<li>HTTP Basic Authentication, at least.</li>
<li>Proxying</li>
</ul>

<h3><a id="user-content-does-this-depend-on-anything" class="anchor" href="#does-this-depend-on-anything" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Does this depend on anything?</h3>

<p>Nope. This is valid pure-stdlib python as of Python 3.3+.</p>
</article>
  </div></body></html>