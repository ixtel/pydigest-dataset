<html><body><div><div id="content">
            <h1>GUI Automation With Python</h1>
            <p class="info">
    Posted on July 14, 2015
    
</p>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="hugo_dc">Tweet</a>

<p>Some of my late requirements needed to do a lot of steps manually, a set of repetitive actions to be done.</p>
<p>But we are developers, we automate repetitive stuff. You can create a program in one hour or two, and avoid 10 hours of manual labor.</p>

<p>We are always creating scripts (Python, Bash, Ruby, etc) to automate our tasks and make our life easier. But usually the stuff we automate are the ones that we can run in a console, but sometimes we need to automate the interaction with a GUI.</p>
<p>In this post I will show you some Python modules that can be very helpful when you need to automate GUI interaction.</p>
<hr/>
<h1 id="mouse-automation-autopy">Mouse Automation [Autopy]</h1>
<p>The python module I use for mouse automation is <a href="https://github.com/msanders/autopy/">Autopy</a>,</p>
<p>You can install this module with:</p>
<pre><code>easy_install autopy</code></pre>
<p>Here are the methods I usually use when I work with autopy:</p>
<p>Moving the mouse pointer:</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> autopy

autopy.mouse.move(x,y)</code></pre>
<p>Your mouse pointer will <em>teleport</em> to the <strong>x</strong> and <strong>y</strong> position.</p>
<p>I say <em>teleport</em> because the pointer gets immediately to the <strong>x</strong> and <strong>y</strong> position, you won’t see the pointer moving. If you want to see your pointer moving from a start position to a <strong>x/y</strong> position then you could use the <code>smooth_move</code> method.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> autopy 

autopy.mouse.smooth_move(x,y)</code></pre>
<p>You see the mouse pointer moving (veeeery slow) in your screen until it gets to the <strong>x</strong> and <strong>y</strong> position.</p>
<p>If you really need your pointer to move from one point to another (i.e. If you want to select something), you can do that, moving point by point until you reach the final point:</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> select(ax, ay, bx, by):
    <span class="co"># Move to the start position</span>
    move(ax,ay)

    <span class="co"># Click in the start position </span>
    autopy.mouse.toggle(<span class="ot">True</span>)

    <span class="co"># Wait 0.8 seconds before moving </span>
    time.sleep(<span class="fl">0.8</span>)
    <span class="dt">print</span> <span class="st">"Moving..."</span>
    x = ax 
    y = ay 

    <span class="co"># Increment x and y by one</span>
    <span class="co"># This will move to the next position </span>
    <span class="co"># Stops when it gets the desired position </span>
    <span class="kw">while</span> x &lt; bx or y &lt; by: 
        <span class="kw">if</span> x &lt; bx: x += <span class="dv">1</span> 
        <span class="kw">if</span> y &lt; by: y += <span class="dv">1</span>
        autopy.mouse.move(x,y)

    <span class="co"># Release the mouse button</span>
    autopy.mouse.toggle(<span class="ot">False</span>)</code></pre>
<p>In the example above, we see another method <code>autopy.mouse.toggle</code>, this method allows to click in some point and hold it until you want to release it.</p>
<hr/>
<h1 id="keyboard-automation-windows-win32com">Keyboard Automation (Windows) [win32com]</h1>
<p>You can send keys as if it comes from a keyboard using win32com. Here is an example:</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> win32com.client <span class="ch">as</span> client

shell = client.Dispatch(<span class="st">"WScript.Shell"</span>)

shell.sendKeys(key)</code></pre>
<p>In <a href="http://ss64.com/vb/sendkeys.html">this site: http://ss64.com/vb/sendkeys.html</a> you can find how to send special keys such as INSERT, ENTER, etc.</p>
<hr/>
<h1 id="other-resources">Other resources</h1>
<h2 id="check-current-window-windows-win32gui">Check Current Window (Windows) [win32gui]</h2>
<p>Using the mouse automation you can operate GUI programs, in my case when I clicked a button in my program I had to wait until the program returns a result, when the program returned a result a little pop up appeared on the screen, so I needed to figure out how my script could know when that little pop up is visible.</p>
<p>To do this I used module win32gui:</p>
<pre class="sourceCode python"><code class="sourceCode python">title = win32gui.GetWindowText(win32gui.GetForegroundWindow())

<span class="kw">if</span> title == POPUP_TITLE:
    <span class="co"># continue_processing...</span></code></pre>
<h2 id="clipboard-tk">Clipboard [Tk]</h2>
<p>Once the popup is in my screen I can copy the result (in my case the number of records found in a SAP table), y selected the result using mouse methods from <strong>autopy</strong>, I send CTRL + C keys using <strong>win32com</strong>. And I imported the value from the Clipboard to my script using Tk:</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">from</span> Tkinter <span class="ch">import</span> Tk

tk = Tk()

clipboard = tk.clipboard_get()

<span class="kw">if</span> <span class="dt">int</span>(clipboard) == <span class="dv">0</span>:
    <span class="co"># If no record found do something</span></code></pre>
<p>And that’s it. I hope you like this post, if you have a comment or question please let me know (You can find my twitter account at the top of the page).</p>


<ins class="adsbygoogle" data-ad-client="ca-pub-8677519572293483" data-ad-slot="3192662842" data-ad-format="auto"/>


        </div>
        </div></body></html>