<html><body><div><div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<h1> <span class="mw-headline" id="Python_3_as_the_Default_Implementation"> Python 3 as the Default Implementation </span></h1>
<h2> <span class="mw-headline" id="Summary"> Summary </span></h2>
<p>Up until now, Fedora has used Python 2 as the default Python implementation. This change proposes switching to Python 3. The details of the term "switching" are explained thoroughly in the <a href="#Scope">Scope</a> section.
</p>
<h2> <span class="mw-headline" id="Owner"> Owner </span></h2>

<h2> <span class="mw-headline" id="Current_status"> Current status </span></h2>

<h2> <span class="mw-headline" id="Detailed_Description"> Detailed Description </span></h2>
<p>Python 3 is the next generation of Python programming language. It is currently mature and stable, since it has been under active development for five years - version 3.0 was released in December 2008, current latest stable version is 3.4.3 released in February 2015. The main reason to switch to Python 3 as the default implementation is that Python 2 is in maintenance mode, thus only bugfixes and security fixes are accepted upstream. Further reasons are mentioned in the <a href="#Benefit_to_Fedora">Benefit to Fedora</a> section.
For this Change to be carried out successfully, it is necessary that the key packages in the Fedora software stack be ported to Python 3. These are parts of the minimal buildroot, the default package manager, programs present on the LiveCD etc. More information on the packages involved can be found in <a href="#Dependencies">Dependencies</a>. While porting of some packages is rather trivial, other packages need significant amount of work to get rid of the Python 2 dependence.
</p>
<h2> <span class="mw-headline" id="Benefit_to_Fedora"> Benefit to Fedora </span></h2>
<p>Python 2.7 (latest Python 2 release, which we also have in Fedora) is currently in maintenance mode only, which means upstream only accepts bugfixes and security fixes, but no new features are being implemented. Python 2.7 is <a class="external text" href="https://www.python.org/dev/peps/pep-0404/">the last minor release of Python 2</a>, with upstream support <a class="external text" href="https://www.python.org/dev/peps/pep-0373/#maintenance-releases">until 2020</a>. Python 3, on the other hand, is actively developed and new features are being added every release. Moreover, there is currently no end of support date for Python 3.
</p><p>Fedora already has Python 3 stack that is parallel to Python 2 stack. There are several benefits of switching the "primary" Python stack:
</p>
<ul><li> Getting upstream support for default system version will not be limited by time.
</li><li> Our system tools will be able to switch to Python 3, drop the burden of Python 2 support and use new features of Python 3.
</li><li> As a distribution that stays close to upstream, Fedora should help Python community go forward by contributing patches and working closely with upstreams to get this accomplished. Thus this Change is meant to benefit not only Fedora, but also broader Python community.
</li><li> Switching to Python 3 as a default will once again push Fedora to stay as close to upstream as possible, highlighting the "Features" and "First" (although, to be honest, Arch Linux was first in this...)
</li></ul>
<h2> <span class="mw-headline" id="Scope"> Scope </span></h2>
<p>The main goal is switching to Python 3 as a default, in which state:
</p>
<ul><li> DNF is the default package manager instead of Yum, which only works with Python 2
</li><li> Python 3 is the only Python implementation in the minimal buildroot (already done since F22)
</li><li> Python 3 is the only Python implementation on the Workstation LiveDVD
</li><li> Python 3 is the only Python implementation in minimal cloud image
</li><li> Python 3 is the only Python implementation in Atomic host
</li><li> It'd also be nice to have Python 3 as the only implementation on the Server LiveDVD, but it's not likely
</li></ul>
<p>(see <a href="#Dependencies">Dependencies</a> for the list of packages that need to be ported)
</p><p><br/>
Changes in packaging:
</p>
<ul><li> Change definition of default python interpreter to python3.
</li><li> Change unversioned python macros to python3 (Possibly do that change in <a class="external text" href="http://rpm.org/ticket/884">upstream rpm</a>)
</li><li> All applications that use only a single python version MUST use python3 (unless they have a good reason not to do so).
</li></ul>
<p>Fate of /usr/bin/python:
</p>
<ul><li> /usr/bin/python will still point to Python2 version of interpreter as suggested in <a class="external text" href="https://www.python.org/dev/peps/pep-0394/">PEP0394</a>.
</li><li> There will be no /usr/bin/python on LiveDVD as python3 will became the only python interpreter shipped by default.
</li><li> Python (python2 version of the interpreter) package will be still available (via dnf install) and will provide /usr/bin/python.
</li></ul>
<p><br/>
</p><p>There are basically two types of packages that need to undergo the conversion:
</p>
<ul><li> "libraries" - Python extension modules and libraries that provide Python bindings - assuming that there is upstream support, these can receive python3- subpackage any time without any damage to Fedora; we can then just utilize this subpackage when switching to Python 3 (instead of using current python- subpackage).
</li><li> "applications" - Packages that build with some sort of "embedded Python support", like gdb, or Rhythmbox with its plugins. In these cases, it makes no sense to do a python3- subpackage, since the whole package would need to be duplicated (e.g. python3-gdb). These packages should be built with Python 3 in Fedora 23 rawhide as soon as possible.
</li></ul>
<h3> <span class="mw-headline" id="Work_in_Fedora_21_Timeframe"> Work in Fedora 21 Timeframe </span></h3>
<ul><li> Proposal owners:
<ul><li> Discussing changes in Python packaging guidelines with Fedora community and FPC
</li><li> Helping upstreams with porting to Python 3
</li><li> Introducing python3- packages where appropriate, testing packages that only build with Python once (e.g. gdb, Rhythmbox)
</li></ul>
</li></ul>
<ul><li> Other developers:
<ul><li> Hopefully the same as proposal owners.
</li></ul>
</li></ul>


<h3> <span class="mw-headline" id="Work_in_Fedora_22_Timeframe"> Work in Fedora 22 Timeframe </span></h3>
<ul><li> Proposal owners:
<ul><li> Discussing changes in Python packaging guidelines with Fedora community and FPC
</li><li> Helping upstreams with porting to Python 3
</li><li> Introducing python3- packages where appropriate, testing packages that only build with Python once (e.g. gdb, Rhythmbox)
</li></ul>
</li></ul>
<ul><li> Other developers:
<ul><li> Hopefully the same as proposal owners.
</li></ul>
</li></ul>


<h3> <span class="mw-headline" id="Work_in_Fedora_23_Timeframe"> Work in Fedora 23 Timeframe </span></h3>
<ul><li> Proposal owners:
<ul><li> Continue the work from F21 and F22 timeframe
</li><li> Modify comps accordingly
</li><li> Apply the changes to Python packaging guidelines
</li></ul>
</li></ul>
<ul><li> Other developers:
<ul><li> Introduce python3- subpackages where appropriate, build against Python 3 if the package supports it
</li></ul>
</li></ul>

<ul><li> Policies and guidelines:
<ul><li> TODO: changes in packaging
</li></ul>
</li></ul>
<h2> <span class="mw-headline" id="Upgrade.2Fcompatibility_impact"> Upgrade/compatibility impact </span></h2>
<p>The Python 2 stack will stay in Fedora, it will just not be the default one. Depending on the modifications done to Python packaging guidelines, this probably means that Python 2 packages will stay the way they are and default tools will drag in python3- dependencies. Upstream recommends that /usr/bin/python point to Python 2 runtime for the time being, so if we go with that, there shouldn't be any serious compatibility impact:
</p>
<ul><li> Users will still be able to install Python 2 packages
</li><li> Both Python 2 and 3 stacks will still live in parallel
</li></ul>
<p>Libraries that are built with Python only once (like gdb) may force users to rewrite their custom scripts and plugins (see e.g. <a class="external free" href="https://bugzilla.redhat.com/show_bug.cgi?id=1014549#c3">https://bugzilla.redhat.com/show_bug.cgi?id=1014549#c3</a>).
</p>
<h2> <span class="mw-headline" id="How_To_Test"> How To Test </span></h2>
<ul><li> No special hardware is needed.
</li><li> Install Fedora 23 in mock/virtual machine and test if everything still works, most importantly system tools like DNF or Firewalld.
</li><li> Test installing the system with Anaconda running on Python 3.
</li></ul>
<h2> <span class="mw-headline" id="User_Experience"> User Experience </span></h2>
<p>Users shouldn't notice any changes, except that packages in minimal buildroot and on LiveCD will be python3-, not python-. Anaconda deps will be python3- as well. /usr/bin/python will still point to Python 2 and depending on result of discussions with FPC, "yum install python-foo" will still install Python 2 version of the package.
</p>
<h2> <span class="mw-headline" id="Dependencies"> Dependencies </span></h2>
<p>See <a class="external free" href="https://fedoraproject.org/wiki/User:Churchyard/python3">https://fedoraproject.org/wiki/User:Churchyard/python3</a> (our tracking page with notes) or <a class="external free" href="https://bugzilla.redhat.com/show_bug.cgi?id=1014209">https://bugzilla.redhat.com/show_bug.cgi?id=1014209</a> (tracking bug).
</p>
<h2> <span class="mw-headline" id="Contingency_Plan"> Contingency Plan </span></h2>
<ul><li> Contingency mechanism: None needed. Packages that will be ready will be built with Python 3, the rest will be ported in next release.
</li><li> Contingency deadline: Software string freeze
</li><li> Blocks release? No
</li></ul>
<h2> <span class="mw-headline" id="Documentation"> Documentation </span></h2>
<p><a class="external free" href="https://docs.python.org/3.0/whatsnew/3.0.html">https://docs.python.org/3.0/whatsnew/3.0.html</a>
</p><p><a class="external free" href="https://docs.python.org/3.1/whatsnew/3.1.html">https://docs.python.org/3.1/whatsnew/3.1.html</a>
</p><p><a class="external free" href="https://docs.python.org/3.2/whatsnew/3.2.html">https://docs.python.org/3.2/whatsnew/3.2.html</a>
</p><p><a class="external free" href="https://docs.python.org/3.3/whatsnew/3.3.html">https://docs.python.org/3.3/whatsnew/3.3.html</a>
</p><p><a class="external free" href="https://docs.python.org/3.4/whatsnew/3.4.html">https://docs.python.org/3.4/whatsnew/3.4.html</a>
</p><p><a class="external free" href="https://docs.python.org/3.5/whatsnew/3.5.html">https://docs.python.org/3.5/whatsnew/3.5.html</a>
</p><p><a class="external free" href="http://en.wikipedia.org/wiki/History_of_Python#Version_3.0">http://en.wikipedia.org/wiki/History_of_Python#Version_3.0</a>
</p><p><a class="external free" href="http://docs.python.org/dev/howto/pyporting.html">http://docs.python.org/dev/howto/pyporting.html</a>
</p><p><a class="external free" href="http://docs.python.org/3/howto/cporting.html">http://docs.python.org/3/howto/cporting.html</a>
</p><p><a class="external free" href="https://wiki.gnome.org/PyGObject/IntrospectionPorting">https://wiki.gnome.org/PyGObject/IntrospectionPorting</a>
</p><p><a class="external free" href="https://lwn.net/Articles/426906/">https://lwn.net/Articles/426906/</a>
</p><p><a class="external free" href="https://lwn.net/Articles/650904/">https://lwn.net/Articles/650904/</a>
</p>
<h2> <span class="mw-headline" id="Release_Notes"> Release Notes </span></h2>




</div></div></body></html>