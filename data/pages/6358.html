<html><body><div><div class="post-text" itemprop="text">
<p>Yes, this should work, although with the caveat that you'll need to change parallel_connection.py in that talk that you site.  In that code there's a <code>fetchall</code> function which executes each of the cursors in parallel, then combines the results.  This is the core of what you'll change:</p>

<p>Old Code:</p>

<pre><code>def fetchall(self):
    results = [None] * len(self.cursors)
    def do_work(index, cursor):
        results[index] = cursor.fetchall()
    self._do_parallel(do_work)
    return list(chain(*[rs for rs in results]))
</code></pre>

<p>New Code:</p>

<pre><code>def fetchall(self):
    results = [None] * len(self.sql_connections)
    def do_work(index, sql_connection):
        sql, conn = sql_connection  #  Store tuple of sql/conn instead of cursor
        results[index] = pd.read_sql(sql, conn)
    self._do_parallel(do_work)
    return pd.DataFrame().append([rs for rs in results])
</code></pre>

<p>Repo:  <a href="https://github.com/godatadriven/ParallelConnection" rel="nofollow">https://github.com/godatadriven/ParallelConnection</a></p>
    </div>
    </div></body></html>