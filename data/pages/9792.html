<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-meza-a-python-toolkit-for-processing-tabular-data" class="anchor" href="#meza-a-python-toolkit-for-processing-tabular-data" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>meza: A Python toolkit for processing tabular data</h1>
<p><a href="https://travis-ci.org/reubano/meza"><img alt="travis" src="https://camo.githubusercontent.com/d66a05ab066117def82ea70942fcb8c12d0507ca/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f72657562616e6f2f6d657a612f6d61737465722e737667" data-canonical-src="https://img.shields.io/travis/reubano/meza/master.svg"/>
</a> <a href="https://pypi.python.org/pypi/meza"><img alt="versions" src="https://camo.githubusercontent.com/1c88b7f439333508dfc0f73cbe7c6da90e3e5b81/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f6d657a612e737667" data-canonical-src="https://img.shields.io/pypi/pyversions/meza.svg"/>
</a> <a href="https://pypi.python.org/pypi/meza"><img alt="pypi" src="https://camo.githubusercontent.com/1c879e7581c2751f006b28c3684f7963e8ba23ec/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6d657a612e737667" data-canonical-src="https://img.shields.io/pypi/v/meza.svg"/>
</a></p>
<a name="user-content-index"/>
<h2><a id="user-content-index" class="anchor" href="#index" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Index</h2>
<p><a href="#introduction">Introduction</a> | <a href="#requirements">Requirements</a> | <a href="#motivation">Motivation</a> | <a href="#hello-world">Hello World</a> | <a href="#usage">Usage</a> | <a href="#interoperability">Interoperability</a> |
<a href="#installation">Installation</a> | <a href="#project-structure">Project Structure</a> | <a href="#design-principles">Design Principles</a> | <a href="#scripts">Scripts</a> |
<a href="#contributing">Contributing</a> | <a href="#credits">Credits</a> | <a href="#more-info">More Info</a> | <a href="#license">License</a></p>
<a name="user-content-introduction"/>
<h2><a id="user-content-introduction" class="anchor" href="#introduction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Introduction</h2>
<p><strong>meza</strong> is a Python <a href="#usage">library</a> for reading and processing tabular data.
It has a functional programming style API, excels at reading/writing large files,
and can process 10+ file types.</p>
<p>With meza, you can</p>
<ul>
<li>Read csv/xls/xlsx/mdb/dbf files, and more!</li>
<li>Type cast records (date, float, text...)</li>
<li>Process Uñicôdë text</li>
<li>Lazily stream files by default</li>
<li>and much more...</li>
</ul>
<a name="user-content-requirements"/>
<h2><a id="user-content-requirements" class="anchor" href="#requirements" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Requirements</h2>
<p>meza has been tested and is known to work on Python 2.7, 3.4, and 3.5;
PyPy 4.0; and PyPy3 2.4</p>
<a name="user-content-optional-dependencies"/>
<h3><a id="user-content-optional-dependencies" class="anchor" href="#optional-dependencies" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Optional Dependencies</h3>
<table>






<thead valign="bottom">
<tr><th>Function</th>
<th>Dependency</th>
<th>Installation</th>
<th>File type / extension</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><code>meza.io.read_mdb</code></td>
<td><a href="http://sourceforge.net/projects/mdbtools/">mdbtools</a></td>
<td><code>sudo port install mdbtools</code></td>
<td>Microsoft Access / mdb</td>
</tr>
<tr><td><code>meza.io.read_html</code></td>
<td><a href="http://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-a-parser">lxml</a> <a href="#id3" id="user-content-id1">[1]</a></td>
<td><code>pip install lxml</code></td>
<td>HTML / html</td>
</tr>
<tr><td><code>meza.convert.records2array</code></td>
<td><a href="https://github.com/numpy/numpy">NumPy</a> <a href="#id4" id="user-content-id2">[2]</a></td>
<td><code>pip install numpy</code></td>
<td>n/a</td>
</tr>
<tr><td><code>meza.convert.records2df</code></td>
<td><a href="https://github.com/pydata/pandas">pandas</a></td>
<td><code>pip install pandas</code></td>
<td>n/a</td>
</tr>
</tbody>
</table>
<a name="user-content-notes"/>
<h3><a id="user-content-notes" class="anchor" href="#notes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Notes</h3>
<table frame="void" id="user-content-id3" rules="none">

<tbody valign="top">
<tr><td><a href="#id1">[1]</a></td><td>If <code>lxml</code> isn't present, <code>read_html</code> will default to the builtin Python html reader</td></tr>
</tbody>
</table>
<table frame="void" id="user-content-id4" rules="none">

<tbody valign="top">
<tr><td><a href="#id2">[2]</a></td><td><code>records2array</code> can be used without <code>numpy</code> by passing <code>native=True</code> in the function call. This will convert <code>records</code> into a list of native <code>array.array</code> objects.</td></tr>
</tbody>
</table>
<a name="user-content-motivation"/>
<h2><a id="user-content-motivation" class="anchor" href="#motivation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Motivation</h2>
<a name="user-content-why-i-built-meza"/>
<h3><a id="user-content-why-i-built-meza" class="anchor" href="#why-i-built-meza" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Why I built meza</h3>
<p>pandas is great, but installing it isn't exactly a <a href="http://pandas.pydata.org/pandas-docs/stable/install.html#installing-pandas-with-anaconda">walk in the park</a>, and it
doesn't play nice with <a href="https://github.com/pydata/pandas/issues/9532">PyPy</a>. I designed <strong>meza</strong> to be a lightweight, easy to install, less featureful alternative to
pandas. I also optimized <strong>meza</strong> for low memory usage, PyPy compatibility, and functional programming best practices.</p>
<a name="user-content-why-you-should-use-meza"/>
<h3><a id="user-content-why-you-should-use-meza" class="anchor" href="#why-you-should-use-meza" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Why you should use meza</h3>
<p><code>meza</code> provides a number of benefits / differences from libraries such as <code>pandas</code> and the like. Namely:</p>

<p>For more detailed information, please check-out the <a href="https://github.com/reubano/meza/blob/master/docs/FAQ.rst">FAQ</a>.</p>
<a name="user-content-hello-world"/>
<h2><a id="user-content-hello-world" class="anchor" href="#hello-world" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Hello World</h2>
<p>A simple data processing example is shown below:</p>
<p>First create a simple csv file (in bash)</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>col1,col2,col3\nhello,5/4/82,1\none,1/1/15,2\nhappy,7/1/92,3\n<span class="pl-pds">'</span></span> <span class="pl-k">&gt;</span> data.csv</pre></div>
<p>Now we can read the file, manipulate the data a bit, and write the manipulated
data back to a new file.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> meza <span class="pl-k">import</span> io, process <span class="pl-k">as</span> pr, convert <span class="pl-k">as</span> cv
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> io <span class="pl-k">import</span> <span class="pl-c1">open</span>

<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c"># Load the csv file</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> io.read_csv(<span class="pl-s"><span class="pl-pds">'</span>data.csv<span class="pl-pds">'</span></span>)

<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c"># `records` are iterators over the rows</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> row <span class="pl-k">=</span> <span class="pl-c1">next</span>(records)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> row
{<span class="pl-s"><span class="pl-pds">'</span>col1<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>hello<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>5/4/82<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col3<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>1<span class="pl-pds">'</span></span>}

<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c"># Let's replace the first row so as not to lose any data</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> pr.prepend(records, row)

<span class="pl-c"># Guess column types. Note: `detect_types` returns a new `records`</span>
<span class="pl-c"># generator since it consumes rows during type detection</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records, result <span class="pl-k">=</span> pr.detect_types(records)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> {t[<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>]: t[<span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span>] <span class="pl-k">for</span> t <span class="pl-k">in</span> result[<span class="pl-s"><span class="pl-pds">'</span>types<span class="pl-pds">'</span></span>]}
{<span class="pl-s"><span class="pl-pds">'</span>col1<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>text<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>date<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col3<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>int<span class="pl-pds">'</span></span>}

<span class="pl-c"># Now type cast the records. Note: most `meza.process` functions return</span>
<span class="pl-c"># generators, so lets wrap the result in a list to view the data</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> casted <span class="pl-k">=</span> <span class="pl-c1">list</span>(pr.type_cast(records, result[<span class="pl-s"><span class="pl-pds">'</span>types<span class="pl-pds">'</span></span>]))
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> casted[<span class="pl-c1">0</span>]
{<span class="pl-s"><span class="pl-pds">'</span>col1<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>hello<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col2<span class="pl-pds">'</span></span>: datetime.date(<span class="pl-c1">1982</span>, <span class="pl-c1">5</span>, <span class="pl-c1">4</span>), <span class="pl-s"><span class="pl-pds">'</span>col3<span class="pl-pds">'</span></span>: <span class="pl-c1">1</span>}

<span class="pl-c"># Cut out the first column of data and merge the rows to get the max value</span>
<span class="pl-c"># of the remaining columns. Note: since `merge` (by definition) will always</span>
<span class="pl-c"># contain just one row, it is returned as is (not wrapped in a generator)</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> cut_recs <span class="pl-k">=</span> pr.cut(casted, [<span class="pl-s"><span class="pl-pds">'</span>col1<span class="pl-pds">'</span></span>], <span class="pl-v">exclude</span><span class="pl-k">=</span><span class="pl-c1">True</span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> merged <span class="pl-k">=</span> pr.merge(cut_recs, <span class="pl-v">pred</span><span class="pl-k">=</span><span class="pl-c1">bool</span>, <span class="pl-v">op</span><span class="pl-k">=</span><span class="pl-c1">max</span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> merged
{<span class="pl-s"><span class="pl-pds">'</span>col2<span class="pl-pds">'</span></span>: datetime.date(<span class="pl-c1">2015</span>, <span class="pl-c1">1</span>, <span class="pl-c1">1</span>), <span class="pl-s"><span class="pl-pds">'</span>col3<span class="pl-pds">'</span></span>: <span class="pl-c1">3</span>}

<span class="pl-c"># Now write merged data back to a new csv file.</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> io.write(<span class="pl-s"><span class="pl-pds">'</span>out.csv<span class="pl-pds">'</span></span>, cv.records2csv(merged))

<span class="pl-c"># View the result</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>out.csv<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>utf-8<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> f:
<span class="pl-c1">...</span>     f.read()
<span class="pl-s"><span class="pl-pds">'</span>col2,col3<span class="pl-cce">\n</span>2015-01-01,3<span class="pl-cce">\n</span><span class="pl-pds">'</span></span></pre></div>
<a name="user-content-usage"/>
<h2><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h2>
<p>meza is intended to be used directly as a Python library.</p>
<a name="user-content-usage-index"/>
<h3><a id="user-content-usage-index" class="anchor" href="#usage-index" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage Index</h3>

<a name="user-content-reading-data"/>
<h3><a id="user-content-reading-data" class="anchor" href="#reading-data" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Reading data</h3>
<p>meza can read both filepaths and file-like objects. Additionally, all readers
return equivalent records iterators, i.e., a generator of dictionaries with
keys corresponding to the column names.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> io <span class="pl-k">import</span> <span class="pl-c1">open</span>, StringIO
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> meza <span class="pl-k">import</span> io

<span class="pl-s"><span class="pl-pds">"""</span>Read a filepath<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> io.read_json(<span class="pl-s"><span class="pl-pds">'</span>path/to/file.json<span class="pl-pds">'</span></span>)

<span class="pl-s"><span class="pl-pds">"""</span>Read a file like object and de-duplicate the header<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> f <span class="pl-k">=</span> StringIO(<span class="pl-s"><span class="pl-pds">'</span>col,col<span class="pl-cce">\n</span>hello,world<span class="pl-cce">\n</span><span class="pl-pds">'</span></span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> io.read_csv(f, <span class="pl-v">dedupe</span><span class="pl-k">=</span><span class="pl-c1">True</span>)

<span class="pl-s"><span class="pl-pds">"""</span>View the first row<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(records)
{<span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>hello<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>world<span class="pl-pds">'</span></span>}

<span class="pl-s"><span class="pl-pds">"""</span>Read the 1st sheet of an xls file object opened in text mode.<span class="pl-pds">"""</span></span>
<span class="pl-c"># Also, santize the header names by converting them to lowercase and</span>
<span class="pl-c"># replacing whitespace and invalid characters with `_`.</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>path/to/file.xls<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>utf-8<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> f:
<span class="pl-c1">...</span>     <span class="pl-k">for</span> row <span class="pl-k">in</span> io.read_xls(f, <span class="pl-v">sanitize</span><span class="pl-k">=</span><span class="pl-c1">True</span>):
<span class="pl-c1">...</span>         <span class="pl-c"># do something with the `row`</span>
<span class="pl-c1">...</span>         <span class="pl-k">pass</span>

<span class="pl-s"><span class="pl-pds">"""</span>Read the 2nd sheet of an xlsx file object opened in binary mode<span class="pl-pds">"""</span></span>
<span class="pl-c"># Note: sheets are zero indexed</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>path/to/file.xlsx<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> f:
<span class="pl-c1">...</span>     records <span class="pl-k">=</span> io.read_xls(f, <span class="pl-v">encoding</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>utf-8<span class="pl-pds">'</span></span>, <span class="pl-v">sheet</span><span class="pl-k">=</span><span class="pl-c1">1</span>)
<span class="pl-c1">...</span>     first_row <span class="pl-k">=</span> <span class="pl-c1">next</span>(records)
<span class="pl-c1">...</span>     <span class="pl-c"># do something with the `first_row`</span>

<span class="pl-s"><span class="pl-pds">"""</span>Read any recognized file<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> io.read(<span class="pl-s"><span class="pl-pds">'</span>path/to/file.geojson<span class="pl-pds">'</span></span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> f.seek(<span class="pl-c1">0</span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> io.read(f, <span class="pl-v">ext</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>csv<span class="pl-pds">'</span></span>, <span class="pl-v">dedupe</span><span class="pl-k">=</span><span class="pl-c1">True</span>)</pre></div>
<p>Please see <a href="https://github.com/reubano/meza/blob/master/docs/FAQ.rst#whatreaders-are-available">readers</a> for a complete list of available readers and recognized
file types.</p>
<a name="user-content-processing-data"/>
<h3><a id="user-content-processing-data" class="anchor" href="#processing-data" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Processing data</h3>
<a name="user-content-numerical-analysis-a-la-pandas"/>
<h4><a id="user-content-numerical-analysis-à-la-pandas-3" class="anchor" href="#numerical-analysis-à-la-pandas-3" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Numerical analysis (à la pandas) <a href="#id9" id="user-content-id5">[3]</a></h4>
<p>In the following example, <code>pandas</code> equivalent methods are preceded by <code>--&gt;</code>.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">import</span> itertools <span class="pl-k">as</span> it
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">import</span> random

<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> io <span class="pl-k">import</span> StringIO
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> meza <span class="pl-k">import</span> io, process <span class="pl-k">as</span> pr, convert <span class="pl-k">as</span> cv, stats

<span class="pl-c"># Create some data in the same structure as what the various `read...`</span>
<span class="pl-c"># functions output</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> header <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>]
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> data <span class="pl-k">=</span> [(random.random() <span class="pl-k">for</span> _ <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">4</span>)) <span class="pl-k">for</span> x <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">7</span>)]
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> df <span class="pl-k">=</span> [<span class="pl-c1">dict</span>(<span class="pl-c1">zip</span>(header, d)) <span class="pl-k">for</span> d <span class="pl-k">in</span> data]
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> df[<span class="pl-c1">0</span>]
{<span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>: <span class="pl-c1">0.53908</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>: <span class="pl-c1">0.28919</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>: <span class="pl-c1">0.03003</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>: <span class="pl-c1">0.65363</span><span class="pl-c1">...</span>}

<span class="pl-s"><span class="pl-pds">"""</span>Sort records by the value of column `B` --&gt; df.sort_values(by='B')<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(pr.sort(df, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>))
{<span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>: <span class="pl-c1">0.53520</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>: <span class="pl-c1">0.06763</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>: <span class="pl-c1">0.02351</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>: <span class="pl-c1">0.80529</span><span class="pl-c1">...</span>}

<span class="pl-s"><span class="pl-pds">"""</span>Select column `A` --&gt; df['A']<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(pr.cut(df, [<span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>]))
{<span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>: <span class="pl-c1">0.53908170489952006</span>}

<span class="pl-s"><span class="pl-pds">"""</span>Select the first three rows of data --&gt; df[0:3]<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">len</span>(<span class="pl-c1">list</span>(it.islice(df, <span class="pl-c1">3</span>)))
<span class="pl-c1">3</span>

<span class="pl-s"><span class="pl-pds">"""</span>Select all data whose value for column `A` is less than 0.5</span>
<span class="pl-s">--&gt; df[df.A &lt; 0.5]</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(pr.tfilter(df, <span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>, <span class="pl-k">lambda</span> <span class="pl-smi">x</span>: x <span class="pl-k">&lt;</span> <span class="pl-c1">0.5</span>))
{<span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>: <span class="pl-c1">0.21000</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>: <span class="pl-c1">0.25727</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>: <span class="pl-c1">0.39719</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>: <span class="pl-c1">0.64157</span><span class="pl-c1">...</span>}

<span class="pl-c"># Note: since `aggregate` and `merge` (by definition) return just one row,</span>
<span class="pl-c"># they return them as is (not wrapped in a generator).</span>
<span class="pl-s"><span class="pl-pds">"""</span>Calculate the mean of column `A` across all data --&gt; df.mean()['A']<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> pr.aggregate(df, <span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>, stats.mean)[<span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>]
<span class="pl-c1">0.5410437473067938</span>

<span class="pl-s"><span class="pl-pds">"""</span>Calculate the sum of each column across all data --&gt; df.sum()<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> pr.merge(df, <span class="pl-v">pred</span><span class="pl-k">=</span><span class="pl-c1">bool</span>, <span class="pl-v">op</span><span class="pl-k">=</span><span class="pl-c1">sum</span>)
{<span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>: <span class="pl-c1">3.78730</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>: <span class="pl-c1">2.82875</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>: <span class="pl-c1">3.14195</span><span class="pl-c1">...</span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>: <span class="pl-c1">5.26330</span><span class="pl-c1">...</span>}</pre></div>
<a name="user-content-text-processing-a-la-csvkit"/>
<h4><a id="user-content-text-processing-à-la-csvkit-4" class="anchor" href="#text-processing-à-la-csvkit-4" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Text processing (à la csvkit) <a href="#id10" id="user-content-id6">[4]</a></h4>
<p>In the following example, <code>csvkit</code> equivalent commands are preceded by <code>--&gt;</code>.</p>
<p>First create a few simple csv files (in bash)</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>col_1,col_2,col_3\n1,dill,male\n2,bob,male\n3,jane,female<span class="pl-pds">'</span></span> <span class="pl-k">&gt;</span> file1.csv
<span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>col_1,col_2,col_3\n4,tom,male\n5,dick,male\n6,jill,female<span class="pl-pds">'</span></span> <span class="pl-k">&gt;</span> file2.csv</pre></div>
<p>Now we can read the files, manipulate the data, convert the manipulated data to
json, and write the json back to a new file. Also, note that since all readers
return equivalent records iterators, you can use them interchangeably (in
place of <code>read_csv</code>) to open any supported file. E.g., <code>read_xls</code>,
<code>read_sqlite</code>, etc.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">import</span> itertools <span class="pl-k">as</span> it

<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> meza <span class="pl-k">import</span> io, process <span class="pl-k">as</span> pr, convert <span class="pl-k">as</span> cv

<span class="pl-s"><span class="pl-pds">"""</span>Combine the files into one iterator</span>
<span class="pl-s">--&gt; csvstack file1.csv file2.csv</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> io.join(<span class="pl-s"><span class="pl-pds">'</span>file1.csv<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>file2.csv<span class="pl-pds">'</span></span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(records)
{<span class="pl-s"><span class="pl-pds">'</span>col_1<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>dill<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_3<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>male<span class="pl-pds">'</span></span>}
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(it.islice(records, <span class="pl-c1">4</span>, <span class="pl-c1">None</span>))
{<span class="pl-s"><span class="pl-pds">'</span>col_1<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>6<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>jill<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_3<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>female<span class="pl-pds">'</span></span>}

<span class="pl-c"># Now let's create a persistant records list</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> <span class="pl-c1">list</span>(io.read_csv(<span class="pl-s"><span class="pl-pds">'</span>file1.csv<span class="pl-pds">'</span></span>))

<span class="pl-s"><span class="pl-pds">"""</span>Sort records by the value of column `col_2`</span>
<span class="pl-s">--&gt; csvsort -c col_2 file1.csv</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(pr.sort(records, <span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>))
{<span class="pl-s"><span class="pl-pds">'</span>col_1<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>bob<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_3<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>male<span class="pl-pds">'</span></span>

<span class="pl-s"><span class="pl-pds">"""</span>Select column `col_2` --&gt; csvcut -c col_2 file1.csv<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(pr.cut(records, [<span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>]))
{<span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>dill<span class="pl-pds">'</span></span>}

<span class="pl-s"><span class="pl-pds">"""</span>Select all data whose value for column `col_2` contains `jan`</span>
<span class="pl-s">--&gt; csvgrep -c col_2 -m jan file1.csv</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(pr.grep(records, [{<span class="pl-s"><span class="pl-pds">'</span>pattern<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>jan<span class="pl-pds">'</span></span>}], [<span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>]))
{<span class="pl-s"><span class="pl-pds">'</span>col_1<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>jane<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col_3<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>female<span class="pl-pds">'</span></span>}

<span class="pl-s"><span class="pl-pds">"""</span>Convert a csv file to json --&gt; csvjson -i 4 file1.csv<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> io.write(<span class="pl-s"><span class="pl-pds">'</span>file.json<span class="pl-pds">'</span></span>, cv.records2json(records))

<span class="pl-c"># View the result</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>file.json<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>utf-8<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> f:
<span class="pl-c1">...</span>     f.read()
<span class="pl-s"><span class="pl-pds">'</span>[{"col_1": "1", "col_2": "dill", "col_3": "male"}, {"col_1": "2",<span class="pl-ii"/></span>
<span class="pl-s"><span class="pl-pds">"</span>col_2<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>bob<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>col_3<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>male<span class="pl-pds">"</span></span>}, {<span class="pl-s"><span class="pl-pds">"</span>col_1<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>3<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>col_2<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>jane<span class="pl-pds">"</span></span>,
<span class="pl-s"><span class="pl-pds">"</span>col_3<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>female<span class="pl-pds">"</span></span>}]<span class="pl-s"><span class="pl-pds">'</span><span class="pl-ii"/></span></pre></div>
<a name="user-content-geo-processing-a-la-mapbox"/>
<h4><a id="user-content-geo-processing-à-la-mapbox-5" class="anchor" href="#geo-processing-à-la-mapbox-5" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Geo processing (à la mapbox) <a href="#id11" id="user-content-id7">[5]</a></h4>
<p>In the following example, <code>mapbox</code> equivalent commands are preceded by <code>--&gt;</code>.</p>
<p>First create a geojson file (in bash)</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>{"type": "FeatureCollection","features": [<span class="pl-pds">'</span></span> <span class="pl-k">&gt;</span> file.geojson
<span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>{"type": "Feature", "id": 11, "geometry": {"type": "Point", "coordinates": [10, 20]}},<span class="pl-pds">'</span></span> <span class="pl-k">&gt;&gt;</span> file.geojson
<span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>{"type": "Feature", "id": 12, "geometry": {"type": "Point", "coordinates": [5, 15]}}]}<span class="pl-pds">'</span></span> <span class="pl-k">&gt;&gt;</span> file.geojson</pre></div>
<p>Now we can open the file, split the data by id, and finally convert the split data
to a new geojson file-like object.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> meza <span class="pl-k">import</span> io, process <span class="pl-k">as</span> pr, convert <span class="pl-k">as</span> cv

<span class="pl-c"># Load the geojson file and peek at the results</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records, peek <span class="pl-k">=</span> pr.peek(io.read_geojson(<span class="pl-s"><span class="pl-pds">'</span>file.geojson<span class="pl-pds">'</span></span>))
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> peek[<span class="pl-c1">0</span>]
{<span class="pl-s"><span class="pl-pds">'</span>lat<span class="pl-pds">'</span></span>: <span class="pl-c1">20</span>, <span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>Point<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>lon<span class="pl-pds">'</span></span>: <span class="pl-c1">10</span>, <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>: <span class="pl-c1">11</span>}

<span class="pl-s"><span class="pl-pds">"""</span>Split the records by feature ``id`` and select the first feature</span>
<span class="pl-s">--&gt; geojsplit -k id file.geojson</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> splits <span class="pl-k">=</span> pr.split(records, <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> feature_records, name <span class="pl-k">=</span> <span class="pl-c1">next</span>(splits)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> name
<span class="pl-c1">11</span>

<span class="pl-s"><span class="pl-pds">"""</span>Convert the feature records into a GeoJSON file-like object<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> geojson <span class="pl-k">=</span> cv.records2geojson(feature_records)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> geojson.readline()
<span class="pl-s"><span class="pl-pds">'</span>{"type": "FeatureCollection", "bbox": [10, 20, 10, 20], "features": <span class="pl-pds">'</span></span>
<span class="pl-s"><span class="pl-pds">'</span>[{"type": "Feature", "id": 11, "geometry": {"type": "Point", <span class="pl-pds">'</span></span>
<span class="pl-s"><span class="pl-pds">'</span>"coordinates": [10, 20]}, "properties": {"id": 11}}], "crs": {"type": <span class="pl-pds">'</span></span>
<span class="pl-s"><span class="pl-pds">'</span>"name", "properties": {"name": "urn:ogc:def:crs:OGC:1.3:CRS84"}}}<span class="pl-pds">'</span></span>

<span class="pl-c"># Note: you can also write back to a file as shown previously</span>
<span class="pl-c"># io.write('file.geojson', geojson)</span></pre></div>
<a name="user-content-writing-data"/>
<h3><a id="user-content-writing-data" class="anchor" href="#writing-data" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Writing data</h3>
<p>meza can persist <code>records</code> to disk via the following functions:</p>
<ul>
<li><code>meza.convert.records2csv</code></li>
<li><code>meza.convert.records2json</code></li>
<li><code>meza.convert.records2geojson</code></li>
</ul>
<p>Each function returns a file-like object that you can write to disk via
<code>meza.io.write('/path/to/file', result)</code>.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> meza <span class="pl-k">import</span> io, convert <span class="pl-k">as</span> cv
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> io <span class="pl-k">import</span> StringIO, <span class="pl-c1">open</span>

<span class="pl-c"># First let's create a simple tsv file like object</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> f <span class="pl-k">=</span> StringIO(<span class="pl-s"><span class="pl-pds">'</span>col1<span class="pl-cce">\t</span>col2<span class="pl-cce">\n</span>hello<span class="pl-cce">\t</span>world<span class="pl-cce">\n</span><span class="pl-pds">'</span></span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> f.seek(<span class="pl-c1">0</span>)

<span class="pl-c"># Next create a records list so we can reuse it</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> <span class="pl-c1">list</span>(io.read_tsv(f))
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records[<span class="pl-c1">0</span>]
{<span class="pl-s"><span class="pl-pds">'</span>col1<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>hello<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>col2<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>world<span class="pl-pds">'</span></span>}

<span class="pl-c"># Now we're ready to write the records data to file</span>

<span class="pl-s"><span class="pl-pds">"""</span>Create a csv file like object<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> cv.records2csv(records).readline()
<span class="pl-s"><span class="pl-pds">'</span>col1,col2<span class="pl-cce">\n</span><span class="pl-pds">'</span></span>

<span class="pl-s"><span class="pl-pds">"""</span>Create a json file like object<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> cv.records2json(records).readline()
<span class="pl-s"><span class="pl-pds">'</span>[{"col1": "hello", "col2": "world"}]<span class="pl-pds">'</span></span>

<span class="pl-s"><span class="pl-pds">"""</span>Write back csv to a filepath<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> io.write(<span class="pl-s"><span class="pl-pds">'</span>file.csv<span class="pl-pds">'</span></span>, cv.records2csv(records))
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>file.csv<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>utf-8<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> f_in:
<span class="pl-c1">...</span>     f_in.read()
<span class="pl-s"><span class="pl-pds">'</span>col1,col2<span class="pl-cce">\n</span>hello,world<span class="pl-cce">\n</span><span class="pl-pds">'</span></span>

<span class="pl-s"><span class="pl-pds">"""</span>Write back json to a filepath<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> io.write(<span class="pl-s"><span class="pl-pds">'</span>file.json<span class="pl-pds">'</span></span>, cv.records2json(records))
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>file.json<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>utf-8<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> f_in:
<span class="pl-c1">...</span>     f_in.readline()
<span class="pl-s"><span class="pl-pds">'</span>[{"col1": "hello", "col2": "world"}]<span class="pl-pds">'</span></span></pre></div>
<a name="user-content-cookbook"/>
<h3><a id="user-content-cookbook" class="anchor" href="#cookbook" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Cookbook</h3>
<p>Please see the <a href="https://github.com/reubano/meza/blob/master/docs/COOKBOOK.rst">cookbook guide</a> or ipython <a href="http://nbviewer.jupyter.org/github/reubano/meza/blob/master/examples/usage.ipynb">notebook</a> for more examples.</p>
<a name="user-content-id8"/>
<h3><a id="user-content-notes-1" class="anchor" href="#notes-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Notes</h3>



<a name="user-content-interoperability"/>
<h2><a id="user-content-interoperability" class="anchor" href="#interoperability" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Interoperability</h2>
<p>meza plays nicely with NumPy and friends out of the box</p>
<a name="user-content-setup"/>
<h3><a id="user-content-setup" class="anchor" href="#setup" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>setup</h3>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> meza <span class="pl-k">import</span> process <span class="pl-k">as</span> pr

<span class="pl-c"># First create some records and types. Also, convert the records to a list</span>
<span class="pl-c"># so we can reuse them.</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records <span class="pl-k">=</span> [{<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span>: <span class="pl-c1">2</span>}, {<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>five<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span>: <span class="pl-c1">10</span>, <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span>: <span class="pl-c1">20.1</span>}]
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records, result <span class="pl-k">=</span> pr.detect_types(records)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> records, types <span class="pl-k">=</span> <span class="pl-c1">list</span>(records), result[<span class="pl-s"><span class="pl-pds">'</span>types<span class="pl-pds">'</span></span>]
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> types
[
    {<span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>text<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>},
    {<span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>int<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span>},
    {<span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>float<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span>}]</pre></div>
<a name="user-content-from-records-to-pandas-dataframe-to-records"/>
<h3><a id="user-content-from-records-to-pandasdataframe-to-records" class="anchor" href="#from-records-to-pandasdataframe-to-records" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>from records to pandas.DataFrame to records</h3>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">import</span> pandas <span class="pl-k">as</span> pd
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> meza <span class="pl-k">import</span> convert <span class="pl-k">as</span> cv

<span class="pl-s"><span class="pl-pds">"""</span>Convert the records to a DataFrame<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> df <span class="pl-k">=</span> cv.records2df(records, types)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> df
        a   b   c
<span class="pl-c1">0</span>   one   <span class="pl-c1">2</span>   NaN
<span class="pl-c1">1</span>  five  <span class="pl-c1">10</span>  <span class="pl-c1">20.1</span>
<span class="pl-c"># Alternatively, you can do `pd.DataFrame(records)`</span>

<span class="pl-s"><span class="pl-pds">"""</span>Convert the DataFrame back to records<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(cv.df2records(df))
{<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span>: <span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span>: nan}</pre></div>
<a name="user-content-from-records-to-arrays-to-records"/>
<h3><a id="user-content-from-records-to-arrays-to-records" class="anchor" href="#from-records-to-arrays-to-records" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>from records to arrays to records</h3>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">import</span> numpy <span class="pl-k">as</span> np

<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> array <span class="pl-k">import</span> array
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> meza <span class="pl-k">import</span> convert <span class="pl-k">as</span> cv

<span class="pl-s"><span class="pl-pds">"""</span>Convert records to a structured array<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> recarray <span class="pl-k">=</span> cv.records2array(records, types)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> recarray
rec.array([(<span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span>, <span class="pl-c1">2</span>, nan), (<span class="pl-s"><span class="pl-pds">'</span>five<span class="pl-pds">'</span></span>, <span class="pl-c1">10</span>, <span class="pl-c1">20.100000381469727</span>)],
          <span class="pl-v">dtype</span><span class="pl-k">=</span>[(<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>O<span class="pl-pds">'</span></span>), (<span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&lt;i4<span class="pl-pds">'</span></span>), (<span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&lt;f4<span class="pl-pds">'</span></span>)])
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> recarray.b
array([ <span class="pl-c1">2</span>, <span class="pl-c1">10</span>], <span class="pl-v">dtype</span><span class="pl-k">=</span>int32)

<span class="pl-s"><span class="pl-pds">"""</span>Convert records to a native array<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> narray <span class="pl-k">=</span> cv.records2array(records, types, <span class="pl-v">native</span><span class="pl-k">=</span><span class="pl-c1">True</span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> narray
[[array(<span class="pl-s"><span class="pl-pds">'</span>u<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>), array(<span class="pl-s"><span class="pl-pds">'</span>u<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span>), array(<span class="pl-s"><span class="pl-pds">'</span>u<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span>)],
[array(<span class="pl-s"><span class="pl-pds">'</span>u<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span>), array(<span class="pl-s"><span class="pl-pds">'</span>u<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>five<span class="pl-pds">'</span></span>)],
array(<span class="pl-s"><span class="pl-pds">'</span>i<span class="pl-pds">'</span></span>, [<span class="pl-c1">2</span>, <span class="pl-c1">10</span>]),
array(<span class="pl-s"><span class="pl-pds">'</span>f<span class="pl-pds">'</span></span>, [<span class="pl-c1">0.0</span>, <span class="pl-c1">20.100000381469727</span>])]

<span class="pl-s"><span class="pl-pds">"""</span>Convert a 2-D NumPy array to a records generator<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> data <span class="pl-k">=</span> np.array([[<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>], [<span class="pl-c1">4</span>, <span class="pl-c1">5</span>, <span class="pl-c1">6</span>]], np.int32)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> data
array([[<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>],
       [<span class="pl-c1">4</span>, <span class="pl-c1">5</span>, <span class="pl-c1">6</span>]], <span class="pl-v">dtype</span><span class="pl-k">=</span>int32)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(cv.array2records(data))
{<span class="pl-s"><span class="pl-pds">'</span>column_1<span class="pl-pds">'</span></span>: <span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>column_2<span class="pl-pds">'</span></span>: <span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>column_3<span class="pl-pds">'</span></span>: <span class="pl-c1">3</span>}

<span class="pl-s"><span class="pl-pds">"""</span>Convert the structured array back to a records generator<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(cv.array2records(recarray))
{<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span>: <span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span>: nan}

<span class="pl-s"><span class="pl-pds">"""</span>Convert the native array back to records generator<span class="pl-pds">"""</span></span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">next</span>(cv.array2records(narray, <span class="pl-v">native</span><span class="pl-k">=</span><span class="pl-c1">True</span>))
{<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span>: <span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span>: <span class="pl-c1">0.0</span>}</pre></div>
<a name="user-content-installation"/>
<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>
<p>(You are using a <a href="http://www.virtualenv.org/en/latest/index.html">virtualenv</a>, right?)</p>
<p>At the command line, install meza using either <code>pip</code> (<em>recommended</em>)</p>

<p>or <code>easy_install</code></p>

<p>Please see the <a href="https://github.com/reubano/meza/blob/master/docs/INSTALLATION.rst">installation doc</a> for more details.</p>
<a name="user-content-project-structure"/>
<h2><a id="user-content-project-structure" class="anchor" href="#project-structure" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Project Structure</h2>
<div class="highlight highlight-source-shell"><pre>┌── CONTRIBUTING.rst
├── LICENSE
├── MANIFEST.<span class="pl-k">in</span>
├── Makefile
├── README.rst
├── data
│   ├── converted/<span class="pl-k">*</span>
│   └── test/<span class="pl-k">*</span>
├── dev-requirements.txt
├── docs
│   ├── AUTHORS.rst
│   ├── CHANGES.rst
│   ├── COOKBOOK.rst
│   ├── FAQ.rst
│   ├── INSTALLATION.rst
│   └── TODO.rst
├── examples
│   ├── usage.ipynb
│   └── usage.py
├── helpers/<span class="pl-k">*</span>
├── manage.py
├── meza
│   ├── __init__.py
│   ├── convert.py
│   ├── dbf.py
│   ├── fntools.py
│   ├── io.py
│   ├── process.py
│   ├── stats.py
│   ├── typetools.py
│   └── unicsv.py
├── optional-requirements.txt
├── py2-requirements.txt
├── requirements.txt
├── setup.cfg
├── setup.py
├── tests
│   ├── __init__.py
│   ├── standard.rc
│   ├── test_fntools.py
│   ├── test_io.py
│   └── test_process.py
└── tox.ini</pre></div>
<a name="user-content-design-principles"/>
<h2><a id="user-content-design-principles" class="anchor" href="#design-principles" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Design Principles</h2>
<ul>
<li>prefer functions over objects</li>
<li>provide enough functionality out of the box to easily implement the most common data analysis use cases</li>
<li>make conversion between <code>records</code>, <code>arrays</code>, and <code>DataFrames</code> dead simple</li>
<li>whenever possible, lazily read objects and stream the result <a href="#id13" id="user-content-id12">[6]</a></li>
</ul>
<table frame="void" id="user-content-id13" rules="none">

<tbody valign="top">
<tr><td><a href="#id12">[6]</a></td><td>Notable exceptions are <code>meza.process.group</code>, <code>meza.process.sort</code>, <code>meza.io.read_dbf</code>, <code>meza.io.read_yaml</code>, and <code>meza.io.read_html</code>. These functions read the entire contents into memory up front.</td></tr>
</tbody>
</table>
<a name="user-content-scripts"/>
<h2><a id="user-content-scripts" class="anchor" href="#scripts" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Scripts</h2>
<p>meza comes with a built in task manager <code>manage.py</code></p>
<a name="user-content-id14"/>
<h3><a id="user-content-setup-1" class="anchor" href="#setup-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Setup</h3>
<div class="highlight highlight-source-shell"><pre>pip install -r dev-requirements.txt</pre></div>
<a name="user-content-examples"/>
<h3><a id="user-content-examples" class="anchor" href="#examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Examples</h3>
<p><em>Run python linter and nose tests</em></p>

<a name="user-content-contributing"/>
<h2><a id="user-content-contributing" class="anchor" href="#contributing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Contributing</h2>
<p>Please mimic the coding style/conventions used in this repo.
If you add new classes or functions, please add the appropriate doc blocks with
examples. Also, make sure the python linter and nose tests pass.</p>
<p>Please see the <a href="https://github.com/reubano/meza/blob/master/CONTRIBUTING.rst">contributing doc</a> for more details.</p>
<a name="user-content-credits"/>
<h2><a id="user-content-credits" class="anchor" href="#credits" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Credits</h2>
<p>Shoutouts to <a href="https://github.com/onyxfish/csvkit">csvkit</a>, <a href="https://github.com/okfn/messytables">messytables</a>, and <a href="https://github.com/pydata/pandas">pandas</a> for heavily inspiring meza.</p>
<a name="user-content-more-info"/>
<h2><a id="user-content-more-info" class="anchor" href="#more-info" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>More Info</h2>

<a name="user-content-license"/>
<h2><a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>License</h2>
<p>meza is distributed under the <a href="http://opensource.org/licenses/MIT">MIT License</a>.</p>

</article>
  </div></body></html>