<html><body><div><section class="entry">
<p class="fsb-clear"/><p class="p1"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_top_to_bottom.jpg"><img class="aligncenter wp-image-2233" src="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_top_to_bottom.jpg" alt="Sorting contours left-to-right using Python and OpenCV." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_top_to_bottom-300x276.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_top_to_bottom.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a></p>
<p class="p1">Alright, so at this point you have been exposed to contours pretty heavily on the PyImageSearch blog.</p>
<p class="p1">We used contours to build a <a title="How to Build a Kick-Ass Mobile Document Scanner in Just 5 Minutes" href="http://www.pyimagesearch.com/2014/09/01/build-kick-ass-mobile-document-scanner-just-5-minutes/" target="_blank">kick-ass mobile document scanner</a>.</p>
<p class="p1">Contours enabled us <a title="Detecting Barcodes in Images with Python and OpenCV" href="http://www.pyimagesearch.com/2014/11/24/detecting-barcodes-images-python-opencv/" target="_blank">detect barcodes in images</a>.</p>
<p class="p1">And we even leveraged the power of contours to <a title="Find distance from camera to object/marker using Python and OpenCV" href="http://www.pyimagesearch.com/2015/01/19/find-distance-camera-objectmarker-using-python-opencv/" target="_blank">find the distance from a camera to object or marker</a>.</p>
<p class="p1">But there still remains a sticking question that we have not addressed: <b><i>how in the world do we </i>sort<i> contours from left-to-right, top-to-bottom, etc.</i></b></p>
<p class="p1">Oddly enough OpenCV <i>does not</i> provide a built-in function or method to perform the actual sorting of contours.</p>
<p class="p1">But no worries.</p>
<p class="p1">In the rest of this blog you’ll be sorting contours using Python and OpenCV like a pro.</p>
<p class="p1">Read on to find out more…</p>

<p class="p1"><strong>OpenCV and Python versions:</strong><br/>
In order to run this example, you’ll need <strong>Python 2.7</strong> and <strong>OpenCV 2.4.X</strong>.</p>
<h1 class="p1">Sorting Contours using Python and OpenCV</h1>
<p class="p1">By the end of this blog article you’ll be able to:</p>
<ol>
<li class="p1">
<p class="p1">Sort contours according to their <i>size/area</i>, along with a template to follow to sort contours by any other arbitrary criteria.</p>
</li>
<li class="p1">
<p class="p1">Sort contoured regions from <i>left-to-right</i>, <i>right-to-left</i>, <i>top-to-bottom</i>, and <i>bottom-to-top</i> using only a <b><i>single function</i></b>.</p>
</li>
</ol>
<p class="p1">So let’s go ahead and get started. Open up your favorite code editor, name it 
			<span id="crayon-56d5a0aa9580c426633201" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">sorting_contours</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> and let’s get started:</p>
<p/>

		<div id="crayon-56d5a0aa95817255727600" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-2">2</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-4">4</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-6">6</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-8">8</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-10">10</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-12">12</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-14">14</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-16">16</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-18">18</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-20">20</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-22">22</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-24">24</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95817255727600-26">26</p><p class="crayon-num" data-line="crayon-56d5a0aa95817255727600-27">27</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0aa95817255727600-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-6"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">sort_contours</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"left-to-right"</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-7"><span class="crayon-h">	</span><span class="crayon-c"># initialize the reverse flag and sort index</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-8"><span class="crayon-h">	</span><span class="crayon-v">reverse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-9"><span class="crayon-h">	</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-10"> </p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-11"><span class="crayon-h">	</span><span class="crayon-c"># handle if we need to sort in reverse</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-12"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"right-to-left"</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"bottom-to-top"</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-13"><span class="crayon-h">		</span><span class="crayon-v">reverse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-14"> </p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-15"><span class="crayon-h">	</span><span class="crayon-c"># handle if we are sorting against the y-coordinate rather than</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-16"><span class="crayon-h">	</span><span class="crayon-c"># the x-coordinate of the bounding box</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-17"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"top-to-bottom"</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"bottom-to-top"</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-18"><span class="crayon-h">		</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-19"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-20"><span class="crayon-h">	</span><span class="crayon-c"># construct the list of bounding boxes and sort them from top to</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-21"><span class="crayon-h">	</span><span class="crayon-c"># bottom</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-22"><span class="crayon-h">	</span><span class="crayon-v">boundingBoxes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">boundingRect</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">cnts</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-23"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boundingBoxes</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-k ">sorted</span><span class="crayon-sy">(</span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boundingBoxes</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-24"><span class="crayon-h">		</span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-o">:</span><span class="crayon-v">b</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reverse</span><span class="crayon-o">=</span><span class="crayon-v">reverse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-25"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95817255727600-26"><span class="crayon-h">	</span><span class="crayon-c"># return the list of sorted contours and bounding boxes</span></p><p class="crayon-line" id="crayon-56d5a0aa95817255727600-27"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boundingBoxes</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p class="p1">We’ll start off by importing our necessary packages: NumPy for numerical processing, 
			<span id="crayon-56d5a0aa9581d579769323" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">argparse</span></span></span>  to parse our command line arguments, and 
			<span id="crayon-56d5a0aa95820613673087" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span></span></span>  for our OpenCV bindings.</p>
<p class="p1">Instead of starting off by parsing arguments, loading images, and taking care of other normal procedures, let’s skip these steps for the time being and jump immediately in to defining our 
			<span id="crayon-56d5a0aa95824341689522" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">sort_contours</span></span></span>  function which will enable us to sort our contours.</p>
<p class="p1">The actual 
			<span id="crayon-56d5a0aa95827610614464" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">sort_contours</span></span></span>  function is defined on <b>Line 6</b> and takes two arguments. The first is 
			<span id="crayon-56d5a0aa9582b815529756" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cnts</span></span></span> , the list of contours that the we want to sort, and the second is the sorting 
			<span id="crayon-56d5a0aa9582e511096430" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">method</span></span></span> , which indicates the <i>direction</i> in which we are going to sort our contours (i.e. left-to-right, top-to-bottom, etc.).</p>
<p class="p1">From there we’ll initialize two important variables on <b>Lines 8 and 9</b>. These variables simply indicate the sorting order (ascending or descending) and the <i>index</i> of the bounding box we are going to use to perform the sort (more on that later). We’ll initialize these variables to sort in <i>ascending</i> order and along to the <i>x</i>-axis location of the bounding box of the contour.</p>
<p class="p1">If we are sorting right-to-left or bottom-to-top, we’ll need to sort in <b><i>descending</i></b> order, according to the location of the contour in the image (<b>Lines 12 and 13</b>).</p>
<p class="p1">Similarly, on <b>Lines 17 and 18</b> we check to see if we are sorting from top-to-bottom or bottom-to-top. If this is the case, then we need to sort according to the <i>y</i>-axis value rather than the <i>x</i>-axis (since we are now sorting vertically rather than horizontally).</p>
<p class="p1">The actual sorting of the contours happens on <b>Lines 22-24</b>.</p>
<p class="p1">We first compute the <i>bounding boxes</i> of each contour, which is simply the starting <i>(x, y)</i>-coordinates of the bounding box followed by the width and height (hence the term “bounding box”). (<b>Line 22</b>)</p>
<p class="p1">The 
			<span id="crayon-56d5a0aa95832679320516" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">boundingBoxes</span></span></span>  enable us to sort the actual contours, which we do on <b>Line 23-24</b> using some Python magic that sorts two lists together. Using this code we are able to sort <b><i>both</i></b> the contours and bounding boxes according to the criteria that we provided.</p>
<p class="p1">Finally, we return the (now sorted) list of bounding boxes and contours to the calling function on <b>Line 27</b>.</p>
<p class="p1">While we’re at it, let’s go ahead and define another helper function, 
			<span id="crayon-56d5a0aa95836811684697" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">draw_contour</span></span></span> :</p>
<p/>

		<div id="crayon-56d5a0aa95839638821242" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5a0aa95839638821242-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95839638821242-30">30</p><p class="crayon-num" data-line="crayon-56d5a0aa95839638821242-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95839638821242-32">32</p><p class="crayon-num" data-line="crayon-56d5a0aa95839638821242-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95839638821242-34">34</p><p class="crayon-num" data-line="crayon-56d5a0aa95839638821242-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95839638821242-36">36</p><p class="crayon-num" data-line="crayon-56d5a0aa95839638821242-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95839638821242-38">38</p><p class="crayon-num" data-line="crayon-56d5a0aa95839638821242-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95839638821242-40">40</p><p class="crayon-num" data-line="crayon-56d5a0aa95839638821242-41">41</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0aa95839638821242-29"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">draw_contour</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95839638821242-30"><span class="crayon-h">	</span><span class="crayon-c"># compute the center of the contour area and draw a circle</span></p><p class="crayon-line" id="crayon-56d5a0aa95839638821242-31"><span class="crayon-h">	</span><span class="crayon-c"># representing the center</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95839638821242-32"><span class="crayon-h">	</span><span class="crayon-v">M</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">moments</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95839638821242-33"><span class="crayon-h">	</span><span class="crayon-v">cX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">M</span><span class="crayon-sy">[</span><span class="crayon-s">"m10"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">M</span><span class="crayon-sy">[</span><span class="crayon-s">"m00"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95839638821242-34"><span class="crayon-h">	</span><span class="crayon-v">cY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">M</span><span class="crayon-sy">[</span><span class="crayon-s">"m01"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">M</span><span class="crayon-sy">[</span><span class="crayon-s">"m00"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95839638821242-35"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95839638821242-36"><span class="crayon-h">	</span><span class="crayon-c"># draw the countour number on the image</span></p><p class="crayon-line" id="crayon-56d5a0aa95839638821242-37"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">putText</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"#{}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">cX</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">FONT_HERSHEY_SIMPLEX</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95839638821242-38"><span class="crayon-h">		</span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95839638821242-39"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95839638821242-40"><span class="crayon-h">	</span><span class="crayon-c"># return the image with the contour number drawn on it</span></p><p class="crayon-line" id="crayon-56d5a0aa95839638821242-41"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">image</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p class="p1">This function simply computes the <b>center</b> <i>(x, y)</i>-coordinate of the supplied contour 
			<span id="crayon-56d5a0aa9583e342356444" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">c</span></span></span>  on <b>Lines 32-34</b> and then uses the center coordinates to draw the contour ID, 
			<span id="crayon-56d5a0aa95841449688583" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">i</span></span></span> , on <b>Lines 37 and 38</b>.</p>
<p class="p1">Finally, the passed in 
			<span id="crayon-56d5a0aa95844687556360" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">image</span></span></span>  is returned to the calling function on <b>Line 41</b>.</p>
<p class="p1">Again, this is simply a helper function that we’ll leverage to draw contour ID numbers on our actual image so we can visualize the results of our work.</p>
<p class="p1">Now that the helper functions are done, let’s put the driver code in place to take our actual image, detect contours, and sort them:</p>
<p/>

		<div id="crayon-56d5a0aa95848899540901" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-44">44</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-46">46</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-48">48</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-50">50</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-52">52</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-54">54</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-55">55</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-56">56</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-57">57</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-58">58</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-59">59</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-60">60</p><p class="crayon-num" data-line="crayon-56d5a0aa95848899540901-61">61</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95848899540901-62">62</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0aa95848899540901-43"><span class="crayon-c"># construct the argument parser and parse the arguments</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-44"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-45"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-i"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"Path to the input image"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-46"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-m"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--method"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"Sorting method"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-47"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-48"> </p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-49"><span class="crayon-c"># load the image and initialize the accumulated edge image</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-50"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"image"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-51"><span class="crayon-v">accumEdged</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-52"> </p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-53"><span class="crayon-c"># loop over the blue, green, and red channels, respectively</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-54"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">chan </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-55"><span class="crayon-h">	</span><span class="crayon-c"># blur the channel, extract edges from it, and accumulate the set</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-56"><span class="crayon-h">	</span><span class="crayon-c"># of edges for the image</span></p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-57"><span class="crayon-h">	</span><span class="crayon-v">chan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">medianBlur</span><span class="crayon-sy">(</span><span class="crayon-v">chan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-58"><span class="crayon-h">	</span><span class="crayon-v">edged</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">Canny</span><span class="crayon-sy">(</span><span class="crayon-v">chan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-59"><span class="crayon-h">	</span><span class="crayon-v">accumEdged</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">bitwise_or</span><span class="crayon-sy">(</span><span class="crayon-v">accumEdged</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">edged</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-60"> </p><p class="crayon-line" id="crayon-56d5a0aa95848899540901-61"><span class="crayon-c"># show the accumulated edge map</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95848899540901-62"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Edge Map"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">accumEdged</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p class="p1"><b>Lines 44-47</b> aren’t very interesting — they simply parse our command line arguments, 
			<span id="crayon-56d5a0aa9584d755554591" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">--</span><span class="crayon-v">image</span></span></span>  which is the path to where our image resides on disk, and 
			<span id="crayon-56d5a0aa95851218226501" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">--</span><span class="crayon-v">method</span></span></span>  which is a text representation of the direction in which we want to sort our contours.</p>
<p class="p1">From there we load our image off disk on <b>Line 50</b> and allocate memory for the edge map on <b>Line 51</b>.</p>
<p class="p1">Constructing the actual edge map happens on <b>Lines 54-59</b>, where we loop over each Blue, Green, and Red channel of the image (<b>Line 54</b>), blur each channel slightly to remove high frequency noise (<b>Line 57</b>), perform edge detection, (<b>Line 59</b>), and update the accumulated edge map on <b>Line 60</b>.</p>
<p class="p1">We display the accumulated edge map on <b>line 62</b> which looks like this:</p>
<div id="attachment_2234" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_edge_map.jpg"><img class="wp-image-2234" src="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_edge_map.jpg" alt="Figure 1: (Left) Our original image. (Right) The edge map of the Lego bricks." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_edge_map-300x272.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_edge_map.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 1:</strong> <em>(Left)</em> Our original image. <em>(Right)</em> The edge map of the Lego bricks.</p></div>
<p class="p1">As you can see, we have detected the actual edge outlines of the Lego bricks in the image.</p>
<p class="p1">Now, let’s see if we can (1) find the contours of these Lego bricks, and then (2) sort them:</p>
<p/>

		<div id="crayon-56d5a0aa95855010976716" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-64">64</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-65">65</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-66">66</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-67">67</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-68">68</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-69">69</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-70">70</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-71">71</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-72">72</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-73">73</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-74">74</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-75">75</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-76">76</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-77">77</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-78">78</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-79">79</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-80">80</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-81">81</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-82">82</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-83">83</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-84">84</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-85">85</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0aa95855010976716-86">86</p><p class="crayon-num" data-line="crayon-56d5a0aa95855010976716-87">87</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-64"><span class="crayon-c"># find contours in the accumulated image, keeping only the largest</span></p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-65"><span class="crayon-c"># ones</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-66"><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">findContours</span><span class="crayon-sy">(</span><span class="crayon-v">accumEdged</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">RETR_EXTERNAL</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-67"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">CHAIN_APPROX_SIMPLE</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-68"><span class="crayon-v">cnts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">sorted</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">contourArea</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reverse</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-69"><span class="crayon-v">orig</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-70"> </p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-71"><span class="crayon-c"># loop over the (unsorted) contours and draw them</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-72"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-73"><span class="crayon-h">	</span><span class="crayon-v">orig</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">draw_contour</span><span class="crayon-sy">(</span><span class="crayon-v">orig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-74"> </p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-75"><span class="crayon-c"># show the original, unsorted contour image</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-76"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Unsorted"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">orig</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-77"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-78"><span class="crayon-c"># sort the contours according to the provided method</span></p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-79"><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boundingBoxes</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sort_contours</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"method"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-80"> </p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-81"><span class="crayon-c"># loop over the (now sorted) contours and draw them</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-82"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-83"><span class="crayon-h">	</span><span class="crayon-e">draw_contour</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-84"> </p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-85"><span class="crayon-c"># show the output image</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0aa95855010976716-86"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Sorted"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0aa95855010976716-87"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p class="p1">Quite obviously, the first step here is to find the actual contours in our accumulated edge map image on <b>Line 66 and 67</b>. We are looking for the <i>external</i> contours of the Lego bricks, which simply corresponds to their <i>outlines</i>.</p>
<p class="p1">Based on these contours, we are now going to <b><i>sort them according to their size</i></b> by using a combination of the Python 
			<span id="crayon-56d5a0aa9585b153538466" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">sorted</span></span></span>  function and the 
			<span id="crayon-56d5a0aa9585f282539511" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">contourArea</span></span></span>  method — this allows us to sort our contours according to their area (i.e. size) from largest to smallest.</p>
<p class="p1">We take these sorted contours (in terms of size, <i>not</i> location), loop over them on <b>Line 72</b> and draw each individual contour on <b>Line 73</b> using our 
			<span id="crayon-56d5a0aa95862884305638" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">draw_contour</span></span></span>  helper function.</p>
<p class="p1">This image is then displayed to our screen on <b>Line 76</b>.</p>
<p class="p1">However, as you’ll notice, our contours have been sorted only according to their <em>size</em> — no attention has been paid to their actual <em>location</em> in the image.</p>
<p class="p1">We address this problem on <b>Line 79</b> where we make a call to our custom 
			<span id="crayon-56d5a0aa95866586439383" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">sort_contours</span></span></span>  function. This method accepts our list of contours along with sorting direction method (provided via command line argument) and sorts them, returning a tuple of sorted bounding boxes and contours, respectively.</p>
<p class="p1">Finally, we take these sorted contours, loop over them, draw each individual one, and finally display the output image to our screen (<b>Lines 82-87</b>).</p>
<h1 class="p1">Results</h1>
<p class="p1">Let’s put our hard work to the test.</p>
<p class="p1">Open up a terminal, navigate to your source code and execute the following command:</p>
<p/>

		<div id="crayon-56d5a0aa9586a325655679" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0aa9586a325655679-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">sorting_contours</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">image_01</span><span class="crayon-e">.png</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-i">method</span><span class="crayon-h"> </span><span class="crayon-s">"top-to-bottom"</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p class="p1">Your output should look like this:</p>
<div id="attachment_2233" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_top_to_bottom.jpg"><img class="wp-image-2233" src="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_top_to_bottom.jpg" alt="Sorting our Lego bricks from top-to-bottom." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_top_to_bottom-300x276.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorted_contours_top_to_bottom.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 2:</strong> Sorting our Lego bricks from top-to-bottom.</p></div>
<p class="p1">On the <i>left</i> we have our original unsorted contours. Clearly, we can see that the contours are very much out of order — the first contour is appearing at the very bottom and the second contour at the very top!</p>
<p class="p1">However, by applying our 
			<span id="crayon-56d5a0aa9586e664319362" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">sorted_contours</span></span></span>  function we were able to sort our Lego bricks from top-to-bottom.</p>
<p class="p1">Let’s take a look at another example.</p>
<p/>

		<div id="crayon-56d5a0aa95871048917070" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0aa95871048917070-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">sorting_contours</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">image_01</span><span class="crayon-e">.png</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-i">method</span><span class="crayon-h"> </span><span class="crayon-s">"bottom-to-top"</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/><div id="attachment_2235" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_bottom_to_top.jpg"><img class="wp-image-2235" src="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_bottom_to_top.jpg" alt="Sorting our contours from bottom-to-top." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_bottom_to_top-300x275.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_bottom_to_top.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 3:</strong> Sorting our contours from bottom-to-top.</p></div>
<p class="p1">And here we have sorted on contours from bottom-to-top.</p>
<p class="p1">Of course, we can also sort contours horizontally as well:</p>
<p/>

		<div id="crayon-56d5a0aa95875830554781" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0aa95875830554781-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">sorting_contours</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">image_02</span><span class="crayon-e">.png</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-i">method</span><span class="crayon-h"> </span><span class="crayon-s">"left-to-right"</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/><div id="attachment_2237" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_left_to_right.jpg"><img class="wp-image-2237" src="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_left_to_right.jpg" alt="Figure 4: Sorting our contours from left-to-right." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_left_to_right-276x300.jpg 276w, http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_left_to_right-943x1024.jpg 943w, http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_left_to_right.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 4:</strong> Sorting our contours from left-to-right.</p></div>
<p class="p1">Again, in the <i>top</i> image our contours are not in order. But in the <i>bottom</i> image we are able to successfully sort our contours without an issue.</p>
<p class="p1">One last example:</p>
<p/>

		<div id="crayon-56d5a0aa95879593115952" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0aa95879593115952-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">sorting_contours</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">image_02</span><span class="crayon-e">.png</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-i">method</span><span class="crayon-h"> </span><span class="crayon-s">"right-to-left"</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/><div id="attachment_2236" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_right_to_left.jpg"><img class="wp-image-2236" src="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_right_to_left.jpg" alt="Sorting our contours from right-to-left." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_right_to_left-281x300.jpg 281w, http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_right_to_left-959x1024.jpg 959w, http://www.pyimagesearch.com/wp-content/uploads/2015/04/sorting_contours_right_to_left.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 5:</strong> Sorting our contours from right-to-left.</p></div>
<p class="p1">As you can see, there’s nothing to it — we’re simply leveraging the bounding box of each object in the image to sort the contours by direction using Python and OpenCV.</p>
<p class="p1">In the future all you need is our trusty 
			<span id="crayon-56d5a0aa9587d650872008" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">sorted_contours</span></span></span>  function and you’ll always be able to sort contours in terms of direction without a problem.</p>
<h1>Summary</h1>
<p class="p1">In this blog article we learned how to sort contours from left-to-right, right-to-left, top-to-bottom, and bottom-to-top.</p>
<p>Realistically, we only needed to leverage two key functions.</p>
<p class="p1">The first critical function was the 
			<span id="crayon-56d5a0aa95880469278399" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">boundingRect</span></span></span>  method which computes the bounding box region of the contour. And based on these bounding boxes, we leveraged some Python magic and used our second critical function, 
			<span id="crayon-56d5a0aa95884840985614" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">sorted</span></span></span> , to actually “sort” these bounding boxes in the direction we want.</p>
<p class="p1">And that’s all there is to it!</p>
<p class="p1">If you would like to play with the examples included in this post, just enter your email address in the form below and I’ll email you the code instantly.</p>
<h1 id="post_downloads">Downloads:</h1>

	</section>
	</div></body></html>