<html><body><div><div class="section">
              <h1>graphite_beacon_cron 0.25.4.1</h1>

              


<p>Simple alerting system for Graphite metrics.</p><p>








graphite-beacon</p><p>===============</p><p>![logo](https://raw.github.com/klen/graphite-beacon/develop/beacon.png)</p><p>Simple alerting system for [Graphite](http://graphite.wikidot.com/) metrics.</p><p>Features:</p><p>- Simplest installation (one python package dependency)</p><p>- No software dependencies (Databases, AMQP and etc)</p><p>- Light and full asyncronous</p><p>- SMTP, HipChat, Slack, PagerDuty, HTTP handlers (Please make a request for additional handlers)</p><p>- Easy configurable and supports historical values</p><p>[![Build status](http://img.shields.io/travis/klen/graphite-beacon.svg?style=flat-square)](http://travis-ci.org/klen/graphite-beacon)</p><p>[![Coverage](http://img.shields.io/coveralls/klen/graphite-beacon.svg?style=flat-square)](https://coveralls.io/r/klen/graphite-beacon)</p><p>[![Version](http://img.shields.io/pypi/v/graphite-beacon.svg?style=flat-square)](https://pypi.python.org/pypi/graphite_beacon)</p><p>[![License](http://img.shields.io/pypi/l/graphite-beacon.svg?style=flat-square)](https://pypi.python.org/pypi/graphite_beacon)</p><p>[![Downloads](http://img.shields.io/pypi/dm/graphite-beacon.svg?style=flat-square)](https://pypi.python.org/pypi/graphite_beacon)</p><p>Example:</p><p>```js</p><p>{</p><p>"graphite_url": "http://g.server.org",</p><p>"smtp": {</p><p>    "from": "beacon@server.org",</p><p>    "to": ["me@gmail.com"]</p><p>},</p><p>"alerts": [</p><p>    {   "name": "MEM",</p><p>        "format": "bytes",</p><p>        "query": "aliasByNode(sumSeriesWithWildcards(collectd.*.memory.{memory-free,memory-cached}, 3), 1)",</p><p>        "rules": ["critical: &lt; 200MB", "warning: &lt; 400MB", "warning: &lt; historical / 2"] },</p><p>    {   "name": "CPU",</p><p>        "format": "percent",</p><p>        "query": "aliasByNode(sumSeriesWithWildcards(collectd.*.cpu-*.cpu-user, 2), 1)",</p><p>        "rules": ["critical: &gt;= 80%", "warning: &gt;= 70%"] }</p><p>]}</p><p>```</p><p>Requirements</p><p>------------</p><p>- python (2.6, 2.7, 3.3, 3.4)</p><p>- tornado</p><p>- funcparserlib</p><p>Installation</p><p>------------</p><p>### Python package</p><p>**graphite-beacon** can be installed using pip:</p><p>    pip install graphite-beacon</p><p>### Debian package</p><p>Using the command line, add the following to your /etc/apt/sources.list system config file:</p><p>    echo "deb http://dl.bintray.com/klen/deb /" | sudo tee -a /etc/apt/sources.list</p><p>    echo "deb-src http://dl.bintray.com/klen/deb /" | sudo tee -a /etc/apt/sources.list</p><p>Install the package using apt-get:</p><p>    apt-get update</p><p>    apt-get install graphite-beacon</p><p>### Ansible role</p><p>There is an ansible role to install the package: https://github.com/Stouts/Stouts.graphite-beacon</p><p>## Docker</p><p>Build a config.json file and run :</p><p>    docker run -v /path/to/config.json:/srv/alerting/etc/config.json deliverous/graphite-beacon</p><p>Usage</p><p>-----</p><p>Just run `graphite-beacon`:</p><p>    $ graphite-beacon</p><p>    [I 141025 11:16:23 core:141] Read configuration</p><p>    [I 141025 11:16:23 core:55] Memory (10minute): init</p><p>    [I 141025 11:16:23 core:166] Loaded with options:</p><p>    ...</p><p>### Configuration</p><p>___</p><p>Time units:</p><p>&gt; '2second', '3.5minute', '4hour', '5.2day', '6week', '7month', '8year'</p><p>&gt; short formats are: '2s', '3m', '4.1h' ...</p><p>Value units:</p><p>&gt; short: '2K', '3Mil', '4Bil', '5Tri'</p><p>&gt; bytes: '2KB', '3MB', '4GB'</p><p>&gt; bits: '2Kb', '3Mb', '4Gb'</p><p>&gt; bps: '2Kbps', '3Mbps', '4Gbps'</p><p>&gt; time: '2s', '3m', '4h', '5d'</p><p>The default options are:</p><p>&gt; Note: comments are not allowed in JSON, but graphite-beacon strips them</p><p>```js</p><p>    {</p><p>        // Graphite server URL</p><p>        "graphite_url": "http://localhost",</p><p>        // Public graphite server URL</p><p>        // Used when notifying handlers, defaults to graphite_url</p><p>        "public_graphite_url": null,</p><p>        // HTTP AUTH username</p><p>        "auth_username": null,</p><p>        // HTTP AUTH password</p><p>        "auth_password": null,</p><p>        // Path to a pidfile</p><p>        "pidfile": null,</p><p>        // Default values format (none, bytes, s, ms, short)</p><p>        // Can be redefined for each alert.</p><p>        "format": "short",</p><p>        // Default query interval</p><p>        // Can be redefined for each alert.</p><p>        "interval": "10minute",</p><p>        // Default time window for Graphite queries</p><p>        // Defaults to query interval, can be redefined for each alert.</p><p>        "time_window": "10minute",</p><p>        // Notification repeat interval</p><p>        // If an alert is failed, its notification will be repeated with the interval below</p><p>        "repeat_interval": "2hour",</p><p>        // Default end time for Graphite queries</p><p>        // Defaults to the current time, can be redefined for each alert.</p><p>        "until": "0second",</p><p>        // Default loglevel</p><p>        "logging": "info",</p><p>        // Default method (average, last_value, sum, minimum, maximum).</p><p>        // Can be redefined for each alert.</p><p>        "method": "average",</p><p>        // Default alert to send when no data received (normal = no alert)</p><p>        // Can be redefined for each alert</p><p>        "no_data": "critical",</p><p>        // Default alert to send when loading failed (timeout, server error, etc)</p><p>        // (normal = no alert)</p><p>        // Can be redefined for each alert</p><p>        "loading_error": "critical"</p><p>        // Default prefix (used for notifications)</p><p>        "prefix": "[BEACON]",</p><p>        // Default handlers (log, smtp, hipchat, http, slack, pagerduty)</p><p>        "critical_handlers": ["log", "smtp"],</p><p>        "warning_handlers": ["log", "smtp"],</p><p>        "normal_handlers": ["log", "smtp"],</p><p>        // Send initial values (Send current values when reactor starts)</p><p>        "send_initial": true,</p><p>        // used together to ignore the missing value</p><p>        "default_nan_value": -1,</p><p>        "ignore_nan": false,</p><p>        // Default alerts (see configuration below)</p><p>        "alerts": [],</p><p>        // Path to other configuration files to include</p><p>        "include": []</p><p>    }</p><p>```</p><p>You can setup options with a configuration file. See examples for</p><p>[JSON](examples/example-config.json) and</p><p>[YAML](examples/example-config.yaml).</p><p>A `config.json` file in the same directory that you run `graphite-beacon`</p><p>from will be used automatically.</p><p>#### Setup alerts</p><p>Currently two types of alerts are supported:</p><p>- Graphite alert (default) - check graphite metrics</p><p>- URL alert - load http and check status</p><p>&gt; Note: comments are not allowed in JSON, but graphite-beacon strips them</p><p>```js</p><p>  "alerts": [</p><p>    {</p><p>      // (required) Alert name</p><p>      "name": "Memory",</p><p>      // (required) Alert query</p><p>      "query": "*.memory.memory-free",</p><p>      // (optional) Alert type (graphite, url)</p><p>      "source": "graphite",</p><p>      // (optional) Default values format (none, bytes, s, ms, short)</p><p>      "format": "bytes",</p><p>      // (optional) Alert method (average, last_value, sum, minimum, maximum)</p><p>      "method": "average",</p><p>      // (optional) Alert interval [eg. 15second, 30minute, 2hour, 1day, 3month, 1year]</p><p>      "interval": "1minute",</p><p>      // (optional) What kind of alert to send when no data received (normal = no alert)</p><p>      "no_data": "warning",</p><p>      // (optional) Alert interval end time (see "Alert interval" for examples)</p><p>      "until": "5second",</p><p>      // (required) Alert rules</p><p>      // Rule format: "{level}: {operator} {value}"</p><p>      // Level one of [critical, warning, normal]</p><p>      // Operator one of [&gt;, &lt;, &gt;=, &lt;=, ==, !=]</p><p>      // Value (absolute value: 3000000 or short form like 3MB/12minute)</p><p>      // Multiple conditions can be separated by AND or OR conditions</p><p>      "rules": [ "critical: &lt; 200MB", "warning: &lt; 300MB" ]</p><p>    }</p><p>  ]</p><p>```</p><p>##### Historical values</p><p>graphite-beacon supports "historical" values for a rule.</p><p>For example you may want to get warning when CPU usage is greater than 150% of normal usage:</p><p>    "warning: &gt; historical * 1.5"</p><p>Or memory is less than half the usual value:</p><p>    "warning: &lt; historical / 2"</p><p>Historical values for each query are kept. A historical value</p><p>represents the average of all values in history. Rules using a historical value will</p><p>only work after enough values have been collected (see `history_size`).</p><p>History values are kept for 1 day by default. You can change this with the `history_size`</p><p>option.</p><p>See the below example for how to send a warning when today's new user count is</p><p>less than 80% of the last 10 day average:</p><p>```js</p><p>alerts: [</p><p>  {</p><p>    "name": "Registrations",</p><p>    // Run once per day</p><p>    "interval": "1day",</p><p>    "query": "Your graphite query here",</p><p>    // Get average for last 10 days</p><p>    "history_size": "10day",</p><p>    "rules": [</p><p>      // Warning if today's new user less than 80% of average for 10 days</p><p>      "warning: &lt; historical * 0.8",</p><p>     // Critical if today's new user less than 50% of average for 10 days</p><p>      "critical: &lt; historical * 0.5"</p><p>    ]</p><p>  }</p><p>],</p><p>```</p><p>### Handlers</p><p>Handlers allow for notifying an external service or process of an alert firing.</p><p>#### Email Handler</p><p>Sends an email (enabled by default).</p><p>```js</p><p>{</p><p>    // SMTP default options</p><p>    "smtp": {</p><p>        "from": "beacon@graphite",</p><p>        "to": [],                   // List of email addresses to send to</p><p>        "host": "localhost",        // SMTP host</p><p>        "port": 25,                 // SMTP port</p><p>        "username": null,           // SMTP user (optional)</p><p>        "password": null,           // SMTP password (optional)</p><p>        "use_tls": false,           // Use TLS?</p><p>        "html": true,               // Send HTML emails?</p><p>        // Graphite link for emails (By default is equal to main graphite_url)</p><p>        "graphite_url": null</p><p>    }</p><p>}</p><p>```</p><p>#### HipChat Handler</p><p>Sends a message to a HipChat room.</p><p>```js</p><p>{</p><p>    "hipchat": {</p><p>        // (optional) Custom HipChat URL</p><p>        "url": 'https://api.custom.hipchat.my',</p><p>        "room": "myroom",</p><p>        "key": "mykey"</p><p>    }</p><p>}</p><p>```</p><p>#### Webhook Handler (HTTP)</p><p>Triggers a webhook.</p><p>```js</p><p>{</p><p>    "http": {</p><p>        "url": "http://myhook.com",</p><p>        "params": {},                 // (optional) Additional query(data) params</p><p>        "method": "GET"               // (optional) HTTP method</p><p>    }</p><p>}</p><p>```</p><p>#### Slack Handler</p><p>Sends a message to a user or channel on Slack.</p><p>```js</p><p>{</p><p>    "slack": {</p><p>        "webhook": "https://hooks.slack.com/services/",</p><p>        "channel": "#general",          // #channel or @user (optional)</p><p>        "username": "graphite-beacon",</p><p>    }</p><p>}</p><p>```</p><p>#### Command Line Handler</p><p>Runs a command.</p><p>```js</p><p>{</p><p>    "cli": {</p><p>        // Command to run (required)</p><p>        // Several variables that will be substituted by values are allowed:</p><p>        //  ${level} -- alert level</p><p>        //  ${name} -- alert name</p><p>        //  ${value} -- current metrics value</p><p>        //  ${limit_value} -- metrics limit value</p><p>        "command": "./myscript ${level} ${name} ${value} ...",</p><p>        // Whitelist of alerts that will trigger this handler (optional)</p><p>        // All alerts will trigger this handler if absent.</p><p>        "alerts_whitelist": ["..."]</p><p>    }</p><p>}</p><p>```</p><p>#### PagerDuty Handler</p><p>Triggers a PagerDuty incident.</p><p>```js</p><p>{</p><p>    "pagerduty": {</p><p>        "subdomain": "yoursubdomain",</p><p>        "apitoken": "apitoken",</p><p>        "service_key": "servicekey",</p><p>    }</p><p>}</p><p>```</p><p>#### Telegram Handler</p><p>Sends a Telegram message.</p><p>```js</p><p>{</p><p>    "telegram": {</p><p>        "token": "telegram bot token",</p><p>        "bot_ident": "token used to activate bot in a group"</p><p>    }</p><p>}</p><p>```</p><p>### Command Line Usage</p><p>```</p><p>  $ graphite-beacon --help</p><p>  Usage: graphite-beacon [OPTIONS]</p><p>  Options:</p><p>    --config                         Path to an configuration file (JSON/YAML)</p><p>                                     (default config.json)</p><p>    --graphite_url                   Graphite URL (default http://localhost)</p><p>    --help                           show this help information</p><p>    --pidfile                        Set pid file</p><p>    --log_file_max_size              max size of log files before rollover</p><p>                                     (default 100000000)</p><p>    --log_file_num_backups           number of log files to keep (default 10)</p><p>    --log_file_prefix=PATH           Path prefix for log files. Note that if you</p><p>                                     are running multiple tornado processes,</p><p>                                     log_file_prefix must be different for each</p><p>                                     of them (e.g. include the port number)</p><p>    --log_to_stderr                  Send log output to stderr (colorized if</p><p>                                     possible). By default use stderr if</p><p>                                     --log_file_prefix is not set and no other</p><p>                                     logging is configured.</p><p>    --logging=debug|info|warning|error|none</p><p>                                     Set the Python log level. If 'none', tornado</p><p>                                     won't touch the logging configuration.</p><p>                                     (default info)</p><p>```</p><p>Bug tracker</p><p>-----------</p><p>If you have any suggestions, bug reports or annoyances please report them to</p><p>the issue tracker at https://github.com/klen/graphite-beacon/issues</p><p>Contributors</p><p>-------------</p><p>* Andrej Kuročenko (https://github.com/kurochenko)</p><p>* Cody Soyland (https://github.com/codysoyland)</p><p>* Garrett Heel (https://github.com/GarrettHeel)</p><p>* George Ionita (https://github.com/georgeionita)</p><p>* James Yuzawa (https://github.com/yuzawa-san)</p><p>* Kirill Klenov (https://github.com/klen)</p><p>* Konstantin Bakulin (https://github.com/kbakulin)</p><p>* Lammert Hellinga (https://github.com/Kogelvis)</p><p>* Miguel Moll (https://github.com/MiguelMoll)</p><p>* Nick Pillitteri (https://github.com/56quarters)</p><p>* Niku Toivola (https://github.com/nikut)</p><p>* Olli-Pekka Puolitaival (https://github.com/OPpuolitaival)</p><p>* Phillip Hagedorn (https://github.com/phagedorn)</p><p>* Raine Virta (https://github.com/raine)</p><p>* Scott Nonnenberg (https://github.com/scottnonnenberg)</p><p>* Sean Johnson (https://github.com/pirogoeth)</p><p>* Terry Peng (https://github.com/tpeng)</p><p>* Thomas Clavier (https://github.com/tclavier)</p><p>* Yuriy Ilyin (https://github.com/YuriyIlyin)</p><p>* dugeem (https://github.com/dugeem)</p><p>* Joakim (https://github.com/VibyJocke)</p><p>License</p><p>--------</p><p>Licensed under a [MIT license](http://www.linfo.org/mitlicense.html)</p><p>If you wish to express your appreciation for the role, you are welcome to send</p><p>a postcard to:</p><p>    Kirill Klenov</p><p>    pos. Severny 8-3</p><p>    MO, Istra, 143500</p><p>    Russia

</p><a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>177</span> downloads in the last week
  </li>
  <li>
    <span>1734</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>