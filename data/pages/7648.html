<html><body><div><div id="quickstart">
<h3>Quickstart</h3>
<p>Below is an example Flask app that only accepts the <tt>text/html</tt> media type:</p>
<pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_accept</span> <span class="kn">import</span> <span class="n">accept</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="nd">@accept</span><span class="p">(</span><span class="s1">'text/html'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">'Hello World!'</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre>
<p>When one tries to access the endpoint without a valid <tt>Accept</tt> header:</p>
<pre><span class="gp">$</span> curl localhost:5000 -I
<span class="go">HTTP/1.0 406 NOT ACCEPTABLE</span>
</pre>
<p>With the valid header:</p>
<pre><span class="gp">$</span> curl localhost:5000 -I -H <span class="s2">"Accept: text/html"</span>
<span class="go">HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8</span>
</pre>
<div id="adding-support-for-an-existing-endpoint">
<h4>Adding Support for an Existing Endpoint</h4>
<p>Given our example from before, we can add support for a different response to
an additonal media type as follows:</p>
<pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">from</span> <span class="nn">flask_accept</span> <span class="kn">import</span> <span class="n">accept</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="nd">@accept</span><span class="p">(</span><span class="s1">'text/html'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">'Hello World!'</span>

<span class="nd">@hello_world.support</span><span class="p">(</span><span class="s1">'application/json'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world_json</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">result</span><span class="o">=</span><span class="s2">"Hello World!"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre>
<p>Now our <tt>hello_world</tt> endpoint supports JSON:</p>
<pre><span class="gp">$</span> curl localhost:5000 -I -H <span class="s2">"Accept: application/json"</span>
<span class="go">HTTP/1.0 200 OK
Content-Type: application/json</span>
</pre>
</div>
<div id="falling-back-on-a-default-endpoint">
<h4>Falling Back on a Default Endpoint</h4>
<p>If we want to support a specific media type, but have every other request
fall back to a default endpoint, we can use <tt>accept_fallback</tt> as follows:</p>
<pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">from</span> <span class="nn">flask_accept</span> <span class="kn">import</span> <span class="n">accept</span><span class="p">,</span> <span class="n">accept_fallback</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="nd">@accept_fallback</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">'Hello World!'</span>

<span class="nd">@hello_world.support</span><span class="p">(</span><span class="s1">'application/json'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world_json</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">result</span><span class="o">=</span><span class="s2">"Hello World!"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre>
<p>Our <tt>hello_world</tt> endpoint still supports JSON, but for any other media type
(or if none is specified) it will fall back:</p>
<pre><span class="gp">$</span> curl localhost:5000 -I
<span class="go">HTTP/1.0 200 OK
Content-Type: text/html

</span><span class="gp">$</span> curl localhost:5000 -I -H <span class="s2">"Accept: madeup/mediatype"</span>
<span class="go">HTTP/1.0 200 OK
Content-Type: text/html</span>
</pre>
</div>
</div>
<div id="use-cases">
<h3>Use Cases</h3>
<p>Some possible use cases for Flask-Accept.</p>
<div id="versioning-your-api">
<h4>Versioning your API</h4>
<p>Flask-Accept let you accept any possible media type, including <a href="https://en.wikipedia.org/wiki/Media_type#Vendor_tree" rel="nofollow">custom vendored
media types</a>. This is
ideal for versioning an API using <tt>Accept</tt> headers only:</p>
<pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">from</span> <span class="nn">flask_accept</span> <span class="kn">import</span> <span class="n">accept</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="nd">@accept</span><span class="p">(</span><span class="s1">'application/vnd.your_vendor.v1'</span><span class="p">,</span> <span class="s1">'application/vnd.your_vendor.v2'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">'Hello World!'</span>

<span class="nd">@hello_world.support</span><span class="p">(</span><span class="s1">'application/vnd.your_vendor.v3'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world_v2</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">'Goodbye cruel world.'</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre>
<pre><span class="gp">$</span> curl localhost:5000 -H <span class="s2">"Accept: application/vnd.your_vendor.v1"</span>
<span class="go">Hello World!

</span><span class="gp">$</span> curl localhost:5000 -H <span class="s2">"Accept: application/vnd.your_vendor.v2"</span>
<span class="go">Hello World!

</span><span class="gp">$</span> curl localhost:5000 -H <span class="s2">"Accept: application/vnd.your_vendor.v3"</span>
<span class="go">Goodbye cruel world.</span>
</pre>
</div>
</div>
</div></body></html>