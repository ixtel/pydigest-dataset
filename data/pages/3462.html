<html><body><div><p class="lead" itemprop="description">И тут вы заметили, что nginx время от времени отвечает ошибкой 502, а в журнале uWSGI появились записи вида «invalid request block size: 11527 (max 4096)...skip».</p>
                <div class="py_user"><p>Вы, конечно, до настройки uWSGI прочли </p><a href="http://uwsgi-docs.readthedocs.org/en/latest/ThingsToKnow.html" target="_blank">обязательное</a><p> и знаете, что заголовки каждого из запросов uWSGI хранит в буфере размером </p><i>4096 байт</i><p> по умолчанию. И что этот буфер, в случае необходимости, можно увеличить директивой </p><code>buffer-size</code><p> в файле конфигурации, или задать параметром </p><code>-b</code><p> в командной строке.</p><p>Но бездумное изменение настроек, скорее всего, не наш метод. И мы уже понимаем, что спонтанность 502 связана с конкретными запросами. Значит, нужно отследить на каких конкретно запросах возникает ошибка. </p><p>Запросы можно увидеть в журнале uWSGI (если вы его для этого предварительно настроили), либо сравнивая журналы uWSGI и nginx.</p><p>Есть большая доля вероятности, что вы обнаружите там длинные GET-запросы. Вы же помните, что метод GET передаёт параметры не в теле запроса, а в заголовках.</p><p>Итак, причина ошибок обнаружена, теперь-то точно можно перейти к их устранению. Ну, а тут должно быть понятно, что первым делом следует попробовать заменить эти запросы на POST, и только если это не вариант, переходить к увеличению размера буфера, упомянутому в начале статьи.</p><p>Удачи!</p></div>

                

                

                </div></body></html>