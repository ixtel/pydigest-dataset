<html><body><div><div class="caption">
						
						<p>I wrote a little script using <em>duct tape</em> approach to parse yify subtitles site. Hope you will find it useful. I assume you are familiar with python.</p>

<p>So first we need a url of the subtitle page for any movie, Lets take Nightcrawler page. Now we are going to download this page using urllib2 library, read the content with .read() function and print the output.</p>

<pre class="prettyprint">import urllib2url = "http://www.yifysubtitles.com/movie-imdb/tt2872718"
response = urllib2.urlopen(url)
print response.read()
</pre>

<p>
So we got a jumble of html, css code that looks really ugly.</p>

<pre class="prettyprint">
...
_gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www')
+ '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s[removed].insertBefore(ga, s); })(); [removed]&amp;lt;!-- 
+ BuySellAds Ad Code --&amp;gt; [removed] (function(){ var bsa = document.createElement('script'); bsa.type = 'text/javascript'; bsa.async = true; bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
+ (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa); })(); [removed] &amp;lt;!--
+ End BuySellAds Ad Code --&amp;gt; &amp;lt;!-- Facebook --&amp;gt; &lt;div id="fb-root"&gt;&lt;/div&gt; 
+ [removed](function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect
...
</pre>

<p>Now there is python module to clean it up called html2text, you can install it with the command</p>

<p><em>pip install html2text</em></p>

<p>so lets import the module and use it to clean up that ugliness.</p>

<pre class="prettyprint">import urllib2
from html2text import html2text
url = "http://www.yifysubtitles.com/movie-imdb/tt2872718"
response = urllib2.urlopen(url).read()
print html2text(response.decode("utf-8"))</pre>

<p>Now that’s beautiful.</p>

<pre class="prettyprint"># [Subtitles for YIFY movie Nightcrawler](/)
![avatar](/images/avatars/default.jpg)[login](/login)

![Game-Price.com](/images/misc/ad-gameprice.png)

![Nightcrawler](/images/movies/movie-3722.jpg)

Runtime: 117 min

Rated: R

Released: 31 Oct 2014

Director: Dan Gilroy

Writer: Dan Gilroy

Actors: Jake Gyllenhaal, Michael Papajohn, Marco Rodríguez, Bill Paxton

DVD release: 10 Feb 2015

Box Office: $32.0M  
</pre>

<p>i have also made some little changes like reading the content of reponse in the previous line, used deocde function to decode the bytes to the Unicode.</p>

<p>Now if you visit our page url you can see there is a list of subtitles in different languages, well the only languge i know from the list is english,
<em>I know i know</em> ,so i just need the link for the english subtitle, lets see our cleaned up response for that.</p>

<pre class="prettyprint">
95%Rotten Tomatoes

*   upvote6downvote[Dutch subtitle Nightcrawler](/subtitles/nightcrawler-dutch-yify-35967)[download](/subtitles/nightcrawler-dutch-yify-35967)
*   upvote28downvote[English subtitle Nightcrawler](/subtitles/nightcrawler-english-yify-35973)[download](/subtitles/nightcrawler-english-yify-35973)
*   upvote5downvote[Spanish subtitle Nightcrawler](/subtitles/nightcrawler-spanish-yify-35968)[download](/subtitles/nightcrawler-spanish-yify-35968)
*   upvote0downvote[Arabic subtitle Nightcrawler](/subtitles/nightcrawler-arabic-yify-35970)[download](/subtitles/nightcrawler-arabic-yify-35970)
</pre>

<p>and if you visit the page and look at the link for english subtitle you will see that we have the link minus the site, so now we need to filter this line out.</p>

<p>First we will make a list out of this cleaned up response using the .split() method with the newline character and run a for loop over the list, then i will use a simple if “xyz” in line: condition to filter out our target line which in our case is english subtitle line.</p>

<pre class="prettyprint">
import urllib2
from html2text import html2text
url = "http://www.yifysubtitles.com/movie-imdb/tt2872718"
response = urllib2.urlopen(url).read()
niceresponse = html2text(response.decode("utf-8"))
datalist = niceresponse.split("\n")
for line in datalist:
    if "[English subtitle" in line:
        print line</pre>

<p>So we got 4 lines in the output</p>

<pre class="prettyprint">
  * upvote28downvote[English subtitle Nightcrawler](/subtitles/nightcrawler-english-yify-35973)[download](/subtitles/nightcrawler-english-yify-35973)
  * upvote1downvote[English subtitle Nightcrawler](/subtitles/nightcrawler-english-yify-35966)[download](/subtitles/nightcrawler-english-yify-35966)
  * upvote0downvote[English subtitle Nightcrawler](/subtitles/nightcrawler-english-yify-36016)[download](/subtitles/nightcrawler-english-yify-36016)
  * upvote0downvote[English subtitle Nightcrawler](/subtitles/nightcrawler-english-yify-36017)[download](/subtitles/nightcrawler-english-yify-36017)</pre>

<p>If you look at subtitle pages of other movies you’ll see that first subtitle is the most downloaded on so that means we just need the first subtitle from these 4.</p>

<p>We are going to use if: opration then break, it will break the for loop as soon as the if condition is met. Basically <em>Take the first one and run.</em></p>

<pre class="prettyprint">
import urllib2
from html2text import html2text
url = "http://www.yifysubtitles.com/movie-imdb/tt2872718"
response = urllib2.urlopen(url).read()
niceresponse = html2text(response.decode("utf-8"))
datalist = niceresponse.split("\n")
for line in datalist:
    if "[English subtitle" in line:
        finalline = line
        break
print finalline </pre>

<p>So now we have our line with some extra stuff attached to it, we just need the link.</p>

<pre class="prettyprint">
  * upvote28downvote[English subtitle Nightcrawler](/subtitles/nightcrawler-english-yify-35973)[download](/subtitles/nightcrawler-english-yify-35973)</pre>

<p>Lets use split one more time with “[download]” to make a list and get value 1 (second value) from the list in the same line. We will also use .strip(“”) a couple of times to get rid of the extra brackets.</p>

<pre class="prettyprint">
import urllib2
from html2text import html2text
url = "http://www.yifysubtitles.com/movie-imdb/tt2872718"
response = urllib2.urlopen(url).read()
niceresponse = html2text(response.decode("utf-8"))
datalist = niceresponse.split("\n")
for line in datalist:
    if "[English subtitle" in line:
        finalline = line
        break
        
partlink = finalline.split("[download]")[1].strip("(").strip(")")
print partlink
</pre>

<p>So we now have a part of our link.</p>

<pre class="prettyprint">
/subtitles/nightcrawler-english-yify-35973
</pre>

<p>lets add the website url and make it a working link to the page and lets also do all this inside a funtion and return the final value.</p>

<pre class="prettyprint">
import urllib2
from html2text import html2text
url = "http://www.yifysubtitles.com/movie-imdb/tt2872718"
site = "http://www.yifysubtitles.com"

def pagefinder(url):
    response = urllib2.urlopen(url).read()
    niceresponse = html2text(response.decode("utf-8"))
    datalist = niceresponse.split("\n")
    for line in datalist:
        if "[English subtitle" in line:
            finalline = line
            break
        
    partlink = finalline.split("[download]")[1].strip("(").strip(")")
    finallink = site + partlink
    return finallink

print pagefinder(url)
</pre>

<p>So now our function could give us a working link for the english subtitle page, but that’s not the Download subtitle link. Its a page with the download button on it. -_-</p>

<pre class="prettyprint">
<a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwww.yifysubtitles.com%2Fsubtitles%2Fnightcrawler-english-yify-35973&amp;t=ZWRlZDg3MWMxY2NhZDZiODBiZjI1ODY5NzllYmEwZmU5NTMxMmViNixNZHREWjVQNA%3D%3D" target="_blank">http://www.yifysubtitles.com/subtitles/nightcrawler-english-yify-35973</a>
</pre>

<p>so lets quickly do the same stuff with this page too.</p>

<pre class="prettyprint">
import urllib2
from html2text import html2text
url = "http://www.yifysubtitles.com/movie-imdb/tt2872718"
site = "http://www.yifysubtitles.com"

def pagefinder(url):
    response = urllib2.urlopen(url).read()
    niceresponse = html2text(response.decode("utf-8"))
    datalist = niceresponse.split("\n")
    for line in datalist:
        if "[English subtitle" in line:
            finalline = line
            break
        
    partlink = finalline.split("[download]")[1].strip("(").strip(")")
    finallink = site + partlink
    return finallink

response = urllib2.urlopen(pagefinder(url)).read()
datalist = html2text(response.decode("utf-8")).split("\n")
for line in datalist:
    if "[Download subtitle]" in line:
        print line
</pre>

<p>in this step we will find that for some weird reason html2text module broken our file link in two lines and we are only getting the first part.</p>

<pre class="prettyprint">[Download subtitle](<a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwww.yifysubtitles.com%2Fsubtitle%2Fnightcrawler-&amp;t=MzRhZDExMmUwZGI1MWI4ZDkzZWFmZmIxZjI1ODY5M2RkNWQxYTQxMyxNZHREWjVQNA%3D%3D" target="_blank">http://www.yifysubtitles.com/subtitle/nightcrawler-</a>
</pre>

<p>if we look in the datalist we could see that the next part of the link end with the .zip extention and this is true for all links on this site so lets <em>add some duck tape</em> to fix this and make one more function for this part.</p>

<pre class="prettyprint">
import urllib2
from html2text import html2text
site = "http://www.yifysubtitles.com"
part = "/movie-imdb/"
imdbid = "tt2872718"
url = site + part + imdbid

def pagefinder(url):
    response = urllib2.urlopen(url).read()
    niceresponse = html2text(response.decode("utf-8"))
    datalist = niceresponse.split("\n")
    for line in datalist:
        if "[English subtitle" in line:
            finalline = line
            break
        
    partlink = finalline.split("[download]")[1].strip("(").strip(")")
    finallink = site + partlink
    return finallink

def linkfinder(url):
    response = urllib2.urlopen(pagefinder(url)).read()
    datalist = html2text(response.decode("utf-8")).split("\n")
    for line in datalist:
        if "[Download subtitle]" in line:
            part1 = line
        elif ".zip" in line:
            part2 = line
        
    finalline = part1 + part2
    finallink = finalline.split("(")[1].strip(")")
    return finallink

print linkfinder(url)
</pre>

<p>Now this gives us our download link for the zip file, so lets download this file and look at our final code.</p>

<pre class="prettyprint">
import urllib2
from html2text import html2text
site = "http://www.yifysubtitles.com"
part = "/movie-imdb/"
imdbid = "tt2872718"
url = site + part + imdbid

def pagefinder(url):
    response = urllib2.urlopen(url).read()
    niceresponse = html2text(response.decode("utf-8"))
    datalist = niceresponse.split("\n")
    for line in datalist:
        if "[English subtitle" in line:
            finalline = line
            break
        
    partlink = finalline.split("[download]")[1].strip("(").strip(")")
    finallink = site + partlink
    return finallink

def linkfinder(url):
    response = urllib2.urlopen(pagefinder(url)).read()
    datalist = html2text(response.decode("utf-8")).split("\n")
    for line in datalist:
        if "[Download subtitle]" in line:
            part1 = line
        elif ".zip" in line:
            part2 = line
        
    finalline = part1 + part2
    finallink = finalline.split("(")[1].strip(")")
    return finallink

def downzip(sublink):
    f = urllib2.urlopen(sublink)
    print "Downloading " + url
    file_name = imdbid + ".zip"
    local_file = open(file_name, "wb")
    local_file.write(f.read())
    local_file.close()

try:
    sublink = linkfinder(url)
except:
    print "Can't download your file."

try:
    downzip(sublink)
except:
    print "Can't write your file to hd."
</pre>

<p>Now we have a working script that can download subtitles from yify subtitles website, i know we could have done lot more and more efficiently but this was not the target of this. i just wrote this to teach students how to use all this stuff together in one program.
So hope you liked it.
Thank you for reading.</p>
						
						</div> 
					    
                         
					
						</div></body></html>