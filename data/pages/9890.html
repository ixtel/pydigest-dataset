<html><body><div><div class="section">
              <h1>tubing 0.0.2.post172</h1>

              


<p>Python I/O pipe utilities</p>

<p>
   <a href="http://pythonhosted.org/tubing/">Package Documentation</a>
</p>






<a href="https://github.com/dokipen/tubing" rel="nofollow"><img src="https://imgur.com/Q9Lv0xo.png"/></a>
<hr class="docutils"/>
<a href="https://travis-ci.org/dokipen/tubing/" rel="nofollow"><img src="https://travis-ci.org/dokipen/tubing.svg?branch=master"/></a>
<a href="https://coveralls.io/github/dokipen/tubing?branch=master" rel="nofollow"><img src="https://coveralls.io/repos/github/dokipen/tubing/badge.svg?branch=master"/></a>
<a href="https://pypi.python.org/pypi/tubing/" rel="nofollow"><img src="https://img.shields.io/pypi/v/tubing.svg"/>
</a>
<a href="https://pypi.python.org/pypi/tubing/" rel="nofollow"><img src="https://img.shields.io/pypi/pyversions/tubing.svg"/>
</a>
<a href="https://pypi.python.org/pypi/tubing/" rel="nofollow"><img src="https://img.shields.io/pypi/dd/tubing.svg"/>
</a>
<a href="https://pypi.python.org/pypi/tubing/" rel="nofollow"><img src="https://img.shields.io/pypi/l/tubing.svg"/>
</a>
<a href="https://pypi.python.org/pypi/tubing/" rel="nofollow"><img src="https://img.shields.io/pypi/wheel/tubing.svg"/>
</a>
<a href="http://tubing.readthedocs.org/en/latest" rel="nofollow"><img src="https://readthedocs.org/projects/tubing/badge/?version=latest"/></a>
<a href="https://landscape.io/github/dokipen/tubing/master" rel="nofollow"><img src="https://landscape.io/github/dokipen/tubing/master/landscape.svg?style=flat"/></a>
<p>Tubing is a Python I/O library.  What makes tubing so freakin’ cool is the
gross abuse of the bit-wise OR operator (|). Have you ever been writing python
code and thought to yourself, “Man, this is great, but I really wish it was a
little more like bash.” Whelp, we’ve made python a little more like bash.If you
are a super lame nerd-kid, you can replace any of the bit-wise ORs with the
tube() function and pray we don’t overload any other operators in future
versions. Here’s how you install tubing:</p>
<pre>$ pip install tubing
</pre>
<p>Tubing is pretty bare-bones at the moment. We’ve tried to make it easy to add
your own functionality. Hopefully you find it not all that unpleasant. There
are three sections below for adding sources, tubes and sink. If you do make
some additions, think about committing them back upstream. We’d love to have
a full suite of tools.</p>
<p>Now, witness the power of this fully operational I/O library.</p>
<pre><span class="kn">from</span> <span class="nn">tubing</span> <span class="kn">import</span> <span class="n">sources</span><span class="p">,</span> <span class="n">tubes</span><span class="p">,</span> <span class="n">sinks</span>

<span class="n">objs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">dict</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">"Bob Corsaro"</span><span class="p">,</span>
        <span class="n">birthdate</span><span class="o">=</span><span class="s2">"08/03/1977"</span><span class="p">,</span>
        <span class="n">alignment</span><span class="o">=</span><span class="s2">"evil"</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">"Tom Brady"</span><span class="p">,</span>
        <span class="n">birthdate</span><span class="o">=</span><span class="s2">"08/03/1977"</span><span class="p">,</span>
        <span class="n">alignment</span><span class="o">=</span><span class="s2">"good"</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">]</span>
<span class="n">sources</span><span class="o">.</span><span class="n">Objects</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">tubes</span><span class="o">.</span><span class="n">JSONDumps</span><span class="p">()</span> \
     <span class="o">|</span> <span class="n">tubes</span><span class="o">.</span><span class="n">Joined</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">b</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">tubes</span><span class="o">.</span><span class="n">Gzip</span><span class="p">()</span> \
     <span class="o">|</span> <span class="n">sinks</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s2">"output.gz"</span><span class="p">,</span> <span class="s2">"wb"</span><span class="p">)</span>
</pre>
<p>Then in our old friend bash.</p>
<pre>$ zcat output.gz
<span class="o">{</span><span class="s2">"alignment"</span>: <span class="s2">"evil"</span>, <span class="s2">"birthdate"</span>: <span class="s2">"08/03/1977"</span>, <span class="s2">"name"</span>: <span class="s2">"Bob Corsaro"</span><span class="o">}</span>
<span class="o">{</span><span class="s2">"alignment"</span>: <span class="s2">"good"</span>, <span class="s2">"birthdate"</span>: <span class="s2">"08/03/1977"</span>, <span class="s2">"name"</span>: <span class="s2">"Tom Brady"</span><span class="o">}</span>
$
</pre>
<p>You can find more documentation on <a href="https://tubing.readthedocs.org/" rel="nofollow">readthedocs</a></p>
<div id="catalog">
<h2>Catalog</h2>
<div id="sources">
<h3>Sources</h3>
<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><td><cite>Objects</cite></td>
<td>Takes a <cite>list</cite> of python objects.</td>
</tr>
<tr><td><cite>File</cite></td>
<td>Creates a stream from a file.</td>
</tr>
<tr><td><cite>Bytes</cite></td>
<td>Takes a byte string.</td>
</tr>
<tr><td><cite>IO</cite></td>
<td>Takes an object with a read function.</td>
</tr>
<tr><td><cite>Socket</cite></td>
<td>Takes an addr, port and socket() args.              .</td>
</tr>
<tr><td><cite>HTTP</cite></td>
<td>Takes an method, url and any args that can be passed
to requests library.</td>
</tr>
</tbody>
</table>
</div>
<div id="tubes">
<h3>Tubes</h3>
<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><td><cite>Gunzip</cite></td>
<td>Unzips a binary stream.</td>
</tr>
<tr><td><cite>Gzip</cite></td>
<td>Zips a binary stream.</td>
</tr>
<tr><td><cite>JSONLoads</cite></td>
<td>Parses a byte string stream of raw JSON objects. Will
try to use ujson, then built-in json.</td>
</tr>
<tr><td><cite>JSONDumps</cite></td>
<td>Serializes an object stream using <cite>json.dumps</cite>. Will
try to use ujson, then built-in json.</td>
</tr>
<tr><td><cite>Split</cite></td>
<td>Splits a stream that supports the <cite>split</cite> method.</td>
</tr>
<tr><td><cite>Joined</cite></td>
<td>Joins a stream of the same type as the <cite>by</cite> argument.</td>
</tr>
<tr><td><cite>Tee</cite></td>
<td>Takes a sink and passes chunks along apparatus.</td>
</tr>
<tr><td><cite>Map</cite></td>
<td>Takes a transformer function for single items in
stream.</td>
</tr>
<tr><td><cite>Filter</cite></td>
<td>Takes a filter test callback and only forwards items
that pass.</td>
</tr>
<tr><td><cite>ChunkMap</cite></td>
<td>Takes a transformer function for batch of stream
items.</td>
</tr>
</tbody>
</table>
</div>
<div id="sinks">
<h3>Sinks</h3>
<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><td><cite>Objects</cite></td>
<td>A list that stores all passed items to self.</td>
</tr>
<tr><td><cite>Bytes</cite></td>
<td>Saves each chunk self.results.</td>
</tr>
<tr><td><cite>File</cite></td>
<td>Writes each chunk to a file.</td>
</tr>
<tr><td><cite>HTTPPost</cite></td>
<td>Writes data via HTTPPost.</td>
</tr>
<tr><td><cite>Hash</cite></td>
<td>Takes algorithm name, updates hash with contents.</td>
</tr>
<tr><td><cite>Debugger</cite></td>
<td>Writes each chunk to the tubing.tubes debugger with level DEBUG.</td>
</tr>
</tbody>
</table>
</div>
<div id="extensions">
<h3>Extensions</h3>
<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><td><cite>s3.S3Source</cite></td>
<td>Create stream from an S3 object.</td>
</tr>
<tr><td><cite>s3.MultipartUploader</cite></td>
<td>Stream data to S3 object.</td>
</tr>
<tr><td><cite>elasticsearch.BulkSink</cite></td>
<td>Stream <cite>elasticsearch.DocUpdate</cite> objects to the
elasticsearch _bulk endpoint.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="id1">
<h2>Sources</h2>
<p>To make your own source, create a Reader class with the following interface.</p>
<pre><span class="k">class</span> <span class="nc">MyReader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""
    MyReader returns count instances of data.
    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">"hello world</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amt</span><span class="p">):</span>
        <span class="sd">"""
        read(amt) returns $amt of data and a boolean indicating EOF.
        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">amt</span><span class="p">:</span>
            <span class="n">amt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">amt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">-=</span> <span class="n">amt</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;=</span> <span class="mi">0</span>
</pre>
<p>The important thing to remember is that your read function should return an
iterable of units of data, not a single piece of data. Then wrap your reader in
the loving embrace of MakeSourceFactory.</p>
<pre><span class="kn">from</span> <span class="nn">tubing</span> <span class="kn">import</span> <span class="n">sources</span>

<span class="n">MySource</span> <span class="o">=</span> <span class="n">sources</span><span class="o">.</span><span class="n">MakeSourceFactory</span><span class="p">(</span><span class="n">MyReader</span><span class="p">)</span>
</pre>
<p>Now it can be used in a apparatus!</p>
<pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">from</span> <span class="nn">tubing</span> <span class="kn">import</span> <span class="n">tubes</span>
<span class="n">sink</span> <span class="o">=</span> <span class="n">MySource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"goodbye cruel world!"</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">tubes</span><span class="o">.</span><span class="n">Joined</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">b</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">sinks</span><span class="o">.</span><span class="n">Bytes</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">sinks</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
<span class="c1"># Output: goodbye cruel world!</span>
</pre>
</div>
<div id="id2">
<h2>Tubes</h2>
<p>Making your own tube is a lot more fun, trust me. First make a Transformer.</p>
<pre><span class="k">class</span> <span class="nc">OptimusPrime</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span>
</pre>
<p><cite>chunk</cite> is an iterable with a len() of whatever type of data the stream is
working with. In Transformers, you don’t need to worry about buffer size or
closing or exception, just transform an iterable to another iterable. There are
lots of examples in tubes.py.</p>
<p>Next give Optimus Prime a hug.</p>
<pre><span class="kn">from</span> <span class="nn">tubing</span> <span class="kn">import</span> <span class="n">tubes</span>

<span class="n">AllMixedUp</span> <span class="o">=</span> <span class="n">tubes</span><span class="o">.</span><span class="n">MakeTranformerTubeFactory</span><span class="p">(</span><span class="n">OptimusPrime</span><span class="p">)</span>
</pre>
<p>Ready to mix up some data?</p>
<pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">tubing</span> <span class="kn">import</span> <span class="n">sources</span><span class="p">,</span> <span class="n">sinks</span>

<span class="n">objs</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">"number"</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>

<span class="n">sink</span> <span class="o">=</span> <span class="n">sources</span><span class="o">.</span><span class="n">Objects</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">AllMixedUp</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">sinks</span><span class="o">.</span><span class="n">Objects</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sink</span><span class="p">))</span>
<span class="c1"># Output: [{"number": 1}, {"number": 0}, {"number": 3}, {"number": 2}, {"number": 5}, {"number": 4}, {"number": 7}, {"number": 6}, {"number": 9}, {"number": 8}]</span>
</pre>
</div>
<div id="id3">
<h2>Sinks</h2>
<p>Really getting tired of making documentation… Maybe I’ll finish later. I have real work to do.</p>
<p>Well.. I’m this far, let’s just push through.</p>
<pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">tubing</span> <span class="kn">import</span> <span class="n">sources</span><span class="p">,</span> <span class="n">tubes</span><span class="p">,</span> <span class="n">sinks</span>

<span class="k">class</span> <span class="nc">StdoutWriter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># this function is optional</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"That's all folks!"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">abort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># this is also optional</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"Something terrible has occurred."</span><span class="p">)</span>

<span class="n">Debugger</span> <span class="o">=</span> <span class="n">sinks</span><span class="o">.</span><span class="n">MakeSinkFactory</span><span class="p">(</span><span class="n">StdoutWriter</span><span class="p">)</span>

<span class="n">objs</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">"number"</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>

<span class="n">sink</span> <span class="o">=</span> <span class="n">sources</span><span class="o">.</span><span class="n">Objects</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">AllMixedUp</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">tubes</span><span class="o">.</span><span class="n">JSONDumps</span><span class="p">()</span> \
     <span class="o">|</span> <span class="n">tubes</span><span class="o">.</span><span class="n">Joined</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">b</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">Debugger</span><span class="p">()</span>
<span class="c1"># Output:</span>
<span class="c1">#{"number": 1}</span>
<span class="c1">#{"number": 0}</span>
<span class="c1">#{"number": 3}</span>
<span class="c1">#{"number": 2}</span>
<span class="c1">#{"number": 5}</span>
<span class="c1">#{"number": 4}</span>
<span class="c1">#{"number": 7}</span>
<span class="c1">#{"number": 6}</span>
<span class="c1">#{"number": 9}</span>
<span class="c1">#{"number": 8}</span>
<span class="c1">#That's all folks!</span>
</pre>
</div>


<a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>3360</span> downloads in the last week
  </li>
  <li>
    <span>18682</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>