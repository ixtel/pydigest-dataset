<html><body><div><div class="post-body entry-content"><p>
By </p><a href="http://www.dancingbison.com">Vasudev Ram</a><p/><a href=""/><p>
Some days ago, I had blogged about </p><a href="http://jugad2.blogspot.in/2014/12/pydal-pure-python-database-abstraction_30.html">pyDAL, a pure Python Database Abstraction Layer</a><p>.
</p><a href=""/><p>
Today I thought of writing a program to </p><b>publish database data</b><p> to </p><a href="http://en.wikipedia.org/wiki/Portable_Document_Format">PDF</a><p>, using </p><a href="https://github.com/web2py/pydal/blob/master/README.md"/><a href="https://github.com/web2py/pydal/blob/master/README.md"/><p>PyDAL and </p><a href="https://google.com/search?q=xtopdf">xtopdf</a><p>, my </p><b>open source Python library</b><p> for </p><b>PDF creation</b><p> from other file formats.
</p><p>
(Here is a good </p><a href="http://slid.es/vasudevram/xtopdf">online overview about xtopdf</a><p>, for those new to it.)
</p><p>
So here is the code for </p><b>PyDALtoPDF<b/></b><p>.py:
</p><pre>"""
Author: Vasudev Ram
Copyright 2014 Vasudev Ram - www.dancingbison.com
This program is a demo of how to use the PyDAL and xtopdf Python libraries 
together to publish database data to PDF.
PyDAL is at: https://github.com/web2py/pydal/blob/master/README.md
xtopdf is at: https://bitbucket.org/vasudevram/xtopdf
and info about xtopdf is at: http://slides.com/vasudevram/xtopdf or 
at: http://slid.es/vasudevram/xtopdf
"""

# imports
from pydal import DAL, Field
from PDFWriter import PDFWriter

SEP = 60

# create the database
db = DAL('sqlite://house_depot.db')

# define the table
db.define_table('furniture', \
    Field('id'), Field('name'), Field('quantity'), Field('unit_price')
)

# insert rows into table
items = ( \
    (1, 'chair', 40, 50),
    (2, 'table', 10, 300),
    (3, 'cupboard', 20, 200),
    (4, 'bed', 30, 400)
)
for item in items:
    db.furniture.insert(id=item[0], name=item[1], quantity=item[2], unit_price=item[3])

# define the query
query = db.furniture
# the above line shows an interesting property of PyDAL; it seems to 
# have some flexibility in how queries can be defined; in this case,
# just saying db.table_name tells it to fetch all the rows 
# from table_name; there are other variations possible; I have not 
# checked out all the options, but the ones I have seem somewhat 
# intuitive.

# run the query
rows = db(query).select()

# setup the PDFWriter
pw = PDFWriter('furniture.pdf')
pw.setFont('Courier', 10)
pw.setHeader('     House Depot Stock Report - Furniture Division     '.center(60))
pw.setFooter('Generated by xtopdf: http://google.com/search?q=xtopdf')

pw.writeLine('=' * SEP)

field_widths = (5, 10, 10, 12, 10)

# print the header row
pw.writeLine(''.join(header_field.center(field_widths[idx]) for idx, header_field in enumerate(('#', 'Name', 'Quantity', 'Unit price', 'Price'))))

pw.writeLine('-' * SEP)

# print the data rows
for row in rows:
    # methinks the writeLine argument gets a little long here ...
    # the first version of the program was taller but thinner :)
    pw.writeLine(''.join(str(data_field).center(field_widths[idx]) for idx, data_field in enumerate((row['id'], row['name'], row['quantity'], row['unit_price'], int(row['quantity']) * int(row['unit_price'])))))

pw.writeLine('=' * SEP)
pw.close()

</pre><p>I ran it (on Windows) with:
</p><pre>$ py PyDALtoPDF.py 2&gt;NUL
</pre><p>Here is a screenshot of the output in Foxit PDF Reader:

</p><p>
- Enjoy.
</p><p>
--- </p><a href="http://jugad2.blogspot.com/search/label/python">Posts about Python</a><p>  ---  </p><a href="http://jugad2.blogspot.com/search/label/xtopdf">Posts about xtopdf</a><p> ---</p><p/><p>- </p><a href="http://jugad2.blogspot.in/p/about-vasudev-ram.html">Vasudev Ram - Python programming and training</a><p/><b><a href="mailto:vasudevram@gmail.com?subject=Email%20me%20about%20your%20new%20products%20and%20services">Signup to hear about new products or services from me.</a></b><p/><a href="http://www.dancingbison.com/contact.html">Contact Page</a>

   
<p/>
</div>
</div></body></html>