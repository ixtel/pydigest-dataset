<html><body><div><div id="content">

            

            
        


            <div class="section">
              <h1>django-tequila 2.0.2</h1>

              


<p>A Tequila authentication backend for django</p>



<p>
<strong>Latest Version: </strong><a title="Latest Version URL" href="https://pypi.python.org/pypi/django-tequila/2.1.0">
<span>2.1.0</span>
</a>
</p>





<div id="requirements">
<h2>Requirements</h2>
<p><tt><span class="pre">django-tequila</span></tt> needs a modern version of Django – something after 1.6.
See django-tequila 1.9.x for the pre Django 1.6.
This project also expects a fully operational <a href="http://tequila.epfl.ch/" rel="nofollow">Tequila</a> server.</p>
</div>
<div id="installation">
<h2>Installation</h2>
<blockquote>
pip install django-tequila</blockquote>
</div>
<div id="configuration">
<h2>Configuration</h2>
<p>You can find an django app example in <tt><span class="pre">./django-tequila/sample_app</span></tt></p>
<div id="settings-py">
<h3>settings.py</h3>
<ul>
<li><p>Add at the end of your <tt>MIDDLEWARE_CLASSES</tt>:</p>
<pre>'django_tequila.middleware.TequilaMiddleware',
</pre>
</li>
<li><p>Add to <tt>INSTALLED_APPS</tt>:</p>
<pre>'django_tequila',
</pre>
</li>
<li><p>Add the line:</p>
<pre>AUTHENTICATION_BACKENDS = ('django_tequila.django_backend.TequilaBackend',)
</pre>
</li>
<li><p>Set a name that will be displayed on the tequila login page:</p>
<pre>TEQUILA_SERVICE_NAME = "django_tequila_service"
</pre>
</li>
<li><p>Finally, add:</p>
<pre>    LOGIN_URL = "/login"
    LOGIN_REDIRECT_URL = "/"
    LOGIN_REDIRECT_IF_NOT_ALLOWED = "/not_allowed"
LOGOUT_URL = '/'
</pre>
</li>
</ul>
</div>

<div id="profile-customization">
<h3>Profile customization</h3>
<p>You may want to keep some additional informations about the user.
Take a look at <a href="http://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users" rel="nofollow">this page</a> for more informations about profile customization.</p>
<p>Here is an example for a profile for Django 1.1+. With Django 1.5+, you may advise to use <a href="https://docs.djangoproject.com/en/dev/topics/auth/customizing/#auth-custom-user" rel="nofollow">this way</a>.</p>
<ul>
<li><p>Create a profile in your <cite>models.py</cite>, like this:</p>
<pre>from django.contrib.auth.models import User
from django.db import models

class UserProfile(models.Model):
    #required field
    user = models.ForeignKey(User, unique=True)

    sciper = models.PositiveIntegerField(null=True, blank=True)
    where = models.CharField(max_length=100, null=True, blank=True)
    units = models.CharField(max_length=300, null=True, blank=True)
    group = models.CharField(max_length=150, null=True, blank=True)
    classe = models.CharField(max_length=100, null=True, blank=True)
    statut = models.CharField(max_length=100, null=True, blank=True)

# Trigger for creating a profile on user creation
def user_post_save(sender, instance, **kwargs):
    profile, new = UserProfile.objects.get_or_create(user=instance)

# Register the trigger
models.signals.post_save.connect(user_post_save, sender=User)
</pre>
</li>
<li><p>in your <cite>settings.py</cite>, tell django to use your model:</p>
<pre>AUTH_PROFILE_MODULE = "my_app.userprofile"
</pre>
</li>
<li><p>Update your database:</p>
<pre>./manage.py syncdb
</pre>
</li>
</ul>
</div>
<div id="site-admin-customizations">
<h3>Site Admin customizations</h3>
<p>If you want to use the admin site, be sure you have followed all steps to have a working django admin site,
then follow these steps :</p>
<ul>
<li><p>Modify your urls.py to look like this:</p>
<pre>from django.contrib import admin
from django_tequila.admin import TequilaAdminSite
admin.autodiscover()
admin.site.__class__ = TequilaAdminSite
</pre>
</li>
<li><p>Please note that your username should identical to the one you use to login in Tequila.
If you do not have any user at the moment, or you want to edit some of them,
create a superuser with this command (replace &lt;USERNAME&gt; and &lt;EMAIL&gt; with you Tequila username and email):</p>
<pre>python manage.py createsuperuser --username=&lt;USERNAME&gt; --email=&lt;EMAIL&gt;
</pre>
</li>
</ul>
</div>
</div>
<div id="additional-tips-and-settings">
<h2>Additional tips and settings</h2>
<div id="advanced-settings">
<h3>Advanced settings</h3>
<ul>
<li><p>If you need to use your personal server, change this parameter:</p>
<pre>TEQUILA_SERVER_URL = "https://tequila.epfl.ch"
</pre>
</li>
<li><p>You may want to create an inactive user when someone try to connect to your app. So you can manually control who access it.
If this is the case, add this line to <cite>settings.py</cite>:</p>
<pre>TEQUILA_NEW_USER_INACTIVE = True
</pre>
</li>
<li><p>You may want to add some custom allow with Tequila.
If this is the case, add this line to <cite>settings.py</cite>:</p>
<pre>TEQUILA_CONFIG_ALLOW = 'categorie=shibboleth'
</pre>
</li>
<li><p>You may want to add some custom paramaters with Tequila.
If this is the case, add this line to <cite>settings.py</cite>:</p>
<pre>TEQUILA_CONFIG_ADDITIONAL = {'allowedorgs': 'EPFL, UNIL'}
</pre>
</li>
<li><p>Everytime the user connect trought the Tequila process, he is redirected to an url
that has a ‘key’ paramter. For some esthetic reasons,you may want to remove this parameter,
so add this line to <cite>settings.py</cite>:</p>
<pre>TEQUILA_CLEAN_URL = True
</pre>
<p>As it creates a redirect to the cleaned address and add an additional page hit, The value by default is False</p>
</li>
<li><p>You can force a strong authentication
so add this line to <cite>settings.py</cite>:</p>
<pre>TEQUILA_STRONG_AUTHENTICATION = True
</pre>
<p>Default value is False</p>
</li>
</ul>
</div>
<div id="login-logout-links">
<h3>Login/logout links</h3>
<p>If you want the user to be redirected to a specific page after he logged/logout successfully, you have to add the ‘next’ parameter to your login url,
like the default Django authentication backend.
See <a href="https://docs.djangoproject.com/en/dev/ref/settings/#login-redirect-url" rel="nofollow">Django help for login-redirect-url</a> for more informations.</p>
</div>
</div>


<a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>93</span> downloads in the last week
  </li>
  <li>
    <span>671</span> downloads in the last month
  </li>
</ul>









            </div>


          </div>
          </div></body></html>