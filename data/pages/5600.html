<html><body><div><div id="article">
		<h1 id="note">Note</h1>

<p>You can access the Ipython notebook code <a href="https://github.com/NSchrading/intro-spacy-nlp">here</a>. This is intended to be run in an Ipython notebook, but the code can be copied and pasted into a python interpreter and it should work as well. Follow the readme on the github page above to get the dependencies required to run this code.</p>

<p>This tutorial is intended as a way for people with some experience doing machine learning and natural language processing to get started performing complex tasks in Python using <a href="https://honnibal.github.io/spaCy/">spaCy</a> and <a href="http://scikit-learn.org/stable/">scikit-learn</a>.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Set up spaCy</span>
<span class="kn">from</span> <span class="nn">spacy.en</span> <span class="kn">import</span> <span class="n">English</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">English</span><span class="p">()</span>

<span class="c"># Test Data</span>
<span class="n">multiSentence</span> <span class="o">=</span> <span class="s">"There is an art, it says, or rather, a knack to flying."</span> \
                 <span class="s">"The knack lies in learning how to throw yourself at the ground and miss."</span> \
                 <span class="s">"In the beginning the Universe was created. This has made a lot of people "</span>\
                 <span class="s">"very angry and been widely regarded as a bad move."</span></code></pre></div>

<h1 id="spacy-does-tokenization-sentence-recognition-part-of-speech-tagging-lemmatization-dependency-parsing-and-named-entity-recognition-all-at-once">spaCy does tokenization, sentence recognition, part of speech tagging, lemmatization, dependency parsing, and named entity recognition all at once!</h1>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># all you have to do to parse text is this:</span>
<span class="c">#note: the first time you run spaCy in a file it takes a little while to load up its modules</span>
<span class="n">parsedData</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="n">multiSentence</span><span class="p">)</span>

<span class="c"># Let's look at the tokens</span>
<span class="c"># All you have to do is iterate through the parsedData</span>
<span class="c"># Each token is an object with lots of different properties</span>
<span class="c"># A property with an underscore at the end returns the string representation</span>
<span class="c"># while a property without the underscore returns an index (int) into spaCy's vocabulary</span>
<span class="c"># The probability estimate is based on counts from a 3 billion word</span>
<span class="c"># corpus, smoothed using the Simple Good-Turing method.</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parsedData</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"original:"</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">orth</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">orth_</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"lowercased:"</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">lower_</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"lemma:"</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">lemma</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">lemma_</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"shape:"</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">shape_</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"prefix:"</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">prefix_</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"suffix:"</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">suffix</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">suffix_</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"log probability:"</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">prob</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Brown cluster id:"</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">cluster</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"----------------------------------------"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">break</span></code></pre></div>

<blockquote>
  <p>original: 300 There</p>
</blockquote>

<blockquote>
  <p>lowercased: 144 there</p>
</blockquote>

<blockquote>
  <p>lemma: 300 There</p>
</blockquote>

<blockquote>
  <p>shape: 187 Xxxxx</p>
</blockquote>

<blockquote>
  <p>prefix: 32 T</p>
</blockquote>

<blockquote>
  <p>suffix: 66 ere</p>
</blockquote>

<blockquote>
  <p>log probability: -7.663576126098633</p>
</blockquote>

<blockquote>
  <p>Brown cluster id: 1918</p>
</blockquote>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Let's look at the sentences</span>
<span class="n">sents</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c"># the "sents" property returns spans</span>
<span class="c"># spans have indices into the original string</span>
<span class="c"># where each index value represents a token</span>
<span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">parsedData</span><span class="o">.</span><span class="n">sents</span><span class="p">:</span>
    <span class="c"># go from the start to the end of each span, returning each token in the sentence</span>
    <span class="c"># combine each token using join()</span>
    <span class="n">sent</span> <span class="o">=</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parsedData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">string</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">sents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">sents</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span></code></pre></div>

<blockquote>
  <p>There is an art, it says, or rather, a knack to flying.</p>
</blockquote>

<blockquote>
  <p>The knack lies in learning how to throw yourself at the ground and miss.</p>
</blockquote>

<blockquote>
  <p>In the beginning the Universe was created.</p>
</blockquote>

<blockquote>
  <p>This has made a lot of people very angry and been widely regarded as a bad move.</p>
</blockquote>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Let's look at the part of speech tags of the first sentence</span>
<span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">parsedData</span><span class="o">.</span><span class="n">sents</span><span class="p">:</span>
    <span class="n">sent</span> <span class="o">=</span> <span class="p">[</span><span class="n">parsedData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span><span class="p">)]</span>
    <span class="k">break</span>

<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">orth_</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span><span class="p">)</span></code></pre></div>

<blockquote>
  <p>There DET</p>
</blockquote>

<blockquote>
  <p>is VERB</p>
</blockquote>

<blockquote>
  <p>an DET</p>
</blockquote>

<blockquote>
  <p>art NOUN</p>
</blockquote>

<blockquote>
  <p>, PUNCT</p>
</blockquote>

<blockquote>
  <p>it PRON</p>
</blockquote>

<blockquote>
  <p>says VERB</p>
</blockquote>

<blockquote>
  <p>, PUNCT</p>
</blockquote>

<blockquote>
  <p>or CONJ</p>
</blockquote>

<blockquote>
  <p>rather ADV</p>
</blockquote>

<blockquote>
  <p>, PUNCT</p>
</blockquote>

<blockquote>
  <p>a DET</p>
</blockquote>

<blockquote>
  <p>knack NOUN</p>
</blockquote>

<blockquote>
  <p>to ADP</p>
</blockquote>

<blockquote>
  <p>flying NOUN</p>
</blockquote>

<blockquote>
  <p>. PUNCT</p>
</blockquote>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Let's look at the dependencies of this example:</span>
<span class="n">example</span> <span class="o">=</span> <span class="s">"The boy with the spotted dog quickly ran after the firetruck."</span>
<span class="n">parsedEx</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
<span class="c"># shown as: original token, dependency tag, head word, left dependents, right dependents</span>
<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">parsedEx</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">orth_</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">dep_</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">orth_</span><span class="p">,</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">orth_</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">token</span><span class="o">.</span><span class="n">lefts</span><span class="p">],</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">orth_</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">token</span><span class="o">.</span><span class="n">rights</span><span class="p">])</span></code></pre></div>

<blockquote>
  <p>The det boy [] []</p>
</blockquote>

<blockquote>
  <p>boy nsubj ran [‘The’] [‘with’]</p>
</blockquote>

<blockquote>
  <p>with prep boy [] [‘dog’]</p>
</blockquote>

<blockquote>
  <p>the det dog [] []</p>
</blockquote>

<blockquote>
  <p>spotted amod dog [] []</p>
</blockquote>

<blockquote>
  <p>dog pobj with [‘the’, ‘spotted’] []</p>
</blockquote>

<blockquote>
  <p>quickly advmod ran [] []</p>
</blockquote>

<blockquote>
  <p>ran ROOT ran [‘boy’, ‘quickly’] [‘after’, ‘.’]</p>
</blockquote>

<blockquote>
  <p>after prep ran [] [‘firetruck’]</p>
</blockquote>

<blockquote>
  <p>the det firetruck [] []</p>
</blockquote>

<blockquote>
  <p>firetruck pobj after [‘the’] []</p>
</blockquote>

<blockquote>
  <p>. punct ran [] []</p>
</blockquote>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Let's look at the named entities of this example:</span>
<span class="n">example</span> <span class="o">=</span> <span class="s">"Apple's stocks dropped dramatically after the death of Steve Jobs in October."</span>
<span class="n">parsedEx</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">parsedEx</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">orth_</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">ent_type_</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">ent_type_</span> <span class="o">!=</span> <span class="s">""</span> <span class="k">else</span> <span class="s">"(not an entity)"</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"-------------- entities only ---------------"</span><span class="p">)</span>
<span class="c"># if you just want the entities and nothing else, you can do access the parsed examples "ents" property like this:</span>
<span class="n">ents</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">parsedEx</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span>
<span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">entity</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span> <span class="s">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">orth_</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">entity</span><span class="p">))</span></code></pre></div>

<blockquote>
  <p>Apple ORG</p>
</blockquote>

<blockquote>
  <p>’s (not an entity)</p>
</blockquote>

<blockquote>
  <p>stocks (not an entity)</p>
</blockquote>

<blockquote>
  <p>dropped (not an entity)</p>
</blockquote>

<blockquote>
  <p>dramatically (not an entity)</p>
</blockquote>

<blockquote>
  <p>after (not an entity)</p>
</blockquote>

<blockquote>
  <p>the (not an entity)</p>
</blockquote>

<blockquote>
  <p>death (not an entity)</p>
</blockquote>

<blockquote>
  <p>of (not an entity)</p>
</blockquote>

<blockquote>
  <p>Steve PERSON</p>
</blockquote>

<blockquote>
  <p>Jobs (not an entity)</p>
</blockquote>

<blockquote>
  <p>in (not an entity)</p>
</blockquote>

<blockquote>
  <p>October DATE</p>
</blockquote>

<blockquote>
  <p>. (not an entity)</p>
</blockquote>

<p>————– entities only —————</p>

<blockquote>
  <p>274530 ORG Apple</p>
</blockquote>

<blockquote>
  <p>112504 PERSON Steve Jobs</p>
</blockquote>

<blockquote>
  <p>71288 DATE October</p>
</blockquote>

<h1 id="spacy-is-trained-to-attempt-to-handle-messy-data-including-emoticons-and-other-web-based-features">spaCy is trained to attempt to handle messy data, including emoticons and other web-based features</h1>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">messyData</span> <span class="o">=</span> <span class="s">"lol that is rly funny :) This is gr8 i rate it 8/8!!!"</span>
<span class="n">parsedData</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="n">messyData</span><span class="p">)</span>
<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">parsedData</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">orth_</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">lemma_</span><span class="p">)</span>
    
<span class="c"># it does pretty well! Note that it does fail on the token "gr8", </span>
<span class="c"># taking it as a verb rather than an adjective meaning "great"</span>
<span class="c"># and "lol" probably isn't a noun...it's more like an interjection</span></code></pre></div>

<blockquote>
  <p>lol NOUN lol</p>
</blockquote>

<blockquote>
  <p>that DET that</p>
</blockquote>

<blockquote>
  <p>is VERB be</p>
</blockquote>

<blockquote>
  <p>rly ADV rly</p>
</blockquote>

<blockquote>
  <p>funny ADJ funny</p>
</blockquote>

<blockquote>
  <p>:) PUNCT :)</p>
</blockquote>

<blockquote>
  <p>This DET This</p>
</blockquote>

<blockquote>
  <p>is VERB be</p>
</blockquote>

<blockquote>
  <p>gr8 VERB gr8</p>
</blockquote>

<blockquote>
  <p>i PRON i</p>
</blockquote>

<blockquote>
  <p>rate VERB rate</p>
</blockquote>

<blockquote>
  <p>it PRON -PRON-</p>
</blockquote>

<blockquote>
  <p>8/8 NUM 8/8</p>
</blockquote>

<blockquote>
  <p>! PUNCT !</p>
</blockquote>

<blockquote>
  <p>! PUNCT !</p>
</blockquote>

<blockquote>
  <p>! PUNCT !</p>
</blockquote>

<h1 id="spacy-has-word-vector-representations-built-in">spaCy has word vector representations built in!</h1>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">dot</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="c"># you can access known words from the parser's vocabulary</span>
<span class="n">nasa</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="s">'NASA'</span><span class="p">]</span>

<span class="c"># cosine similarity</span>
<span class="n">cosine</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">:</span> <span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">*</span> <span class="n">norm</span><span class="p">(</span><span class="n">v2</span><span class="p">))</span>

<span class="c"># gather all known words, take only the lowercased versions</span>
<span class="n">allWords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">({</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">vocab</span> <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">has_repvec</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orth_</span><span class="o">.</span><span class="n">islower</span><span class="p">()</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">lower_</span> <span class="o">!=</span> <span class="s">"nasa"</span><span class="p">})</span>

<span class="c"># sort by similarity to NASA</span>
<span class="n">allWords</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">cosine</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">repvec</span><span class="p">,</span> <span class="n">nasa</span><span class="o">.</span><span class="n">repvec</span><span class="p">))</span>
<span class="n">allWords</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Top 10 most similar words to NASA:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">allWords</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>   
    <span class="k">print</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">orth_</span><span class="p">)</span></code></pre></div>

<p>Top 10 most similar words to NASA:</p>

<blockquote>
  <p>jpl</p>
</blockquote>

<blockquote>
  <p>noaa</p>
</blockquote>

<blockquote>
  <p>esa</p>
</blockquote>

<blockquote>
  <p>cern</p>
</blockquote>

<blockquote>
  <p>nih</p>
</blockquote>

<blockquote>
  <p>norad</p>
</blockquote>

<blockquote>
  <p>fema</p>
</blockquote>

<blockquote>
  <p>isro</p>
</blockquote>

<blockquote>
  <p>usaid</p>
</blockquote>

<blockquote>
  <p>nsf</p>
</blockquote>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Let's see if it can figure out this analogy</span>
<span class="c"># Man is to King as Woman is to ??</span>
<span class="n">king</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="s">'king'</span><span class="p">]</span>
<span class="n">man</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="s">'man'</span><span class="p">]</span>
<span class="n">woman</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="s">'woman'</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">king</span><span class="o">.</span><span class="n">repvec</span> <span class="o">-</span> <span class="n">man</span><span class="o">.</span><span class="n">repvec</span> <span class="o">+</span> <span class="n">woman</span><span class="o">.</span><span class="n">repvec</span>

<span class="c"># gather all known words, take only the lowercased versions</span>
<span class="n">allWords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">({</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">vocab</span> <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">has_repvec</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orth_</span><span class="o">.</span><span class="n">islower</span><span class="p">()</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">lower_</span> <span class="o">!=</span> <span class="s">"king"</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">lower_</span> <span class="o">!=</span> <span class="s">"man"</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">lower_</span> <span class="o">!=</span> <span class="s">"woman"</span><span class="p">})</span>
<span class="c"># sort by similarity to the result</span>
<span class="n">allWords</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">cosine</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">repvec</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
<span class="n">allWords</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">----------------------------</span><span class="se">\n</span><span class="s">Top 3 closest results for king - man + woman:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">allWords</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>   
    <span class="k">print</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">orth_</span><span class="p">)</span>
    
<span class="c"># it got it! Queen!</span></code></pre></div>

<hr/>

<p>Top 3 closest results for king - man + woman:</p>

<blockquote>
  <p>queen</p>
</blockquote>

<blockquote>
  <p>monarch</p>
</blockquote>

<blockquote>
  <p>princess</p>
</blockquote>

<h1 id="you-can-do-cool-things-like-extract-subject-verb-object-triples-from-the-dependency-parse-if-you-use-my-code-in-subjectobjectextractionpy-note-doesnt-work-on-complicated-sentences-fails-if-the-dependency-parse-is-incorrect">You can do cool things like extract Subject, Verb, Object triples from the dependency parse if you use my code in subject_object_extraction.py. Note: Doesn’t work on complicated sentences. Fails if the dependency parse is incorrect.</h1>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">subject_object_extraction</span> <span class="kn">import</span> <span class="n">findSVOs</span>

<span class="c"># can still work even without punctuation</span>
<span class="n">parse</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="s">"he and his brother shot me and my sister"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">findSVOs</span><span class="p">(</span><span class="n">parse</span><span class="p">))</span></code></pre></div>

<blockquote>
  <p>[(‘he’, ‘shot’, ‘me’), (‘he’, ‘shot’, ‘sister’), (‘brother’, ‘shot’, ‘me’), (‘brother’, ‘shot’, ‘sister’)]</p>
</blockquote>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># very complex sample. Only some are correct. Some are missed.</span>
<span class="n">parse</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="s">"Far out in the uncharted backwaters of the unfashionable end of the Western Spiral arm of the Galaxy lies a small unregarded yellow sun. "</span>
                <span class="s">"Orbiting this at a distance of roughly ninety-two million miles is an utterly insignificant little blue green planet whose ape-descended "</span>
                <span class="s">"life forms are so amazingly primitive that they still think digital watches are a pretty neat idea. "</span>
                <span class="s">"This planet has – or rather had – a problem, which was this: most of the people living on it were unhappy for pretty much of the time. "</span>
                <span class="s">"Many solutions were suggested for this problem, but most of these were largely concerned with the movements of small green pieces of paper, "</span>
                <span class="s">"which is odd because on the whole it wasn’t the small green pieces of paper that were unhappy. And so the problem remained; lots of the "</span>
                <span class="s">"people were mean, and most of them were miserable, even the ones with digital watches."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">findSVOs</span><span class="p">(</span><span class="n">parse</span><span class="p">))</span></code></pre></div>

<blockquote>
  <p>[(‘orbiting’, ‘is’, ‘planet’), (‘watches’, ‘are’, ‘idea’), (‘problem’, ‘was’, ‘this’), (‘it’, ‘wasn’t’, ‘pieces’), (‘most’, ‘were’, ‘ones’)]</p>
</blockquote>

<h1 id="if-you-want-to-include-spacy-in-your-machine-learning-it-is-not-too-difficult">If you want to include spaCy in your machine learning it is not too difficult</h1>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">TransformerMixin</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.stop_words</span> <span class="kn">import</span> <span class="n">ENGLISH_STOP_WORDS</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c"># A custom stoplist</span>
<span class="n">STOPLIST</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s">'english'</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s">"n't"</span><span class="p">,</span> <span class="s">"'s"</span><span class="p">,</span> <span class="s">"'m"</span><span class="p">,</span> <span class="s">"ca"</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">ENGLISH_STOP_WORDS</span><span class="p">))</span>
<span class="c"># List of symbols we don't care about</span>
<span class="n">SYMBOLS</span> <span class="o">=</span> <span class="s">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">" "</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s">"-----"</span><span class="p">,</span> <span class="s">"---"</span><span class="p">,</span> <span class="s">"..."</span><span class="p">,</span> <span class="s">"“"</span><span class="p">,</span> <span class="s">"”"</span><span class="p">,</span> <span class="s">"'ve"</span><span class="p">]</span>

<span class="c"># Every step in a pipeline needs to be a "transformer". </span>
<span class="c"># Define a custom transformer to clean text using spaCy</span>
<span class="k">class</span> <span class="nc">CleanTextTransformer</span><span class="p">(</span><span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Convert text to cleaned text</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_params</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">cleanText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{}</span>
    
<span class="c"># A custom function to clean the text before sending it into the vectorizer</span>
<span class="k">def</span> <span class="nf">cleanText</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="c"># get rid of newlines</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">" "</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\r</span><span class="s">"</span><span class="p">,</span> <span class="s">" "</span><span class="p">)</span>
    
    <span class="c"># replace twitter @mentions</span>
    <span class="n">mentionFinder</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r"@[a-z0-9_]{1,15}"</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">mentionFinder</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">"@MENTION"</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    
    <span class="c"># replace HTML symbols</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"&amp;amp;"</span><span class="p">,</span> <span class="s">"and"</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"&amp;gt;"</span><span class="p">,</span> <span class="s">"&gt;"</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"&amp;lt;"</span><span class="p">,</span> <span class="s">"&lt;"</span><span class="p">)</span>
    
    <span class="c"># lowercase</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">text</span>

<span class="c"># A custom function to tokenize the text using spaCy</span>
<span class="c"># and convert to lemmas</span>
<span class="k">def</span> <span class="nf">tokenizeText</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>

    <span class="c"># get the tokens using spaCy</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

    <span class="c"># lemmatize</span>
    <span class="n">lemmas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
        <span class="n">lemmas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">lemma_</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">tok</span><span class="o">.</span><span class="n">lemma_</span> <span class="o">!=</span> <span class="s">"-PRON-"</span> <span class="k">else</span> <span class="n">tok</span><span class="o">.</span><span class="n">lower_</span><span class="p">)</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">lemmas</span>

    <span class="c"># stoplist the tokens</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">tok</span> <span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">tok</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">STOPLIST</span><span class="p">]</span>

    <span class="c"># stoplist symbols</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">tok</span> <span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">tok</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SYMBOLS</span><span class="p">]</span>

    <span class="c"># remove large strings of whitespace</span>
    <span class="k">while</span> <span class="s">""</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
    <span class="k">while</span> <span class="s">" "</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s">" "</span><span class="p">)</span>
    <span class="k">while</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="k">while</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tokens</span>

<span class="k">def</span> <span class="nf">printNMostInformative</span><span class="p">(</span><span class="n">vectorizer</span><span class="p">,</span> <span class="n">clf</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="sd">"""Prints features with the highest coefficient values, per class"""</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>
    <span class="n">coefs_with_fns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">feature_names</span><span class="p">))</span>
    <span class="n">topClass1</span> <span class="o">=</span> <span class="n">coefs_with_fns</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>
    <span class="n">topClass2</span> <span class="o">=</span> <span class="n">coefs_with_fns</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Class 1 best: "</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">topClass1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Class 2 best: "</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">topClass2</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
    
<span class="c"># the vectorizer and classifer to use</span>
<span class="c"># note that I changed the tokenizer in CountVectorizer to use a custom function using spaCy's tokenizer</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizeText</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">()</span>
<span class="c"># the pipeline to clean, tokenize, vectorize, and classify</span>
<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s">'cleanText'</span><span class="p">,</span> <span class="n">CleanTextTransformer</span><span class="p">()),</span> <span class="p">(</span><span class="s">'vectorizer'</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">),</span> <span class="p">(</span><span class="s">'clf'</span><span class="p">,</span> <span class="n">clf</span><span class="p">)])</span>

<span class="c"># data</span>
<span class="n">train</span> <span class="o">=</span> <span class="p">[</span><span class="s">"I love space. Space is great."</span><span class="p">,</span> <span class="s">"Planets are cool. I am glad they exist in space"</span><span class="p">,</span> 
        <span class="s">"lol @twitterdude that is gr8"</span><span class="p">,</span> <span class="s">"twitter &amp;amp; reddit are fun."</span><span class="p">,</span> 
        <span class="s">"Mars is a planet. It is red."</span><span class="p">,</span> <span class="s">"@Microsoft: y u skip windows 9?"</span><span class="p">,</span> 
        <span class="s">"Rockets launch from Earth and go to other planets."</span><span class="p">,</span> <span class="s">"twitter social media &amp;gt; &amp;lt;"</span><span class="p">,</span> 
        <span class="s">"@someguy @somegirl @twitter #hashtag"</span><span class="p">,</span> <span class="s">"Orbiting the sun is a little blue-green planet."</span><span class="p">]</span>
<span class="n">labelsTrain</span> <span class="o">=</span> <span class="p">[</span><span class="s">"space"</span><span class="p">,</span> <span class="s">"space"</span><span class="p">,</span> <span class="s">"twitter"</span><span class="p">,</span> <span class="s">"twitter"</span><span class="p">,</span> <span class="s">"space"</span><span class="p">,</span> <span class="s">"twitter"</span><span class="p">,</span> <span class="s">"space"</span><span class="p">,</span> <span class="s">"twitter"</span><span class="p">,</span> <span class="s">"twitter"</span><span class="p">,</span> <span class="s">"space"</span><span class="p">]</span>

<span class="n">test</span> <span class="o">=</span> <span class="p">[</span><span class="s">"i h8 riting comprehensibly #skoolsux"</span><span class="p">,</span> <span class="s">"planets and stars and rockets and stuff"</span><span class="p">]</span>
<span class="n">labelsTest</span> <span class="o">=</span> <span class="p">[</span><span class="s">"twitter"</span><span class="p">,</span> <span class="s">"space"</span><span class="p">]</span>

<span class="c"># train</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">labelsTrain</span><span class="p">)</span>

<span class="c"># test</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"----------------------------------------------------------------------------------------------"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"results:"</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">preds</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="s">":"</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"accuracy:"</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">labelsTest</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s">"----------------------------------------------------------------------------------------------"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Top 10 features used to predict: "</span><span class="p">)</span>
<span class="c"># show the top features</span>
<span class="n">printNMostInformative</span><span class="p">(</span><span class="n">vectorizer</span><span class="p">,</span> <span class="n">clf</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"----------------------------------------------------------------------------------------------"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The original data as it appeared to the classifier after tokenizing, lemmatizing, stoplisting, etc"</span><span class="p">)</span>
<span class="c"># let's see what the pipeline was transforming the data into</span>
<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s">'cleanText'</span><span class="p">,</span> <span class="n">CleanTextTransformer</span><span class="p">()),</span> <span class="p">(</span><span class="s">'vectorizer'</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">)])</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">labelsTrain</span><span class="p">)</span>

<span class="c"># get the features that the vectorizer learned (its vocabulary)</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>

<span class="c"># the values from the vectorizer transformed data (each item is a row,column index with value as # times occuring in the sample, stored as a sparse matrix)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">indexIntoVocab</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">indptr</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">transform</span><span class="o">.</span><span class="n">indptr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">numOccurences</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">indptr</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">transform</span><span class="o">.</span><span class="n">indptr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indexIntoVocab</span><span class="p">,</span> <span class="n">numOccurences</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">((</span><span class="n">vocab</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">num</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Sample {}: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span></code></pre></div>

<hr/>
<p>results:</p>

<blockquote>
  <p>i h8 riting comprehensibly #skoolsux : twitter</p>
</blockquote>

<blockquote>
  <p>planets and stars and rockets and stuff : space</p>
</blockquote>

<blockquote>
  <p>accuracy: 1.0</p>
</blockquote>

<hr/>
<p>Top 10 features used to predict: </p>

<pre><code>Class 1 best: 
(-0.52882810587037121, 'planet')
(-0.35193565503626856, 'space')
(-0.2182987490483107, 'mar')
(-0.2182987490483107, 'red')
(-0.15592826214493352, 'earth')
(-0.15592826214493352, 'launch')
(-0.15592826214493352, 'rocket')
(-0.1482804579342584, 'great')
(-0.1482804579342584, 'love')
(-0.099226355509375405, 'blue')
Class 2 best: 
(0.41129938045689757, 'twitter')
(0.34038557663231445, <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="7b5c3b161e150f121415">[email protected]</a>')
(0.23401502570811406, 'lol')
(0.23401502570811406, 'gr8')
(0.20564996854629114, 'social')
(0.20564996854629114, 'medium')
(0.20564941191060651, 'reddit')
(0.20564941191060651, 'fun')
(0.10637055092420053, 'y')
(0.10637055092420053, 'window')
</code></pre>

<hr/>

<p>The original data as it appeared to the classifier after tokenizing, lemmatizing, stoplisting, etc</p>

<pre><code>Sample 0: ('love', 1)('space', 2)('great', 1)
Sample 1: ('space', 1)('planet', 1)('cool', 1)('glad', 1)('exist', 1)
Sample 2: ('lol', 1)(<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="54731439313a203d3b3a">[email protected]</a>', 1)('gr8', 1)
Sample 3: ('twitter', 1)('reddit', 1)('fun', 1)
Sample 4: ('planet', 1)('mar', 1)('red', 1)
Sample 5: (<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="4f680f222a213b262021">[email protected]</a>', 1)('y', 1)('u', 1)('skip', 1)('window', 1)('9', 1)
Sample 6: ('planet', 1)('rocket', 1)('launch', 1)('earth', 1)
Sample 7: ('twitter', 1)('social', 1)('medium', 1)
Sample 8: (<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="092e49646c677d606667">[email protected]</a>', 3)('hashtag', 1)
Sample 9: ('planet', 1)('orbit', 1)('sun', 1)('little', 1)('blue', 1)('green', 1)
</code></pre>

	</div>
	
</div></body></html>