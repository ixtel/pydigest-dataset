<html><body><div><div class="entry-content clearfix"><p>Social Authentication (or Social Login) is a way to simplify logins for end users by using existing login information from the popular social networking services such as <a href="https://www.facebook.com/">Facebook</a>, <a href="https://www.twitter.com/">Twitter</a>, <a href="https://plus.google.com/">Google+</a>, <a href="https://www.linkedin.com/">LinkedIn</a> (focus of this article), and so on. Most websites that require a user to login, utilize social login platforms for a better authentication/registeration experience in lieu of developing their own systems.</p>

<p><a href="http://psa.matiasaguirre.net/">Python Social Auth</a> provides a mechanism for easily setting up an authentication/registration system, which supports several frameworks and auth providers. <strong>In this tutorial, we’ll demonstrate in detail how to integrate this library into your Django Project to provide user authentication through LinkedIn using OAuth 2.0.</strong></p>









<a name="What.is.OAuth.2.0."/>
<h2>What is OAuth 2.0?</h2>

<p><a href="http://oauth.net/2/">OAuth 2.0</a> is the authorization framework which allows applications to gain access to an end user’s account for authenticating/registering via popular social networking services. The end user gets to choose which details the application has access to. It focuses on simplifying the development workflow while providing specific authorization flows for web applications and desktop applications, mobile phones, and IOT (Internet of Things) devices.</p>

<a name="Environment.and.Django.Set.up"/>
<h2>Environment and Django Set up</h2>

<p>We’ll be using:</p>

<ul>
<li>python v3.4.2</li>
<li>Django v1.8.4</li>
<li>python-social-auth v0.2.12</li>
</ul>


<blockquote><p>If you already have a <a href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">virtualenv</a> and a Django Project set up and ready to go, feel free to skip this section.</p></blockquote>

<a name="Create.a.virtualenv"/>
<h3>Create a virtualenv</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>mkvirtualenv --python<span class="o">=</span><span class="s1">'/usr/bin/python3.4'</span> django_social_project
</span><span class="line"><span class="nv">$ </span>pip install <span class="nv">django</span><span class="o">==</span>1.8.4
</span></code></pre></td></tr></table></div></figure>


<a name="Start.a.new.Django.Project"/>
<h3>Start a new Django Project</h3>

<p>Bootstrap a Django Application:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>django-admin.py startproject django_social_project
</span><span class="line"><span class="nv">$ </span><span class="nb">cd </span>django_social_project
</span><span class="line"><span class="nv">$ </span>python manage.py startapp django_social_app
</span></code></pre></td></tr></table></div></figure>


<p>Don’t forget to add the app to the <code>INSTALLED_APPS</code> tuple in <em>settings.py</em>, for our Project to know that we have created an app that needs to be served as a part of our Django Project.</p>

<a name="Set.up.the.initial.tables"/>
<h3>Set up the initial tables</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python manage.py migrate
</span><span class="line">Operations to perform:
</span><span class="line">  Synchronize unmigrated apps: messages, staticfiles
</span><span class="line">  Apply all migrations: sessions, admin, auth, contenttypes
</span><span class="line">Synchronizing apps without migrations:
</span><span class="line">  Creating tables...
</span><span class="line">    Running deferred SQL...
</span><span class="line">  Installing custom SQL...
</span><span class="line">Running migrations:
</span><span class="line">  Rendering model states... DONE
</span><span class="line">  Applying contenttypes.0001_initial... OK
</span><span class="line">  Applying auth.0001_initial... OK
</span><span class="line">  Applying admin.0001_initial... OK
</span><span class="line">  Applying contenttypes.0002_remove_content_type_name... OK
</span><span class="line">  Applying auth.0002_alter_permission_name_max_length... OK
</span><span class="line">  Applying auth.0003_alter_user_email_max_length... OK
</span><span class="line">  Applying auth.0004_alter_user_username_opts... OK
</span><span class="line">  Applying auth.0005_alter_user_last_login_null... OK
</span><span class="line">  Applying auth.0006_require_contenttypes_0002... OK
</span><span class="line">  Applying sessions.0001_initial... OK
</span></code></pre></td></tr></table></div></figure>


<a name="Add.a.superuser"/>
<h3>Add a superuser</h3>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python manage.py syncdb
</span></code></pre></td></tr></table></div></figure>


<a name="Create.a.templates.directory"/>
<h3>Create a templates directory</h3>

<p>Create a new directory called “templates” in the project root, and then add the correct path to the <code>TEMPLATES</code> in the <em>settings.py</em> file:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="s">'BACKEND'</span><span class="p">:</span> <span class="s">'django.template.backends.django.DjangoTemplates'</span><span class="p">,</span>
</span><span class="line">        <span class="s">'DIRS'</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s">'templates'</span><span class="p">)],</span>
</span><span class="line">        <span class="s">'APP_DIRS'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
</span><span class="line">        <span class="s">'OPTIONS'</span><span class="p">:</span> <span class="p">{</span>
</span><span class="line">            <span class="s">'context_processors'</span><span class="p">:</span> <span class="p">[</span>
</span><span class="line">                <span class="s">'django.template.context_processors.debug'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.template.context_processors.request'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.contrib.auth.context_processors.auth'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.contrib.messages.context_processors.messages'</span><span class="p">,</span>
</span><span class="line">            <span class="p">],</span>
</span><span class="line">        <span class="p">},</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line"><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Run.a.sanity.check"/>
<h3>Run a sanity check</h3>

<p>Fire up the development server – <code>python manage.py runserver</code> to ensure all is in order and then navigate to <a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a>. You should see the “It worked!” page.</p>

<p>Your project should look like this:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">└── django_social_project
</span><span class="line">    ├── db.sqlite3
</span><span class="line">    ├── django_social_app
</span><span class="line">    │   ├── __init__.py
</span><span class="line">    │   ├── admin.py
</span><span class="line">    │   ├── migrations
</span><span class="line">    │   │   └── __init__.py
</span><span class="line">    │   ├── models.py
</span><span class="line">    │   ├── tests.py
</span><span class="line">    │   └── views.py
</span><span class="line">    ├── django_social_project
</span><span class="line">    │   ├── __init__.py
</span><span class="line">    │   ├── settings.py
</span><span class="line">    │   ├── urls.py
</span><span class="line">    │   └── wsgi.py
</span><span class="line">    ├── manage.py
</span><span class="line">    └── templates
</span></code></pre></td></tr></table></div></figure>


<a name="Python.Social.Auth.Set.up"/>
<h2>Python Social Auth Set up</h2>

<p>Follow the steps below and/or the <a href="http://psa.matiasaguirre.net/docs/installing.html">official installation guide</a> to install and set up the basic configuration in order to make our app handle the social login via any social networking service.</p>

<a name="Installation"/>
<h3>Installation</h3>

<p>Install with pip:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>pip install python-social-auth<span class="o">==</span>0.2.12
</span></code></pre></td></tr></table></div></figure>


<a name="Configuration"/>
<h3>Configuration</h3>

<p>Update <em>settings.py</em> to include/register the library in our project:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
</span><span class="line">    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
</span><span class="line">    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
</span><span class="line">    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
</span><span class="line">    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
</span><span class="line">    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
</span><span class="line">    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
</span><span class="line">    <span class="s">'django_social_app'</span><span class="p">,</span>
</span><span class="line">    <span class="s">'social.apps.django_app.default'</span><span class="p">,</span>
</span><span class="line"><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="s">'BACKEND'</span><span class="p">:</span> <span class="s">'django.template.backends.django.DjangoTemplates'</span><span class="p">,</span>
</span><span class="line">        <span class="s">'DIRS'</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s">'templates'</span><span class="p">)],</span>
</span><span class="line">        <span class="s">'APP_DIRS'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
</span><span class="line">        <span class="s">'OPTIONS'</span><span class="p">:</span> <span class="p">{</span>
</span><span class="line">            <span class="s">'context_processors'</span><span class="p">:</span> <span class="p">[</span>
</span><span class="line">                <span class="s">'django.template.context_processors.request'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.contrib.auth.context_processors.auth'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.core.context_processors.debug'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.core.context_processors.i18n'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.core.context_processors.media'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.core.context_processors.static'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.core.context_processors.tz'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'django.contrib.messages.context_processors.messages'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'social.apps.django_app.context_processors.backends'</span><span class="p">,</span>
</span><span class="line">                <span class="s">'social.apps.django_app.context_processors.login_redirect'</span><span class="p">,</span>
</span><span class="line">            <span class="p">],</span>
</span><span class="line">        <span class="p">},</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line"><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p><strong>NOTE</strong>: Since we’re using LinkedIn Social Authentication, we need the Linkedin OAuth2 backend:</p></blockquote>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">AUTHENTICATION_BACKENDS</span> <span class="o">=</span> <span class="p">(</span>
</span><span class="line">    <span class="s">'social.backends.linkedin.LinkedinOAuth2'</span><span class="p">,</span>
</span><span class="line">    <span class="s">'django.contrib.auth.backends.ModelBackend'</span><span class="p">,</span>
</span><span class="line"><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Run.a.migration"/>
<h3>Run a migration</h3>

<p>Once registered, update the database:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python manage.py makemigrations
</span><span class="line"><span class="nv">$ </span>python manage.py migrate
</span></code></pre></td></tr></table></div></figure>


<a name="Update.the.URLs"/>
<h3>Update the URLs</h3>

<p>Within the Project’s <em>urls.py</em> file, update the urlpatters to inclue the main auth URLs:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="n">url</span><span class="p">(</span><span class="s">r'^admin/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
</span><span class="line">    <span class="n">url</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'social.apps.django_app.urls'</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'social'</span><span class="p">)),</span>
</span><span class="line"><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next we need to grab the required authentication keys from a LinkedIn Application. This process is similar for many popular social networks – like Twitter, Facebook and Google.</p>

<a name="LinkedIn.Authentication.Keys"/>
<h3>LinkedIn Authentication Keys</h3>

<p>In order for our app to distinctly recognize the LinkedIn social login that we implemented, we need to have some app-specific credentials to differentiate our app’s login from other social logins on the web.</p>

<p>Create a new application at <a href="https://www.linkedin.com/developer/apps">https://www.linkedin.com/developer/apps</a> and make sure to use a callback/redirect URL of <a href="http://127.0.0.1:8000/complete/linkedin-oauth2/">http://127.0.0.1:8000/complete/linkedin-oauth2/</a> (very important!). This URL is specific to OAuth 2.0, remember that.</p>

<blockquote><p><strong>NOTE</strong>: The callback URL used above is valid only in local development and will need be changed when you move to a production or staging environment.</p></blockquote>

<p>In the “django_social_project” directory, add a new file called <em>config.py</em>. Then grab the Consumer Key (API Key) and the Consumer Secret (API Secret) from LinkedIn and add them to the file:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">SOCIAL_AUTH_LINKEDIN_OAUTH2_KEY</span> <span class="o">=</span> <span class="s">'update me'</span>
</span><span class="line"><span class="n">SOCIAL_AUTH_LINKEDIN_OAUTH2_SECRET</span> <span class="o">=</span> <span class="s">'update me'</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let’s also add the following URLs to the <em>config.py</em> file to specify the login and the redirect URLs (after a user authenticates):</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">SOCIAL_AUTH_LOGIN_REDIRECT_URL</span> <span class="o">=</span> <span class="s">'/home/'</span>
</span><span class="line"><span class="n">SOCIAL_AUTH_LOGIN_URL</span> <span class="o">=</span> <span class="s">'/'</span>
</span></code></pre></td></tr></table></div></figure>


<p>Add the following imports to <em>settings.py</em></p>

<figure class="code"><figcaption><span/></figcaption></figure>


<p>In order for our app to complete the login process successfully we need to define the Templates and Views associated with those URLs. Let’s do that now.</p>

<a name="Friendly.Views"/>
<h2>Friendly Views</h2>

<p>For checking whether our app is working or not we just need two views – <em>login</em> and <em>home</em>.</p>

<a name="URLs"/>
<h3>URLs</h3>

<p>Update the urlpatterns in the Project’s <em>urls.py</em> file, to map our URLs to our views that we’ll be seeing in the further sections:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="n">url</span><span class="p">(</span><span class="s">r'^admin/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
</span><span class="line">    <span class="n">url</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'social.apps.django_app.urls'</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'social'</span><span class="p">)),</span>
</span><span class="line">    <span class="n">url</span><span class="p">(</span><span class="s">r'^$'</span><span class="p">,</span> <span class="s">'django_social_app.views.login'</span><span class="p">),</span>
</span><span class="line">    <span class="n">url</span><span class="p">(</span><span class="s">r'^home/$'</span><span class="p">,</span> <span class="s">'django_social_app.views.home'</span><span class="p">),</span>
</span><span class="line">    <span class="n">url</span><span class="p">(</span><span class="s">r'^logout/$'</span><span class="p">,</span> <span class="s">'django_social_app.views.logout'</span><span class="p">),</span>
</span><span class="line"><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Views"/>
<h3>Views</h3>

<p>Now, add the views to the App’s <em>views.py</em> for making our routes know what exactly to do when a particular route is hit.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render_to_response</span><span class="p">,</span> <span class="n">redirect</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">logout</span> <span class="k">as</span> <span class="n">auth_logout</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">login_required</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">django.template.context</span> <span class="kn">import</span> <span class="n">RequestContext</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span class="line">    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s">'login.html'</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">RequestContext</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="nd">@login_required</span><span class="p">(</span><span class="n">login_url</span><span class="o">=</span><span class="s">'/'</span><span class="p">)</span>
</span><span class="line"><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span class="line">    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s">'home.html'</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span class="line">    <span class="n">auth_logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span><span class="line">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, in the login function we fetched the logged-in user using the <code>RequestContext</code>.</p>

<a name="Templates"/>
<h3>Templates</h3>

<p>Add two templates to the “templates” folder – <em>login.html</em>:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="c">&lt;!-- login.html --&gt;</span>
</span><span class="line">
</span><span class="line">{% if user and not user.is_anonymous %}
</span><span class="line">  <span class="nt">&lt;a&gt;</span>Hello, {{ user.get_full_name }}!<span class="nt">&lt;/a&gt;</span>
</span><span class="line">  <span class="nt">&lt;br&gt;</span>
</span><span class="line">  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/logout"</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/a&gt;</span>
</span><span class="line">{% else %}
</span><span class="line">  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'social:begin' backend='linkedin-oauth2' %}"</span><span class="nt">&gt;</span>Login with Linkedin<span class="nt">&lt;/a&gt;</span>
</span><span class="line">{% endif %}
</span></code></pre></td></tr></table></div></figure>


<p>And <em>home.html</em>:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="c">&lt;!-- home.html --&gt;</span>
</span><span class="line">
</span><span class="line"><span class="nt">&lt;h1&gt;</span>Welcome<span class="nt">&lt;/h1&gt;</span>
</span><span class="line"><span class="nt">&lt;br&gt;</span>
</span><span class="line"><span class="nt">&lt;p&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/logout"</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/a&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Your project should now look like this:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">└── django_social_project
</span><span class="line">    ├── db.sqlite3
</span><span class="line">    ├── django_social_app
</span><span class="line">    │   ├── __init__.py
</span><span class="line">    │   ├── admin.py
</span><span class="line">    │   ├── migrations
</span><span class="line">    │   │   └── __init__.py
</span><span class="line">    │   ├── models.py
</span><span class="line">    │   ├── tests.py
</span><span class="line">    │   └── views.py
</span><span class="line">    ├── django_social_project
</span><span class="line">    │   ├── __init__.py
</span><span class="line">    │   ├── config.py
</span><span class="line">    │   ├── settings.py
</span><span class="line">    │   ├── urls.py
</span><span class="line">    │   └── wsgi.py
</span><span class="line">    ├── manage.py
</span><span class="line">    └── templates
</span><span class="line">        ├── home.html
</span><span class="line">        └── login.html
</span></code></pre></td></tr></table></div></figure>


<a name="Test."/>
<h2>Test!</h2>

<p>Now just fire up the server again to test:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nv">$ </span>python manage.py runserver
</span></code></pre></td></tr></table></div></figure>


<p>Just browse to <a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a> and you will see a “Login with Linkedin” hyperlink. Test this out to make sure all is well.</p>

<p>Grab the code <a href="https://github.com/realpython/python-social-auth">here</a>. Cheers!</p>
</div>


      </div></body></html>