<html><body><div><section class="the_post">
    <p>It’s a python library that supplies a functionality very similar to the python <cite>re</cite> module (regular expressions) but for arbitrary sequences of objects instead of strings (sequences of characters).</p>
<p>In addition to that, it’s possible to match each object in a sequence with not only equality, but an arbitrary python function. For example, if you have a sequence of integers you can make a regular expression that asks for a even number followed by a prime number followed by a 3-divisible number.</p>
<p>This software was written by Rafael Carrascosa while working at Machinalis in the first months of 2012.</p>
<p>Contact: <a class="reference external" href="mailto:rcarrascosa%40machinalis.com">rcarrascosa<span>@</span>machinalis<span>.</span>com</a> or rafacarrascosa xyz gmail.com (replace ” xyz ” with “@”)</p>
<div class="section" id="how-to-use-it">
<h2>How to use it</h2>
<p>The syntax is a little bit different than python’s re, and similar to that of pyparsing, you have to more-or-less explicitly build the syntax tree of your regular expression. For instance:</p>
<div class="highlight-python">
<pre>"ab"` is `Literal("a") + Literal("b")`
`"a*"` is `Star(Literal("a"))`</pre>
</div>
<p><cite>“(ab)+|(bb)*?”</cite> is:</p>
<div class="highlight-python">
<div class="highlight">
<pre><span class="n">a</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">(</span><span class="s">"b"</span><span class="p">)</span>
<span class="n">regex</span> <span class="o">=</span> <span class="n">Plus</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">|</span> <span class="n">Star</span><span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre>
</div>
</div>
<p>You can also assign a group to any sub-match and later on retrieve the matched content, for instance:</p>
<div class="highlight-python">
<div class="highlight">
<pre><span class="n">regex</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="n">Plus</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">),</span> <span class="s">"foobar"</span><span class="p">)</span>  <span class="o">|</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">match</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="s">"abab"</span><span class="p">)</span>
<span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="s">"foobar"</span><span class="p">)</span>  <span class="c"># prints (0, 4)</span>
</pre>
</div>
</div>
<p>For more, check out the examples in the examples folder.</p>
</div>
<div class="section" id="how-we-use-it">
<h2>How we use it</h2>
<p>At Machinalis we use REfO for applications similar to that in <cite>examples/words.py</cite>, check it out!</p>
</div>
<div class="section" id="about-the-implementation">
<h2>About the implementation</h2>
<p>I use a Thompson-like virtual machine aproach, which ensures polynomial time worst-case complexity. See <cite>examples/poly_time.py</cite> for an example of this.</p>
<p>The implementation is heavily based on Russ Cox notes, see <a class="reference external" href="http://swtch.com/~rsc/regexp/regexp2.html">http://swtch.com/~rsc/regexp/regexp2.html</a> for the source.</p>
<p>If you go to read the code, some glossary:</p>
<blockquote>
<div>
<ul>
<li>
<p class="first">RE – regular expression</p>
</li>
<li>
<p class="first">VM – virtual machine</p>
</li>
<li><dl class="first docutils"><dt>Epsilon transitions – All VM instructions that do not consume a symbol</dt><dd>
<p class="first last">or stop the thread (for example an Accept).</p>
</dd></dl></li>
</ul>
</div>
</blockquote>
</div>
</section>


</div></body></html>