<html><body><div><div id="usage">
<h3>Usage</h3>
<p>The <cite>Flask-PyBankID</cite> package adds a <cite>PyBankID</cite> class that can be used when initiating the Flask app:</p>
<pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_pybankid</span> <span class="kn">import</span> <span class="n">PyBankID</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">bankid</span> <span class="o">=</span> <span class="n">PyBankID</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre>
<p>Configuration of the BankID client is done via the regular parameters to Flask:</p>
<pre><span class="n">PYBANKID_CERT_PATH</span> <span class="o">=</span> <span class="s1">'path/to/certificate.pem'</span>
<span class="n">PYBANKID_KEY_PATH</span> <span class="o">=</span> <span class="s1">'path/to/key.pem'</span>
<span class="n">PYBANKID_TEST_SERVER</span> <span class="o">=</span> <span class="bp">True</span>
</pre>
<p>Should several BankID clients with different settings be desired, one
can change the prefix <cite>PYBANKID</cite> to an arbitrarily chosen prefix instead,
and initiate the <cite>PyBankID</cite> extension with the extra keyword <cite>config_prefix=’MY_PREFIX’</cite></p>
<p>The PyBankID wrapper adds three API endpoints for your site, all accepting <cite>GET</cite> requests:</p>
<ul>
<li><dl>
<dt><cite>/authenticate/YYYYMMDDXXXX</cite></dt>
<dd><ul>
<li>Initiate a BankID authentication session.</li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt><cite>/sign/YYYYMMDDXXXX</cite></dt>
<dd><ul>
<li>Initiate a BankID signing session (requires data to be sent in as well; see below).</li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt><cite>/collect/&lt;orderRef&gt;</cite></dt>
<dd><ul>
<li>Collect the signing status of a session with the sent in order reference UUID.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>These endpoints can then be called either from the backend or the frontend. Here are some
<a href="https://api.jquery.com/jquery.ajax/" rel="nofollow">jquery ajax</a> examples for frontend use:</p>
<div id="authenticate-example">
<h4>Authenticate example</h4>
<pre><span class="kd">function</span> <span class="nx">authenticate</span><span class="p">(</span><span class="nx">nationalIDNumber</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">"/authenticate/"</span> <span class="o">+</span> <span class="nx">nationalIDNumber</span><span class="p">,</span>
        <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">statusText</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseJSON</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
            <span class="k">return</span> <span class="p">{};</span>
        <span class="p">},</span>
        <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre>
</div>
<div id="sign-example">
<h4>Sign example</h4>
<pre><span class="kd">function</span> <span class="nx">sign</span><span class="p">(</span><span class="nx">nationalIDNumber</span><span class="p">,</span> <span class="nx">userVisibleData</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">"/sign/"</span> <span class="o">+</span> <span class="nx">nationalIDNumber</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span> <span class="s1">'userVisibleData'</span><span class="o">:</span> <span class="s1">'Signera med Personnummer: '</span> <span class="o">+</span> <span class="nx">nationalIDNumber</span> <span class="p">},</span>
        <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">statusText</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseJSON</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
            <span class="k">return</span> <span class="p">{};</span>
        <span class="p">},</span>
        <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre>
</div>
<div id="collect-example">
<h4>Collect example</h4>
<pre><span class="kd">function</span> <span class="nx">collect</span><span class="p">(</span><span class="nx">orderRef</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">"/collect/"</span> <span class="o">+</span> <span class="nx">orderRef</span><span class="p">,</span>
        <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">statusText</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseJSON</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
            <span class="k">return</span> <span class="p">{};</span>
        <span class="p">},</span>
        <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre>
</div>
</div>
</div></body></html>