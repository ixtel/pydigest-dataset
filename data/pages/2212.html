<html><body><div><header class="post-header">


    


    


    <h1 class="post-title">Turn Your Twitter Timeline into a Word Cloud</h1>
    <h2 class="post-title">– using Python</h2>


    <p/>
    <p class="post-meta">Nov 28, 2014 <br/>by Sebastian Raschka</p>
  </header>

  <article class="post-content">
    <h2 id="turn-your-twitter-timeline-into-a-word-cloud-using-python">Turn Your Twitter Timeline into a Word Cloud Using Python</h2>

<p>Last week, I posted some visualizations in context of “Happy Rock Song”
data mining project, and some people were curious about how I created
the word clouds. I thought it might be interesting to use a different
dataset for this tutorial: Your personal twitter timeline.</p>

<p><img src="/images/blog/2014/twitter-wordcloud/my_twitter_wordcloud_2_small.jpg" alt=""/></p>

<h3 id="sections">Sections</h3>



<h3 id="requirements">Requirements</h3>

<p>Before we get started, I want to list some of the required packages to
make this work!</p>

<p>Below, you find a list of the basic packages which can be installed via</p>

<div class="highlighter-rouge"><pre class="highlight"><code>pip install &lt;package_name&gt;
</code></pre>
</div>



<p>And the Python (2.7)
<a href="https://github.com/amueller/word_cloud"><code class="highlighter-rouge">wordcloud</code></a> package by Andreas
Mueller can be installed via</p>

<div class="highlighter-rouge"><pre class="highlight"><code>pip install git+git://github.com/amueller/word_cloud.git
</code></pre>
</div>

<p>Note that <code class="highlighter-rouge">wordcloud</code> requires Python’s imaging library
<a href="http://effbot.org/imagingbook/pil-index.htm">PIL</a>. Depending on the
operating system, the installation and setup of PIL can be quite
challenging; however, when I tried to install it on different MacOS and
Linux systems via <a href="http://www.continuum.io/blog/conda"><code class="highlighter-rouge">conda</code></a> it
always seemed to work seamlessly:</p>



<p>Let me use my handy <a href="https://github.com/rasbt/watermark"><code class="highlighter-rouge">watermark</code></a>
extension to summarize the different packages and version numbers that
were used in my case to download the twitter timeline and create the
word cloud:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>%load_ext watermark
%watermark -d -v -m -p twitter,pyprind,wordcloud,pandas,scipy,matplotlib


28/11/2014

CPython 2.7.8
IPython 2.1.0

twitter 1.15.0
pyprind 2.8.0
wordcloud 1.0.0
pandas 0.14.1
scipy 0.14.0
matplotlib 1.3.1

compiler   : GCC 4.2.1 (Apple Inc. build 5577)
system     : Darwin
release    : 14.0.0
machine    : x86_64
processor  : i386
CPU cores  : 2
interpreter: 64bit
</code></pre>
</div>

<h2 id="a-downloading-your-twitter-timeline-tweetsa-downloading-your-twitter-timeline-tweets-a-downloading-your-twitter-timeline-tweets">A. Downloading Your Twitter Timeline Tweets[](#A.-Downloading-Your-Twitter-Timeline-Tweets) {#A.-Downloading-Your-Twitter-Timeline-Tweets}</h2>

<p>In order to download our twitter timeline, we are going to use a simple
command line tool
<a href="https://github.com/rasbt/datacollect/tree/master/twitter_timeline"><code class="highlighter-rouge">twitter_timeline.py</code></a>.
The usage is quite simple, and I have detailed the setup procedure in
the
<a href="https://github.com/rasbt/datacollect/tree/master/twitter_timeline">README.md</a>
file which can be found in the respective GitHub repository. After you
provided the necessary authentication information, you can run it from
your terminal via</p>

<div class="highlighter-rouge"><pre class="highlight"><code>python ./twitter_timeline.py --out 'output.csv'
</code></pre>
</div>

<p>in order to save your timeline in CSV format.</p>

<p>Alternatively, you can import the <code class="highlighter-rouge">TimelineMiner</code> class from the
<code class="highlighter-rouge">twitter_timeline.py</code> to run the code directly in this IPython notebook
as shown below.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import sys
sys.path.append('../../twitter_timeline/')
import twitter_timeline
import oauth_info as auth



tm = twitter_timeline.TimelineMiner(auth.ACCESS_TOKEN,
                                    auth.ACCESS_TOKEN_SECRET,
                                    auth.CONSUMER_KEY,
                                    auth.CONSUMER_SECRET,
                                    auth.USER_NAME
                                    )

print('Authentification successful: %s' %tm.authenticate())
tm.get_timeline(max=2000, keywords=[])

Authentification successful: True
Tweets downloaded: 1999
</code></pre>
</div>

<p><img src="/images/blog/2014/twitter-wordcloud/twitter_timeline.png" alt=""/></p>

<p>If you used <code class="highlighter-rouge">twitter_timeline.py</code> from the terminal terminal, you can
read the “tweets” from the CSV file via</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import pandas as pd
df = pd.read_csv('path/to/CSV')
</code></pre>
</div>

<h2 id="b-creating-the-word-cloudb-creating-the-word-cloud-b-creating-the-word-cloud">B. Creating the Word Cloud[](#B.-Creating-the-Word-Cloud) {#B.-Creating-the-Word-Cloud}</h2>
<p>Now that we collected the tweets from our twitter timeline the creation
of the word cloud is pretty simple and straightforward thanks to the
nice <code class="highlighter-rouge">wordcloud</code> module.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import matplotlib.pyplot as plt
from wordcloud import WordCloud, STOPWORDS

# join tweets to a single string
words = ' '.join(tm.df['tweet'])

# remove URLs, RTs, and twitter handles
no_urls_no_tags = " ".join([word for word in words.split()
                            if 'http' not in word
                                and not word.startswith('@')
                                and word != 'RT'
                            ])

wordcloud = WordCloud(
                      font_path='/Users/sebastian/Library/Fonts/CabinSketch-Bold.ttf',
                      stopwords=STOPWORDS,
                      background_color='black',
                      width=1800,
                      height=1400
                     ).generate(no_urls_no_tags)

plt.imshow(wordcloud)
plt.axis('off')
plt.savefig('./my_twitter_wordcloud_1.png', dpi=300)
plt.show()
</code></pre>
</div>

<p><img src="/images/blog/2014/twitter-wordcloud/my_twitter_wordcloud_1.jpg" alt=""/></p>

<p>Surprise, surprise: The most common term I used in my tweets is
obviously “Python!”</p>

<p>To make the word cloud even more visually appealing, let us use a custom
shape in form of the twitter logo:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>from scipy.misc import imread

twitter_mask = imread('./twitter_mask.png', flatten=True)


wordcloud = WordCloud(
                      font_path='/Users/sebastian/Library/Fonts/CabinSketch-Bold.ttf',
                      stopwords=STOPWORDS,
                      background_color='white',
                      width=1800,
                      height=1400,
                      mask=twitter_mask
            ).generate(no_urls_no_tags)

plt.imshow(wordcloud)
plt.axis("off")
plt.savefig('./my_twitter_wordcloud_2.png', dpi=300)
plt.show()
</code></pre>
</div>

<p><img src="/images/blog/2014/twitter-wordcloud/my_twitter_wordcloud_2.jpg" alt=""/></p>

<p>(You can find the <code class="highlighter-rouge">twitter_mask.png</code>
<a href="https://raw.githubusercontent.com/rasbt/datacollect/master/dataviz/twitter_cloud/twitter_mask.png">here</a>)</p>

<p>Optionally, you can add additional stop words to the <code class="highlighter-rouge">STOPWORD</code> set to
be ignored when building the word cloud:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">more_stopwords</span> <span class="o">=</span> <span class="p">{</span><span class="s">'oh'</span><span class="p">,</span> <span class="s">'will'</span><span class="p">,</span> <span class="s">'hey'</span><span class="p">,</span> <span class="s">'yet'</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
<span class="n">STOPWORDS</span> <span class="o">=</span> <span class="n">STOPWORDS</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">more_stopwords</span><span class="p">)</span>
</code></pre>
</div>

<p>I wrote this simple twitter timeline mining code in a completely
different context, and I luckily found out about this neat wordcloud
module when I was working on a data mining project about song lyrics
classification by mood. However, I have to say that I find this
particularly combination very interesting, and I was curious to get an
“objective” about my twitter language and topics! I hope you found this
short tutorial interesting and I am looking forward to seeing some of
your word clouds on twitter!</p>

  </article>


</div></body></html>