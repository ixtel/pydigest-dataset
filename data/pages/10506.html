<html><body><div><div class="post-text" itemprop="text">
<p>I have tested the following successfully:</p>

<p>I have a C# sample project to be called:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Windows.Forms;

namespace ClassLibrary1
{
    public class ElementId
    {
        public string Name{set;get;}
    }

    public class TestClass
    {
        public static void TestMethod(ISet&lt;ElementId&gt; fSet)
        {
            MessageBox.Show("Number of Elements  in Set: " + fSet.Count.ToString());

            foreach(var lElement in fSet)
            {
                MessageBox.Show(lElement.Name);
            }
        }
    }
}
</code></pre>

<p>This is compiled as ClassLibrary1.dll and installed into the global assembly cache.</p>

<p>Then I have the following Python script:</p>

<pre><code>import clr
import System

# Load System.Core assembly that contains HashSet
clr.AddReference("System.Core")
from System.Collections.Generic import HashSet

# Load Sample Assembly
clr.AddReference("ClassLibrary1")
from ClassLibrary1 import ElementId
from ClassLibrary1 import TestClass

# Create HashSet
myHashSet = HashSet[ElementId]()

# Fill HashSet with two objects 
item = ElementId()
item.Name = "Hello"
myHashSet.Add(item)

item2 = ElementId()
item2.Name = "World"
myHashSet.Add(item2)

# Now call test method and pass the Set
TestClass.TestMethod(myHashSet)
</code></pre>

<p>The script runs without error in the Iron Python console and as expected I get three message boxes, saying "Number of Elements in Set: 2", "Hello" and "World"</p>

<p>In order to use a type in .NET, you need to do two things: </p>

<ol>
<li>You need to load the Assembly (DLL) that the type is declared in. In Python you do that via <code>clr.AddReference()</code>.</li>
<li>You need to import the namespace in which the type is declared. In Python, you do that via <code>import</code>.</li>
</ol>

<p>In the documentation you can see that the class <code>HashSet</code> is in the namespace <code>System.Collections.Generic</code> and in the assembly <code>System.Core.dll</code>. So in order to use the type HashSet you need both:</p>

<pre><code>clr.AddReference("System.Core")
from System.Collections.Generic import HashSet
</code></pre>

<p>Some of the more basic types are in the assemblies <code>System.dll</code> and <code>mscorlib.dll</code> which are always automatically loaded by the runtime. </p>

<p>What assembly and what namespace a type is declared in is often related. Often the name of the assembly is the beginning of the name of the namespace, but not always. Two types that are in the same namespace can actually be contained in two different assemblies. For example, most of the other types in the namespace <code>System.Collections.Generic</code> (like for example <code>List</code> or <code>SortedSet</code>) are not part of <code>System.Core.dll</code> but part of <code>System.dll</code> so that you can use them without any explicit assembly referencing.</p>
    </div>
    </div></body></html>