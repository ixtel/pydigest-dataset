<html><body><div><div itemprop="articleBody"><p>If you have to install 10.04 in a Hyper-V you might have some trouble if you want network. I've tried 11.10 and it has the same problem. Only 12.04 works out of the box with no fixups.</p><p>The first thing to do is to always use the legacy network adapter. If you use the normal one and activate the hv_netvsc module the vm won't boot anymore (some kernel failure at boot). It will look like this:</p><img alt="Screenshot of Ubuntu crashing at boot on Hyper-V" src="https://blog.ionelmc.ro/2013/03/11/old-ubuntu-10-04-on-hyper-v/ubuntu-10-04-crash-at-boot.png"/><p>Now, the first thing to do is disable vga16fb in the install: in the install menu press F6 and then add <tt class="docutils literal">vga16fb.modeset=0</tt> to the boot options. This will speed up the display a lot. Eg:</p><img alt="Screenshort of Ubuntu 10.04 install" src="https://blog.ionelmc.ro/2013/03/11/old-ubuntu-10-04-on-hyper-v/ubuntu-10-04-install.png"/><p>After the install disable it again: <tt class="docutils literal">echo blacklist vga16fb | sudo tee <span class="pre">-a</span> <span class="pre">/etc/modprobe.d/blacklist-framebuffer.conf</span></tt></p><p>Ubuntu 10.04 has the <a class="reference external" href="http://blogs.technet.com/b/port25/archive/2009/07/22/introduction-to-the-linux-integration-components.aspx">IC</a> modules but they are not active by default. They aren't even supported but they seem to work. Do the standard kernel module dance:</p><p>in /etc/initramfs-tools/modules add:</p><pre class="literal-block">
hv_vmbus
hv_storvsc
hv_blkvsc
hv_netvsc
</pre><p>and run <tt class="docutils literal"><span class="pre">update-initramfs</span> <span class="pre">-u</span></tt></p><p>Make sure you take a snapshot before rebooting (just in case)!</p><div class="section" id="bonus"><h2>Bonus:<a class="headerlink" href="#bonus" title="Permalink to this headline"> *</a></h2><p>If you get this <tt class="docutils literal">piix4_smbus 0000:00:07.0: SMBus base address uninitialized - upgrade BIOS or use force_addr=0xaddr</tt></p><p>Then <tt class="docutils literal">sudo nano /etc/modprobe.d/blacklist.conf</tt>, add: <tt class="docutils literal">blacklist i2c_piix4</tt> and run <tt class="docutils literal"><span class="pre">update-initramfs</span> <span class="pre">-u</span></tt> again.</p></div></div></div></body></html>