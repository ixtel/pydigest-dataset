<html><body><div><div class="entry-content"><p>Оператор <code>GOTO</code> не ругал только ленивый. Тем не менее, это инструмент, и польза или вред от него определяется только тем, как его используют.<br/> <span id="more-8906"/></p><p><a href="https://github.com/snoack/python-goto" target="_blank">Эта маленькая библиотека</a> позволяет использовать оператор <code>GOTO</code> в коде на Python:</p><div id="crayon-56d5a0e4ec14c876759641" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover"><p class="crayon-plain-wrap"/><div class="crayon-main"><table class="crayon-table"><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0e4ec14c876759641-2">2</p><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0e4ec14c876759641-4">4</p><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0e4ec14c876759641-6">6</p><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0e4ec14c876759641-8">8</p><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0e4ec14c876759641-10">10</p><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0e4ec14c876759641-12">12</p><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0e4ec14c876759641-14">14</p><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5a0e4ec14c876759641-16">16</p><p class="crayon-num" data-line="crayon-56d5a0e4ec14c876759641-17">17</p></div></td><td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">goto </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">with</span><span class="crayon-sy">_</span>goto</p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0e4ec14c876759641-2"> </p><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-3"><span class="crayon-sy">@</span><span class="crayon-e">with_goto</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0e4ec14c876759641-4"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">start</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stop</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-5"><span class="crayon-h">    </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">start</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0e4ec14c876759641-6"><span class="crayon-e">    </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0e4ec14c876759641-8"><span class="crayon-h">    </span><span class="crayon-i">label</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-e">begin</span></p><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-9"><span class="crayon-e">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">stop</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0e4ec14c876759641-10"><span class="crayon-h">        </span><span class="crayon-i">goto</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-e">end</span></p><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0e4ec14c876759641-12"><span class="crayon-e">    </span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-13"><span class="crayon-h">    </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0e4ec14c876759641-14"><span class="crayon-h">    </span><span class="crayon-i">goto</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-e">begin</span></p><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-15"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0e4ec14c876759641-16"><span class="crayon-e">    </span><span class="crayon-i">label</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-e">end</span></p><p class="crayon-line" id="crayon-56d5a0e4ec14c876759641-17"><span class="crayon-e">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">result</span></p></div></td></tr></table></div></div><p>Декоратор <code>with_goto</code> заменяет байт-код для доступа к атрибутам у объектов <code>label</code> и <code>goto</code> на безусловный переход (<code>JUMP_ABSOLUTE</code>). Без него такой код вызвал бы исключение <code>NameError</code>, поскольку переменные <code>begin</code> и <code>end</code> не инициализированны.</p><p>Идея добавить <code>GOTO</code> в Python не нова. В 2004 году в качестве первоапрельской шутки была написана <a href="http://entrian.com/goto/" target="_blank">другая библиотека</a>. Она работает через функцию <code>trace</code> и требует гораздо больших накладные расходы.</p><p class="mistape_caption"/><footer class="entry-meta clearfix"><p class="vk_like" id="vk_like_bottom_8906"/></footer></div></div></body></html>