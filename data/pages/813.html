<html><body><div><div class="outline-text-2" id="text-1">
<p>  There are a few different ways to debug Python code using PDB (The Python<br/>
  Debugger, actually I use IPDB, an enhanced version of PDB). What I usually do<br/>
  is insert the following line into the position where I want a break point:
</p>
<pre class="src src-python"><span>import</span> ipdb; ipdb.set_trace()
</pre>
<p>
  Of course, as a frequently used operation, I have found an Elisp function to<br/>
  help me do it:
</p>
<pre class="src src-emacs-lisp"><span class="linenr">1:  </span><span>(</span><span>defun</span> <span>python-add-breakpoint</span> <span>()</span>
<span class="linenr">2:  </span>  <span>"Add a break point"</span>
<span class="linenr">3:  </span>  <span>(</span>interactive<span>)</span>
<span class="linenr">4:  </span>  <span>(</span>newline-and-indent<span>)</span>
<span class="linenr">5:  </span>  <span>(</span>insert <span>"import ipdb; ipdb.set_trace()"</span><span>)</span>
<span class="linenr">6:  </span>  <span>(</span>highlight-lines-matching-regexp <span>"^[ ]*import ipdb; ipdb.set_trace()"</span><span>))</span>
<span class="linenr">7:  </span>
<span class="linenr">8:  </span><span>(</span>define-key python-mode-map <span>(</span>kbd <span>"C-c C-b"</span><span>)</span> 'python-add-breakpoint<span>)</span>
</pre>
<p>
  This function will insert the Python code mentioned above and highlight it.
</p>
<p>
  Then I create a shell in Emacs and run a Python program in the newly created<br/>
  shell, when the program reaches the “break point” it will automatically get<br/>
  into PDB.
</p>
<p>
  Say if I have a Python source code file ~/test.py:
</p>
<pre class="src src-python"><span class="linenr"> 1:  </span><span>#</span><span>!/usr/bin/env python</span>
<span class="linenr"> 2:  </span><span># </span><span>-*- encoding: utf-8 -*-</span>
<span class="linenr"> 3:  </span><span>#</span>
<span class="linenr"> 4:  </span><span># </span><span>Author: 任文山 (Ren Wenshan)</span>
<span class="linenr"> 5:  </span>
<span class="linenr"> 6:  </span>
<span class="linenr"> 7:  </span><span>def</span> <span>f</span>(a, b):
<span class="linenr"> 8:  </span><span> </span>   <span>return</span> <span>"%d - %d"</span> % (a, b)
<span class="linenr"> 9:  </span>
<span class="linenr">10:  </span><span>if</span> <span>__name__</span> == <span>"__main__"</span>:
<span class="linenr">11:  </span><span> </span>   <span>for</span> i <span>in</span> <span>xrange</span>(9, 1, -1):
<span class="linenr">12:  </span><span> </span>   <span> </span>   <span>if</span> i == 6: <span>import</span> ipdb; ipdb.set_trace()
<span class="linenr">13:  </span><span> </span>   <span> </span>   <span>print</span> f(i, i - 2)
</pre>
<p>
  You can see that I have set a break point at line #12. Now press <i>M-x shell</i><br/>
  to open a shell, and then run the Python file in it:
</p>
<pre class="src src-sh"><span>cd</span> ~ &amp;&amp; python test.py
</pre>
<p>
  It gets into PDB when the variable i is equal to 6:
</p>
<pre class="src src-text"><span class="linenr"> 1:  </span>wenshan@debian-vm-home:~$ cd ~ &amp;&amp; python test.py
<span class="linenr"> 2:  </span>9 - 7
<span class="linenr"> 3:  </span>8 - 6
<span class="linenr"> 4:  </span>7 - 5
<span class="linenr"> 5:  </span>&gt; /home/wenshan/test.py(13)&lt;module&gt;()
<span class="linenr"> 6:  </span>     11     for i in xrange(9, 1, -1):
<span class="linenr"> 7:  </span>     12         if i == 6: import ipdb; ipdb.set_trace()
<span class="linenr"> 8:  </span>---&gt; 13         print f(i, i - 2)
<span class="linenr"> 9:  </span>
<span class="linenr">10:  </span>ipdb&gt;
</pre>
<p>
  Now, if you want to redefine the f() method, you could do it in PDB. But that<br/>
  isn’t convenient at all, alternatively, we could enter the Python interactive<br/>
  interpreter, which is a much nicer programming environment, by executing the<br/>
  following line in PDB:
</p>
<pre class="src src-python">!<span>import</span> code; code.interact(local=<span>vars</span>())
</pre>
<p>
  Again, I have written an Elisp function to do it because I use this often:
</p>
<pre class="src src-emacs-lisp"><span class="linenr">1:  </span><span>(</span><span>defun</span> <span>python-interactive</span> <span>()</span>
<span class="linenr">2:  </span>  <span>"Enter the interactive Python environment"</span>
<span class="linenr">3:  </span>  <span>(</span>interactive<span>)</span>
<span class="linenr">4:  </span>  <span>(</span><span>progn</span>
<span class="linenr">5:  </span><span> </span>   <span>(</span>insert <span>"!import code; code.interact(local=vars())"</span><span>)</span>
<span class="linenr">6:  </span><span> </span>   <span>(</span>move-end-of-line 1<span>)</span>
<span class="linenr">7:  </span><span> </span>   <span>(</span>comint-send-input<span>)))</span>
<span class="linenr">8:  </span>
<span class="linenr">9:  </span><span>(</span>global-set-key <span>(</span>kbd <span>"C-c i"</span><span>)</span> 'python-interactive<span>)</span>
</pre>
<p>
  With this function, pressing <i>C-c i</i> (in PDB) will invoke an interactive<br/>
  interpreter.
</p>
<p>
  And now you could write code in the interpreter, interactively.
</p>
<p>
  But I’m not satisfied with this, because Python is very strict with<br/>
  indentation, so quite often you will have to rewrite your code for a few<br/>
  times due to some small mistake. Hence, I want to write Python code in a<br/>
  normal python-mode buffer, which brings auto indentation, error checking,<br/>
  auto completion and etc, and send the code to the interactive interpreter for<br/>
  execution.
</p>
</div>
</div></body></html>