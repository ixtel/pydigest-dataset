<html><body><div><div class="content html_format">
      <img src="https://habrastorage.org/files/707/3e0/5c1/7073e05c1fd6409d872795278e2fe1e1.gif"/>

<strong>Запятошка:</strong><p> Устраивайся поудобнее, Жучок, мы будем с тобой сегодня проводить мысленные эксперименты со свободно падающими телами.
</p><strong>Жучок:</strong><p> А это как? Тела будут падать в моём воображении? Прямо так и вижу: обнажённые тела, летящие на фоне звёздного неба…
</p><strong>Запятошка:</strong><p> Тела, конечно, воображаемые, но не настолько большие, чтобы быть обнажёнными. Вообще, речь пойдёт о свободном падении тел в однородном гравитационном поле.
</p><a name="habracut"/>
<img src="https://habrastorage.org/files/964/ae3/008/964ae3008d5a481bbfc03c1c7f317ffe.gif"/>

<strong>Жучок:</strong><p> Что это ещё за проектор снов такой?
</p><strong>Запятошка:</strong><p> Это мой экспериментальный проект. Пока что это куча страшного кода на Python с использованием IPython для связки. Ну, да вернёмся к нашему разговору. Итак, тело, падающее свободно с начальной скоростью </p><img src="https://habrastorage.org/files/6bf/e9e/d4e/6bfe9ed4e3224071a0b81e27b656c5d6.png"/><p> движется с ускорением…
</p><strong>Жучок:</strong><p> Опять ты бубнишь себе под нос всякие непонятные проклятия. Я много раз видел, как летят кусочки бабочек, которых с удовольствием пожираю каждый день. А твой проектор может показать, что получится, если разбросать кучу ошмётков места в разные стороны? Я тут подумываю о новом способе потрошения бабо… прости, поглощения обеда.
</p><strong>Запятошка:</strong><p> Вечно ты о еде думаешь, Жучок. А вообще, да, мы можем такую ситуацию смоделировать. Давай предположим, что все кусочки вылетают из одного с одинаковой скоростью, и проследим их полёт в течении первых нескольких секунд.
</p><img src="https://habrastorage.org/files/612/d35/8a3/612d358a3ca741b3b61c8e7063845d70.gif"/>

<strong>Жучок:</strong><p> Ого, салют!
</p><strong>Запятошка:</strong><p> Правда, похоже? А ещё что-нибудь замечаешь?
</p><strong>Жучок:</strong><p> Хм-м, похоже, что кусочки образуют круг… всегда… любопытная картинка. А почему так происходит?
</p><strong>Запятошка:</strong><p> Прежде, чем я объясню, заметь, что ты опознал, что это круг без всяких вычислений и формул. Даже в проекторе, если посмотришь, нигде нет указания, что кусочки должны всегда образовывать круг. Я просто указала проектору сэмулировать много летящих кусочков и всё, а уже твой мозг сам заметил закономерность безо всяких заумных объяснений и формул. Главное, задать интересный вопрос и иметь под рукой такой вот проектор!
</p><p>
А теперь попробую объяснить, почему получается такая картинка. Представь, что ты — один из маленьких кусочков, летящих вместе с остальными. Однако, тебя не швырнули вместе со всеми, тебе удалось ускользнуть и ты выпал из гнезда без начальной скорости. Немного придя в себя ты начинаешь смотреть вокруг и наблюдать за остальными кусочками. Как, по-твоему, на что будет похоже их поведение?
</p><strong>Жучок:</strong><p> Ну, они наверное будут от меня удаляться, так как их-то вышвырнули из гнезда.
</p><strong>Запятошка:</strong><p> Всё верно, в системе отсчёта, связанной с тобой падающим свободно, не будет действовать сила притяжения, а значит, что кусочки будут от тебя удаляться, двигаясь с одинаковой скорость равномерно и прямолинейно.
</p><strong>Жучок:</strong><p> Ух, как ты опять начала умничать. Но суть я уловил: кусочки будут от меня убегать как по спицам велосипеда, и в целом будут образовывать круг как велосипедное колесо. А это можно «увидеть» в твоём проекторе?
</p><strong>Запятошка:</strong><p> Можно, и это тебе будет упражнением на дом. А ещё попробуй доказать формально, что кусочки будут всегда образовывать круг, используя формулы для свободного падения.

</p><strong>Жучок:</strong><p> Ладно, ладно. А что ещё интересного можно посмотреть в твоём проекторе?
</p><strong>Запятошка:</strong><p> Я тебе расскажу про один приём нахождения любопытных свойств у обычных явлений. Ты ведь помнишь, что свободно падающие тела движутся, в общем случае, по параболе?
</p><strong>Жучок:</strong><p> Так вот что у тебя там рисуется как хвост у звёздочек в проекторе! Да, что-то у меня про параболы осталось в памяти.
</p><strong>Зпятошка:</strong><p> Очень хорошо! Давай </p><a href="http://en.wikipedia.org/wiki/Parabola">посмотрим в энциклопедии</a><p> какими интересными свойствами обладает парабола. Для начала, посмотрим какая получится картинка, если пометить вершины траекторий кусочков, полётом которых мы любовались выше.
</p><strong>Жучок:</strong><p> А как ты объяснишь проектору в каком месте ставить метку?
</p><strong>Запятошка:</strong><p> Ну, мы можем это сделать двумя способами. Если бы мы исследовали неизвестный феномен, то можно было бы просто объяснить проектору как найти локальный максимум траектории. Но мы-то знаем как движется тело в поле земли, поэтому попробуем подобрать формулу для координат вершины, и одновременно посмотрим как нам в этом может помочь пакет </p><a href="http://live.sympy.org/">sympy</a><p>, который умеет решать всевозможные задачки в символьном виде.
</p><div class="spoiler"><b class="spoiler_title">Инициализация</b><div class="spoiler_text"><pre><code class="python">import numpy as np
from IPython.core.display import Image 
from sympy import *
init_printing()
</code></pre>
<pre><code class="python">x,y,z = symbols('x y z')
v_0, alpha, g, t = symbols('v_0, alpha, g, t', real=True)
</code></pre>
</div></div>
<pre><code class="python">v_x = v_0 * cos(alpha)
v_y = v_0 * sin(alpha) - g * t
(Eq(Symbol('v_x'), v_x), Eq(Symbol('v_y'), v_y))
</code></pre>
<img src="https://habrastorage.org/files/3d8/024/118/3d802411866845168ef4787e58327d0a.png"/>

<strong>Запятошка:</strong><p> теперь вычислим координаты кусочка, учитывая, что запустили мы его из точки (0,0). Для этого необходимо проинтегрировать скорость по времени
</p><pre><code class="python">x_t = integrate(v_x, t)
y_t = integrate(v_y, t)
(Eq(x, x_t),Eq(y, y_t))
</code></pre>
<img src="https://habrastorage.org/files/9e6/bf4/4c9/9e6bf44c925f47c28d2a556b5ef10be7.png"/>

<strong>Жучок:</strong><p> постой, постой! Я запутался немного. Почему ты пишешь Symbol('v_x')? Почему нельзя просто указать переменную v_x, чтобы увидеть результирующее уравнение? Да и сами уравнения ты как-то странно выводишь…
</p><strong>Запятошка:</strong><p> ты очень наблюдательный, Жучок, молодец! Это потому, что переменная v_х и </p><em>символ</em><p> v_х — это разные сущности. Подробнее можешь почитать вот </p><a href="http://docs.sympy.org/latest/tutorial/gotchas.html">здесь</a><p>.
</p><strong>Запятошка:</strong><p> На вершине траектории вертикальная скорость </p><img src="https://habrastorage.org/files/521/efb/a45/521efba45253406f86ae6add383258ba.png"/><p>, откуда находим момент времени </p><img src="https://habrastorage.org/files/dad/b43/0f4/dadb430f4cb0482ab14d8589c237c70c.png"/><p> когда это происходит.
</p><pre><code class="python">solution=solve(v_y, t)
t_h = solution[0]; t_h
</code></pre>
<img src="https://habrastorage.org/files/6b9/46f/37b/6b946f37b8794d4ca131189f29b407af.png"/>

<strong>Запятошка:</strong><p> Наконец, координаты вершины параболы:
</p><pre><code class="python">x_h = x_t.subs(t, t_h);x_h
</code></pre>
<img src="https://habrastorage.org/files/4c8/ea2/a17/4c8ea2a17b7d442ea0fc70f9c5e9ea1b.png"/>
<pre><code class="python">y_h = y_t.subs(t, t_h);y_h
</code></pre>
<img src="https://habrastorage.org/files/80b/704/981/80b7049815d14e4f90510813a5203a25.png"/>

<strong>Запятошка:</strong><p> Обучаем наш проектор этому знанию и смотрим что получается.
</p><img src="https://habrastorage.org/files/98f/c9e/9d0/98fc9e9d0a7b43aca8699cfd92bffc2b.gif"/>

<strong>Жучок:</strong><p> Обалдеть! Это же… это же… Эллипс! Ну очень похож!
</p><strong>Запятошка:</strong><p> Молодец, Жучок. Заметь, ты сначала увидел картинку, а мозг уже сам подсказал тебе закономерность, которую нельзя было заметить сколь бы мы ни пялились на формулы.
</p><strong>Жучок:</strong><p> Запятошка, я кажется начинаю понимать зачем ты возишься со своим проектором. А мы будем доказывать, что это реально эллипс, а не фикция нашего воображения?
</p><strong>Запятошка:</strong><p> Конечно, давай попробуем это сделать. Правда, нам придётся немного попотеть объясняя sympy чего мы хотим добиться. По сути, необходимо избавиться от угла в выражениях для вершин парабол, и получить формулу, связывающую </p><img src="https://habrastorage.org/files/83a/4ca/9a8/83a4ca9a8c054afd8e57867869013793.png"/><p> и </p><img src="https://habrastorage.org/files/a97/347/d46/a97347d460f449519c56e6d379504421.png"/><p>. Если попробовать решить в лоб:
</p><pre><code class="python">solve([x-x_h, y-y_h], [y, alpha])
</code></pre>
<strong>Запятошка:</strong><p> то получится абракадабра (проверь дома сам). А всё потому, что sympy ещё маленький, не умеет элегантно манипулировать тригонометрическими выражениями. Но мы ему поможем. Для начала:
</p><pre><code class="python">x_h = trigsimp(x_h); x_h
</code></pre>
<img src="https://habrastorage.org/files/7a3/c42/67f/7a3c4267f7ae48fcb2ee736a3f16f9b7.png"/>

<strong>Запятошка:</strong><p> далее заметим, что в выражении для </p><img src="https://habrastorage.org/files/83a/4ca/9a8/83a4ca9a8c054afd8e57867869013793.png"/><p> можно сделать замену </p><img src="https://habrastorage.org/files/ed9/b9c/73d/ed9b9c73db69406eae6be63fcc05a345.png"/><p>. Делаем подстановку и получаем:
</p><pre><code class="python">y_h = y_h.subs(sin(alpha)**2, (1-cos(2*alpha))/2);y_h
</code></pre>
<img src="https://habrastorage.org/files/3c6/722/deb/3c6722deb498403090d9b87098b00640.png"/>

<strong>Жучок:</strong><p> Что-то мне подсказывает, что ты хочешь воспользоваться равенством </p><img src="https://habrastorage.org/files/bb8/a0c/9df/bb8a0c9dfc1c420090882f990ffebaf8.png"/>
<strong>Запятошка:</strong><p> Сразу видно, что долгие ночи подготовки не прошли для тебя даром. Выражаем </p><img src="https://habrastorage.org/files/ead/020/521/ead020521abe4bf787e9fec306ca5f0d.png"/><p> и </p><img src="https://habrastorage.org/files/0f1/81d/984/0f181d984b4c446fa67373dd90be6f4e.png"/><p> через </p><img src="https://habrastorage.org/files/da9/8b5/de7/da98b5de7f1d494096df4327093c306f.png"/><p> и </p><img src="https://habrastorage.org/files/fac/cdf/09f/faccdf09f2d14373bbaa8b90a8ef97b7.png"/><p>.
</p><pre><code class="python">s = solve([x-x_h, y-y_h], [sin(2*alpha), cos(2*alpha)]);s
</code></pre>
<img src="https://habrastorage.org/files/376/590/896/3765908969bd46bd976389fe7e358d87.png"/>

<strong>Запятошка:</strong><p> и подставляем в подмеченное тобой равенство:
</p><pre><code class="python">Eq(s[sin(2*alpha)]**2 + s[cos(2*alpha)]**2, 1)
</code></pre>
<img src="https://habrastorage.org/files/daa/65b/01d/daa65b01de024164a19dbc8f3f05bf04.png"/>

<strong>Запятошка:</strong><p> Получаем ни что иное, как уравнение эллипса!
</p><strong>Жучок:</strong><p> М-да…
</p><strong>Запятошка:</strong><p> Вот тебе ещё одно домашнее задание: выясни, как меняется форма эллипса в зависимости от начальной скорости, а также координаты его центра, можешь ещё и фокусы исследовать. Подсказка: найди эксцентриситет эллипса. Он, как ты помнишь, определяет форму эллипса

</p><strong>Жучок:</strong><p> Ладно-ладно, не ты одна такая умная, разберусь как-нибудь. Ты лучше ещё что-нибудь покажи, а то нашла какой-то эллипс и радуешься как ребёнок…
</p><strong>Запятошка:</strong><p> А вот и покажу! Читаем упомянутую выше энциклопедию дальше и обнаруживаем там описание фокуса параболы. Какой у нас сразу возникает вопрос? По твоей кислой мине сразу понятно, что мы хотим пометить фокусы всех наших парабол и посмотреть, что получится.
</p><strong>Жучок:</strong><p> Что, опять эллипс?
</p><strong>Запятошка:</strong><p> Почём мне знать? Давай посмотрим. В виду симметрии, абсцисса фокуса совпадает с абсциссой вершины параболы. А вот ординату надо будет найти по формуле </p><img src="https://habrastorage.org/files/070/fff/e5a/070fffe5abf847339772f24f4c7d7869.png"/><p> согласно энциклопедии. Для этого найдём сначала уравнение параболы через </p><img src="https://habrastorage.org/files/da9/8b5/de7/da98b5de7f1d494096df4327093c306f.png"/><p> и </p><img src="https://habrastorage.org/files/fac/cdf/09f/faccdf09f2d14373bbaa8b90a8ef97b7.png"/><p>, избавишься для этого от </p><img src="https://habrastorage.org/files/6b9/f43/987/6b9f4398786f4c89bbb3b340e75180ba.png"/><p>.
</p><pre><code class="python">ss = solve([x-x_t,y-y_t], [y,t], dict=True);ss
</code></pre>
<img src="https://habrastorage.org/files/1f1/80e/9fa/1f180e9fa09f40dc8bb05411e642a303.png"/>

<strong>Запятошка:</strong><p> Следовательно, коэффициенты квадратичного трёхчлена:
</p><pre><code class="python">a,b,c = ss[0][y].as_poly(x).all_coeffs(); a,b,c
</code></pre>
<img src="https://habrastorage.org/files/1ac/2aa/1c2/1ac2aa1c26174a7f9efc7ce246b6c25b.png"/>

<strong>Запятошка:</strong><p> Дальше попробуй сам.
</p><strong>Жучок:</strong><p> Хорошо, значит дискриминант получится вот таким:
</p><pre><code class="python">D = b**2 - 4*a*c; D
</code></pre>
<img src="https://habrastorage.org/files/704/b26/422/704b26422965498595b2eb3203cafc2b.png"/>

<strong>Жучок:</strong><p> и ордината фокуса:
</p><pre><code class="python">y_f=(1-D)/(4*a);y_f
</code></pre>
<img src="https://habrastorage.org/files/e71/567/0a6/e715670a66ff4b7eb6050946013593c9.png"/>

<strong>Жучок:</strong><p> Что получится, если это подставить в твой проектор, Запятошка?
</p><strong>Запятошка:</strong><p> А вот что!
</p><img src="https://habrastorage.org/files/ee4/51c/3a5/ee451c3a5b0f402b90805ec990e1c355.gif"/>

<strong>Жучок:</strong><p> У меня нет слов! Чем-то смахивает на какой-то сакральный знак… Вспомнил! Око Ра!
</p><strong>Запятошка:</strong><p> Ну у тебя и воображение, Жучок. Попробуешь доказать, что фокусы ложатся на круг?
</p><strong>Жучок:</strong><p> Так, значит сначала пробуем упростить:
</p><pre><code class="python">y_f = trigsimp(y_f); y_f
</code></pre>
<img src="https://habrastorage.org/files/40a/100/43e/40a10043e1844f098bf7a60701630fba.png"/>

<strong>Жучок:</strong><p> Э, да тут всё просто получается! Даже потеть не надо, просто складываем квадраты абсциссы и ординаты:
</p><pre><code class="python">Eq(x**2 + y**2, simplify(x_h**2 + y_f**2))
</code></pre>
<img src="https://habrastorage.org/files/f48/dc2/034/f48dc20349224e4bab9f03f627d96e29.png"/>

<strong>Запятошка:</strong><p> Ну, раз уж ты у нас такой молодец, то вот тебе ещё одна задачка на дом. Изучи, как ведут себя директрисы наших парабол.
</p><strong>Жучок:</strong><p> А что если у меня возникнут трудности?
</p><strong>Запятошка:</strong><p> Постарайся самостоятельно разобраться, помня, что наши инструменты всё ещё далеки от совершенства и им нужно эпизодически помогать и подсказывать. Если всё же вопросы останутся — встретимся ещё раз и пообщаемся.
</p><p>
Напоследок, последняя задачка: посмотри внимательно на самую первую картинку в начале нашей беседы — видишь, там ещё одна фигура на фоне вырисовывается? Попробуй выяснить, что это за фигура и как себя ведёт.
</p><p>
Вот тебе ещё парочка ресурсов для вдохновения.
</p>
      <p class="clear"/>
    </div>

    
  </div></body></html>