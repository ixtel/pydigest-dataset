<html><body><div><div class="post-text" itemprop="text">

<p>I have lines as such from this dataset (<a href="https://raw.githubusercontent.com/alvations/stasis/master/sts.csv" rel="nofollow">https://raw.githubusercontent.com/alvations/stasis/master/sts.csv</a>):</p>

<pre><code>Dataset Domain  Score   Sent1   Sent2
STS2012-gold    surprise.OnWN   5.000   render one language in another language restate (words) from one language into another language.
STS2012-gold    surprise.OnWN   3.250   nations unified by shared interests, history or institutions    a group of nations having common interests.
STS2012-gold    surprise.OnWN   3.250   convert into absorbable substances, (as if) with heat or chemical process   soften or disintegrate by means of chemical action, heat, or moisture.
STS2012-gold    surprise.OnWN   4.000   devote or adapt exclusively to an skill, study, or work devote oneself to a special area of work.
STS2012-gold    surprise.OnWN   3.250   elevated wooden porch of a house    a porch that resembles the deck on a ship.
</code></pre>

<p>I have read it into a <code>graphlab.SFrame</code> using the <code>read_csv()</code> function:</p>

<pre><code>import graphlab
sts = graphlab.SFrame.read_csv('sts.csv', delimiter='\t', column_type_hints=[str, str, float, str, str])
</code></pre>

<p>And there were lines that are not parsed. The traceback is as follows:</p>

<pre><code>PROGRESS: Unable to parse line "STS2012-gold    MSRpar  3.800   "She was crying and scared,' said Isa Yasin, the owner of the store.    "She was crying and she was really scared," said Yasin."
PROGRESS: Unable to parse line "STS2012-gold    MSRpar  2.200   "And about eight to 10 seconds down, I hit. "I was in the water for about eight seconds."
PROGRESS: Unable to parse line "STS2012-gold    MSRpar  2.800   "It's a major victory for Maine, and it's a major victory for other states. The Maine program could be a model for other states."
PROGRESS: Unable to parse line "STS2012-gold    MSRpar  4.000   "Right from the beginning, we didn't want to see anyone take a cut in pay.  But Mr. Crosby told The Associated Press: "Right from the beginning, we didn't want to see anyone take a cut in pay."
PROGRESS: Unable to parse line "STS2014-gold    deft-forum  0.8 "Then the captain was gone. Then the captain came back."
PROGRESS: Unable to parse line "STS2014-gold    deft-forum  1.8 "Oh, you're such a good person! You're such a bad person!""
PROGRESS: Unable to parse line "STS2012-train   MSRpar  3.750   "We put a lot of effort and energy into improving our patching process, probably later than we should have and now we're just gaining incredible speed. "We've put a lot of effort and energy into improving our patching progress, p..."
PROGRESS: Unable to parse line "STS2012-train   MSRpar  4.000   "Tomorrow at the Mission Inn, I have the opportunity to congratulate the governor-elect of the great state of California.   "I have the opportunity to congratulate the governor-elect of the great state of California, and I'm lookin..."
PROGRESS: Unable to parse line "STS2012-train   MSRpar  3.600   "Unlike many early-stage Internet firms, Google is believed to be profitable.   The privately held Google is believed to be profitable."
PROGRESS: Unable to parse line "STS2012-train   MSRpar  4.000   "It was a final test before delivering the missile to the armed forces. State radio said it was the last test before the missile was delivered to the armed forces."
PROGRESS: 22 lines failed to parse correctly
PROGRESS: Finished parsing file /home/alvas/git/stasis/sts.csv
PROGRESS: Parsing completed. Parsed 19075 lines in 0.069578 secs.
</code></pre>

<p>Look at these lines there seems to be a problem if any of my <code>Sent1</code> or <code>Sent2</code> columns contains odd-numbered double quotation marks.</p>

<p>Using the <code>error_bad_lines</code> to track the problematic lines:</p>

<pre><code>sts = graphlab.SFrame.read_csv('sts.csv', delimiter='\t', column_type_hints=[str, str, float, str, str],
                              error_bad_lines=True)
</code></pre>

<p>It throws the traceback:</p>

<pre><code>---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
&lt;ipython-input-15-a1ec53597af9&gt; in &lt;module&gt;()
      1 sts = graphlab.SFrame.read_csv('sts.csv', delimiter='\t', column_type_hints=[str, str, float, str, str],
----&gt; 2                               error_bad_lines=True)

/usr/local/lib/python2.7/dist-packages/graphlab/data_structures/sframe.pyc in read_csv(cls, url, delimiter, header, error_bad_lines, comment_char, escape_char, double_quote, quote_char, skip_initial_space, column_type_hints, na_values, line_terminator, usecols, nrows, skiprows, verbose, **kwargs)
   1537                                   verbose=verbose,
   1538                                   store_errors=False,
-&gt; 1539                                   **kwargs)[0]
   1540 
   1541 

/usr/local/lib/python2.7/dist-packages/graphlab/data_structures/sframe.pyc in _read_csv_impl(cls, url, delimiter, header, error_bad_lines, comment_char, escape_char, double_quote, quote_char, skip_initial_space, column_type_hints, na_values, line_terminator, usecols, nrows, skiprows, verbose, store_errors, **kwargs)
   1097                 glconnect.get_client().set_log_progress(False)
   1098             with cython_context():
-&gt; 1099                 errors = proxy.load_from_csvs(internal_url, parsing_config, type_hints)
   1100         except Exception as e:
   1101             if type(e) == RuntimeError and "CSV parsing cancelled" in e.message:

/usr/local/lib/python2.7/dist-packages/graphlab/cython/context.pyc in __exit__(self, exc_type, exc_value, traceback)
     47             if not self.show_cython_trace:
     48                 # To hide cython trace, we re-raise from here
---&gt; 49                 raise exc_type(exc_value)
     50             else:
     51                 # To show the full trace, we do nothing and let exception propagate

RuntimeError: Runtime Exception. Unable to parse line "STS2012-gold MSRpar  3.800   "She was crying and scared,' said Isa Yasin, the owner of the store.    "She was crying and she was really scared," said Yasin."
Set error_bad_lines=False to skip bad lines
</code></pre>

<p><strong>Is there a way to resolve this problem where my lines contains odd number of double quotes?</strong> </p>

<p><strong>Is there a way to do it without cleaning the data (e.g. identifying the problematic lines and then clean/correct them but keep another SFrame to track the cleaning/correction?</strong></p>

<hr/>

<p>As a sanity check, if we do a search <code>\t</code> in the raw csv file, there's a tab in the rows that gives problem but when <code>graphlab</code> parses it, it disappears:</p>

<p><a href="http://i.stack.imgur.com/3DzsG.png" rel="nofollow"><img src="http://i.stack.imgur.com/3DzsG.png" alt="enter image description here"/></a></p>

<hr/>

<p>As another sanity check, reading the file line by line and splitting it by <code>\t</code> returns 5 columns for the whole file:</p>

<pre><code>alvas@ubi:~/git/stasis$ head sts.csv 
Dataset Domain  Score   Sent1   Sent2
STS2012-gold    surprise.OnWN   5.000   render one language in another language restate (words) from one language into another language.
STS2012-gold    surprise.OnWN   3.250   nations unified by shared interests, history or institutions    a group of nations having common interests.
STS2012-gold    surprise.OnWN   3.250   convert into absorbable substances, (as if) with heat or chemical process   soften or disintegrate by means of chemical action, heat, or moisture.
STS2012-gold    surprise.OnWN   4.000   devote or adapt exclusively to an skill, study, or work devote oneself to a special area of work.
STS2012-gold    surprise.OnWN   3.250   elevated wooden porch of a house    a porch that resembles the deck on a ship.
STS2012-gold    surprise.OnWN   4.000   either half of an archery bow   either of the two halves of a bow from handle to tip.
STS2012-gold    surprise.OnWN   3.333   a removable device that is an accessory to larger object    a supplementary part or accessory.
STS2012-gold    surprise.OnWN   4.750   restrict or confine place limits on (extent or access).
STS2012-gold    surprise.OnWN   0.500   orient, be positioned   be opposite.
alvas@ubi:~/git/stasis$ python
Python 2.7.10 (default, Jun 30 2015, 15:30:23) 
[GCC 4.8.4] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; with open('sts.csv') as fin:
...     for line in fin:
...             print len(line.split('\t'))
...             break
... 
5

&gt;&gt;&gt; with open('sts.csv') as fin:
...     for line in fin:
...             assert len(line.split('\t')) == 5
... 
&gt;&gt;&gt; 
</code></pre>

<hr/>

<p>Even more sanity check that it's the no. of columns, @papayawarrior example of the 4 columns line was correctly parsed in my version of <code>graphlab</code>:</p>

<p><a href="http://i.stack.imgur.com/TrjPE.png" rel="nofollow"><img src="http://i.stack.imgur.com/TrjPE.png" alt="enter image description here"/></a></p>

<hr/>

<p>I have manually checked the problematic lines and they're:</p>

<pre><code>STS2012-gold    MSRpar  3.800   "She was crying and scared,' said Isa Yasin, the owner of the store.    "She was crying and she was really scared," said Yasin.
STS2012-gold    MSRpar  2.200   "And about eight to 10 seconds down, I hit. "I was in the water for about eight seconds.
STS2012-gold    MSRpar  2.800   "It's a major victory for Maine, and it's a major victory for other states. The Maine program could be a model for other states.
STS2012-gold    MSRpar  4.000   "Right from the beginning, we didn't want to see anyone take a cut in pay.  But Mr. Crosby told The Associated Press: "Right from the beginning, we didn't want to see anyone take a cut in pay.
STS2012-train   MSRpar  3.750   "We put a lot of effort and energy into improving our patching process, probably later than we should have and now we're just gaining incredible speed. "We've put a lot of effort and energy into improving our patching progress, probably later than we should have.
STS2012-train   MSRpar  4.000   "Tomorrow at the Mission Inn, I have the opportunity to congratulate the governor-elect of the great state of California.   "I have the opportunity to congratulate the governor-elect of the great state of California, and I'm looking forward to it."
STS2012-train   MSRpar  3.600   "Unlike many early-stage Internet firms, Google is believed to be profitable.   The privately held Google is believed to be profitable.
STS2012-train   MSRpar  4.000   "It was a final test before delivering the missile to the armed forces. State radio said it was the last test before the missile was delivered to the armed forces.
STS2012-train   MSRpar  4.750   "The economy, nonetheless, has yet to exhibit sustainable growth.   But the economy hasn't shown signs of sustainable growth.
STS2014-gold    deft-forum  0.8 "Then the captain was gone. Then the captain came back.
STS2014-gold    deft-forum  1.8 "Oh, you're such a good person! You're such a bad person!"
STS2015-gold    answers-forums      "Normal, healthy (physically, nutritionally and mentally) individuals have little reason to worry about accidentally consuming too much water.  It's fine to skip arm specific exercises if you are already happy with how they are progressing without direct exercises.
STS2015-gold    answers-forums  1.40    "The grass family is one of the most widely distributed and abundant groups of plants on Earth. As noted on the Wiki page, grass seed was imported to the new world to improve pasturage for livestock.
STS2015-gold    answers-forums      "God is exactly this Substance underlying who supports, exist independently of, and persist through time changes in material nature.    I'd argue that matter and energy are substances in the category of empirical scientific knowledge.
STS2015-gold    belief      "watching the first fight i saw that manny pacquiao was getting tired, and i wasn't.    at the same time, an asian summit is being held in a tourist resort.
STS2015-gold    belief      "global warming doesn't mean every year will be warmer than the last.   doesn't matter, that will just be obama's fault as well.
STS2015-gold    belief      "the only reason i'm not as confident that there's something about the birth certificate... the conventional view is that the us and ussr fought it out in the body of vietnam.
STS2015-gold    belief      "im not playing these bullshit games... if not get the hell out of there.
STS2015-gold    belief      "that oil is already contaminating our shoreline.   what point are you trying to relay?
STS2015-gold    belief      "we cannot write history with laws. "she's not sitting here" he said.
STS2015-gold    belief      the protest is going well so far.   our request is the same.
STS2015-gold    belief      "for over 20 years, i have illustrated the absurd with absurdity, three hours a day, five days a week.  for the first 1-2 years he hated me going out with my friends.
</code></pre>

<p>Instead of finding these lines manually by repeatedly cleaning out these lines from the <code>PROGRESS: ...</code> verbose message, <strong>is there a way to just dump these lines out when loading it into a Graphlab SFrame?</strong> </p>
    </div>
    </div></body></html>