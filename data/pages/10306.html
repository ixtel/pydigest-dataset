<html><body><div><article class="text">
        

        <header class="article-header">
            <h1 class="page-title">PEP 0515 -- Underscores in Numeric Literals</h1>
        </header>

        

 
  <table class="rfc2822 docutils field-list" frame="void" rules="none">
   <col class="field-name"/>
   
   <col class="field-body"/>
   
   <tbody valign="top">
    <tr class="field">
     <th class="field-name">
      PEP:
     </th>
     <td class="field-body">
      515
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Title:
     </th>
     <td class="field-body">
      Underscores in Numeric Literals
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Author:
     </th>
     <td class="field-body">
      Georg Brandl, Serhiy Storchaka
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Status:
     </th>
     <td class="field-body">
      Draft
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Type:
     </th>
     <td class="field-body">
      Standards Track
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Created:
     </th>
     <td class="field-body">
      10-Feb-2016
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Python-Version:
     </th>
     <td class="field-body">
      3.6
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Post-History:
     </th>
     <td class="field-body">
      10-Feb-2016, 11-Feb-2016
     </td>
    </tr>
   </tbody>
  </table>
  <hr/>
  
  <div class="section" id="abstract-and-rationale">
   
   <p>
    This PEP proposes to extend Python's syntax and number-from-string
constructors so that underscores can be used as visual separators for
digit grouping purposes in integral, floating-point and complex number
literals.
   </p>
   <p>
    This is a common feature of other modern languages, and can aid
readability of long literals, or literals whose value should clearly
separate into parts, such as bytes or words in hexadecimal notation.
   </p>
   <p>
    Examples:
   </p>
   <pre class="literal-block">
# grouping decimal numbers by thousands
amount = 10_000_000.0

# grouping hexadecimal addresses by words
addr = 0xCAFE_F00D

# grouping bits into nibbles in a binary literal
flags = 0b_0011_1111_0100_1110

# same, for string conversions
flags = int('0b_1111_0000', 2)
</pre>
  </div>
  <div class="section" id="specification">
   
   <p>
    The current proposal is to allow one underscore between digits, and
after base specifiers in numeric literals.  The underscores have no
semantic meaning, and literals are parsed as if the underscores were
absent.
   </p>
   <div class="section" id="literal-grammar">
    
    <p>
     The production list for integer literals would therefore look like
this:
    </p>
    <pre class="literal-block">
integer: decinteger | bininteger | octinteger | hexinteger
decinteger: nonzerodigit (["_"] digit)* | "0" (["_"] "0")*
bininteger: "0" ("b" | "B") (["_"] bindigit)+
octinteger: "0" ("o" | "O") (["_"] octdigit)+
hexinteger: "0" ("x" | "X") (["_"] hexdigit)+
nonzerodigit: "1"..."9"
digit: "0"..."9"
bindigit: "0" | "1"
octdigit: "0"..."7"
hexdigit: digit | "a"..."f" | "A"..."F"
</pre>
    <p>
     For floating-point and complex literals:
    </p>
    <pre class="literal-block">
floatnumber: pointfloat | exponentfloat
pointfloat: [digitpart] fraction | digitpart "."
exponentfloat: (digitpart | pointfloat) exponent
digitpart: digit (["_"] digit)*
fraction: "." digitpart
exponent: ("e" | "E") ["+" | "-"] digitpart
imagnumber: (floatnumber | digitpart) ("j" | "J")
</pre>
   </div>
   <div class="section" id="constructors">
    
    <p>
     Following the same rules for placement, underscores will be allowed in
the following constructors:
    </p>
    <ul class="simple">
     <li>
      <tt class="docutils literal">
       int()
      </tt>
      (with any base)
     </li>
     <li>
      <tt class="docutils literal">
       float()
      </tt>
     </li>
     <li>
      <tt class="docutils literal">
       complex()
      </tt>
     </li>
     <li>
      <tt class="docutils literal">
       Decimal()
      </tt>
     </li>
    </ul>
   </div>
  </div>
  <div class="section" id="prior-art">
   
   <p>
    Those languages that do allow underscore grouping implement a large
variety of rules for allowed placement of underscores.  In cases where
the language spec contradicts the actual behavior, the actual behavior
is listed.  ("single" or "multiple" refer to allowing runs of
consecutive underscores.)
   </p>
   <ul class="simple">
    <li>
     Ada: single, only between digits
     <a class="footnote-reference" href="#id21" id="id1">
      [8]
     </a>
    </li>
    <li>
     C# (open proposal for 7.0): multiple, only between digits
     <a class="footnote-reference" href="#id19" id="id2">
      [6]
     </a>
    </li>
    <li>
     C++14: single, between digits (different separator chosen)
     <a class="footnote-reference" href="#id14" id="id3">
      [1]
     </a>
    </li>
    <li>
     D: multiple, anywhere, including trailing
     <a class="footnote-reference" href="#id15" id="id4">
      [2]
     </a>
    </li>
    <li>
     Java: multiple, only between digits
     <a class="footnote-reference" href="#id20" id="id5">
      [7]
     </a>
    </li>
    <li>
     Julia: single, only between digits (but not in float exponent parts)
     <a class="footnote-reference" href="#id22" id="id6">
      [9]
     </a>
    </li>
    <li>
     Perl 5: multiple, basically anywhere, although docs say it's
restricted to one underscore between digits
     <a class="footnote-reference" href="#id16" id="id7">
      [3]
     </a>
    </li>
    <li>
     Ruby: single, only between digits (although docs say "anywhere")
     <a class="footnote-reference" href="#id23" id="id8">
      [10]
     </a>
    </li>
    <li>
     Rust: multiple, anywhere, except for between exponent "e" and digits
     <a class="footnote-reference" href="#id17" id="id9">
      [4]
     </a>
    </li>
    <li>
     Swift: multiple, between digits and trailing (although textual
description says only "between digits")
     <a class="footnote-reference" href="#id18" id="id10">
      [5]
     </a>
    </li>
   </ul>
  </div>
  <div class="section" id="alternative-syntax">
   
   <div class="section" id="underscore-placement-rules">
    
    <p>
     Instead of the relatively strict rule specified above, the use of
underscores could be less limited.  As seen in other languages, common
rules include:
    </p>
    <ul class="simple">
     <li>
      Only one consecutive underscore allowed, and only between digits.
     </li>
     <li>
      Multiple consecutive underscores allowed, but only between digits.
     </li>
     <li>
      Multiple consecutive underscores allowed, in most positions except
for the start of the literal, or special positions like after a
decimal point.
     </li>
    </ul>
    <p>
     The syntax in this PEP has ultimately been selected because it covers
the common use cases, and does not allow for syntax that would have to
be discouraged in style guides anyway.
    </p>
    <p>
     A less common rule would be to allow underscores only every N digits
(where N could be 3 for decimal literals, or 4 for hexadecimal ones).
This is unnecessarily restrictive, especially considering the
separator placement is different in different cultures.
    </p>
   </div>
   <div class="section" id="different-separators">
    
    <p>
     A proposed alternate syntax was to use whitespace for grouping.
Although strings are a precedent for combining adjoining literals, the
behavior can lead to unexpected effects which are not possible with
underscores.  Also, no other language is known to use this rule,
except for languages that generally disregard any whitespace.
    </p>
    <p>
     C++14 introduces apostrophes for grouping (because underscores
introduce ambiguity with user-defined literals), which is not
considered because of the use in Python's string literals.
     <a class="footnote-reference" href="#id14" id="id11">
      [1]
     </a>
    </p>
   </div>
  </div>
  <div class="section" id="open-proposals">
   
   <p>
    It has been proposed
    <a class="footnote-reference" href="#id24" id="id12">
     [11]
    </a>
    to extend the number-to-string formatting
language to allow
    <tt class="docutils literal">
     _
    </tt>
    as a thousans separator, where currently only
    <tt class="docutils literal">
     ,
    </tt>
    is supported.  This could be used to easily generate code with
more readable literals.
   </p>
  </div>
  <div class="section" id="implementation">
   
   <p>
    A preliminary patch that implements the specification given above has
been posted to the issue tracker.
    <a class="footnote-reference" href="#id25" id="id13">
     [12]
    </a>
   </p>
  </div>
  
  <div class="section" id="copyright">
   
   <p>
    This document has been placed in the public domain.
   </p>
   
  </div>
 
Source: <a href="https://hg.python.org/peps/file/tip/pep-0515.txt">https://hg.python.org/peps/file/tip/pep-0515.txt</a>

    </article>


                </div></body></html>