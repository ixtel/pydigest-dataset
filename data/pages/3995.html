<html><body><div><div class="article-content"><p>I discovered <a class="reference external" href="https://virtualenv.pypa.io/">virtualenvwrapper</a> in early 2012, it’s been my tool of choice when working with python since then. Now, <tt class="docutils literal">mkvirtualenv</tt> is the first command I type when starting a project. Then my workflow used to look something close to:</p><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span> ~/codaz/myproject
<span class="nv">$ </span>workon myproject
<span class="o">(</span>myproject<span class="o">)</span><span class="nv">$ </span><span class="nb">source </span>myenv
</pre></div><p>This is very repetitive and long to type. Trying to be a good developer I tend to be as lazy as humanly possible, thankfully virtualenvwrapper is helping us being just that. I’ll show a few commands and some useful user hooks I’m using to streamline repetitive tasks.</p><p>I used to have a lot of user hooks to do the job but now with commands like <tt class="docutils literal">mkproject</tt> the whole thing is very simple.</p><p>First step is to create a <tt class="docutils literal">PROJECT_HOME</tt> environment variable, in my case I edit <tt class="docutils literal"><span class="pre">~/.bashrc</span></tt> and add this line near the end:</p><div class="highlight"><pre><span class="nb">export </span><span class="nv">PROJECT_HOME</span><span class="o">=</span>/home/hr/codaz
</pre></div><p>I then source this file so the variable is available.</p><p>Now when creating a new project, I simply use <tt class="docutils literal">mkproject</tt>:</p><div class="highlight"><pre><span class="nv">$ </span>mkproject coolapp
New python executable in coolapp/bin/python
Installing setuptools, pip...done.
Creating /home/hr/codaz/coolapp
Setting project <span class="k">for</span> coolapp to /home/hr/codaz/coolapp
<span class="o">(</span>coolapp<span class="o">)</span><span class="nv">$ </span><span class="nb">pwd</span>
/home/hr/codaz/coolapp
</pre></div><p>Using the <tt class="docutils literal">mkproject</tt> command did the following:</p><ul class="simple"><li>create a virtualenv named coolapp</li><li>create a project folder named coolapp in <tt class="docutils literal">$PROJECT_HOME</tt></li><li>create a file with the project folder path in <tt class="docutils literal"><span class="pre">$VIRTUAL_ENV/$VIRTUALENVWRAPPER_PROJECT_FILENAME</span></tt></li><li>cd to <tt class="docutils literal">$PROJECT_HOME/coolapp</tt></li><li>activate the virtualenv</li></ul><p>From now on, activating the virtualenv with <tt class="docutils literal">workon</tt> will also change the directory to our project folder. When using that virtualenv, using <tt class="docutils literal">cdproject</tt> will bring you back to your project folder.</p><p>When working on a project, I also often need some environment variables to be set, that’s where I use the hooks. You need to edit <tt class="docutils literal">$WORKON_HOME/postactivate</tt> and <tt class="docutils literal">$WORKON_HOME/predeactivate</tt> so they include:</p><div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> -f <span class="s2">"</span><span class="nv">$VIRTUAL_ENV</span><span class="s2">/</span><span class="nv">$VIRTUALENVWRAPPER_PROJECT_FILENAME</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">venvrc</span><span class="o">=</span><span class="s2">"</span><span class="k">$(</span>cat <span class="nv">$VIRTUAL_ENV</span>/<span class="nv">$VIRTUALENVWRAPPER_PROJECT_FILENAME</span><span class="k">)</span><span class="s2">/.venvrc"</span>
    <span class="k">if</span> <span class="o">[</span> -f <span class="s2">"</span><span class="nv">$venvrc</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">source</span> <span class="s2">"</span><span class="nv">$venvrc</span><span class="s2">"</span>
    <span class="k">fi</span>
<span class="k">fi</span>
</pre></div><p>Then in the project folder I create a file called <tt class="docutils literal">.venvrc</tt> with the following skeleton:</p><div class="highlight"><pre><span class="c"># virtualenv env variables</span>
<span class="c"># this file is sourced in postactivate and postdeactivate hooks</span>
<span class="c"># the $VENV variable is used to know which state the project is in</span>

<span class="k">case</span> <span class="s2">"</span><span class="nv">$VENV</span><span class="s2">"</span> in
    <span class="c"># virtualenv was active so this is a postdeactivate, CLEAN ALL THE STUFF</span>
    <span class="s1">'active'</span><span class="o">)</span>
        <span class="nb">unset </span>VENVRC
    <span class="p">;;</span>
    <span class="c"># virtualenv is getting activated, set the env variables</span>
    *<span class="o">)</span>
        <span class="nb">export </span><span class="nv">VENVRC</span><span class="o">=</span><span class="s2">"active"</span>
    <span class="p">;;</span>
<span class="k">esac</span>

<span class="c"># vim: syntax=sh</span>
</pre></div><p>This is a good start and much can be stuffed in the <tt class="docutils literal">.venvrc</tt> file.</p><p>If you just discovered about the concept of project folder in virtualenv, you can use <a class="reference external" href="https://virtualenvwrapper.readthedocs.org/en/latest/command_ref.html#setvirtualenvproject">setvirtualenvproject</a> to set a project for an already existing virtualenv.</p><p>There is a bunch of other <a class="reference external" href="https://virtualenvwrapper.readthedocs.org/en/latest/command_ref.html">very powerful commands</a> provided by virtualenvwrapper, you should definitely check it out.</p></div></div></body></html>