<html><body><div><article class="markdown-body entry-content" itemprop="text"><a href="https://camo.githubusercontent.com/edf1eed242a022e014a63bf22c8e1e783ee70cd5/68747470733a2f2f7261772e6769746875622e636f6d2f6b6c656e2f6d756666696e2f646576656c6f702f646f63732f7374617469632f6c6f676f2e706e67" target="_blank"><img alt="https://raw.github.com/klen/muffin/develop/docs/static/logo.png" src="https://camo.githubusercontent.com/edf1eed242a022e014a63bf22c8e1e783ee70cd5/68747470733a2f2f7261772e6769746875622e636f6d2f6b6c656e2f6d756666696e2f646576656c6f702f646f63732f7374617469632f6c6f676f2e706e67" data-canonical-src="https://raw.github.com/klen/muffin/develop/docs/static/logo.png"/></a>
<a name="user-content-the-muffin"/>

<a href="http://travis-ci.org/klen/muffin" id="user-content-badges"><img alt="Build Status" src="https://camo.githubusercontent.com/11f55c71f8f83b4f8b8ba606931e4230495e7ab0/687474703a2f2f696d672e736869656c64732e696f2f7472617669732f6b6c656e2f6d756666696e2e7376673f7374796c653d666c61742d737175617265" data-canonical-src="http://img.shields.io/travis/klen/muffin.svg?style=flat-square"/></a>
<a href="https://pypi.python.org/pypi/muffin"><img alt="http://img.shields.io/pypi/v/muffin.svg?style=flat-square" src="https://camo.githubusercontent.com/cdae552250d74ac6c03bdcba7603be220a91f1c5/687474703a2f2f696d672e736869656c64732e696f2f707970692f762f6d756666696e2e7376673f7374796c653d666c61742d737175617265" data-canonical-src="http://img.shields.io/pypi/v/muffin.svg?style=flat-square"/></a>
<a href="https://pypi.python.org/pypi/muffin"><img alt="http://img.shields.io/pypi/dm/muffin.svg?style=flat-square" src="https://camo.githubusercontent.com/67164c2aa255e698e30b6e9245505b68cfe8d667/687474703a2f2f696d672e736869656c64732e696f2f707970692f646d2f6d756666696e2e7376673f7374796c653d666c61742d737175617265" data-canonical-src="http://img.shields.io/pypi/dm/muffin.svg?style=flat-square"/></a>
<p id="user-content-description">The Muffin -- A web framework based on <a href="https://docs.python.org/3/library/asyncio.html">Asyncio</a> stack <code>(early beta)</code></p>
<p>Muffin is a fast, simple and asyncronous web-framework for <a href="http://python.org">Python</a> 3.</p>
<p>Example "Hello User" with the Muffin:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> muffin


app <span class="pl-k">=</span> muffin.Application(<span class="pl-s"><span class="pl-pds">'</span>example<span class="pl-pds">'</span></span>)


<span class="pl-en">@app.register</span>(<span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>/hello/<span class="pl-c1">{name}</span><span class="pl-pds">'</span></span>)
<span class="pl-k">def</span> <span class="pl-en">hello</span>(<span class="pl-smi">request</span>):
    name <span class="pl-k">=</span> request.match_info.get(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>anonymous<span class="pl-pds">'</span></span>)
    <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">'</span>Hello <span class="pl-c1">%s</span>!<span class="pl-pds">'</span></span> <span class="pl-k">%</span> name

<span class="pl-k">if</span> <span class="pl-c1">__name__</span> <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span>__main__<span class="pl-pds">'</span></span>:
    app.manage()</pre></div>
<p>Save the script as example.py and run it:</p>
<pre>$ python3 example.py run
</pre>
<p>Open <a href="http://fuf.me:5000">http://fuf.me:5000</a>, <a href="http://fuf.me:5000/hello/username">http://fuf.me:5000/hello/username</a> in your browser. Enjoy!</p>

<a name="user-content-id2"/>

<p>The list of some Muffin plugins (please make PR if you want to provide more):</p>

<a name="user-content-id3"/>


<a name="user-content-benchmarks"/>

<p>You could find some tests here: <a href="http://klen.github.io/py-frameworks-bench/">http://klen.github.io/py-frameworks-bench/</a></p>
<a name="user-content-id4"/>

<p><strong>The Muffin</strong> should be installed using pip:</p>
<pre>pip install muffin
</pre>
<a name="user-content-id5"/>

<p>See more in the example application sources. The application is deployed on Heroku:
<a href="https://muffin-py.herokuapp.com">https://muffin-py.herokuapp.com</a></p>
<p>Run example server locally:</p>
<pre>$ make -C example run
</pre>
<p>And open <a href="http://fuf.me:5000">http://fuf.me:5000</a> in your browser.</p>
<a name="user-content-configuration"/>

<p>Muffin gets configuration options from python files. You have to specify
default configuration module name in your app initialization:</p>
<div class="highlight highlight-source-python"><pre>app <span class="pl-k">=</span> muffin.Application(<span class="pl-s"><span class="pl-pds">'</span>myapp<span class="pl-pds">'</span></span>, <span class="pl-v">CONFIG</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>config.debug<span class="pl-pds">'</span></span>)</pre></div>
<p>This name could be overriden by <code>MUFFIN_CONFIG</code> environment variable:</p>
<pre>$ MUFFIN_CONFIG=settings_local muffin example run
</pre>
<p>Which in its turn could be overriden by <code>--config</code> param of <code>muffin</code> command:</p>
<pre>$ muffin --config=config.debug example run
</pre>
<p>Also you can define default config parameter values while initializing your application:</p>
<div class="highlight highlight-source-python"><pre>app <span class="pl-k">=</span> muffin.Application(<span class="pl-s"><span class="pl-pds">'</span>myapp<span class="pl-pds">'</span></span>, <span class="pl-v">DEBUG</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-v">ANY_OPTION</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Here<span class="pl-pds">'</span></span>, <span class="pl-v">ONE_MORE</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Yes<span class="pl-pds">'</span></span>)</pre></div>
<a name="user-content-base-application-options"/>

<p>Base Muffin options and default values:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># Configuration module</span>
<span class="pl-s"><span class="pl-pds">'</span>CONFIG<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>config<span class="pl-pds">'</span></span>

<span class="pl-c"># Enable debug mode</span>
<span class="pl-s"><span class="pl-pds">'</span>DEBUG<span class="pl-pds">'</span></span>: <span class="pl-c1">False</span>

<span class="pl-c"># Logging options</span>
<span class="pl-s"><span class="pl-pds">'</span>ACCESS_LOG<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>-<span class="pl-pds">'</span></span>,  <span class="pl-c"># File path to access log, - to stderr</span>
<span class="pl-s"><span class="pl-pds">'</span>ACCESS_LOG_FORMAT<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-c1">%a</span> %l <span class="pl-c1">%u</span> %t "<span class="pl-c1">%r</span>" <span class="pl-c1">%s</span> %b "%<span class="pl-c1">{Referrer}</span>i" "%{User-Agent}i"<span class="pl-pds">'</span></span>,

<span class="pl-s"><span class="pl-pds">'</span>LOG_LEVEL<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>WARNING<span class="pl-pds">'</span></span>
<span class="pl-s"><span class="pl-pds">'</span>LOG_FORMAT<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-c1">%(asctime)s</span> [<span class="pl-c1">%(process)d</span>] [<span class="pl-c1">%(levelname)s</span>] <span class="pl-c1">%(message)s</span><span class="pl-pds">'</span></span>
<span class="pl-s"><span class="pl-pds">'</span>LOG_DATE_FORMAT<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>[%Y-%m-<span class="pl-c1">%d</span> %H:%M:%S %z]<span class="pl-pds">'</span></span>

<span class="pl-c"># List of enabled plugins</span>
<span class="pl-s"><span class="pl-pds">'</span>PLUGINS<span class="pl-pds">'</span></span>: []

<span class="pl-c"># Setup static files in development</span>
<span class="pl-s"><span class="pl-pds">'</span>STATIC_PREFIX<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>/static<span class="pl-pds">'</span></span>
<span class="pl-s"><span class="pl-pds">'</span>STATIC_FOLDERS<span class="pl-pds">'</span></span>: [<span class="pl-s"><span class="pl-pds">'</span>static<span class="pl-pds">'</span></span>]</pre></div>
<a name="user-content-configuring-logging"/>

<p>You can define your logging configurations with <a href="https://docs.python.org/3.4/library/logging.config.html#configuration-dictionary-schema">Python dictConfig format</a> and place in <code>LOGGING</code> conf:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c1">LOGGING</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>version<span class="pl-pds">'</span></span>: <span class="pl-c1">1</span>,
    <span class="pl-s"><span class="pl-pds">'</span>disable_existing_loggers<span class="pl-pds">'</span></span>: <span class="pl-c1">False</span>,
    <span class="pl-s"><span class="pl-pds">'</span>formatters<span class="pl-pds">'</span></span>: {
        <span class="pl-s"><span class="pl-pds">'</span>default<span class="pl-pds">'</span></span>: {
            <span class="pl-s"><span class="pl-pds">'</span>format<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-c1">%(asctime)s</span> <span class="pl-c1">%(levelname)s</span> <span class="pl-c1">%(name)s</span> <span class="pl-c1">%(message)s</span><span class="pl-pds">'</span></span>
        },
    },
    <span class="pl-s"><span class="pl-pds">'</span>handlers<span class="pl-pds">'</span></span>: {
        <span class="pl-s"><span class="pl-pds">'</span>logfile<span class="pl-pds">'</span></span>: {
            <span class="pl-s"><span class="pl-pds">'</span>level<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>DEBUG<span class="pl-pds">'</span></span>,
            <span class="pl-s"><span class="pl-pds">'</span>class<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>logging.handlers.RotatingFileHandler<span class="pl-pds">'</span></span>,
            <span class="pl-s"><span class="pl-pds">'</span>filename<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>my_log.log<span class="pl-pds">'</span></span>,
            <span class="pl-s"><span class="pl-pds">'</span>maxBytes<span class="pl-pds">'</span></span>: <span class="pl-c1">50</span> <span class="pl-k">*</span> <span class="pl-c1">1024</span> <span class="pl-k">*</span> <span class="pl-c1">1024</span>,
            <span class="pl-s"><span class="pl-pds">'</span>backupCount<span class="pl-pds">'</span></span>: <span class="pl-c1">10</span>
        },
    },
    <span class="pl-s"><span class="pl-pds">'</span>loggers<span class="pl-pds">'</span></span>: {
        <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>: {
            <span class="pl-s"><span class="pl-pds">'</span>handlers<span class="pl-pds">'</span></span>: [<span class="pl-s"><span class="pl-pds">'</span>logfile<span class="pl-pds">'</span></span>],
            <span class="pl-s"><span class="pl-pds">'</span>level<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>ERROR<span class="pl-pds">'</span></span>
        },
        <span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>: {
            <span class="pl-s"><span class="pl-pds">'</span>level<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>INFO<span class="pl-pds">'</span></span>,
            <span class="pl-s"><span class="pl-pds">'</span>propagate<span class="pl-pds">'</span></span>: <span class="pl-c1">True</span>,
        },
    }
}</pre></div>
<p>To use just get logger with <code>logging.getLogger()</code>:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> logging
logger <span class="pl-k">=</span> logging.getLogger(<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>)</pre></div>
<a name="user-content-cli-integration"/>

<p>Run in your shell:</p>
<pre>$ muffin path.to.your.module:app_object_name --help
</pre>
<a name="user-content-write-a-custom-command"/>

<div class="highlight highlight-source-python"><pre><span class="pl-en">@app.manage.command</span>
<span class="pl-k">def</span> <span class="pl-en">hello</span>(<span class="pl-smi">name</span>, <span class="pl-smi">upper</span><span class="pl-k">=</span><span class="pl-c1">False</span>):
    <span class="pl-s"><span class="pl-pds">"""</span> Write command help text here.</span>
<span class="pl-s"/>
<span class="pl-s">    :param name:  Write your name</span>
<span class="pl-s">    :param upper: Use uppercase</span>
<span class="pl-s"/>
<span class="pl-s">    <span class="pl-pds">"""</span></span>
    greetings <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Hello <span class="pl-c1">%s</span>!<span class="pl-pds">'</span></span> <span class="pl-k">%</span> name
    <span class="pl-k">if</span> upper:
        greetings <span class="pl-k">=</span> greetings.upper()
    <span class="pl-c1">print</span>(greetings)</pre></div>
<pre>$ muffin example hello --help

    Write command help text here.

    positional arguments:
    name        Write your name

    optional arguments:
    -h, --help  show this help message and exit
    --upper     Enable use uppercase
    --no-upper  Disable use uppercase

$ muffin example hello mike --upper

    HELLO MIKE!
</pre>
<a name="user-content-id6"/>

<a name="user-content-setup-tests"/>

<p>Set module path to your Muffin Application in pytest configuration file or use
command line option <code>--muffin-app</code>.</p>
<p>Example:</p>
<pre>$ py.test -xs --muffin-app example
</pre>
<a name="user-content-testing-application"/>

<p>See examples:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> pytest

<span class="pl-en">@pytest.mark.</span><span class="pl-k">async</span>
<span class="pl-k">def</span> <span class="pl-en">test_async_code</span>():
    <span class="pl-k">from</span> aiohttp <span class="pl-k">import</span> request
    response <span class="pl-k">=</span> <span class="pl-k">yield from</span> request(<span class="pl-s"><span class="pl-pds">'</span>GET<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>)
    text <span class="pl-k">=</span> <span class="pl-k">yield from</span> response.text()
    <span class="pl-k">assert</span> <span class="pl-s"><span class="pl-pds">'</span>html<span class="pl-pds">'</span></span> <span class="pl-k">in</span> text

<span class="pl-k">def</span> <span class="pl-en">test_app</span>(<span class="pl-smi">app</span>):
    <span class="pl-s"><span class="pl-pds">"""</span> Get your app in your tests as fixture. <span class="pl-pds">"""</span></span>
    <span class="pl-k">assert</span> app.name <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span>my app name<span class="pl-pds">'</span></span>
    <span class="pl-k">assert</span> app.cfg.<span class="pl-c1">MYOPTION</span> <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span>develop<span class="pl-pds">'</span></span>

<span class="pl-k">def</span> <span class="pl-en">test_view</span>(<span class="pl-smi">client</span>):
    <span class="pl-s"><span class="pl-pds">"""</span> Make HTTP request to your application. <span class="pl-pds">"""</span></span>
    response <span class="pl-k">=</span> client.get(<span class="pl-s"><span class="pl-pds">'</span>/my-handler<span class="pl-pds">'</span></span>)
    <span class="pl-k">assert</span> <span class="pl-s"><span class="pl-pds">'</span>mydata<span class="pl-pds">'</span></span> <span class="pl-k">in</span> response.text</pre></div>
<a name="user-content-id7"/>

<p>Use <code>muffin</code> command. By example:</p>
<pre>$ muffin example run --workers=4
</pre>
<p>See <code>muffin {APP} run --help</code> for more info.</p>
<a name="user-content-bug-tracker"/>

<p>If you have any suggestions, bug reports or
annoyances please report them to the issue tracker
at <a href="https://github.com/klen/muffin/issues">https://github.com/klen/muffin/issues</a></p>
<a name="user-content-id8"/>

<p>Development of The Muffin happens at: <a href="https://github.com/klen/muffin">https://github.com/klen/muffin</a></p>
<a name="user-content-contributors"/>


<a name="user-content-id9"/>

<p>Licensed under a MIT license (See LICENSE)</p>
<p>If you wish to express your appreciation for the project, you are welcome to send
a postcard to:</p>
<pre>Kirill Klenov
pos. Severny 8-3
MO, Istra, 143500
Russia
</pre>

</article>
  </div></body></html>