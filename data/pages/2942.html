<html><body><div><div class="entry-content"><p>Проще всего создать динамические страницы на Python при помощи CGI-скриптов. CGI-скрипты - это исполняемые файлы, которые выполняются веб-сервером, когда в URL запрашивается соответствующий скрипт.</p><p>Сегодня я расскажу про то, как написать Hello world, как CGI-скрипт.</p><div class="section" id="id1"><h2>Настройка локального сервера</h2><p>В Python уже есть встроенный CGI сервер, поэтому его настройка элементарна.</p><p>Для запуска из консоли (для любителей linux-систем). Запускать нужно из той папки, где мы хотим работать:</p><pre class="code bash literal-block">
python3 -m http.server --cgi
</pre><p>Для сидящих на Windows чуть проще будет запуск Python файла (заметьте, что он <b>должен находиться в той же папке, в которой мы планируем работать!</b>):</p><pre class="code python3"><span class="kn">from</span> <span class="nn">http.server</span> <span class="k">import</span> <span class="n">HTTPServer</span><span class="p">,</span> <span class="n">CGIHTTPRequestHandler</span>
<span class="n">server_address</span> <span class="o">=</span> <span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
<span class="n">httpd</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">(</span><span class="n">server_address</span><span class="p">,</span> <span class="n">CGIHTTPRequestHandler</span><span class="p">)</span>
<span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span></pre><p>Теперь откройте браузер и в адресной строке наберите <b>localhost:8000</b></p><p>Если у вас примерно такая же картина, значит, у вас все заработало!</p><p><img alt="Локальный CGI-сервер" src="/uploads/python-cgi/create-cgi-server.png"/></p></div><div class="section" id="hello-world"><h2>Hello world</h2><p>Теперь в той папке, где мы запустили сервер, создаём папку cgi-bin (у меня она уже создана).</p><p>В этой папке создаём скрипт hello.py со следующим содержимым:</p><pre class="code python3"><span class="ch">#!/usr/bin/env python3</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Content-type: text/html"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"&lt;h1&gt;Hello world!&lt;/h1&gt;"</span><span class="p">)</span></pre><p>Первая строка говорит о том, что это Python скрипт (CGI-скрипты можно не только на Python писать).</p><p>Вторая строка печатает заголовок. Он обозначает, что это будет html файл (бывает ещё css, javascript, pdf и куча других, и браузер различает их по заголовкам).</p><p>Третья строка (просто символ новой строки) отделяет заголовки от тела ответа.</p><p>Четвёртая печатает Hello world.</p><p>Теперь переходим на localhost:8000/cgi-bin/hello.py</p><p>И радуемся!</p><p><img alt="Hello world CGI" src="/uploads/python-cgi/cgi-hello-world.png"/></p><p>Если у вас не работает, проверьте, установлены ли права на выполнение.</p><p>Также в консоли запущенного сервера появляются сообщения об ошибках. Например, убрал скобочку и обновил страницу:</p><p><img alt="CGI ошибки" src="/uploads/python-cgi/cgi-errors.png"/></p><p>В следующей части мы рассмотрим обработку данных форм и cookies.</p></div></div></div></body></html>