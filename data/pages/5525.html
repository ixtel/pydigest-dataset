<html><body><div><div class="content html_format"><p>
      Привет Хабр! Анализируя пользовательские данные для нужд маркетинга и рекламы, мы решили исследовать влияние типа личности пользователя на то, как он реагирует на рекламное объявление. За основу решили взять, пожалуй, самую популярную типологию линостей </p><a href="https://en.wikipedia.org/wiki/Myers–Briggs_Type_Indicator">MBTI</a><p> (Myers-Briggs Type Indicator), известную еще с середины 20-го века. Многие крупные западные компании используют тесты MBTI при найме или при формировании команды для работы над проектами. 
</p><p>
Но нас интересует, конечно, не готовность пользователя к командной работе, а влияние его типа личности на желание кликнуть по баннеру. Поэтому вопрос, который мы исследовали звучит так: «Могут ли типы личности влиять на </p><a href="https://en.wikipedia.org/wiki/Click-through_rate">CTR</a><p> в рекламных кампаниях?»
</p><p>
В этой статье я расскажу о том как мы это делали.

</p><a href="http://habrahabr.ru/company/dca/blog/263729/"><img src="https://habrastorage.org/files/d19/b9a/524/d19b9a524683464fbea6b481468db31c.jpg"/></a>
<a name="habracut"/>
<h2>Типология Майерс — Бригс</h2><p>
Типология Майерс-Бриггс включает в себя четыре характеристики.

</p><ol>
<li> <b>E—I — направленность жизненной энергии:</b><br/>
 Е (Еxtraversion, экстраверсия) — на внешний мир;<br/>
 I (Introversion, интроверсия) — на внутренний мир;<br/>
<br/>
</li>
<li><b>S—N — способ ориентирования в ситуации:</b><br/>
 S (Sensing, здравый смысл) — ориентирование на конкретную информацию;<br/>
 N (iNtuition, интуиция) — ориентирование на обобщённую информацию;<br/>
<br/>
</li>
<li><b>T—F — основа принятия решений:</b><br/>
 T (Thinking, мышление) — рациональное взвешивание альтернатив;<br/>
 F (Feeling, чувство) — принятие решений на эмоциональной основе;<br/>
<br/>
</li>
<li><b>J—P — способ подготовки решений:</b><br/>
 J (Judging, суждение) — предпочтение планировать и заранее упорядочивать информацию;<br/>
 P (Perception, восприятие) — предпочтение действовать без детальной предварительной подготовки, больше ориентируясь по обстоятельствам.<br/>
 </li>
</ol><p>
Сочетание характеристик, описанных выше, даёт обозначение одного из 16 типов, например: JTSE.
</p><img src="https://habrastorage.org/files/9f9/492/9b7/9f94929b76184f30960fa0bc30861dfc.jpg"/>
<h2>Определение типа личности</h2><p>
Чтобы определить тип личности пользователя мы построили четыре классификатора, по одному для каждой из характеристик.</p><p>
Для обучающей выборки мы использовали информацию одного из наших сайтов-партнеров, на этом сайте пользователь заполняет анкету, по которой определяется его тип личности. Объем выборки составляет около десяти тысяч пользователей.
</p><p>
Зависимая переменная в каждом из классификаторов — это классы характеристик. Например, для характеристики E-I: I — положительный класс (1), E — отрицательный класс (0). 
</p><p>
В качестве независимых переменных мы использовали историю поведения пользователя в Интернете (посещенные страницы) за период, предшествующий прохождению теста на сайте-партнере. Адрес каждой посещённой страницы представляется в виде токенов: слов длинной от трех до десяти символов. Например, адрес </p><a href="http://habrahabr.ru/company/dca/blog/260845/">habrahabr.ru/company/dca/blog/260845</a><p> преобразовывается в следующий набор токенов: ['http', 'habrahabr', 'company', 'dca', 'blog'].
</p><p>
После этого все данные случайно делятся на обучающую выборку (37.5%), выборку для feature engineering (37.5%) и тестовую выборку (25%).
</p><p>
Процесс feature engineering похож на тот, что мы используем для иерархической классификации сайтов, которая описана в нашей предыдущей </p><a href="http://habrahabr.ru/company/dca/blog/261677/">статье</a><p>, тем не менее, опишу его ниже.

</p><h2>Feature engineering</h2><p>
Для каждого токена в выборке для feature engineering мы вычисляем следующие характеристики

</p><ul>
<li>сколько раз встретился токен (total_number);</li>
<li>сколько раз встретился токен, при условии, что пользователь принадлежит положительному классу (true_number);</li>
<li>сколько раз встретился токен, при условии, что пользователь принадлежит отрицательному классу (false_number);</li>
</ul><p>
Далее считаем метрику </p><a href="http://habrahabr.ru/company/dca/blog/261677/">distributed grade</a><p> (dg) для каждого токена. Выбираем двадцать токенов с наибольшим значением этой метрики для каждого класса. В результате получаем сорок признаков. Значения признаков — условные вероятности принадлежности токена к классу: true_number к total_number и false_number к total_number. 

</p><h2>Характеристики полученных классификаторов</h2><p>
Для классификации мы использовали </p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html">Gradient Boosting Classifier</a><p> из библиотеки </p><a href="http://scikit-learn.org/stable/">scikit-learn</a><p>. Для оценки качества классификаторов мы анализировали площадь под </p><a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic">ROC</a><p> кривой. ROC кривая – это графическая характеристика качества бинарного классификатора. Кривая отражает зависимость TPR (true positive rate) от FPR (false positive rate).

</p><img src="https://habrastorage.org/files/265/773/296/2657732961774abcbca4dc1f4c44adff.png"/> <img src="https://habrastorage.org/files/ae7/4df/40d/ae74df40daa34b7c9bdf60bd36dbca49.png"/>

<i>где TP — true positive, FP — false positive, FN — false negative, TN — true negative.</i> 
<p>
Площадь под ROC кривой AUC (Area Under Curve) является характеристикой качества классификации: чем больше значение AUC, тем лучше модель классификации.
</p><p>
В процессе подбора параметров нам удалось увеличить эту метрику с 0.63 до 0.77, с помощью поиска по решётке для параметров n_estimators(количество деревьев) и max_depth(глубина деревьев). В таблице 1 приведены итоговые значения площади под ROC кривой для каждого из классификаторов. А на рисунке ниже построены сами ROC-кривые. 

</p><table>
<caption>Таблица 1: площади под ROC кривой классификаторов</caption>
<tr>
<td>E-I классификатор</td>
<td>0.763</td>
</tr>
<tr>
<td>S-N классификатор</td>
<td>0.793</td>
</tr>
<tr>
<td>T-F классификатор</td>
<td>0.768</td>
</tr>
<tr>
<td>J-P классификатор</td>
<td>0.768</td>
</tr>
</table>
<img src="https://habrastorage.org/files/9c2/392/98f/9c239298f5464a2b9d183c2075713976.png" alt="ROC кривые классификаторов"/>

<h2>Проверка на реальных данных</h2><p>
Ну вот мы и добрались до самого интересного. А именно до ответа на вопрос «Могут ли типы личности влиять на CTR в рекламных кампаниях?».
</p><p>
Чтобы это понять мы проанализировали данные одной из наших рекламных кампаний. При этом на аудиторию этой кампании не было наложено никаких ограничений. Всего в рамках этой кампании было сделано более 89-и миллионов показов. Для анализа мы использовали около 30 000 уникальных пользователей, которые кликнули по баннеру и 300 000 уникальных пользователей, которым хотя бы раз показывался баннер. 
</p><p>
Далее, мы оценили вероятность пользователя принадлежать к одному из классов для каждой характеристики нашей типологии. Затем, взяли 10% пользователей с наиболее высокими вероятностями и 10% с наиболее низкими вероятностями. В каждой из групп мы оценили CTR и построили для него 95% доверительные интервалы по </p><a href="http://www.ucl.ac.uk/english-usage/staff/sean/resources/binomialpoisson.pdf">формуле</a><p> Вильсона (wilson score interval)

</p><img src="https://habrastorage.org/files/334/298/835/3342988354cc4429872c8ec3aea27f79.png"/>

<i>где n — объём выборки,<img src="https://habrastorage.org/files/f4d/71d/d24/f4d71dd24dfe4162830d5781b05a13a4.png"/>, где k — количество кликов, <img src="https://habrastorage.org/files/2c7/8bd/4e5/2c78bd4e5c634c71b0aa616c26e85a70.png"/> — альфа-квантиль стандартного нормального распределения.</i>
<p>
Как видно из таблицы 2 для характеристик E-I и T-F различие в ctr составляет более 20% и является статистически значимым. В то время как для характеристик S-N и J-P различие в CTR статистически значимым не является. Таким образом, существуют рекламные кампании, в которых типы личности влияют на CTR.

</p><table>
<caption>Таблица 2: оценки CTR и доверительные интервалы</caption>
<tr>
<td>Extraversion<br/>
 Introversion<br/>
 </td>
<td>8.7<br/>
 11.4 <br/>
</td>
<td>(8.4, 9.0)<br/>
(11.1, 11.8)<br/>
</td>
</tr>
<tr>
<td>Sensing<br/>
Intuition </td>
<td>10.2<br/>
10.0</td>
<td>(9.9, 10.6)<br/>
(9.7, 10.4)</td>
</tr>
<tr>
<td>Thinking<br/>
Feeling </td>
<td>9.5<br/>
12.5 </td>
<td>(9.1, 9.8)<br/>
(12.1, 12.9)</td>
</tr>
<tr>
<td>Judging<br/>
Perception </td>
<td>10.0<br/>
10.7 </td>
<td>(9.6, 10.3)<br/>
(10.3, 11.1)</td>
</tr>
</table><p>
Стоит отметить, что это результат для конкретной рекламной кампании, который во многом определяется тем, что именно в рамках нее мы рекламировали, внешним видом баннеров и т. п. Возможно, на других кампаниях значимое различие в CTR было бы у других характеристик.

</p><h2>Что дальше</h2><p>
Различие CTR в разных классах на 20% вдохновляет нас на применение знаний про типы личности при проведении рекламных кампаний. В ближайшее время мы планируем сделать восемь cегментов пользователей, доступных для таргетирования рекламных кампаний — по два на каждую из характеристик. Кроме того, перед нами стоит задача научиться до старта рекламной кампании понимать, какому типу личности информация из нее будет наиболее интересна. 
</p><p>
Но это не единственное применение полученных нами сегментов. Информацию о типах личности можно использовать почти во всех сферах бизнеса.
</p><p>
Например, при проведении большой кампании по найму сотрудников (обычно это делают сети фастфуда, производственные предприятия и торговые сети) можно таргетировать рекламу на людей с определенными характеристиками. Таким образом уже на входе сужается воронка конверсии и заметно сэконмится бюджет. 
</p><p>
Из менее очевидного – зная психотип пользователей сайта, компания может адаптировать его внешний вид и контентное наполнение, чтобы лучше соответствовать ожиданиям и, как результат, повышать продажи. 
 </p><p>
По сути любой бизнес, работа которого строится на взаимодействии с большим количеством клиентов через digital-каналы, сможет найти применение этих знаний для оптимизации своих процессов и построения более персонифицированных коммуникаций. 

</p><h2>Полезные ссылки</h2> <p>
» </p><a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic">Здесь</a><p> информация для тех, кто хочет поближе познакомиться с ROC кривыми</p><p>
» </p><a href="http://www.ucl.ac.uk/english-usage/staff/sean/resources/binomialpoisson.pdf">Здесь</a><p> можно изучить подробности о доверительном интервале, который мы использовали (wilson score interval)</p><p>
» А </p><a href="https://en.wikipedia.org/wiki/Myers–Briggs_Type_Indicator">здесь</a><p> можно прочитать про типологию Майерс-Бриггс.

      
      </p><p class="clear"/>
    </div>

    
  </div></body></html>