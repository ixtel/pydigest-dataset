<html><body><div><div class="entry-content">
    <p>I took a break from the intense <a href="/django-design-patterns-and-best-practices-book-coming-soon/">book</a> schedule this weekend (don’t worry everything is on schedule). Was reading about Commodore’s <a href="http://www.slate.com/articles/technology/books/2012/11/computer_programming_10_print_chr_205_5_rnd_1_goto_10_from_mit_press_reviewed.html">one-liner maze</a> when it struck me.</p>
<p>I wondered - why not make some one-liner games in Python? And just to make it insanely hard, I would try to make it fit a tweet i.e. 140 characters. Let’s see what we could manage.</p>
<p><strong><span class="caps">NOTE</span>:</strong> All the one-liners below work only in Python 3. Depending on your platform, you might want to change the code by replacing <code>python</code> with <code>python3</code>.</p>
<h3 id="maze">Maze</h3>
<p><img src="/static/images/blog/game-maze.gif" alt="Game recording"/></p>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">"while 1:import random;print(random.choice('|| __'), end='')"</span>
</pre></div>


<p>Create an infinite maze with this deceptively short one-liner. It is quite easy to understand too. The <code>while</code> loop is infinite. The <code>import</code> statement had to move inside the loop but Python takes care not to re-import it each time.</p>
<p>A random character is picked from one of the maze drawing characters and printed. An alternate version below has better maze drawing characters. But this version used characters which were displayable on the Windows shell (and possibly portable to other operating systems).</p>
<h4 id="prettier-version">Prettier Version</h4>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">"while 1:import random;print(random.choice('╱╲'), end='')"</span>
</pre></div>


<p>This version uses two Unicode characters. The maze walls look more connected in this version and the viewing angle is interestingly skewed.</p>
<p>If you are more interested in the history and phenomenon of these one-liner mazes, then I suggest you check out the book <a href="http://10print.org/">10 <span class="caps">PRINT</span></a>, which can be freely downloaded.</p>
<h3 id="crash">Crash!</h3>
<p><img src="/static/images/blog/game-crash.gif" alt="Game recording"/></p>
<p>Crash is a homage to the <span class="caps">BASIC</span> era games like <a href="http://www.technologizer.com/2009/07/19/lunar-lander/">Lunar Lander</a>. Watch an out-of-control spaceship fall into earth. You need to freeze time (i.e. Ctrl+Break) just before it hits the cliff walls.</p>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">"while 1:locals().setdefault('i',60);import time,random;print(' '*i+'&lt;&gt;'+' '*(80-i-1)+'|');time.sleep(.1);i+=random.randint(-2,2)"</span>
</pre></div>


<p>Once again, we rely on <code>while</code> to create an infinite loop. Since the whole code is wrapped in a loop, we cannot initialise the spaceship position <code>i</code>. Unless, of course, we <code>setdefault</code> the <code>locals()</code> dictionary directly.</p>
<p>The <code>print</code> statement pads spaces <code>i</code> times to offset the ship’s symbolic representation. Then a slight delay is introduced for a convincing animation and the ship’s position is randomly shifted left or right. This put together gives the mesmerising effect of a swerving ship. </p>
<h3 id="slot-machine">Slot Machine</h3>
<p><img src="/static/images/blog/game-slotmachine.gif" alt="Game recording"/></p>
<p>Back when we were kids, we had a handheld toy slot machine with plastic rollers. We used to love spinning it until the three 7s aligned and everyone used to yell - Jackpot!</p>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">"import random;p=lambda:random.choice('7♪♫♣♠♦♥◄☼☽');[print('|'.join([p(),p(),p()]),end='</span><span class="se">\r</span><span class="s">') for i in range(8**5)]"</span>
</pre></div>


<p>This is one of the most fun games here. Essentially it needs three independent random number generators. Using a <code>lambda</code> function was the obvious choice for the generator so that you could invoke it thrice.</p>
<p>I used a variety of fun-looking Unicode characters that rendered correctly even on a Windows shell. Using the  <code>\r</code> (carriage return) terminator for <code>print</code> makes it overwrite the same line; giving the illusion of animation. Finally, <code>8**5</code> was chosen as a compact large number that completes looping in a reasonable time.</p>
<h4 id="slightly-longer-version">Slightly Longer Version</h4>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">"import random,time;p=lambda:random.choice('7♪♫♣♠♦♥◄☼☽');[print('[{}|{}|{}]'.format(p(),p(),p(),t=time.sleep(.1)),end='</span><span class="se">\r</span><span class="s">') for i in range(20)]"</span>
</pre></div>


<p>This version is slightly more satisfying since you can actually see the symbols as they change. The printed representation is also slightly better. However, these changes made it exceed the length of a tweet.</p>
<h3 id="100-feet-golf">100 Feet Golf</h3>
<p><img src="/static/images/blog/game-golf.gif" alt="Game recording"/></p>
<p>Inspired by <a href="http://en.wikipedia.org/wiki/Yetisports">Pingu Throw</a> (and possibly Angry Birds), this game allows you to choose the angle and velocity of a golf ball. The objective is to make it fall exactly in a hole at the hundredth feet, no more no less.</p>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">"import math as m;a,v=eval(input());[print('%03d'%x+' '*m.floor(0.5+x*m.tan(a)-x*x/(v*m.cos(a)))+'o') for x in range(102)]"</span>
</pre></div>


<p>Entering the two values is slightly clumsy due to the length restrictions. You need to input a tuple having two numbers like <code>(0.9,120)</code> - the first number is the angle in radians and the second number is the velocity (in some arbitrary unit). Due to the use of the infamous <code>eval</code> statement and subsequent tuple unpacking, input in any other form will not work.</p>
<p>The remaining list comprehension is basically a <code>for</code> loop with a <code>print</code> function. The ‘height’ of the golf ball is calculated by a simplified form of the actual <a href="http://en.wikipedia.org/wiki/Trajectory_of_a_projectile#Conditions_at_an_arbitrary_distance_x">physics formula</a> to compute projectile trajectories.</p>
<p>The range is chosen to be slightly more than, the expected, 100 to give an idea of the trajectory in case you overshoot.</p>
<h4 id="slightly-longer-version_1">Slightly Longer Version</h4>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">"import math as m;a,v=m.radians(float(input())),float(input());[print('{:03}:'.format(x)+' '*m.floor(0.5+x*m.tan(a)-x*x/(v*m.cos(a)))+'o') for x in range(102)]"</span>
</pre></div>


<p>This version has a more sane method of entering values. The first input is the angle in degrees (thank god!) and the next input is the velocity. However, it exceeds the length of a tweet.</p>
<h3 id="number-guess">Number Guess</h3>
<p><img src="/static/images/blog/game-guess.gif" alt="Game recording"/></p>
<p>This is a classic game for new programmers. Rules are easy to understand - I am thinking of a number between 1 and 99. You can make a guess and I will tell if your guess is higher (‘H’) or lower (‘L’) than my number. You can make up to six guesses.</p>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">"import random;n=random.randint(1,99);[(lambda a:print('Y' if a==n else 'H' if a&gt;n else 'L'))(int(input())) for i in range(6)]"</span>
</pre></div>


<p>Most of the techniques used here should look familiar - list comprehensions, lambdas and random integers. The lambda is needed since the input variable needs to be assigned (when the lamda gets called). The <code>if else</code> short form is used as a ternary operator.</p>
<p>Upon a successful guess the game prints a ‘Y’. However, it doesn’t stop which is a possible drawback of this implementation.</p>
<p>As you might know, the best strategy is a binary search. To make the game more interesting, I have chosen the maximum number of guesses to be one less than the ideal to span the range.</p>
<h2 id="how-to-write-one-liners-in-python">How to Write One-liners in Python?</h2>
<p>One-liners are notoriously hard to write in Python. You would be hard pressed to find examples of one-liners with the exception of the <a href="https://wiki.python.org/moin/Powerful%20Python%20One-Liners">Python wiki</a>.</p>
<p>What makes it so hard? Well, there are a couple of reasons:</p>
<ul>
<li><strong>Whitespace-significance</strong>: This makes is quite hard to include block statements like <code>while</code> or <code>for</code>. Often the entire program is wrapped in one loop statement.</li>
<li><strong>Verboseness</strong>: Unlike languages like Perl there are no short hand symbols say for commandline arguments or regular expressions</li>
</ul>
<p>But Python is not devoid of merit for creating one-liners. Thanks to some great functional programming features it does have some advantages like:</p>
<ul>
<li><strong>Lamdas</strong>: Defining functions in a line does come handy despite its limitations.</li>
<li><strong>List comprehensions</strong>: Readable yet terse constructs.</li>
<li><strong>Reflectiveness</strong>: Ability to edits its own local variables for instance is quite handy. </li>
</ul>
<p>Overall, I am quite surprised by the kinds of games I could manage. My daughter and I had lots of fun playing and tweaking some of these games. They are probably the most fun I could get from one line of code.</p>
  </div>

    </div></body></html>