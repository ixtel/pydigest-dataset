<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-eve-elastic" class="anchor" href="#eve-elastic" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Eve-Elastic</h1>
<a href="https://travis-ci.org/petrjasek/eve-elastic"><img alt="https://travis-ci.org/petrjasek/eve-elastic.png?branch=master" src="https://camo.githubusercontent.com/be09406615fe2eb3b3d510026cecb7fc2a3c5cc0/68747470733a2f2f7472617669732d63692e6f72672f706574726a6173656b2f6576652d656c61737469632e706e673f6272616e63683d6d6173746572" data-canonical-src="https://travis-ci.org/petrjasek/eve-elastic.png?branch=master"/></a>
<p>Eve-Elastic is <a href="http://www.elasticsearch.org">elasticsearch</a> data layer for <a href="http://python-eve.org">eve REST framework</a>.</p>
<a name="user-content-features"/>
<h2><a id="user-content-features" class="anchor" href="#features" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Features</h2>
<ul>
<li>fulltext search</li>
<li>filtering via elasticsearch filter dsl</li>
<li>facets support</li>
<li>aggragations support</li>
<li>elasticsearch mapping generator for schema</li>
</ul>
<a name="user-content-license"/>
<h2><a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>License</h2>
<p>Eve-Elastic is <a href="http://www.gnu.org/licenses/gpl-3.0.txt">GPLv3</a> licensed.</p>
<a name="user-content-install"/>
<h2><a id="user-content-install" class="anchor" href="#install" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Install</h2>
<div class="highlight highlight-source-shell"><pre>$ pip install Eve-Elastic</pre></div>
<a name="user-content-usage"/>
<h2><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h2>
<p>Set elastic as your eve data layer.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> eve
<span class="pl-k">from</span> eve_elastic <span class="pl-k">import</span> Elastic

app <span class="pl-k">=</span> eve.Eve(<span class="pl-v">data</span><span class="pl-k">=</span>Elastic)</pre></div>
<a name="user-content-config"/>
<h2><a id="user-content-config" class="anchor" href="#config" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Config</h2>
<p>There are 2 options for Eve-Elastic taken from <code>app.config</code>:</p>
<ul>
<li><code>ELASTICSEARCH_URL</code> (default: <code>'http://localhost:9200/'</code>)</li>
<li><code>ELASTICSEARCH_INDEX</code> - (default: <code>'eve'</code>)</li>
<li><code>ELASTICSEARCH_INDEXES</code> - (default: <code>{}</code>) - <code>resource</code> to <code>index</code> mapping</li>
<li><code>ELASTICSEARCH_FORCE_REFRESH</code> - (default: <code>False</code>) - force index refresh after every modification</li>
<li><code>ELASTICSEARCH_AUTO_AGGREGATIONS</code> - (default: <code>True</code>) - return aggregates on every search if configured for resource</li>
</ul>
<a name="user-content-query-params"/>
<h2><a id="user-content-query-params" class="anchor" href="#query-params" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Query params</h2>
<p>Eve-Elastic supports eve like queries via <code>where</code> param which work as <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-term-filter.html">term</a> filter.</p>
<p>On top of this, there is a predefined <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html">query_string</a> query which does fulltext search.</p>
<div class="highlight highlight-source-shell"><pre>$ curl http://localhost:5000/items<span class="pl-k">?</span>q=foo<span class="pl-k">&amp;</span>df=name</pre></div>
<ul>
<li><code>q</code> - query (default: <code>*</code>)</li>
<li><code>df</code> - default field (default: <code>_all</code>)</li>
</ul>
<a name="user-content-filtering"/>
<h2><a id="user-content-filtering" class="anchor" href="#filtering" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Filtering</h2>
<p>For more sophisticated filtering, you can use <code>filter</code> query param which will be used as filter for the query,
using elastic <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-filters.html">filter dsl</a>.</p>
<a name="user-content-facets"/>
<h2><a id="user-content-facets" class="anchor" href="#facets" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Facets</h2>
<p>To add a facets support for specific resource, add <code>facets</code> into its <code>datasource</code>:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c1">DOMAIN</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>contacts<span class="pl-pds">'</span></span>: {
        <span class="pl-s"><span class="pl-pds">'</span>datasource<span class="pl-pds">'</span></span>:
            <span class="pl-s"><span class="pl-pds">'</span>facets<span class="pl-pds">'</span></span>: {
                <span class="pl-s"><span class="pl-pds">'</span>urgency<span class="pl-pds">'</span></span>: {<span class="pl-s"><span class="pl-pds">'</span>terms<span class="pl-pds">'</span></span>: {<span class="pl-s"><span class="pl-pds">'</span>field<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>urgency<span class="pl-pds">'</span></span>}},
                <span class="pl-s"><span class="pl-pds">'</span>versioncreated<span class="pl-pds">'</span></span>: {<span class="pl-s"><span class="pl-pds">'</span>date_histogram<span class="pl-pds">'</span></span>: {<span class="pl-s"><span class="pl-pds">'</span>field<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>versioncreated<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>interval<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>hour<span class="pl-pds">'</span></span>}}
            }
        }
    }</pre></div>
<p>You will find more info about facets in <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-facets.html">elasticsearch docs</a>.</p>

</article>
  </div></body></html>