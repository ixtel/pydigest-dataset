<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-wp-file-analyser" class="anchor" href="#wp-file-analyser" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>wp-file-analyser</h1>

<p>Find modified, missing and extra files in a WordPress directory.</p>

<h1><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h1>

<div class="highlight highlight-source-shell"><pre>$ ./analyser.py -v wordpress/
                  ___ _ _                            _
                 / __<span class="pl-k">|</span>_) <span class="pl-k">|</span>                          <span class="pl-k">|</span> <span class="pl-k">|</span>
  _ _ _ ____    <span class="pl-k">|</span> <span class="pl-k">|</span>__ _<span class="pl-k">|</span> <span class="pl-k">|</span> ____     ____ ____   ____<span class="pl-k">|</span> <span class="pl-k">|</span>_   _  ___  ____  ____
 <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span>  _ <span class="pl-cce">\ </span>  <span class="pl-k">|</span>  __) <span class="pl-k">|</span> <span class="pl-k">|</span>/ _  )   / _  <span class="pl-k">|</span>  _ <span class="pl-cce">\ </span>/ _  <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span>/___)/ _  )/ ___)
 <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span>  <span class="pl-k">|</span> <span class="pl-k">|</span>  <span class="pl-k">|</span> <span class="pl-k">|</span> ( (/ /   ( ( <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> ( ( <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span>_<span class="pl-k">|</span> <span class="pl-k">|</span>___ ( (/ /<span class="pl-k">|</span> <span class="pl-k">|</span>
  <span class="pl-cce">\_</span>___<span class="pl-k">|</span> <span class="pl-k">||</span>_/   <span class="pl-k">|</span>_<span class="pl-k">|</span>  <span class="pl-k">|</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span><span class="pl-cce">\_</span>___)   <span class="pl-cce">\_</span><span class="pl-k">||</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span> <span class="pl-k">|</span>_<span class="pl-k">|</span><span class="pl-cce">\_</span><span class="pl-k">||</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span><span class="pl-cce">\_</span>_  (___/ <span class="pl-cce">\_</span>___)_<span class="pl-k">|</span>
       <span class="pl-k">|</span>_<span class="pl-k">|</span>                                            (____/

Setting up:
Downloading a new copy of WordPress
wordpress_4.4.2.zip [<span class="pl-k">==================================================</span>]
Getting plugins:
akismet.3.1.7.zip [<span class="pl-k">==================================================</span>]
wp-super-cache.1.4.7.zip [<span class="pl-k">==================================================</span>]
Getting themes:
twentyfourteen.1.6.zip [<span class="pl-k">==================================================</span>]
twentyfifteen.1.4.zip [<span class="pl-k">==================================================</span>]
twentysixteen.1.1.zip [<span class="pl-k">==================================================</span>]
billie.1.0.3.zip [<span class="pl-k">==================================================</span>]
Comparing wordpress/ with wpa-temp/wordpress/
Starting Analysis:
DIFF: (1)
wordpress/wp-content/themes/billie/content.php
EXTRA: (2)
wordpress/wp-content/plugins/wp-super-cache/malware.php
wordpress/bad.php
MISSING: (1)
wpa-temp/wordpress/wp-load.php
PHP FILES IN <span class="pl-s"><span class="pl-pds">'</span>WP-CONTENT/UPLOADS<span class="pl-pds">'</span></span>: (1)
wordpress/wp-content/uploads/shouldnotbehere.php</pre></div>

<h1><a id="user-content-about" class="anchor" href="#about" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>About</h1>

<p>When fixing hacked Wordpress sites I needed a way of quickly comparing the core and plugin files against their wordpress.org originals. This python script automates the process of downloading the same copy of WordPress and plugins into a new directory and then comparing the two.</p>

<hr/>

<h2><a id="user-content-important-note" class="anchor" href="#important-note" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Important Note</h2>

<p>This script copies functionality from several WordPress security plugins such as <a href="https://www.wordfence.com/">https://www.wordfence.com/</a>. It is not designed to replace these plugins and for most WordPress admins, using one of these plugins is your best bet for fixing your hacked site. 
This script is useful for when you do not want, or it is not possible, to execute PHP. For example:</p>

<ul>
<li>Finding malware in a site that has been taken offline (when a site starts sending spam, hosting companies usually disable PHP execution to stop it).</li>
<li>Checking for malware in an offline backup copy of a site. </li>
</ul>

<hr/>

<p>The script will create a temporary directory called ‘wpa-temp’. It will then download a new copy of the same version of WordPress into that directory, along with any plugins and themes that are hosted on wordpress.org. The two directories are then compared and the following displayed:</p>

<ul>
<li>DIFF - files that are in both, but have been modified in the original.<br/></li>
<li>EXTRA - files that are in the old copy, but not in the new.<br/></li>
<li>MISSING - files that are in the new copy, but not in the old.<br/></li>
<li>PHP IN UPLOADS - and .php files that are in the wp-content/uploads directory.<br/></li>
</ul>

<p>If using this script to repair a WordPress site please note the following: </p>

<ul>
<li>Do not delete all files reported as EXTRA, Some plugins during installation add files outside of their plugin directory which will be picked up. wp-config.php will also be listed. </li>
<li>Be aware that a developer may have (against best practice) modified core and plugin files. Review them before overwriting with the originals.</li>
<li>If comparing against a backup copy of the site, theme and plugin files will be compared with the backup versions. If not:

<ul>
<li>Currently, only wordpress.org hosted themes/plugins will be analysed. Ensure premium theme/plugins from other sources are reviewed manually before declaring the site is free of malware. </li>
<li>To analyse premium themes and plugins that cannot be auto downloaded. Run the tool to create the wpa-temp directory, then manually copy new versions of these required files into the wpa-temp directory. Finally re-run the tool, passing the wpa-temp directory as the second path argument.<br/></li>
</ul></li>
</ul>

<h1><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h1>

<p>Download analyser.py to your required directory (directory above your WordPress install makes sense). Make executable with:</p>



<h1><a id="user-content-requirements" class="anchor" href="#requirements" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Requirements</h1>



<h1><a id="user-content-command-line-options" class="anchor" href="#command-line-options" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Command line options</h1>

<p>Show help</p>



<p>Verbose mode - shows info messages and download progress bars </p>

<div class="highlight highlight-source-shell"><pre>./analyser.py -v wordpress-path/</pre></div>

<p>Compare against another existing WordPress directory </p>

<div class="highlight highlight-source-shell"><pre>./analyser.py -v wordpress-path/ other-wordpress-path/</pre></div>

<p>Compare against an certain version, e.g. WordPress 4.4</p>

<div class="highlight highlight-source-shell"><pre>./analyser.py -v -w 4.4 wordpress-path/</pre></div>

<p>Delete temporary files. During analysis a directory called wpa-temp is created that holds the new copies of files, delete this after running. </p>

<div class="highlight highlight-source-shell"><pre>./analyser.py -t wordpress-path/</pre></div>

<h1><a id="user-content-tests" class="anchor" href="#tests" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Tests</h1>

<p>Requires nose, run the following from the top level of the project directory</p>



<h1><a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>License</h1>

<p>Licensed under <a href="https://github.com/VirenMohindra/wp-file-analyser/blob/master/LICENSE">GPLv3</a></p>
</article>
  </div></body></html>