<html><body><div><article>
  <header>
  
  <time data-url="/archives/2014/09/08/pythonrc/" datetime="2014-08-09 00:00:00-0500" pubdate="">Monday, September  8, 2014</time>
</header>



  <p>I’ve been using and working with Python in a professional context for around 8 years. So it came sort of a shock that something so useful, so obvious, was unfamiliar to me until around a week and a half ago.</p>

<p>It involves a little file called <code class="highlighter-rouge">.pythonrc</code> that lives in your home directory. To get it to work, you’ll need to define an environment variable called <code class="highlighter-rouge">PYTHONSTARTUP</code>, like so:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">PYTHONSTARTUP</span><span class="o">=</span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.pythonrc"</span></code></pre></figure>

<p>(Major hat tip to <a href="https://www.reddit.com/user/kasnalin">kasnalin</a> on Reddit for <a href="https://www.reddit.com/r/Python/comments/2fun6t/how_to_supercharge_your_python_shell_with_a/ckd1w4t">pointing out</a> that I’d forgotten to include this important piece of info in an earlier version of the post.)</p>

<p>If you’re a Python developer, no doubt you open up a Python shell countless times per day. Whether you use the regular Python shell, or another one such as IPython, it’s all the same. Open up the shell, import a few useful modules, and start playing around.</p>

<p>Maybe you find yourself importing the same modules over and over again. Maybe you leave a single shell open all the time since it’s such a pain to re-type those commands.</p>

<p>I spend a lot of time working with Django, so I’d gotten pretty used to typing <code class="highlighter-rouge">./manage.py shell</code> and then <code class="highlighter-rouge">from app import models</code> to start playing around with objects in my database.</p>

<p>Well, I got to wondering what this <code class="highlighter-rouge">.pythonrc</code> could do to help me out with this, so I dumped in the following code:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">models</span>
    <span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Could not import Django modules."</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Imported Django modules."</span><span class="p">)</span></code></pre></figure>

<p>Not expecting this to work at all, I ran my trusty Django shell, and voilà:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="err">$</span> <span class="o">./</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">shell</span>

<span class="n">Imported</span> <span class="n">Django</span> <span class="n">modules</span><span class="o">.</span>
<span class="n">Python</span> <span class="mf">2.7</span><span class="o">.</span><span class="mi">6</span> <span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">Jan</span>  <span class="mi">6</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="mi">56</span><span class="p">)</span>
<span class="p">[</span><span class="n">GCC</span> <span class="mf">4.2</span><span class="o">.</span><span class="mi">1</span> <span class="n">Compatible</span> <span class="n">Apple</span> <span class="n">LLVM</span> <span class="mf">5.0</span> <span class="p">(</span><span class="n">clang</span><span class="o">-</span><span class="mf">500.2</span><span class="o">.</span><span class="mi">79</span><span class="p">)]</span> <span class="n">on</span> <span class="n">darwin</span>
<span class="n">Type</span> <span class="s">"help"</span><span class="p">,</span> <span class="s">"copyright"</span><span class="p">,</span> <span class="s">"credits"</span> <span class="ow">or</span> <span class="s">"license"</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="p">(</span><span class="n">InteractiveConsole</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span></code></pre></figure>

<p>It’s like magic. No more reverse searching my shell history to import commonly-used modules. If I find myself using one often enough, I just add it into my <code class="highlighter-rouge">.pythonrc</code> and it’s there for me every time.</p>

<p>I play around Redis a bunch, so here’s another chunk of code I plopped in there.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">redis</span> <span class="kn">import</span> <span class="n">StrictRedis</span> <span class="k">as</span> <span class="n">Redis</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">Redis</span><span class="p">()</span></code></pre></figure>

<p>Now, I can just open up the shell and use <code class="highlighter-rouge">r</code> to play with Redis.</p>

<p>Here’s another one I’m pretty fond of. I’m a big fan of tab-completion and readline support. So I put this in my <code class="highlighter-rouge">.pythonrc</code> too:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">readline</span>
<span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Module readline not available."</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">rlcompleter</span>
    <span class="k">if</span> <span class="s">'libedit'</span> <span class="ow">in</span> <span class="n">readline</span><span class="o">.</span><span class="n">__doc__</span><span class="p">:</span>
        <span class="n">readline</span><span class="o">.</span><span class="n">parse_and_bind</span><span class="p">(</span><span class="s">"bind ^I rl_complete"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">readline</span><span class="o">.</span><span class="n">parse_and_bind</span><span class="p">(</span><span class="s">"tab: complete"</span><span class="p">)</span></code></pre></figure>

<p>Works like a charm.</p>

<p>Below is my full <code class="highlighter-rouge">.pythonrc</code>, in all of its glory (also available as a <a href="https://gist.github.com/dlo/e0b48890495a6c4b3065">Gist</a>).</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></td><td class="code"><pre><span class="c"># vim: set ft=python :</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">redis</span> <span class="kn">import</span> <span class="n">StrictRedis</span> <span class="k">as</span> <span class="n">Redis</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">Redis</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">readline</span>
<span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Module readline not available."</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">rlcompleter</span>
    <span class="k">if</span> <span class="s">'libedit'</span> <span class="ow">in</span> <span class="n">readline</span><span class="o">.</span><span class="n">__doc__</span><span class="p">:</span>
        <span class="n">readline</span><span class="o">.</span><span class="n">parse_and_bind</span><span class="p">(</span><span class="s">"bind ^I rl_complete"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">readline</span><span class="o">.</span><span class="n">parse_and_bind</span><span class="p">(</span><span class="s">"tab: complete"</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">models</span>
    <span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Could not import Django modules."</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Imported Django modules."</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span> <span class="k">as</span> <span class="n">parse_date</span>
<span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Could not import dateutil."</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>


</article>


        </div></body></html>