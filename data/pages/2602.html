<html><body><div><div class="text-content">
 

<p>Writing today’s article was a fascinating experience for me and would also be for the readers of this blog. What’s so different? Two things: firstly the article is about something I always wanted to do since I was a 5-year old; secondly this topic / tools / algorithm are new to me as well. I am no way a master of image processing, but the utility of this field simply blew my mind.</p>
<p><a href="http://i2.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/image-process.jpg"><img class=" size-full wp-image-18865 aligncenter" src="http://i2.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/image-process.jpg?resize=500%2C350" alt="image processing in python" srcset="http://i2.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/image-process.jpg?resize=300%2C210 300w, http://i2.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/image-process.jpg?w=500 500w" sizes="(max-width: 500px) 100vw, 500px" data-recalc-dims="1"/></a></p>
<p>Imagine, if you can create an application of auto-tagging a photograph as that of Facebook, or create your own face recognition password to your laptop. In this article, I will pick up a very simple but interesting application of Image processing. We will use Python to do the image processing.  In next few articles, I will take over more complex examples of Image Processing. Here is the problem I will be working on in this article:</p>
<h3/>
<h3><strong>Problem Statement</strong></h3>
<p>Guess what is this image?</p>
<p><a href="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/wint_sky.gif"><img class="alignnone size-full wp-image-11774 aligncenter" src="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/wint_sky.gif?resize=581%2C480" alt="wint_sky" data-recalc-dims="1"/></a></p>
<p>You are right, it’s a typical picture of an open sky. I took this picture last to last night in Bangalore from my terrace. At that point of time, I had no clue that this can be such an exciting and rewarding exercise. As a kid, I used to spend hours counting these stars but almost always failed to go beyond 50-60. I wanted to complete this exercise using some help from my machine. I had no clue that this was even possible till last Sunday, and today I have completed this long pending task using Python.</p>
<h3><strong>Let’s get started</strong></h3>
<p><strong>Step 1: Import the required library</strong></p>
<p>Skimage package enables us to do image processing using Python. The language is extremely simple to understand but does some of the most complicated tasks. Here are a few library you need to import to get started,</p>
<p><a href="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/code11.png"><img class=" size-full wp-image-11784 aligncenter" src="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/code11.png?resize=467%2C133" alt="code1" srcset="http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/code11.png?resize=300%2C85 300w, http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/code11.png?w=467 467w" sizes="(max-width: 467px) 100vw, 467px" data-recalc-dims="1"/></a></p>
<p> </p>
<p><strong>Step 2 : Import the image</strong></p>
<p>Once we have all the libraries in place, we need to import our image file to python. Following is the code you can use to import the image file. Note that the image is imported in grey scale, which basically means that each pixel is a shade of grey. And each pixel essentially becomes one cell in a matrix. In this case the image is matrix of 480*581 cells (or image of 480*581 pixels).</p>
<p><a href="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/code21.png"><img class="alignnone size-full wp-image-11785 aligncenter" src="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/code21.png?resize=637%2C336" alt="code2" srcset="http://i2.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/code21.png?resize=300%2C158 300w, http://i2.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/code21.png?w=637 637w" sizes="(max-width: 637px) 100vw, 637px" data-recalc-dims="1"/></a></p>
<p><strong>Step 3 : Find the number of Stars</strong></p>
<p>Now comes the critical part where our major labor is done by a few commands. These few command go out for searching continuous objects in the picture. Blobs_log gives three outputs for each object found. First two are the coordinates and the third one is the area of the object. The radius of each blob/object can be estimated using this column (area of the object).</p>
<p><a href="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/code31.png"><img class="alignnone size-full wp-image-11786 aligncenter" src="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/code31.png?resize=547%2C122" alt="code3" srcset="http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/code31.png?resize=300%2C67 300w, http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/code31.png?w=547 547w" sizes="(max-width: 547px) 100vw, 547px" data-recalc-dims="1"/></a></p>
<p>As we can see that the algorithm has estimated 308 visible stars. Let’s now look at how accurate are these readings.</p>
<p> </p>
<p><strong>Step 4 : Validated whether we captured all the stars</strong></p>
<p>The number 308 is still coming out of a black box. Let’s look at whether we have spotted all the stars correctly. For this I am circling each estimated star position. And the look at the image if we are missing any star.</p>
<p><a href="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/code41.png"><img class="alignnone size-full wp-image-11787 aligncenter" src="http://i0.wp.com/www.analyticsvidhya.com/blog/wp-content/uploads/2014/12/code41.png?resize=581%2C377" alt="code4" srcset="http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/code41.png?resize=300%2C195 300w, http://i1.wp.com/www.analyticsvidhya.com/wp-content/uploads/2014/12/code41.png?w=581 581w" sizes="(max-width: 581px) 100vw, 581px" data-recalc-dims="1"/></a></p>
<p>Here is the complete code :</p>
<div id="stb-container-4668" class="stb-container-css stb-grey-container stb-image-none stb-ltr stb-corners stb-side-none"><aside class="stb-icon"><img src="http://i2.wp.com/www.analyticsvidhya.com/blog/wp-content/plugins/wp-special-textboxes/images/gears-b.png" data-recalc-dims="1"/></aside><div id="stb-box-4668" class="stb-grey_box stb-box">
<pre>from matplotlib import pyplot as plt
from skimage import data
from skimage.feature import blob_dog, blob_log, blob_doh
from math import sqrt
from skimage.color import rgb2gray
import glob
from skimage.io import imread</pre>
<pre>example_file = glob.glob(r"C:UsersTavishDesktopwint_sky.gif")[0]
im = imread(example_file, as_grey=True)
plt.imshow(im, cmap=cm.gray)
plt.show()</pre>
<pre>blobs_log = blob_log(im, max_sigma=30, num_sigma=10, threshold=.1)
# Compute radii in the 3rd column.
blobs_log[:, 2] = blobs_log[:, 2] * sqrt(2)
numrows = len(blobs_log)
print("Number of stars counted : " ,numrows)</pre>
<pre>fig, ax = plt.subplots(1, 1)
plt.imshow(im, cmap=cm.gray)
for blob in blobs_log:
    y, x, r = blob
    c = plt.Circle((x, y), r+5, color='lime', linewidth=2, fill=False)
    ax.add_patch(c)

</pre></div></div>
<h3><strong>End Notes</strong></h3>
<p>Image Processing is fascinating! I started my journey with Python Image Processing not more than 5 days. For the benefit of the community, I will encourage any suggestions or best practices to be shared on this forum. This exercise might not have any practical application but similar analysis can be done for purity estimations. For instance, in glass industry we need the number of silica particles in the glass at a microscopic level. By capturing the frames in a video, you can use this simple code to do a lot of things. For example, estimation of traffic through CCTV footage. This code can easily be tailored to achieve the same.</p>
<p>Did you find the article useful? If you have done similar pieces of work on Python Image processing, please share them with us. Do let us know your thoughts about this article in the box below.</p>

<p/>
<p id="jp-relatedposts" class="jp-relatedposts">
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</p>
</div>
</div></body></html>