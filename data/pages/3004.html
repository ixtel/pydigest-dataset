<html><body><div><div class="entry-content">
        
      <h1 class="post-title entry-title">Python for Android Tutorial #6 – Saving and reading user data</h1>
      <h3 id="welcome">Welcome!</h3>

<p>This is the sixth post about mobile development with Python.</p>

<p>In this  post, we’ll see how to save and read user data with Kivy. It’s compatible with Desktop, Android and iOS.</p>

<figure class="center ">
  <a href="/images/python-mobile.png"><img src="/images/python-mobile.png" alt=""/></a>
  <figcaption>Python Mobile course</figcaption>
</figure>




<p><ins class="adsbygoogle" data-ad-client="ca-pub-7559770887681599" data-ad-slot="6312284669" data-ad-format="auto"/>
</p>

<h2 id="i---about-the-tutorials">I - About the Tutorials</h2>

<p>I’ll show you how to use each mobile API, like compass, camera, sensors, sound, and others. After the API, we will start to test some Python libs, as PyGame and OpenCV.
I’m using Android with buildozer, but major part are compatible with iOS as well.</p>

<p>Must read:</p>



<h3 id="source-code">Source code</h3>



<h2 id="ii---index">II - Index</h2>

<p>Available tutorials:</p>



<h2 id="iii---about-this-tutorial">III - About this tutorial</h2>

<p>It’s a shot tutorial, I’ll show you how to save user data with Kivy.</p>

<p>We’ll be using <a href="http://kivy.org/docs/api-kivy.storage.html#module-kivy.storage">Kivy Storage</a>, you can save user settings, score, or anything else inside files, so Python and Kivy will easily manage these files for you.</p>

<p>It’s explaining more about the game created at <a href="/2015/01/24/python-for-android-tutorial-5-our-first-mobile-game-with-kivy/">Tutorial #5 - Android and iOS game with Python</a></p>

<p>When I wrote this post, I was using Kivy 1.9.0, and this API was experimental, and the API was subject to change in a future version. So, if you are using a new version of Kivy and something is not working fine, just let me know.</p>

<h2 id="iv---about-kivy-storage">IV - About Kivy Storage</h2>

<p>We can save user information in these ways:</p>



<p>You can use any of these storage in the same way.</p>

<p>To create a <strong>DictSore</strong>, use:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">kivy.storage.dictstore</span> <span class="kn">import</span> <span class="n">DictStore</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>

<span class="n">data_dir</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">'user_data_dir'</span><span class="p">)</span> <span class="c">#get a writable path to save the file</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">DictStore</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">'user.dat'</span><span class="p">))</span></code></pre></figure>

<p>To create a JsonStore, use:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">kivy.storage.jsonstore</span> <span class="kn">import</span> <span class="n">JsonStore</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>

<span class="n">data_dir</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">'user_data_dir'</span><span class="p">)</span> <span class="c">#get a writable path to save the file</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">JsonStore</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">'user.json'</span><span class="p">))</span></code></pre></figure>

<p>Or, to connect to a Redis database, use:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">kivy.storage.redisstore</span> <span class="kn">import</span> <span class="n">RedisStore</span>

<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'localhost'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">RedisStore</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code></pre></figure>

<p>After creating the <strong>store</strong> object, any storage will have the same methods.</p>

<h2 id="v---saving-data">V - Saving data</h2>

<p>To save the user score, you can use:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s">'score'</span><span class="p">,</span> <span class="n">best</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span></code></pre></figure>

<p>This code will create the key <strong>score</strong> and set the <strong>best</strong> as <strong>50</strong>. You can change the key <strong>score</strong> to any name, and the content <strong>best</strong> to any name.</p>

<p>If using a JsonStore, you’ll have the following file:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span><span class="s1">'score'</span><span class="err">:</span> <span class="p">{</span><span class="s1">'best'</span><span class="err">:</span> <span class="mi">50</span><span class="p">}}</span></code></pre></figure>

<h2 id="vi---getting-user-data">VI - Getting user data</h2>

<p>Before get some data, we need to check if the user has this information saved:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">if</span> <span class="n">store</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s">'score'</span><span class="p">):</span>
	<span class="n">best</span> <span class="o">=</span>  <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'score'</span><span class="p">)[</span><span class="s">'best'</span><span class="p">]</span></code></pre></figure>

<p>You can read the <a href="http://kivy.org/docs/api-kivy.storage.html#module-kivy.storage">full doc and check all methods available</a>.</p>

<p>That’s it. Thanks for reading!</p>

<p>Aron Bordin</p>


<center>
  <ins class="adsbygoogle" data-ad-client="ca-pub-7559770887681599" data-ad-slot="1350374663">
  </ins>
</center>



      <footer class="entry-meta">
        <span class="entry-tags"><a href="/tags#Android" title="Pages tagged Android" class="tag"><span class="term">Android</span></a><a href="/tags#ios" title="Pages tagged ios" class="tag"><span class="term">ios</span></a><a href="/tags#python" title="Pages tagged python" class="tag"><span class="term">python</span></a><a href="/tags#Tutorial" title="Pages tagged Tutorial" class="tag"><span class="term">Tutorial</span></a></span>
        
        <span class="author vcard"><span class="fn">Aron Bordin</span></span>
        

      </footer>
    </div>
    </div></body></html>