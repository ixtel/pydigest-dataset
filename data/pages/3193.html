<html><body><div><div class="content html_format"><p>
      Доброго времени суток, хабражители!</p>

<img src="https://habrastorage.org/getpro/habr/post_images/208/d6d/e7e/208d6de7ef8762b926d4907b655f6ff2.png"/>
<p>
Думаю, многих из вас когда-либо посещала мысль «вот бы сохранить статьи с Хабра». Такая же мысль посетила и меня </p><a href="http://habrahabr.ru/post/208802/">чуть больше года назад</a><p>. 
</p><p>
Представляю вам новую версию программы закачки статей с Хабра, Гиктаймс и Мегамозг в формате PDF.
</p><p>
Новый проект называется </p><a href="https://github.com/icoz/habraparse">HabraParse</a><p>.
</p><p>
Проект состоит из библиотечки, которая парсит сайты, и скрипта, использующего лишь часть возможностей этой библиотеки. Скрипт написан на python3, для его работы потребуются модули </p><strong>docopt</strong><p>, </p><strong>requests</strong><p> и </p><strong>weasyprint</strong><p> (все их легко можно установить командой </p><strong>pip install <em>name</em></strong><p>).
</p><p>
На текущий момент в скрипте имеются следующие возможности:
</p><ul>
<li>скачать статью по её ID;</li>
<li>скачать список URL избранного для заданного пользователя;</li>
<li>скачать статьи из избранного в папку в формате PDF или HTML (пока реализация HTML не на высоте, поэтому по умолчанию используется формат PDF, но он работает значительно дольше).</li>
</ul>
<p>
Использование опций </p><strong>--gt</strong><p>/</p><strong>--mm</strong><p> позволяет сохранять статьи с </p><a href="http://geektimes.ru/">GeekTimes.ru</a><p> и </p><a href="http://megamozg.ru/">Megamozg.ru</a><p>.

</p><div class="spoiler"><b class="spoiler_title">Краткое описание параметров скрипта</b><div class="spoiler_text"><p>Usage:</p>
<pre><code class="bash">  ./habraparse.py save_favs_list [--gt|--mm] &lt;username&gt; &lt;out_file&gt;
  ./habraparse.py save_favs [--gt|--mm] [-cn --save-html --limit=N] &lt;username&gt; &lt;out_dir&gt;
  ./habraparse.py save_post [--gt|--mm] [-c --save-html] &lt;topic_id&gt; &lt;out_file&gt;
</code></pre><p>
По умолчанию все команды работают с проектом HabraHabr.ru.</p><p>
При задании опций </p><strong>--gt</strong><p>/</p><strong>--mm</strong><p> скрипт будет работать с GeekTimes.ru/Megamozg.ru.
</p><p>
Команды:
</p><pre><code class="bash">  save_favs_list - сохранение в файл &lt;out_file&gt; списка URL избранного для пользователя &lt;username&gt;
  save_favs - сохранение в папку &lt;out_dir&gt; статей из избранного для пользователя &lt;username&gt;
  save_post - сохранение в файл &lt;out_file&gt; статьи с заданным ID
</code></pre>
</div></div>
<p>
Пользуйтесь и наслаждайтесь. В случае выявления ошибок прошу кидать сообщения в личку или заводить баг на </p><a href="https://github.com/icoz/habraparse/issues">github-страничке проекта</a><p>.</p><p>
Если кому-то чего-то не хватает, то пишите фич-реквест в комментах, по мере сил постараюсь реализовать.

</p><a name="habracut"/>

<h4>Технические подробности</h4><p>
На самом деле Habraparse это, в первую очередь, библиотека для работы с информацией на сайтах Habrahabr.ru, GeekTimes.ru, MegaMozg.ru, позволяющая:
</p><ul>
<li>получить информацию о профиле пользователя по его имени;</li>
<li>получить из профиля пользователя: статьи, которые он написал и которые он добавил в свое «Избранное»;</li>
<li>получить статью по номеру ID с её разбором.</li>
</ul><p>
Название для библиотеки было выбрано крайне оригинальное — </p><b><i>habr</i></b><p>.
</p><p>
Информация о пользователе представлена в классах </p><strong>HabraUser</strong><p>, </p><strong>GeektimesUser</strong><p>, </p><strong>MegamozgUser</strong><p> модуля </p><b><em>habr.user</em></b><p> и включает в себя:
</p><ul>
<li>полное имя и никнейм;</li>
<li>дата регистрации;</li>
<li>дата рождения;</li>
<li>данные по карме (сама карма, количество голосов);</li>
<li>рейтинг и место в рейтинге;</li>
<li>страна, регион, город;</li>
<li>количество фолловеров;</li>
<li>количество постов;</li>
<li>количество комментов;</li>
<li>подписки на хабы, компании.</li>
</ul>
<p>
Информация о статьях представлена в классах </p><strong>HabraTopic</strong><p>, </p><strong>MegamozgTopic</strong><p>, </p><strong>GeektimesTopic</strong><p> модуля </p><b><em>habr.topic</em></b><p> и включает в себя:
</p><ul>
<li>id статьи;</li>
<li>заголовок;</li>
<li>имя автора;</li>
<li>рейтинг;</li>
<li>текст статьи (текст статьи не преобразован, все ссылки на картинки и прочее не тронуты);</li>
<li>комментарии: их количество и list с текстом комментариев;</li>
<li>перечень хабов, в которых находится статья.</li>
</ul>
<p>
Скрипт же использует библиотеку </p><b><i>habr</i></b><p> для парсинга и библиотеку </p><b><i>weasyprint</i></b><p> для генерации pdf. Weasyprint был выбран как самый простой по интерфейсу работы, и как единственный из попробованных, который смог сгенерировать нормальный PDF-файл. Однако, как оказалось, данная библиотека работает весьма медленно.</p><p>
Если вы знаете другие библиотеки генерации pdf, которые работают лучше — пишите в комменты или в личку. Однако сразу скажу, что разработка изначально велась под python3, поэтому не надо мне рассказывать про прекрасные pdf-библиотеки для python2.
</p><p>
На сим всё. Если кому понравилось, то пользуйтесь на здоровье! Если кто готов на базе этой библиотеки сделать свой скрипт с картами и женщинами, то всё в ваших руках!

</p><b>UPD.</b><p> По просьбам трудящихся обновил образ контейнера для докера </p><i>icoz/habraparse</i><p>. Порядок использования читайте </p><a href="https://registry.hub.docker.com/u/icoz/habraparse/">здесь</a><p>.

      	</p><div class="polling">
		

	

    <p class="for_users_only_msg">Только зарегистрированные пользователи могут участвовать в опросе. <a href="https://habrahabr.ru/auth/login/">Войдите</a>, пожалуйста.</p>
	</div>

      <p class="clear"/>
    </div>

    
  </div></body></html>