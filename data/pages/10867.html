<html><body><div><p class="lead" itemprop="description">Вслед за torrt рассылать телеграммы научилось и django-sitemessage.</p>
                <div class="py_user"><p>Напомню, что в начале этой недели поддержка рассылки телеграмм </p><a href="http://pythonz.net/articles/47/">появилась в приложении torrt</a><p>, сегодня же вышла очередная версия </p><a href="https://pypi.python.org/pypi/django-sitemessage">django-sitemessage</a><p> — приложения для Django, представляющего собой каркас для рассылки разного типа сообщений различными способами (эл. почта, Jabber, Twitter и пр.)</p><p>Отсылка телеграмм потребует установленного пакета </p><a href="https://pypi.python.org/pypi/requests">requests</a><p>. В остальном она ничем не отличается от рассылки прочих типов сообщений — выполняются два основных шага: 1. конфигурируется посыльный (Messenger) нужного типа (обычно нужные посыльные конфигурируются в файле </p><code>sitemessages.py</code><p> одного из приложений вашего проекта); 2. сообщение ставиться в очередь отправки (это может происходить, например, по сигналу при возникновении какого-либо события):</p><pre><code class="python"><br/>    from sitemessage.shortcuts import schedule_telegram_message<br/>    from sitemessage.messengers.telegram import TelegramMessenger<br/><br/>    # Конфигурируем посыльного Telegram. <br/>    # `bot_token` - это токен, полученный при создании телеграм-бота.<br/>    register_messenger_objects(TelegramMessenger('bot_token'))<br/><br/>    # Ставим сообщение в очередь. <br/>    # Оно будет отослано в переписку (чат) с ID 01234567.<br/>    schedule_telegram_message('Бот приветствует вас.', '01234567')<br/></code></pre><p>Если у вас получилось создать своего бота, то, скорее всего, получится и узнать нужный ID переписки, но чтобы упростить эту задачу ещё, можно воспользоваться методом посыльного </p><i>get_chat_ids()</i><p>, возвращающим список идентификаторов переписок с пользователями, которые отослали боту команду </p><code>/start</code><p>.</p><p>Отослать сообщение можно и в канал, если использовать вместо ID переписки нотацию </p><code>@channelname</code><p>, однако для этого бот должен состоять в списке администраторов канала. Ввиду того, что каналы появились относительно недавно, с отсылкой вполне могут возникать различного рода проблемы.</p><p>Помимо описанного выше, в версии </p><b>0.7.0</b><p> появилась функция-упрощение </p><i>schedule_tweet()</i><p> для быстрого отправления твитов; исправлена ошибка в работе функции </p><i>get_user_preferences_for_ui()</i><p>, генерирующей данные для виджета, при помощи которого пользователи могут подписываться на сообщения нужного типа самостоятельно; для фильтрации доступности в упомянутом ранее виджете для классов сообщений и посыльных добавлена возможность указания атрибута </p><code>allow_user_subscription</code><p>.</p><i>Оповещайте.</i></div>

                

                

                </div></body></html>