<html><body><div><div itemprop="articleBody"><p>In case you've been feeling adventurous like me and installed Windows 8 you probably also installed Hyper-V cause well, it's free and it has way better integration with Windows. Yes, you can make your VM start when Windows starts with VMware too - but Hyper-V remembers if you had it running before shutdown. And shutdown works unlike VMware which does poweroff in case you did not reinstall vmware-tools after kernel upgrade (at least with Ubuntu). Could I have gotten something wrong? Don't think so ... cause it works properly on Hyper-V.</p><p>Well anyway, the Network and Sharing Center in Windows 8 is quite weird ... could not change the network type (to private) for one virtual Hyper-V adapter even tho I've enabled all user control with <a class="reference external" href="http://www.wincert.net/tips/microsoft-windows/windows-8/3342-how-to-change-network-location-type-in-windows-8">gpedit.msc</a>. To fix it I had to use the Network List Manager API's <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa370790%28v=vs.85%29.aspx">SetCategory</a> it seems. There was <a class="reference external" href="http://blogs.technet.com/b/samdrey/archive/2011/10/19/how-to-use-powershell-to-change-the-network-location-type-to-private-or-public.aspx">this</a> PowerShell script that seem to do that but, damn it, I don't want to edit the script every time I have the problem. And that PowerShell thing looks awful compared to Python ...</p><p>Here's a python script that does the right thing: asks the user what network should be made private.</p><div class="highlight"><pre><span/><span class="kn">import</span> <span class="nn">win32com.client</span>
<span class="n">NETWORK_CATEGORIES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s2">"PRIVATE"</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s2">"PUBLIC"</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s2">"DOMAIN"</span>
<span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">win32com</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s2">"{DCB00C01-570F-4A9B-8D69-199FDBA5723B}"</span><span class="p">)</span>
<span class="n">more</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">connections</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">GetNetworkConnections</span><span class="p">()</span>

<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
    <span class="n">connection</span><span class="p">,</span> <span class="n">more</span> <span class="o">=</span> <span class="n">connections</span><span class="o">.</span><span class="n">Next</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">connection</span><span class="p">:</span>
        <span class="n">network</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">GetNetwork</span><span class="p">()</span>
        <span class="n">category</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">GetCategory</span><span class="p">()</span>
        <span class="k">print</span> <span class="s1">'</span><span class="si">%s</span><span class="s1">. "</span><span class="si">%s</span><span class="s1">" is </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">network</span><span class="o">.</span><span class="n">GetName</span><span class="p">(),</span> <span class="n">NETWORK_CATEGORIES</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">category</span> <span class="ow">and</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s2">"Make private [N]"</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'y'</span><span class="p">,</span> <span class="s1">'Y'</span><span class="p">]:</span>
            <span class="n">network</span><span class="o">.</span><span class="n">SetCategory</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div><p>Now isn't this pretty? (except the shitty iterator-wanna-be api in <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa370706%28v=vs.85%29.aspx">GetNetworkConnections</a> ...)</p></div></div></body></html>