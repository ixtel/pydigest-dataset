<html><body><div><div class="clearfix"><p><img src="/images/blog/flask-stopwatch.png" alt="Flask Auth in One Line of Code" title="Flask Auth in One Line of Code" class="center-block"/></p>

<p>Ever since I wrote about the <a href="https://stormpath.com/blog/part-one-flask-authentication-problem/">authentication problem</a> in the Flask ecosystem
a few months back, I’ve been working hard to build a simple abstraction to
solve these issues.</p>

<p>When I launched the first version of <a href="http://flask-stormpath.readthedocs.org/en/latest/">Flask-Stormpath</a>, I got a <em>ton</em> of
incredibly great feedback from the community, and learned a lot — namely,
people don’t want to worry about user authentication <em>at all</em>.</p>




<h2>The Problem (a Recap) + A v.1 Solution</h2>

<p>The “<a href="https://stormpath.com/blog/part-one-flask-authentication-problem/">authentication problem</a>” in the Flask ecosystem is this: since Flask has no
built-in ORM or tooling — almost every Flask developer ends up rolling their
own form of user authentication.  There are currently no libraries which solve
<em>all</em> of the authentication problems. So, I built a first release of a <a href="http://flask-stormpath.readthedocs.org/en/latest/">Flask + Stormpath</a> integration, which solved some big authentication problems in Flask:</p>

<ul>
<li>Centralized (secure) user store.</li>
<li>No need to worry about hashing passwords or JOIN’ing database tables — that bit was handled automatically.</li>
<li>Easy to use user accounts.</li>
<li>Secure sessions.</li>
</ul>


<p>After launch, I got a ton of excellent user feedback (<em>thanks everyone!</em>). After talking with lots of people, using the library myself, and writing a
Flask beginner <a href="https://stormpath.com/blog/build-a-flask-app-in-30-minutes/">tutorial</a>, I realized that the first version of <a href="http://flask-stormpath.readthedocs.org/en/latest/">Flask-Stormpath</a> was not really as good as I initially thought.</p>

<h2>Learning and Planning</h2>

<p>I realized that by even explaining how to do things like create registration, login, and logout views was a total waste of time — <em>why should
developers have to do this stuff themselves?</em></p>

<p>So, I decided to revamp the initial Flask-Stormpath design and simplify all developer-facing code, such that:</p>

<ul>
<li>Users could get registration, login, and logout working without writing any view code at all.</li>
<li>Users could control basic authentication features through app config variables (this way things are still flexible).</li>
<li>Users should be able to support social login with both Google and Facebook without doing any additional work.</li>
</ul>


<h2>Introducing the <em>New</em> Flask-Stormpath</h2>

<p>I’m incredibly excited to announce the newest release of <a href="http://flask-stormpath.readthedocs.org/en/latest/">Flask-Stormpath</a> —
it contains a huge number of improvements over the first release, and makes
handling user authentication in Flask apps incredibly simple.</p>

<p>In simple cases, registration, login, and logout are only a single line of code!  <strong>No database required!</strong></p>

<p>Here’s how this looks in practice:</p>

<pre><code>from os import environ

from flask.ext.stormpath import StormpathManager

# ...
app.config['STORMPATH_API_KEY_ID'] = environ.get('STORMPATH_API_KEY_ID')
app.config['STORMPATH_API_KEY_SECRET'] = environ.get('STORMPATH_API_KEY_SECRET')
app.config['STORMPATH_APPLICATION'] = environ.get('STORMPATH_APPLICATION')

# This is where the magic happens.
StormpathManager(app)
</code></pre>

<p>As you can see, we’re defining some settings, and initializing a
<code>StormpathManager</code>.  What does this get you?</p>

<p>Firstly, you get a fully functional registration page out-of-the-box:</p>

<p><img src="/images/blog/new-flask-registration-page.png" alt="New Flask Registration Page" title="New Flask Registration Page" class="center-block"/></p>

<p>You also get a beautiful login page out-of-the-box (note the Google and Facebook buttons):</p>

<p><img src="/images/blog/new-flask-login-page.png" alt="New Flask Login Page" title="New Flask Login Page" class="center-block"/></p>

<p>And lastly, you get logout functionality (if a user visits <code>/logout</code> they’ll be
logged out and redirected back to the site root).</p>

<p>There are currently three built-in views (along with templates and URL routes):</p>

<ul>
<li>A registration view / template / route (<em>bound to <code>/register</code> by default</em>).</li>
<li>A login view / template / route (<em>bound to <code>/login</code> by default</em>).</li>
<li>A logout view / route (<em>bound to <code>/logout</code> by default</em>).</li>
</ul>


<p>To make things even nicer, each of these views is 100% customizable — and
dynamically configure themselves based on your Flask settings.</p>

<p>Let’s take a deeper look!</p>

<h2>Authentication Customization</h2>

<p>Let’s say you’d like to modify the registration fields you accept when signing
up new users.  Flask-Stormpath supports several user fields for registration:</p>

<ul>
<li><code>email</code> (required)</li>
<li><code>password</code> (required)</li>
<li><code>given_name</code> (first name)</li>
<li><code>surname</code> (last name)</li>
<li><code>middle_name</code></li>
<li><code>username</code></li>
</ul>


<p>So, let’s say you want to remove the first, middle, and last name fields from
the registration page — you could simply set the following configuration
variables:</p>

<pre><code># ...
app.config['STORMPATH_ENABLE_GIVEN_NAME'] = False
app.config['STORMPATH_ENABLE_MIDDLE_NAME'] = False
app.config['STORMPATH_ENABLE_SURNAME'] = False
</code></pre>

<p>And just like that, those fields will disappear:</p>

<p><img src="/images/blog/new-flask-registration-page-no-names.png" alt="New Flask Login Page (no names)" title="New Flask Login Page (no names)" class="center-block"/></p>

<p>Want to include an optional <code>username</code> field?  Simple!  Just add the following
config:</p>

<pre><code># ...
app.config['STORMPATH_ENABLE_USERNAME'] = True
app.config['STORMPATH_REQUIRE_USERNAME'] = False
</code></pre>

<p>Each of the available fields can be both ‘ENABLED’ and ‘REQUIRED’ to your
liking.  This makes building dynamic registration / login pages incredibly easy.</p>

<p><strong>But wait!  There’s more!</strong></p>

<p>You can also easily change the default routes around:</p>

<pre><code># ...
app.config['STORMPATH_REGISTRATION_URL'] = '/user/register'
app.config['STORMPATH_LOGIN_URL'] = '/user/login'
app.config['STORMPATH_LOGOUT_URL'] = '/user/logout'
</code></pre>

<p>And changing templates is equally easy:</p>

<pre><code># ...
app.config['STORMPATH_REGISTRATION_TEMPLATE'] = 'register.html'
app.config['STORMPATH_LOGIN_TEMPLATE'] = 'login.html'
</code></pre>

<p><strong>NOTE</strong>: The official <a href="http://flask-stormpath.readthedocs.org/en/latest/quickstart.html#customize-the-templates">template documentation</a> has all the information you
could ever need / want on how to build you own registration / login templates
(<em>it’s super easy!</em>).</p>

<p>Furthermore, handling social login is incredibly simple.  You can easily enable
or disable social login support for both Facebook and Google by modifying
configuration variables alone:</p>

<pre><code># ...
app.config['STORMPATH_ENABLE_FACEBOOK'] = True
app.config['STORMPATH_ENABLE_GOOGLE'] = True
app.config['STORMPATH_SOCIAL'] = {
    'FACEBOOK': {
        'app_id': 'xxx',
        'app_secret': 'xxx',
        'scopes': ['user_likes'],
    },
    'GOOGLE': {
        'client_id': 'xxx',
        'client_secret': 'xxx',
        'scopes': ['profile'],
    },
}
</code></pre>

<p>Full examples for adding social login to your site can be found <a href="http://flask-stormpath.readthedocs.org/en/latest/quickstart.html#use-facebook-login">here</a>
(including in-depth instructions for creating Facebook / Google apps).</p>

<p>And if you’re not interested in any of the automatic stuff that’s built in, you
can disable it all with only three config variables:</p>

<pre><code># ...
app.config['STORMPATH_ENABLE_REGISTRATION'] = False
app.config['STORMPATH_ENABLE_LOGIN'] = False
app.config['STORMPATH_ENABLE_LOGOUT'] = False
</code></pre>

<p>Not bad, right?</p>

<h2>New Design</h2>

<p>The new <a href="http://flask-stormpath.readthedocs.org/en/latest/">Flask-Stormpath</a> design is based around abstraction: the main idea is
to make authentication as simple and painless as humanly possible.  If you’re
building a Flask app, you no longer have to worry about storing / securing user
data at all — it’s completely handled, scaled, and secured.</p>

<p>From this point forward, I’ll be slowly adding more convenience features to the
<a href="http://flask-stormpath.readthedocs.org/en/latest/">Flask-Stormpath</a> integration to handle other things as well:</p>

<ul>
<li>Email verification for new users.</li>
<li>API key authentication (<em>an awesome new feature for securing REST APIs</em>).</li>
<li>Password reset.</li>
<li>Distributed caching support (redis, memcache, etc.).</li>
</ul>


<p>I’m extremely excited about the new <a href="http://flask-stormpath.readthedocs.org/en/latest/">Flask-Stormpath</a>, and hope you are too!</p>

<p>If you end up giving it a try, I’d love to <a href="mailto:randall@stormpath.com">hear your feedback</a>.</p>

<p>Furthermore, if you aren’t already a Stormpath user — you should go
<a href="https://api.stormpath.com/register">create an account</a> right now!  <strong>It’s free for up to 100,000 API requests
per month!</strong>  That means most small to medium sized projects can use Stormpath
for zero cost, ever.</p>

<p>And as always, I’d love to hear from you!  Please hit me up (I’m
<a href="mailto:randall@stormpath.com">randall@stormpath.com</a>).</p>
</div>



            </div></body></html>