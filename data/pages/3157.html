<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-python-atomicwrites" class="anchor" href="#python-atomicwrites" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>python-atomicwrites</h1>
<a href="https://travis-ci.org/untitaker/python-atomicwrites"><img alt="https://travis-ci.org/untitaker/python-atomicwrites.svg?branch=master" src="https://camo.githubusercontent.com/69e328c84a9d3ca3988f509ebf2b5393d4e1d3dc/68747470733a2f2f7472617669732d63692e6f72672f756e746974616b65722f707974686f6e2d61746f6d69637772697465732e7376673f6272616e63683d6d6173746572" data-canonical-src="https://travis-ci.org/untitaker/python-atomicwrites.svg?branch=master"/></a>
<a href="https://ci.appveyor.com/project/untitaker/python-atomicwrites/branch/master"><img alt="https://ci.appveyor.com/api/projects/status/vadc4le3c27to59x/branch/master?svg=true" src="https://camo.githubusercontent.com/10c4fe38a7e01fdccefc21a09f342b41df9aac29/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f76616463346c6533633237746f3539782f6272616e63682f6d61737465723f7376673d74727565" data-canonical-src="https://ci.appveyor.com/api/projects/status/vadc4le3c27to59x/branch/master?svg=true"/></a>
<p>Atomic file writes.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> atomicwrites <span class="pl-k">import</span> atomic_write

<span class="pl-k">with</span> atomic_write(<span class="pl-s"><span class="pl-pds">'</span>foo.txt<span class="pl-pds">'</span></span>, <span class="pl-v">overwrite</span><span class="pl-k">=</span><span class="pl-c1">True</span>) <span class="pl-k">as</span> f:
    f.write(<span class="pl-s"><span class="pl-pds">'</span>Hello world.<span class="pl-pds">'</span></span>)
    <span class="pl-c"># "foo.txt" doesn't exist yet.</span>

<span class="pl-c"># Now it does.</span></pre></div>
<p>Features that distinguish it from other similar libraries (see <a href="#alternatives-and-credit">Alternatives and Credit</a>):</p>
<ul>
<li>Race-free assertion that the target file doesn't yet exist. This can be
controlled with the <code>overwrite</code> parameter.</li>
<li>Windows support, although not well-tested. The MSDN resources are not very
explicit about which operations are atomic.</li>
<li>Simple high-level API that wraps a very flexible class-based API.</li>
<li>Consistent error handling across platforms.</li>
</ul>
<a name="user-content-how-it-works"/>
<h2><a id="user-content-how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How it works</h2>
<p>It uses a temporary file in the same directory as the given path. This ensures
that the temporary file resides on the same filesystem.</p>
<p>The temporary file will then be atomically moved to the target location: On
POSIX, it will use <code>rename</code> if files should be overwritten, otherwise a
combination of <code>link</code> and <code>unlink</code>. On Windows, it uses <code>MoveFileEx</code> (see
<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365240%28v=vs.85%29.aspx">MSDN</a>) through stdlib's <code>ctypes</code> with the appropriate flags.</p>
<p>Note that with <code>link</code> and <code>unlink</code>, there's a timewindow where the file
might be available under two entries in the filesystem: The name of the
temporary file, and the name of the target file.</p>
<a name="user-content-alternatives-and-credit"/>
<h2><a id="user-content-alternatives-and-credit" class="anchor" href="#alternatives-and-credit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Alternatives and Credit</h2>
<p>Atomicwrites is directly inspired by the following libraries (and shares a
minimal amount of code):</p>

<p>Other alternatives to atomicwrites include:</p>
<ul>
<li><a href="https://github.com/sashka/atomicfile">sashka/atomicfile</a>. Originally I
considered using that, but at the time it was lacking a lot of features I
needed (Windows support, overwrite-parameter, overriding behavior through
subclassing).</li>
<li>The <a href="https://github.com/mahmoud/boltons">Boltons library collection</a>
features a class for atomic file writes, which seems to have a very similar
<code>overwrite</code> parameter. It is lacking Windows support though.</li>
</ul>
<a name="user-content-license"/>
<h2><a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>License</h2>
<p>Licensed under the MIT, see <code>LICENSE</code>.</p>

</article>
  </div></body></html>