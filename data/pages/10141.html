<html><body><div><div class="post-text" itemprop="text">
<p>Firstly, try to use (i) namespaces and (ii) unequivocal variable names, e.g.:</p>

<pre><code>&gt;&gt;&gt; from nltk import PCFG
&gt;&gt;&gt; from nltk.parse import ViterbiParser
&gt;&gt;&gt; import urllib.request
&gt;&gt;&gt; response = urllib.request.urlopen('https://raw.githubusercontent.com/salmanahmad/6.863/master/Labs/Assignment5/Code/wsjp.cfg')
&gt;&gt;&gt; wsjp = response.read().decode('utf8')
&gt;&gt;&gt; grammar = PCFG.fromstring(wsjp)
&gt;&gt;&gt; parser = ViterbiParser(grammar)
&gt;&gt;&gt; list(parser.parse('turn off the lights'.split()))
[ProbabilisticTree('S', [ProbabilisticTree('VP', [ProbabilisticTree('VB', ['turn']) (p=0.002082678), ProbabilisticTree('PRT', [ProbabilisticTree('RP', ['off']) (p=0.1089101771)]) (p=0.10768769667270556), ProbabilisticTree('NP', [ProbabilisticTree('DT', ['the']) (p=0.7396712852), ProbabilisticTree('NNS', ['lights']) (p=4.61672e-05)]) (p=4.4236397464693323e-07)]) (p=1.0999324002161311e-13)]) (p=2.5385077255727538e-14)]
</code></pre>

<p>If we look at the grammar:</p>

<pre><code>&gt;&gt;&gt; grammar.check_coverage('please turn off the lights'.split())
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/usr/local/lib/python3.4/dist-packages/nltk/grammar.py", line 631, in check_coverage
    "input words: %r." % missing)
ValueError: Grammar does not cover some of the input words: "'please'".
</code></pre>

<p><strong>To resolve the unknown word issues, there're several options</strong>:</p>

<ul>
<li><p><strong>Use <code>wildcard</code> non-terminals nodes to replace the unknown words</strong>. Find some way to replace the words that the grammar don't cover from <code>check_coverage()</code> with the <code>wildcard</code>, then parse the sentence with the wildcard </p>

<ul>
<li>this will usually decrease the parser's accuracy unless you have specifically train the PCFG with a grammar that handles unknown words and the wildcard is a superset of the unknown words.</li>
</ul></li>
<li><p>Go back to your grammar production file that you have before creating the learning the PCFG with <a href="https://github.com/salmanahmad/6.863/blob/master/Labs/Assignment5/Code/learn_pcfg.py"><code>learn_pcfg.py</code></a> and <strong>add all possible words in the terminal productions</strong>.</p></li>
<li><p><strong>Add the unknown words into your pcfg grammar and then renormalize the weights</strong>, given either very small weights to the unknown words (you can also try smarter smoothing/interpolation techniques)</p></li>
</ul>

<p>Since this is a homework question I will not give the answer with the full code. But the hints above should be enough to resolve the problem.</p>
    </div>
    </div></body></html>