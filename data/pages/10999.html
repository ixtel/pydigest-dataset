<html><body><div><div class="post-text" itemprop="text">

<p>I am having an issue trying to select a return date due to the fact that it cannot find the element of <code>current_date = calendar.find_element_by_class_name("ui-datepicker-days-cell-over")</code>. For the depart date it works but not return date. This is because when you open up the datepicker for return date, it automatically has a date highlighted for you (this is the element), but for return date it doesn't have a date highlighted when its datepicker is opened (only after you select a date).</p>

<p>So my question is does anybody know how to fix the code below so that it is able to retrieve the date selected from  the depart datepicker (the date selected is the next_available_date) and somehow store it in the return date picker so that it becomes a selected date in the return datepicker?</p>

<p>At the moment the code below is able to retrieve the next available date from the depart datepicker no problem, the issue is just the return datepicker. (Both blocks of code are pretty much mirrored as each other)</p>

<pre><code># select depart date
datepicker = driver.find_element_by_id("ctl00_centralDynamicContent_OutDateTextBox")
actions.move_to_element(datepicker).click().perform()

# find the calendar, month and year picker and the current date
calendar = driver.find_element_by_id("ui-datepicker-div")
month_picker = Select(calendar.find_element_by_class_name("ui-datepicker-month"))
year_picker = Select(calendar.find_element_by_class_name("ui-datepicker-year"))
current_date = calendar.find_element_by_class_name("ui-datepicker-days-cell-over")

# printing out current date
month = month_picker.first_selected_option.text
year = year_picker.first_selected_option.text
print("Current departure date: {day} {month} {year}".format(day=current_date.text, month=month, year=year))

# see if we have an available date in this month
try:
    next_available_date = current_date.find_element_by_xpath("following::td[@title='Click to see flights on this date' and ancestor::div/@id='ui-datepicker-div']")
    print("Found an available departure date: {day} {month} {year}".format(day=next_available_date.text, month=month, year=year))
    next_available_date.click()
except NoSuchElementException:
# looping over until the next available date found
        while True:
# click next, if not found, select the next year
            try:
                calendar.find_element_by_class_name("ui-datepicker-next").click()
            except NoSuchElementException:
# select next year
                year = Select(calendar.find_element_by_class_name("ui-datepicker-year"))
                year.select_by_visible_text(str(int(year.first_selected_option.text) + 1))

# reporting current processed month and year
                month = Select(calendar.find_element_by_class_name("ui-datepicker-month")).first_selected_option.text
                year = Select(calendar.find_element_by_class_name("ui-datepicker-year")).first_selected_option.text
                print("Processing {month} {year}".format(month=month, year=year))

            try:
                next_available_date = calendar.find_element_by_xpath(".//td[@title='Click to see flights on this date']")
                print("Found an available departure date: {day} {month} {year}".format(day=next_available_date.text, month=month, year=year))
                next_available_date.click()
                break
            except NoSuchElementException:
                continue



# select return date
datepicker = driver.find_element_by_id("ctl00_centralDynamicContent_InDateTextBox")
actions.move_to_element(datepicker).click().perform()

# find the calendar, month and year picker and the current date
calendar = driver.find_element_by_id("ui-datepicker-div")
month_picker = Select(calendar.find_element_by_class_name("ui-datepicker-month"))
year_picker = Select(calendar.find_element_by_class_name("ui-datepicker-year"))
current_date = calendar.find_element_by_class_name("ui-datepicker-days-cell-over")

# printing out current date
month = month_picker.first_selected_option.text
year = year_picker.first_selected_option.text
print("Current return date: {day} {month} {year}".format(day=current_date.text, month=month, year=year))

# see if we have an available date in this month
try:
    next_available_date = current_date.find_element_by_xpath("following::td[@title='Click to see flights on this date' and ancestor::div/@id='ui-datepicker-div']")
    print("Found an available return date: {day} {month} {year}".format(day=next_available_date.text, month=month, year=year))
    next_available_date.click()
except NoSuchElementException:
# looping over until the next available date found
        while True:
# click next, if not found, select the next year
            try:
                calendar.find_element_by_class_name("ui-datepicker-next").click()
            except NoSuchElementException:
# select next year
                year = Select(calendar.find_element_by_class_name("ui-datepicker-year"))
                year.select_by_visible_text(str(int(year.first_selected_option.text) + 1))

# reporting current processed month and year
                month = Select(calendar.find_element_by_class_name("ui-datepicker-month")).first_selected_option.text
                year = Select(calendar.find_element_by_class_name("ui-datepicker-year")).first_selected_option.text
                print("Processing {month} {year}".format(month=month, year=year))

            try:
                next_available_date = calendar.find_element_by_xpath(".//td[@title='Click to see flights on this date']")
                print("Found an available return date: {day} {month} {year}".format(day=next_available_date.text, month=month, year=year))
                next_available_date.click()
                break
            except NoSuchElementException:
                continue
</code></pre>

<p>Update:</p>

<p>Below is the plugin (the first page where the calendar is displayed):</p>

<p><a href="http://i.stack.imgur.com/MeoIT.png" rel="nofollow"><img src="http://i.stack.imgur.com/MeoIT.png" alt="enter image description here"/></a></p>

<p>Below is the textbox html for depart date:</p>

<pre><code>&lt;input type="text" autocomplete="off" class="dpTextBox datepickerOut calendar_field hasDatepicker" id="ctl00_centralDynamicContent_OutDateTextBox" readonly="readonly" name="ctl00$centralDynamicContent$OutDateTextBox"&gt;
</code></pre>

<p>For return date text box it's same id except <code>InDateTextBox</code> at end</p>

<p>Below is screenshot html of what return datepicker looks like when it's open (exactly like the picture displayed above and that's how mine looks at moment before script stops):</p>

<p><a href="http://i.stack.imgur.com/vBSt1.png" rel="nofollow"><img src="http://i.stack.imgur.com/vBSt1.png" alt="enter image description here"/></a></p>
    </div>
    </div></body></html>