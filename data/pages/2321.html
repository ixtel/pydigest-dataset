<html><body><div><section class="entry">
<p class="fsb-clear"/><p><strong><em>This is a guest post by Michael Herman from <a href="http://www.realpython.com" target="_blank">Real Python</a> – learn Python programming and web development through hands-on, interesting examples that are useful and fun!</em></strong></p>
<p>In this tutorial, we’ll take the command line image search engine from the <a href="http://www.pyimagesearch.com/2014/12/01/complete-guide-building-image-search-engine-python-opencv/" target="_blank">previous tutorial</a> and turn it into a full-blown web application using Python and Flask. More specifically, we’ll be creating a <a href="http://en.wikipedia.org/wiki/Single-page_application" target="_blank">Single Page Application</a> (SPA) that consumes data via AJAX (on the front-end) from an internal, REST-like API via Python/Flask (on the back-end).</p>
<p>The end product will look like this:</p>
<p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration.jpg"><img class="aligncenter wp-image-1656" src="http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration.jpg" alt="7_sixth-iteration" srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration-300x168.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration-1024x575.jpg 1024w, http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration.jpg 1049w" sizes="(max-width: 600px) 100vw, 600px"/></a></p>
<p><strong><em>New to Flask?</em></strong> Start with the <a href="http://flask.pocoo.org/docs/0.10/quickstart/" target="_blank">official Quickstart guide</a> or the “Flask: QuickStart” chapter in the <a href="https://realpython.com/courses/#course-2-web-development-with-python" target="_blank">second Real Python course</a>.</p>
<h1>Setup</h1>
<p>You can setup you development either with or without <a href="https://www.docker.com/" target="_blank">Docker</a>.</p>
<p><strong>With Docker:</strong></p>
<p>If you don’t have Docker installed, follow the <a href="https://docs.docker.com/installation/mac/" target="_blank">official Docker documentation</a> to install both Docker and boot2docker. Then with boot2docker up and running, run 
			<span id="crayon-56d59d9f52e2e815449988" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-e">docker </span><span class="crayon-v">version</span></span></span>  to test the Docker installation.</p>
<p>Create a directory to house your project “flask-image-search”.</p>
<p>Grab the <em>_setup.zip</em> from the <a href="https://github.com/realpython/flask-image-search" target="_blank">repository</a>, unzip the files, and add them to your project directory.</p>
<p>Now build the Docker image:</p>

		<div id="crayon-56d59d9f52e39312536785" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e39312536785-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">docker </span><span class="crayon-v">build</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-r">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-v">opencv</span><span class="crayon-o">-</span><span class="crayon-i">docker</span><span class="crayon-h"> </span><span class="crayon-sy">.</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Once built, run the Docker container:</p>

		<div id="crayon-56d59d9f52e3d691814185" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e3d691814185-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">docker </span><span class="crayon-v">run</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-o">:</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-v">opencv</span><span class="crayon-o">-</span><span class="crayon-v">docker</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Open your web browser and navigate to the IP address associated with the DOCKER_HOST variable – which should be <a href="http://192.168.59.103/" target="_blank">http://192.168.59.103/</a>; if not, run 
			<span id="crayon-56d59d9f52e41071030617" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-e">boot2docker </span><span class="crayon-v">ip</span></span></span>  to get the correct address – you should see the text “Welcome!” in your browser.</p>
<p><strong>Without Docker:</strong></p>
<p>Create a directory to house your project “flask-image-search”.</p>
<p>Grab the <em>_setup.zip</em> from the <a href="https://github.com/realpython/flask-image-search" target="_blank">repository</a>, unzip the files, and add them to your project directory. Create and activate a virtualenv, then install the requirements via Pip:</p>

		<div id="crayon-56d59d9f52e45442864930" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e45442864930-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-e">flask </span><span class="crayon-e">numpy </span><span class="crayon-e">scipy </span><span class="crayon-e">matplotlib </span><span class="crayon-v">scikit</span><span class="crayon-o">-</span><span class="crayon-e">image </span><span class="crayon-i">gunicorn</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e45442864930-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-v">freeze</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">requirements</span><span class="crayon-e">.txt</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h1>Basics</h1>
<p>Since you’ve already built the search engine, we just need to transfer the <em>relevant</em> code to Flask. Essentially, we’re just going to wrap the image search engine in Flask.</p>
<p>Right now your project directory should look like this:</p>

		<div id="crayon-56d59d9f52e48915962860" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-2">2</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-4">4</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-6">6</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-8">8</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-10">10</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-12">12</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-14">14</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-16">16</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e48915962860-18">18</p><p class="crayon-num" data-line="crayon-56d59d9f52e48915962860-19">19</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e48915962860-1">├──<span class="crayon-h"> </span><span class="crayon-i">Dockerfile</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-2">├──<span class="crayon-h"> </span><span class="crayon-i">app</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-3">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">app</span><span class="crayon-e">.py</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-4">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-e">.csv</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-5">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-i">pyimagesearch</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-6">│  <span class="crayon-h"> </span>│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">__init__</span><span class="crayon-e">.py</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-7">│  <span class="crayon-h"> </span>│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">colordescriptor</span><span class="crayon-e">.py</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-8">│  <span class="crayon-h"> </span>│  <span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-v">searcher</span><span class="crayon-e">.py</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-9">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-i">static</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-10">│  <span class="crayon-h"> </span>│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">main</span><span class="crayon-e">.css</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-11">│  <span class="crayon-h"> </span>│  <span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-v">main</span><span class="crayon-e">.js</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-12">│  <span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-i">templates</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-13">│  <span class="crayon-h">     </span>├──<span class="crayon-h"> </span><span class="crayon-v">_base</span><span class="crayon-e">.html</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-14">│  <span class="crayon-h">     </span>└──<span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-e">.html</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-15">├──<span class="crayon-h"> </span><span class="crayon-i">config</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-16">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">app</span><span class="crayon-e">.ini</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-17">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">nginx</span><span class="crayon-e">.conf</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e48915962860-18">│  <span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-v">supervisor</span><span class="crayon-e">.conf</span></p><p class="crayon-line" id="crayon-56d59d9f52e48915962860-19">└──<span class="crayon-h"> </span><span class="crayon-v">requirements</span><span class="crayon-e">.txt</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The <em>Dockerfile</em> and the files with the “config” directory are used specifically to get our app up an running in the Docker container (if you used Docker, of course). Don’t worry too much about how these work, but if you are curious you can reference the inline comments in the <em>Dockerfile</em>. Within the “app” directory the <em>index.csv</em> file as well as the files within the “pyimagesearch” directory are specific to, well, the image search engine. Reference the <a href="http://www.pyimagesearch.com/2014/12/01/complete-guide-building-image-search-engine-python-opencv/" target="_blank">previous tutorial</a> for more information.</p>
<p>Now, let’s take a closer look at the files and folders within the “app” directory that are specific to Flask:</p>
<ol>
<li>The <em>app.py</em> file is our Flask application. Be sure to reference the inline comments within the file to fully understand what’s happening. It’s important to note that in most cases you should break your app into smaller pieces. However, since this app (as well as our finished app) are small, we can get away with storing all the functionality in a single file.</li>
<li>The “static” directory houses static files, like – stylesheets, JavaScript files, images, etc.</li>
<li>The “templates” directory houses our app’s templates. Take a look at the relationship between the <em>_base.html</em> and <em>index.html</em> templates. This is called template inheritance. For more on this, check out <a href="https://realpython.com/blog/python/primer-on-jinja-templating/#inheritance" target="_blank">this blog post</a>.</li>
</ol>
<p>That’s it for our current project structure. With that, let’s start building!</p>
<h1>Workflow</h1>
<p>Put simply, we’ll focus on two routes/endpoints:</p>
<ol>
<li>The main route (‘/’): This route handles the main user interaction. Users can select an image (which sends a POST request to the search route) and then displays the similar images.</li>
<li>The search route (‘/search’): This route handles POST requests. It will take an image (name) and then using the majority of the search engine code return similar images (URLs).</li>
</ol>
<h1>Back-end</h1>
<h2>Main Route</h2>
<p>The back-end code is already set up. That’s right – We just need to render a template when a user requests 
			<span id="crayon-56d59d9f52e4e328541625" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">/</span></span></span> . We do however, need to update the template, <em>index.html</em>, as well as add HTML, CSS, and Javascript/jQuery code. This will be handled in the <strong>Front-end</strong> section.</p>
<h2>Search Route</h2>
<p>Again, this route is meant to:</p>
<ul>
<li>Handle POST requests,</li>
<li>Take an image and search for similar images (using the already completed search engine code), and</li>
<li>Return the similar images (in the form of URLs) in JSON format</li>
</ul>
<p>Add the following code to <em>app.py</em>, just below the main route.</p>

		<div id="crayon-56d59d9f52e52121955666" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-2">2</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-4">4</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-6">6</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-8">8</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-10">10</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-12">12</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-14">14</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-16">16</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-18">18</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-20">20</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-22">22</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-24">24</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-26">26</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-28">28</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-30">30</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-32">32</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-34">34</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-36">36</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-38">38</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e52121955666-40">40</p><p class="crayon-num" data-line="crayon-56d59d9f52e52121955666-41">41</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e52121955666-1"><span class="crayon-c"># search route</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-2"><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">route</span><span class="crayon-sy">(</span><span class="crayon-s">'/search'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">methods</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'POST'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-3"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">search</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-4"> </p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-5"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">method</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"POST"</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-6"> </p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-7"><span class="crayon-h">        </span><span class="crayon-v">RESULTS_ARRAY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-8"> </p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-9"><span class="crayon-h">        </span><span class="crayon-c"># get url</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-10"><span class="crayon-h">        </span><span class="crayon-v">image_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">form</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'img'</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-12"><span class="crayon-h">        </span><span class="crayon-st">try</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-13"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-14"><span class="crayon-h">            </span><span class="crayon-c"># initialize the image descriptor</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-15"><span class="crayon-h">            </span><span class="crayon-k ">cd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ColorDescriptor</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-16"> </p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-17"><span class="crayon-h">            </span><span class="crayon-c"># load the query image and describe it</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-18"><span class="crayon-h">            </span><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">skimage </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">io</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-19"><span class="crayon-h">            </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-20"><span class="crayon-e">            </span><span class="crayon-v">query</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">io</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">image_url</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-21"><span class="crayon-h">            </span><span class="crayon-v">query</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">query</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-22"><span class="crayon-h">            </span><span class="crayon-sy">(</span><span class="crayon-v">r</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">query</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-23"><span class="crayon-h">            </span><span class="crayon-v">query</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-24"><span class="crayon-h">            </span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">cd</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-v">query</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-25"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-26"><span class="crayon-h">            </span><span class="crayon-c"># perform the search</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-27"><span class="crayon-h">            </span><span class="crayon-v">searcher</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Searcher</span><span class="crayon-sy">(</span><span class="crayon-v">INDEX</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-28"><span class="crayon-h">            </span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">searcher</span><span class="crayon-sy">.</span><span class="crayon-e">search</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-29"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-30"><span class="crayon-h">            </span><span class="crayon-c"># loop over the results, displaying the score and image name</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-31"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">resultID</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-32"><span class="crayon-h">                </span><span class="crayon-v">RESULTS_ARRAY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-33"><span class="crayon-h">                    </span><span class="crayon-sy">{</span><span class="crayon-s">"image"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">resultID</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"score"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-34"> </p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-35"><span class="crayon-h">            </span><span class="crayon-c"># return success</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-36"><span class="crayon-h">            </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">jsonify</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">RESULTS_ARRAY</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-37"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-38"><span class="crayon-h">        </span><span class="crayon-st">except</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-39"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e52121955666-40"><span class="crayon-h">            </span><span class="crayon-c"># return error</span></p><p class="crayon-line" id="crayon-56d59d9f52e52121955666-41"><span class="crayon-h">            </span><span class="crayon-e">jsonify</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"sorry"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Sorry, no results! Please try again."</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>What’s happening?</strong></p>
<ol>
<li>We define the endpoint, 
			<span id="crayon-56d59d9f52e56708339764" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">/</span><span class="crayon-i">search</span>'</span></span> , along with the allowed HTTP request methods, 
			<span id="crayon-56d59d9f52e5a553536097" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">methods</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'POST'</span><span class="crayon-sy">]</span></span></span> . Jump back to the 
			<span id="crayon-56d59d9f52e5d583189768" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">/</span></span></span>  main endpoint real quick. Notice how we did not specify the allowed request methods. Why? That’s because by default all endpoints respond to GET requests.</li>
<li>We grab the image, 
			<span id="crayon-56d59d9f52e61751908070" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">image_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">form</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'img'</span><span class="crayon-sy">)</span></span></span>  and then using a try/except we search for similar images.</li>
<li>Compare the loop in the above code, to the loop in <em>search.py</em> from the previous tutorial. Here, instead of outputting the results, we’re simply grabbing them and adding them to a list. This list is then passed into a special Flask function called 
			<span id="crayon-56d59d9f52e64222131232" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">jsonify</span></span></span>  which returns a JSON response.</li>
</ol>
<p>Be sure to update the imports-</p>

		<div id="crayon-56d59d9f52e68698388737" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e68698388737-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e68698388737-2"> </p><p class="crayon-line" id="crayon-56d59d9f52e68698388737-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">flask </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">Flask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">render_template</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">jsonify</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e68698388737-4"> </p><p class="crayon-line" id="crayon-56d59d9f52e68698388737-5"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span><span class="crayon-sy">.</span><span class="crayon-e">colordescriptor </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">ColorDescriptor</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e68698388737-6"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span><span class="crayon-sy">.</span><span class="crayon-e">searcher </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">Searcher</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>-and add the following variable, just below the creation of the Flask instance, which specifies the path to the <em>index.csv</em> file used in the image search-</p>

		<div id="crayon-56d59d9f52e6b387676671" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e6b387676671-1"><span class="crayon-v">INDEX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">dirname</span><span class="crayon-sy">(</span><span class="crayon-v">__file__</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'index.csv'</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We’ll look at the exact output of this in the next section.</p>
<h1>Front-end</h1>
<p>So, with our back-end code done, we just need to update the structure and feel (via HTML and CSS) as well as add user interaction (via JavaScript/jQuery). To help with this, we’ll use the <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a> front-end framework.</p>
<p>Open the <em>_base.html</em> template.</p>
<p>We’ve already included the Bootstrap stylesheet (via a <a href="http://en.wikipedia.org/wiki/Content_delivery_network" target="_blank">CDN</a>) along with the jQuery and Bootstrap JavaScript libraries and a custom stylesheet and JavaScript file (both of which reside in the “static” folder):</p>

		<div id="crayon-56d59d9f52e6f686372082" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e6f686372082-1"><span class="crayon-c">&lt;!-- stylesheets --&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e6f686372082-2"><span class="crayon-r ">&lt;link </span><span class="crayon-e ">href</span><span class="crayon-o">=</span><span class="crayon-s ">"//maxcdn.bootstrapcdn.com/bootswatch/3.2.0/yeti/bootstrap.min.css"</span><span class="crayon-h"> </span><span class="crayon-e ">rel</span><span class="crayon-o">=</span><span class="crayon-s ">"stylesheet"</span><span class="crayon-h"> </span><span class="crayon-e ">media</span><span class="crayon-o">=</span><span class="crayon-s ">"screen"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e6f686372082-3"><span class="crayon-r ">&lt;link </span><span class="crayon-e ">href</span><span class="crayon-o">=</span><span class="crayon-s ">"{{ url_for('static', filename='main.css') }}"</span><span class="crayon-h"> </span><span class="crayon-e ">rel</span><span class="crayon-o">=</span><span class="crayon-s ">"stylesheet"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e6f686372082-4"> </p><p class="crayon-line" id="crayon-56d59d9f52e6f686372082-5"><span class="crayon-i ">... snip ...</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e6f686372082-6"> </p><p class="crayon-line" id="crayon-56d59d9f52e6f686372082-7"><span class="crayon-c">&lt;!-- Scripts --&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e6f686372082-8"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s">"//code.jquery.com/jquery-2.1.1.min.js"</span><span class="crayon-h"> </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e6f686372082-9"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s">"//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"</span><span class="crayon-h"> </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e6f686372082-10"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s">"{{ url_for('static', filename='main.js') }}"</span><span class="crayon-h"> </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Template</h2>
<p>First, let’s update the <em>index.html</em> template:</p>

		<div id="crayon-56d59d9f52e73890354401" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-2">2</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-4">4</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-6">6</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-8">8</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-10">10</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-12">12</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-14">14</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-16">16</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-18">18</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-20">20</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-22">22</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-24">24</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-26">26</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-28">28</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-30">30</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-32">32</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-34">34</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-36">36</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-38">38</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e73890354401-40">40</p><p class="crayon-num" data-line="crayon-56d59d9f52e73890354401-41">41</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e73890354401-1"><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span>extends<span class="crayon-h"> </span><span class="crayon-s ">"_base.html"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-2"> </p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-3"><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span>block<span class="crayon-h"> </span>content<span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-4"> </p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-5"><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"row"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-6"> </p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-7"><span class="crayon-i ">  </span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"col-md-7"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-8"><span class="crayon-i ">    </span><span class="crayon-r ">&lt;h2&gt;</span><span class="crayon-i ">Select an Image</span><span class="crayon-r ">&lt;/h2&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-9"><span class="crayon-i ">    </span><span class="crayon-r ">&lt;br&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-10"><span class="crayon-i ">    </span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"row"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-11"><span class="crayon-i ">      </span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"col-md-6"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-12"><span class="crayon-i ">        </span><span class="crayon-r ">&lt;p&gt;</span><span class="crayon-r ">&lt;img </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s ">"http://static.pyimagesearch.com.s3-us-west-2.amazonaws.com/vacation-photos/queries/103100.png"</span><span class="crayon-h"> </span><span class="crayon-e ">style</span><span class="crayon-o">=</span><span class="crayon-s ">"height: 250px;"</span><span class="crayon-h"> </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"img"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;/p&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-13"><span class="crayon-i ">        </span><span class="crayon-r ">&lt;p&gt;</span><span class="crayon-r ">&lt;img </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s ">"http://static.pyimagesearch.com.s3-us-west-2.amazonaws.com/vacation-photos/queries/103300.png"</span><span class="crayon-h"> </span><span class="crayon-e ">style</span><span class="crayon-o">=</span><span class="crayon-s ">"height: 250px;"</span><span class="crayon-h"> </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"img"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;/p&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-14"><span class="crayon-i ">      </span><span class="crayon-r ">&lt;/div&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-15"><span class="crayon-i ">      </span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"col-md-6"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-16"><span class="crayon-i ">        </span><span class="crayon-r ">&lt;p&gt;</span><span class="crayon-r ">&lt;img </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s ">"http://static.pyimagesearch.com.s3-us-west-2.amazonaws.com/vacation-photos/queries/127502.png"</span><span class="crayon-h"> </span><span class="crayon-e ">style</span><span class="crayon-o">=</span><span class="crayon-s ">"height: 250px;"</span><span class="crayon-h"> </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"img"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;/p&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-17"><span class="crayon-i ">        </span><span class="crayon-r ">&lt;p&gt;</span><span class="crayon-r ">&lt;img </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s ">"http://static.pyimagesearch.com.s3-us-west-2.amazonaws.com/vacation-photos/queries/123600.png"</span><span class="crayon-h"> </span><span class="crayon-e ">style</span><span class="crayon-o">=</span><span class="crayon-s ">"height: 250px;"</span><span class="crayon-h"> </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"img"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;/p&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-18"><span class="crayon-i ">      </span><span class="crayon-r ">&lt;/div&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-19"><span class="crayon-i ">    </span><span class="crayon-r ">&lt;/div&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-20"><span class="crayon-i ">  </span><span class="crayon-r ">&lt;/div&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-21"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-22"><span class="crayon-i ">  </span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"col-md-3 col-md-offset-1"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-23"><span class="crayon-i ">    </span><span class="crayon-r ">&lt;h2&gt;</span><span class="crayon-i ">Results</span><span class="crayon-r ">&lt;/h2&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-24"><span class="crayon-i ">    </span><span class="crayon-r ">&lt;br&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-25"><span class="crayon-i ">    </span><span class="crayon-r ">&lt;table </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"table"</span><span class="crayon-h"> </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s ">"results-table"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-26"><span class="crayon-i ">      </span><span class="crayon-r ">&lt;thead&gt;</span><span class="crayon-i ">b</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-27"><span class="crayon-i ">        </span><span class="crayon-r ">&lt;tr&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-28"><span class="crayon-i ">          </span><span class="crayon-r ">&lt;th&gt;</span><span class="crayon-i ">Image</span><span class="crayon-r ">&lt;/th&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-29"><span class="crayon-i ">          </span><span class="crayon-r ">&lt;th&gt;</span><span class="crayon-i ">Score</span><span class="crayon-r ">&lt;/th&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-30"><span class="crayon-i ">        </span><span class="crayon-r ">&lt;/tr&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-31"><span class="crayon-i ">      </span><span class="crayon-r ">&lt;/thead&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-32"><span class="crayon-i ">      </span><span class="crayon-r ">&lt;tbody </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s ">"results"</span><span class="crayon-r ">&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-33"><span class="crayon-i ">      </span><span class="crayon-r ">&lt;/tbody&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-34"><span class="crayon-i ">    </span><span class="crayon-r ">&lt;/table&gt;</span></p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-35"><span class="crayon-i ">  </span><span class="crayon-r ">&lt;/div&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-36"> </p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-37"><span class="crayon-r ">&lt;/div&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-38"> </p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-39"><span class="crayon-r ">&lt;br&gt;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e73890354401-40"> </p><p class="crayon-line" id="crayon-56d59d9f52e73890354401-41"><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span>endblock<span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now let’s test…</p>
<p><strong>With Docker: </strong></p>
<p>Rebuild the Docker image and then run the new container:</p>

		<div id="crayon-56d59d9f52e77736381041" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e77736381041-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">docker </span><span class="crayon-v">build</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-r">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-v">opencv</span><span class="crayon-o">-</span><span class="crayon-i">docker</span><span class="crayon-h"> </span><span class="crayon-sy">.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e77736381041-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">docker </span><span class="crayon-v">run</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-o">:</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-v">opencv</span><span class="crayon-o">-</span><span class="crayon-v">docker</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Without Docker: </strong></p>

		

<p>Navigate to your app in the browser, and you should see:</p>
<p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/11/1_first-iteration.png"><img class="aligncenter wp-image-1603" src="http://www.pyimagesearch.com/wp-content/uploads/2014/11/1_first-iteration.png" alt="1_first-iteration" srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/11/1_first-iteration-300x170.png 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/11/1_first-iteration-1024x581.png 1024w, http://www.pyimagesearch.com/wp-content/uploads/2014/11/1_first-iteration.png 1110w" sizes="(max-width: 600px) 100vw, 600px"/></a></p>
<p>As you can tell, we added four images on the left side and a results table on the right side. Pay attention to the <a href="http://www.w3schools.com/css/css_selectors.asp" target="_blank">CSS selectors</a> (
			<span id="crayon-56d59d9f52e7f352309819" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">id</span></span></span> s and 
			<span id="crayon-56d59d9f52e82590449900" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-t">class</span></span></span> es) in the above HTML code. The 
			<span id="crayon-56d59d9f52e86904277776" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">row</span></span></span>  and 
			<span id="crayon-56d59d9f52e89119524285" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">col</span><span class="crayon-o">-</span><span class="crayon-v">md</span><span class="crayon-o">-</span><span class="crayon-v">x</span></span></span>  classes are associated with the <a href="http://getbootstrap.com/css/#grid" target="_blank">Bootstrap grid system</a>. The remaining 
			<span id="crayon-56d59d9f52e8c693288110" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">id</span></span></span> s and 
			<span id="crayon-56d59d9f52e90748552819" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-t">class</span></span></span> es are used for adding styles with CSS and/or interaction via JavaScript/jQuery.</p>
<h2>JavaScript/jQuery</h2>
<p><em><strong>Note: </strong></em>If you’re unfamiliar with JavaScript and jQuery basics, please check out the <a href="https://realpython.com/resources/#front-end" target="_blank">Madlibs tutorial</a>.</p>
<p>Let’s break down the user interaction by each individual piece of interaction.</p>
<h3>Image Click</h3>
<p>The interaction begins with an image click. In other words, the end user clicks one of the four images on the left side of the page with the end goal of finding similar images.</p>
<p>Update the <em>main.js</em> file:</p>

		<div id="crayon-56d59d9f52e93067549041" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-2">2</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-4">4</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-6">6</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-8">8</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-10">10</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-12">12</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-14">14</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-16">16</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-18">18</p><p class="crayon-num" data-line="crayon-56d59d9f52e93067549041-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52e93067549041-20">20</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52e93067549041-1"><span class="crayon-c">// ----- custom js ----- //</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-2"> </p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-3"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-4"> </p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-5"><span class="crayon-h">  </span><span class="crayon-c">// sanity check</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-6"><span class="crayon-h">  </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"ready!"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-8"><span class="crayon-h">  </span><span class="crayon-c">// image click</span></p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-9"><span class="crayon-h">  </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">".img"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">click</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-10"> </p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-11"><span class="crayon-h">    </span><span class="crayon-c">// add active class to clicked picture</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-12"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">addClass</span><span class="crayon-sy">(</span><span class="crayon-s">"active"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-13"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-14"><span class="crayon-h">    </span><span class="crayon-c">// grab image url</span></p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-15"><span class="crayon-h">    </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">attr</span><span class="crayon-sy">(</span><span class="crayon-s">"src"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-16"><span class="crayon-h">    </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-17"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-18"><span class="crayon-h">  </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52e93067549041-19"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52e93067549041-20"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Run your app. Either:</p>
<ul>
<li>Rebuild the Docker image, and run the new container.</li>
<li>Run 
			<span id="crayon-56d59d9f52e97880071489" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-e">python </span><span class="crayon-v">app</span><span class="crayon-o">/</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-i">py</span> </span></span></li>
</ul>
<p>Then navigate to your app in the browser. Open your JavaScript console and then click one of the images. You should see:</p>
<p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/11/2_second-iteration.png"><img class="aligncenter wp-image-1604" src="http://www.pyimagesearch.com/wp-content/uploads/2014/11/2_second-iteration.png" alt="2_second-iteration" srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/11/2_second-iteration-1024x507.png 1024w, http://www.pyimagesearch.com/wp-content/uploads/2014/11/2_second-iteration.png 1270w" sizes="(max-width: 600px) 100vw, 600px"/></a>So, the jQuery code handles the click event by grabbing the URL of the specific image clicked and adding a CSS class (which we still need to add to the CSS file). The link between the jQuery code and the HTML is the 
			<span id="crayon-56d59d9f52e9b943681366" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">img</span></span></span>  class – 
			<span id="crayon-56d59d9f52e9f046221074" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">".img"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">click</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span>  and 
			<span id="crayon-56d59d9f52ea2049461491" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"img"</span></span></span> , respectively. This should be clear.</p>
<h3>AJAX Request</h3>
<p>With the image URL in hand, we can now send it to the back-end via an <a href="http://en.wikipedia.org/wiki/Ajax_(programming)" target="_blank">AJAX</a> request, which is a client-side technology for making asynchronous requests that don’t cause an entire page refresh. Most SPAs use some sort of asynchronous technology to prevent a page refresh when requesting data since this enhances the overall user experience.</p>
<p>Update <em>main.js</em> like so:</p>

		<div id="crayon-56d59d9f52ea6628746197" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-2">2</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-4">4</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-6">6</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-8">8</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-10">10</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-12">12</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-14">14</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-16">16</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-18">18</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-20">20</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-22">22</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-24">24</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-26">26</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-28">28</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-30">30</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-32">32</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ea6628746197-34">34</p><p class="crayon-num" data-line="crayon-56d59d9f52ea6628746197-35">35</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-1"><span class="crayon-c">// ----- custom js ----- //</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-2"> </p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-3"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-4"> </p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-5"><span class="crayon-h">  </span><span class="crayon-c">// sanity check</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-6"><span class="crayon-h">  </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"ready!"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-8"><span class="crayon-h">  </span><span class="crayon-c">// image click</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-9"><span class="crayon-h">  </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">".img"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">click</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-10"> </p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-11"><span class="crayon-h">    </span><span class="crayon-c">// add active class to clicked picture</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-12"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">addClass</span><span class="crayon-sy">(</span><span class="crayon-s">"active"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-13"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-14"><span class="crayon-h">    </span><span class="crayon-c">// grab image url</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-15"><span class="crayon-h">    </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">attr</span><span class="crayon-sy">(</span><span class="crayon-s">"src"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-16"><span class="crayon-h">    </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-17"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-18"><span class="crayon-h">    </span><span class="crayon-c">// ajax request</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-19"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-e">ajax</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-20"><span class="crayon-h">      </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"POST"</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-21"><span class="crayon-h">      </span><span class="crayon-v">url</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"/search"</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-22"><span class="crayon-h">      </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-23"><span class="crayon-h">      </span><span class="crayon-c">// handle success</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-24"><span class="crayon-h">      </span><span class="crayon-v">success</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-25"><span class="crayon-h">        </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-26"><span class="crayon-h">      </span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-27"><span class="crayon-h">      </span><span class="crayon-c">// handle error</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-28"><span class="crayon-h">      </span><span class="crayon-v">error</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-29"><span class="crayon-h">        </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-30"><span class="crayon-h">      </span><span class="crayon-sy">}</span></p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-31"><span class="crayon-h">    </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-32"> </p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-33"><span class="crayon-h">  </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ea6628746197-34"> </p><p class="crayon-line" id="crayon-56d59d9f52ea6628746197-35"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>You know the drill: Run the app, and then refresh your browser. Click an image again, and then after a few seconds you should see:</p>
<p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/11/3_third-iteration.png"><img class="aligncenter wp-image-1605" src="http://www.pyimagesearch.com/wp-content/uploads/2014/11/3_third-iteration.png" alt="3_third-iteration" srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/11/3_third-iteration-300x147.png 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/11/3_third-iteration-1024x503.png 1024w, http://www.pyimagesearch.com/wp-content/uploads/2014/11/3_third-iteration.png 1272w" sizes="(max-width: 600px) 100vw, 600px"/></a><em><strong>Note: </strong></em>This request is quite slow since we are searching a CSV rather than an <strong>actual</strong> database – i.e., SQLite, Postgres, MySQL. It’s a fairly trivial job to convert the data to a database. Try this on your own. Feel free to comment below if you have questions and/or a solution that you’d like us to look at. Cheers!</p>
<p>This time after the user click, we send a POST request to the 
			<span id="crayon-56d59d9f52eaa711499038" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">/</span><span class="crayon-v">search</span></span></span>  endpoint, which includes the image URL. The back-end does it’s magic (grabbing the image, running the search code) and then returns the results in JSON format. The AJAX request has two handlers – one for a success and one for a failure. Jumping back to the back-end, the 
			<span id="crayon-56d59d9f52eae928373438" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">/</span><span class="crayon-v">search</span></span></span>  route either returns a 200 response (a success) or a 500 response (a failure) along with the data or an error message:</p>

		<div id="crayon-56d59d9f52eb1561278923" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52eb1561278923-1"><span class="crayon-h">    </span><span class="crayon-c"># return success</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb1561278923-2"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">jsonify</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">RESULTS_ARRAY</span><span class="crayon-sy">[</span><span class="crayon-o">::</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52eb1561278923-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb1561278923-4"><span class="crayon-st">except</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d59d9f52eb1561278923-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb1561278923-6"><span class="crayon-h">    </span><span class="crayon-c"># return error</span></p><p class="crayon-line" id="crayon-56d59d9f52eb1561278923-7"><span class="crayon-h">    </span><span class="crayon-e">jsonify</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"sorry"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Sorry, no results! Please try again."</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Back to the front-end… since the result was successful, you can see the data in the JavaScript console:</p>

		<div id="crayon-56d59d9f52eb5682929945" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52eb5682929945-1"><span class="crayon-sy">[</span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Object</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>This is just an array of JSON objects. Go ahead and expand the array and open an individual object:</p>
<p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/11/4_json-data.png"><img class="aligncenter wp-image-1606" src="http://www.pyimagesearch.com/wp-content/uploads/2014/11/4_json-data.png" alt="4_json-data"/></a>So, each object has an image and a score that represents the “similarity” between the query image and the result image. The smaller the score is, the more “similar” the query is to the result. A similarity of zero would indicate “perfect similarity”. This is the exact data we want to present to the end user.</p>
<h3>Update the DOM</h3>
<p>We’re in the home stretch! Let’s update the success and error handlers so that once one of them receives data from the back-end, we append that data to the DOM:</p>

		<div id="crayon-56d59d9f52eb9382621611" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52eb9382621611-1"><span class="crayon-r ">&lt;a </span><span class="crayon-e ">href</span><span class="crayon-o">=</span><span class="crayon-s ">"'+url+data[i]["</span><span class="crayon-h"> </span><span class="crayon-e ">data-mce-href</span><span class="crayon-o">=</span><span class="crayon-s ">"'+url+data[i]["</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">'+data[i]["image"]+'</span><span class="crayon-r ">&lt;/a&gt;</span><span class="crayon-s ">'+data[i]['</span>score<span class="crayon-s ">']+'</span><span class="crayon-s ">')   }; }, // handle error error: function(error) {   console.log(error);   // show error   $("#error").show(); }" &gt;// handle success</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb9382621611-2"><span class="crayon-s ">success: function(result) {</span></p><p class="crayon-line" id="crayon-56d59d9f52eb9382621611-3"><span class="crayon-s ">  console.log(result.results);</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb9382621611-4"><span class="crayon-s ">  var data = result.results</span></p><p class="crayon-line" id="crayon-56d59d9f52eb9382621611-5"><span class="crayon-s ">  // loop through results, append to dom</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb9382621611-6"><span class="crayon-s ">  for (i = 0; i &lt; data.length; i++) {</span></p><p class="crayon-line" id="crayon-56d59d9f52eb9382621611-7"><span class="crayon-s ">    $("#results").append('</span><span class="crayon-r ">&lt;tr&gt;</span><span class="crayon-r ">&lt;th&gt;</span><span class="crayon-r ">&lt;a </span><span class="crayon-e ">href</span><span class="crayon-o">=</span><span class="crayon-s ">"'+url+data[i]["</span>image<span class="crayon-s ">"]+'"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">'+data[i]["image"]+'</span><span class="crayon-r ">&lt;/a&gt;</span><span class="crayon-r ">&lt;/th&gt;</span><span class="crayon-r ">&lt;th&gt;</span><span class="crayon-i ">'+data[i]['score']+'</span><span class="crayon-r ">&lt;/th&gt;</span><span class="crayon-r ">&lt;/tr&gt;</span>'<span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb9382621611-8"><span class="crayon-h">  </span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52eb9382621611-9"><span class="crayon-sy">}</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb9382621611-10"><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-h"> </span>handle<span class="crayon-h"> </span>error</p><p class="crayon-line" id="crayon-56d59d9f52eb9382621611-11">error<span class="crayon-o">:</span><span class="crayon-h"> </span>function<span class="crayon-sy">(</span>error<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb9382621611-12"><span class="crayon-h">  </span>console<span class="crayon-sy">.</span>log<span class="crayon-sy">(</span>error<span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52eb9382621611-13"><span class="crayon-h">  </span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-h"> </span>show<span class="crayon-h"> </span>error</p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52eb9382621611-14"><span class="crayon-h">  </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s ">"#error"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span>show<span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52eb9382621611-15"><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>In the success handler, we loop through the results, add in some HTML (for the table), then append the data to an id of 
			<span id="crayon-56d59d9f52ebe630791793" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">results</span></span></span>  (which is already part of the HTML template). The error handler does not actually update the DOM with the <em>exact</em> error returned. Instead, we log the exact error it to the console, for us to see, and then “unhide” an HTML element with an id of 
			<span id="crayon-56d59d9f52ec2778947719" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">error</span></span></span>  (which, again, we need to add to the HTML template).</p>
<p>We also need to add some global variables to the top of the file JavaScript file:</p>

		<div id="crayon-56d59d9f52ec5445438722" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ec5445438722-1"><span class="crayon-c">// ----- custom js ----- //</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ec5445438722-2"> </p><p class="crayon-line" id="crayon-56d59d9f52ec5445438722-3"><span class="crayon-c">// global</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ec5445438722-4"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'http://static.pyimagesearch.com.s3-us-west-2.amazonaws.com/vacation-photos/dataset/'</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ec5445438722-5"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ec5445438722-6"> </p><p class="crayon-line" id="crayon-56d59d9f52ec5445438722-7"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-i">snip</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Look through the file and see if you can find how these variables are put to use.</p>
<p>Finally, before we test, let’s update the <em>index.html</em> template…</p>
<p>Add:</p>

		<div id="crayon-56d59d9f52ec9519565787" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ec9519565787-1"><span class="crayon-r ">&lt;p </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s ">"error"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">Oh no! No results! Check your internet connection.</span><span class="crayon-r ">&lt;/p&gt;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Right above:</p>

		<div id="crayon-56d59d9f52ecc155128513" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ecc155128513-1"><span class="crayon-r ">&lt;table </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"table"</span><span class="crayon-h"> </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s ">"results-table"</span><span class="crayon-r ">&gt;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Okay. Think about what’s going to happen now when we test. if all went well, you should see:</p>
<p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/11/5_fourth-iteration.png"><img class="aligncenter wp-image-1607" src="http://www.pyimagesearch.com/wp-content/uploads/2014/11/5_fourth-iteration.png" alt="5_fourth-iteration" srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/11/5_fourth-iteration-300x177.png 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/11/5_fourth-iteration-1024x604.png 1024w, http://www.pyimagesearch.com/wp-content/uploads/2014/11/5_fourth-iteration.png 1079w" sizes="(max-width: 600px) 100vw, 600px"/></a></p>
<p>Boom! You can even click on the image URLs to see the <em>actual</em> results (e.g., the similar images). Notice how you can see the error though. We still have some cleaning up to do.</p>
<h3>DOM Cleanup</h3>
<p>With the main functionality done, we just need to do a bit of housekeeping. Update <em>main.js</em> like so:</p>

		<div id="crayon-56d59d9f52ed0108617239" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-2">2</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-4">4</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-6">6</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-8">8</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-10">10</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-12">12</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-14">14</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-16">16</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-18">18</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-20">20</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-22">22</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-24">24</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-26">26</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-28">28</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-30">30</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-32">32</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-34">34</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-36">36</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-38">38</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-40">40</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-42">42</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-44">44</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-46">46</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-48">48</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-50">50</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-52">52</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-54">54</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-55">55</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-56">56</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-57">57</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-58">58</p><p class="crayon-num" data-line="crayon-56d59d9f52ed0108617239-59">59</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d59d9f52ed0108617239-60">60</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-1"><span class="crayon-c">// ----- custom js ----- //</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-2"> </p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-3"><span class="crayon-c">// hide initial</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-4"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#searching"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-5"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results-table"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-6"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#error"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-8"><span class="crayon-c">// global</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-9"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'http://static.pyimagesearch.com.s3-us-west-2.amazonaws.com/vacation-photos/dataset/'</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-10"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-12"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-13"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-14"><span class="crayon-h">  </span><span class="crayon-c">// sanity check</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-15"><span class="crayon-h">  </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"ready!"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-16"> </p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-17"><span class="crayon-h">  </span><span class="crayon-c">// image click</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-18"><span class="crayon-h">  </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">".img"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">click</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-19"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-20"><span class="crayon-h">    </span><span class="crayon-c">// empty/hide results</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-21"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">empty</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-22"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results-table"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-23"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#error"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-24"> </p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-25"><span class="crayon-h">    </span><span class="crayon-c">// add active class to clicked picture</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-26"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">addClass</span><span class="crayon-sy">(</span><span class="crayon-s">"active"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-27"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-28"><span class="crayon-h">    </span><span class="crayon-c">// grab image url</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-29"><span class="crayon-h">    </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">attr</span><span class="crayon-sy">(</span><span class="crayon-s">"src"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-30"><span class="crayon-h">    </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-31"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-32"><span class="crayon-h">    </span><span class="crayon-c">// show searching text</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-33"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#searching"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-34"><span class="crayon-h">    </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">"searching..."</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-35"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-36"><span class="crayon-h">    </span><span class="crayon-c">// ajax request</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-37"><span class="crayon-h">    </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-e">ajax</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-38"><span class="crayon-h">      </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"POST"</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-39"><span class="crayon-h">      </span><span class="crayon-v">url</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"/search"</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-40"><span class="crayon-h">      </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-41"><span class="crayon-h">      </span><span class="crayon-c">// handle success</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-42"><span class="crayon-h">      </span><span class="crayon-v">success</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-43"><span class="crayon-h">        </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-44"><span class="crayon-h">        </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-v">results</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-45"><span class="crayon-h">        </span><span class="crayon-c">// loop through results, append to dom</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-46"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-47"><span class="crayon-h">          </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'&lt;tr&gt;&lt;th&gt;&lt;a href="'</span><span class="crayon-o">+</span><span class="crayon-v">url</span><span class="crayon-o">+</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"image"</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-s">'"&gt;'</span><span class="crayon-o">+</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"image"</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-s">'&lt;/a&gt;&lt;/th&gt;&lt;th&gt;'</span><span class="crayon-o">+</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'score'</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-s">'&lt;/th&gt;&lt;/tr&gt;'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-48"><span class="crayon-h">        </span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-49"><span class="crayon-h">      </span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-50"><span class="crayon-h">      </span><span class="crayon-c">// handle error</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-51"><span class="crayon-h">      </span><span class="crayon-v">error</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-52"><span class="crayon-h">        </span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-53"><span class="crayon-h">        </span><span class="crayon-c">// append to dom</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-54"><span class="crayon-h">        </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#error"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-55"><span class="crayon-h">      </span><span class="crayon-sy">}</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-56"><span class="crayon-h">    </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-57"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-58"><span class="crayon-h">  </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed0108617239-59"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed0108617239-60"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Take a look at the added code…</p>

		<div id="crayon-56d59d9f52ed5551704483" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ed5551704483-1"><span class="crayon-c">// hide initial</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed5551704483-2"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#searching"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed5551704483-3"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results-table"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed5551704483-4"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#error"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>and</p>

		<div id="crayon-56d59d9f52ed9022083996" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ed9022083996-1"><span class="crayon-c">// empty/hide results</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed9022083996-2"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">empty</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ed9022083996-3"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results-table"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ed9022083996-4"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#error"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">hide</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>and</p>

		<div id="crayon-56d59d9f52edc273324432" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52edc273324432-1"><span class="crayon-c">// remove active class</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52edc273324432-2"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">".img"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">removeClass</span><span class="crayon-sy">(</span><span class="crayon-s">"active"</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>and</p>

		<div id="crayon-56d59d9f52ee0556244705" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ee0556244705-1"><span class="crayon-c">// show searching text</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ee0556244705-2"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#searching"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ee0556244705-3"><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">"searching..."</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>and</p>

		<div id="crayon-56d59d9f52ee3567267681" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ee3567267681-1"><span class="crayon-c">// show table</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ee3567267681-2"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results-table"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We’re just hiding and showing different HTML elements based on the user interaction and whether the results of the AJAX request is a success or failure. If you’re really paying attention you probably saw that there is a new CSS selector that you have not seen before – 
			<span id="crayon-56d59d9f52ee7884723913" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-p">#searching</span></span></span> . What does this mean? Well, first off we need to update the template…</p>
<p>Add:</p>

		<div id="crayon-56d59d9f52eea521148342" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52eea521148342-1"><span class="crayon-r ">&lt;p </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s ">"searching"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">Searching...</span><span class="crayon-r ">&lt;/p&gt;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Right above:</p>

		<div id="crayon-56d59d9f52eee962594457" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52eee962594457-1"><span class="crayon-r ">&lt;p </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s ">"error"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">Oh no! No results! Check your internet connection.</span><span class="crayon-r ">&lt;/p&gt;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Now, let’s test! What’s different? Well, when the end user clicks an image, the text 
			<span id="crayon-56d59d9f52ef1238546322" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">Searching</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></span></span>  appears, which disappears when results are added. Then if the user clicks another image, the previous results disappear, the 
			<span id="crayon-56d59d9f52ef5657602855" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">Searching</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></span></span>  text reappears, and finally the new results are added to the DOM.</p>
<p>Take a breath. Or two. We’re now done with the JavaScript portion. It’s a good idea to review this before moving on.</p>
<h2>CSS</h2>
<p>There’s a lot we could do, style-wise, but let’s keep it simple. Add the following code to <em>main.css</em>:</p>

		<div id="crayon-56d59d9f52ef8846560874" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52ef8846560874-1"><span class="crayon-k ">.center-container </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ef8846560874-2"><span class="crayon-h">  </span><span class="crayon-e ">text-align</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">center</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ef8846560874-3"><span class="crayon-h">  </span><span class="crayon-e ">padding-top</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">20px</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ef8846560874-4"><span class="crayon-h">  </span><span class="crayon-e ">padding-bottom</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">20px</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ef8846560874-5"><span class="crayon-sy">}</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ef8846560874-6"> </p><p class="crayon-line" id="crayon-56d59d9f52ef8846560874-7"><span class="crayon-k ">.active </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52ef8846560874-8"><span class="crayon-h">  </span><span class="crayon-e ">border</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">5px</span><span class="crayon-h"> </span><span class="crayon-i ">solid</span><span class="crayon-h"> </span><span class="crayon-i ">red</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52ef8846560874-9"><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Run the app, which should now look like this:</p>
<p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/11/6_fifth-iteration.png"><img class="aligncenter wp-image-1608" src="http://www.pyimagesearch.com/wp-content/uploads/2014/11/6_fifth-iteration.png" alt="6_fifth-iteration" srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/11/6_fifth-iteration-1024x580.png 1024w, http://www.pyimagesearch.com/wp-content/uploads/2014/11/6_fifth-iteration.png 1089w" sizes="(max-width: 600px) 100vw, 600px"/></a>The big change is now when a user clicks an image, a red border appears around it, just reminding the end user which image s/he clicked. Try clicking another image. The red border should now appear around that image. Return to the JavaScript file and review the code to find out how this works.</p>
<h2>Refactor</h2>
<p>We could stop here, but let’s refactor the code slightly to show thumbnails of the top three results. This is an image search engine, after all – We should display some actual images!</p>
<p>Starting with the back-end, update the 
			<span id="crayon-56d59d9f52efc394965069" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-e">search</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span>  view function so that it returns only the top three results:</p>

		<div id="crayon-56d59d9f52f00264211759" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52f00264211759-1"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">jsonify</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">RESULTS_ARRAY</span><span class="crayon-sy">[</span><span class="crayon-o">::</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Next update the for loop within the success handler <em>main.js</em>:</p>

		<div id="crayon-56d59d9f52f03732269637" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52f03732269637-1"><span class="crayon-c">// loop through results, append to dom</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52f03732269637-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d59d9f52f03732269637-3"><span class="crayon-h">  </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">"#results"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'&lt;tr&gt;&lt;th&gt;&lt;a href="'</span><span class="crayon-o">+</span><span class="crayon-v">url</span><span class="crayon-o">+</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"image"</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-s">'"&gt;&lt;img src="'</span><span class="crayon-o">+</span><span class="crayon-v">url</span><span class="crayon-o">+</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"image"</span><span class="crayon-sy">]</span><span class="crayon-o">+</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52f03732269637-4"><span class="crayon-h">    </span><span class="crayon-s">'" class="result-img"&gt;&lt;/a&gt;&lt;/th&gt;&lt;th&gt;'</span><span class="crayon-o">+</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'score'</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-s">'&lt;/th&gt;&lt;/tr&gt;'</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d59d9f52f03732269637-5"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Finally, add the following CSS style:</p>

		<div id="crayon-56d59d9f52f07161903611" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d59d9f52f07161903611-1"><span class="crayon-k ">.result-img </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52f07161903611-2"><span class="crayon-h">  </span><span class="crayon-e ">max-width</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">100px</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d59d9f52f07161903611-3"><span class="crayon-h">  </span><span class="crayon-e ">max-height</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">100px</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d59d9f52f07161903611-4"><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>You should now have:</p>
<p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration.jpg"><img class="aligncenter wp-image-1656" src="http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration.jpg" alt="7_sixth-iteration" srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration-300x168.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration-1024x575.jpg 1024w, http://www.pyimagesearch.com/wp-content/uploads/2014/12/7_sixth-iteration.jpg 1049w" sizes="(max-width: 600px) 100vw, 600px"/></a></p>
<p>Boom!</p>
<h1>Conclusion and Next steps</h1>
<p>To recap, we took the search engine code from the <a href="http://www.pyimagesearch.com/2014/12/01/complete-guide-building-image-search-engine-python-opencv/" target="_blank">first tutorial</a> and wrapped in in Flask to create a full-featured web application. If you’d like to continue working with Flask and web development in general, try:</p>
<ul>
<li>Replacing the static CSV file with a relational database;</li>
<li>Updating the overall user experience by allowing a user to upload an image, rather than limiting the user to search only by the four images;</li>
<li>Adding unit and integration tests;</li>
<li>Deploying to Heroku.</li>
</ul>
<p>Be sure to check out the <a href="http://www.realpython.com" target="_blank">Real Python</a> course to learn how to do all of these and more.</p>
<p>Cheers!</p>
<h1>Interested in learning more?</h1>
<p>Interested in learning more about the <strong>algorithms behind building image search engines?</strong> Or utilizing <strong>Python web frameworks to upload images</strong> and make them searchable? We are considering creating an online course covering image search engines in more depth, from both a <em>technical computer vision side</em>, and a <em>practical web development side</em>.</p>
<p>If this sounds interesting to you, enter your email address in the form below and (if we get enough interest) we will keep you up to date with how the course progresses.</p>

	</section>
	</div></body></html>