<html><body><div><div class="post-text" itemprop="text">
<p>From your spec in the question and comments, I think your code is close - but you don't want the <code>csl</code>.  I've put the code I think you want below (it may not be the most elegant implementation, but I think it's reasonable).  You have to avoid a potential problem that <code>BooleanLiteral</code> is a subset of <code>StringLiteral</code>.  This meant that you can't make the <code>LineExpression</code> have </p>

<pre><code>grammar = maybe_some([LineFilter,StringLiteral]), optional(BooleanLiteral)
</code></pre>

<p>The result is a list of objects with the correct types according to your spec, I think.  I think the crucial bit to emphasise is that you can put in alternatives as a python <code>list</code> (i.e. <code>[LineFilter,StringLiteral]</code> means a <code>LineFilter</code> or a <code>StringLiteral</code>).  The PEG parser will try them in the order they occur, i.e. it will try to match the first and only if it fails will it try the second and so on.</p>

<pre><code>from pypeg2 import *

class BooleanLiteral(Keyword):
    # Need to alter keyword regex to allow for quoted literal keywords
    K.regex=re.compile(r'"*\w+"*') 
    grammar = Enum(K('OR'), K('AND'),K(r'"OR"'), K(r'"AND"')) 

class LineFilter(Namespace):
    grammar = flag('inverted', "-"), name(), ":", attr('value', word)

class StringLiteral(str):
     quoted_string = re.compile(r'"[^"]*"')
     grammar = [word, quoted_string]

class LineExpression(List):
    grammar = maybe_some([(LineFilter,BooleanLiteral),
                          (StringLiteral,BooleanLiteral),
                          LineFilter,
                          StringLiteral])

test_string = ('filter34:43 "My oh my!!" Hello OR '
               'filter32:3232 "AND" "Goodbye cruel world"')

k = parse(test_string,LineExpression)

print('Input:')
print(test_string)
print('Parsed output:')
print('==============')
for component in k:
    print(component,type(component))
</code></pre>

<h3>Output</h3>

<pre><code>Input:
filter34:43 "My oh my!!" Hello OR filter32:3232 "AND" "Goodbye cruel world"
Parsed output:
==============
LineFilter([], name=Symbol('filter34')) &lt;class '__main__.LineFilter'&gt;
"My oh my!!" &lt;class '__main__.StringLiteral'&gt;
Hello &lt;class '__main__.StringLiteral'&gt;
OR &lt;class '__main__.BooleanLiteral'&gt;
LineFilter([], name=Symbol('filter32')) &lt;class '__main__.LineFilter'&gt;
"AND" &lt;class '__main__.BooleanLiteral'&gt;
"Goodbye cruel world" &lt;class '__main__.StringLiteral'&gt;
</code></pre>
    </div>
    </div></body></html>