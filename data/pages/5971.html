<html><body><div><div id="installation">
<h2>Installation</h2>
<p>To install pytest-html:</p>
<pre>$ pip install pytest-html
</pre>
<p>Then run your tests with:</p>
<pre>$ py.test --html<span class="o">=</span>report.html
</pre>
</div>
<div id="enhancing-reports">
<h2>Enhancing reports</h2>
<p>You can add change the <em>Environment</em> section of the report by modifying
<tt>request.config._html.environment</tt> from a fixture:</p>
<pre><span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_environment</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">request</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">_environment</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">))</span>
</pre>
<p>You can add details to the HTML reports by creating an ‘extra’ list on the
report object. The following example adds the various types of extras using a
<code>pytest_runtest_makereport</code> hook, which can be implemented in a plugin or
conftest.py file:</p>
<pre><span class="kn">import</span> <span class="nn">pytest</span>
<span class="nd">@pytest.mark.hookwrapper</span>
<span class="k">def</span> <span class="nf">pytest_runtest_makereport</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">call</span><span class="p">):</span>
    <span class="n">pytest_html</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">pluginmanager</span><span class="o">.</span><span class="n">getplugin</span><span class="p">(</span><span class="s1">'html'</span><span class="p">)</span>
    <span class="n">outcome</span> <span class="o">=</span> <span class="k">yield</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">outcome</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="s1">'extra'</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="n">report</span><span class="o">.</span><span class="n">when</span> <span class="o">==</span> <span class="s1">'call'</span><span class="p">:</span>
        <span class="c1"># always add url to report</span>
        <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pytest_html</span><span class="o">.</span><span class="n">extras</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="s1">'http://www.example.com/'</span><span class="p">))</span>
        <span class="n">xfail</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="s1">'wasxfail'</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">skipped</span> <span class="ow">and</span> <span class="n">xfail</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">failed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">xfail</span><span class="p">):</span>
            <span class="c1"># only add additional html on failure</span>
            <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pytest_html</span><span class="o">.</span><span class="n">extras</span><span class="o">.</span><span class="n">html</span><span class="p">(</span><span class="s1">'&lt;div&gt;Additional HTML&lt;/div&gt;'</span><span class="p">))</span>
        <span class="n">report</span><span class="o">.</span><span class="n">extra</span> <span class="o">=</span> <span class="n">extra</span>
</pre>
</div>
</div></body></html>