<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-pholcidae---tiny-python-web-crawler" class="anchor" href="#pholcidae---tiny-python-web-crawler" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>PHOLCIDAE - Tiny python web crawler</h1>

<h2><a id="user-content-pholcidae" class="anchor" href="#pholcidae" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Pholcidae</h2>

<p>Pholcidae, commonly known as cellar spiders, are a spider family in the suborder Araneomorphae.</p>

<h2><a id="user-content-about" class="anchor" href="#about" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>About</h2>

<p>Pholcidae is a tiny Python module allows you to write your own crawl spider fast and easy.</p>

<p><em>View end of README to read about changes in v. 2.0</em></p>

<h2><a id="user-content-dependencies" class="anchor" href="#dependencies" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Dependencies</h2>



<h2><a id="user-content-basic-example" class="anchor" href="#basic-example" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Basic example</h2>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> pholcidae2 <span class="pl-k">import</span> Pholcidae

<span class="pl-k">class</span> <span class="pl-en">MySpider</span>(<span class="pl-e">Pholcidae</span>):

    <span class="pl-k">def</span> <span class="pl-en">crawl</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">data</span>):
        <span class="pl-c1">print</span>(data.url)

settings <span class="pl-k">=</span> {<span class="pl-s"><span class="pl-pds">'</span>domain<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>www.test.com<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>start_page<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>/sitemap/<span class="pl-pds">'</span></span>}

spider <span class="pl-k">=</span> MySpider()
spider.extend(settings)
spider.start()</pre></div>

<h2><a id="user-content-allowed-settings" class="anchor" href="#allowed-settings" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Allowed settings</h2>

<p>Settings must be passed as dictionary to <code>extend</code> method of the crawler.</p>

<p>Params you can use:</p>

<p><strong>Required</strong></p>

<ul>
<li><strong>domain</strong> <em>string</em> - defines domain which pages will be parsed. Defines without trailing slash.</li>
</ul>

<p><strong>Additional</strong></p>

<ul>
<li><strong>start_page</strong> <em>string</em> - URL which will be used as entry point to parsed site. Default: <code>/</code></li>
<li><strong>protocol</strong> <em>string</em> - defines protocol to be used by crawler. Default: <code>http://</code></li>
<li><strong>stay_in_domain</strong> <em>bool</em> - defines ability of crawler to leave passed domain to crawl out-of-domain pages. Default: <code>True</code></li>
<li><strong>valid_links</strong> <em>list</em> - list of regular expression strings (or full URLs), which will be used to filter site URLs to be passed to <code>crawl()</code> method. Default: <code>['(.*)']</code></li>
<li><strong>append_to_links</strong> <em>string</em> - text to be appended to each link before fetching it. Default: <code>''</code></li>
<li><strong>exclude_links</strong> <em>list</em> - list of regular expression strings (or full URLs), which will be used to filter site URLs which must not be checked at all. Default: <code>[]</code></li>
<li><strong>cookies</strong> <em>dict</em> - a dictionary of string key-values which represents cookie name and cookie value to be passed with site URL request. Default: <code>{}</code></li>
<li><strong>headers</strong> <em>dict</em> - a dictionary of string key-values which represents header name and value value to be passed with site URL request. Default: <code>{}</code></li>
<li><strong>follow_redirects</strong> <em>bool</em> - allows crawler to bypass 30x headers and not follow redirects. Default: <code>True</code></li>
<li><strong>precrawl</strong> <em>string</em> - name of function which will be called before start of crawler. Default: <code>None</code></li>
<li><strong>postcrawl</strong> <em>string</em> - name of function which will be called after the end crawlering. Default: <code>None</code></li>
<li><strong>callbacks</strong> <em>dict</em> - a dictionary of key-values which represents URL pattern from <code>valid_links</code> dict and string name of self defined method to get parsed data. Default: <code>{}</code></li>
<li><strong>proxy</strong> <em>dict</em> - a dictionary mapping protocol names to URLs of proxies, e.g., {'http': 'http://user:passwd@host:port'}. Default: <code>{}</code></li>
</ul>

<p>New in 2.0: </p>

<ul>
<li><strong>silent_links</strong> <em>list</em> - list of regular expression strings (or full URLs), which will be used to filter site URLs which must not pass page data to callback function, yet still collect URLs from this page. Default: <code>[]</code></li>
<li><strong>valid_mimes</strong> <em>list</em> - list of strings representing valid MIME types. Only URLs that can be identified with this MIME types will be parsed. Default: <code>[]</code></li>
<li><strong>threads</strong> <em>int</em> - number of cuncurrent threads of pages fetchers. Default: <code>1</code></li>
<li><strong>with_lock</strong> <em>bool</em> - wheither use or not lock while URLs sync. It slightly decreases crawling speed but enliminates race condicitons. Default: <code>True</code></li>
<li><strong>hashed</strong> <strong>bool</strong> - wheither or not store parsed URLs as shortened SHA1 hashes. Crawler may run a little bit slower but consumes a lot less memory. Default: <code>False</code></li>
</ul>

<h2><a id="user-content-response-attributes" class="anchor" href="#response-attributes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Response attributes</h2>

<p>While inhrerit Pholcidae class you can override built-in <code>crawl()</code> method to retreive data gathered from page. Any response object will contain some attributes depending on successfulness of page parsing.</p>

<p><strong>Successfull parsing</strong></p>

<ul>
<li><strong>body</strong> <em>string</em> - raw HTML/XML/XHTML etc. representation of page.</li>
<li><strong>url</strong> <em>string</em> - URL of parsed page.</li>
<li><strong>headers</strong> <em>AttrDict</em> - dictionary of response headers.</li>
<li><strong>cookies</strong> <em>AttrDict</em> - dictionary of response cookies.</li>
<li><strong>status</strong> <em>int</em> - HTTP status of response (e.g. 200).</li>
<li><strong>match</strong> <em>list</em> - matched part from valid_links regex.</li>
</ul>

<p><strong>Unsuccessfull parsing</strong></p>

<ul>
<li><strong>body</strong> <em>string</em> - raw representation of error.</li>
<li><strong>status</strong> <em>int</em> - HTTP status of response (e.g. 200). Default: 500</li>
<li><strong>url</strong> <em>string</em> - URL of parsed page.</li>
</ul>

<h2><a id="user-content-example" class="anchor" href="#example" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Example</h2>

<p>See <code>test.py</code></p>

<h2><a id="user-content-note" class="anchor" href="#note" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Note</h2>

<p>Pholcidae does not contain any built-in XML, XHTML, HTML or other parser. You can manually add any response body parsing methods using any available python libraries you want.</p>

<h2><a id="user-content-20-vs-1x" class="anchor" href="#20-vs-1x" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>2.0 vs 1.x</h2>

<p>Major changes have been made in version 2.0:</p>

<ul>
<li>All code has been completely rewritten from scratch</li>
<li>Less abstractions = more speed</li>
<li>Threads support</li>
<li>Matches in page data are now list and not optional</li>
</ul>

<p>There are some minor code changes which breaks backward code compatibility between version 1.x and 2.0:</p>

<ul>
<li>You need to explicitly pass settings to <code>extend</code> method of your crawler</li>
<li>Option <code>autostart</code> has been removed. You must call <code>spider.srart()</code> explisitly</li>
<li>Module is now called <code>pholcidae2</code></li>
</ul>
</article>
  </div></body></html>