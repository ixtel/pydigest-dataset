<html><body><div><div class="section" id="construct">
<h1>Construct<a class="headerlink" href="#construct" title="Permalink to this headline">¶</a></h1>
<p>Construct is a powerful <strong>declarative</strong> parser (and builder) for binary data.</p>
<p>Instead of writing <em>imperative code</em> to parse a piece of data, you declaratively
define a <em>data structure</em> that describes your data. As this data structure is not
code, you can use it in one direction to <em>parse</em> data into Pythonic objects,
and in the other direction, convert (“build”) objects into binary data.</p>
<p>The library provides both simple, atomic constructs (such as integers of various sizes),
as well as composite ones which allow you form hierarchical structures of increasing complexity.
Construct features <strong>bit and byte granularity</strong>, easy debugging and testing, an
<strong>easy-to-extend subclass system</strong>, and lots of primitive constructs to make your
work easier:</p>
<ul class="simple">
<li>Fields: raw bytes or numerical types</li>
<li>Structs and Sequences: combine simpler constructs into more complex ones</li>
<li>Adapters: change how data is represented</li>
<li>Arrays/Ranges: duplicate constructs</li>
<li>Meta-constructs: use the context (history) to compute the size of data</li>
<li>If/Switch: branch the computational path based on the context</li>
<li>On-demand (lazy) parsing: read only what you require</li>
<li>Pointers: jump from here to there in the data stream</li>
</ul>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal"><span class="pre">PascalString</span></code> is a string prefixed by its length:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">construct</span> <span class="kn">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PascalString</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="s">"PascalString"</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">UBInt8</span><span class="p">(</span><span class="s">"length"</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">Bytes</span><span class="p">(</span><span class="s">"data"</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ctx</span><span class="o">.</span><span class="n">length</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PascalString</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">"</span><span class="se">\x05</span><span class="s">helloXXX"</span><span class="p">)</span>
<span class="go">Container({'length': 5, 'data': 'hello'})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PascalString</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">Container</span><span class="p">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="s">"foobar"</span><span class="p">))</span>
<span class="go">'\x06foobar'</span>
</pre></div>
</div>
<p>Instead of specifying the length manually, let’s use an adapter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">PascalString2</span> <span class="o">=</span> <span class="n">ExprAdapter</span><span class="p">(</span><span class="n">PascalString</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">encoder</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">obj</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Container</span><span class="p">(</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">obj</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">decoder</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">obj</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PascalString2</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">"</span><span class="se">\x05</span><span class="s">hello"</span><span class="p">)</span>
<span class="go">'hello'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PascalString2</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">"i'm a long string"</span><span class="p">)</span>
<span class="go">"\x11i'm a long string"</span>
</pre></div>
</div>
<p>See more examples of <a class="reference external" href="https://github.com/construct/construct/tree/master/construct/formats">file formats</a>
and <a class="reference external" href="https://github.com/construct/construct/tree/master/construct/protocols">network protocols</a>
in the repository.</p>
</div>

<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>Construct should run on any Python 2.5-3.3 implementation.</p>
<p>Its only requirement is <a class="reference external" href="http://pypi.python.org/pypi/six">six</a>, which is used to overcome the
differences between Python 2 and 3.</p>
</div>
</div>
</div></body></html>