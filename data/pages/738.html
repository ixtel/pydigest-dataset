<html><body><div><div class="content html_format">
      <h5>0. Вступление</h5>
<p>
Доброго времени суток, Хабр!</p><p>
Началось всё с того, что у меня возникла необходимость сделать </p><a href="http://yadi.sk/d/2c2QD5ZaMXHQR">GUI-установщик для Django под Windows</a><p>. Не увидев на хабре какой-либо статьи, описывающей создание установщиков, я подумал, «А почему бы и нет»? Из сообщества Django по этому вопросу мне ответили приблизительно так, как это сделал хабраюзер </p><a href="https://habrahabr.ru/users/ffriend/" class="user_link">ffriend</a><p>. Спасибо ему за конструктивность и открытость. Подробности под катом.
</p><a name="habracut"/><p>
Вот такое письмо пришло мне от сообщества Django в ответ на </p><a href="http://habrahabr.ru/company/SECL_GROUP/blog/218921/#comment_7486371">моё фи</a><p>. Собственно говоря, именно из-за этого фи я и оказался в минусе по репутации с рейтингом.</p><div class="spoiler"><b class="spoiler_title">Текст</b><p class="spoiler_text">Hi Ivan,<br/>
<br/>
Thanks for the suggestion.<br/>
<br/>
The contact form you've used is for the DSF — we're the fund raising<br/>
arm and legal arm of the Django project.<br/>
<br/>
If you've got ideas for how Django can be improved, you should direct<br/>
those ideas to the django-developers mailing list, or open a ticket on<br/>
Django's ticket tracker.<br/>
<br/>
Better still, try your hand at implementing the features you want to<br/>
see, and provide those changes as a patch against the Django codebase.<br/>
If you can provide a better user experience for Windows or Cyrillic<br/>
users, we may integrate those changes into the core product.<br/>
<br/>
Yours,<br/>
Russ Magee %-)</p></div><p>Сразу скажу, как не надо делать. Не надо пытаться пользоваться ограниченной редакцией InstallShield, прилагаемой бонусом к MSVS Pro 2013. </p><p>
Быть может, в отдельных простых случаях он подходит более чем, но в моём был желателен как можно больший контроль над процессом, и когда я открыл InstallShield и стал разбирать его по косточкам — последний меня разочаровал своей ограниченностью.</p><p>
К счастью, на этом свете существует </p><a href="http://nsis.sourceforge.net/Main_Page">NSIS</a><p> – NullSoft Install System, а именно – скриптовый генератор установщиков с возможностями, радующими глаз:</p><div class="spoiler"><b class="spoiler_title">Посмотреть список</b><div class="spoiler_text"><ul>
<li>Поддержка ZLIB, BZIP2 и LZMA (файлы могут быть сжаты вместе или по отдельности).</li>
<li>Генерация программ удаления.</li>
<li>Настраиваемый пользовательский интерфейс: диалоги, шрифты, фоны, иконки, текст, галочки, изображения и т.д.</li>
<li>Классический и современный интерфейсы мастеров.</li>
<li>Поддержка нескольких языков в одной установке. Более 60 переводов доступны, но вы также можете создавать свои собственные. Поддержка unicode позволяет использовать ещё больше языков.</li>
<li>Постраничная логика организации: вы можете добавить стандартные страницы мастера или создать собственные.</li>
<li>Дерево для выбора компонентов установки.</li>
<li>Возможность определить конфигурации: обычно минимальная, типовая и полная установки, а также возможно создать пользовательскую конфигурацию.</li>
<li>Самопроверка CRC32.</li>
<li>Малые расходы на сжатие, а именно — 34 Кб с параметрами по умолчанию.</li>
<li>Возможность отображения лицензионного соглашения RTF или TXT.</li>
<li>Возможность выявлять каталог назначения из реестра.</li>
<li>Много плагинов для создания пользовательских диалогов, интернет-соединений, HTTP-скачивания, модификация файлов, вызовы WinAPI и т.д.</li>
<li>Монтажники может быть как 2 Гб.</li>
<li>Дополнительный тихий режим для автоматизированных установок.</li>
<li>Препроцессор с поддержкой определенных символов, макросов, условной компиляции, стандартных предопределений.</li>
<li>Кодирование с элементами PHP и include ( включают в себя пользовательские переменные, стек, реальное управление потоком.</li>
</ul>

<h6>Установщики имеют свои собственные виртуальные машины, которые позволяют следующее</h6>
<ul>
<li>Извлечение файлов с настраиваемыми параметрами перезаписи.</li>
<li>Копирование файлов и каталогов, переименование, удаление, поиск.</li>
<li>Плагин для вызова DLL.</li>
<li>Регистрация DLL, ActiveX, снятие с регистрации.</li>
<li>Оболочка исполнения с возможностью ожидания выполнения операций.</li>
<li>Создание ярлыка.</li>
<li>Работать с реестром.</li>
<li>Чтение и запись INI.</li>
<li>Чтение и запись общего текстового файла.</li>
<li>Гибкие манипуляции с целыми и строковыми значениями.</li>
<li>Открытие окна на основе имени класса или его названия.</li>
<li>Манипуляции с пользовательским интерфейсом: шрифт, установка текста.</li>
<li>Окно отправки сообщений.</li>
<li>Взаимодействие пользователей с окнами сообщений или страницами.</li>
<li>Ветвление, сравнение и прочее в этом духе.</li>
<li>Возможность контроля над ситуацией при возникновении ошибок.</li>
<li>Перезагрузка, в том числе удаление или переименование при перезагрузке.</li>
<li>Команды поведение установщика. Например, «показать», «скрыть», «ожидать».</li>
<li>Пользовательские функции в скрипте.</li>
<li>Функции обратного вызова для действий пользователя.</li>
</ul></div></div><p>Этот список взят из </p><a href="http://nsis.sourceforge.net/Docs/Chapter1.html#1.3">относительно полной документации на sourceforge</a><p>, тогда как в штатном пакете присутствуют лишь общие сведения о генераторе и его языке, о чём и сказано в соответствующем файле справки. </p><p>
К моему удивлению, на sf не оказалось ссылки на архив с этой самой полной документацией. Эту оплошность</p><a href="http://yadi.sk/d/GAt5QzXWMXKXc"> исправил самостоятельно</a><p>.</p><p>
Вместе с тем существует </p><a href="http://nsis.sourceforge.net/Category:Tutorials">архив с набором «простых руководств»</a><p> по реализации конкретных фич, который до этого приходилось качать через сторонний файловый хостинг сторонней же программой. </p><a href="http://yadi.sk/d/Qdqb3VEpMXK9Y">Исправлен и этот недочёт</a><p>.</p><p>
Существует великое множество – простите за каламбур – генераторов скрипта генератора на основе GUI (из опробованных наилучшим оказался </p><a href="http://hmne.sourceforge.net/">HM NIS Edit</a><p>), но вместе с тем существует </p><a href="http://programming-motherfucker.com">только лишь одна методика продуктивного обучения</a><p> языкам…

</p><h5>1. Итак...</h5>
<p>
Простейший код, не требующий особенных пояснений, для первого знакомства с общими принципами:
</p><div class="spoiler"><b class="spoiler_title">Познакомиться</b><div class="spoiler_text"><blockquote><ol>
<li><font># define installer name</font></li>
<li><font>OutFile</font> <font>"installer.exe"</font></li>
<li> </li>
<li><font># set desktop as install directory</font></li>
<li><font>InstallDir</font> <font>$DESKTOP</font></li>
<li> </li>
<li><font># default section start</font></li>
<li><font>Section</font></li>
<li> </li>
<li><font># define output path</font></li>
<li><font>SetOutPath</font> <font>$INSTDIR</font></li>
<li> </li>
<li><font># specify file to go in output path</font></li>
<li><font>File</font> test.txt</li>
<li> </li>
<li><font># define uninstaller name</font></li>
<li><font>WriteUninstaller</font> <font>$INSTDIR</font>\uninstaller.exe</li>
<li> </li>
<li> </li>
<li><font>#-------</font></li>
<li><font># default section end</font></li>
<li><font>SectionEnd</font></li>
<li> </li>
<li><font># create a section to define what the uninstaller does.</font></li>
<li><font># the section will always be named "Uninstall"</font></li>
<li><font>Section</font> <font>"Uninstall"</font></li>
<li> </li>
<li><font># Always delete uninstaller first</font></li>
<li><font>Delete</font> <font>$INSTDIR</font>\uninstaller.exe</li>
<li> </li>
<li><font># now delete installed file</font></li>
<li><font>Delete</font> <font>$INSTDIR</font>\test.txt</li>
<li> </li>
<li><font>SectionEnd</font></li>
</ol></blockquote></div></div><p>Да, я ленивый, использовал копипасту </p><a href="http://nsis.sourceforge.net/Examples/bigtest.nsi">отсюда</a><p>, адаптируя оную под свои нужды.</p><p>
Кстати, у НЛО не нашлось подсветки nsi, поэтому был использован </p><a href="http://highlight.hohli.com">highlight.hohli.com</a><p>, возможно, эта информация окажется полезной.</p><p>
Я не разбираюсь в тонкостях питона, но судя по файлу setup.py в Django-1.6.2 при установке работа идёт только и только с путями в той или иной системе.</p><div class="spoiler"><b class="spoiler_title">Код setup.py в Django</b><div class="spoiler_text"><pre><code class="python">import os
import sys

from distutils.core import setup
from distutils.sysconfig import get_python_lib

# Warn if we are installing over top of an existing installation. This can
# cause issues where files that were deleted from a more recent Django are
# still present in site-packages. See #18115.
overlay_warning = False
if "install" in sys.argv:
    lib_paths = [get_python_lib()]
    if lib_paths[0].startswith("/usr/lib/"):
        # We have to try also with an explicit prefix of /usr/local in order to
        # catch Debian's custom user site-packages directory.
        lib_paths.append(get_python_lib(prefix="/usr/local"))
    for lib_path in lib_paths:
        existing_path = os.path.abspath(os.path.join(lib_path, "django"))
        if os.path.exists(existing_path):
            # We note the need for the warning here, but present it after the
            # command is run, so it's more likely to be seen.
            overlay_warning = True
            break


def fullsplit(path, result=None):
    """
    Split a pathname into components (the opposite of os.path.join)
    in a platform-neutral way.
    """
    if result is None:
        result = []
    head, tail = os.path.split(path)
    if head == '':
        return [tail] + result
    if head == path:
        return result
    return fullsplit(head, [tail] + result)


EXCLUDE_FROM_PACKAGES = ['django.conf.project_template',
                         'django.conf.app_template',
                         'django.bin']


def is_package(package_name):
    for pkg in EXCLUDE_FROM_PACKAGES:
        if package_name.startswith(pkg):
            return False
    return True


# Compile the list of packages available, because distutils doesn't have
# an easy way to do this.
packages, package_data = [], {}

root_dir = os.path.dirname(__file__)
if root_dir != '':
    os.chdir(root_dir)
django_dir = 'django'

for dirpath, dirnames, filenames in os.walk(django_dir):
    # Ignore PEP 3147 cache dirs and those whose names start with '.'
    dirnames[:] = [d for d in dirnames if not d.startswith('.') and d != '__pycache__']
    parts = fullsplit(dirpath)
    package_name = '.'.join(parts)
    if '__init__.py' in filenames and is_package(package_name):
        packages.append(package_name)
    elif filenames:
        relative_path = []
        while '.'.join(parts) not in packages:
            relative_path.append(parts.pop())
        relative_path.reverse()
        path = os.path.join(*relative_path)
        package_files = package_data.setdefault('.'.join(parts), [])
        package_files.extend([os.path.join(path, f) for f in filenames])


# Dynamically calculate the version based on django.VERSION.
version = __import__('django').get_version()


setup(
    name='Django',
    version=version,
    url='http://www.djangoproject.com/',
    author='Django Software Foundation',
    author_email='foundation@djangoproject.com',
    description=('A high-level Python Web framework that encourages '
                 'rapid development and clean, pragmatic design.'),
    license='BSD',
    packages=packages,
    package_data=package_data,
    scripts=['django/bin/django-admin.py'],
    classifiers=[
        'Development Status :: 5 - Production/Stable',
        'Environment :: Web Environment',
        'Framework :: Django',
        'Intended Audience :: Developers',
        'License :: OSI Approved :: BSD License',
        'Operating System :: OS Independent',
        'Programming Language :: Python',
        'Programming Language :: Python :: 2',
        'Programming Language :: Python :: 2.6',
        'Programming Language :: Python :: 2.7',
        'Programming Language :: Python :: 3',
        'Programming Language :: Python :: 3.2',
        'Programming Language :: Python :: 3.3',
        'Topic :: Internet :: WWW/HTTP',
        'Topic :: Internet :: WWW/HTTP :: Dynamic Content',
        'Topic :: Internet :: WWW/HTTP :: WSGI',
        'Topic :: Software Development :: Libraries :: Application Frameworks',
        'Topic :: Software Development :: Libraries :: Python Modules',
    ],
)

if overlay_warning:
    sys.stderr.write("""

========
WARNING!
========

You have just installed Django over top of an existing
installation, without removing it first. Because of this,
your install may now include extraneous files from a
previous version that have since been removed from
Django. This is known to cause a variety of problems. You
should manually remove the

%(existing_path)s

directory and re-install Django.

""" % {"existing_path": existing_path})
</code></pre></div></div><p>Я не разбираюсь в питоне, но в общем и целом видно, что здесь происходит работа с путями в зависимости от оси, проверка, не идёт ли установка поверх существующей Django и в setup(), по-видимому, содержится информация для пакета python в целом. </p><p>
К тому же, файл INSTALL утверждает:
</p><blockquote>AS AN ALTERNATIVE, you can just copy the entire «django» directory to Python's<br/>
site-packages directory, which is located wherever your Python installation<br/>
lives. Some places you might check are:<br/>
<br/>
/usr/lib/python2.7/site-packages (Unix, Python 2.7)<br/>
 /usr/lib/python2.6/site-packages (Unix, Python 2.6)<br/>
 C:\\PYTHON\site-packages (Windows)</blockquote><p>
Однако именно из-за того, что я не знаю питон, предпочёл более кошерное применение setup.py, так как доподлинно мне не известно, чем отзовётся отсутствие setup(). Вот, что получилось у меня после адаптации bigtest.nsi. В комментариях особо отмечены места, которые не оказываются интуитивно понятными, с которыми пришлось повозиться, пока всё пошло, как нужно.</p><div class="spoiler"><b class="spoiler_title">Полный код скрипта установщика</b><div class="spoiler_text"><blockquote><ol>
<li><font>!include</font> <font>"Include\LogicLib.nsh"</font></li>
<li> </li>
<li><font>OutFile</font> <font>"installer.exe"</font></li>
<li><font>Name</font> <font>"Django 1.6.2"</font></li>
<li><font>Caption</font> <font>"Django 1.6.2"</font></li>
<li><font>Icon</font> <font>"${NSISDIR}\Contrib\Graphics\Icons\nsis1-install.ico"</font></li>
<li><font>CRCCheck</font> <font>on</font></li>
<li><font>SilentInstall</font> <font>normal</font></li>
<li><font>BGGradient</font> 000000 0000FF FFFFFF</li>
<li><font>InstallColors</font> FF8080 000030</li>
<li><font>XPStyle</font> <font>on</font></li>
<li><font>InstallDir</font> <font>$EXEDIR</font> <font>/* Обеспечиввает установку по умолчанию туда, куда был сохранён установщик */</font></li>
<li><font>SetFont</font> <font>"Tahoma"</font> <font>10</font> <font>/* Нравится мне этот шрифт и всё тут */</font></li>
<li><font>SetOverWrite</font> <font>on</font></li>
<li><font>#-NonSectionInstructionsEnd-</font></li>
<li><font>Section</font> <font>"BaseInstructions"</font></li>
<li><font>SetDatablockOptimize</font> <font>on</font></li>
<li><font>/* Без установки выходного пути для файлов установщик ругался</font></li>
<li><font>на невозможность записи уже во время выполнения,</font></li>
<li><font>хотя кажется, что необходимо достаточно InstallDir */</font></li>
<li><font>SetOutPath</font> <font>"$INSTDIR\*"</font> </li>
<li><font>SetOverWrite</font> <font>on</font></li>
<li><font>File</font> <font>/r</font> <font>"C:\ins\Django-1.6.2\*"</font> <font>/* Та папка, в которой у меня лежал Django.</font></li>
<li><font>Именно так можно включить в установщик нужные файлы */</font></li>
<li><font>SectionEnd</font></li>
<li> </li>
<li>RequestExecutionLevel highest <font>/* От греха подальше... */</font></li>
<li><font>CheckBitmap</font> <font>"${NSISDIR}\Contrib\Graphics\Checks\classic-cross.bmp"</font></li>
<li><font>LicenseText</font> <font>"Django license"</font></li>
<li><font>LicenseData</font> <font>"license.rtf"</font> <font>/* Отделался... лень =) */</font></li>
<li> </li>
<li><font>/* "Сколько языков ты знаешь, столько раз ты человек" =)</font></li>
<li><font>NSIDIR, как можно понять, папка установки генератора.</font></li>
<li><font>Весь язык сам по себе замечателен интуитивной понятностью */</font></li>
<li> </li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\English.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\Dutch.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\French.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\German.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\Korean.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"Russian.nlf"</font> <font>/* Слегка подправленный файл перевода на родной */</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\Spanish.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\Swedish.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\TradChinese.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\SimpChinese.nlf"</font></li>
<li><font>LoadLanguageFile</font> <font>"${NSISDIR}\Contrib\Language files\Slovak.nlf"</font></li>
<li> </li>
<li><font>; Set name using the normal interface (Name command)</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_ENGLISH<font>}</font></font> <font>"English"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_DUTCH<font>}</font></font> <font>"Dutch"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_FRENCH<font>}</font></font> <font>"French"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_GERMAN<font>}</font></font> <font>"German"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_KOREAN<font>}</font></font> <font>"Korean"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_RUSSIAN<font>}</font></font> <font>"Russian"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_SPANISH<font>}</font></font> <font>"Spanish"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_SWEDISH<font>}</font></font> <font>"Swedish"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_TRADCHINESE<font>}</font></font> <font>"Traditional Chinese"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_SIMPCHINESE<font>}</font></font> <font>"Simplified Chinese"</font></li>
<li><font>LangString</font> <font>Name</font> <font>$<font>{</font>LANG_SLOVAK<font>}</font></font> <font>"Slovak"</font></li>
<li> </li>
<li><font>; Directly change the inner lang strings (Same as ComponentText)</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_ENGLISH<font>}</font></font> <font>"English component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_DUTCH<font>}</font></font> <font>"Dutch component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_FRENCH<font>}</font></font> <font>"French component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_GERMAN<font>}</font></font> <font>"German component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_KOREAN<font>}</font></font> <font>"Korean component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_RUSSIAN<font>}</font></font> <font>"Russian component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_SPANISH<font>}</font></font> <font>"Spanish component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_SWEDISH<font>}</font></font> <font>"Swedish component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_TRADCHINESE<font>}</font></font> <font>"Traditional Chinese component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_SIMPCHINESE<font>}</font></font> <font>"Simplified Chinese component page"</font></li>
<li><font>LangString</font> ^ComponentsText <font>$<font>{</font>LANG_SLOVAK<font>}</font></font> <font>"Slovak component page"</font></li>
<li> </li>
<li><font>; A LangString for the section name</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_ENGLISH<font>}</font></font> <font>"English section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_DUTCH<font>}</font></font> <font>"Dutch section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_FRENCH<font>}</font></font> <font>"French section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_GERMAN<font>}</font></font> <font>"German section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_KOREAN<font>}</font></font> <font>"Korean section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_RUSSIAN<font>}</font></font> <font>"Russian section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_SPANISH<font>}</font></font> <font>"Spanish section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_SWEDISH<font>}</font></font> <font>"Swedish section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_TRADCHINESE<font>}</font></font> <font>"Trandional Chinese section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_SIMPCHINESE<font>}</font></font> <font>"Simplified Chinese section #1"</font></li>
<li><font>LangString</font> Sec1Name <font>$<font>{</font>LANG_SLOVAK<font>}</font></font> <font>"Slovak section #1"</font></li>
<li> </li>
<li> </li>
<li> </li>
<li><font>;--------------------------------</font></li>
<li> </li>
<li><font>Function</font> <font>.onInit</font></li>
<li> </li>
<li> <font>;Language selection dialog</font></li>
<li> </li>
<li> <font>Push</font> <font>""</font></li>
<li> <font>Push</font> <font>$<font>{</font>LANG_ENGLISH<font>}</font></font></li>
<li> <font>Push</font> English</li>
<li> <font>Push</font> <font>$<font>{</font>LANG_DUTCH<font>}</font></font></li>
<li> <font>Push</font> Dutch</li>
<li> <font>Push</font> <font>$<font>{</font>LANG_FRENCH<font>}</font></font></li>
<li> <font>Push</font> French</li>
<li> <font>Push</font> <font>$<font>{</font>LANG_GERMAN<font>}</font></font></li>
<li> <font>Push</font> German</li>
<li> <font>Push</font> <font>$<font>{</font>LANG_KOREAN<font>}</font></font></li>
<li> <font>Push</font> Korean</li>
<li> <font>Push</font> <font>$<font>{</font>LANG_RUSSIAN<font>}</font></font></li>
<li> <font>Push</font> Russian</li>
<li> <font>Push</font> <font>$<font>{</font>LANG_SPANISH<font>}</font></font></li>
<li> <font>Push</font> Spanish</li>
<li> <font>Push</font> <font>$<font>{</font>LANG_SWEDISH<font>}</font></font></li>
<li> <font>Push</font> Swedish</li>
<li> <font>Push</font> <font>$<font>{</font>LANG_TRADCHINESE<font>}</font></font></li>
<li> <font>Push</font> <font>"Traditional Chinese"</font></li>
<li> <font>Push</font> <font>$<font>{</font>LANG_SIMPCHINESE<font>}</font></font></li>
<li> <font>Push</font> <font>"Simplified Chinese"</font></li>
<li> <font>Push</font> <font>$<font>{</font>LANG_SLOVAK<font>}</font></font></li>
<li> <font>Push</font> Slovak</li>
<li> <font>Push</font> A <font>; A means auto count languages</font></li>
<li>        <font>; for the auto count to work the first empty push (Push "") must remain</font></li>
<li> <font>LangDLL</font>::<font>LangDialog </font><font>"Installer Language"</font> <font>"Please select the language of the installer"</font></li>
<li> </li>
<li> <font>Pop</font> <font>$LANGUAGE</font></li>
<li> <font>StrCmp</font> <font>$LANGUAGE</font> <font>"cancel"</font> <font>0</font> +<font>2</font></li>
<li> <font>Abort</font></li>
<li><font>FunctionEnd</font></li>
<li> </li>
<li><font>;--------------------------------</font></li>
<li> </li>
<li><font>;--------------------------------</font></li>
<li> </li>
<li><font>Page</font> <font>license</font></li>
<li><font>Page</font> <font>directory</font></li>
<li><font>Page</font> <font>instfiles</font></li>
<li> </li>
<li><font>AutoCloseWindow</font> <font>false</font></li>
<li><font>ShowInstDetails</font> <font>show</font></li>
<li> </li>
<li><font>Function</font> <font>"FinalStage"</font></li>
<li><font>MessageBox</font> <font>MB_OK</font> <font>"Close window and see on your screen... Thanks!"</font></li>
<li><font>FunctionEnd</font></li>
<li> </li>
<li><font>/* Обратите внимаание на обёртку. Казалось бы, что должно</font></li>
<li><font>сработать без секции, просто вызов и на этом закончили, но нет... :( */</font></li>
<li><font>Section</font> <font>"Final"</font></li>
<li><font>Call</font> <font>"FinalStage"</font></li>
<li><font>SectionEnd</font></li>
<li> </li>
<li><font>Function</font> <font>.onGUIEnd</font> <font>/* Есть и другие колбэки */</font></li>
<li><font>ClearErrors</font></li>
<li><font>/* При чистой установке можно было обойтись</font></li>
<li><font>копированием django в site-packages, однако использование setup.py</font></li>
<li><font>мне показалось более кошерным, учитывая мета-информацию. Я питон не знаю</font></li>
<li><font>и значит не знаю, где и как аукнется отсутствие вызова setup(). */</font></li>
<li><font>FileOpen</font> <font>$0</font> <font>$INSTDIR</font>\installer.bat w</li>
<li><font>IfErrors</font> done</li>
<li><font>FileWrite</font> <font>$0</font> <font>"cd $INSTDIR $\npython setup.py install"</font> <font>/* Абракадабра с регистрами мне не всегда нравится */</font></li>
<li><font>/*Здесь нужно отметить, что добавление в батник чего-то вроде del /Q $INSTDIR\installer.bat к хорошему не приводит.</font></li>
<li><font>Буду благодарен, если мне подскажут, почему так происходит, ибо это не нагуглишь и интуитивно представляется,</font></li>
<li><font>что если уж команда запустилась, то наличие или отсутствие файла с командой роли не играет, ан нет же...*/</font></li>
<li><font>FileClose</font> <font>$0</font></li>
<li>done:</li>
<li><font>Exec</font> <font>"$INSTDIR\installer.bat"</font></li>
<li><font>FunctionEnd</font></li>
<li> </li>
<li><font>/* Можно было бы сделать страницу с выбором папки питона, на случай, если питон не прописан в PATH -</font></li>
<li><font>именно так было бы идеально, но я не маньяк-перфекционист и сделаю это, только если вдруг установщик</font></li>
<li><font>кому-то понравится и мне будет указано на недочёт. */</font></li>
</ol></blockquote></div></div><p>А ниже — скрин одного из результатов при обкатывании генератора.</p><img src="https://habrastorage.org/getpro/habr/post_images/1d2/f0d/761/1d2f0d7611ab22a9235bf56825b94bf0.jpg"/>
<p>
Осталось только вторично достучаться до сообщества Django и сделать мелочи типа указания версии, имени файла и т.п…</p><p>
Надеюсь, что этот пост оказался кому-то полезным и достаточно информативным.

      
      </p><p class="clear"/>
    </div>

    
  </div></body></html>