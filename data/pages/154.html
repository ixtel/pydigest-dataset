<html><body><div><div class="postbox">
            <h1>Extract text from Word files (docx) simply</h1><small><time class="published" datetime="2013-11-26T10:01:59+00:00">Nov 26, 2013</time> <a class="tag" href="../../categories/python/"><span class="badge badge-info">Python</span></a></small>
            <div>
              <p>If you want to extract the text content of a Word file there are a few <a class="reference external" href="http://stackoverflow.com/questions/42482/best-way-to-extract-text-from-a-word-doc-without-using-com-automation">solutions</a> to do this in Python. Unfortunately most of these solutions have dependencies or need to run an external command in a subprocess or are heavy/complex, using an office suite, etc. I find that the best solution among those in the Stackoverflow page is <a class="reference external" href="https://github.com/mikemaccana/python-docx">python-docx</a>. But using it bring two dependencies: <em>python-docx</em> itself and <a class="reference external" href="http://lxml.de/">lxml</a>. Installing <em>python-docx</em> is not a big problem. Unfortunately <em>lxml</em> is sometimes hard to install or, at the minimum, requires compilation.</p>
              <p>To avoid that, inspired by <em>python-docx</em>, I created a simple function to extract text from <em>.docx</em> files that do not require dependencies, using only the standard library. So itâ€™s easy to incorporate it in any Python project.</p>
              <p>Is there any way to improve it?</p>
              <noscript>
              <pre class="literal-block">
try:
    from xml.etree.cElementTree import XML
except ImportError:
    from xml.etree.ElementTree import XML
import zipfile


"""
Module that extract text from MS XML Word document (.docx).
(Inspired by python-docx &lt;https://github.com/mikemaccana/python-docx&gt;)
"""

WORD_NAMESPACE = '{http://schemas.openxmlformats.org/wordprocessingml/2006/main}'
PARA = WORD_NAMESPACE + 'p'
TEXT = WORD_NAMESPACE + 't'


def get_docx_text(path):
    """
    Take the path of a docx file as argument, return the text in unicode.
    """
    document = zipfile.ZipFile(path)
    xml_content = document.read('word/document.xml')
    document.close()
    tree = XML(xml_content)

    paragraphs = []
    for paragraph in tree.getiterator(PARA):
        texts = [node.text
                 for node in paragraph.getiterator(TEXT)
                 if node.text]
        if texts:
            paragraphs.append(''.join(texts))

    return '\n\n'.join(paragraphs)

</pre></noscript>
            </div>
            
            <p id="disqus_thread"/>
             <a href="http://disqus.com" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
        </div></body></html>