<html><body><div><div class="col-md-8">
          <h1>Represent File Structure as YAML with Python</h1>
<p>I needed to collect some test cases for some shoddy software that kept breaking when files and folders were named or arranged a certain way. I was tired of manually copying and pasting folders back and forth trying to troubleshoot the issue, so I automated the whole task away and turned it into a great tool for unit testing and bug reporting at the same time.</p>

<p>This is a recursive preorder tree traversal of a given directory. It recurses each time it encounters a folder until it finds a node with only files for leaves:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>root:
- subdir1:
  - subdir2:
    - subdir3:
      - file1
      - file2
      - file3
</code></pre>
</div>

<p>Each leaf file is added to a list and returned to its parent where the depth-first traversal continues:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>root:
- subdir1:
  - subdir2:
    - subdir3:
      - file1
      - file2
      - file3
  - subdir4:
    ...
  ...
  - subdirN:
    - fileN
</code></pre>
</div>

<p>Once there are no more folders at each level, it will append any sibling files to the current level’s list:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>root:
- subdir1:
  - subdir2:
    - subdir3:
      - file1
      - file2
      - file3
  - subdir4:
    ...
  ...
  - subdirN:
    - fileK
  - fileN
  - fileO
  - fileP
</code></pre>
</div>

<p>This pattern continues until there are no more files and directories at each level. And here is the Python script that does it (requires <a href="https://pypi.python.org/pypi/PyYAML">PyYAML</a>):
</p>

<p>Usage:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>python dir2yaml.py /path/to/directory
</code></pre>
</div>

<div class="bs-callout bs-callout-info">
  <p>When no argument is passed, <code class="highlighter-rouge">dir2yaml.py</code> will walk the current directory.</p>
</div>

<p>So now we have a file hierarchy represented in purely in YAML! But what do we do now? Say we want to go the other direction and convert our YAML structure back into a directory. We can, again, traverse the YAML tree through each nested folder with files in preorder fashion.</p>

<p>Starting with the root, a directory is created each time a dictionary in encountered. That pattern continues until a list is found. Each list can contain either files (leaves) or more dictionaries. If a file is found, that file is created (touched). If a dictionary is found, it recurses. The function returns to the parent after the entire list is visited and the process continues until there are no more dictionaries at each level. And here is the Python script to go from YAML to filesystem tree:</p>



<p>Usage:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>python yaml2dir.py /path/to/directory.yaml /path/to/destination
</code></pre>
</div>

<div class="bs-callout bs-callout-info">
  <p>When no 2nd argument is passed, <code class="highlighter-rouge">yaml2dir.py</code> will output to the current directory.</p>
</div>

<p>I tested both scripts on OS X Yosemite and on Debian Wheezy. I did not try it on Windows because I don’t keep an instance readily available, but I imagine it to work just fine since it’s Python. Both scripts were also written with Python 3 in mind, so ought to be fine there too.</p>

<hr/>

<ins class="adsbygoogle" data-ad-client="ca-pub-8244598697443713" data-ad-slot="9961827581" data-ad-format="auto"/>

<p id="disqus_thread"/>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
        </div></body></html>