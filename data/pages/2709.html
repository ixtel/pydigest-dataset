<html><body><div><div class="entry-content">
<div><p>
Используем в новом большом проекте Jenkins. Он очень хорош, для того чтобы дать тебе вовремя понять, что ты спорол какую-то чушь, и теперь тесты закосячены, а сними и код. Но как быть, если самодисциплины не всегда хватает на выполнение тестов перед коммитом и проверку кода на соответствие стандартам? Хуки! Мы используем mercurial, для него уже есть </p><a href="https://pypi.python.org/pypi/hghooks/">https://pypi.python.org/pypi/hghooks/</a><p>.</p></div>
<pre>[hooks]
pretxncommit.pep8 = python:hghooks.code.pep8hook
pretxncommit.pyflakes = python:hghooks.code.pyflakeshook
pretxncommit.pdb = python:hghooks.code.pdbhook
pretxncommit.jslint = python:hghooks.code.jslinthook

[hghooks]
strict_checking = true

[pep8]
ignore = E501</pre>
<p>
Осталось написать собственный хук, который будет откатывать коммиты с запоротыми тестами.</p>
<p>
UPD:</p>
<div class="hlcode">
<div class="syntax">
<pre>preoutgoing.confirm = hg summary<span class="p">;</span> read -p 'Are you sure you want to push to remote? (y/n): '<span class="p">;</span> echo $REPLY <span class="p">|</span> grep -q 'y'
</pre>
<p>
</p>
</div>
</div>
</div>
</div></body></html>