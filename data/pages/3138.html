<html><body><div><div class="body"><div itemscope="" itemtype="http://schema.org/Article"><h1 class="title" itemprop="name">Setuptools &amp; nosetests oddness</h1><p class="date"> Thu 24 April 2008</p><div itemprop="articleBody"><p>Looks like using setuptools's test runner (eg, run <tt class="docutils literal">python setup.py test</tt>) with the nose.collector has some weird issues - well, unexpected, for me at least.</p><p>I was using nose with coverage via --with-coverage option to get some cover reports. But setup.py test borked with "setup.py: error: no such option: --cover-package". After some digging in the sources i've found that some plugins aren't compatible with setuptools's test runner - you can't run post test hooks with that runner apparently (sadly, the coverage plugin is one of them). I wish setuptools had a option to ignore bogus options and show only a warning - well, on second thought, that's not setuptools related at all, the error is raised from optparse.</p><p>Luckily, setuptools has aliases for commands and instead of</p><div class="highlight"><pre><span/><span class="k">[nosetests]</span>
<span class="na">with-coverage</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">cover-package</span> <span class="o">=</span> <span class="s">cogen</span>
</pre></div><p>I can do:</p><div class="highlight"><pre><span/><span class="k">[aliases]</span>
<span class="na">test</span> <span class="o">=</span> <span class="s">nosetests --cover-package=cogen --with-coverage</span>
</pre></div><p>in setup.cfg.</p></div><p class="tags">This entry was tagged as <a href="https://blog.ionelmc.ro/tag/nose/"><span itemprop="keywords">nose</span></a><a href="https://blog.ionelmc.ro/tag/python/"><span itemprop="keywords">python</span></a><a href="https://blog.ionelmc.ro/tag/setuptools/"><span itemprop="keywords">setuptools</span></a><a href="https://blog.ionelmc.ro/tag/testing/"><span itemprop="keywords">testing</span></a></p></div><p id="disqus_thread"/><noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> </div></div></body></html>