<html><body><div><div class="section">
              <h1>farthing 0.0.1</h1>

              


<p>Infer types by inspecting program runs</p>








<p>Farthing will run arbitrary Python code while tracing the argument and return
types of all functions within a given file or directory. Farthing can then
automatically add type annotations based on the types of the values it saw
during the execution run. This might be useful if you want to add static types
to existing Python code, or for exploring codebases where you’re not sure what
type a value has.</p>
<p>For instance, the following code:</p>
<pre><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">*=</span> <span class="n">i</span>

    <span class="k">return</span> <span class="n">result</span>
</pre>
<p>can be automatically transformed into:</p>
<pre><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">*=</span> <span class="n">i</span>

    <span class="k">return</span> <span class="n">result</span>
</pre>
<p>by running Farthing against the following test file:</p>
<pre><span class="kn">from</span> <span class="nn">nose.tools</span> <span class="kn">import</span> <span class="n">assert_equal</span>

<span class="kn">import</span> <span class="nn">fact</span>


<span class="k">def</span> <span class="nf">test_fib</span><span class="p">():</span>
    <span class="n">test_cases</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">test_cases</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">_check_fact</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span>


<span class="k">def</span> <span class="nf">_check_fact</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="n">assert_equal</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">fact</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</pre>
<div id="usage">
<h2>Usage</h2>
<p>Farthing can be called from the command line. The first argument should be the
file or directory that should have type annotations added to it. The other
arguments should be the Python script to run with any arguments. For instance:</p>
<pre>farthing demo/fact.py _virtualenv/bin/nosetests demo/tests.py
</pre>
</div>
<div id="demo">
<h2>Demo</h2>
<p>To run the demo, you can just run <tt>demo.sh</tt>. To explain what it actually does:</p>
<ol>
<li>Run <tt>make bootstrap</tt> to set up the virtualenv with dependencies.</li>
<li>Run <tt>. _virtualenv/bin/activate</tt> to enter the virtualenv.</li>
<li>Run <tt>farthing demo/fact.py _virtualenv/bin/nosetests demo/tests.py</tt> to
run <tt>_virtualenv/bin/nosetests demo/tests.py</tt> and add annotations to
<tt>demo/fact.py</tt> based on the types of actual values used in the execution run.</li>
</ol>
</div>
<div id="limitations">
<h2>Limitations</h2>
<p>At the moment, Farthing is just a quick prototype, so currently has the
following limitations:</p>
<ul>
<li>Annotations are added just using the name of the type, which may not be
available in the current scope.</li>
<li>Type annotations cannot be added to the Python script being run.</li>
<li>The first type seen is used, rather than any attempt at finding a super-type.</li>
</ul>
<p>I’d be interested to see any projects along similar lines, so if you know of any,
I’d be grateful if you let me know.</p>
</div>


<a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>0</span> downloads in the last week
  </li>
  <li>
    <span>0</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>