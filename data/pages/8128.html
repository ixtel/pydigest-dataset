<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-django-package-monitor" class="anchor" href="#django-package-monitor" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>django-package-monitor</h1>
<p>A Django app for keeping track of dependency updates.</p>
<a href="https://travis-ci.org/yunojuno/django-package-monitor"><img alt="https://travis-ci.org/yunojuno/django-package-monitor.svg?branch=master" src="https://camo.githubusercontent.com/f5e93d375e8710215966c36c2b6b32ff277ea8ae/68747470733a2f2f7472617669732d63692e6f72672f79756e6f6a756e6f2f646a616e676f2d7061636b6167652d6d6f6e69746f722e7376673f6272616e63683d6d6173746572" data-canonical-src="https://travis-ci.org/yunojuno/django-package-monitor.svg?branch=master"/></a>
<a name="user-content-background"/>
<h2><a id="user-content-background" class="anchor" href="#background" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Background</h2>
<p>At YunoJuno we have a Django project that includes almost 100 external packages.
In order to manage updates to these we have a rolling development task that
comes around in the first week of each month, and includes the following:</p>
<ol>
<li>Using <code>pip list --outdated</code> list out all available updates</li>
<li>Group updates (using <a href="http://semver.org/">semver</a>) into Major, Minor, Patch, Other</li>
<li>Apply patch updates in a single update / commit</li>
<li>Apply minor updates as a group, see what breaks, remove, rinse, repeat</li>
<li>Take a view on major updates</li>
</ol>
<p>This task is a PITA, and so we decided to make it simpler.</p>
<a name="user-content-implementation"/>
<h2><a id="user-content-implementation" class="anchor" href="#implementation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Implementation</h2>
<p>This project contains a Django app that can be used to monitor your packages.</p>
<p>It consists of a single model, <code>PackageVersion</code>, an admin list view that you
can use to view current package versions, and load latest versions from PyPI,
and a single management command that can be used to load local requirements and
update remote versions from the shell - which you could run overnight if you
felt the need.</p>
<p>It is important to note that this app <strong>does not</strong> update your requirements for
you - it simply displays the requirements that you have, and the latest that
is available on PyPI.</p>
<p>In order to illustrate how it works, the app itself contains a Django project
that can be used to demonstrate the feature.</p>
<a name="user-content-installation"/>
<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>
<p>Download / install the app using pip:</p>
<div class="highlight highlight-source-shell"><pre>pip install django-package-monitor</pre></div>
<p>Add the app <code>package_monitor</code> to your <code>INSTALLED_APPS</code> Django setting:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># settings.py</span>
<span class="pl-c1">INSTALLED_APPS</span> <span class="pl-k">=</span> (
    <span class="pl-s"><span class="pl-pds">'</span>django.contrib.admin<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>django.contrib.auth<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>django.contrib.contenttypes<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>django.contrib.sessions<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>django.contrib.messages<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>django.contrib.staticfiles<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>package_monitor<span class="pl-pds">'</span></span>,
    <span class="pl-c1">...</span>
)</pre></div>
<p>Set the <code>PACKAGE_MONITOR_REQUIREMENTS_FILE</code> setting to point to your project
requirements file:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># settings.py</span>
<span class="pl-c1">PACKAGE_MONITOR_REQUIREMENTS_FILE</span> <span class="pl-k">=</span> path.join(<span class="pl-c1">PROJECT_ROOT</span>, <span class="pl-s"><span class="pl-pds">'</span>requirements.txt<span class="pl-pds">'</span></span>)</pre></div>
<p>Add the app URLs to your project - NB it must have the namespace set:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># urls.py</span>
urlpatterns <span class="pl-k">=</span> patterns(
    <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,
    url(<span class="pl-sr"><span class="pl-k">r</span><span class="pl-pds">'</span><span class="pl-c1">^</span>admin/<span class="pl-pds">'</span></span>, include(admin.site.urls)),
    url(<span class="pl-sr"><span class="pl-k">r</span><span class="pl-pds">'</span><span class="pl-c1">^</span>package_monitor/<span class="pl-pds">'</span></span>, include(<span class="pl-s"><span class="pl-pds">'</span>package_monitor.urls<span class="pl-pds">'</span></span>, <span class="pl-v">namespace</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>package_monitor<span class="pl-pds">'</span></span>)),
)</pre></div>
<p>At this point you should have a working implementation. You can test this by running
the management command to load your local requirements:</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c"># load up the local requirements file</span>
$ python manage.py refresh_packages --local</pre></div>
<p>This will load all of the requirements it finds in the requirements file specified into the
database. If you then want to check PyPI for updated version, run the command with the <code>--remote</code>
option. You can run both of these command together:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># load up the local requirements file, and check PyPI</span>
<span class="pl-ii">$</span> python manage.py refresh_packages <span class="pl-ii">--</span>local <span class="pl-ii">--</span>remote</pre></div>
<p>If you want to clean out the existing <code>PackageVersion</code> table before loading the local file, use the <code>--clean</code>
option:</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c"># clear out database, load up the local requirements file, and check PyPI</span>
$ python manage.py refresh_packages --clean --local --remote</pre></div>
<a name="user-content-tests"/>
<h2><a id="user-content-tests" class="anchor" href="#tests" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Tests</h2>
<p>There is a test suite that can be run using tox:</p>
<div class="highlight highlight-source-shell"><pre>$ pip install -r requirements
$ tox</pre></div>
<p>In addition to the unit tests, the source distribution also includes a fully-functioning Django
project, that can be run from the repo root, and used to demonstrate how it works:</p>
<div class="highlight highlight-source-shell"><pre>$ git clone git@github.com:yunojuno/django-package-monitor.git
$ <span class="pl-c1">cd</span> django-package-monitor
$ pip install -r requirements.txt
<span class="pl-c"># you will need to create a superuser in order to access the admin site</span>
$ python manage.py createsuperuser
$ python manage.py runserver</pre></div>
<p>If you then log in to the app (<a href="http://localhost:8000/admin">http://localhost:8000/admin</a> by default), you can then see the admin
list page:</p>
<a href="https://github.com/yunojuno/django-package-monitor/blob/master/screenshots/no_packages.png" target="_blank"><img alt="Screenshot of admin list view (empty)" src="https://github.com/yunojuno/django-package-monitor/raw/master/screenshots/no_packages.png"/></a>
<p>If you click on the "Reload local requirements" button in the top-right, it will load up the contents
of the requirements file that you used earlier:</p>
<a href="https://github.com/yunojuno/django-package-monitor/blob/master/screenshots/local_only.png" target="_blank"><img alt="Screenshot of admin list view populated with local requirements" src="https://github.com/yunojuno/django-package-monitor/raw/master/screenshots/local_only.png"/></a>
<p>At this point it has parsed the requirements file, and stored the current working version of
each package (as <code>current_version</code>). In order to see what the latest versions are, select all the packages, and choose
"Update selected packages from PyPI" form the actions list:</p>
<a href="https://github.com/yunojuno/django-package-monitor/blob/master/screenshots/select_all.png" target="_blank"><img alt="Screenshot of admin list view with all requirements selected" src="https://github.com/yunojuno/django-package-monitor/raw/master/screenshots/select_all.png"/></a>
<p>This may take some time, as it will call the PyPI API for each package (excluding those that are
marked as editable), and download the latest version info for each. At the end of this, you should
see the page updated with the new version information (as <code>latest_version</code>) - as well as the licence
information that is stored in the PyPI metadata:</p>
<a href="https://github.com/yunojuno/django-package-monitor/blob/master/screenshots/remote.png" target="_blank"><img alt="Screenshot of admin list view with requirement info updated from PyPI" src="https://github.com/yunojuno/django-package-monitor/raw/master/screenshots/remote.png"/></a>
<p>If you drill down to the detail on an individual package, you can see all of the available versions:</p>
<a href="https://github.com/yunojuno/django-package-monitor/blob/master/screenshots/package_details.png" target="_blank"><img alt="Screenshot of Django package details" src="https://github.com/yunojuno/django-package-monitor/raw/master/screenshots/package_details.png"/></a>
<a name="user-content-contributing"/>
<h2><a id="user-content-contributing" class="anchor" href="#contributing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Contributing</h2>
<p>This is by no means complete - it can't cope with requirements that are anything other than '==',
and it doesn't (yet) help with updating the requirements file itself. However, it's good enough to
be of value, hence releasing it. If you would like to contribute to the project, usual Github rules
apply:</p>
<ol>
<li>Fork the repo to your own account</li>
<li>Submit a pull request</li>
<li>Add tests for any new code</li>
<li>Follow coding style of existing project</li>
</ol>
<a name="user-content-licence"/>
<h2><a id="user-content-licence" class="anchor" href="#licence" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Licence</h2>
<p>This project is MIT licensed - see the LICENCE file for details.</p>

</article>
  </div></body></html>