<html><body><div><div class="section">
              <h1>excel-modelling-helper 0.2.6</h1>

              


<p>Use Excel to define your model parameters.</p>








<p>Given an excel file with rows similar to the below</p>
<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<thead>
<tr><th>variable</th>
<th>scenario</th>
<th>module</th>
<th>distribution</th>
<th>param 1</th>
<th>param 2</th>
<th>param 3</th>
<th>unit</th>
<th>start date</th>
<th>end date</th>
<th>CAGR</th>
<th>ref date</th>
<th>label</th>
<th>comment</th>
<th>source</th>
</tr>
</thead>
<tbody>
<tr><td>a</td>
<td> </td>
<td>numpy.random</td>
<td>choice</td>
<td>1</td>
<td> </td>
<td> </td>
<td>kg</td>
<td>01/01/2009</td>
<td>01/04/2009</td>
<td>0.10</td>
<td>01/01/2009</td>
<td>test var 1</td>
<td> </td>
<td> </td>
</tr>
<tr><td>b</td>
<td> </td>
<td>numpy.random</td>
<td>uniform</td>
<td>2</td>
<td>4</td>
<td> </td>
<td>
</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>label</td>
<td> </td>
<td> </td>
</tr>
<tr><td>c</td>
<td> </td>
<td>numpy.random</td>
<td>triangular</td>
<td>3</td>
<td>6</td>
<td>10</td>
<td>
</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>label</td>
<td> </td>
<td> </td>
</tr>
<tr><td>d</td>
<td> </td>
<td>bottom_up_comparision.sampling_core_router
s</td>
<td>Distribution</td>
<td>core_routers.csv</td>
<td> </td>
<td> </td>
<td>J/Gb</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>label</td>
<td> </td>
<td> </td>
</tr>
<tr><td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
</tr>
<tr><td>a</td>
<td>s1</td>
<td>numpy.random</td>
<td>choice</td>
<td>2</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>test var 1</td>
<td> </td>
<td> </td>
</tr>
<tr><td>multiple choice</td>
<td> </td>
<td>numpy.random</td>
<td>choice</td>
<td>1,2,3</td>
<td> </td>
<td> </td>
<td>kg</td>
<td>01/01/2007</td>
<td>01/01/2009</td>
<td> </td>
<td> </td>
<td>test var 1</td>
<td> </td>
<td> </td>
</tr>
</tbody>
</table>
<p>You can run python/ numpy code that references these variables and
generates random distributions.</p>
<p>For example, the following will initialise a variable <tt>c</tt> with a
vector of size 2 with random values from a triangular distribution.</p>
<pre>    np.random.seed(123)

    data = ParameterLoader.from_excel('test.xlsx', size=2, sheet_index=0)
    c = data['c']
&gt;&gt;&gt; [ 7.08471918  5.45131111]
</pre>
<p>Other types of distributions include <tt>choice</tt> and <tt>normal</tt>. However
you can specify any distribution from numpy that takes up to three
parameters to init.</p>
<p>You can also specify a .csv file with samples and an empiricial
distribution function is generated and variable values will be sampled
from that.</p>
<div id="scenarios">
<h2>Scenarios</h2>
<p>It is possible to define scenarios and have paramter values for a
variable change with each scenario.</p>
<pre>data = ParameterLoader.from_excel('test.xlsx', size=1, sheet_index=0)
res = data['a'][0]

assert res == 1.

data.select_scenario('s1')
res = data['a'][0]

assert res == 2.
</pre>
<p>use <tt>data.unselect_scenario()</tt> to return to the default value.</p>
</div>
<div id="pandas-dataframes">
<h2>Pandas Dataframes</h2>
<p>It is possible to define a time frame for distributions and have sample
values change over time.</p>
<pre># the time axis of our dataset
times = pd.date_range('2009-01-01', '2009-04-01', freq='MS')
# the sample axis our dataset
samples = 2

dfl = DataSeriesLoader.from_excel('test.xlsx', times, size=samples, sheet_index=0)
res = dfl['a']

assert res.loc[[datetime(2009, 1, 1)]][0] == 1
assert np.abs(res.loc[[datetime(2009, 4, 1)]][0] - pow(1.1, 3. / 12)) &lt; 0.00001
</pre>
</div>
<div id="reload">
<h2>Reload</h2>
<p>Reloading data sources is useful when underlying excel files change.</p>
<pre>times = pd.date_range('2009-01-01', '2009-04-01', freq='MS')
samples = 2

data = MultiSourceLoader()
data.add_source(ExcelSeriesLoaderDataSource('test.xlsx', times, size=samples, sheet_index=0))

res = data['a'][0]
assert res == 1.

wb = load_workbook(filename='test.xlsx')
ws = wb.worksheets[0]
ws['E2'] = 4.
wb.save(filename='test.xlsx')

data.reload_sources()

res = data['a'][0]
assert res == 4.

wb = load_workbook(filename='test.xlsx')
ws = wb.worksheets[0]
ws['E2'] = 1.
wb.save(filename='test.xlsx')

data.reload_sources()

data.set_scenario('s1')
res = data['a'][0]

assert res == 2.

data.reset_scenario()
res = data['a'][0]

assert res == 1.
</pre>
</div>



<a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>180</span> downloads in the last week
  </li>
  <li>
    <span>1403</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>