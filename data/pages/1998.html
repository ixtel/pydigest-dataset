<html><body><div><div class="entry-content">
<h4><strong>Build a Reddit Bot Series</strong></h4>
<p><a href="http://pythonforengineers.com/build-a-reddit-bot-part-1/">Part 1: Read posts from reddit</a></p>
<p><a href="http://pythonforengineers.com/build-a-reddit-bot-part-2-reply-to-posts/">Part 2: Reply to posts</a></p>
<p><a title="Build a Reddit Bot Part 3: Automate your bot" href="http://pythonforengineers.com/build-a-reddit-bot-part-3-automate-your-bot/">Part 3: Automate our Bot</a></p>
<p><strong>Introduction</strong></p>
<p>So we are going to build a simple Reddit Bot that will do two things:</p>
<p>1. It will monitor a particular subreddit for new posts, and when someone posts “I love Python”, it will reply “Me too!”.</p>
<p>2. It will also monitor all comments to recent posts, and if it finds one that says “I hate Python”, it will post a link to /r/learnpython and ask the commenter to ask a question there.</p>
<p><strong>Prerequisite knowledge</strong></p>
<p>Only a basic knowledge of Python is required, as building bots is fairly easy.</p>
<p><strong>Part 1</strong></p>
<p>In part one, we will see how we can read data from Reddit using the Reddit API. You can follow along with the video or text (or both). The source code is available at <a href="https://github.com/shantnu/RedditBot/blob/master/Part1/bot_read.py">Github</a>:</p>
<p> </p>
<p/>
<p><strong>Software bot</strong></p>
<p>A software bot is a program that can interact with websites autonomously. They can be as simple or as complex as you want them to be.</p>
<p>The bot runs in the background and monitors a website. When it sees a change (like a post on Reddit), it can reply to it, upvote, or do any other task it was programmed to.</p>
<p><strong>Monitoring websites</strong></p>
<p>There are many ways to monitor websites. You can use web scraping tools like urllib or Beautifulsoup any anything similar. There is a slight problem with this, though. Bots can make thousands of requests a second, and this can overload servers. So most big websites ban bots. <em>Ignore this at your own risk</em>. I have been banned from Google for hours, had my Gmail locked till I entered a dozen captachas, my mobile and the name of my first cat.</p>
<p>If you want to do this properly, stick to any rules the website has.</p>
<p><strong>Reddit API</strong></p>
<p>Reddit provides an API, and unlike some websites, it’s actually quite easy to use. It’s based on REST and json, so in theory doesn’t require any fancy setup.</p>
<p><a href="http://www.reddit.com/dev/api">http://www.reddit.com/dev/api</a></p>
<p>The important thing is to follow the rules they set. Two of the most important ones are:</p>
<ul>
<li> You can’t make more than 1 request every 2 seconds (or 30 a minute)</li>
<li>You must not lie about your user agent</li>
</ul>
<p>Read the rest <a href="https://github.com/reddit/reddit/wiki/API">here</a>.</p>
<p>The user agent is what identifies your browser. Libraries like Python’s urllib are severely restricted by Reddit to prevent abuse. Reddit recommends you use your own special user agent, and that’s what we’ll do.</p>
<p><strong>Using the API</strong></p>
<p>The API is quite easy to use, like I said. You make a REST request, and this can be done via urllib2 (as long as you set the user agent properly). This is how you would do it. I have put two links below. Open both in a new tab:</p>
<p><a href="http://www.reddit.com/r/learnPython/">http://www.reddit.com/r/learnPython/</a></p>
<p><a href="http://www.reddit.com/r/learnPython/hot/.json">http://www.reddit.com/r/learnPython/hot/.json</a></p>
<p>The first is how a human would see it. The second is how your code sees it. As you can see, getting the json is fairly easy.</p>
<p>The problem with this approach is that you still have to make sure you rate limit your requests. You also have to parse the json yourself. Json is easy to parse in Python, as it’s essentially a Python dictionary, but if you actually look at the json, there is a lot of data.</p>
<p><strong>Introducing Praw</strong></p>
<p>Praw is a library that fixes many of these problems for you. It limits how many requests you can make, and makes it easy to extract the json. Install it by:</p> 

 
<p>Let’s go over the code now. Download it at <a href="https://github.com/shantnu/RedditBot/blob/master/Part1/bot_read.py">Github</a>.</p> 

 
<p>We import praw.</p> 
<div id="crayon-56d5aa145ed1f107783725" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">

<p class="crayon-info"/>
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">

</td>
<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5aa145ed1f107783725-1"><span class="crayon-v">user_agent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"PyEng Bot 0.1"</span><span class="crayon-sy">)</span></p></div></td>
</tr>
</table>
</div>
</div>
 
<p>Remember I said the Reddit rules say you have to have a specific user agent? I’m choosing the name <em>PyEng Bot. </em>The number at the end is the version. This is recommended, because once your code is out there, people might abuse it. If someone spams Reddit with your code, Reddit will ban that user agent.</p>
<p>In that case, you just move the version up. Not ideal, but you have to accept that your code may be misused by spammers.</p> 
<div id="crayon-56d5aa145ed23042952929" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">

<p class="crayon-info"/>
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">

</td>
<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5aa145ed23042952929-1"><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">praw</span><span class="crayon-sy">.</span><span class="crayon-e">Reddit</span><span class="crayon-sy">(</span><span class="crayon-v">user_agent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">user_agent</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed23042952929-2"> </p><p class="crayon-line" id="crayon-56d5aa145ed23042952929-3"><span class="crayon-v">subreddit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-e">get_subreddit</span><span class="crayon-sy">(</span><span class="crayon-s">"learnpython"</span><span class="crayon-sy">)</span></p></div></td>
</tr>
</table>
</div>
</div>
 
<p>We create a Reddit instance, and get the subreddit <em>learnpython</em>.</p>
<p>Now, if you look on the subreddit, you can see that there is a <em>hot</em> tab. This does not indicate the temperature there is high or that there are racy swimsuit models. It means the most popular posts. That’s what we are going to read now. The function to do so is <em>get_hot()</em>.</p> 
<div id="crayon-56d5aa145ed26192485187" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">

<p class="crayon-info"/>
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">

</td>
<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5aa145ed26192485187-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">submission </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">subreddit</span><span class="crayon-sy">.</span><span class="crayon-e">get_hot</span><span class="crayon-sy">(</span><span class="crayon-v">limit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p></div></td>
</tr>
</table>
</div>
</div>
 
<p>We get the top 5 hot submissions. At this stage, you can do this to see which functions are available (you can do that at any stage, or look at Praw’s documentation).</p>
<p>Seeing a snipped list:</p> 
<div id="crayon-56d5aa145ed29733600409" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">

<p class="crayon-info"/>
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-2">2</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-4">4</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-6">6</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-8">8</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-10">10</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-12">12</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-14">14</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-16">16</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-18">18</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-20">20</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-22">22</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-24">24</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-26">26</p><p class="crayon-num" data-line="crayon-56d5aa145ed29733600409-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5aa145ed29733600409-28">28</p></div>
</td>
<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5aa145ed29733600409-1"> <span class="crayon-e">dir</span><span class="crayon-sy">(</span><span class="crayon-v">submission</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-2"> </p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-3"><span class="crayon-sy">[</span><span class="crayon-s">'approve'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-4"><span class="crayon-s">'approved_by'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-5"><span class="crayon-s">'author'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-6"> </p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-7"><span class="crayon-s">'domain'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-8"><span class="crayon-s">'downs'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-9"><span class="crayon-s">'downvote'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-10"><span class="crayon-s">'edit'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-11"><span class="crayon-s">'edited'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-12"> </p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-13"><span class="crayon-s">'saved'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-14"> </p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-15"><span class="crayon-s">'score'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-16"><span class="crayon-s">'secure_media'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-17"><span class="crayon-s">'secure_media_embed'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-18"><span class="crayon-s">'selftext'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-19"><span class="crayon-s">'selftext_html'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-20"> </p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-21"><span class="crayon-s">'title'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-22"> </p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-23"><span class="crayon-s">'ups'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-24"><span class="crayon-s">'upvote'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-25"><span class="crayon-s">'url'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-26"><span class="crayon-s">'user_reports'</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5aa145ed29733600409-27"><span class="crayon-s">'visited'</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed29733600409-28"><span class="crayon-s">'vote'</span><span class="crayon-sy">]</span></p></div></td>
</tr>
</table>
</div>
</div>
 
<p>I’ll point out a few important ones. <em>Title</em> is the title, as it appears on Reddit’s main page. <em>Selftext</em> is the optional text you can put on posts- most posts don’t have these. <em>learnpython</em> is unique in that most posts do have text (usually the poster asking their question), which is why I’ve chosen it. <em>score</em> is the total score, adding upvotes and downvotes (both of which are also available).</p>
<p>These are the three we will print:</p> 
<div id="crayon-56d5aa145ed2d998513363" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">

<p class="crayon-info"/>
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">

</td>
<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5aa145ed2d998513363-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">submission </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">subreddit</span><span class="crayon-sy">.</span><span class="crayon-e">get_hot</span><span class="crayon-sy">(</span><span class="crayon-v">limit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed2d998513363-2"><span class="crayon-h">    </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Title: "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">submission</span><span class="crayon-sy">.</span><span class="crayon-e">title</span></p><p class="crayon-line" id="crayon-56d5aa145ed2d998513363-3"><span class="crayon-e">    </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Text: "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">submission</span><span class="crayon-sy">.</span><span class="crayon-e">selftext</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5aa145ed2d998513363-4"><span class="crayon-e">    </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Score: "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">submission</span><span class="crayon-sy">.</span><span class="crayon-e">score</span></p><p class="crayon-line" id="crayon-56d5aa145ed2d998513363-5"><span class="crayon-e">    </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"---------------------------------\n"</span></p></div></td>
</tr>
</table>
</div>
</div>
 
<p>That’s it. Run the script, and open Reddit in a browser at the same time. Check that you are getting the right results.</p>
<p><strong>Next time</strong></p>
<p>Next time we will look at how to send a reply to a post on Reddit. <a title="Build a Reddit Bot Part 2: Reply to posts" href="http://pythonforengineers.com/build-a-reddit-bot-part-2-reply-to-posts/">Next Part</a></p>
<p> </p><p>
PS: Want a </p><strong>free</strong><p> 1+ hour </p><strong>video</strong> <strong>course</strong><p>,</p><em> Introduction to Web Scraping and Data Analysis</em><p>?
Also get a </p><strong>free</strong><p> mini-book,</p><em> Python: From Apprentice to Master.</em>

 
<em>I will never spam you. Unsubscribe anytime.
</em>
</div>
</div></body></html>