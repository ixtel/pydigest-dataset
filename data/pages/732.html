<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-flask-bouncer" class="anchor" href="#flask-bouncer" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>flask-bouncer</h1>
<p>Flask declarative authorization leveraging <a href="https://github.com/jtushman/bouncer">bouncer</a></p>
<p><a href="https://travis-ci.org/jtushman/flask-bouncer"><img alt="Build Status" src="https://camo.githubusercontent.com/a8101f0539b9809a851978d79a775849d0eb53db/68747470733a2f2f7472617669732d63692e6f72672f6a747573686d616e2f666c61736b2d626f756e6365722e7376673f6272616e63683d6d6173746572" data-canonical-src="https://travis-ci.org/jtushman/flask-bouncer.svg?branch=master"/></a></p>
<p><strong>flask-bouncer</strong> is an authorization library for Flask which restricts
what resources a given user is allowed to access. All the permissions
are defined in a <strong>single location</strong>.</p>
<p>Enough chit-chat – show me the code …</p>
<a name="user-content-installation"/>
<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>
<div class="highlight highlight-source-shell"><pre>pip install flask-bouncer</pre></div>
<a name="user-content-usage"/>
<h2><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h2>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> flask.ext.bouncer <span class="pl-k">import</span> requires, ensure, Bouncer
app <span class="pl-k">=</span> Flask()
bouncer <span class="pl-k">=</span> Bouncer(app)

<span class="pl-c"># Define your authorization in one place and in english ...</span>
<span class="pl-en">@bouncer.authorization_method</span>
<span class="pl-k">def</span> <span class="pl-en">define_authorization</span>(<span class="pl-smi">user</span>, <span class="pl-smi">they</span>):
    <span class="pl-k">if</span> user.is_admin:
        they.can(<span class="pl-c1">MANAGE</span>, <span class="pl-c1">ALL</span>)
    <span class="pl-k">else</span>:
        they.can(<span class="pl-c1">READ</span>, (<span class="pl-s"><span class="pl-pds">'</span>Article<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>BlogPost<span class="pl-pds">'</span></span>))
        they.can(<span class="pl-c1">EDIT</span>, <span class="pl-s"><span class="pl-pds">'</span>Article<span class="pl-pds">'</span></span>, <span class="pl-k">lambda</span> <span class="pl-smi">a</span>: a.author_id <span class="pl-k">==</span> user.id)

<span class="pl-c"># Then decorate your routes with your conditions.</span>
<span class="pl-c"># If it fails it will return a 401</span>
<span class="pl-en">@app.route</span>(<span class="pl-s"><span class="pl-pds">"</span>/articles<span class="pl-pds">"</span></span>)
<span class="pl-en">@requires</span>(<span class="pl-c1">READ</span>, Article)
<span class="pl-k">def</span> <span class="pl-en">articles_index</span>():
    <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>A bunch of articles<span class="pl-pds">"</span></span>

<span class="pl-en">@app.route</span>(<span class="pl-s"><span class="pl-pds">"</span>/topsecret<span class="pl-pds">"</span></span>)
<span class="pl-en">@requires</span>(<span class="pl-c1">READ</span>, TopSecretFile)
<span class="pl-k">def</span> <span class="pl-en">topsecret_index</span>():
    <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>A bunch of top secret stuff that only admins should see<span class="pl-pds">"</span></span></pre></div>
<ul>
<li>When you are dealing with a specific resource, then use the
<code>ensure</code> method</li>
</ul>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> flask.ext.bouncer <span class="pl-k">import</span> requires, ensure
<span class="pl-en">@app.route</span>(<span class="pl-s"><span class="pl-pds">"</span>/articles/&lt;article_id&gt;<span class="pl-pds">"</span></span>)
<span class="pl-en">@requires</span>(<span class="pl-c1">READ</span>, Article)
<span class="pl-k">def</span> <span class="pl-en">show_article</span>(<span class="pl-smi">article_id</span>):
    article <span class="pl-k">=</span> Article.find_by_id(article_id)

    <span class="pl-c"># can the current user 'read' the article, if not it will throw a 401</span>
    ensure(<span class="pl-c1">READ</span>,article)
    <span class="pl-k">return</span> render_template(<span class="pl-s"><span class="pl-pds">'</span>article.html<span class="pl-pds">'</span></span>, <span class="pl-v">article</span><span class="pl-k">=</span>article)</pre></div>
<ul>
<li>Check out <a href="https://github.com/jtushman/bouncer">bouncer</a> with more details about defining Abilities</li>
<li>flask-bouncer by default looks for <code>current_user</code> or <code>user</code>
stored in flask’s <a href="http://flask.pocoo.org/docs/api/#flask.g">g</a></li>
</ul>
<a name="user-content-lock-it-down"/>
<h2><a id="user-content-lock-it-down" class="anchor" href="#lock-it-down" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Lock It Down</h2>
<p>You can use the ensure_authorization feature to ensure that all of your routes in your application have been
authorized</p>
<div class="highlight highlight-source-python"><pre>bouncer <span class="pl-k">=</span> Bouncer(app, <span class="pl-v">ensure_authorization</span><span class="pl-k">=</span><span class="pl-c1">True</span>)</pre></div>
<p>This will check each request to ensure that an authorization check (either ensure or requires) has been made</p>
<p>If you want to skip a certain route, decorate your route with @skip_authorization.  Like so:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-en">@app.route</span>(<span class="pl-s"><span class="pl-pds">"</span>/articles<span class="pl-pds">"</span></span>)
<span class="pl-en">@skip_authorization</span>
<span class="pl-k">def</span> <span class="pl-en">articles_index</span>():
    <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>A bunch of articles<span class="pl-pds">"</span></span></pre></div>
<a name="user-content-flask-classy-support"/>
<h2><a id="user-content-flask-classy-support" class="anchor" href="#flask-classy-support" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Flask-Classy Support</h2>
<p>I ❤ <a href="https://pythonhosted.org/Flask-Classy/">Flask-Classy</a> Like a lot. Flask-Classy is an extension that adds
class-based REST views to Flask.</p>
<a name="user-content-define-you-view-similarly-as-you-would-with-flask-classy"/>
<h3><a id="user-content-1-define-you-view-similarly-as-you-would-with-flask-classy" class="anchor" href="#1-define-you-view-similarly-as-you-would-with-flask-classy" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>1) Define you View similarly as you would with flask-classy</h3>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> flask.ext.classy <span class="pl-k">import</span> FlaskView
<span class="pl-k">from</span> yourapp.models <span class="pl-k">import</span> Article

<span class="pl-k">class</span> <span class="pl-en">ArticleView</span>(<span class="pl-e">FlaskView</span>)

    # <span class="pl-en">an</span> <span class="pl-en">additional</span> <span class="pl-k">class</span> <span class="pl-en">attribute</span> <span class="pl-en">that</span> <span class="pl-en">you</span> <span class="pl-en">need</span> <span class="pl-en">to</span> <span class="pl-en">add</span> <span class="pl-k">for</span> <span class="pl-en">flask</span>-<span class="pl-en">bouncer</span>
    <span class="pl-en">__target_model__</span> = <span class="pl-en">Article</span>

    <span class="pl-k">def</span> <span class="pl-en">index</span>(<span class="pl-v">self</span>)
        <span class="pl-k">return</span> "<span class="pl-en">Index</span>"

    <span class="pl-k">def</span> <span class="pl-en">get</span>(<span class="pl-v">self</span>, <span class="pl-e">obj_id</span>):
        <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>Get <span class="pl-pds">"</span></span>

    <span class="pl-c"># ... methods for post, delete (and even put, and patch if you so like</span></pre></div>
<a name="user-content-register-the-view-with-flask-and-bouncer"/>
<h3><a id="user-content-2-register-the-view-with-flask-and-bouncer" class="anchor" href="#2-register-the-view-with-flask-and-bouncer" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>2) Register the View with flask and bouncer</h3>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># in your application.py or the like</span>

app <span class="pl-k">=</span> Flask(<span class="pl-s"><span class="pl-pds">"</span>classy<span class="pl-pds">"</span></span>)
bouncer <span class="pl-k">=</span> Bouncer(app)
ArticleView.register(app)

<span class="pl-c"># Which classy views do you want to lock down, you can pass multiple</span>
bouncer.monitor(ArticleView)</pre></div>
<p>Then voila – flask-bouncer will implicitly add the following conditions
to the routes:</p>
<ul>
<li>You need ‘READ’ privileges for ‘index’,‘show’ and ‘get’</li>
<li>You need ‘CREATE’ privileges for ‘new’,‘put’ and ‘post’</li>
<li>You need ‘UPDATE’ privileges for ‘edit’ and ‘patch’</li>
</ul>
<p>If you want to over-write the default requirements, just add the
<code>@requires</code> decorator to the function</p>
<a name="user-content-configuration"/>
<h2><a id="user-content-configuration" class="anchor" href="#configuration" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Configuration</h2>
<h2 id="user-content-current-user"><a id="user-content-current_user" class="anchor" href="#current_user" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>current_user</h2>
<p>By default flask-bouncer will inspect <code>g</code> for user or current_user.
You can add your custom loader by decorating a function with
<code>@bouncer.user_loader</code></p>
<a name="user-content-other-features"/>
<h2><a id="user-content-other-features" class="anchor" href="#other-features" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Other Features</h2>

<a name="user-content-notes"/>
<h2><a id="user-content-notes" class="anchor" href="#notes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Notes</h2>
<ul>
<li>This library focusing only on <strong>Authorization</strong>, we leave
<strong>Authentication</strong> to other libraries such as <a href="http://flask-login.readthedocs.org/en/latest/">flask-login</a>.</li>
</ul>
<a name="user-content-thank-you"/>
<h2><a id="user-content-thank-you" class="anchor" href="#thank-you" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Thank You!</h2>
<ul>
<li>Ryan Bates, and his excellent CanCan ruby library which this the
inspiration for this library</li>
</ul>
<a name="user-content-questions-issues"/>
<h2><a id="user-content-questions--issues" class="anchor" href="#questions--issues" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Questions / Issues</h2>
<p>Feel free to ping me on twitter: <a href="http://twitter.com/tushman">@tushman</a>
or add issues or PRs at <a href="https://github.com/jtushman/flask-bouncer">https://github.com/jtushman/flask-bouncer</a></p>

</article>
  </div></body></html>