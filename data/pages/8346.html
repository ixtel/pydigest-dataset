<html><body><div><section class="entry">
<p class="fsb-clear"/><p><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_results_montage.jpg"><img class="aligncenter wp-image-3438" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_results_montage.jpg" alt="lbp_results_montage" srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_results_montage-300x243.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_results_montage.jpg 800w" sizes="(max-width: 600px) 100vw, 600px"/></a></p>
<p>Well. I’ll just come right out and say it. <em><strong>Today is my 27th birthday.</strong></em></p>
<p>As a kid I was always <em>super excited</em> about my birthday. It was another year closer to being able to drive a car. Go to R rated movies. Or buy alcohol.</p>
<p>But now as an adult, I don’t care too much for my birthday — I suppose it’s just another reminder of the passage of time and how it can’t be stopped. And to be totally honest with you, I guess I’m a bit nervous about turning the “Big 3-0” in a few short years.</p>
<p>In order to rekindle some of that “little kid excitement”, I want to do something special with today’s post. Since today is both a <em>Monday</em> (when new PyImageSearch blog posts are published) and <em>my birthday</em> (two events that will not coincide again until 2020), I’ve decided to put together a really great tutorial on <em><strong>texture and pattern recognition in images</strong></em>.</p>
<p>In the remainder of this blog post I’ll show you how to use the <a href="https://en.wikipedia.org/wiki/Local_binary_patterns" target="_blank">Local Binary Patterns</a> image descriptor (along with a bit of machine learning) to automatically <em>classify</em> and <em>identify</em> textures and patterns in images (such as the texture/pattern of wrapping paper, cake icing, or candles, for instance).</p>
<p>Read on to find out more about Local Binary Patterns and how they can be used for texture classification.</p>

<h2>PyImageSearch Gurus</h2>
<p>The majority of this blog post on texture and pattern recognition is based on the Local Binary Patterns lesson inside the <em><strong><a href="http://www.pyimagesearch.com/pyimagesearch-gurus/" target="_blank">PyImageSearch Gurus course</a></strong></em>.</p>
<p>While the lesson in PyImageSearch Gurus goes into <em><strong>a lot more detail</strong></em> than what this tutorial does, I still wanted to give you a taste of what PyImageSearch Gurus — my <em>magnum opus</em> on computer vision — has in store for you.</p>
<p>If you like this tutorial, there are over <strong>29 lessons</strong> spanning <strong>324 pages</strong> covering image descriptors (HOG, Haralick, Zernike, etc.), keypoint detectors (FAST, DoG, GFTT, etc.), and local invariant descriptors (SIFT, SURF, RootSIFT, etc.), inside the course.</p>
<p>At the time of this writing, the PyImageSearch Gurus course also covers an additional <strong>166</strong> lessons and <strong>1,291 pages</strong> including computer vision topics such as <em>face recognition</em>, <em>deep learning</em>, <em>automatic license plate recognition</em>, and <em>training your own custom object detectors</em>, just to name a few.</p>
<p><strong>If this sounds interesting to you, <em><a href="http://www.pyimagesearch.com/pyimagesearch-gurus/" target="_blank">be sure to take a look and consider signing up for the next open enrollment!</a></em></strong></p>
<h2>What are Local Binary Patterns?</h2>
<p>Local Binary Patterns, or LBPs for short, are a texture descriptor made popular by the work of Ojala et al. in their 2002 paper, <i><a href="http://www.outex.oulu.fi/publications/pami_02_opm.pdf" target="_blank">Multiresolution Grayscale and Rotation Invariant Texture Classification with Local Binary Patterns</a> </i>(although the concept of LBPs were introduced as early as 1993).</p>
<p>Unlike <a href="http://haralick.org/journals/TexturalFeatures.pdf" target="_blank">Haralick texture features</a> that compute a <em>global representation</em> of texture based on the <a href="http://www.mathworks.com/help/images/gray-level-co-occurrence-matrix-glcm.html" target="_blank">Gray Level Co-occurrence Matrix</a>, LBPs instead compute a <em>local representation</em> of texture. This local representation is constructed by comparing each pixel with its surrounding neighborhood of pixels.</p>
<p>The first step in constructing the LBP texture descriptor is to convert the image to grayscale. For each pixel in the grayscale image, we select a neighborhood of size <em>r</em> surrounding the center pixel. A LBP value is then calculated for this center pixel and stored in the output 2D array with the same width and height as the input image.</p>
<p>For example, let’s take a look at the original LBP descriptor which operates on a fixed <em>3 x 3</em> neighborhood of pixels just like this:</p>
<div id="attachment_3439" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_thresholding.jpg"><img class="wp-image-3439" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_thresholding.jpg" alt="Figure 1: The first step in constructing a LBP is to take the 8 pixel neighborhood surrounding a center pixel and construct it to construct a set of 8 binary digits." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_thresholding-300x131.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_thresholding.jpg 836w" sizes="(max-width: 500px) 100vw, 500px"/></a><p class="wp-caption-text"><strong>Figure 1:</strong> The first step in constructing a LBP is to take the 8 pixel neighborhood surrounding a center pixel and threshold it to construct a set of 8 binary digits.</p></div>
<p>In the above figure we take the center pixel (highlighted in red) and threshold it against its neighborhood of 8 pixels. If the intensity of the center pixel is greater-than-or-equal to its neighbor, then we set the value to <em>1</em>; otherwise, we set it to <em>0</em>. With 8 surrounding pixels, we have a total of <em>2 ^ 8 = 256</em> possible combinations of LBP codes.</p>
<p>From there, we need to calculate the LBP value for the center pixel. We can start from any neighboring pixel and work our way clockwise or counter-clockwise, but our ordering must be kept <em>consistent</em> for all pixels in our image and all images in our dataset. Given a <em>3 x 3</em> neighborhood, we thus have 8 neighbors that we must perform a binary test on. The results of this binary test are stored in an 8-bit array, which we then convert to decimal, like this:</p>
<div id="attachment_3440" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_calculation.jpg"><img class="wp-image-3440" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_calculation.jpg" alt="Figure 2: Taking the 8-bit binary neighborhood of the center pixel and converting it into a decimal representation. (Thanks to Hanzra Tech for the inspiration on this visualization!)" srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_calculation-300x88.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_calculation-1024x299.jpg 1024w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_calculation.jpg 1248w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 2:</strong> Taking the 8-bit binary neighborhood of the center pixel and converting it into a decimal representation. (Thanks to Bikramjot of <a href="http://hanzratech.in/" target="_blank">Hanzra Tech</a> for the inspiration on this visualization!)</p></div>
<p>In this example we start at the top-right point and work our way <strong><em>clockwise</em></strong> accumulating the binary string as we go along. We can then convert this binary string to decimal, yielding a value of 23.</p>
<p>This value is stored in the output LBP 2D array, which we can then visualize below:</p>
<div id="attachment_3441" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_to_output.jpg"><img class="wp-image-3441" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_to_output.jpg" alt="Figure 3: The calculated LBP value is then stored in an output array with the same width and height as the original image." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_to_output-300x152.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_to_output-1024x519.jpg 1024w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_to_output.jpg 1326w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 3:</strong> The calculated LBP value is then stored in an output array with the same width and height as the original image.</p></div>
<p>This process of thresholding, accumulating binary strings, and storing the output decimal value in the LBP array is then repeated for each pixel in the input image.</p>
<p>Here is an example of computing and visualizing a full LBP 2D array:</p>
<div id="attachment_3442" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_2d_array.jpg"><img class="wp-image-3442" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_2d_array.jpg" alt="Figure 4: An example of computing the LBP representation (right) from the original input image (left)." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_2d_array-300x175.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_2d_array.jpg 900w" sizes="(max-width: 500px) 100vw, 500px"/></a><p class="wp-caption-text"><strong>Figure 4:</strong> An example of computing the LBP representation <em>(right)</em> from the original input image <em>(left)</em>.</p></div>
<p>The last step is to compute a histogram over the output LBP array. Since a <em>3 x 3 </em>neighborhood has <em>2 ^ 8 = 256</em> possible patterns, our LBP 2D array thus has a <em>minimum value of 0</em> and a <em>maximum value of 255</em>, allowing us to construct a 256-bin histogram of LBP codes as our final feature vector:</p>
<div id="attachment_3443" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_256bin_histogram.jpg"><img class="wp-image-3443" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_256bin_histogram.jpg" alt="Figure 5: Finally, we can compute a histogram that tabulates the number of times each LBP pattern occurs. We can treat this histogram as our feature vector." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_256bin_histogram-300x190.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_256bin_histogram-1024x648.jpg 1024w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_256bin_histogram.jpg 1200w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 5:</strong> Finally, we can compute a histogram that tabulates the number of times each LBP pattern occurs. We can treat this histogram as our feature vector.</p></div>
<p>A primary benefit of this original LBP implementation is that we can capture extremely fine-grained details in the image. However, being able to capture details at such a small scale is also the <em>biggest drawback to the algorithm</em> — we cannot capture details at varying scales, only the fixed <em>3 x 3 </em>scale!</p>
<p>To handle this, an extension to the original LBP implementation was proposed by Ojala et al. to handle variable neighborhood sizes. To account for variable neighborhood sizes, two parameters were introduced:</p>
<ol>
<li>The number of points <em>p</em> in a circularly symmetric neighborhood to consider (thus removing relying on a square neighborhood).</li>
<li>The radius of the circle <em>r</em>, which allows us to account for different scales.</li>
</ol>
<p>Below follows a visualization of these parameters:</p>
<div id="attachment_3444" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_num_points_radii.jpg"><img class="size-full wp-image-3444" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_num_points_radii.jpg" alt="Figure 6: Three neighborhood examples with varying p and r used to construct Local Binary Patterns." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_num_points_radii-300x99.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_num_points_radii.jpg 358w" sizes="(max-width: 358px) 100vw, 358px"/></a><p class="wp-caption-text"><strong>Figure 6:</strong> Three neighborhood examples with varying <em>p</em> and <em>r</em> used to construct Local Binary Patterns.</p></div>
<p>Lastly, it’s important that we consider the concept of LBP <em><strong>uniformity</strong></em>. A LBP is considered to be uniform if it has <em><strong>at most</strong></em> two <i>0-1</i> or <em>1-0</em> transitions. For example, the pattern 
			<span id="crayon-56d5910f48d0e822253322" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-cn">00001000</span></span></span>  (2 transitions) and 
			<span id="crayon-56d5910f48d1c480746902" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-cn">10000000</span></span></span>  (1 transition) are both considered to be <strong>uniform patterns</strong> since they contain at most two <em>0-1</em> and <em>1-0</em> transitions. The pattern 
			<span id="crayon-56d5910f48d20801778444" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-cn">01010010</span></span></span> ) on the other hand is <em>not</em> considered a uniform pattern since it has six <em>0-1</em> or <em>1-0</em> transitions.</p>
<p>The number of uniform prototypes in a Local Binary Pattern is completely dependent on the number of points <em>p</em>. As the value of <em>p</em> increases, so will the dimensionality of your resulting histogram. Please refer to the original Ojala et al. paper for the full explanation on deriving the number of patterns and uniform patterns based on this value. However, for the time being simply keep in mind that given the number of points <em>p</em> in the LBP there are <em>p + 1</em> <strong>uniform patterns</strong>. The final dimensionality of the histogram is thus <em>p + 2</em>, where the added entry tabulates all patterns that are <em><strong>not uniform</strong></em>.</p>
<p>So why are uniform LBP patterns so interesting? Simply put: they add an extra level of <em>rotation and grayscale invariance</em>, hence they are commonly used when extracting LBP feature vectors from images.</p>
<h2>Local Binary Patterns with Python and OpenCV</h2>
<p>Local Binary Pattern implementations can be found in both the <a href="http://scikit-image.org/docs/dev/api/skimage.feature.html#skimage.feature.local_binary_pattern" target="_blank">scikit-image</a> and <a href="http://mahotas.readthedocs.org/en/latest/lbp.html" target="_blank">mahotas</a> packages. OpenCV also implements LBPs, but strictly in the context of face recognition — the underlying LBP extractor is not exposed for raw LBP histogram computation.</p>
<p>In general, I recommend using the scikit-image implementation of LBPs as they offer more control of the types of LBP histograms you want to generate. Furthermore, the scikit-image implementation also includes variants of LBPs that improve rotation and grayscale invariance.</p>
<p>Before we get started extracting Local Binary Patterns from images and using them for classification, we first need to create a dataset of textures. To form this dataset, earlier today I took a walk through my apartment and collected 20 photos of various textures and patterns, including an <strong>area rug</strong>:</p>
<div id="attachment_3445" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_area_rug_examples.jpg"><img class="wp-image-3445" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_area_rug_examples.jpg" alt="Figure 7: Example images of the area rug texture and pattern." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_area_rug_examples-300x60.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_area_rug_examples.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 7:</strong> Example images of the area rug texture and pattern.</p></div>
<p>Notice how the area rug images have a geometric design to it.</p>
<p>I also gathered a few examples of <strong>carpet</strong>:</p>
<div id="attachment_3446" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_carpet_examples.jpg"><img class="wp-image-3446" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_carpet_examples.jpg" alt="Figure 8: Four examples of the carpet texture." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_carpet_examples-300x60.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_carpet_examples.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 8:</strong> Four examples of the carpet texture.</p></div>
<p>Notice how the carpet has a distinct pattern with a coarse texture.</p>
<p>I then snapped a few photos of the <strong>keyboard</strong> sitting on my desk:</p>
<div id="attachment_3447" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_keyboard_examples.jpg"><img class="wp-image-3447" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_keyboard_examples.jpg" alt="Figure 9: Example images of my keyboard." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_keyboard_examples-300x60.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_keyboard_examples.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 9:</strong> Example images of my keyboard.</p></div>
<p>Notice how the keyboard has little texture — but it does demonstrate a repeatable pattern of white keys and silver metal spacing in between them.</p>
<p>Finally, I gathered a few final examples of <strong>wrapping paper</strong> (since it is my birthday after all):</p>
<div id="attachment_3448" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_wrapping_paper_examples.jpg"><img class="wp-image-3448" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_wrapping_paper_examples.jpg" alt="Figure 10: Our final texture we are going to classify -- wrapping paper." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_wrapping_paper_examples-300x60.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_wrapping_paper_examples.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 10:</strong> Our final texture we are going to classify — wrapping paper.</p></div>
<p>The wrapping paper has a very smooth texture to it, but also demonstrates a unique pattern.</p>
<p>Given this dataset of <strong>area rug</strong>, <strong>carpet</strong>, <strong>keyboard</strong>, and <strong>wrapping paper</strong>, our goal is to extract Local Binary Patterns from these images and apply machine learning to automatically recognize and categorize these texture images.</p>
<p>Let’s go ahead and get this demonstration started by defining the directory structure for our project:</p>

		<div id="crayon-56d5910f48d28238042872" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5910f48d28238042872-1"><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d28238042872-2"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">localbinarypatterns</span><span class="crayon-e">.py</span></p><p class="crayon-line" id="crayon-56d5910f48d28238042872-3"><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">recognize</span><span class="crayon-e">.py</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We’ll be creating a 
			<span id="crayon-56d5910f48d2c716472030" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">pyimagesearch</span></span></span>  module to keep our code organized. And within the 
			<span id="crayon-56d5910f48d2f830946122" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">pyimagesearch</span></span></span>  module we’ll create 
			<span id="crayon-56d5910f48d33375496920" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">localbinarypatterns</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> , which as the name suggests, is where our Local Binary Patterns implementation will be stored.</p>
<p>Speaking of Local Binary Patterns, let’s go ahead and create the descriptor class now:</p>

		<div id="crayon-56d5910f48d37871918357" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-2">2</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-4">4</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-6">6</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-8">8</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-10">10</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-12">12</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-14">14</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-16">16</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-18">18</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-20">20</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-22">22</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-24">24</p><p class="crayon-num" data-line="crayon-56d5910f48d37871918357-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d37871918357-26">26</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5910f48d37871918357-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">skimage </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">feature</span></p><p class="crayon-line" id="crayon-56d5910f48d37871918357-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-4"> </p><p class="crayon-line" id="crayon-56d5910f48d37871918357-5"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-v">LocalBinaryPatterns</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-6"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numPoints</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">radius</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5910f48d37871918357-7"><span class="crayon-h">		</span><span class="crayon-c"># store the number of points and radius</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-8"><span class="crayon-h">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">numPoints</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">numPoints</span></p><p class="crayon-line" id="crayon-56d5910f48d37871918357-9"><span class="crayon-e">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">radius</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">radius</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-10"> </p><p class="crayon-line" id="crayon-56d5910f48d37871918357-11"><span class="crayon-e">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-12"><span class="crayon-h">		</span><span class="crayon-c"># compute the Local Binary Pattern representation</span></p><p class="crayon-line" id="crayon-56d5910f48d37871918357-13"><span class="crayon-h">		</span><span class="crayon-c"># of the image, and then use the LBP representation</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-14"><span class="crayon-h">		</span><span class="crayon-c"># to build the histogram of patterns</span></p><p class="crayon-line" id="crayon-56d5910f48d37871918357-15"><span class="crayon-h">		</span><span class="crayon-v">lbp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">feature</span><span class="crayon-sy">.</span><span class="crayon-e">local_binary_pattern</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">numPoints</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-16"><span class="crayon-h">			</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">radius</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"uniform"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d37871918357-17"><span class="crayon-h">		</span><span class="crayon-sy">(</span><span class="crayon-v">hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">histogram</span><span class="crayon-sy">(</span><span class="crayon-v">lbp</span><span class="crayon-sy">.</span><span class="crayon-e">ravel</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-18"><span class="crayon-h">			</span><span class="crayon-v">bins</span><span class="crayon-o">=</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">arange</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">numPoints</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5910f48d37871918357-19"><span class="crayon-h">			</span><span class="crayon-k ">range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">numPoints</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-20"> </p><p class="crayon-line" id="crayon-56d5910f48d37871918357-21"><span class="crayon-h">		</span><span class="crayon-c"># normalize the histogram</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-22"><span class="crayon-h">		</span><span class="crayon-v">hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">hist</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"float"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d37871918357-23"><span class="crayon-h">		</span><span class="crayon-v">hist</span><span class="crayon-h"> </span><span class="crayon-o">/=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">hist</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-24"> </p><p class="crayon-line" id="crayon-56d5910f48d37871918357-25"><span class="crayon-h">		</span><span class="crayon-c"># return the histogram of Local Binary Patterns</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d37871918357-26"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">hist</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We start of by importing the 
			<span id="crayon-56d5910f48d3b254970621" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">feature</span></span></span>  sub-module of <a href="http://scikit-image.org/" target="_blank">scikit-image</a> which contains the implementation of the Local Binary Patterns descriptor.</p>
<p><strong>Line 5</strong> defines our constructor for our 
			<span id="crayon-56d5910f48d3f606803264" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">LocalBinaryPatterns</span></span></span>  class. As mentioned in the section above, we know that LBPs require two parameters: the <em>radius</em> of the pattern surrounding the central pixel, along with the <em>number of points</em> along the outer radius. We’ll store both of these values on <strong>Lines 8 and 9</strong>.</p>
<p>From there, we define our 
			<span id="crayon-56d5910f48d42454574862" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">describe</span></span></span>  method on <strong>Line 11</strong>, which accepts a single required argument — the image we want to extract LBPs from.</p>
<p>The actual LBP computation is handled on <strong>Line 15</strong> using our supplied radius and number of points. The 
			<span id="crayon-56d5910f48d46541341137" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">uniform</span></span></span>  method indicates that we are computing the rotation and grayscale invariant form of LBPs.</p>
<p>However, the 
			<span id="crayon-56d5910f48d4a192284599" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">lbp</span></span></span>  variable returned by the 
			<span id="crayon-56d5910f48d4d324115986" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">local_binary_patterns</span></span></span>  function is not directly usable as a feature vector. Instead, 
			<span id="crayon-56d5910f48d51176595763" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">lbp</span></span></span>  is a 2D array with the same width and height as our input image — each of the values inside 
			<span id="crayon-56d5910f48d54644377494" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">lbp</span></span></span>  ranges from <em>[0, numPoints + 2]</em>, a value for each of the possible <em>numPoints + 1</em> possible rotation invariant prototypes (see the discussion of <em>uniform patterns </em>at the top of this post for more information) along with an extra dimension for all patterns that <em>are not</em> uniform, yielding a total of <em>numPoints + 2</em> unique possible values.</p>
<p>Thus, to construct the actual feature vector, we need to make a call to 
			<span id="crayon-56d5910f48d58675914604" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">histogram</span></span></span>  which counts the number of times each of the LBP prototypes appears. The returned histogram is <em>numPoints + 2</em>-dimensional, an integer count for each of the prototypes. We then take this histogram and normalize it such that it sums to <em>1</em>, and then return it to the calling function.</p>
<p>Now that our 
			<span id="crayon-56d5910f48d5c638889031" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">LocalBinaryPatterns</span></span></span>  descriptor is defined, let’s see how we can use it to recognize textures and patterns. Create a new file named 
			<span id="crayon-56d5910f48d5f773112495" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">recognize</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> , and let’s get coding:</p>

		<div id="crayon-56d5910f48d63405479913" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-2">2</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-4">4</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-6">6</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-8">8</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-10">10</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-12">12</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-14">14</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-16">16</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-18">18</p><p class="crayon-num" data-line="crayon-56d5910f48d63405479913-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d63405479913-20">20</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5910f48d63405479913-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span><span class="crayon-sy">.</span><span class="crayon-e">localbinarypatterns </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LocalBinaryPatterns</span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LinearSVC</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">imutils </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">paths</span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-8"><span class="crayon-c"># construct the argument parse and parse the arguments</span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-9"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-10"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-t"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--training"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-11"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to the training images"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-12"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-e"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--testing"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-13"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to the tesitng images"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-14"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-15"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-16"><span class="crayon-c"># initialize the local binary patterns descriptor along with</span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-17"><span class="crayon-c"># the data and label lists</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-18"><span class="crayon-v">desc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LocalBinaryPatterns</span><span class="crayon-sy">(</span><span class="crayon-cn">24</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d63405479913-19"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d63405479913-20"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We start off on <strong>Lines 2-6</strong> by importing our necessary command line arguments. Notice how we are importing the 
			<span id="crayon-56d5910f48d67733048180" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">LocalBinaryPatterns</span></span></span>  descriptor from the 
			<span id="crayon-56d5910f48d6b560261339" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">pyimagesearch</span></span></span>  sub-module that we defined above.</p>
<p>From there, <strong>Lines 9-14</strong> handle parsing our command line arguments. We’ll only need two switches here: the path to the 
			<span id="crayon-56d5910f48d6f443493790" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">--</span><span class="crayon-v">training</span></span></span>  data and the path to the 
			<span id="crayon-56d5910f48d72832245710" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">--</span><span class="crayon-v">testing</span></span></span>  data.</p>
<p>In this example, we have partitioned our textures into two sets: a training set of 4 images per texture (4 textures x 4 images per texture = 16 total images), and a testing set of one image per texture (4 textures x 1 image per texture = 4 images). The training set of 16 images will be used to “teach” our classifier — and then we’ll evaluate performance on our testing set of 4 images.</p>
<p>On <strong>Line 18</strong> we initialize our 
			<span id="crayon-56d5910f48d76142236120" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">LocalBinaryPattern</span></span></span>  descriptor using a <em>numPoints=24</em> and <em>radius=8</em>.</p>
<p>In order to store the LBP feature vectors and the label names associated with each of the texture classes, we’ll initialize two lists: 
			<span id="crayon-56d5910f48d7a538900657" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">data</span></span></span>  to store the feature vectors and 
			<span id="crayon-56d5910f48d7d005600708" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">labels</span></span></span>  to store the names of each texture (<strong>Lines 19 and 20</strong>).</p>
<p>Now it’s time to extract LBP features from our set of training images:</p>

		<div id="crayon-56d5910f48d81125973387" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d81125973387-22">22</p><p class="crayon-num" data-line="crayon-56d5910f48d81125973387-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d81125973387-24">24</p><p class="crayon-num" data-line="crayon-56d5910f48d81125973387-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d81125973387-26">26</p><p class="crayon-num" data-line="crayon-56d5910f48d81125973387-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d81125973387-28">28</p><p class="crayon-num" data-line="crayon-56d5910f48d81125973387-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d81125973387-30">30</p><p class="crayon-num" data-line="crayon-56d5910f48d81125973387-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d81125973387-32">32</p><p class="crayon-num" data-line="crayon-56d5910f48d81125973387-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d81125973387-34">34</p><p class="crayon-num" data-line="crayon-56d5910f48d81125973387-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d81125973387-36">36</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d81125973387-22"><span class="crayon-c"># loop over the training images</span></p><p class="crayon-line" id="crayon-56d5910f48d81125973387-23"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">imagePath </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-e">list_images</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"training"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d81125973387-24"><span class="crayon-h">	</span><span class="crayon-c"># load the image, convert it to grayscale, and describe it</span></p><p class="crayon-line" id="crayon-56d5910f48d81125973387-25"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">imagePath</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d81125973387-26"><span class="crayon-h">	</span><span class="crayon-v">gray</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_BGR2GRAY</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d81125973387-27"><span class="crayon-h">	</span><span class="crayon-v">hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">desc</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-v">gray</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d81125973387-28"> </p><p class="crayon-line" id="crayon-56d5910f48d81125973387-29"><span class="crayon-h">	</span><span class="crayon-c"># extract the label from the image path, then update the</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d81125973387-30"><span class="crayon-h">	</span><span class="crayon-c"># label and data lists</span></p><p class="crayon-line" id="crayon-56d5910f48d81125973387-31"><span class="crayon-h">	</span><span class="crayon-v">labels</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">imagePath</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"/"</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d81125973387-32"><span class="crayon-h">	</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hist</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d81125973387-33"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d81125973387-34"><span class="crayon-c"># train a Linear SVM on the data</span></p><p class="crayon-line" id="crayon-56d5910f48d81125973387-35"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearSVC</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-cn">100.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d81125973387-36"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We start looping over our training images on <strong>Line 23</strong>. For each of these images, we load them from disk, convert them to grayscale, and extract Local Binary Pattern features. The label (i.e., texture name) is then extracted from the image path and both our 
			<span id="crayon-56d5910f48d86156991352" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">labels</span></span></span>  and 
			<span id="crayon-56d5910f48d8a765506623" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">data</span></span></span>  lists are updated, respectively.</p>
<p>Once we have our features and labels extracted, we can train our <a href="https://en.wikipedia.org/wiki/Support_vector_machine#Linear_SVM" target="_blank">Linear Support Vector Machine</a> on <strong>Lines 35 and 36</strong> to learn the difference between the various texture classes.</p>
<p>Once our Linear SVM is trained, we can use it to classify subsequent texture images:</p>

		<div id="crayon-56d5910f48d8e309078356" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d8e309078356-38">38</p><p class="crayon-num" data-line="crayon-56d5910f48d8e309078356-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d8e309078356-40">40</p><p class="crayon-num" data-line="crayon-56d5910f48d8e309078356-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d8e309078356-42">42</p><p class="crayon-num" data-line="crayon-56d5910f48d8e309078356-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d8e309078356-44">44</p><p class="crayon-num" data-line="crayon-56d5910f48d8e309078356-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d8e309078356-46">46</p><p class="crayon-num" data-line="crayon-56d5910f48d8e309078356-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d8e309078356-48">48</p><p class="crayon-num" data-line="crayon-56d5910f48d8e309078356-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5910f48d8e309078356-50">50</p><p class="crayon-num" data-line="crayon-56d5910f48d8e309078356-51">51</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d8e309078356-38"><span class="crayon-c"># loop over the testing images</span></p><p class="crayon-line" id="crayon-56d5910f48d8e309078356-39"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">imagePath </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-e">list_images</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"testing"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d8e309078356-40"><span class="crayon-h">	</span><span class="crayon-c"># load the image, convert it to grayscale, describe it,</span></p><p class="crayon-line" id="crayon-56d5910f48d8e309078356-41"><span class="crayon-h">	</span><span class="crayon-c"># and classify it</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d8e309078356-42"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">imagePath</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d8e309078356-43"><span class="crayon-h">	</span><span class="crayon-v">gray</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_BGR2GRAY</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d8e309078356-44"><span class="crayon-h">	</span><span class="crayon-v">hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">desc</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-v">gray</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d8e309078356-45"><span class="crayon-h">	</span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">hist</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d8e309078356-46"> </p><p class="crayon-line" id="crayon-56d5910f48d8e309078356-47"><span class="crayon-h">	</span><span class="crayon-c"># display the image and the prediction</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d8e309078356-48"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">putText</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">FONT_HERSHEY_SIMPLEX</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5910f48d8e309078356-49"><span class="crayon-h">		</span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5910f48d8e309078356-50"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5910f48d8e309078356-51"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Just as we looped over the <em>training images</em> on <strong>Line 22</strong> to gather data to train our classifier, we now loop over the <em>testing images</em> on <strong>Line 39</strong> to test the performance and accuracy of our classifier.</p>
<p>Again, all we need to do is load our image from disk, convert it to grayscale, extract Local Binary Patterns from the grayscale image, and then pass the features onto our Linear SVM for classification (<strong>Lines 42-45</strong>).</p>
<p><strong>Lines 48-51</strong> show the output classification to our screen.</p>
<h2>Results</h2>
<p>Let’s go ahead and give our texture classification system a try by executing the following command:</p>

		<div id="crayon-56d5910f48d93634566429" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5910f48d93634566429-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">recognize</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">training </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">training</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">testing </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">testing</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>And here’s the first output image from our classification:</p>
<div id="attachment_3449" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_area_rug_result.jpg"><img class="size-full wp-image-3449" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_area_rug_result.jpg" alt="Figure 11: Our Linear SVM + Local Binary Pattern combination is able to correctly classify the area rug pattern." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_area_rug_result-300x254.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_area_rug_result.jpg 500w" sizes="(max-width: 500px) 100vw, 500px"/></a><p class="wp-caption-text"><strong>Figure 11:</strong> Our Linear SVM + Local Binary Pattern combination is able to correctly classify the area rug pattern.</p></div>
<p>Sure enough, the image is correctly classified as “area rug”.</p>
<p>Let’s try another one:</p>
<div id="attachment_3450" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_carpet_result.jpg"><img class="size-full wp-image-3450" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_carpet_result.jpg" alt="Figure 12: We are also able to recognize the carpet pattern." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_carpet_result-300x254.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_carpet_result.jpg 500w" sizes="(max-width: 500px) 100vw, 500px"/></a><p class="wp-caption-text"><strong>Figure 12:</strong> We are also able to recognize the carpet pattern.</p></div>
<p>Once again, our classifier correctly identifies the texture/pattern of the image.</p>
<p>Here’s an example of the keyboard pattern being correctly labeled:</p>
<div id="attachment_3451" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_keyboard_result.jpg"><img class="size-full wp-image-3451" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_keyboard_result.jpg" alt="Figure 13: Classifying the keyboard pattern is also easy for our method." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_keyboard_result-300x254.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_keyboard_result.jpg 500w" sizes="(max-width: 500px) 100vw, 500px"/></a><p class="wp-caption-text"><strong>Figure 13:</strong> Classifying the keyboard pattern is also easy for our method.</p></div>
<p>Finally, we are able to recognize the texture and pattern of the wrapping paper as well:</p>
<div id="attachment_3452" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_wrapping_paper_result.jpg"><img class="size-full wp-image-3452" src="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_wrapping_paper_result.jpg" alt="Figure 14: Using Local Binary Patterns to classify the texture of an image." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_wrapping_paper_result-300x243.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/12/lbp_wrapping_paper_result.jpg 500w" sizes="(max-width: 500px) 100vw, 500px"/></a><p class="wp-caption-text"><strong>Figure 14:</strong> Using Local Binary Patterns to classify the texture of an image.</p></div>
<p>While this example was quite small and simple, it was still able to demonstrate that by using Local Binary Pattern features and a bit of machine learning, we are able to correctly classify the texture and pattern of an image.</p>
<h2>Summary</h2>
<p>In this blog post we learned how to extract Local Binary Patterns from images and use them (along with a bit of machine learning) to perform <strong><em>texture and pattern recognition</em></strong>.</p>
<p>If you enjoyed this blog post, be sure to take a look at the <em><strong><a href="http://www.pyimagesearch.com/pyimagesearch-gurus/" target="_blank">PyImageSearch Gurus course</a></strong></em> where the majority this lesson was derived from.</p>
<p>Inside the course you’ll find over <strong>166+ lessons</strong> covering <strong>1,291</strong> pages of computer vision topics such as:</p>
<ul>
<li>Face recognition.</li>
<li>Deep learning.</li>
<li>Automatic license plate recognition.</li>
<li>Training your own custom object detectors.</li>
<li>Building image search engines.</li>
<li><em>…and much more!</em></li>
</ul>
<p><strong>If this sounds interesting to you, <em><a href="http://www.pyimagesearch.com/pyimagesearch-gurus/" target="_blank">be sure to take a look and consider signing up for the next open enrollment!</a></em></strong></p>
<p>See you next week!</p>
<h2 id="post_downloads">Downloads:</h2>

	</section>
	</div></body></html>