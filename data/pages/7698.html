<html><body><div><div class="section">
              <h1>contextualized 1.1</h1>

              


<p>Get tracebacks with context.</p>








<p>If you have ever wrote a Python program that processes large input files you probably have been in a situation where you get an error on certain file and line. You may get a traceback telling you have e.g. a <tt>KeyError</tt> but still don’t know what line in that text file provoked it.</p>
<p>Then you may start adding <tt>print(line)</tt> calls every time a line is processed, but that’s quirky, clutters your terminal quickly and you’ll have to eventually remove it, only to later add it when the next bug hits.</p>
<p>This module is an alternative to improve this kind of debugging issue, making it clean and robust, whilst providing a easy to use API.</p>
<p>This module works by providing you with a context object where you can set state variables like file name and line number. When an unhandled exception is raised, this module catches it and prints the value of the state variables along with the traceback.</p>
<p>Example code:</p>
<pre><span class="kn">from</span> <span class="nn">contextualized</span> <span class="kn">import</span> <span class="n">contextualized_tracebacks</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">dcontext</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="s1">'hello.txt'</span>
    <span class="n">a</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">a</span><span class="p">():</span>
    <span class="n">dcontext</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">b</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">b</span><span class="p">():</span>
    <span class="c1"># buggy code</span>
    <span class="n">nonexistent</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">with</span> <span class="n">contextualized_tracebacks</span><span class="p">([</span><span class="s1">'file'</span><span class="p">,</span> <span class="s1">'line'</span><span class="p">,</span> <span class="s1">'character'</span><span class="p">])</span> <span class="k">as</span> <span class="n">dcontext</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre>
<p>This program will show this once run:</p>
<pre>Traceback (most recent call last):
  File "contextualized_example.py", line 16, in &lt;module&gt;
    main()
  File "contextualized_example.py", line 5, in main
    a()
  File "contextualized_example.py", line 9, in a
    b()
  File "contextualized_example.py", line 13, in b
    nonexistent += 1
UnboundLocalError: local variable 'nonexistent' referenced before assignment
The exception was caught on file 'hello.txt', line 20.
</pre>
<p>The context information is right after the traceback. Notice how only non <tt>None</tt> fields are shown. They also preserve the order from the <tt>contextualized_tracebacks()</tt> call.</p>
<div id="overriding-the-traceback-print-function">
<h2>Overriding the traceback print function</h2>
<p>You can override the default traceback print with the <tt>print_tb</tt> argument. For example, this example will print the context <strong>before</strong> the traceback.</p>
<pre><span class="kn">from</span> <span class="nn">contextualized</span> <span class="kn">import</span> <span class="n">contextualized_tracebacks</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">dcontext</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="s1">'hello.txt'</span>
    <span class="n">a</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">a</span><span class="p">():</span>
    <span class="n">dcontext</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">b</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">b</span><span class="p">():</span>
    <span class="c1"># buggy code</span>
    <span class="n">nonexistent</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">my_print_tb</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">tb_info</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">traceback</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">'An exception was caught on </span><span class="si">%s</span><span class="s1">.'</span> <span class="o">%</span> <span class="n">context</span><span class="o">.</span><span class="n">_to_prose</span><span class="p">(),</span>
          <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exception</span><span class="p">(</span><span class="o">*</span><span class="n">tb_info</span><span class="p">)</span>

<span class="k">with</span> <span class="n">contextualized_tracebacks</span><span class="p">([</span><span class="s1">'file'</span><span class="p">,</span> <span class="s1">'line'</span><span class="p">,</span> <span class="s1">'character'</span><span class="p">],</span>
                               <span class="n">print_tb</span><span class="o">=</span><span class="n">my_print_tb</span><span class="p">)</span> <span class="k">as</span> <span class="n">dcontext</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre>
<p>This will be the new output:</p>
<pre>An exception was caught on file 'hello.txt', line 20.
Traceback (most recent call last):
  File "contextualized_example.py", line 25, in &lt;module&gt;
    main()
  File "contextualized_example.py", line 5, in main
    a()
  File "contextualized_example.py", line 9, in a
    b()
  File "contextualized_example.py", line 13, in b
    nonexistent += 1
UnboundLocalError: local variable 'nonexistent' referenced before assignment
</pre>
</div>

<div id="changelog">
<h2>Changelog</h2>
<ul>
<li><strong>1.0</strong>: Initial release.</li>
<li><strong>1.1</strong>: SystemExit exceptions no longer are catched, thus triggering normal <tt>exit()</tt> by the interpreter.</li>
</ul>
</div>
<div id="license">
<h2>License</h2>
<p>This module is under the MIT License.</p>
<p>Copyright (c) 2015 Juan Luis Boya García</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the “Software”), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>
</div>


<a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>20</span> downloads in the last week
  </li>
  <li>
    <span>169</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>