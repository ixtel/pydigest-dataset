<html><body><div><div class="field-item even" property="content:encoded"> <p>Impacket is a collection of Python classes for working with network protocols. Impacket is focused on providing low-level programmatic access to the packets and for some protocols (for instance NMB, SMB1-3 and MS-DCERPC) the protocol implementation itself.<br/> Packets can be constructed from scratch, as well as parsed from raw data, and the object oriented API makes it simple to work with deep hierarchies of protocols. The library provides a set of tools as examples of what can be done within the context of this library.</p>
<h3 id="toc1">The following protocols are featured in Impacket</h3>
<ul><li>Ethernet, Linux "Cooked" capture.</li>
<li>IP, TCP, UDP, ICMP, IGMP, ARP.</li>
<li>NMB and SMB1/2/3 (high-level implementations).</li>
<li>DCE/RPC version 5, over different transports: TCP, SMB/TCP, SMB/NetBIOS and HTTP.</li>
<li>Multiple ways of doing SMB tree_connect, file open, read, write.</li>
<li>SMB "fragmentation", SMB AndX command chaining.</li>
<li>Plain, NTLM and Kerberos authentications, using password/hashes/tickets/keys.</li>
<li>Portions/full implementation of the following DCE/RPC interfaces: EPM, DTYPES, LSAD, LSAT, NRPC, RRP, SAMR, SRVS, WKST, SCMR, DCOM, WMI</li>
<li>DCERPC Alternate contexts, Multi-bind requests, Endianness selection</li>
<li>DCERPC NTLM, NETLOGON and Kerberos authentication, integrity checking and encryption.</li>
<li>Take a look at <a href="http://www.coresecurity.com/system/files/RicharteSolino_2006-impacketv0.9.6.0%20%281%29.pdf" target="_blank">this document</a> for an explanation of the advanced SMB and DCERPC features(outdated for the current version :-/)</li>
</ul><h3 id="toc2">The following tools are featured in Impacket</h3>

<p>A semi-interactive shell, used through Windows Management Instrumentation. It does not require to install any service/agent at the target server. Runs as Administrator. Highly stealthy.</p>

<p>Performs various techniques to dump secrets from the remote machine without executing any agent there. For SAM and LSA Secrets (including cached creds) we try to read as much as we can from the registry and then we save the hives in the target system (%SYSTEMROOT%\Temp dir) and read the rest of the data from there. For NTDS.dit, we dump NTLM hashes, Plaintext credentials (if available) and Kerberos keys using the DL_DRSGetNCChanges() method. It can also dump NTDS.dit via vssadmin executed with the smbexec approach. The scripts initiates the services required for its working if they are not available (e.g. Remote Registry, even if it is disabled). After the work is done, things are restored to the original state.</p>

<p>This script creates/removes a WMI Event Consumer/Filter and link between both to execute Visual Basic based on the WQL filter or timer specified.</p>

<p>MS14-068 exploit. Saves the golden ticket and also launches a psexec session at the target.</p>

<p>PSEXEC like functionality example using RemComSvc(<a href="https://github.com/kavika13/RemCom" target="_blank">https://github.com/kavika13/RemCom</a>)</p>

<p>It allows to issue WQL queries and get description of WMI objects at the target system (e.g. select name from win32_account).</p>

<p>[MS-SCMR] use to manipulate windows services. It supports start, stop, delete, status, config, list, create and change.</p>

<p>An MSSQL client, supporting SQL and Windows Authentications (hashes too). It also supports TLS</p>

<p>Retrieves the MSSQL instances names from the target host</p>

<p>Allows dumping catalog, pages and tables of ESE databases (e.g. NTDS.dit)</p>

<p>Gets a list of the sessions opened at the remote hosts and keep track of them looping over the hosts found and keeping track of who logged in/out from remote servers</p>

<p>Mini shell for browsing an NTFS volume</p>

<p>This module performs the SMB Relay attacks originally discovered by cDc. It receives a list of targets and for every connection received it will choose the next target and try to relay the credentials. Also, if specified, it will first to try authenticate against the client connecting to us.<br/> It is implemented by invoking a SMB and HTTP Server, hooking to a few functions and then using the smbclient portion. It is supposed to be working on any LM Compatibility level. The only way to stop this attack is to enforce on the server SPN checks and or signing. If the authentication against the targets succeed, the client authentication success as well and a valid connection is set against the local smbserver. It's up to the user to set up the local smbserver functionality. One option is to set up shares with whatever files you want to the victim thinks it's connected to a valid SMB server. All that is done through the smb.conf file or programmatically.</p>

<p>[MS-RDPBCGR] and [MS-CREDSSP] partial implementation just to reach CredSSP auth. This example test whether an account is valid on the target host.</p>

<p>A Windows offline registry Reader example</p>

<p>A similar approach to psexec w/o using RemComSvc. The technique is described here <a href="http://blog.accuvant.com/rdavisaccuvant/owning-computers-without-shell-access/" target="_blank">http://blog.accuvant.com/rdavisaccuvant/owning-computers-without-shell-access/</a>.<br/> Our implementation goes one step further, instantiating a local smbserver to receive the output of the commands. This is useful in the situation where the target machine does NOT have a writeable share available.</p>

<p>An application that communicates with the Endpoint Mapper interface from the DCE/RPC suite. This can be used to list services that are remotely available through DCE/RPC.</p>

<p>An application that communicates with the Security Account Manager Remote interface from the DCE/RPC suite. It lists system user accounts, available resource shares and other sensitive information exported through this service.</p>

<p>A generic SMB client that will let you list shares and files, rename, upload and download files and create and delete directories, all using either username and password or username and hashes combination. It's an excellent example to see how to use impacket.smb in action.</p>

<p>A python implementation of an SMB server.</p>

<p>A SMB Server that answers specific file contents regardless of the SMB share and pathname specified.</p>

<p>First, this binds to the MGMT interface and gets a list of interface IDs. It adds to this a large list of interface UUIDs seen in the wild. It then tries to bind to each interface and reports whether the interface is listed and/or listening.</p>

<p>A Windwows SID brute forcer example, aiming at finding remote users/groups</p>

<p>This binds to the given hostname:port and DCERPC interface. Then, it tries to call each of the first 256 operation numbers in turn and reports the outcome of each call.</p>

<p>This example executes a command on the target machine through the Task Scheduler service. Returns the output of such command</p>
<h3 id="toc28">Source code</h3>
<ul><li>You can check out trunk (devel version) at <a href="https://github.com/CoreSecurity/impacket" target="_blank">https://github.com/CoreSecurity/impacket</a></li>
<li>0.9.14, updated on Jan 7th, 2016 - <a href="https://pypi.python.org/packages/source/i/impacket/impacket-0.9.14.tar.gz" target="_blank">gzip'd tarball</a>,</li>
<li>0.9.13, updated on May 4th, 2015 - <a href="https://pypi.python.org/packages/source/i/impacket/impacket-0.9.13.tar.gz" target="_blank">gzip'd tarball</a>,</li>
<li>0.9.12, updated on July 20th, 2014 - <a href="https://pypi.python.org/packages/source/i/impacket/impacket-0.9.12.tar.gz" target="_blank">gzip'd tarball</a>,</li>
<li>0.9.11, updated on Feb 3, 2014 - <a href="http://www.coresecurity.com/system/files/impacket-0.9.11.tar_.gz" target="_blank">gzip'd tarball</a>,</li>
<li>0.9.10, updated on May 6, 2013 - <a href="http://www.coresecurity.com/system/files/impacket-0.9.10.tar_.gz" target="_blank">gzip'd tarball</a>,</li>
<li>0.9.9.9, updated on July 20, 2012 - <a href="https://www.coresecurity.com/system/files/impacket-0.9.9.9.tar_.gz" target="_blank">gzip'd tarball</a>, <a href="http://www.coresecurity.com/system/files/impacket-0.9.9.9.zip" target="_blank">zip file</a></li>
<li>0.9.6.0, updated on May 23, 2006 - <a href="http://www.coresecurity.com/system/files/Impacket-0.9.6.0.tar_.gz" target="_blank">gzip'd tarball</a></li>
<li>0.9.5.2, updated on Apr 3, 2006 - <a href="http://www.coresecurity.com/system/files/Impacket-0.9.5.2.tar_.gz" target="_blank">gzip'd tarball</a>, <a href="http://www.coresecurity.com/system/files/Impacket-0.9.5.2.zip" target="_blank">zip file</a></li>
<li>0.9.5.1, updated on Dec 16, 2003 - <a href="http://www.coresecurity.com/system/files/Impacket-0.9.5.1.tar_.gz" target="_blank">gzip'd tarball</a>, <a href="http://www.coresecurity.com/system/files/Impacket-0.9.5.1.zip" target="_blank">zip file</a></li>
</ul><h3 id="toc29">Setup</h3>
<ul><li><strong>Quick start</strong>: Click the following link to obtain the latest version <a href="https://pypi.python.org/packages/source/i/impacket/impacket-0.9.14.tar.gz" target="_blank">gzip'd tarbal</a></li>
<li><strong>Requirements</strong>: <a href="http://www.python.org/" target="_blank">Python</a> interpreter. Versions 2.5 and higher. pyOpenSSL and PyCrypto also required</li>
<li><strong>Installing</strong>: In order to install the code, execute<br/><pre>python setup.py install</pre><p>from the directory where Impacket's distribution has been placed. This will install the classes into the default Python's modules path (you might need special permissions to write there). For more information on what commands and options are available from setup.py, run</p>
<pre>python setup.py --help-commands</pre></li>
</ul><h3 id="toc30">Documentation</h3>
<p>Most documentation is included in the source as Python's <span>doc</span> comments, but were are some examples upon which you can base your own programs:</p>
<h3 id="toc31">Licensing</h3>
<p>This software is provided under a slightly modified version of the Apache Software License. Feel free to review it <a href="https://github.com/CoreSecurity/impacket/tree/impacket_0_9_14/LICENSE" target="_blank">here</a> and compare it to the official Apache Software License.</p>
<h3 id="toc32">Contact Us</h3>
<p>Whether you want to report a bug, send a patch or give some suggestions on this package, drop us a few lines at oss- at -coresecurity.com.</p>
<p><strong>Release date:</strong> 2003</p>
<h3>Related Tools</h3>
<p><a href="/corelabs-research/open-source-tools/pcapy">Pcapy</a><span> | </span><a href="/corelabs-research/open-source-tools/wpsig">WPSIG</a></p>
 </div></div></body></html>