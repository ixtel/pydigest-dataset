<html><body><div><p>The edge-color scheme is the same as in the original paper by Adamic and Glance, i.e. each node corresponds to a blog url and the colors reflect political orientation, red for conservative, and blue for liberal. Orange edges go from liberal blogs to conservative blogs, and purple ones from conservative to liberal (cf  fig. 1 in Adamic and Glance).</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">graph_tool.all</span> <span class="kn">as</span> <span class="nn">gt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">"polblogs"</span><span class="p">]</span> <span class="c">#  http://www2.scedu.unibo.it/roversi/SocioNet/AdamicGlanceBlogWWW.pdf</span>
<span class="k">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">num_vertices</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">num_edges</span><span class="p">())</span>

<span class="c">#reduce to only connected nodes</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">GraphView</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">vfilt</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">purge_vertices</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">num_vertices</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">num_edges</span><span class="p">())</span>

<span class="c">#use 1-&gt;Republican, 2-&gt;Democrat</span>
<span class="n">red_blue_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">:(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span>
<span class="n">plot_color</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s">'vector&lt;double&gt;'</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s">'plot_color'</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_color</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
    <span class="n">plot_color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">red_blue_map</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s">'value'</span><span class="p">][</span><span class="n">v</span><span class="p">]]</span>

<span class="c">#edge colors</span>
<span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span>
<span class="n">edge_color</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s">'vector&lt;double&gt;'</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">edge_properties</span><span class="p">[</span><span class="s">'edge_color'</span><span class="p">]</span><span class="o">=</span><span class="n">edge_color</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">plot_color</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()]</span> <span class="o">!=</span> <span class="n">plot_color</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]:</span>
        <span class="k">if</span> <span class="n">plot_color</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
            <span class="c">#orange on dem -&gt; rep</span>
            <span class="n">edge_color</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">255.0</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="mi">102</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="mi">0</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edge_color</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">102.0</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="mi">51</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="mi">153</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="c">#red on rep-rep edges</span>
    <span class="k">elif</span> <span class="n">plot_color</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">edge_color</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="c">#blue on dem-dem edges</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">edge_color</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">minimize_nested_blockmodel_dl</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">deg_corr</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">bstack</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_bstack</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">get_hierarchy_tree</span><span class="p">(</span><span class="n">bstack</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tpos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">radial_tree_layout</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">num_vertices</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">cts</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">get_hierarchy_control_points</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">tpos</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">own_property</span><span class="p">(</span><span class="n">tpos</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">bstack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s">"b"</span><span class="p">]</span>

<span class="c">#labels</span>
<span class="n">text_rot</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s">'double'</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s">'text_rot'</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_rot</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">pos</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">text_rot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">pos</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text_rot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">pos</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">gt</span><span class="o">.</span><span class="n">graph_draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s">'plot_color'</span><span class="p">],</span>
            <span class="n">vertex_color</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s">'plot_color'</span><span class="p">],</span>
            <span class="n">edge_control_points</span><span class="o">=</span><span class="n">cts</span><span class="p">,</span>
            <span class="n">vertex_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">vertex_text</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s">'label'</span><span class="p">],</span>
            <span class="n">vertex_text_rotation</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s">'text_rot'</span><span class="p">],</span>
            <span class="n">vertex_text_position</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">vertex_font_size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
            <span class="n">edge_color</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">edge_properties</span><span class="p">[</span><span class="s">'edge_color'</span><span class="p">],</span>
            <span class="n">vertex_anchor</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">bg_color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">output_size</span><span class="o">=</span><span class="p">[</span><span class="mi">4024</span><span class="p">,</span><span class="mi">4024</span><span class="p">],</span>
            <span class="n">output</span><span class="o">=</span><span class="s">'polblogs_blockmodel.png'</span><span class="p">)</span></code></pre></div>

</div></body></html>