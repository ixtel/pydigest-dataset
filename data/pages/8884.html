<html><body><div><div class="post-text" itemprop="text">

<p>In the <a href="https://www.hackerrank.com/challenges/ashton-and-string" rel="nofollow">Ashton String task</a>, the goal is to:</p>

<blockquote>
  <p>Arrange all the distinct substrings of a given string in
  lexicographical order and concatenate them. Print the Kth character of
  the concatenated string. It is assured that given value of K will be
  valid i.e. there will be a Kth character. </p>
</blockquote>

<p>The <code>Input Format</code>:</p>

<blockquote>
  <p>First line will contain a number T i.e. number of test cases.  First
  line of each test case will contain a string containing characters
  (a−z) and second line will contain a number K.</p>
</blockquote>

<p>The <code>Output Format</code>:</p>

<blockquote>
  <p>Print Kth character ( the string is 1 indexed )</p>
</blockquote>

<p>And the <code>Constraints</code> are</p>

<blockquote>
  <p>1 ≤ T ≤ 5<br/>
  1 ≤ length ≤ 105<br/>
  K will be an appropriate integer.</p>
</blockquote>

<p>For example, given the input:</p>

<pre><code>1
dbac
3
</code></pre>

<p>The output would be: <code>c</code></p>

<p>I've attempted the task with this code and it works for relatively short strings:</p>

<pre><code>from itertools import chain

def zipngram(text, n=2):
    words = list(text)
    return zip(*[words[i:] for i in range(n)])

for _ in input():
    t = input()
    position = int(input())-1 # 0th indexing
    chargrams = chain(*[zipngram(t,i) for i in range(1,len(t)+1)])
    concatstr = ''.join(sorted([''.join(s) for s in chargrams]))
    print (concatstr[position])
</code></pre>

<p>But if the input file looks like this: <a href="http://pastebin.com/raw/WEi2p09H" rel="nofollow">http://pastebin.com/raw/WEi2p09H</a> and the desired output is:</p>

<pre><code>l
s
y
h
s
</code></pre>

<p>The interpreter will throw a <code>MemoryError</code>:</p>

<pre><code>Traceback (most recent call last):
  File "solution.py", line 11, in &lt;module&gt;
    chargrams = chain(*[zipngram(t,i) for i in range(1,len(t)+1)])
  File "solution.py", line 11, in &lt;listcomp&gt;
    chargrams = chain(*[zipngram(t,i) for i in range(1,len(t)+1)])
  File "solution.py", line 6, in zipngram
    return zip(*[words[i:] for i in range(n)])
  File "solution.py", line 6, in &lt;listcomp&gt;
    return zip(*[words[i:] for i in range(n)])
MemoryError
</code></pre>

<p><strong>How can the MemoryError be resolved? Is it solvable in another way using native python2 or python3?</strong> </p>

<p>I tried to resolve the <code>MemoryError</code> by pruning the stack using <code>heapq</code> but now it goes into an uber slow runtime pushing and popping the heap instead of taking up too much memory.</p>

<pre><code>from itertools import chain
import heapq

t = int(input())
s = list(input())
k = int(input())

stack = []
for n in range(1,len(s)+1):
    for j in range(n):
        ngram = (''.join(s[j:]))
        ngram_len = len(ngram)
        # Push the ngram into the heapq.
        heapq.heappush(stack, ngram)
        pruned_stack = []
        temp_k = 0
        # Prune stack.
        while stack != [] and temp_k &lt; k:
            x = heapq.heappop(stack)
            pruned_stack.append(x)
            temp_k+=len(x)
        # Replace stack with pruend_stack.
        stack = pruned_stack

print (''.join(chain(*pruned_stack))[k])
</code></pre>

<p><strong>Is there a way to balance between not using too much memory that it leads to <code>MemoryError</code> and too slow runtime with <code>heapq</code> pushing and popping?</strong></p>
    </div>
    </div></body></html>