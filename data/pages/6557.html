<html><body><div><div class="entry-content">
		<p>For some this may sound like some NSA mind control scheme, The Hack? It’s simple using the LED’s on the router for your project without any modification.</p>
<blockquote><p>No DD-WRT, OPEN-WRT just telnet like the good old days.</p></blockquote>
<p><strong>STORY :</strong> While hanging out with @LegendaryDude i asked for one of his spare SLT Prolink H5004NK router with the hope of getting Open-WRT on it, After a minute of googling rooting this box became a dream. I like telnetting stuff as usual; After Telnetting this box i found out this native shell interface nothing fancy like busybox or bash just a crappy vendor shell, while monkeying around i found the LED debug mode and it was just awesome how the system allows you to individually address and  change the indicators without disrupting  the normal workflow.</p>
<h3>Telnet interface for controlling the LED’s</h3>
<pre><code>
➜  codes  telnet 192.168.1.1
Trying 192.168.1.1...
Connected to 192.168.1.1.
Escape character is '^]'.

User Access Verification

Username: admin

Password: 

$sh
ADSL#led


Looking for :
  test                      enter led test mode
ADSL#led test
ADSL(led-test)#ls
command: "ls" is unknown
Looking for :
  start                     
  stop                      
  reset                     
  set  
ADSL(led-test)#start
ADSL(led-test)#set 


Looking for :
  power                     
  dsl                       
  internet                  
  lan                       
  wlan                      
  wps                       
ADSL(led-test)#set power 


Looking for :
  red                       
  green                     
ADSL(led-test)#set power red 
ADSL(led-test)#stop      
</code></pre>
<p>Now What?</p>
<h3>Automation Time</h3>
<p>I selected Python for this project since, It’s a hack and the cool kids these days write exploits on Python not on Ruby <strong>in fact, fuck ruby</strong> not me some speaker at Defcon 18 told that; The other reason is that i want to learn <a href="https://www.python.org/dev/peps/pep-0328/">PEP 0328</a> Anyway here is the main part of code where the magic happens, nothing magical just using the plain old telnetlib all in the standard library</p>
<blockquote><p><strong>GET THE CODE <a href="https://github.com/KaveenR/H5004NK_LED">HERE</a> </strong></p></blockquote>
<p> </p>
<pre><code>
import telnetlib
class led:

    def __init__(self,HOST,USR,PASS):
        self.ready = False
        self.NL = "\r\n"
        self.tn = None
        self.tn = telnetlib.Telnet(HOST)
        self.tn.read_until("Username: ")
        self.tn.write(USR + self.NL)
        self.tn.read_until("Password: ")
        self.tn.write(PASS + self.NL)
        if "$" not in self.tn.read_until("$"):
            raise Exception("Authentication Error")
        else:
            self.tn.write("sh" + self.NL)
            self.tn.write("led test" + self.NL)
            self.ready = True
    def ledmode(self,STATE):
        if self.ready:
            if STATE:
                self.tn.write("start" + self.NL)
            else :
                self.tn.write("stop" + self.NL)
        else:
            raise Exception("Not Connected")

    def set(self,NAME,STATE):
        if self.ready:
            self.tn.write("set " + NAME + " " + STATE + self.NL)
        else:
            raise Exception("Not Connected")

    def disconnect(self):
        if self.ready:
            self.ledmode(False)
            self.tn.write("exit" + self.NL)
            self.tn.write("quit" + self.NL)
            self.tn.write("exit" + self.NL)
        else:
            raise Exception("Not Connected")

</code></pre>
<h3> Quick Example usage of the Library</h3>
<pre>&gt;&gt;&gt; import H5004NK_LED
&gt;&gt;&gt; asd = H5004NK_LED.led("192.168.1.1","admin","password")
&gt;&gt;&gt; asd.ledmode(True)
&gt;&gt;&gt; asd.set("power","red")
&gt;&gt;&gt; asd.set("dsl","red")
&gt;&gt;&gt; asd.set("dsl","")
&gt;&gt;&gt; asd.set("lan","2")
&gt;&gt;&gt; asd.set("lan","3")
&gt;&gt;&gt; asd.set("lan","4")
&gt;&gt;&gt; asd.set("wlan","green")
&gt;&gt;&gt; asd.set("internet","red")
&gt;&gt;&gt; asd.ledmode(False)
&gt;&gt;&gt; asd.disconnect()
</pre>
<p> </p>
<h3>Demo Time</h3>
<p>I will talk about one demo called “FEDS”, this is a simple one that simply simulates a Police lights,</p>
<p> </p>
<blockquote class="instagram-media" data-instgrm-version="4">

</blockquote>
<p/>
<pre><code>
➜  codes  python -m H5004NK_LED.tests.feds -u admin -p password
FEDS! 
Ctrl-C to exit
^CYou pressed Ctrl+C!
➜  codes  
</code></pre>
<p>As you guys can see the possibilities are endless <strong>:3</strong></p>
<p>Well I’m currently writing an Tweet notifier, therefore when a new tweet comes my router should start doing weird shit :3, see you around</p>
<p><strong>   </strong></p>
<span><img src="http://lifeofenigma.com/wp-content/plugins/wp-spamfree/img/wpsf-img.php" alt=""/></span>			</div>
</div></body></html>