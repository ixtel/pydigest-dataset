<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-django-post-office" class="anchor" href="#django-post-office" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Django Post Office</h1>
<p>Django Post Office is a simple app to send and manage your emails in Django.
Some awesome features are:</p>
<ul>
<li>Allows you to send email asynchronously</li>
<li>Multi backend support</li>
<li>Supports HTML email</li>
<li>Supports database based email templates</li>
<li>Built in scheduling support</li>
<li>Works well with task queues like <a href="http://python-rq.org">RQ</a> or <a href="http://www.celeryproject.org">Celery</a></li>
<li>Uses multiprocessing to send a large number of emails in parallel</li>
<li>Supports multilingual email templates (i18n)</li>
</ul>
<a name="user-content-dependencies"/>
<h2><a id="user-content-dependencies" class="anchor" href="#dependencies" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Dependencies</h2>

<a name="user-content-installation"/>
<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>
<p><a href="https://travis-ci.org/ui/django-post_office"><img alt="Build Status" src="https://camo.githubusercontent.com/c442acca644a0755910d15bce997f765187dec5f/68747470733a2f2f7472617669732d63692e6f72672f75692f646a616e676f2d706f73745f6f66666963652e706e673f6272616e63683d6d6173746572" data-canonical-src="https://travis-ci.org/ui/django-post_office.png?branch=master"/></a></p>
<ul>
<li><p>Install from PyPI (or you <a href="http://pypi.python.org/pypi/django-post_office">manually download from PyPI</a>):</p>
<pre>pip install django-post_office
</pre>
</li>
<li><p>Add <code>post_office</code> to your INSTALLED_APPS in django's <code>settings.py</code>:</p>
</li>
</ul>
<div class="highlight highlight-source-python"><pre><span class="pl-c1">INSTALLED_APPS</span> <span class="pl-k">=</span> (
    <span class="pl-c"># other apps</span>
    <span class="pl-s"><span class="pl-pds">"</span>post_office<span class="pl-pds">"</span></span>,
)</pre></div>

<p>If you're still on Django &lt;= 1.6 and use South to manage your migrations,
you'll need to put the following in <code>settings.py</code>:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c1">SOUTH_MIGRATION_MODULES</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">"</span>post_office<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>post_office.south_migrations<span class="pl-pds">"</span></span>,
}</pre></div>
<a name="user-content-quickstart"/>
<h2><a id="user-content-quickstart" class="anchor" href="#quickstart" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Quickstart</h2>
<p>Send a simple email is really easy:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> post_office <span class="pl-k">import</span> mail

mail.send(
    <span class="pl-s"><span class="pl-pds">'</span>recipient@example.com<span class="pl-pds">'</span></span>, <span class="pl-c"># List of email addresses also accepted</span>
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">subject</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>My email<span class="pl-pds">'</span></span>,
    <span class="pl-v">message</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Hi there!<span class="pl-pds">'</span></span>,
    <span class="pl-v">html_message</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Hi &lt;strong&gt;there&lt;/strong&gt;!<span class="pl-pds">'</span></span>,
)</pre></div>
<p>If you want to use templates, ensure that Django's admin interface is enabled. Create an
<code>EmailTemplate</code> instance via <code>admin</code> and do the following:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> post_office <span class="pl-k">import</span> mail

mail.send(
    <span class="pl-s"><span class="pl-pds">'</span>recipient@example.com<span class="pl-pds">'</span></span>, <span class="pl-c"># List of email addresses also accepted</span>
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">template</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>welcome_email<span class="pl-pds">'</span></span>, <span class="pl-c"># Could be an EmailTemplate instance or name</span>
    <span class="pl-v">context</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span>},
)</pre></div>
<p>The above command will put your email on the queue so you can use the
command in your webapp without slowing down the request/response cycle too much.
To actually send them out, run <code>python manage.py send_queued_mail</code>.
You can schedule this management command to run regularly via cron:</p>
<pre>* * * * * (/usr/bin/python manage.py send_queued_mail &gt;&gt; send_mail.log 2&gt;&amp;1)
</pre>
<a name="user-content-usage"/>
<h2><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h2>
<a name="user-content-mail-send"/>
<h3><a id="user-content-mailsend" class="anchor" href="#mailsend" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>mail.send()</h3>
<p><code>mail.send</code> is the most important function in this library, it takes these
arguments:</p>
<table>





<tbody valign="top">
<tr><td>Argument</td>
<td>Required</td>
<td>Description</td>
</tr>
<tr><td>recipients</td>
<td>Yes</td>
<td>list of recipient email addresses</td>
</tr>
<tr><td>sender</td>
<td>No</td>
<td>Defaults to <code>settings.DEFAULT_FROM_EMAIL</code>,
display name is allowed (<code>John &lt;john@a.com&gt;</code>)</td>
</tr>
<tr><td>subject</td>
<td>No</td>
<td>Email subject (if <code>template</code> is not specified)</td>
</tr>
<tr><td>message</td>
<td>No</td>
<td>Email content (if <code>template</code> is not specified)</td>
</tr>
<tr><td>html_message</td>
<td>No</td>
<td>HTML content (if <code>template</code> is not specified)</td>
</tr>
<tr><td>template</td>
<td>No</td>
<td><code>EmailTemplate</code> instance or name</td>
</tr>
<tr><td>language</td>
<td>No</td>
<td>Language in which you want to send the email in
(if you have multilingual email templates.)</td>
</tr>
<tr><td>cc</td>
<td>No</td>
<td>list emails, will appear in <code>cc</code> field</td>
</tr>
<tr><td>bcc</td>
<td>No</td>
<td>list of emails, will appear in bcc field</td>
</tr>
<tr><td>attachments</td>
<td>No</td>
<td><p>Email attachments - A dictionary where the keys
are the filenames and the values are either:</p>
<ul>
<li>files</li>
<li>file-like objects</li>
<li>full path of the file</li>
</ul>
</td>
</tr>
<tr><td>context</td>
<td>No</td>
<td>A dictionary, used to render templated email</td>
</tr>
<tr><td>headers</td>
<td>No</td>
<td>A dictionary of extra headers on the message</td>
</tr>
<tr><td>scheduled_time</td>
<td>No</td>
<td>A date/datetime object indicating when the email
should be sent</td>
</tr>
<tr><td>priority</td>
<td>No</td>
<td><code>high</code>, <code>medium</code>, <code>low</code> or <code>now</code>
(send_immediately)</td>
</tr>
<tr><td>backend</td>
<td>No</td>
<td>Alias of the backend you want to use.
<code>default</code> will be used if not specified.</td>
</tr>
<tr><td>render_on_delivery</td>
<td>No</td>
<td>Setting this to <code>True</code> causes email to be
lazily rendered during delivery. <code>template</code>
is required when <code>render_on_delivery</code> is True.
This way content is never stored in the DB.
May result in significant space savings.</td>
</tr>
</tbody>
</table>
<p>Here are a few examples.</p>
<p>If you just want to send out emails without using database templates. You can
call the <code>send</code> command without the <code>template</code> argument.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> post_office <span class="pl-k">import</span> mail

mail.send(
    [<span class="pl-s"><span class="pl-pds">'</span>recipient1@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">subject</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Welcome!<span class="pl-pds">'</span></span>,
    <span class="pl-v">message</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Welcome home, <span class="pl-c1">{{</span> name <span class="pl-c1">}}</span>!<span class="pl-pds">'</span></span>,
    <span class="pl-v">html_message</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Welcome home, &lt;b&gt;<span class="pl-c1">{{</span> name <span class="pl-c1">}}</span>&lt;/b&gt;!<span class="pl-pds">'</span></span>,
    <span class="pl-v">headers</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>Reply-to<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>reply@example.com<span class="pl-pds">'</span></span>},
    <span class="pl-v">scheduled_time</span><span class="pl-k">=</span>date(<span class="pl-c1">2014</span>, <span class="pl-c1">1</span>, <span class="pl-c1">1</span>),
    <span class="pl-v">context</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>Alice<span class="pl-pds">'</span></span>},
)</pre></div>
<p><code>post_office</code> is also task queue friendly. Passing <code>now</code> as priority into
<code>send_mail</code> will deliver the email right away (instead of queuing it),
regardless of how many emails you have in your queue:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> post_office <span class="pl-k">import</span> mail

mail.send(
    [<span class="pl-s"><span class="pl-pds">'</span>recipient1@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">template</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>welcome_email<span class="pl-pds">'</span></span>,
    <span class="pl-v">context</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span>},
    <span class="pl-v">priority</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>,
)</pre></div>
<p>This is useful if you already use something like <a href="https://github.com/ui/django-rq">django-rq</a>
to send emails asynchronously and only need to store email related activities and logs.</p>
<p>If you want to send an email with attachments:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> django.core.files.base <span class="pl-k">import</span> ContentFile
<span class="pl-k">from</span> post_office <span class="pl-k">import</span> mail

mail.send(
    [<span class="pl-s"><span class="pl-pds">'</span>recipient1@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">template</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>welcome_email<span class="pl-pds">'</span></span>,
    <span class="pl-v">context</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span>},
    <span class="pl-v">priority</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>,
    <span class="pl-v">attachments</span><span class="pl-k">=</span>{
        <span class="pl-s"><span class="pl-pds">'</span>attachment1.doc<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>/path/to/file/file1.doc<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>attachment2.txt<span class="pl-pds">'</span></span>: ContentFile(<span class="pl-s"><span class="pl-pds">'</span>file content<span class="pl-pds">'</span></span>),
    }
)</pre></div>
<a name="user-content-template-tags-and-variables"/>
<h3><a id="user-content-template-tags-and-variables" class="anchor" href="#template-tags-and-variables" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Template Tags and Variables</h3>
<p><code>post-office</code> supports Django's template tags and variables.
For example, if you put "Hello, {{ name }}" in the subject line and pass in
<code>{'name': 'Alice'}</code> as context, you will get "Hello, Alice" as subject:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> post_office.models <span class="pl-k">import</span> EmailTemplate
<span class="pl-k">from</span> post_office <span class="pl-k">import</span> mail

EmailTemplate.objects.create(
    <span class="pl-v">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>morning_greeting<span class="pl-pds">'</span></span>,
    <span class="pl-v">subject</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Morning, <span class="pl-c1">{{</span> name|capfirst <span class="pl-c1">}}</span><span class="pl-pds">'</span></span>,
    <span class="pl-v">content</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Hi <span class="pl-c1">{{</span> name <span class="pl-c1">}}</span>, how are you feeling today?<span class="pl-pds">'</span></span>,
    <span class="pl-v">html_content</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Hi &lt;strong&gt;<span class="pl-c1">{{</span> name <span class="pl-c1">}}</span>&lt;/strong&gt;, how are you feeling today?<span class="pl-pds">'</span></span>,
)

mail.send(
    [<span class="pl-s"><span class="pl-pds">'</span>recipient@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">template</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>morning_greeting<span class="pl-pds">'</span></span>,
    <span class="pl-v">context</span><span class="pl-k">=</span>{<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>alice<span class="pl-pds">'</span></span>},
)

<span class="pl-c"># This will create an email with the following content:</span>
subject <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Morning, Alice<span class="pl-pds">'</span></span>,
content <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Hi alice, how are you feeling today?<span class="pl-pds">'</span></span>
content <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Hi &lt;strong&gt;alice&lt;/strong&gt;, how are you feeling today?<span class="pl-pds">'</span></span></pre></div>
<a name="user-content-multilingual-email-templates"/>
<h3><a id="user-content-multilingual-email-templates" class="anchor" href="#multilingual-email-templates" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Multilingual Email Templates</h3>
<p>You can easily create email templates in various different languanges.
For example:</p>
<div class="highlight highlight-source-python"><pre>template <span class="pl-k">=</span> EmailTemplate.objects.create(
    <span class="pl-v">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>hello<span class="pl-pds">'</span></span>,
    <span class="pl-v">subject</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Hello world!<span class="pl-pds">'</span></span>,
)

<span class="pl-c"># Add an Indonesian version of this template:</span>
indonesian_template <span class="pl-k">=</span> template.translated_templates.create(
    <span class="pl-v">language</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>,
    <span class="pl-v">subject</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Halo Dunia!<span class="pl-pds">'</span></span>
)</pre></div>
<p>Sending an email using template in a non default languange is
also similarly easy:</p>
<div class="highlight highlight-source-python"><pre>mail.send(
    [<span class="pl-s"><span class="pl-pds">'</span>recipient@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">template</span><span class="pl-k">=</span>template, <span class="pl-c"># Sends using the default template</span>
)

mail.send(
    [<span class="pl-s"><span class="pl-pds">'</span>recipient@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">template</span><span class="pl-k">=</span>template,
    <span class="pl-v">language</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>, <span class="pl-c"># Sends using Indonesian template</span>
)</pre></div>
<a name="user-content-custom-email-backends"/>
<h3><a id="user-content-custom-email-backends" class="anchor" href="#custom-email-backends" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Custom Email Backends</h3>
<p>By default, <code>post_office</code> uses django's <code>smtp.EmailBackend</code>. If you want to
use a different backend, you can do so by configuring <code>BACKENDS</code>.</p>
<p>For example if you want to use <a href="https://github.com/hmarr/django-ses">django-ses</a>:</p>
<pre>POST_OFFICE = {
    'BACKENDS': {
        'default': 'smtp.EmailBackend',
        'ses': 'django_ses.SESBackend',
    }
}
</pre>
<p>You can then choose what backend you want to use when sending mail:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># If you omit `backend_alias` argument, `default` will be used</span>
mail.send(
    [<span class="pl-s"><span class="pl-pds">'</span>recipient@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">subject</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Hello<span class="pl-pds">'</span></span>,
)

<span class="pl-c"># If you want to send using `ses` backend</span>
mail.send(
    [<span class="pl-s"><span class="pl-pds">'</span>recipient@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-v">subject</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Hello<span class="pl-pds">'</span></span>,
    <span class="pl-v">backend</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>ses<span class="pl-pds">'</span></span>,
)</pre></div>
<a name="user-content-management-commands"/>
<h3><a id="user-content-management-commands" class="anchor" href="#management-commands" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Management Commands</h3>
<ul>
<li><code>send_queued_mail</code> - send queued emails, those aren't successfully sent
will be marked as <code>failed</code>. Accepts the following arguments:</li>
</ul>
<table>





<tbody valign="top">
<tr><td>Argument</td>
<td colspan="2">Description</td>
</tr>
<tr><td><code>--processes</code> or <code>-p</code></td>
<td colspan="2">Number of parallel processes to send email.
Defaults to 1</td>
</tr>
<tr><td><code>--lockfile</code> or <code>-L</code></td>
<td colspan="2">Full path to file used as lock file. Defaults to
<code>/tmp/post_office.lock</code></td>
</tr>
</tbody>
</table>
<ul>
<li><code>cleanup_mail</code> - delete all emails created before an X number of days
(defaults to 90).</li>
</ul>
<p>You may want to set these up via cron to run regularly:</p>
<pre>* * * * * (cd $PROJECT; python manage.py send_queued_mail --processes=1 &gt;&gt; $PROJECT/cron_mail.log 2&gt;&amp;1)
0 1 * * * (cd $PROJECT; python manage.py cleanup_mail --days=30 &gt;&gt; $PROJECT/cron_mail_cleanup.log 2&gt;&amp;1)
</pre>
<a name="user-content-settings"/>
<h2><a id="user-content-settings" class="anchor" href="#settings" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Settings</h2>
<p>This section outlines all the settings and configurations that you can put
in Django's <code>settings.py</code> to fine tune <code>post-office</code>'s behavior.</p>
<a name="user-content-batch-size"/>
<h3><a id="user-content-batch-size" class="anchor" href="#batch-size" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Batch Size</h3>
<p>If you may want to limit the number of emails sent in a batch (sometimes useful
in a low memory environment), use the <code>BATCH_SIZE</code> argument to limit the
number of queued emails fetched in one batch.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># Put this in settings.py</span>
<span class="pl-c1">POST_OFFICE</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>BATCH_SIZE<span class="pl-pds">'</span></span>: <span class="pl-c1">5000</span>
}</pre></div>
<a name="user-content-default-priority"/>
<h3><a id="user-content-default-priority" class="anchor" href="#default-priority" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Default Priority</h3>
<p>The default priority for emails is <code>medium</code>, but this can be altered by
setting <code>DEFAULT_PRIORITY</code>. Integration with asynchronous email backends
(e.g. based on Celery) becomes trivial when set to <code>now</code>.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># Put this in settings.py</span>
<span class="pl-c1">POST_OFFICE</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>DEFAULT_PRIORITY<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>
}</pre></div>
<a name="user-content-log-level"/>
<h3><a id="user-content-log-level" class="anchor" href="#log-level" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Log Level</h3>
<p>The default log level is 2 (logs both successful and failed deliveries)
This behavior can be changed by setting <code>LOG_LEVEL</code>.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># Put this in settings.py</span>
<span class="pl-c1">POST_OFFICE</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>LOG_LEVEL<span class="pl-pds">'</span></span>: <span class="pl-c1">1</span> <span class="pl-c"># Log only failed deliveries</span>
}</pre></div>
<p>The different options are:</p>
<ul>
<li><code>0</code> logs nothing</li>
<li><code>1</code> logs only failed deliveries</li>
<li><code>2</code> logs everything (both successful and failed delivery attempts)</li>
</ul>
<a name="user-content-sending-order"/>
<h3><a id="user-content-sending-order" class="anchor" href="#sending-order" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Sending Order</h3>
<p>The default sending order for emails is <code>-priority</code>, but this can be altered by
setting <code>SENDING_ORDER</code>. For example, if you want to send queued emails in FIFO order :</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># Put this in settings.py</span>
<span class="pl-c1">POST_OFFICE</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>SENDING_ORDER<span class="pl-pds">'</span></span>: [<span class="pl-s"><span class="pl-pds">'</span>created<span class="pl-pds">'</span></span>]
}</pre></div>
<a name="user-content-context-field-serializer"/>
<h3><a id="user-content-context-field-serializer" class="anchor" href="#context-field-serializer" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Context Field Serializer</h3>
<p>If you need to store complex Python objects for deferred rendering
(i.e. setting <code>render_on_delivery=True</code>), you can specify your own context
field class to store context variables. For example if you want to use
<a href="https://github.com/gintas/django-picklefield/tree/master/src/picklefield">django-picklefield</a>:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># Put this in settings.py</span>
<span class="pl-c1">POST_OFFICE</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>CONTEXT_FIELD_CLASS<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>picklefield.fields.PickledObjectField<span class="pl-pds">'</span></span>
}</pre></div>
<p><code>CONTEXT_FIELD_CLASS</code> defaults to <code>jsonfield.JSONField</code>.</p>
<a name="user-content-logging"/>
<h3><a id="user-content-logging" class="anchor" href="#logging" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Logging</h3>
<p>You can configure <code>post-office</code>'s logging from Django's <code>settings.py</code>. For
example:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c1">LOGGING</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">"</span>version<span class="pl-pds">"</span></span>: <span class="pl-c1">1</span>,
    <span class="pl-s"><span class="pl-pds">"</span>disable_existing_loggers<span class="pl-pds">"</span></span>: <span class="pl-c1">False</span>,
    <span class="pl-s"><span class="pl-pds">"</span>formatters<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>post_office<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>format<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>[<span class="pl-c1">%(levelname)s</span>]<span class="pl-c1">%(asctime)s</span> PID <span class="pl-c1">%(process)d</span>: <span class="pl-c1">%(message)s</span><span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>datefmt<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span><span class="pl-c1">%d</span>-%m-%Y %H:%M:%S<span class="pl-pds">"</span></span>,
        },
    },
    <span class="pl-s"><span class="pl-pds">"</span>handlers<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>post_office<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>level<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>DEBUG<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>class<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>logging.StreamHandler<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>formatter<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>post_office<span class="pl-pds">"</span></span>
        },
        <span class="pl-c"># If you use sentry for logging</span>
        <span class="pl-s"><span class="pl-pds">'</span>sentry<span class="pl-pds">'</span></span>: {
            <span class="pl-s"><span class="pl-pds">'</span>level<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>ERROR<span class="pl-pds">'</span></span>,
            <span class="pl-s"><span class="pl-pds">'</span>class<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>raven.contrib.django.handlers.SentryHandler<span class="pl-pds">'</span></span>,
        },
    },
    <span class="pl-s"><span class="pl-pds">'</span>loggers<span class="pl-pds">'</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>post_office<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>handlers<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>post_office<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>sentry<span class="pl-pds">"</span></span>],
            <span class="pl-s"><span class="pl-pds">"</span>level<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>INFO<span class="pl-pds">"</span></span>
        },
    },
}</pre></div>
<a name="user-content-performance"/>
<h2><a id="user-content-performance" class="anchor" href="#performance" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Performance</h2>
<a name="user-content-caching"/>
<h3><a id="user-content-caching" class="anchor" href="#caching" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Caching</h3>
<p>if Django's caching mechanism is configured, <code>post_office</code> will cache
<code>EmailTemplate</code> instances . If for some reason you want to disable caching,
set <code>POST_OFFICE_CACHE</code> to <code>False</code> in <code>settings.py</code>:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c">## All cache key will be prefixed by post_office:template:</span>
<span class="pl-c">## To turn OFF caching, you need to explicitly set POST_OFFICE_CACHE to False in settings</span>
<span class="pl-c1">POST_OFFICE_CACHE</span> <span class="pl-k">=</span> <span class="pl-c1">False</span>

<span class="pl-c">## Optional: to use a non default cache backend, add a "post_office" entry in CACHES</span>
<span class="pl-c1">CACHES</span> <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>post_office<span class="pl-pds">'</span></span>: {
        <span class="pl-s"><span class="pl-pds">'</span>BACKEND<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>django.core.cache.backends.memcached.PyLibMCCache<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>LOCATION<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>127.0.0.1:11211<span class="pl-pds">'</span></span>,
    }
}</pre></div>
<a name="user-content-send-many"/>
<h3><a id="user-content-send_many" class="anchor" href="#send_many" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>send_many()</h3>
<p><code>send_many()</code> is much more performant (generates less database queries) when
sending a large number of emails. <code>send_many()</code> is almost identical to <code>mail.send()</code>,
with the exception that it accepts a list of keyword arguments that you'd
usually pass into <code>mail.send()</code>:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> post_office <span class="pl-k">import</span> mail

first_email <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>sender<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>recipients<span class="pl-pds">'</span></span>: [<span class="pl-s"><span class="pl-pds">'</span>alice@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>subject<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>Hi!<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>Hi Alice!<span class="pl-pds">'</span></span>
}
second_email <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>sender<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>from@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>recipients<span class="pl-pds">'</span></span>: [<span class="pl-s"><span class="pl-pds">'</span>bob@example.com<span class="pl-pds">'</span></span>],
    <span class="pl-s"><span class="pl-pds">'</span>subject<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>Hi!<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>Hi Bob!<span class="pl-pds">'</span></span>
}
kwargs_list <span class="pl-k">=</span> [first_email, second_email]

mail.send_many(kwargs_list)</pre></div>
<p>Attachments are not supported with <code>mail.send_many()</code>.</p>
<a name="user-content-running-tests"/>
<h2><a id="user-content-running-tests" class="anchor" href="#running-tests" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Running Tests</h2>
<p>To run the test suite:</p>
<pre>`which django-admin.py` test post_office --settings=post_office.test_settings --pythonpath=.
</pre>
<a name="user-content-changelog"/>
<h2><a id="user-content-changelog" class="anchor" href="#changelog" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Changelog</h2>
<a name="user-content-version-2-0-5"/>
<h3><a id="user-content-version-205" class="anchor" href="#version-205" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Version 2.0.5</h3>
<ul>
<li>Fixes more Django 1.8 deprecation warnings.</li>
<li>Email.dispatch() now closes backend connection by default. Thanks @zwack</li>
<li>Compatibility fixes for Django 1.9. Thanks @yprez!</li>
</ul>
<a name="user-content-version-2-0-1"/>
<h3><a id="user-content-version-201" class="anchor" href="#version-201" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Version 2.0.1</h3>
<ul>
<li>Fixes migration related packaging issues.</li>
<li>Fixes deprecation warning in Django 1.8.</li>
</ul>
<a name="user-content-version-2-0"/>
<h3><a id="user-content-version-20" class="anchor" href="#version-20" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Version 2.0</h3>
<ul>
<li>Added multi backend support. Now you can use multiple email backends with <code>post-office</code>!</li>
<li>Added multi language support. Thanks @jrief!</li>
</ul>
<a name="user-content-version-1-1-2"/>
<h3><a id="user-content-version-112" class="anchor" href="#version-112" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Version 1.1.2</h3>
<ul>
<li>Adds Django 1.8 compatibility.</li>
</ul>
<a name="user-content-version-1-1-1"/>
<h3><a id="user-content-version-111" class="anchor" href="#version-111" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Version 1.1.1</h3>
<ul>
<li>Fixes a migration error. Thanks @garry-cairns!</li>
</ul>
<a name="user-content-version-1-1-0"/>
<h3><a id="user-content-version-110" class="anchor" href="#version-110" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Version 1.1.0</h3>
<ul>
<li>Support for Django 1.7 migrations. If you're still on Django &lt; 1.7,
South migration files are stored in <code>south_migrations</code> directory.</li>
</ul>
<a name="user-content-version-1-0-0"/>
<h3><a id="user-content-version-100" class="anchor" href="#version-100" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Version 1.0.0</h3>
<ul>
<li><strong>IMPORTANT</strong>: in older versions, passing multiple <code>recipients</code> into
<code>mail.send()</code> will create multiple emails, each addressed to one recipient.
Starting from <code>1.0.0</code>, only one email with multiple recipients will be created.</li>
<li>Added <code>LOG_LEVEL</code> setting.</li>
<li><code>mail.send()</code> now supports <code>cc</code> and <code>bcc</code>.
Thanks Ștefan Daniel Mihăilă (@stefan-mihaila)!</li>
<li>Improvements to <code>admin</code> interface; you can now easily requeue multiple emails.</li>
<li><code>Log</code> model now stores the type of exception caught during sending.</li>
<li><code>send_templated_mail</code> command is now deprecated.</li>
<li>Added <code>EMAIL_BACKEND</code> setting to the new dictionary-styled settings.</li>
</ul>
<p>Full changelog can be found <a href="https://github.com/ui/django-post_office/blob/master/CHANGELOG.md">here</a>.</p>
<p>Created and maintained by the cool guys at <a href="https://stamps.co.id">Stamps</a>,
Indonesia's most elegant CRM/loyalty platform.</p>

</article>
  </div></body></html>