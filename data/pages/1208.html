<html><body><div><section class="entry">
<p class="fsb-clear"/><p><iframe src="http://www.youtube.com/embed/IkgM1b1HLK0?feature=oembed" frameborder="0" allowfullscreen="">VIDEO</iframe></p>
<p>So last night I went out for a few drinks with my colleague, James, a fellow computer vision researcher who I have known for years.</p>
<p>You see, James likes to party. He’s a “go hard” type of guy. He wanted to hit every single bar on Washington St. (there’s a lot of them)…and then hit ’em again on the way back.</p>
<p>It’s safe to say that by the end of the night that <em>James was blotto</em>. Wasted. Lights out.</p>
<p>Anyway, it was getting late. 1:47am, to be exact. I’m tired. I just want to go to bed. We’re at the last bar. I’m signing my name on the tab and heading for the door, looking forward to getting some sleep.</p>
<p>And James, in his clearly drunken and intoxicated state, walks (or rather, stumbles like a newborn foal) up to this blonde who looks and dresses like she’s straight out of South Beach and says: <em>“You know…if you take your shirt off I have a Python script that can detect how much skin you’re showing. Wanna see?”</em></p>
<p>Now tell me,<em> what do you think happens next?</em></p>
<p>That’s right. James gets a top shelf Manhattan thrown in his face by the South Beach girl. Honestly, he’s just lucky that he didn’t catch a <em>well deserved</em> fist to the nose.</p>
<p>Shocked, and fairly appalled, I led the drunken James back to my apartment to sleep it off. Not to mention have a conversation with him regarding how to treat women the next morning.</p>
<p>So here’s the deal…</p>
<p>In this blog post I’m going to show you <em><strong>how to detect skin in images using computer vision.</strong></em></p>
<p>But use these superpowers for good, okay? Don’t be like James. Play it cool.</p>
<p>Read on and find out how <em><strong>simple</strong></em> it really is to detect skin in images using Python and OpenCV.</p>

<p><strong>OpenCV and Python versions:</strong><br/>
This example will run on<strong> Python 2.7/Python 3.4+</strong> and <strong>OpenCV 2.4.X/OpenCV 3.0+</strong>.</p>
<h1>Detecting Skin in Images &amp; Video Using Python and OpenCV</h1>
<p>You know the drill. Open up your favorite editor, create a new file, name it 
			<span id="crayon-56d5ad6a32bf4134911374" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">skindetector</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> , and let’s get to work:</p>

		<div id="crayon-56d5ad6a32bfe919591187" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5ad6a32bfe919591187-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32bfe919591187-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">pyimagesearch </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></p><p class="crayon-line" id="crayon-56d5ad6a32bfe919591187-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32bfe919591187-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></p><p class="crayon-line" id="crayon-56d5ad6a32bfe919591187-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32bfe919591187-6"> </p><p class="crayon-line" id="crayon-56d5ad6a32bfe919591187-7"><span class="crayon-c"># construct the argument parse and parse the arguments</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32bfe919591187-8"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32bfe919591187-9"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-v"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--video"</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32bfe919591187-10"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"path to the (optional) video file"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32bfe919591187-11"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32bfe919591187-12"> </p><p class="crayon-line" id="crayon-56d5ad6a32bfe919591187-13"><span class="crayon-c"># define the upper and lower boundaries of the HSV pixel</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32bfe919591187-14"><span class="crayon-c"># intensities to be considered 'skin'</span></p><p class="crayon-line" id="crayon-56d5ad6a32bfe919591187-15"><span class="crayon-v">lower</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32bfe919591187-16"><span class="crayon-v">upper</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>On <strong>Lines 2-5</strong> we import the packages that we’ll need. We’ll use NumPy for some numerical processing, 
			<span id="crayon-56d5ad6a32c03596259660" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">argparse</span></span></span>  to parse our command line arguments, and 
			<span id="crayon-56d5ad6a32c07466960906" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span></span></span>  for our OpenCV bindings.</p>
<p>We’ll also use a package called 
			<span id="crayon-56d5ad6a32c0a998653221" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">imutils</span></span></span>  which contains a bunch of “convenience” image processing functions for resizing, rotating, etc. You can read more about the 
			<span id="crayon-56d5ad6a32c0d732303014" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">imutils</span></span></span>  package in my <a href="http://www.pyimagesearch.com/2014/01/20/basic-image-manipulations-in-python-and-opencv-resizing-scaling-rotating-and-cropping/" target="_blank">Basics of Image Manipulations</a> post.</p>
<p>From there, <strong>Lines 8-11</strong> parse our command line arguments. We have only a single (optional) switch, 
			<span id="crayon-56d5ad6a32c11666845737" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">--</span><span class="crayon-v">video</span></span></span> , which allows you to detect skin in a pre-supplied video. However, you could just as easily omit this switch from the command and use your webcam to detect skin in images. If you don’t have a webcam attached to your system, then you’ll have to supply a video.</p>
<p>From there, we define the <em>lower</em> and <em>upper</em> boundaries for pixel intensities to be considered skin on <strong>Lines 15 and 16</strong>. It’s important to note that these boundaries are for the <i>HSV color space, <strong>NOT </strong>the RGB color space<strong>.</strong></i></p>
<p>If you haven’t had a chance to take a look at my post on <a href="http://www.pyimagesearch.com/2014/08/04/opencv-python-color-detection/" target="_blank">Color Detection Using Python and OpenCV</a>, then now would be a good time to do so — we’ll be building off the fundamentals presented in the color detection post and extending our method to detect skin in images.</p>
<p>Alright, now let’s write some code to grab a reference to the webcam or video:</p>

		<div id="crayon-56d5ad6a32c15398591334" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c15398591334-18"><span class="crayon-c"># if a video path was not supplied, grab the reference</span></p><p class="crayon-line" id="crayon-56d5ad6a32c15398591334-19"><span class="crayon-c"># to the gray</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c15398591334-20"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">"video"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5ad6a32c15398591334-21"><span class="crayon-h">	</span><span class="crayon-v">camera</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">VideoCapture</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c15398591334-22"> </p><p class="crayon-line" id="crayon-56d5ad6a32c15398591334-23"><span class="crayon-c"># otherwise, load the video</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c15398591334-24"><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5ad6a32c15398591334-25"><span class="crayon-h">	</span><span class="crayon-v">camera</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">VideoCapture</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"video"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>On <strong>Line 20 </strong>we make a check to see if the 
			<span id="crayon-56d5ad6a32c19483512838" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">--</span><span class="crayon-v">video</span></span></span>  switch was supplied. If it was not, then we grab reference to the webcam by passing a value of <em>0</em>  to the 
			<span id="crayon-56d5ad6a32c1d642962111" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">VideoCapture</span></span></span>  function.</p>
<p>However, if the 
			<span id="crayon-56d5ad6a32c20956389631" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">--</span><span class="crayon-v">video</span></span></span>  switch was supplied, then we’ll pass the path to the video to 
			<span id="crayon-56d5ad6a32c23081853080" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">VideoCapture</span></span></span>  on <strong>Lines 24 and 25</strong>.</p>
<p>Let’s start reading frames from our video:</p>

		<div id="crayon-56d5ad6a32c27824916656" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-28">28</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-30">30</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-32">32</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-34">34</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-36">36</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-38">38</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-40">40</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-42">42</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-44">44</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-46">46</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-48">48</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-50">50</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-52">52</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-54">54</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-55">55</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-56">56</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-57">57</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-58">58</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-59">59</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-60">60</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-61">61</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-62">62</p><p class="crayon-num" data-line="crayon-56d5ad6a32c27824916656-63">63</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5ad6a32c27824916656-64">64</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-27"><span class="crayon-c"># keep looping over the frames in the video</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-28"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-29"><span class="crayon-h">	</span><span class="crayon-c"># grab the current frame</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-30"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">grabbed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">camera</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-31"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-32"><span class="crayon-h">	</span><span class="crayon-c"># if we are viewing a video and we did not grab a</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-33"><span class="crayon-h">	</span><span class="crayon-c"># frame, then we have reached the end of the video</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-34"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">"video"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">grabbed</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-35"><span class="crayon-h">		</span><span class="crayon-st">break</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-36"> </p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-37"><span class="crayon-h">	</span><span class="crayon-c"># resize the frame, convert it to the HSV color space,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-38"><span class="crayon-h">	</span><span class="crayon-c"># and determine the HSV pixel intensities that fall into</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-39"><span class="crayon-h">	</span><span class="crayon-c"># the speicifed upper and lower boundaries</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-40"><span class="crayon-h">	</span><span class="crayon-v">frame</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">400</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-41"><span class="crayon-h">	</span><span class="crayon-v">converted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_BGR2HSV</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-42"><span class="crayon-h">	</span><span class="crayon-v">skinMask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">inRange</span><span class="crayon-sy">(</span><span class="crayon-v">converted</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lower</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">upper</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-43"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-44"><span class="crayon-h">	</span><span class="crayon-c"># apply a series of erosions and dilations to the mask</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-45"><span class="crayon-h">	</span><span class="crayon-c"># using an elliptical kernel</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-46"><span class="crayon-h">	</span><span class="crayon-v">kernel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">getStructuringElement</span><span class="crayon-sy">(</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">MORPH_ELLIPSE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">11</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-47"><span class="crayon-h">	</span><span class="crayon-v">skinMask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">erode</span><span class="crayon-sy">(</span><span class="crayon-v">skinMask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">iterations</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-48"><span class="crayon-h">	</span><span class="crayon-v">skinMask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">dilate</span><span class="crayon-sy">(</span><span class="crayon-v">skinMask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">iterations</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-49"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-50"><span class="crayon-h">	</span><span class="crayon-c"># blur the mask to help remove noise, then apply the</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-51"><span class="crayon-h">	</span><span class="crayon-c"># mask to the frame</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-52"><span class="crayon-h">	</span><span class="crayon-v">skinMask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">GaussianBlur</span><span class="crayon-sy">(</span><span class="crayon-v">skinMask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-53"><span class="crayon-h">	</span><span class="crayon-v">skin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">bitwise_and</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">skinMask</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-54"> </p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-55"><span class="crayon-h">	</span><span class="crayon-c"># show the skin in the image along with the mask</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-56"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"images"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skin</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-57"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-58"><span class="crayon-h">	</span><span class="crayon-c"># if the 'q' key is pressed, stop the loop</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-59"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k ">ord</span><span class="crayon-sy">(</span><span class="crayon-s">"q"</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-60"><span class="crayon-h">		</span><span class="crayon-st">break</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-61"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-62"><span class="crayon-c"># cleanup the camera and close any open windows</span></p><p class="crayon-line" id="crayon-56d5ad6a32c27824916656-63"><span class="crayon-v">camera</span><span class="crayon-sy">.</span><span class="crayon-e">release</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5ad6a32c27824916656-64"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">destroyAllWindows</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We start looping over the frames in the video on <strong>Line 28 </strong>and grab the next frame on <strong>Line 30</strong> using the 
			<span id="crayon-56d5ad6a32c2c522821931" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">camera</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span>  method.</p>
<p>The 
			<span id="crayon-56d5ad6a32c30546193489" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">camera</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span>  function returns a tuple, consisting of 
			<span id="crayon-56d5ad6a32c33350428351" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">grabbed</span></span></span>  and 
			<span id="crayon-56d5ad6a32c36110793839" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frame</span></span></span> . The 
			<span id="crayon-56d5ad6a32c3a733313282" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">grabbed</span></span></span>  variable is simply a boolean flag, indicating if the frame was successfully read or not. The 
			<span id="crayon-56d5ad6a32c3d488907391" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frame</span></span></span>  is the frame itself.</p>
<p>From there, we make a check on <strong>Line 34</strong> to see if the 
			<span id="crayon-56d5ad6a32c40800706224" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">frame</span></span></span>  was not read. If it was not, and we are reading a video from file, we assume we have reached the end of the video and we can safely break from the loop. Otherwise, we keep on looping.</p>
<p>In order to speed up the skin detection process, we use our 
			<span id="crayon-56d5ad6a32c44786202007" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-v">resize</span></span></span>  convenience function to resize our frame to have a width of 400 pixels on <strong>Line 40</strong>.</p>
<p>The actual skin detection takes place on <strong>Line 41 and 42</strong>. First, we convert the image from the RGB color space to the HSV color space. Then, we apply the 
			<span id="crayon-56d5ad6a32c47852399442" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">inRange</span></span></span>  function, supplying our HSV frame, and our lower and upper boundaries as arguments, respectively.</p>
<p>The output of the 
			<span id="crayon-56d5ad6a32c4b927430750" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">inRange</span></span></span>  function is our mask This mask is a single channel image, has the same width and height as the frame, and is of the 8-bit unsigned integer data type.</p>
<p>Pixels that are <em>white</em> (255) in the mask represent areas of the frame <strong><em>that are skin</em></strong>. Pixels that are <em>black</em> (0) in the mask represent areas <em><strong>that are not</strong> <strong>skin</strong></em>.</p>
<p>However, we may detect many small false-positive skin regions in the image. To remove these small regions, take a look at <strong>Lines 46-48</strong>. First, we create an elliptical structuring kernel. Then, we use this kernel to perform two iterations of erosions and dilations, respectively. These erosions and dilations will help remove the small false-positive skin regions in the image.</p>
<p>From there, we smooth the mask slightly using a Gaussian blur on <strong>Line 52</strong>. This smoothing step, while not critical to the skin detection process, produces a much cleaner mask.</p>
<p>We then apply the skin mask to our frame on <strong>Line 53</strong>.</p>
<p><strong>Line 56</strong> shows us a side-by-side view of the original frame along with the frame with skin detected in it.</p>
<p>We wait for a keypress on <strong>Line 59</strong>, and if it’s the 
			<span id="crayon-56d5ad6a32c4f568657216" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">q</span></span></span>  key, then we break from the loop.</p>
<p>Finally, <strong>Lines 63 and 64</strong> release the reference to our webcam/video and close any open windows.</p>
<h1>Running our Skin Detector</h1>
<p>To run our skin detector, open up a terminal and navigate to where our source code is stored.</p>
<p>If you are using the example video provided with the code downloads for this post (or an example video of your own), then issue the following command:</p>

		<div id="crayon-56d5ad6a32c53104015800" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5ad6a32c53104015800-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">skindetector</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">video </span><span class="crayon-v">video</span><span class="crayon-o">/</span><span class="crayon-v">skin_example</span><span class="crayon-e">.mov</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Otherwise, if you want to use your own webcam, execute this command:</p>

		

<p>If all goes well, you should see my detected skin, as shown by the following figure:</p>
<div id="attachment_1099" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/08/skin_detection_face.jpg"><img class="wp-image-1099" src="http://www.pyimagesearch.com/wp-content/uploads/2014/08/skin_detection_face.jpg" alt="Figure 1: Detecting the skin of my face using Python and OpenCV."/></a><p class="wp-caption-text"><strong>Figure 1:</strong> Detecting the skin of my face using Python and OpenCV.</p></div>
<p>And here is another example image from the video supplied with the code download:</p>
<div id="attachment_1100" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/08/skin_detection_hand.jpg"><img class="wp-image-1100" src="http://www.pyimagesearch.com/wp-content/uploads/2014/08/skin_detection_hand.jpg" alt="Figure 2: Detecting both the skin of my and and the skin of my face using Python and OpenCV."/></a><p class="wp-caption-text"><strong>Figure 2:</strong> Detecting both the skin of my and and the skin of my face using Python and OpenCV.</p></div>
<p>Pretty cool, right?</p>
<p>Using this basic approach we were able to build a fairly rudimentary skin detection algorithm — that’s still able to obtain decent results!</p>
<h1>Limitations</h1>
<p>There are some pretty obvious limitations and drawbacks to this approach.</p>
<p>The main drawback is that we are framing skin detection as a “color detection” problem. This assumes that we can easily specify the HSV values for ranges of pixel intensities that are considered skin.</p>
<p>However, under different lighting conditions, this approach might not perform as well — and we would likely have to continue to tweak the HSV value ranges.</p>
<p>The HSV value ranges we supplied worked fairly well for this example post…but what about for other ethnicities?</p>
<p>For example, I’m a white male. And surely the same HSV values used to detect my skin could not be used to detect someone from Asia or Africa. This implies that we have some <em>a priori</em> knowledge regarding the skin tone of who we want to detect.</p>
<p>Of course, more robust approaches can be applied. A (highly simplified) example would be to perform face detection to an image, determine the color of the skin on their face, and then use that model to detect the rest of the skin on their body.</p>
<p>Not a bad approach, but as you can imagine, it’s definitely a little more complicated.</p>
<p>In the meantime, as long as you can specify the HSV values of the skin tone you want to detect, framing skin detection as a color detection problem should work quite well for you.</p>
<h1>Summary</h1>
<p>In this blog post I showed you how to detect skin in images using Python and OpenCV.</p>
<p>To accomplish our skin detection, we framed <em>skin detection </em>as an extension to <a title="OpenCV and Python Color Detection" href="http://www.pyimagesearch.com/2014/08/04/opencv-python-color-detection/" target="_blank"><em>color detection</em></a>.</p>
<p>We were able to supply upper and lower ranges of pixel intensities in the HSV color space to detect skin in images.</p>
<p>While this is not a perfect or robust approach, the simplicity of our skin detection algorithm makes it a very good starting point to build more robust solutions.</p>
<p>But remember our promise, okay?</p>
<p>Don’t be like James. Use our skin detection superpowers for good, not evil.</p>
<h1 id="post_downloads">Downloads:</h1>

	</section>
	</div></body></html>