<html><body><div><section class="post_content clearfix" itemprop="articleBody">
                            <p class="shareaholic-canvas" data-app-id="18930042" data-app="share_buttons" data-title="Flask Internationalization and Localization" data-link="https://www.safaribooksonline.com/blog/2013/11/27/flask-internationalization-and-localization/" data-summary=""/><blockquote><p><em>Aaron Kavlie is a developer at Stremor working on a mobile voice platform called Plexi.</em></p></blockquote>
<p>Internationalization and localization of a web app can be an enormous undertaking. Supporting a second language adds a significant overhead to every change you make, and that only increases as you add more languages. The good news is that Flask, a Python microframework, together with <em>Flask-Babel</em>, gives you some good tools to streamline the process.</p>
<p>There are a lot of things to consider when internationalizing and localizing a complex web application, including design and layout, number and date formatting, graphics with text, and so on. In this post we will focus on the fundamental issues that all apps, even basic brochure sites, need to support multiple languages: string extraction, translation files, and URL routing.<span id="more-12927"/></p>
<h2>Translating strings with Babel and gettext</h2>
<p>Let’s start with a couple of basic handlers:</p>

		<div id="crayon-56d5a0cdf3ab3353503013" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3ab3353503013-1"><span class="crayon-h">	</span><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">route</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3ab3353503013-2"><span class="crayon-h">	</span><span class="crayon-e">def </span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3ab3353503013-3"><span class="crayon-h">	    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">render_template</span><span class="crayon-sy">(</span><span class="crayon-s">'index.html'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3ab3353503013-4"><span class="crayon-h">	</span></p><p class="crayon-line" id="crayon-56d5a0cdf3ab3353503013-5"><span class="crayon-h">	</span><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">route</span><span class="crayon-sy">(</span><span class="crayon-s">'/about'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3ab3353503013-6"><span class="crayon-h">	</span><span class="crayon-e">def </span><span class="crayon-e">about</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3ab3353503013-7"><span class="crayon-h">	    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">render_template</span><span class="crayon-sy">(</span><span class="crayon-s">'about.html'</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>And a simple template for the about page:</p>

		<div id="crayon-56d5a0cdf3aca838423158" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3aca838423158-1"><span class="crayon-h">	</span><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-r">extends</span><span class="crayon-h"> </span><span class="crayon-s">"base.html"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3aca838423158-2"><span class="crayon-h">	</span></p><p class="crayon-line" id="crayon-56d5a0cdf3aca838423158-3"><span class="crayon-h">	</span><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">block </span><span class="crayon-v">body</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3aca838423158-4"><span class="crayon-h">	</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">h1</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-e">About </span><span class="crayon-e">Acme </span><span class="crayon-v">Corporation</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-o">/</span><span class="crayon-v">h1</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5a0cdf3aca838423158-5"><span class="crayon-h">	</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3aca838423158-6"><span class="crayon-h">	</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">div</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5a0cdf3aca838423158-7"><span class="crayon-h">	    </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">p</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-st">For</span><span class="crayon-h"> </span><span class="crayon-i">over</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">century</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Acme </span><span class="crayon-e">has </span><span class="crayon-i">been</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">leader </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">anvil </span><span class="crayon-v">production</span><span class="crayon-sy">.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3aca838423158-8"><span class="crayon-h">	       </span><span class="crayon-e">Our </span><span class="crayon-e">unmatched </span><span class="crayon-e">quality </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">trusted </span><span class="crayon-e">by </span><span class="crayon-e">people</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">roadrunners</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5a0cdf3aca838423158-9"><span class="crayon-h">	       </span><span class="crayon-e">throughout </span><span class="crayon-e">the </span><span class="crayon-v">world</span><span class="crayon-sy">.</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3aca838423158-10"><span class="crayon-h">	</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5a0cdf3aca838423158-11"><span class="crayon-h">	</span><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">endblock</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>For a simple English-only static site, this is all fine and dandy. As soon as you need to translate the site to Spanish, however, things get more complicated.</p>
<p>Fortunately the <a href="http://pythonhosted.org/Flask-Babel/">Flask-Babel</a> extension gives us some good tools to manage string translations, building on the <a href="http://docs.python.org/2/library/gettext.html">gettext support</a> in the Python standard library and the <a href="http://babel.pocoo.org/">Babel</a> i18n library.</p>
<p>Getting started with Babel is simple:</p>

		<div id="crayon-56d5a0cdf3ad6053166759" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3ad6053166759-1"><span class="crayon-h">	</span><span class="crayon-e">from </span><span class="crayon-v">flask</span><span class="crayon-sy">.</span><span class="crayon-v">ext</span><span class="crayon-sy">.</span><span class="crayon-e">babel </span><span class="crayon-e">import </span><span class="crayon-e">Babel</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3ad6053166759-2"><span class="crayon-e">	</span></p><p class="crayon-line" id="crayon-56d5a0cdf3ad6053166759-3"><span class="crayon-e">	</span><span class="crayon-v">app</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flask</span><span class="crayon-sy">(</span><span class="crayon-v">__name__</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3ad6053166759-4"><span class="crayon-h">	</span><span class="crayon-v">babel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Babel</span><span class="crayon-sy">(</span><span class="crayon-v">app</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>This will load the <a href="http://jinja.pocoo.org/docs/extensions/#i18n-extension">Jinaj2 i18n extension</a> with the <code>gettext</code> function aliased to the conventional shortcut <code>_</code>. Let’s modify that template now by feeding our copy into <code>gettext</code>:</p>

		<div id="crayon-56d5a0cdf3ae0056140419" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3ae0056140419-1"><span class="crayon-h">	</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">h1</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-sy">{</span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-e">_</span><span class="crayon-sy">(</span><span class="crayon-s">'About Acme Corporation'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-o">/</span><span class="crayon-v">h1</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3ae0056140419-2"><span class="crayon-h">	</span></p><p class="crayon-line" id="crayon-56d5a0cdf3ae0056140419-3"><span class="crayon-h">	</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">div</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3ae0056140419-4"><span class="crayon-h">	    </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">p</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-sy">{</span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-e">_</span><span class="crayon-sy">(</span><span class="crayon-s">'For over a century, Acme has been a leader in anvil production.</span></p><p class="crayon-line" id="crayon-56d5a0cdf3ae0056140419-5"><span class="crayon-s">	       Our unmatched quality is trusted by people (and roadrunners)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3ae0056140419-6"><span class="crayon-s">	       throughout the world.'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5a0cdf3ae0056140419-7"><span class="crayon-h">	</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>Reload the page. If all is well, things will look exactly the same.</p>
<h2>The translation workflow</h2>
<p>Now that we have a couple of <code>gettext</code>ified strings, let’s produce a file to send to the translator.</p>
<p>First of all, we need a basic <code>babel.cfg</code> in the root directory of the project:</p>

		<div id="crayon-56d5a0cdf3aea009248648" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3aea009248648-1"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-i">python</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">=</span><span class="crayon-s">"**.py"</span><span class="crayon-h"> </span><span class="crayon-v">language</span><span class="crayon-o">=</span><span class="crayon-s">":"</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">/</span><span class="crayon-v">python</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3aea009248648-2"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-v">jinja2</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">/</span><span class="crayon-v">templates</span><span class="crayon-o">/</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-v">html</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5a0cdf3aea009248648-3"><span class="crayon-h">	</span><span class="crayon-v">extensions</span><span class="crayon-o">=</span><span class="crayon-v">jinja2</span><span class="crayon-sy">.</span><span class="crayon-v">ext</span><span class="crayon-sy">.</span><span class="crayon-v">autoescape</span><span class="crayon-sy">,</span><span class="crayon-v">jinja2</span><span class="crayon-sy">.</span><span class="crayon-v">ext</span><span class="crayon-sy">.</span><span class="crayon-v">with_</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>With that out of the way, Babel will come to our aid again with a command line tool to produce the <code>.po</code> and <code>.pot</code> files we need. First of all, produce a <code>.pot</code> file:</p>

		<div id="crayon-56d5a0cdf3af4270192350" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3af4270192350-1"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pybabel </span><span class="crayon-v">extract</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">F</span><span class="crayon-h"> </span><span class="crayon-v">babel</span><span class="crayon-sy">.</span><span class="crayon-v">cfg</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-v">messages</span><span class="crayon-sy">.</span><span class="crayon-i">pot</span><span class="crayon-h"> </span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>Next, add a translation. In this example we’ll use Spanish. Note that translations are indicated by <a href="http://www.loc.gov/standards/iso639-2/php/code_list.php">ISO 639-1 codes</a>. Substitute the proper two-letter code for <code>es</code> to add other languages. You’ll need to do this once for each language you plan to support:</p>

		<div id="crayon-56d5a0cdf3afd141659268" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3afd141659268-1"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pybabel </span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">messages</span><span class="crayon-sy">.</span><span class="crayon-v">pot</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-v">translations</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">l</span><span class="crayon-h"> </span><span class="crayon-v">es</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>Now you have a <code>.po</code> file ready to be translated. Fortunately this is a very common format, and there are a number of good GUI tools to assist in the translation process, so translators don’t have to edit the plain text by hand.</p>
<p>After the translation is done, compile the the translated <code>.po</code> file:</p>

		<div id="crayon-56d5a0cdf3b06288943017" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3b06288943017-1"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pybabel </span><span class="crayon-v">compile</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-v">translations</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>This will add a <code>.mo</code> file alongside the <code>.po</code> file.</p>
<p>Note: Instances of <code>#, fuzzy</code> must be removed before running the <code>compile</code> command. Those are intended to mark a string as modified for the translator, but for some reason Babel marks an empty string as fuzzy every time.</p>
<p>Finally, every time you add or modify strings in the future, run the first command again, get translations for the <code>.po</code> files, then run:</p>

		<div id="crayon-56d5a0cdf3b0f405816111" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3b0f405816111-1"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pybabel </span><span class="crayon-v">update</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">messages</span><span class="crayon-sy">.</span><span class="crayon-v">pot</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-v">translations</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>Now our translations are ready to go. We just need to tell the app which language to use.</p>
<h2>URL Routing</h2>
<p>Modify the routes to add a <code>lang_code</code> parameter as follows:</p>

		<div id="crayon-56d5a0cdf3b17463476914" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3b17463476914-1"><span class="crayon-h">	</span><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">route</span><span class="crayon-sy">(</span><span class="crayon-s">'/&amp;lt;lang_code&amp;gt;'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b17463476914-2"><span class="crayon-h">	</span><span class="crayon-e">def </span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b17463476914-3"><span class="crayon-h">	    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">render_template</span><span class="crayon-sy">(</span><span class="crayon-s">'index.html'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b17463476914-4"><span class="crayon-h">	</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b17463476914-5"><span class="crayon-h">	</span><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">route</span><span class="crayon-sy">(</span><span class="crayon-s">'/&amp;lt;lang_code&amp;gt;/about'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b17463476914-6"><span class="crayon-h">	</span><span class="crayon-e">def </span><span class="crayon-e">about</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b17463476914-7"><span class="crayon-h">	    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">render_template</span><span class="crayon-sy">(</span><span class="crayon-s">'about.html'</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Ordinarily that would require an argument in each view handler (<code>index(lang_code)</code> rather than just <code>index()</code>), but we’re going to take care of that for all the views as follows:</p>

		<div id="crayon-56d5a0cdf3b20896870552" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3b20896870552-1"><span class="crayon-h">	</span><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">before_request</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b20896870552-2"><span class="crayon-e">	</span><span class="crayon-e">def </span><span class="crayon-e">before</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b20896870552-3"><span class="crayon-h">	    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-e">view_args </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-s">'lang_code'</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">view_args</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b20896870552-4"><span class="crayon-h">		    </span><span class="crayon-v">g</span><span class="crayon-sy">.</span><span class="crayon-v">current_lang</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">view_args</span><span class="crayon-sy">[</span><span class="crayon-s">'lang_code'</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b20896870552-5"><span class="crayon-h">		    </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">view_args</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-s">'lang_code'</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>Now that we’ve stored the language in Flask’s <code>g</code> object, this is what we need to do to select a language:</p>

		<div id="crayon-56d5a0cdf3b2a205328933" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3b2a205328933-1"><span class="crayon-h">	</span><span class="crayon-sy">@</span><span class="crayon-v">babel</span><span class="crayon-sy">.</span><span class="crayon-e">localeselector</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b2a205328933-2"><span class="crayon-e">	</span><span class="crayon-e">def </span><span class="crayon-e">get_locale</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b2a205328933-3"><span class="crayon-h">	    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">g</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'current_lang'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'en'</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>Now everything should be working. Give it a try! Assuming that you provided string translations in the previous step, <code>/en/about</code> should be showing the English text, and <code>/es/about</code> the Spanish.</p>
<p>You may notice that an invalid <code>lang_code</code> breaks the app (e.g. <code>/klingon/about</code>). To prevent that, we just need to check for a valid code like so:</p>

		<div id="crayon-56d5a0cdf3b33586360491" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3b33586360491-1"><span class="crayon-h">	</span><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">before_request</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b33586360491-2"><span class="crayon-e">	</span><span class="crayon-e">def </span><span class="crayon-e">before</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b33586360491-3"><span class="crayon-h">	    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-e">view_args </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-s">'lang_code'</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">view_args</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b33586360491-4"><span class="crayon-h">		    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">view_args</span><span class="crayon-sy">[</span><span class="crayon-s">'lang_code'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'es'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'en'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b33586360491-5"><span class="crayon-h">		        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">abort</span><span class="crayon-sy">(</span><span class="crayon-cn">404</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b33586360491-6"><span class="crayon-h">			</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Finally, what about the root URL? Just redirect that to the English version of the home page like this:</p>

		<div id="crayon-56d5a0cdf3b3c032931196" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5a0cdf3b3c032931196-1"><span class="crayon-h">	</span><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">route</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5a0cdf3b3c032931196-2"><span class="crayon-h">	</span><span class="crayon-e">def </span><span class="crayon-e">root</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5a0cdf3b3c032931196-3"><span class="crayon-h">	    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">redirect</span><span class="crayon-sy">(</span><span class="crayon-e">url_for</span><span class="crayon-sy">(</span><span class="crayon-s">'index'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lang_code</span><span class="crayon-o">=</span><span class="crayon-s">'en'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Conclusion</h2>
<p>There’s still a lot we could do to refine our language handling. For example, we could store the preferred language in a session (so we don’t always redirect to the English page if the user explicitly chose Spanish), or ask Babel for the supported translations, rather than hard-coding them. But this is a solid foundation upon which you can build further enhancements and optimizations as needed.</p>
<p>All of the code for this tutorial is <a href="https://github.com/akavlie/flask-i18n-l10n-tutorial">available on GitHub</a>.</p>
<p>See below for Flask resources from Safari Books Online.</p>
<h2>Safari Books Online has the content you need</h2>
<table>
<tbody>
<tr>
<td><a href="https://www.safaribooksonline.com/library/view/instant-flask-web/9781782169628/" target="_blank"><img alt="" hspace="70" src="https://www.safaribooksonline.com/library/cover/9781782169628/" vspace="30"/></a></td>
<td><a href="https://www.safaribooksonline.com/library/view/instant-flask-web/9781782169628/" target="_blank">Instant Flask Web Development</a> takes you beyond the quick start in the Flask documentation and shows you a bottom-up approach to organizing your Flask application. It shows you how to build a small deployable scheduling application with pointers to the various design decisions you can make when developing with Flask.</td>
</tr>
<tr>
<td><a href="https://www.safaribooksonline.com/library/view/instant-data-intensive/9781782165583/" target="_blank"><img alt="" hspace="70" src="https://www.safaribooksonline.com/library/cover/9781782165583/" vspace="30"/></a></td>
<td><a href="https://www.safaribooksonline.com/library/view/instant-data-intensive/9781782165583/" target="_blank">Instant Data Intensive Apps with pandas How-to</a> starts with Pandas’ functionalities such as joining datasets, cleaning data, and other data munging tasks. It quickly moves onto building a data reporting tool, which consists of analysis in Pandas to determine what’s relevant and present that relevant data in an easy-to-consume manner, and also provides a section on Flask.</td>
</tr>
</tbody>
</table>
<h3>About the author</h3>
<table>
<tbody>
<tr>
<td valign="top"><a href="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/11/aaron.jpg"><img alt="aaron" class="aligncenter size-full wp-image-12936" src="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/11/aaron.jpg"/></a></td>
<td>Aaron Kavlie started doing web development a few years ago and is currently a developer at Stremor working on a mobile voice platform called Plexi. He mainly does backend work with Python these days, but has been known to do frontend web development in the past. He can be reached at <a href="https://www.twitter.com/akavlie">@akavlie</a>.</td>
</tr>
</tbody>
</table>
                          
                            
                                                
                        </section> 
                        
                        </div></body></html>