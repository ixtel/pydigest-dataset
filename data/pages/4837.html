<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-climactic" class="anchor" href="#climactic" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a><code>climactic</code></h1>



<p><em>Testing commandline utilities</em></p>

<p>A simple testing framework for running
shell commands and verifying their behavior. Tests are
written as YAML files which specify the commands to run
along with assertions about the output (currently, stdout
and file/directory contents).</p>

<p>It is written in Python 3, but it can be used for testing
any kind of shell-based application using just the
<code>climactic</code> utility and your test files (by default,
files matching <code>**/test_*.yml</code>).</p>

<h3><a id="user-content-hello-world" class="anchor" href="#hello-world" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Hello, World!</h3>

<p>So, what does this actually look like? We try to keep it simple.</p>

<p><code>test_hello.yml</code>:</p>

<pre><code>---
# A very simple test!

- run: &gt;
    echo Hello world!

- assert-output: &gt;
    Hello world!
</code></pre>

<p>Run the <code>climactic</code> test runner:</p>

<pre><code>~$ climactic test_hello.yml
.
----------------------------------------------------------------------
Ran 1 test in 0.029s

OK
</code></pre>

<p>If you want to use it with existing unit tests via <code>py.test</code>:</p>

<pre><code>~/climacticpytest$ py.test
================= test session starts ==================
platform darwin -- Python 3.4.2 -- py-1.4.28 -- pytest-2.7.1
rootdir: /Users/brjorgensen/climacticpytest/climacticpytest, inifile:
plugins: climactic
collected 2 items

test_hello.yml .
test_other_thing.py .

=============== 2 passed in 0.01 seconds ===============
</code></pre>

<h3><a id="user-content-features" class="anchor" href="#features" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Features</h3>

<ul>
<li>Pytest integration</li>
<li>Aggregate tests recursively in a directory matching the
pattern <code>test_*.yml</code> using the commandline tool
<code>climactic</code></li>
<li>Compare stdout, directory structure, and file contents
against expected string values</li>
<li>Tests are run in a temporary directory to avoid data loss
and path-dependent results</li>
<li>Set environment variables per-test with the <code>env</code>
command</li>
<li><code>bash</code>-like <code>${VAR}</code> substitution for input commands
and output validation</li>
<li>Compatibility with the standard <code>unittest</code> package</li>
</ul>

<h2><a id="user-content-install" class="anchor" href="#install" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Install</h2>

<p><code>climactic</code> is registered in PyPI, so you can use pip:</p>

<pre><code>pip install climactic
</code></pre>

<p>Or (not necessary if you aren't using <code>py.test</code>, or already
have an up-to-date <code>pytest</code>):</p>

<pre><code>pip install climactic[pytest]
</code></pre>

<p>To use the most recent source code:</p>

<pre><code>virtualenv -p python3 climactic_venv
source climactic_venv/bin/activate
pip install -U -e git+https://github.com/b33j0r/climactic.git#egg=climactic
</code></pre>

<p>Either method will install the <code>climactic</code> python package
as well as the <code>climactic</code> commandline utility.</p>

<h4><a id="user-content-commands" class="anchor" href="#commands" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Commands</h4>

<p>The top-level of a climactic test file describes a list of
commands. Commands are executed in order (unless specified as a
dictionary, in which case execution order is undefined, but
each is still executed).</p>

<p>The following commands are currently supported:</p>

<h5><a id="user-content-action-commands-shell-interaction" class="anchor" href="#action-commands-shell-interaction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Action Commands (shell interaction)</h5>

<ul>
<li><p><strong>env</strong>:
sets environment variables which can be used in <code>run</code>
commands and assertions</p></li>
<li><p><strong>run</strong>:
runs one or more commands; nearly acts like a bash script
(performs environment variable substitution)</p></li>
<li><p><strong>write-file-utf8</strong>:
writes a string to a file</p></li>
</ul>

<h5><a id="user-content-assertion-commands-test-conditions" class="anchor" href="#assertion-commands-test-conditions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Assertion Commands (test conditions)</h5>

<ul>
<li><p><strong>assert-output</strong>:
compares the output of the most recent <code>run</code> command
with an expected variable (performs environment variable
substitution)</p></li>
<li><p><strong>assert-tree</strong>:
compares the directory structure of the directory being
tested against an expected structure</p></li>
<li><p><strong>assert-file-utf8</strong>:
compares the contents of a file against an expected
string</p></li>
</ul>

<h2><a id="user-content-usage-examples" class="anchor" href="#usage-examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage Examples</h2>

<p>The following should work out of the box if you opted to
install from source (and, for example, cloned the source tree
to <code>~/climactic</code>):</p>

<pre><code>~$ cd climactic
~/climactic$ climactic examples/test_hello.yml
.
----------------------------------------------------------------------
Ran 1 test in 0.225s

OK
</code></pre>

<p>When tests begin to get into the dozens or hundreds (and that
one random one breaks or becomes slow for some reason), it can
be nice to see which ones are running and when. For this purpose,
we can specify <code>--verbose</code> or its shortcut, <code>-v</code>:</p>

<pre><code>~/climactic$ climactic -v examples/test_hello.yml
test_hello.yml ...
INFO     stdout:
Hello world!
ok

----------------------------------------------------------------------
Ran 1 test in 0.245s

OK
</code></pre>

<p>To begin exploring all of the features of <code>climactic</code>,
create a new directory and add the test file
<code>test_git_init.yml</code>:</p>

<pre><code>---
# Run `git init` and verify
# that the expected directory
# structure and file contents
# are produced.

# Sets environment variables
- env:
    CMD: git
    CMD_NAME: Git
    REPO_DIR: .git/

# Runs `git init` in a new
# temporary directory
- run: |
    ${CMD} init

# Checks that stdout was as
# expected
- assert-output: &gt;
    Initialized empty ${CMD_NAME}
    repository in ${CWD}/${REPO_DIR}

# Verifies that expected files
# and directories were created
- assert-tree:
    .git:
    - HEAD
    - objects:
    - refs:
      - heads:
      - tags:

# Verifies that the HEAD file
# has the correct initial value
- assert-file-utf8:
    .git/HEAD: |
      ref: refs/heads/master
</code></pre>

<p>Now run <code>climactic</code>:</p>

<pre><code>.
----------------------------------------------------------------------
Ran 1 test in 0.029s

OK
</code></pre>

<h2><a id="user-content-contributing" class="anchor" href="#contributing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Contributing</h2>

<ul>
<li>Please do!</li>
<li>In my personal projects, I usually use a narrow line width of
80 characters because I like to review code on my phone or tablet;
this is a loose standard, but there is a greater probability of
getting your pull request accepted if you adopt it :)</li>
</ul>

<h2><a id="user-content-author" class="anchor" href="#author" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Author</h2>

<p><a href="/b33j0r/climactic/blob/master/brian.jorgensen+climactic@gmail.com">Brian Jorgensen</a>
(<a href="https://www.linkedin.com/in/briangregoryjorgensen">LinkedIn</a>)</p>

<h2><a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>License</h2>

<ul>
<li>Copyright (C) 2015  Brian Jorgensen</li>
<li>(Submit a pull request for Your Name Here)</li>
</ul>

<p>This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.</p>

<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>

<h1><a id="" class="anchor" href="#" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>...</h1>

<p><em>Don't Take Any Wooden Nickels</em></p>
</article>
  </div></body></html>