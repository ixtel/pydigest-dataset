<html><body><div><p>Flask-Redis-Sentinel provides support for connecting to Redis using Sentinel and also supports connecting to Redis
without it.</p>
<div id="basic-usage">
<h2>Basic usage</h2>
<pre><span class="kn">from</span> <span class="nn">flask.ext.redis_sentinel</span> <span class="kn">import</span> <span class="n">SentinelExtension</span>

<span class="n">redis_sentinel</span> <span class="o">=</span> <span class="n">SentinelExtension</span><span class="p">()</span>
<span class="n">redis_connection</span> <span class="o">=</span> <span class="n">redis_sentinel</span><span class="o">.</span><span class="n">default_connection</span>

<span class="c1"># Later when you create application</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">redis_sentinel</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre>
<p>You can configure Redis connection parameters using <cite>REDIS_URL</cite> Flask configuration variable with <cite>redis+sentinel</cite>
URL scheme:</p>
<pre>redis+sentinel://localhost:26379[,otherhost:26379,...]/mymaster/0
redis+sentinel://localhost:26379[,otherhost:26379,...]/mymaster/0?socket_timeout=0.1
redis+sentinel://localhost:26379[,otherhost:26379,...]/mymaster/0?sentinel_socket_timeout=0.1
redis+sentinel://:sentinel-secret-password@localhost:26379[,otherhost:26379,...]/mymaster/0?sentinel_socket_timeout=0.1
</pre>
<p>The extension also supports URL schemes as supported by redis-py for connecting to an instance directly without Sentinel:</p>
<pre>redis://[:password]@localhost:6379/0
rediss://[:password]@localhost:6379/0
unix://[:password]@/path/to/socket.sock?db=0
</pre>
<p>Flask-And-Redis style config variables are also supported for easier migration, but the extension will
log a <cite>DeprecationWarning</cite>:</p>
<pre>REDIS_HOST = 'localhost'
REDIS_PORT = 6379
REDIS_DB = 0
</pre>
<p>In case both <cite>REDIS_URL</cite> and other variables are present, the URL is used.</p>
</div>
<div id="accessing-redis-py-s-sentinel-instance">
<h2>Accessing redis-pyâ€™s Sentinel instance</h2>
<pre><span class="kn">from</span> <span class="nn">flask.ext.redis_sentinel</span> <span class="kn">import</span> <span class="n">SentinelExtension</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="s1">'test'</span><span class="p">)</span>

<span class="n">redis_sentinel</span> <span class="o">=</span> <span class="n">SentinelExtension</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">slaves</span> <span class="o">=</span> <span class="n">redis_sentinel</span><span class="o">.</span><span class="n">sentinel</span><span class="o">.</span><span class="n">discover_slaves</span><span class="p">(</span><span class="s1">'service1'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">slaves</span><span class="o">=</span><span class="n">slaves</span><span class="p">)</span>
</pre>
</div>
</div></body></html>