<html><body><div><article id="CnApdkW1apQwEx9GyY" class="post  historical">
	<time datetime="2015-01-03" class="article_time">January  3, 2015</time>
  
	<p>Python comprehensions are syntactic constructs that enable sequences to be built from other sequences in a clear and concise manner. Python comprehensions are of three types namely: </p>

<ol>
<li>list comprehensions, </li>
<li>set comprehensions and </li>
<li>dict comprehensions. </li>
</ol>

<p>List comprehension constructs have been part of python since python 2.0 while set and dict comprehensions have been part of python since python 2.7.</p>
<h1 id="list-comprehensions_1">
<a class="head_anchor" href="#list-comprehensions_1" rel="nofollow"> </a>List Comprehensions</h1>
<p>List comprehensions are by far the most popular python comprehension construct. List comprehensions provide a concise way to create new list of elements that satisfy a given condition from an <strong>iterable</strong>. An <strong>iterable</strong> is any python construct that can be looped over. Examples of inbuilt iterables include lists, sets and tuples. The example below from the <a href="https://docs.python.org/2/tutorial/datastructures.html" rel="nofollow">python documentation</a> illustrates the usage of list comprehensions. In this example, we want to create a list of squares of the numbers from 0 to 10. One conventional way of creating this list without comprehensions is given below :</p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; squares = []
&gt;&gt;&gt; for x in range(10):
...     squares.append(x**2)
...
&gt;&gt;&gt; squares
[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
</code></pre>

<p>The same list can be created in a more concise manner using list comprehensions as below: </p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; squares = [x**2 for x in range(10)]
</code></pre>

<p>The comprehension version is obviously clearer and more concise than the conventional method.</p>

<p>According to the python documentation, <strong>a list comprehension consists of square brackets containing an expression followed by a <em>for</em> clause and zero or more for or <em>if</em> clauses as shown below.</strong> </p>

<pre><code class="prettyprint lang-python">[expression for item1 in iterable1 if condition1 
            for item2 in iterable2 if condition2
            ...
            for itemN in iterableN if conditionN ]
</code></pre>

<p>The result is a new list resulting from evaluating the expression in the context of the <em>for</em> and <em>if</em> clauses which follow it. For example to create a list of the squares of even numbers between 0 and 10, the following comprehension is used:</p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; even_squares = [i**2 for i in range(10) if i % 2 == 0]
&gt;&gt;&gt; even_squares
[0, 4, 16, 36, 64]
</code></pre>

<p>The expression <code class="prettyprint">i**2</code> is computed in the context of the <em>for</em> clause that iterates over the numbers from 0 to 10 and the <em>if</em> clause that filters out non-even numbers. </p>
<h2 id="nested-emforem-loops-in-list-comprehensions_2">
<a class="head_anchor" href="#nested-emforem-loops-in-list-comprehensions_2" rel="nofollow"> </a>Nested <em>for</em> loops in List Comprehensions</h2>
<p>List comprehensions can also be used with multiple or nested <em>for</em> loops. Consider for example, the simple code fragment shown below that creates a tuple from pair of numbers drawn from the two sequences given. </p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; combs = []
&gt;&gt;&gt; for x in [1,2,3]:
...     for y in [3,1,4]:
...         if x != y:
...             combs.append((x, y))
...
&gt;&gt;&gt; combs
[(1, 3), (1, 4), (2, 3), (2, 1), (2, 4), (3, 1), (3, 4)]
</code></pre>

<p>The above can be rewritten in a more concise and simple manner as shown below using list comprehensions</p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; [(x, y) for x in [1,2,3] for y in [3,1,4] if x != y]
[(1, 3), (1, 4), (2, 3), (2, 1), (2, 4), (3, 1), (3, 4)]
</code></pre>

<p>It is important to take into consideration the order of the <em>for</em> loops as used in the list comprehension. Careful observation of the code snippets using comprehension and that without comprehension shows that the order of the <em>for</em> loops in the comprehension follows the same order if it had been written without comprehensions. The same applies to nested for loops with nesting depth greater than two.</p>
<h2 id="nested-list-comprehensions_2">
<a class="head_anchor" href="#nested-list-comprehensions_2" rel="nofollow"> </a>Nested List Comprehensions</h2>
<p>List comprehensions can also be nested. Consider the following example drawn from the <a href="https://docs.python.org/2/tutorial/datastructures.html" rel="nofollow">python documentation</a> of a 3x4 matrix implemented as a list of 3 lists of length 4:</p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; matrix = [
...     [1, 2, 3, 4],
...     [5, 6, 7, 8],
...     [9, 10, 11, 12],
... ]
</code></pre>

<p>Transposition is a matrix operation that creates a new matrix from an old one using the rows of the old matrix as the columns of the new matrix and the columns of the old matrix as the rows of the new matrix.<br/>
The rows and columns of the matrix can be transposed using the following nested list comprehension:</p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; [[row[i] for row in matrix] for i in range(4)]
[[1, 5, 9], [2, 6, 10], [3, 7, 11], [4, 8, 12]]
</code></pre>

<p>The above is equivalent to the snippet given below:</p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; transposed = []
&gt;&gt;&gt; for i in range(4):
...     transposed.append([row[i] for row in matrix])
...
&gt;&gt;&gt; transposed
[[1, 5, 9], [2, 6, 10], [3, 7, 11], [4, 8, 12]]
</code></pre>
<h1 id="set-comprehensions_1">
<a class="head_anchor" href="#set-comprehensions_1" rel="nofollow"> </a>Set Comprehensions</h1>
<p>Set comprehensions were added to python in version 2.7. In set comprehensions, we use the braces rather than<br/>
square brackets. For example, to create the set of the squares of all numbers between 0 and 10 the following set comprehensions can be used in lieu of regular looping:  </p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; x = {i**2 for i in range(10)}
&gt;&gt;&gt; x
set([0, 1, 4, 81, 64, 9, 16, 49, 25, 36])
&gt;&gt;&gt; 
</code></pre>
<h1 id="dict-comprehensions_1">
<a class="head_anchor" href="#dict-comprehensions_1" rel="nofollow"> </a>Dict Comprehensions</h1>
<p>Just like set comprehensions, dict comprehensions were added to python in version 2.7. Below we create a mapping of a number to its  square using <br/>
dict comprehensions.</p>

<pre><code class="prettyprint lang-python">&gt;&gt;&gt; x = {i:i**2 for i in range(10)}
&gt;&gt;&gt; x
{0: 0, 1: 1, 2: 4, 3: 9, 4: 16, 5: 25, 6: 36, 7: 49, 8: 64, 9: 81}
</code></pre>
<h1 id="further-reading_1">
<a class="head_anchor" href="#further-reading_1" rel="nofollow"> </a>Further Reading</h1>
<ol>
<li><a href="https://docs.python.org/2/tutorial/datastructures.html" rel="nofollow">Python Documentation</a></li>
<li>Python Essential Reference, Fourth Edition</li>
<li><a href="http://python-3-patterns-idioms-test.readthedocs.org/en/latest/Comprehensions.html" rel="nofollow">Python 3 Patterns, Recipes and Idioms</a></li>
</ol>

  <figure class="postend kudo able clearfix" id="kudo_CnApdkW1apQwEx9GyY">
    <a href="#kudo">
      <p class="filling"> </p>
    </a>
    <p class="num">295</p>
    <p class="txt">Kudos</p>
  </figure>
  <figure class="side kudo able clearfix" id="kudo_side_CnApdkW1apQwEx9GyY">
    <a href="#kudo">
      <p class="filling"> </p>
    </a>
    <p class="num">295</p>
    <p class="txt">Kudos</p>
  </figure>
</article>

</div></body></html>