<html><body><div><div class="entry-content clearfix"><p><strong>This blog post covers how to use the new <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/">PostgreSQL-specific ModelFields</a> introduced in Django 1.8 – the ArrayField, HStoreField, and Range Fields.</strong></p>









<p><em>This post is dedicated to the awesome backers of this <a href="https://www.kickstarter.com/projects/mjtamlyn/improved-postgresql-support-in-django/posts/803919">Kickstarter</a> campaign put together by <a href="https://twitter.com/mjtamlyn">Marc Tamlyn</a>, the true playa that made it happen.</em></p>

<a name="Playaz.Club."/>
<h2>Playaz Club?</h2>

<p>Since I’m a huge geek and have no chance of ever getting into a real Playaz Club (and because back in the day <a href="https://www.youtube.com/watch?v=2daXghqHgjQ">4 Tay</a> was the bomb), I decided to build my own virtual online Playaz Club. What is that exactly?  A private, invite-only social network targeted at a small group of like-minded individuals.</p>

<p>For this post, we are going to focus on the user model and explore how Django’s new <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/fields/">PostgreSQL features</a> support the modeling. The new features we are referring to are PostgreSQL-only, so don’t bother trying this unless you have your database <code>ENGINE</code> equal to <code>django.db.backends.postgresql_psycopg2</code>. You will need version &gt;= 2.5 of <code>psycopg2</code>. Aight playa, let’s do this.</p>

<p>Holla if you with me! :)</p>

<a name="Modeling.a.Playa.s.Rep"/>
<h2>Modeling a Playa’s Rep</h2>

<p>Every playa got a rep, and they want the whole world to know about their rep. So let’s create a user profile (aka a “rep”) that allows for each of our playaz to express their individuality.</p>

<p>Here’s the basic model for a playaz rep:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">Rep</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class="line">    <span class="n">playa</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</span><span class="line">    <span class="n">hood</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span class="line">    <span class="n">area_code</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nothing specific to 1.8 above. Just a standard model to extend the base Django User, cause a playa still needs a username and email address, right?  Plus we added two new fields to store the playaz hood and area code.</p>

<a name="Bankroll.and.the.RangeField"/>
<h2>Bankroll and the RangeField</h2>

<p>For a playa, repping your hood ain’t always enough. Playaz often like to flaunt their bankroll, but at the same time don’t want to be letting people know exactly how large that bankroll is. We can model that with one of the new <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/fields/#range-fields">Postgres Range Fields</a>. Of course we will use the <code>BigIntegerRangeField</code> to better model massive digits, amiright?</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">bankroll</span> <span class="o">=</span> <span class="n">pgfields</span><span class="o">.</span><span class="n">BigIntegerRangeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Range fields are based on the <a href="http://initd.org/psycopg/docs/extras.html#adapt-range">psycopg2 Range objects</a> and can be used for Numeric and DateRanges. With the bankroll field migrated to the database, we can interact with our range fields by passing it a range object, so creating our first playa would look something like this:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">&gt;&gt;&gt; from playa.models import Rep
</span><span class="line">&gt;&gt;&gt; from django.contrib.auth.models import User
</span><span class="line">&gt;&gt;&gt; <span class="nv">calvin</span> <span class="o">=</span> User.objects.create_user<span class="o">(</span><span class="nv">username</span><span class="o">=</span><span class="s2">"snoop"</span>, <span class="nv">password</span><span class="o">=</span><span class="s2">"dogg"</span><span class="o">)</span>
</span><span class="line">&gt;&gt;&gt; <span class="nv">calvins_rep</span> <span class="o">=</span> Rep<span class="o">(</span><span class="nv">hood</span><span class="o">=</span><span class="s2">"Long Beach"</span>, <span class="nv">area_code</span><span class="o">=</span>213<span class="o">)</span>
</span><span class="line">&gt;&gt;&gt; calvins_rep.bankroll <span class="o">=</span> <span class="o">(</span>100000000, 150000000<span class="o">)</span>
</span><span class="line">&gt;&gt;&gt; calvins_rep.playa <span class="o">=</span> calvin
</span><span class="line">&gt;&gt;&gt; calvins_rep.save<span class="o">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice this line: <code>calvins_rep.bankroll = (100000000, 150000000)</code>. Here we are setting a range field by using a simple tuple. It is also possible to set the value using a <code>NumericRange</code> object like so:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">from psycopg2.extras import NumericRange
</span><span class="line"><span class="nv">br</span> <span class="o">=</span> NumericRange<span class="o">(</span><span class="nv">lower</span><span class="o">=</span>100000000, <span class="nv">upper</span><span class="o">=</span>150000000<span class="o">)</span>
</span><span class="line">calvin.rep.bankroll <span class="o">=</span> br
</span><span class="line">calvin.rep.save<span class="o">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is essentially the same as using the tuple. However, it’s important to know about the <code>NumericRange</code> object as that is used to filter the model. For example, if we wanted to find all playas whose bankroll was greater than 50 million (meaning the entire bankroll range is greater than 50 million):</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Rep</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">bankroll__fully_gt</span><span class="o">=</span><span class="n">NumericRange</span><span class="p">(</span><span class="mi">50000000</span><span class="p">,</span> <span class="mi">50000000</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>And that will return the list of those playas. Alternatively, if we wanted to find all playas whose bankroll is “somewhere around the 10 to 15 million range”, we could use:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Rep</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">bankroll__overlap</span><span class="o">=</span><span class="n">NumericRange</span><span class="p">(</span><span class="mi">10000000</span><span class="p">,</span> <span class="mi">15000000</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>This would return all playas that have a bankroll range that includes at least some part of the 10 to 15 million range. A more absolute query would be all playas that have a bankroll fully in between a range, i.e. everybody that’s making at least 10 million but not more than 15 million. That query would look like:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Rep</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">bankroll__contained_by</span><span class="o">=</span><span class="n">NumericRange</span><span class="p">(</span><span class="mi">10000000</span><span class="p">,</span> <span class="mi">15000000</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>More information about Range-based queries can be found <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/fields/#querying-range-fields">here</a>.</p>

<a name="Skillz.as.ArrayField"/>
<h2>Skillz as ArrayField</h2>

<p>It ain’t all about the bankroll, playaz got skillz, all kinds of skillz. Let’s model those with an <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/fields/#arrayfield">ArrayField</a>.</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">skillz</span> <span class="o">=</span> <span class="n">pgfields</span><span class="o">.</span><span class="n">ArrayField</span><span class="p">(</span>
</span><span class="line">    <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
</span><span class="line">    <span class="n">blank</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
</span><span class="line">    <span class="n">null</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
</span><span class="line"><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>To declare the <code>ArrayField</code> we have to give it a first argument, which is the basefield. Unlike Python lists, ArrayFields must declare each element of the list as the same type. Basefield declares which type this is, and it can be any of the standard model field types. In the case above, we have just used a <code>CharField</code> as our basetype, which means <code>skillz</code> will be an array of strings.</p>

<p>Storing values to the <code>ArrayField</code> is exactly as you expect:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">&gt;&gt;&gt; from django.contrib.auth.models import User
</span><span class="line">&gt;&gt;&gt; <span class="nv">calvin</span> <span class="o">=</span> User.objects.get<span class="o">(</span><span class="nv">username</span><span class="o">=</span><span class="s1">'snoop'</span><span class="o">)</span>
</span><span class="line">&gt;&gt;&gt; calvin.rep.skillz <span class="o">=</span> <span class="o">[</span><span class="s1">'ballin'</span>, <span class="s1">'rappin'</span>, <span class="s1">'talk show host'</span>, <span class="s1">'merchandizn'</span><span class="o">]</span>
</span><span class="line">&gt;&gt;&gt; calvin.rep.save<span class="o">()</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Finding.playas.by.skillz"/>
<h3>Finding playas by skillz</h3>

<p>If we need a particular playa with a particular skill, how we gonna find them?  Use the <code>__contains</code> filter:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Rep</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">skillz__contains</span><span class="o">=</span><span class="p">[</span><span class="s">'rappin'</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>For playas who have any of the skills [‘rappin’, ‘djing’, ‘producing’] but no other skills, you could do a query like so:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Rep</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">skillz__contained_by</span><span class="o">=</span><span class="p">[</span><span class="s">'rappin'</span><span class="p">,</span> <span class="s">'djing'</span><span class="p">,</span> <span class="s">'producing'</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or if you want to find anyone that has any of a certain list of skills:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Rep</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">skillz__overlap</span><span class="o">=</span><span class="p">[</span><span class="s">'rappin'</span><span class="p">,</span> <span class="s">'djing'</span><span class="p">,</span> <span class="s">'producing'</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>You could even find only those people who listed a skill as their first skill (because everybody lists their best skill first):</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Rep</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">skillz__0</span><span class="o">=</span><span class="s">'ballin'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Game.as.HStore"/>
<h2>Game as HStore</h2>

<p>Game can be thought of as a list of miscellaneous, random skills a playa might have. Since Game spans all kinds of things, let’s model it as an <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/fields/#hstorefield">HStore field</a>, which basically means we can stick any old Python dictionary in there:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">game</span> <span class="o">=</span> <span class="n">pgfields</span><span class="o">.</span><span class="n">HStoreField</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>Take a second to think about what we just did here. HStore is pretty huge. It basically allows for “NoSQL”-type data storage, right inside of postgreSQL. Plus, since it’s inside PostgreSQL we can link (through foreign keys), tables that contain NoSQL data with tables that store regular SQL-type data. You can even store both in the same table on different columns as we are doing here. Maybe playas don’t need to use that jankie, all-talk MongoDB anymore…</p></blockquote>

<p>Coming back to implementation details, if you try to migrate the new HStore field into the database and end up with this error-</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">ProgrammingError</span><span class="p">:</span> <span class="nb">type</span> <span class="s">"hstore"</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
</span></code></pre></td></tr></table></div></figure>


<p>-then your PostgreSQL database is pre 8.1 (time to upgrade, playa) or doesn’t have the HStore extension installed. Keep in mind that in PostgreSQL the HStore extension is installed per database and not system-wide. To install it from your psql prompt, run the following SQL:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">CREATE</span> <span class="n">EXTENSION</span> <span class="n">hstore</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or if you want, you could do it through a SQL Migration with the following migration file (assuming you were connected to the database as the superuser):</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">migrations</span>
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class="line">
</span><span class="line">    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">        <span class="n">migrations</span><span class="o">.</span><span class="n">RunSQL</span><span class="p">(</span><span class="s">"CREATE EXTENSION IF NOT EXISTS hstore"</span><span class="p">)</span>
</span><span class="line">    <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, you will also need to make sure that you have added <code>'django.contrib.postgres'</code> to <code>'settings.INSTALLED_APPS'</code> to make use of HStore fields.</p>

<p>With that setup we can add data to our <code>HStoreField</code> <code>game</code> by throwing a dictionary at it like so:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">&gt;&gt;&gt; <span class="nv">calvin</span> <span class="o">=</span> User.objects.get<span class="o">(</span><span class="nv">username</span><span class="o">=</span><span class="s2">"snoop"</span><span class="o">)</span>
</span><span class="line">&gt;&gt;&gt; calvin.rep.game <span class="o">=</span> <span class="o">{</span><span class="s1">'best_album'</span>: <span class="s1">'Doggy Style'</span>, <span class="s1">'youtube-channel'</span>: <span class="se">\</span>
</span><span class="line">    <span class="s1">'https://www.youtube.com/user/westfesttv'</span>, <span class="s1">'twitter_follows'</span> : <span class="s1">'11000000'</span><span class="o">}</span>
</span><span class="line">&gt;&gt;&gt; calvin.rep.save<span class="o">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Do keep in mind that the dict must only use strings for all keys and values.</p>

<p>And now for some more interesting examples…</p>

<a name="Propz"/>
<h2>Propz</h2>

<p>Let’s write a “show game” function to search the playaz game and return a list of playaz that match. In geeky terms, we’re searching through the HStore field for any keys passed into the function. It looks something like this:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">show_game</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span><span class="line">    <span class="k">return</span> <span class="n">Rep</span><span class="o">.</span><span class="n">Objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">game__has_key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">'game'</span><span class="p">,</span><span class="s">'playa__username'</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Above we have used the <code>has_key</code> filter for the HStore field to return a queryset, then further filtered it with the values function (mainly to show that you can chain <code>django.contrib.postgres</code> stuff with regular query set stuff).</p>

<p>The return value would be a list of dictionaries:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="p">[</span>
</span><span class="line">  <span class="p">{</span><span class="s">'playa__username'</span><span class="p">:</span> <span class="s">'snoop'</span><span class="p">,</span>
</span><span class="line">  <span class="s">'game'</span><span class="p">:</span> <span class="p">{</span><span class="s">'twitter_follows'</span><span class="p">:</span> <span class="s">'11000000'</span><span class="p">,</span>
</span><span class="line">           <span class="s">'youtube-channel'</span><span class="p">:</span> <span class="s">'https://www.youtube.com/user/westfesttv'</span><span class="p">,</span>
</span><span class="line">           <span class="s">'best_album'</span><span class="p">:</span> <span class="s">'Doggy Style'</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line"><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>As they say, <a href="http://www.urbandictionary.com/define.php?term=Game+recognizes+game">Game recognizes Game</a>, and now we can search for game, too.</p>

<a name="High.Rollers"/>
<h2>High Rollers</h2>

<p>If we believe what the playaz are telling us about their bankrolls, then we can use that to rank them in categories (since it’s a range). Let’s add a Playa ranking based upon the bankroll with the following levels:</p>

<ul>
<li><p>young buck — bankroll less than one hundred grand</p></li>
<li><p>balla — bankroll between 100,000 and 500,000 with the skill ‘ballin’</p></li>
<li><p>playa — bankroll between 500,000 and 1,000,000 with two skillz and some game</p></li>
<li><p>high roller — bankroll greater than 1,000,000</p></li>
<li><p>O.G. — has the skill ‘gangsta’ and game key “old-school”</p></li>
</ul>


<p>The query for balla is below. This would be the strict interpretation, which would return only those whose entire bankroll range is within the specified limits:</p>

<figure class="code"><figcaption><span/></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">Rep</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">bankroll__contained_by</span><span class="o">=</span><span class="p">[</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">500000</span><span class="p">],</span> <span class="n">skillz__contains</span><span class="o">=</span><span class="p">[</span><span class="s">'ballin'</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>




<hr/>


<p>Try out the <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/">rest</a> yourself for some practice. If you need some help, <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/fields/#postgresql-specific-model-fields">Read the Docs</a>.</p>
</div>


      </div></body></html>