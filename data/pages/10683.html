<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-botnet-lab" class="anchor" href="#botnet-lab" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a><em>Botnet Lab</em></h1>

<h2><a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Summary</h2>

<p>The botnet built using this laboratory will match the general architecture for any botnet based on a Command-and-Control (C&amp;C) architecture.
Our actor is the <em>Bot Herder</em> or <em>Bot Master</em>, it operates using the a special IRC client (that is part of this laboratory), connects to a IRC-Server (in this case a IRCD-Hybrid based one) where all the bots are connected.</p>

<p>Whenever the <em>Bot Herder</em> sends a message to the IRC Server it broadcast it to all the connected bots that executes the requested job.</p>

<p>Special cases are the Spam request and the Screenshot/Webcam request. 
In the first case, the Spam, to avoid the trouble of setting up a SMTP server on all the bots we use the <a href="https://www.mandrill.com/">Mandrill API</a> for sending the e-mail. While this can appear strange, 
because of centralizing all the traffic on one e-mail sender API with low free quotas and with the risk of the account being blocked, we send the API Key in the request sended to bots in a way that if a Key it's blocked we can simple send a different API Key on the request sended to the bots. 
Additionally it's used the <a href="http://pastebin.com/">PasteBin Service</a> and it's "anonymous and hidden file" hability for hosting relevant data like the the <em>e-mail sending list</em>, <em>API Key</em> and <em>Message</em> and the <em>Bot Herder</em> just needs to send to the bots the files URL. </p>

<p>In the second case, the Screenshot/Webcam, the bots uses the <a href="https://api.imgur.com/">Imgur API</a> for storage the images and just send the URL of that images back to the <em>Bot Herder</em>.</p>

<p>Adding to all of this, it is used the <a href="https://freegeoip.net/">freegeoip</a> and <a href="https://developers.google.com/maps/documentation/static-maps/">Google Static Map API</a> for getting and showing the relative world position of the controlled hosts.</p>

<p>Also, it's used RSA encryption so the <em>Bot Herder</em> it's the only one capable of decrypt the messages sended by the bots because it's the <em>Private Key</em> owner. The bots encrypts the messages using the <em>Public Key</em> defined by the <em>Bot Herder</em>.</p>

<h2><a id="user-content-botnet-lab-setup" class="anchor" href="#botnet-lab-setup" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a><em>Botnet Lab</em> setup</h2>

<h3><a id="user-content-minimal-requirements" class="anchor" href="#minimal-requirements" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Minimal requirements</h3>

<h4><a id="user-content-operative-system" class="anchor" href="#operative-system" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Operative System</h4>

<p>Any Windows or Linux system will be capable of building and running the project.</p>

<h4><a id="user-content-dependencies" class="anchor" href="#dependencies" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Dependencies</h4>



<h2><a id="user-content-setup-guide" class="anchor" href="#setup-guide" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Setup guide</h2>

<p>Almost everyone of this steps are commands.</p>

<h4><a id="user-content-cloning-the-repository" class="anchor" href="#cloning-the-repository" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Cloning the repository</h4>

<ul>
<li><code>git clone https://github.com/jpdias/botnet-lab.git</code></li>
<li><code>cd botnet-lab/botnet-lab</code></li>
</ul>

<h4><a id="user-content-setting-up-the-virtual-environment" class="anchor" href="#setting-up-the-virtual-environment" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Setting up the virtual environment</h4>

<ul>
<li><code>virtualenv venv</code></li>
<li>Starting the created virtual envoirnemnt

<ul>
<li>Linux: <code>. venv/bin/activate</code></li>
<li>Windows: <code>venv\scripts\activate</code> </li>
</ul></li>
</ul>

<h3><a id="user-content-installing-project-dependencies" class="anchor" href="#installing-project-dependencies" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installing project dependencies</h3>

<ul>
<li><code>pip install -r requirements.txt</code>

<ul>
<li>This probably will fail at some point, because some of the used librarys are no longer supported or they stoped the development.</li>
</ul></li>
</ul>

<p>So, for each line of the requirements.txt do:</p>

<ul>
<li><code>pip install &lt;requirement&gt;</code></li>
</ul>

<p>If some of this fails try:</p>

<ul>
<li><code>sudo apt-get install python2.7-dev</code></li>
<li><code>pip install &lt;requirement&gt; --allow-external &lt;requirement&gt; --allow-unverified &lt;requirement&gt;</code></li>
</ul>

<p>If it fails to the best workaround is to search for a valid package. For example the dependency <code>pygame==1.9.2a0</code> will fail to install. </p>

<p><strong>Windows</strong></p>

<p>To make it install on Windows simple go to the <a href="http://www.lfd.uci.edu/%7Egohlke/pythonlibs/">Unofficial Windows Binaries for Python Extension Packages</a> from the <a href="http://www.uci.edu/">Univeristy of California</a> and use the respective wheel.
For example wiht <code>pygame==1.9.2a0</code> for Windows 64bit:</p>

<ul>
<li><code>pip install &lt;path_to_download_folder&gt;/pygame‑1.9.2a0‑cp33‑none‑win_amd64.whl</code></li>
</ul>

<p><strong>Linux</strong></p>

<p>In Linux there is no generic way of installing all the missing packages. For that we will go throught everyone that may cause problems and present a workaround.</p>

<ul>
<li><em>pygame</em>:
For installing <code>pygame</code> you can use the shell script below.
Remember to do this with the <code>venv</code> activated.</li>
</ul>

<pre><code>#!/bin/sh
BASE_PATH=`pwd`
sudo apt-get build-dep python-pygame
sudo apt-get install python-dev libsdl-image1.2-dev libsdl-mixer1.2-dev libsdl-ttf2.0-dev libsdl1.2-dev libsmpeg-dev python-numpy subversion libportmidi-dev ffmpeg libswscale-dev libavformat-dev libavcodec-dev libv4l-dev
cd /usr/include/linux
sudo ln -s ../libv4l1-videodev.h videodev.h
cd $BASE_PATH
wget http://www.pygame.org/ftp/pygame-1.9.1release.tar.gz
tar -xzf pygame-1.9.1release.tar.gz
cd pygame-1.9.1release
python config.py
sudo python setup.py install
cd $BASE_PATH
rm pygame-1.9.1release.tar.gz
sudo rm -rf pygame-1.9.1release
ln -s /usr/local/lib/python2.7/dist-packages/pygame venv/lib/python2.7/site-packages/pygame
</code></pre>



<p>Some of the libraries like <code>pyHook</code> and <code>pypiwin32</code> are Windows-only dependencies, so if you are on a Linux machine don't worry about them.</p>
</article>
  </div></body></html>