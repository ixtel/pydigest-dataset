<html><body><div><article class="entry-content"><p>После, пожалуй, самого длительного периода без обновлений в истории <strong class="trebuchet">Insight IT</strong>, сайт прошел через "реинкарнацию" - был переделан с нуля, сохранен лишь контент. Этого сложно не заметить, если Вы здесь не впервые. Желающих получить ответы на вопросы в духе "как так?", "зачем?", "что поменялось?" и "что дальше?" - прошу читать далее.</p><h2 id="kak-tak">Как так?</h2><p>Многие годы, занимаясь <strong class="trebuchet">Insight IT</strong>, я совмещал приятное с полезным: по большому счёту оставаясь просто хобби, сайт помогал мне знакомиться с будущими партнерами, клиентами, коллегами, что долгое время позволяло мне обходиться без стабильного источника дохода. Когда я в итоге "сдался" и пошел работать в крупную компанию за зарплату - эта дополнительная ценность стала менее значимой. Во многом из-за этого здесь нельзя найти ни одной записи датированной прошлым годом (хотя есть и другие причины, конечно, но об этом в заключении).</p><h2 id="zachem">Зачем?</h2><p>Резонный вопрос - зачем вкладывать столько сил, чтобы всё переделать на в заброшенном сайте? Началось всё со спортивного интереса: я начал замечать, что постепенно теряю хватку в мирах opensource и веб-разработки. В Яндексе вокруг меня по большей части разный backend внутренней разработки. Кандидат для экспериментов в лице <strong class="trebuchet">Insight IT</strong> нашелся быстро, что из этого получилось - в следующем разделе.</p><h2 id="chto-pomenialos">Что поменялось?</h2><h3 id="rip-wordpress">R.I.P. WordPress</h3><p>Первые 6 c половиной лет своего существования <strong class="trebuchet">Insight IT</strong> проработал на <a href="/tag/wordpress/">WordPress</a> в качестве <abbr title="Content Management System">CMS</abbr>. С пьедестала самой популярной <abbr title="Content Management System">CMS</abbr> в мире, насколько я знаю, за всё это время WordPress так никто и не сместил. Думаю, в первую очередь благодаря крайне простому в использовании интерфейсу для управления сайтом, а во вторую - выдающемуся ассортименту плагинов и тем. Плюс имевший место в 2008-м акцент на блоги отходит в сторону, сейчас на нем какие только сайты не делают.</p><p>Но за <del>красоту</del> простоту приходится платить:</p><ul><li><abbr title="What You See Is What You Get">WYSIWYG</abbr> редактор создает верстку сомнительного качества,</li><li>При установке большого числа плагинов и без того далёкая от идеала производительность становится невыносимой,</li><li>У всех компонентов разные разработчики и релизные циклы, постоянно нужно следить за совместимостью, регулярно накатывать обновления как минимум по части безопасности, после обновлений часто всё ломается.</li></ul><p>Вопрос с производительностью решается агрессивным кешированием и клиентской оптимизацией. Не раз занимался этим для других сайтов, в том числе и на WordPress, но для некоммерческого проекта не понятно как оправдать трудозатраты на изначальную настройку и поддержание этого всего в рабочем состоянии. Зачастую плагины разрабатываются без оглядки на то, что, например, <a href="/tag/javascript/">JavaScript</a>-библиотека, от которой они зависят, может быть ещё не быть загружена и пытаются ей пользоваться в распечатанном прямо вперемешку с HTML JavaScript, что даже само по себе плохо, а с перенесенными вниз зависимостями и вовсе не работает.</p><p>Верстку тоже можно "чинить" через текстовый режим редактора, но такие правки имеют обыкновение пропадать после любого изменения в визуальном режиме, что крайне надоедает.</p><p>Уже в 2009-м минусы WordPress для меня начали перевешивать плюсы. Тогда достойной альтернативы, увы, не нашлось и всё осталось как есть. Но не в этот раз.</p><h3 id="staticheskie-saity">Статические сайты</h3><p>Несколько лет назад начал набирать популярность подход с <strong>генерацией статических сайтов</strong>:</p><ul><li>Вместо хранения в базе данных статьи и другой контент приравнивается к исходному коду, то есть:<ul><li>Хранятся в системе контроля версий в виде файлов в специализированном формате (как правило, <a href="https://www.insight-it.ru/goto/4eefcf89/" rel="nofollow" target="_blank" title="https://ru.wikipedia.org/wiki/Markdown">Markdown</a> или ReStructured Text), который удобен для написания человеко-читаемых текстов и однозначно преобразовывается в чистый, валидный, HTML.</li><li>Пишутся в текстовых редакторах, ориентированных на разработчиков, с подсветкой синтаксиса, автодополнением и т.п.</li><li>При необходимости легко начать использовать общепринятые инструменты для работы с кодом, в том числе совместной (ревью кода, ветвление, непрерывная интеграция, отслеживание проблем).</li></ul></li><li>С помощью <code>make</code> или аналога сайт собирается примерно так же, как это делала бы программа на <a href="/tag/c/">C++</a>:<ul><li>Создается output директория с будущим результатом.</li><li>В ней генерируются все страницы сайта - для статей с помощью шаблонизатора добавляется вся необходимая HTML-обвязка, а навигационные страницы (по категориям и тегам, с по-страничным выводом) создаются с нуля, тоже по шаблону.</li><li>Весь клиентский код на JavaScript и CSS, а также статические файлы вроде изображений, группируются и прогоняются через разные фильтры для уменьшения количества файлов и их размеров.</li><li>Внутренние ссылки в исходном коде как правило реализованы по путям в локальной файловой системе, а как они будут выглядеть в итоговом сайте конфигурируется и тоже применяется при сборке.</li></ul></li><li>В итоге, чтобы посмотреть на результат в браузере подойдет любой веб-сервер, умеющий отдавать статические файлы из папки, то есть совсем любой за вычетом специализированных.</li><li>Как легко такую папочку кешировать на всех уровнях, а также как быстро и дешево можно такой сайт показывать пользователям, рассказывать, думаю, не нужно.</li><li>Но у отсутствия динамической серверной логики есть и минусы:<ul><li><del>Тоска по гламурной админке WordPress.</del></li><li>Для реализации некоторого функционала <em>(в нашем случае - комментариев и поиска по сайту)</em> требуется как-то изворачиваться, возможные варианты:<ul><li>Воспользоваться сторонним сервисом - <a href="/tag/disqus/">Disqus</a> уже использовался и раньше, а обе лидирующие поисковые системы предоставляют сервис поиска по конкретному сайту, так что я пошел по этому пути).</li><li>Поселить рядом с кучей статики какой-о набор скриптов, но не очень понятно как их интегрировать с системой сборки сайта, которая по сути выполняет роль <abbr title="Content Management System">CMS</abbr>.</li><li>Реализовать его на JavaScript - скажем для поиска по сайту можно при сборке сложить весь контент в один большой JSON, и искать по нему уже на клиенте. Но я решил пожалеть пользователей с долгоиграющими ноутбуками, особенно новых без вентиляторов. Раньше ещё можно было пожалеть владельцев смартфонов, но когда их стали делать восьми-ядерными...</li></ul></li><li>Время, которое технически необходимо для публикации нового контента или изменений в шаблонах, начинает зависеть от размера самого сайта - не смотря на попытки реализовать кеширование при сборке, многие изменения требуют перегенерации примерно всего сайта.</li></ul></li><li>И, напоследок, ввиду низкой серверной ресурсоемкости таких сайтов, для него легко найти качественный хостинг бесплатно.</li></ul><p>Взвесив "за" и "против", я решил, что для <strong class="trebuchet">Insight IT</strong> такой вариант очень даже подходит. Осталось выбрать конкретную реализацию такой системы сборки сайта.</p><p>Первопроходцем и лидером рынка здесь является <a href="https://www.insight-it.ru/goto/d9898f57/" rel="nofollow" target="_blank" title="http://jekyllrb.com/">Jekyll</a>. Всем хорош, очень много кем используется, масса тем и плагинов. Но один субъективный минус поставил на нём лично для меня крест - <a href="/tag/ruby/">Ruby</a>. Вот тошнит меня от его синтаксиса и всё.</p><p>Был вариант, конечно, закрыть на это глаза и не лезть вглубь, а просто собрать сайт из готовых компонентов, но опыт подсказывает, что без напильника нынче ничего не взлетает.</p><p>Подходящую альтернативу искать долго не пришлось: выбор пал на <a href="https://www.insight-it.ru/goto/f5099f2a/" rel="nofollow" target="_blank" title="http://getpelican.com">Pelican</a>, практически единственный вариант на <a href="/tag/python/">Python</a>. Готовых плагинов у него не так много, но самое основное есть, а недостающее мне определенно было не сложно допилить, благо с экосистемой Python я тесно знаком. В качестве шаблонизатора используется <a href="/tag/jinja2/">Jinja2</a>, лучше которого я по-прежнему ничего не видел. Про сам перенос сайта можно написать отдельный пост, и не один, что я надеюсь и сделаю в скором будущем, так что здесь эту тему дальше развивать не буду.</p><h3 id="https">https://</h3><p>Как при желании можно было заметить, <strong class="trebuchet">Insight IT</strong> уже много лет живет за <a href="https://www.insight-it.ru/goto/26a5858d/" rel="nofollow" target="_blank" title="https://www.cloudflare.com/">CloudFlare</a> - многофункциональной распределенной прокси, выполняющей роль <abbr title="Content Delivery Network">CDN</abbr>, <abbr title="Domain Name System">DNS</abbr>,защиты от разного рода атак и многого другого. Изначально поддержка <abbr title="Secure Sockets Layer">SSL</abbr> была доступна только на платном тарифе, который некоммерческому проекту был ни к чему, но с недавних пор это стало не так и я за компанию решил перейти на <code>https://</code>, раз уж всё равно все внутренние ссылки переехали. Плюсы не критичны, но всё же есть:</p><ul><li>Само отображение защищенного соединения в адресной строке браузеров внушает уверенность если не всем, то какой-то части посетителей</li><li>Поддержка современных протоколов в лице SPDY и, вероятно, со временем HTTP/2.0</li><li>Говорят, использование защищенного соединения положительно сказывается на репутации сайта в глазах как минимум поиска Google</li><li>Владельцы публичных WiFi точек не могут показывать свою рекламу на сайте</li></ul><p>Основной минус - дополнительные накладные расходы на инициализацию соединения и, собственно, шифрование, но как правило это не особо критично.</p><p>К слову, стоявший за CloudFlare простенький <abbr title="Virtual Private Server">VPS</abbr> тоже заменен, на наиболее популярный среди хостингов статичных сайтов <a href="https://www.insight-it.ru/goto/e7e0e370/" rel="nofollow" target="_blank" title="https://pages.github.com/">GitHub Pages</a>.</p><h3 id="kontent">Контент</h3><p>В состав Pelican входит инструмент для конвертации статей из XML-формата WordPress в Markdown, которым я и воспользоваться. Большую часть работы он сделал, но всё равно потребовался ручной просмотр и адаптация всех страниц сайта. Это заняло уйму времени, но в целом того стоило:</p><ul><li>Везде причёсан HTML, во многом благодаря <a href="/tag/markdown/">Markdown</a>; лучше оформлены изображения и врезки, ещё раз проверены опечатки.</li><li>Исторически статьи раскладывались по рубрикам по мере написания, по-этому общая структура сайта была хаотичной. Теперь разбил их на категории по-другому, на этот раз, надеюсь, более логичным образом.</li><li>Пока перечитывал осознал, что значительная часть контента морально устарела и годится только для совсем начинающих или как историческая перспектива. Решил сделать некоторый акцент на годе публикации - теперь он присутствует в URL статей, а также в <a href="https://www.insight-it.ru/highload/">оглавлении публикаций об архитектуре высоконагруженных интернет-проектов</a>. Совсем-совсем неактуальным пришлось пожертвовать или явно подписать соответствующим образом.</li><li>Как следствие из предыдущих двух пунктов, в очередной раз полностью поменялась структура ссылок сайта. По-возможности со старых адресов сохранены редиректы, но, к сожалению, в концепции статических сайтов возможны только клиентские, через meta-тег или JavaScript. Поисковые системы же предпочитают серверные, через 301/307 HTTP-код и заголовок Location.</li><li>В общем, позиции <strong class="trebuchet">Insight IT</strong> в поисковых системах определенно пострадают, остается лишь надеяться что не катастрофическим образом - ведь сейчас это основной источник посетителей. Если вам не безразлична судьба сайта - твиты, лайки и прочие входящие ссылки по новым адресам крайне приветствуются.</li><li>Теперь весь контент публикуется под лицензией <a href="https://www.insight-it.ru/goto/c3aba0/" rel="nofollow" target="_blank" title="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>, о чем свидетельствует значок в правом-нижнем углу каждой страницы.</li></ul><h3 id="dizain">Дизайн</h3><p>В плане дизайна я не особо гурман, но предыдущий определенно требовал замены. Изыски здесь ни к чему, так что всё свелось к выбору готовой визуальной концепции.</p><p>За всё те же последние несколько лет <a href="https://www.insight-it.ru/goto/80e3ad2/" rel="nofollow" target="_blank" title="http://getbootstrap.com/">Twitter Bootstrap</a> стал решением по-умолчанию для подобных ситуаций благодаря низкому порогу входа и хорошей комбинации встроенного функционала, кроссбраузерности и приличного внешнего вида. По иронии ровно это и стало причиной моего от него отказа в данном случае: уж больно он всем приелся и на каждом углу почти без изменений используется.</p><p>В своё время мне приглянулось своей стройностью и логичностью концепция <a href="https://www.insight-it.ru/goto/7d571a9f/" rel="nofollow" target="_blank" title="http://www.google.com/design/spec/">Material Design</a> от <a href="/tag/google/">Google</a>, которую они активно внедряют сами и всем советуют. Не долго думая, я пошел поискать opensource решения с готовой реализацией для веб-сайтов и остановился на <a href="https://www.insight-it.ru/goto/823b55/" rel="nofollow" target="_blank" title="http://materializecss.com">варианте</a>, который одновременно имел достаточный функционал, сколько-либо большое сообщество и минимум зависимостей, особенно от громоздких <a href="/tag/javascript/">JavaScript</a>-библиотек, чем грешили альтернативные варианты.</p><p>Основной цвет сменился с желтовато-зеленого на ярко синий, появился набор акцентных цветов, а типографичный логотип остался почти неизменным. Иконочный шрифт сделан специальный, только с использующимися иконками, получается очень маленький по байтам.</p><p>Итого, с моей субъективной колокольни получилось заметно лучше прежнего, но хочется всё же услышать и ваше мнение в комментариях.</p><h2 id="chto-dalshe_1">Что дальше?</h2><p>Как обычно, многое зависит от вас, читателей. Вложенные в реконструкцию сайта силы дают некоторый толчок к мотивации писать новые материалы, но без обратной связи её определенно на долго не хватит.</p><p>С закрытием Google Reader два года назад число подписчиков на счетчике от FeedBurner упало почти на два порядка, так что можно считать, что сейчас и правда для <strong class="trebuchet">Insight IT</strong> всё начинается почти с начала.</p><div class="card-panel light-blue darken-2 light-blue-text text-lighten-4"><span class="published" title="2015-05-30T20:10:00+03:00">30 мая 2015</span><p> | </p><span class="vcard author"><a class="url fn light-blue-text text-lighten-4" href="https://www.insight-it.ru/author/"> Иван Блинков </a></span><p> | </p><a href="https://www.insight-it.ru/category/misc/" class="light-blue-text text-lighten-4"> Разное </a></div></article></div></body></html>