<html><body><div><p>Asterisklint is a suite of tools to check syntax of your Asterisk PBX
configuration files.</p>
<p>Alright, enough talking. Some examples please.</p>
<div id="invocation">
<h2>Invocation</h2>
<pre><span class="gp">$</span> asterisklint
<span class="go">usage: asterisklint [-h] COMMAND
asterisklint: error: the following arguments are required: COMMAND

</span><span class="gp">$</span> asterisklint ls
<span class="go">builtin:
  ls                    List available commands.

/usr/lib/python/dist-packages:
  dialplan-check        Do sanity checks on dialplan. Takes 'extensions.conf'
                        as argument. Suppress error classes using ALINT_IGNORE.
  dialplan-show         Show dialplan like Asterisk does with CLI command
                        "dialplan show". Takes 'extensions.conf' as argument.
  modules-show          Show which modules, apps and functions are used by the
                        dialplan. Takes 'extensions.conf' as argument.

Place custom commands in ~/.asterisklint/asterisklint/commands.</span>
</pre>
<p>Take this little dialplan snippet, that we’ll call <tt>extensions.conf</tt>:</p>
<pre>[default]
exten =&gt; _8[2-9]x,1,NoOp
 same =&gt; n,GoSub(somewhere,s,1(argument1,argument2)
 same =&gt; n,Payback(audiofile)
</pre>
<p>Now run the <tt><span class="pre">dialplan-check</span></tt> command on it:</p>
<pre><span class="gp">$</span> <span class="nv">ALINT_IGNORE</span><span class="o">=</span>H_DP_ asterisklint dialplan-check extensions.conf
<span class="go">extensions.conf:2 H_PAT_NON_CANONICAL: pattern '_8[2-9]x' is not in the canonical form '_8NX'
extensions.conf:3 W_APP_BAD_CASE: app 'GoSub' does not have the proper Case 'Gosub'
extensions.conf:3 W_APP_BALANCE: app data 'somewhere,1,s(argument1,argument2' looks like unbalanced parentheses/quotes/curlies
extensions.conf:4 E_APP_MISSING: app 'Payback' does not exist, dialplan will halt here!</span>
</pre>
<p>It had a lot to complain about that little snippet. But it was right. We
even suppressed two hints about a missing <tt>[general]</tt> and <tt>[global]</tt>
context using <tt>ALINT_IGNORE</tt>.</p>
<p>Not everything it checks is documented, and it does not check everything
that we like yet. But it’s a start. Bug reports are welcome. Feature requests
prefer to be accompanied by a patch :-)</p>
<p>Try out <tt><span class="pre">modules-show</span></tt> if you use <tt>autoload=no</tt> in your <tt>modules.conf</tt>.</p>
<p>All commands show help if asked:</p>
<pre><span class="gp">$</span> asterisklint modules-show --help
<span class="go">usage: asterisklint modules-show [-h] EXTENSIONS_CONF

Show which modules, apps and functions are used by the dialplan. Useful when
you use autoload=no in your modules.conf. Beware that you do need more modules
than just these listed.

positional arguments:
  EXTENSIONS_CONF  path to extensions.conf

optional arguments:
  -h, --help       show this help message and exit</span>
</pre>
</div>
<div id="installation">
<h2>Installation</h2>
<p>Installation is a matter of <tt>python3 setup.py install</tt>. Or, for more convenience,
install a PyPI uploaded version through <tt>pip3(1)</tt>:</p>
<pre><span class="gp">$</span> sudo pip3 install asterisklint
<span class="go">...
Successfully installed asterisklint</span>
</pre>
<p>The <tt><span class="pre">dialplan-check</span></tt> comes in handy as a git commit hook, for example
<tt><span class="pre">.git/hooks/pre-commit</span></tt>:</p>
<pre><span class="ch">#!/bin/sh
</span><span class="nb">export</span> <span class="nv">ALINT_IGNORE</span><span class="o">=</span>  <span class="c1"># adjust as needed
</span>
asterisklint dialplan-check PATH/TO/extensions.conf
<span class="nv">ret</span><span class="o">=</span><span class="nv">$?</span>
<span class="k">if</span> <span class="nb">test</span> $ret -ne 0<span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> &gt;<span class="p">&amp;</span>2
    <span class="nb">echo</span> <span class="s1">'One or more dialplan syntax errors. Please fix before committing.'</span> &gt;<span class="p">&amp;</span>2
    <span class="nb">exit</span> $ret
<span class="k">fi</span>

<span class="nb">exit</span> 0
</pre>
</div>
</div></body></html>