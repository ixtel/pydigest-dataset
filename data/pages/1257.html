<html><body><div><div class="postcontents">
                    <p>Cleo 0.2 is now out with a lot of improvements and new features.</p>

<h2 id="what-is-cleo">What is cleo?</h2>

<p>Cleo eases the creation of beautiful and testable command line interfaces.</p>

<p>It is heavily inspired by the <a href="https://github.com/symfony/Console">Symfony Console Component</a>, with some useful additions.</p>

<p>Full documentation available here: <a href="http://cleo.readthedocs.org">http://cleo.readthedocs.org</a></p>

<h2 id="installation">Installation</h2>

<p>You can install Cleo in two different ways:</p>



<h2 id="usage">Usage</h2>
<p>The Application object manages the CLI application:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">cleo</span> <span class="kn">import</span> <span class="n">Application</span>

<span class="n">console</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>
<span class="n">console</span><span class="o">.</span><span class="n">run</span><span class="p">()</span></code></pre></div>

<p>The <code>run()</code> method parses the arguments and options passed on the command
line and executes the right command.</p>

<p>Registering a new command can easily be done via the <code>register()</code> method,
which returns a <code>Command</code> instance:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">cleo.input</span> <span class="kn">import</span> <span class="n">InputArgument</span><span class="p">,</span> <span class="n">InputOption</span>

<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">output_</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">input_</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">'name'</span><span class="p">)</span>

    <span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'Hello &lt;info&gt;</span><span class="si">%s</span><span class="s">&lt;/info&gt;'</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

<span class="n">console</span>\
    <span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s">'hello'</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">set_definition</span><span class="p">([</span>
        <span class="n">InputArgument</span><span class="p">(</span><span class="s">'name'</span><span class="p">,</span> <span class="n">InputArgument</span><span class="o">.</span><span class="n">REQUIRED</span><span class="p">,</span> <span class="s">'The name'</span><span class="p">),</span>
    <span class="p">])</span>\
    <span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">'Says hello!'</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">set_code</span><span class="p">(</span><span class="n">hello</span><span class="p">)</span></code></pre></div>

<p>You can also register new commands via classes.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">cleo</span> <span class="kn">import</span> <span class="n">Command</span>

<span class="k">class</span> <span class="nc">HelloCommand</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">'hello'</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">'Says hello!'</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'name'</span><span class="p">,</span> <span class="n">InputArgument</span><span class="o">.</span><span class="n">REQUIRED</span><span class="p">,</span> <span class="s">'The name'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">output_</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">input_</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">'name'</span><span class="p">)</span>

        <span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'Hello &lt;info&gt;</span><span class="si">%s</span><span class="s">&lt;/info&gt;'</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

<span class="n">console</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">HelloCommand</span><span class="p">())</span></code></pre></div>

<p>But it might be a little too verbose for some. That’s why commands can also be declared and registered via dictionaries.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">hello_command</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'hello'</span><span class="p">,</span>
    <span class="s">'description'</span><span class="p">:</span> <span class="s">'Says hello!'</span><span class="p">,</span>
    <span class="s">'arguments'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s">'name'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'mode'</span><span class="p">:</span> <span class="s">'required'</span><span class="p">,</span>
            <span class="s">'description'</span><span class="p">:</span> <span class="s">'The name'</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s">'code'</span><span class="p">:</span> <span class="n">hello</span>
<span class="p">}</span>

<span class="n">console</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hello_command</span><span class="p">)</span></code></pre></div>

<div class="note">
<p>With dictionaries, you will not be able to do as many things as with classes declaration since you won't have access to the <code>Command</code> instance.</p>
</div>

<h3 id="output-coloring">Output coloring</h3>

<p>Cleo provides output coloring out of the box, you just need to surround the text with tags:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># green text</span>
<span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'&lt;info&gt;foo&lt;/info&gt;'</span><span class="p">)</span>

<span class="c"># yellow text</span>
<span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'&lt;comment&gt;foo&lt;/comment&gt;'</span><span class="p">)</span>

<span class="c"># black text on a cyan background</span>
<span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'&lt;question&gt;foo&lt;/question&gt;'</span><span class="p">)</span>

<span class="c"># white text on a red background</span>
<span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'&lt;error&gt;foo&lt;/error&gt;'</span><span class="p">)</span></code></pre></div>

<p>Those are the default styles but you can easily define your own :</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">style</span> <span class="o">=</span> <span class="n">OutputFormatterStyle</span><span class="p">(</span><span class="s">'red'</span><span class="p">,</span> <span class="s">'yellow'</span><span class="p">,</span> <span class="p">[</span><span class="s">'bold'</span><span class="p">,</span> <span class="s">'blink'</span><span class="p">])</span>
<span class="n">output_</span><span class="o">.</span><span class="n">get_formatter</span><span class="p">()</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">'fire'</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
<span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'&lt;fire&gt;foo&lt;/fire&gt;'</span><span class="p">)</span></code></pre></div>

<p>If you don’t want to set the styles upfront, you can just as easily set the colors and options inside the tagnames :</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># green text</span>
<span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'&lt;fg=green&gt;foo&lt;/fg=green&gt;'</span><span class="p">)</span>

<span class="c"># black text on a cyan background</span>
<span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'&lt;fg=black;bg=cyan&gt;foo&lt;/fg=black;bg=cyan&gt;'</span><span class="p">)</span>

<span class="c"># bold text on a yellow background</span>
<span class="n">output_</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="s">'&lt;bg=yellow;options=bold&gt;foo&lt;/bg=yellow;options=bold&gt;'</span><span class="p">)</span></code></pre></div>

<h3 id="testable-commands">Testable commands</h3>

<p>Cleo provides input and output abstraction so that you can easily unit-test your commands, especially with the <code>CommandTester</code> class:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span> <span class="nn">cleo</span> <span class="kn">import</span> <span class="n">Application</span><span class="p">,</span> <span class="n">CommandTester</span>

<span class="k">class</span> <span class="nc">GreetCommandTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">application</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>
        <span class="n">application</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">greet_command</span><span class="p">)</span>
        <span class="c"># Or application.add(GreetCommand()) if using classes</span>

        <span class="n">commmand</span> <span class="o">=</span> <span class="n">application</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'demo:greet'</span><span class="p">)</span>
        <span class="n">command_tester</span> <span class="o">=</span> <span class="n">CommandTester</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">command_tester</span><span class="o">.</span><span class="n">execute</span><span class="p">([(</span><span class="s">'command'</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">get_name</span><span class="p">())])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRegex</span><span class="p">(</span><span class="s">'...'</span><span class="p">,</span> <span class="n">command_tester</span><span class="o">.</span><span class="n">get_display</span><span class="p">())</span>

        <span class="c"># ...</span></code></pre></div>

<p>Basically, the <code>get_display()</code> method returns what would have been displayed during a normal call from the console.</p>

<h3 id="helpers">Helpers</h3>

<p>Cleo comes bundled with some nice helpers that will cover some basic needs when developing command-line interfaces.</p>

<p>The <code>DialogHelper</code> will, basically, prompt the user for answers:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># ...</span>
<span class="k">if</span> <span class="n">dialog</span><span class="o">.</span><span class="n">ask_confirmation</span><span class="p">(</span>
    <span class="n">output_</span><span class="p">,</span>
    <span class="s">'&lt;question&gt;Continue with this action?&lt;/question&gt;'</span><span class="p">,</span>
    <span class="bp">False</span>
<span class="p">):</span>
    <span class="c"># Some code</span></code></pre></div>

<p>This code will prompt for a yes/no anwser, while this code:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># ...</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span>
    <span class="n">output_</span><span class="p">,</span>
    <span class="s">'Please enter your name'</span><span class="p">,</span>
    <span class="s">'John Doe'</span>
<span class="p">)</span></code></pre></div>

<p>will prompt for a more generic answer.</p>

<p>The <code>ProgressHelper</code> allows you to display a progress bar for actions that might take a while:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">progress</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_helper_set</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'progress'</span><span class="p">)</span>

<span class="n">progress</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">output_</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="c"># ... do some work</span>

    <span class="c"># advance the progress bar 1 unit</span>
    <span class="n">progress</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>

<span class="n">progress</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span></code></pre></div>

<p>And the <code>TableHelper</code> will display automatically tabular data:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">get_helper_set</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'table'</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">set_headers</span><span class="p">([</span><span class="s">'ISBN'</span><span class="p">,</span> <span class="s">'Title'</span><span class="p">,</span> <span class="s">'Author'</span><span class="p">])</span>
<span class="n">table</span><span class="o">.</span><span class="n">set_rows</span><span class="p">([</span>
   <span class="p">[</span><span class="s">'99921-58-10-7'</span><span class="p">,</span> <span class="s">'Divine Comedy'</span><span class="p">,</span> <span class="s">'Dante Alighieri'</span><span class="p">],</span>
   <span class="p">[</span><span class="s">'9971-5-0210-0'</span><span class="p">,</span> <span class="s">'A Tale of Two Cities'</span><span class="p">,</span> <span class="s">'Charles Dickens'</span><span class="p">],</span>
   <span class="p">[</span><span class="s">'960-425-059-0'</span><span class="p">,</span> <span class="s">'The Lord of the Rings'</span><span class="p">,</span> <span class="s">'J. R. R. Tolkien'</span><span class="p">],</span>
   <span class="p">[</span><span class="s">'80-902734-1-6'</span><span class="p">,</span> <span class="s">'And Then There Were None'</span><span class="p">,</span> <span class="s">'Agatha Christie'</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">table</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">output_</span><span class="p">)</span></code></pre></div>

<p>There is a lot more you can do with Cleo, you can just give a look at the documentation: <a href="http://cleo.readthedocs.org">http://cleo.readthedocs.org</a>.</p>

<p>And if you are interested by how it all works, you can just check out the <a href="https://github.com/sdispater/cleo">Github Repository</a>, and feel free to contribute.</p>

<p>And, finally, here are some features for the 0.3 version:</p>

<ul>
  <li>Set commands with decorators</li>
  <li>Validators for the arguments and options</li>
  <li>Autocompletion of commands</li>
</ul>

<p>You can check the advancement on <a href="https://github.com/sdispater/cleo/issues?q=is%3Aissue+milestone%3A0.3">the Github project</a></p>

                </div>
                </div></body></html>