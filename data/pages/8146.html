<html><body><div><div id="content">

            

            
        


            <div class="section">
              <h1>oss2 2.0.5</h1>

              


<p>Aliyun OSS (Object Storage Service) SDK</p>








<div id="id1">
<h2>概述</h2>
<p>阿里云对象存储Python SDK 2.x版本。该版本不和上一个版本（0.x版本）兼容，包的名称为oss2，以避免和先前的版本冲突。</p>
<p>该版本的SDK依赖于第三方HTTP库 <a href="https://github.com/kennethreitz/requests" rel="nofollow">requests</a> ，请按照下述安装方法进行安装。</p>

</div>
<div id="id2">
<h2>运行环境</h2>
<p>Python 2.6，2.7，3.3，3.4，3.5</p>

</div>
<div id="id3">
<h2>安装方法</h2>
<p>通过pip安装官方发布的版本（以Linux系统为例）：</p>
<pre>$ pip install oss2
</pre>
<p>也可以直接安装解压后的安装包：</p>
<pre>$ sudo python setup.py install
</pre>
</div>
<div id="id4">
<h2>快速使用</h2>
<pre><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">oss2</span>

<span class="n">endpoint</span> <span class="o">=</span> <span class="s1">'http://oss-cn-hangzhou.aliyuncs.com'</span> <span class="c1"># 假设你的Bucket处于杭州区域</span>

<span class="n">auth</span> <span class="o">=</span> <span class="n">oss2</span><span class="o">.</span><span class="n">Auth</span><span class="p">(</span><span class="s1">'&lt;你的AccessKeyId&gt;'</span><span class="p">,</span> <span class="s1">'&lt;你的AccessKeySecret&gt;'</span><span class="p">)</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">oss2</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="s1">'&lt;你的Bucket名&gt;'</span><span class="p">)</span>

<span class="c1"># Bucket中的文件名（key）为storage.txt</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">'story.txt'</span>

<span class="c1"># 上传</span>
<span class="n">bucket</span><span class="o">.</span><span class="n">put_object</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">'Ali Baba is a happy youth.'</span><span class="p">)</span>

<span class="c1"># 下载</span>
<span class="n">bucket</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># 删除</span>
<span class="n">bucket</span><span class="o">.</span><span class="n">delete_object</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># 遍历Bucket里所有文件</span>
<span class="k">for</span> <span class="n">object_info</span> <span class="ow">in</span> <span class="n">oss2</span><span class="o">.</span><span class="n">ObjectIterator</span><span class="p">(</span><span class="n">bucket</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">object_info</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</pre>
<p>更多例子请参考examples目录下的代码。</p>
</div>
<div id="id5">
<h2>出错处理</h2>
<p>除非特别说明，一旦出错，Python SDK的接口就会抛出异常（见oss2.exceptions子模块）。参考下面的例子：</p>
<pre><span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="k">except</span> <span class="n">oss2</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">NoSuchKey</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'{0} not found: http_status={1}, request_id={2}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">request_id</span><span class="p">))</span>
</pre>
</div>
<div id="id6">
<h2>测试</h2>
<p>首先通过环境变量来设置测试所需的AccessKeyId、AccessKeySecret、Endpoint以及Bucket信息（<strong>请不要使用生产环境的Bucket</strong>）。
以Linux系统为例：</p>
<pre>$ <span class="nb">export</span> <span class="nv">OSS_TEST_ACCESS_KEY_ID</span><span class="o">=</span>&lt;AccessKeyId&gt;
$ <span class="nb">export</span> <span class="nv">OSS_TEST_ACCESS_KEY_SECRET</span><span class="o">=</span>&lt;AccessKeySecret&gt;
$ <span class="nb">export</span> <span class="nv">OSS_TEST_ENDPOINT</span><span class="o">=</span>&lt;endpoint&gt;
$ <span class="nb">export</span> <span class="nv">OSS_TEST_BUCKET</span><span class="o">=</span>&lt;bucket&gt;
</pre>
<p>然后通过以下方式之一运行测试：</p>
<pre>$ python -m unittest discover tests  <span class="c1"># 如果Python版本 &gt;= 2.7
</span>$ nosetests                          <span class="c1"># 如果安装了nose</span>
</pre>
</div>





<a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>109</span> downloads in the last week
  </li>
  <li>
    <span>831</span> downloads in the last month
  </li>
</ul>









            </div>


          </div>
          </div></body></html>