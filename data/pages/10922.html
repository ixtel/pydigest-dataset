<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-about-conn-check" class="anchor" href="#about-conn-check" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>About conn-check</h1>
<p>conn-check allows for checking connectivity with external services.</p>
<p>You can write a config file that defines services that you need to
have access to, and conn-check will check connectivity with each.</p>
<p>It supports various types of services, all of which allow for
basic network checks, but some allow for confirming credentials
work also.</p>
<a name="user-content-configuration"/>
<h2><a id="user-content-configuration" class="anchor" href="#configuration" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Configuration</h2>
<p>The configuration is done via a yaml file. The file defines a list
of checks to do:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-s">- <span class="pl-ent">type:</span> <span class="pl-s">tcp</span></span>
  <span class="pl-s"><span class="pl-ent">host:</span> <span class="pl-s">localhost</span></span>
  <span class="pl-c1"><span class="pl-ent">port:</span> 80</span>
<span class="pl-s">- <span class="pl-ent">type:</span> <span class="pl-s">tls</span></span>
  <span class="pl-s"><span class="pl-ent">host:</span> <span class="pl-s">localhost</span></span>
  <span class="pl-c1"><span class="pl-ent">port:</span> 443</span>
  <span class="pl-s"><span class="pl-ent">disable_tls_verification:</span> <span class="pl-s">false</span></span></pre></div>
<p>Each check defines a type, and then options as appropriate for that type.</p>
<p>For a step by step guide on configuring conn-check for your application
<a href="http://conn-check.readthedocs.org/">see the tutorial</a>.</p>
<a name="user-content-check-types"/>
<h2><a id="user-content-check-types" class="anchor" href="#check-types" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Check Types</h2>
<a name="user-content-tcp"/>
<h3><a id="user-content-tcp" class="anchor" href="#tcp" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>tcp</h3>
<p>A simple tcp connectivity check.</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>The port.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-tls"/>
<h3><a id="user-content-tls" class="anchor" href="#tls" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>tls</h3>
<p>A check that uses TLS (ssl is a deprecated alias for this type).</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>The port.</dd>
<dt>disable_tls_verification</dt>
<dd>Optional flag to disable verification of TLS certs and handshake. Default:
false.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-udp"/>
<h3><a id="user-content-udp" class="anchor" href="#udp" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>udp</h3>
<p>Check that sending a specific UDP packet gets a specific response.</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>The port.</dd>
<dt>send</dt>
<dd>The string to send.</dd>
<dt>expect</dt>
<dd>The string to expect in the response.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-http"/>
<h3><a id="user-content-http" class="anchor" href="#http" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>http</h3>
<p>Check that a HTTP/HTTPS request succeeds (https also works).</p>
<dl>
<dt>url</dt>
<dd>The URL to fetch.</dd>
<dt>method</dt>
<dd>Optional HTTP method to use. Default: "GET".</dd>
<dt>expected_code</dt>
<dd>Optional status code that defines success. Default: 200.</dd>
<dt>proxy_url</dt>
<dd>Optional HTTP/HTTPS proxy URL to connect via, including protocol,
if set proxy_{host,port} are ignored.</dd>
<dt>proxy_host</dt>
<dd>Optional HTTP/HTTPS proxy to connect via.</dd>
<dt>proxy_port</dt>
<dd>Optional port to use with <code>proxy_host</code>. Default: 8000.</dd>
<dt>headers:</dt>
<dd>Optional headers to send, as a dict of key-values. Multiple values can be
given as a list/tuple of lists/tuples, e.g.:
<code>[('foo', 'bar'), ('foo', 'baz')]</code></dd>
<dt>body:</dt>
<dd>Optional raw request body string to send.</dd>
<dt>disable_tls_verification:</dt>
<dd>Optional flag to disable verification of TLS certs and handshake. Default:
false.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
<dt>allow_redirects</dt>
<dd>Optional flag to Follow 30x redirects. Default: false.</dd>
<dt>params</dt>
<dd>Optional dict of params to URL encode and pass in the querystring.</dd>
<dt>cookies</dt>
<dd>Optional dict of cookies to pass in the request headers.</dd>
<dt>auth</dt>
<dd>Optional <a href="https://en.wikipedia.org/wiki/Basic_access_authentication">basic HTTP auth</a>
credentials, as a tuple/list: <code>(username, password)</code>.</dd>
<dt>digest_auth</dt>
<dd>Optional <a href="https://en.wikipedia.org/wiki/Digest_access_authentication">digest HTTP auth</a>
credentials, as a tuple/list: <code>(username, password)</code>.</dd>
</dl>
<a name="user-content-amqp"/>
<h3><a id="user-content-amqp" class="anchor" href="#amqp" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>amqp</h3>
<p>Check that an AMQP server can be authenticated against.</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>The port.</dd>
<dt>username</dt>
<dd>The username to authenticate with.</dd>
<dt>password</dt>
<dd>The password to authenticate with.</dd>
<dt>use_tls</dt>
<dd>Optional flag whether to connect with TLS. Default: true.</dd>
<dt>vhost</dt>
<dd>Optional vhost name to connect to. Default '/'.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-postgres"/>
<h3><a id="user-content-postgres" class="anchor" href="#postgres" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>postgres</h3>
<p>Check that a PostgreSQL db can be authenticated against (postgresql also works).</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>The port.</dd>
<dt>username</dt>
<dd>The username to authenticate with.</dd>
<dt>password</dt>
<dd>The password to authenticate with.</dd>
<dt>database</dt>
<dd>The database to connect to.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-redis"/>
<h3><a id="user-content-redis" class="anchor" href="#redis" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>redis</h3>
<p>Check that a redis server is present, optionally checking authentication.</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>The port.</dd>
<dt>password</dt>
<dd>Optional password to authenticatie with.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-memcache"/>
<h3><a id="user-content-memcache" class="anchor" href="#memcache" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>memcache</h3>
<p>Check that a memcached server is present (memcached also works).</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>The port.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-mongodb"/>
<h3><a id="user-content-mongodb" class="anchor" href="#mongodb" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>mongodb</h3>
<p>Check that a MongoDB server is present (mongo also works).</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>Optional port. Default: 27017.</dd>
<dt>username</dt>
<dd>Optional username to authenticate with.</dd>
<dt>password</dt>
<dd>Optional password to authenticate with.</dd>
<dt>database</dt>
<dd>Optional database name to connect to, if not set the <code>test</code> database will be used,
if this database does not exist (or is not available to the user) you will need to
provide a database name.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-smtp"/>
<h3><a id="user-content-smtp" class="anchor" href="#smtp" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>smtp</h3>
<p>Check that we can reach, authenticate with and send an email using an SMTP server.</p>
<p><strong>Note 1</strong>: if this check succeeds an email is actually sent to the email
defined in <code>to_address</code>, be careful how this is check is configured so it doesn't
unintentionally spam anyone.</p>
<p><strong>Note 2</strong>: only EHLO/HELO over a TLS connection is supported with the <code>use_tls</code>
flag, this check cannot currently create new TLS connection using the
<a href="https://tools.ietf.org/html/rfc3207">STARTTLS Extension</a>.</p>
<dl>
<dt>host</dt>
<dd>The host.</dd>
<dt>port</dt>
<dd>The port, normally 465 for TLS and 25 for plaintext.</dd>
<dt>username</dt>
<dd>Username to authenticate with.</dd>
<dt>password</dt>
<dd>Password to authenticate with.</dd>
<dt>from_address:</dt>
<dd>Email address to send from.</dd>
<dt>to_address:</dt>
<dd>Email address to send to.</dd>
<dt>message:</dt>
<dd>Optional email body.</dd>
<dt>subject:</dt>
<dd>Optional email subject.</dd>
<dt>helo_fallback:</dt>
<dd>Optional flag that defines whether to fall back to <code>HELO</code> if the <code>EHLO</code>
extended command set fails.</dd>
<dt>use_tls:</dt>
<dd>Optional flag to enable TLS security on connection. Default: true.</dd>
<dt>timeout</dt>
<dd>Optional connection timeout in seconds. Default: 10 (or value from <code>--connect-timeout</code>).</dd>
</dl>
<a name="user-content-tags"/>
<h2><a id="user-content-tags" class="anchor" href="#tags" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Tags</h2>
<p>Every check type also supports a <code>tags</code> field, which is a list of tags that
can be used with the <code>--include-tags</code> and <code>--exclude-tags</code> arguments to conn-check.</p>
<p>Example YAML:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-s">- <span class="pl-ent">type:</span> <span class="pl-s">http</span></span>
  <span class="pl-s"><span class="pl-ent">url:</span> <span class="pl-s">http://google.com/</span></span>
  <span class="pl-s"><span class="pl-ent">tags:</span></span>
    <span class="pl-s">- <span class="pl-s">external</span></span></pre></div>
<p>To run just "external" checks:</p>
<pre>conn-check --include-tags=external ...
</pre>
<p>To run all the checks <em>except</em> external:</p>
<pre>conn-check --exclude-tags=external
</pre>
<a name="user-content-buffered-ordered-output"/>
<h2><a id="user-content-bufferedordered-output" class="anchor" href="#bufferedordered-output" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Buffered/Ordered output</h2>
<p>conn-check normally executes with output to <code>STDOUT</code> buffered so that the output can be ordered,
with failed checks being printed first, grouping by destination etc.</p>
<p>If you'd rather see results as they available you can use the <code>-U</code>/<code>--unbuffered-output</code> option
to disable buffering.</p>
<a name="user-content-generating-firewall-rules"/>
<h2><a id="user-content-generating-firewall-rules" class="anchor" href="#generating-firewall-rules" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Generating firewall rules</h2>
<p>conn-check includes the <code>conn-check-export-fw</code> utility which takes the same arguments as
<code>conn-check</code> but runs using <code>--dry-run</code> mode and outputs a set of egress firewall
rules in an easy to parse YAML format, for example:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-c"># Generated from the conn-check demo.yaml file</span>
<span class="pl-s"><span class="pl-ent">egress:</span></span>
<span class="pl-s">- <span class="pl-ent">from_host:</span> <span class="pl-s">mydevmachine</span></span>
  <span class="pl-s"><span class="pl-ent">ports:</span> <span class="pl-s">[8080]</span></span>
  <span class="pl-s"><span class="pl-ent">protocol:</span> <span class="pl-s">udp</span></span>
  <span class="pl-s"><span class="pl-ent">to_host:</span> <span class="pl-s">localhost</span></span>
<span class="pl-s">- <span class="pl-ent">from_host:</span> <span class="pl-s">mydevmachine</span></span>
  <span class="pl-s"><span class="pl-ent">ports:</span> <span class="pl-s">[80, 443]</span></span>
  <span class="pl-s"><span class="pl-ent">protocol:</span> <span class="pl-s">tcp</span></span>
  <span class="pl-s"><span class="pl-ent">to_host:</span> <span class="pl-s">login.ubuntu.com</span></span>
<span class="pl-s">- <span class="pl-ent">from_host:</span> <span class="pl-s">mydevmachine</span></span>
  <span class="pl-s"><span class="pl-ent">ports:</span> <span class="pl-s">[6379, 11211]</span></span>
  <span class="pl-s"><span class="pl-ent">protocol:</span> <span class="pl-s">tcp</span></span>
  <span class="pl-s"><span class="pl-ent">to_host:</span> <span class="pl-s">127.0.0.1</span></span></pre></div>
<p>You can then use this output to generate your environments firewall rules (e.g. with
EC2 security groups, OpenStack Neutron, iptables etc.).</p>
<p><code>conn-check-convert-fw</code> is a utility that does just this, it accepts multiple firewall
rule YAML files, merges/de-dupes them, and outputs commands for AWS, Openstack Neutron,
OpenStack Nova (client), iptables, and ufw (mostly for testing purposes).</p>
<p>It is designed for this workflow:</p>
<blockquote>
<ul>
<li>On each host you run conn-check from, you run <code>conn-check-export-fw</code> to generate
a YAML file containing egress firewall rules.</li>
<li>Each of these files is transfered to a host with the correct DNS entries for the
egress hosts.</li>
<li>On this host <code>conn-check-convert-fw</code> is run to generate a set of commands
for your firewall.</li>
<li>These commands are audited by a human / possibly merged with other rules, such as
adding ingress rules, and then run to update your environment's firewall.</li>
</ul>
</blockquote>
<a name="user-content-building-wheels"/>
<h2><a id="user-content-building-wheels" class="anchor" href="#building-wheels" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Building wheels</h2>
<p>To allow for easier/more portable distribution of this tool you can build
conn-check and all its dependencies as <a href="http://legacy.python.org/dev/peps/pep-0427/">Python wheels</a>:</p>
<pre>make clean-wheels
make build-wheels
make build-wheels-extra EXTRA=amqp
make build-wheels-extra EXTRA=redis
</pre>
<p>The build-wheels make target will build conn-check and its base
dependencies, but to include the optional extra dependencies for other
checks such as amqp, redis or postgres you need to use the
build-wheels-extra target with the EXTRA env value.</p>
<p>By default all the wheels will be placed in ./wheels.</p>
<a name="user-content-automatically-generating-conn-check-yaml-configurations"/>
<h2><a id="user-content-automatically-generating-conn-check-yaml-configurations" class="anchor" href="#automatically-generating-conn-check-yaml-configurations" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Automatically generating conn-check YAML configurations</h2>
<p>The <a href="https://pypi.python.org/pypi/conn-check-configs">conn-check-configs</a> package contains utilities/libraries
for generating checks from existing application configurations and environments, e.g. from Django settings modules
and Juju environments.</p>

</article>
  </div></body></html>