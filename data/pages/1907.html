<html><body><div><table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tr>
        <td id="L1" class="blob-num js-line-number" data-line-number="1"/>
        <td id="LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c">##python QuantileRandomForestRegressor</span></td>
      </tr>
      <tr>
        <td id="L2" class="blob-num js-line-number" data-line-number="2"/>
        <td id="LC2" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L3" class="blob-num js-line-number" data-line-number="3"/>
        <td id="LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">from</span> sklearn.ensemble <span class="pl-k">import</span> RandomForestRegressor</td>
      </tr>
      <tr>
        <td id="L4" class="blob-num js-line-number" data-line-number="4"/>
        <td id="LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-k">import</span> numpy <span class="pl-k">as</span> np</td>
      </tr>
      <tr>
        <td id="L5" class="blob-num js-line-number" data-line-number="5"/>
        <td id="LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">import</span> pandas <span class="pl-k">as</span> pd</td>
      </tr>
      <tr>
        <td id="L6" class="blob-num js-line-number" data-line-number="6"/>
        <td id="LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L7" class="blob-num js-line-number" data-line-number="7"/>
        <td id="LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">class</span> <span class="pl-en">QuantileRandomForestRegressor</span>(<span class="pl-e">RandomForestRegressor</span>):</td>
      </tr>
      <tr>
        <td id="L8" class="blob-num js-line-number" data-line-number="8"/>
        <td id="LC8" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">n_estimators</span><span class="pl-k">=</span><span class="pl-c1">10</span>, <span class="pl-smi">criterion</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>mse<span class="pl-pds">'</span></span>, <span class="pl-smi">max_depth</span><span class="pl-k">=</span><span class="pl-c1">None</span>, <span class="pl-smi">min_samples_split</span><span class="pl-k">=</span><span class="pl-c1">2</span>, <span class="pl-smi">min_samples_leaf</span><span class="pl-k">=</span><span class="pl-c1">1</span>, <span class="pl-smi">max_features</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>auto<span class="pl-pds">'</span></span>, <span class="pl-smi">max_leaf_nodes</span><span class="pl-k">=</span><span class="pl-c1">None</span>, <span class="pl-smi">bootstrap</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-smi">oob_score</span><span class="pl-k">=</span><span class="pl-c1">False</span>, <span class="pl-smi">n_jobs</span><span class="pl-k">=</span><span class="pl-c1">1</span>, <span class="pl-smi">random_state</span><span class="pl-k">=</span><span class="pl-c1">None</span>, <span class="pl-smi">verbose</span><span class="pl-k">=</span><span class="pl-c1">0</span>, <span class="pl-smi">min_density</span><span class="pl-k">=</span><span class="pl-c1">None</span>, <span class="pl-smi">compute_importances</span><span class="pl-k">=</span><span class="pl-c1">None</span>):</td>
      </tr>
      <tr>
        <td id="L9" class="blob-num js-line-number" data-line-number="9"/>
        <td id="LC9" class="blob-code blob-code-inner js-file-line">		RandomForestRegressor.<span class="pl-c1">__init__</span>(<span class="pl-v">self</span>, <span class="pl-v">n_estimators</span><span class="pl-k">=</span>n_estimators, <span class="pl-v">criterion</span><span class="pl-k">=</span>criterion, <span class="pl-v">max_depth</span><span class="pl-k">=</span>max_depth, <span class="pl-v">min_samples_split</span><span class="pl-k">=</span>min_samples_split, <span class="pl-v">min_samples_leaf</span><span class="pl-k">=</span>min_samples_leaf, <span class="pl-v">max_features</span><span class="pl-k">=</span>max_features, <span class="pl-v">max_leaf_nodes</span><span class="pl-k">=</span> max_leaf_nodes, <span class="pl-v">bootstrap</span><span class="pl-k">=</span> bootstrap, <span class="pl-v">compute_importances</span><span class="pl-k">=</span>compute_importances, <span class="pl-v">oob_score</span><span class="pl-k">=</span>oob_score, <span class="pl-v">n_jobs</span><span class="pl-k">=</span>n_jobs, <span class="pl-v">random_state</span><span class="pl-k">=</span>random_state, <span class="pl-v">verbose</span><span class="pl-k">=</span>verbose)</td>
      </tr>
      <tr>
        <td id="L10" class="blob-num js-line-number" data-line-number="10"/>
        <td id="LC10" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L11" class="blob-num js-line-number" data-line-number="11"/>
        <td id="LC11" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">def</span> <span class="pl-en">fit</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>,<span class="pl-smi">X</span>, <span class="pl-smi">y</span>):</td>
      </tr>
      <tr>
        <td id="L12" class="blob-num js-line-number" data-line-number="12"/>
        <td id="LC12" class="blob-code blob-code-inner js-file-line">		<span class="pl-v">self</span>.target_columns <span class="pl-k">=</span> np.array(y.columns)</td>
      </tr>
      <tr>
        <td id="L13" class="blob-num js-line-number" data-line-number="13"/>
        <td id="LC13" class="blob-code blob-code-inner js-file-line">		num_targets <span class="pl-k">=</span> <span class="pl-c1">len</span>(y.iloc[<span class="pl-c1">0</span>])</td>
      </tr>
      <tr>
        <td id="L14" class="blob-num js-line-number" data-line-number="14"/>
        <td id="LC14" class="blob-code blob-code-inner js-file-line">		RandomForestRegressor.fit(<span class="pl-v">self</span>,<span class="pl-c1">X</span>,y)</td>
      </tr>
      <tr>
        <td id="L15" class="blob-num js-line-number" data-line-number="15"/>
        <td id="LC15" class="blob-code blob-code-inner js-file-line">		<span class="pl-v">self</span>.tree_leaf_dicts <span class="pl-k">=</span> []</td>
      </tr>
      <tr>
        <td id="L16" class="blob-num js-line-number" data-line-number="16"/>
        <td id="LC16" class="blob-code blob-code-inner js-file-line">		leaf_results <span class="pl-k">=</span> pd.DataFrame(<span class="pl-v">self</span>.apply( <span class="pl-c1">X</span>))</td>
      </tr>
      <tr>
        <td id="L17" class="blob-num js-line-number" data-line-number="17"/>
        <td id="LC17" class="blob-code blob-code-inner js-file-line">		<span class="pl-c">#leaf_results['ind'] = 1</span></td>
      </tr>
      <tr>
        <td id="L18" class="blob-num js-line-number" data-line-number="18"/>
        <td id="LC18" class="blob-code blob-code-inner js-file-line">		<span class="pl-v">self</span>.tree_weights <span class="pl-k">=</span> []</td>
      </tr>
      <tr>
        <td id="L19" class="blob-num js-line-number" data-line-number="19"/>
        <td id="LC19" class="blob-code blob-code-inner js-file-line">		<span class="pl-c">#self.leaf_values = [0]*len(leaf_results.columns)</span></td>
      </tr>
      <tr>
        <td id="L20" class="blob-num js-line-number" data-line-number="20"/>
        <td id="LC20" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">for</span> t <span class="pl-k">in</span> leaf_results:</td>
      </tr>
      <tr>
        <td id="L21" class="blob-num js-line-number" data-line-number="21"/>
        <td id="LC21" class="blob-code blob-code-inner js-file-line">			tree <span class="pl-k">=</span> leaf_results[t]</td>
      </tr>
      <tr>
        <td id="L22" class="blob-num js-line-number" data-line-number="22"/>
        <td id="LC22" class="blob-code blob-code-inner js-file-line">			<span class="pl-v">self</span>.tree_weights.append({})</td>
      </tr>
      <tr>
        <td id="L23" class="blob-num js-line-number" data-line-number="23"/>
        <td id="LC23" class="blob-code blob-code-inner js-file-line">			<span class="pl-v">self</span>.tree_leaf_dicts.append({})</td>
      </tr>
      <tr>
        <td id="L24" class="blob-num js-line-number" data-line-number="24"/>
        <td id="LC24" class="blob-code blob-code-inner js-file-line">			leaf_dict <span class="pl-k">=</span> <span class="pl-v">self</span>.tree_leaf_dicts[t]</td>
      </tr>
      <tr>
        <td id="L25" class="blob-num js-line-number" data-line-number="25"/>
        <td id="LC25" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">len</span>(tree)):</td>
      </tr>
      <tr>
        <td id="L26" class="blob-num js-line-number" data-line-number="26"/>
        <td id="LC26" class="blob-code blob-code-inner js-file-line">				obs <span class="pl-k">=</span> tree[i]</td>
      </tr>
      <tr>
        <td id="L27" class="blob-num js-line-number" data-line-number="27"/>
        <td id="LC27" class="blob-code blob-code-inner js-file-line">					<span class="pl-c">#iterate through rows of observations on single tree</span></td>
      </tr>
      <tr>
        <td id="L28" class="blob-num js-line-number" data-line-number="28"/>
        <td id="LC28" class="blob-code blob-code-inner js-file-line">					<span class="pl-c">#compare observed leaf to dict -if exists append values else add key to dict</span></td>
      </tr>
      <tr>
        <td id="L29" class="blob-num js-line-number" data-line-number="29"/>
        <td id="LC29" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span>(obs <span class="pl-k">in</span> leaf_dict):</td>
      </tr>
      <tr>
        <td id="L30" class="blob-num js-line-number" data-line-number="30"/>
        <td id="LC30" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">for</span> col <span class="pl-k">in</span> <span class="pl-v">self</span>.target_columns:</td>
      </tr>
      <tr>
        <td id="L31" class="blob-num js-line-number" data-line-number="31"/>
        <td id="LC31" class="blob-code blob-code-inner js-file-line">						leaf_values <span class="pl-k">=</span>leaf_dict[obs][col]</td>
      </tr>
      <tr>
        <td id="L32" class="blob-num js-line-number" data-line-number="32"/>
        <td id="LC32" class="blob-code blob-code-inner js-file-line">						<span class="pl-c">#leaf # is assigned values</span></td>
      </tr>
      <tr>
        <td id="L33" class="blob-num js-line-number" data-line-number="33"/>
        <td id="LC33" class="blob-code blob-code-inner js-file-line">						leaf_dict[obs][col] <span class="pl-k">=</span> np.append(leaf_values,y.iloc[i][col])</td>
      </tr>
      <tr>
        <td id="L34" class="blob-num js-line-number" data-line-number="34"/>
        <td id="LC34" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span>:</td>
      </tr>
      <tr>
        <td id="L35" class="blob-num js-line-number" data-line-number="35"/>
        <td id="LC35" class="blob-code blob-code-inner js-file-line">					leaf_dict[obs] <span class="pl-k">=</span> {}</td>
      </tr>
      <tr>
        <td id="L36" class="blob-num js-line-number" data-line-number="36"/>
        <td id="LC36" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">for</span> col <span class="pl-k">in</span> <span class="pl-v">self</span>.target_columns:</td>
      </tr>
      <tr>
        <td id="L37" class="blob-num js-line-number" data-line-number="37"/>
        <td id="LC37" class="blob-code blob-code-inner js-file-line">						<span class="pl-c">#leaf # is assigned values</span></td>
      </tr>
      <tr>
        <td id="L38" class="blob-num js-line-number" data-line-number="38"/>
        <td id="LC38" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">if</span>(np.isfinite(y.iloc[i][col])):</td>
      </tr>
      <tr>
        <td id="L39" class="blob-num js-line-number" data-line-number="39"/>
        <td id="LC39" class="blob-code blob-code-inner js-file-line">							leaf_dict[obs][col]<span class="pl-k">=</span>np.array(y.iloc[i][col])</td>
      </tr>
      <tr>
        <td id="L40" class="blob-num js-line-number" data-line-number="40"/>
        <td id="LC40" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L41" class="blob-num js-line-number" data-line-number="41"/>
        <td id="LC41" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">for</span> tree <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">len</span>(<span class="pl-v">self</span>.tree_leaf_dicts)):</td>
      </tr>
      <tr>
        <td id="L42" class="blob-num js-line-number" data-line-number="42"/>
        <td id="LC42" class="blob-code blob-code-inner js-file-line">			<span class="pl-v">self</span>.tree_weights.append({})</td>
      </tr>
      <tr>
        <td id="L43" class="blob-num js-line-number" data-line-number="43"/>
        <td id="LC43" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">for</span> leaf <span class="pl-k">in</span> <span class="pl-v">self</span>.tree_leaf_dicts[tree]:</td>
      </tr>
      <tr>
        <td id="L44" class="blob-num js-line-number" data-line-number="44"/>
        <td id="LC44" class="blob-code blob-code-inner js-file-line">				<span class="pl-v">self</span>.tree_weights[tree][leaf] <span class="pl-k">=</span> {}</td>
      </tr>
      <tr>
        <td id="L45" class="blob-num js-line-number" data-line-number="45"/>
        <td id="LC45" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">for</span> col <span class="pl-k">in</span> <span class="pl-v">self</span>.target_columns:</td>
      </tr>
      <tr>
        <td id="L46" class="blob-num js-line-number" data-line-number="46"/>
        <td id="LC46" class="blob-code blob-code-inner js-file-line">					<span class="pl-v">self</span>.tree_weights[tree][leaf][col] <span class="pl-k">=</span> (np.count_nonzero(<span class="pl-k">~</span>np.isnan(<span class="pl-v">self</span>.tree_leaf_dicts[tree][leaf][col])))</td>
      </tr>
      <tr>
        <td id="L47" class="blob-num js-line-number" data-line-number="47"/>
        <td id="LC47" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L48" class="blob-num js-line-number" data-line-number="48"/>
        <td id="LC48" class="blob-code blob-code-inner js-file-line">						</td>
      </tr>
      <tr>
        <td id="L49" class="blob-num js-line-number" data-line-number="49"/>
        <td id="LC49" class="blob-code blob-code-inner js-file-line">		</td>
      </tr>
      <tr>
        <td id="L50" class="blob-num js-line-number" data-line-number="50"/>
        <td id="LC50" class="blob-code blob-code-inner js-file-line">				</td>
      </tr>
      <tr>
        <td id="L51" class="blob-num js-line-number" data-line-number="51"/>
        <td id="LC51" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L52" class="blob-num js-line-number" data-line-number="52"/>
        <td id="LC52" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L53" class="blob-num js-line-number" data-line-number="53"/>
        <td id="LC53" class="blob-code blob-code-inner js-file-line">		</td>
      </tr>
      <tr>
        <td id="L54" class="blob-num js-line-number" data-line-number="54"/>
        <td id="LC54" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L55" class="blob-num js-line-number" data-line-number="55"/>
        <td id="LC55" class="blob-code blob-code-inner js-file-line">		</td>
      </tr>
      <tr>
        <td id="L56" class="blob-num js-line-number" data-line-number="56"/>
        <td id="LC56" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L57" class="blob-num js-line-number" data-line-number="57"/>
        <td id="LC57" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">def</span> <span class="pl-en">predict</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>,<span class="pl-smi">X</span>, <span class="pl-smi">quantiles</span> <span class="pl-k">=</span> [<span class="pl-c1">.80</span>,<span class="pl-c1">.50</span>,<span class="pl-c1">.20</span>], <span class="pl-smi">withMean</span> <span class="pl-k">=</span> <span class="pl-c1">True</span>):</td>
      </tr>
      <tr>
        <td id="L58" class="blob-num js-line-number" data-line-number="58"/>
        <td id="LC58" class="blob-code blob-code-inner js-file-line">		</td>
      </tr>
      <tr>
        <td id="L59" class="blob-num js-line-number" data-line-number="59"/>
        <td id="LC59" class="blob-code blob-code-inner js-file-line">		leaf_results <span class="pl-k">=</span> pd.DataFrame(<span class="pl-v">self</span>.apply( <span class="pl-c1">X</span>))</td>
      </tr>
      <tr>
        <td id="L60" class="blob-num js-line-number" data-line-number="60"/>
        <td id="LC60" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L61" class="blob-num js-line-number" data-line-number="61"/>
        <td id="LC61" class="blob-code blob-code-inner js-file-line">		<span class="pl-v">self</span>.distributions <span class="pl-k">=</span> []</td>
      </tr>
      <tr>
        <td id="L62" class="blob-num js-line-number" data-line-number="62"/>
        <td id="LC62" class="blob-code blob-code-inner js-file-line">		<span class="pl-c">##iterate through samples</span></td>
      </tr>
      <tr>
        <td id="L63" class="blob-num js-line-number" data-line-number="63"/>
        <td id="LC63" class="blob-code blob-code-inner js-file-line">		<span class="pl-c">#add set of distributions for each target for given sample </span></td>
      </tr>
      <tr>
        <td id="L64" class="blob-num js-line-number" data-line-number="64"/>
        <td id="LC64" class="blob-code blob-code-inner js-file-line">		out_q <span class="pl-k">=</span> np.ndarray((<span class="pl-c1">len</span>(leaf_results),<span class="pl-c1">len</span>(<span class="pl-v">self</span>.target_columns),(<span class="pl-c1">len</span>(quantiles)<span class="pl-k">+</span>withMean)), <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-c1">float</span>)</td>
      </tr>
      <tr>
        <td id="L65" class="blob-num js-line-number" data-line-number="65"/>
        <td id="LC65" class="blob-code blob-code-inner js-file-line">		mean_predictions <span class="pl-k">=</span> <span class="pl-c1">None</span></td>
      </tr>
      <tr>
        <td id="L66" class="blob-num js-line-number" data-line-number="66"/>
        <td id="LC66" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> withMean:</td>
      </tr>
      <tr>
        <td id="L67" class="blob-num js-line-number" data-line-number="67"/>
        <td id="LC67" class="blob-code blob-code-inner js-file-line">			mean_predictions <span class="pl-k">=</span> RandomForestRegressor.predict(<span class="pl-v">self</span>,<span class="pl-c1">X</span>)</td>
      </tr>
      <tr>
        <td id="L68" class="blob-num js-line-number" data-line-number="68"/>
        <td id="LC68" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L69" class="blob-num js-line-number" data-line-number="69"/>
        <td id="LC69" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">for</span> n <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">len</span>(leaf_results)):</td>
      </tr>
      <tr>
        <td id="L70" class="blob-num js-line-number" data-line-number="70"/>
        <td id="LC70" class="blob-code blob-code-inner js-file-line">			<span class="pl-v">self</span>.distributions.append({})</td>
      </tr>
      <tr>
        <td id="L71" class="blob-num js-line-number" data-line-number="71"/>
        <td id="LC71" class="blob-code blob-code-inner js-file-line">			<span class="pl-c">#iterate through columns in sample (trees) j=sample tree</span></td>
      </tr>
      <tr>
        <td id="L72" class="blob-num js-line-number" data-line-number="72"/>
        <td id="LC72" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">for</span> col <span class="pl-k">in</span> <span class="pl-v">self</span>.target_columns:</td>
      </tr>
      <tr>
        <td id="L73" class="blob-num js-line-number" data-line-number="73"/>
        <td id="LC73" class="blob-code blob-code-inner js-file-line">				<span class="pl-v">self</span>.distributions[n][col]<span class="pl-k">=</span>pd.DataFrame(<span class="pl-v">columns</span><span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">'</span>weight<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>value<span class="pl-pds">'</span></span>])</td>
      </tr>
      <tr>
        <td id="L74" class="blob-num js-line-number" data-line-number="74"/>
        <td id="LC74" class="blob-code blob-code-inner js-file-line">				<span class="pl-c">#leaf_dict[col] = y.iloc[n][col]</span></td>
      </tr>
      <tr>
        <td id="L75" class="blob-num js-line-number" data-line-number="75"/>
        <td id="LC75" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">for</span> j <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-v">self</span>.n_estimators):</td>
      </tr>
      <tr>
        <td id="L76" class="blob-num js-line-number" data-line-number="76"/>
        <td id="LC76" class="blob-code blob-code-inner js-file-line">					temp_df <span class="pl-k">=</span> pd.DataFrame(<span class="pl-v">columns</span><span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">'</span>weight<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>value<span class="pl-pds">'</span></span>])</td>
      </tr>
      <tr>
        <td id="L77" class="blob-num js-line-number" data-line-number="77"/>
        <td id="LC77" class="blob-code blob-code-inner js-file-line">					<span class="pl-c">#print str(j)+" "+str(n)+" "+str(leaf_results.iloc[n][j])+" "+str(self.tree_leaf_dicts[j][leaf_results.iloc[n][j]][col])</span></td>
      </tr>
      <tr>
        <td id="L78" class="blob-num js-line-number" data-line-number="78"/>
        <td id="LC78" class="blob-code blob-code-inner js-file-line">				</td>
      </tr>
      <tr>
        <td id="L79" class="blob-num js-line-number" data-line-number="79"/>
        <td id="LC79" class="blob-code blob-code-inner js-file-line">					temp_df[<span class="pl-s"><span class="pl-pds">'</span>value<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> np.atleast_1d(<span class="pl-v">self</span>.tree_leaf_dicts[j][leaf_results.iloc[n][j]][col])</td>
      </tr>
      <tr>
        <td id="L80" class="blob-num js-line-number" data-line-number="80"/>
        <td id="LC80" class="blob-code blob-code-inner js-file-line">					</td>
      </tr>
      <tr>
        <td id="L81" class="blob-num js-line-number" data-line-number="81"/>
        <td id="LC81" class="blob-code blob-code-inner js-file-line">					temp_df[<span class="pl-s"><span class="pl-pds">'</span>weight<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-c1">1.0</span><span class="pl-k">/</span>(<span class="pl-v">self</span>.tree_weights[j][leaf_results.iloc[n][j]][col]<span class="pl-k">*</span>(<span class="pl-v">self</span>.n_estimators)<span class="pl-k">+</span><span class="pl-c1">1</span>)</td>
      </tr>
      <tr>
        <td id="L82" class="blob-num js-line-number" data-line-number="82"/>
        <td id="LC82" class="blob-code blob-code-inner js-file-line">					<span class="pl-v">self</span>.distributions[n][col]<span class="pl-k">=</span> <span class="pl-v">self</span>.distributions[n][col].append(temp_df)</td>
      </tr>
      <tr>
        <td id="L83" class="blob-num js-line-number" data-line-number="83"/>
        <td id="LC83" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L84" class="blob-num js-line-number" data-line-number="84"/>
        <td id="LC84" class="blob-code blob-code-inner js-file-line">				</td>
      </tr>
      <tr>
        <td id="L85" class="blob-num js-line-number" data-line-number="85"/>
        <td id="LC85" class="blob-code blob-code-inner js-file-line">				<span class="pl-v">self</span>.distributions[n][col].sort(<span class="pl-v">columns</span><span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">'</span>value<span class="pl-pds">'</span></span>],<span class="pl-v">inplace</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-v">ascending</span><span class="pl-k">=</span>[<span class="pl-c1">1</span>])</td>
      </tr>
      <tr>
        <td id="L86" class="blob-num js-line-number" data-line-number="86"/>
        <td id="LC86" class="blob-code blob-code-inner js-file-line">				<span class="pl-v">self</span>.distributions[n][col][<span class="pl-s"><span class="pl-pds">'</span>cumsum<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> np.cumsum(<span class="pl-v">self</span>.distributions[n][col].weight)</td>
      </tr>
      <tr>
        <td id="L87" class="blob-num js-line-number" data-line-number="87"/>
        <td id="LC87" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L88" class="blob-num js-line-number" data-line-number="88"/>
        <td id="LC88" class="blob-code blob-code-inner js-file-line">			</td>
      </tr>
      <tr>
        <td id="L89" class="blob-num js-line-number" data-line-number="89"/>
        <td id="LC89" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">for</span> target <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">len</span>(<span class="pl-v">self</span>.target_columns)):</td>
      </tr>
      <tr>
        <td id="L90" class="blob-num js-line-number" data-line-number="90"/>
        <td id="LC90" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">for</span> p <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">len</span>(quantiles)):</td>
      </tr>
      <tr>
        <td id="L91" class="blob-num js-line-number" data-line-number="91"/>
        <td id="LC91" class="blob-code blob-code-inner js-file-line">					<span class="pl-c">#print str(n) +" " + str(target) + " " + str(p)</span></td>
      </tr>
      <tr>
        <td id="L92" class="blob-num js-line-number" data-line-number="92"/>
        <td id="LC92" class="blob-code blob-code-inner js-file-line">					out_q[n,target,p] <span class="pl-k">=</span> <span class="pl-v">self</span>.distributions[n][<span class="pl-v">self</span>.target_columns[target]][<span class="pl-v">self</span>.distributions[n][<span class="pl-v">self</span>.target_columns[target]][<span class="pl-s"><span class="pl-pds">'</span>cumsum<span class="pl-pds">'</span></span>] <span class="pl-k">&lt;=</span> quantiles[p]].value.max()</td>
      </tr>
      <tr>
        <td id="L93" class="blob-num js-line-number" data-line-number="93"/>
        <td id="LC93" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L94" class="blob-num js-line-number" data-line-number="94"/>
        <td id="LC94" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> withMean:</td>
      </tr>
      <tr>
        <td id="L95" class="blob-num js-line-number" data-line-number="95"/>
        <td id="LC95" class="blob-code blob-code-inner js-file-line">					out_q[n,target,p<span class="pl-k">+</span><span class="pl-c1">1</span>] <span class="pl-k">=</span> mean_predictions[n,target]</td>
      </tr>
      <tr>
        <td id="L96" class="blob-num js-line-number" data-line-number="96"/>
        <td id="LC96" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L97" class="blob-num js-line-number" data-line-number="97"/>
        <td id="LC97" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> out_q</td>
      </tr>
      <tr>
        <td id="L98" class="blob-num js-line-number" data-line-number="98"/>
        <td id="LC98" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L99" class="blob-num js-line-number" data-line-number="99"/>
        <td id="LC99" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L100" class="blob-num js-line-number" data-line-number="100"/>
        <td id="LC100" class="blob-code blob-code-inner js-file-line">		</td>
      </tr>
      <tr>
        <td id="L101" class="blob-num js-line-number" data-line-number="101"/>
        <td id="LC101" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L102" class="blob-num js-line-number" data-line-number="102"/>
        <td id="LC102" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L103" class="blob-num js-line-number" data-line-number="103"/>
        <td id="LC103" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L104" class="blob-num js-line-number" data-line-number="104"/>
        <td id="LC104" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L105" class="blob-num js-line-number" data-line-number="105"/>
        <td id="LC105" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="L106" class="blob-num js-line-number" data-line-number="106"/>
        <td id="LC106" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
</table>

  </div></body></html>