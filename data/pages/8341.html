<html><body><div><div class="post-text" itemprop="text">

<p><a href="http://i.stack.imgur.com/h9hnj.jpg"><img src="http://i.stack.imgur.com/h9hnj.jpg" alt="enter image description here"/></a></p>

<p>The excel is like the left picture with 3 columns.</p>

<p>When inserting into database, I need to add 2 columns more manually like right picture showed and insert altogether 5 columns in database finally. These 2 additional columns information is fetched from other databases.</p>

<p>And another function is if there is already existing file, the newly uploaded file will override the existing one.[snippets in views.py below]</p>

<p>I have already tried two 3 party tools but not works, so maybe it is still better just to use the one embedded in django.</p>

<p>Version: Python 2.7. Excel 2013. Django1.8.</p>

<p>Any help is highly appreciated. Hope could provide the detail snippet for how to append these 2 columns :</p>

<pre><code>uploader = request.session['uploader']
Date=request.session['date']
</code></pre>

<p><strong>forms.py</strong></p>

<pre><code>from django.core.files.storage import FileSystemStorage
from financialdata.storage import OverwriteStorage

class XXXXDataForm(forms.Form):
    XXXXfile=forms.FileField(label='Select a file')
</code></pre>

<p><strong>views.py</strong></p>

<pre><code>from django.core.files.storage import FileSystemStorage

def import_data(request):
    if request.method == "POST":
        form = XXXXForm(request.POST,request.FILES)
        if form.is_valid():
            newdoc= XXXX(docfile=request.FILES['docfile'])
            newdoc.save()
            return HttpResponseRedirect(reverse('homepage'))
        else:
            return HttpResponseBadRequest()
    else:
        form = XXXXForm()
    return render_to_response(
        'dataentry.html',
        {
            'form': form,
            'title': 'Import excel data into database example',
            'header': 'Please upload XXXX.xlsx:',
            'message': 'File Saved!'
        },
        context_instance=RequestContext(request))

&lt;!--How can I embed the following part to previous part?--&gt;

class OverwriteStorage(FileSystemStorage):
    def _save(self, name, content):
        if self.exists(name):
            self.delete(name)
        return super(OverwriteStorage, self)._save(name, content)

    def get_available_name(self, name):
        return name
</code></pre>
    </div>
    </div></body></html>