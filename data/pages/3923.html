<html><body><div><div class="section" id="s-backwards-incompatible-changes-in-1-8">
<span id="backwards-incompatible-changes-in-1-8"/><h2>Backwards incompatible changes in 1.8<a class="headerlink" href="#backwards-incompatible-changes-in-1-8" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In addition to the changes outlined in this section, be sure to review the
<a class="reference internal" href="../../internals/deprecation/#deprecation-removed-in-1-8"><span>deprecation plan</span></a> for any features that
have been removed. If you haven’t updated your code within the
deprecation timeline for a given feature, its removal may appear as a
backwards incompatible change.</p>
</div>

<div class="section" id="s-assigning-unsaved-objects-to-relations-raises-an-error">
<span id="s-unsaved-model-instance-check-18"/><span id="assigning-unsaved-objects-to-relations-raises-an-error"/><span id="unsaved-model-instance-check-18"/><h3>Assigning unsaved objects to relations raises an error<a class="headerlink" href="#assigning-unsaved-objects-to-relations-raises-an-error" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To more easily allow in-memory usage of models, this change was reverted in
Django 1.8.4 and replaced with a check during <code class="docutils literal"><span class="pre">model.save()</span></code>. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">book</span> <span class="o">=</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Django"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">book</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"John"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">book</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">save() prohibited to prevent data loss due to unsaved related object 'author'.</span>
</pre></div>
</div>
<p class="last">A similar check on assignment to reverse one-to-one relations was removed
in Django 1.8.5.</p>
</div>
<p>Assigning unsaved objects to a <a class="reference internal" href="../../ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal"><span class="pre">ForeignKey</span></code></a>,
<a class="reference internal" href="../../ref/contrib/contenttypes/#django.contrib.contenttypes.fields.GenericForeignKey" title="django.contrib.contenttypes.fields.GenericForeignKey"><code class="xref py py-class docutils literal"><span class="pre">GenericForeignKey</span></code></a>, and
<a class="reference internal" href="../../ref/models/fields/#django.db.models.OneToOneField" title="django.db.models.OneToOneField"><code class="xref py py-class docutils literal"><span class="pre">OneToOneField</span></code></a> now raises a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.5)"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code></a>.</p>
<p>Previously, the assignment of an unsaved object would be silently ignored.
For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">book</span> <span class="o">=</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Django"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">book</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"John"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">book</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">book</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Django"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">book</span><span class="o">.</span><span class="n">author</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Now, an error will be raised to prevent data loss:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">book</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"john"</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot assign "&lt;Author: John&gt;": "Author" instance isn't saved in the database.</span>
</pre></div>
</div>
<p>If you require allowing the assignment of unsaved instances (the old behavior)
and aren’t concerned about the data loss possibility (e.g. you never save the
objects to the database), you can disable this check by using the
<code class="docutils literal"><span class="pre">ForeignKey.allow_unsaved_instance_assignment</span></code> attribute. (This attribute was
removed in 1.8.4 as it’s no longer relevant.)</p>
</div>
<div class="section" id="s-management-commands-that-only-accept-positional-arguments">
<span id="management-commands-that-only-accept-positional-arguments"/><h3>Management commands that only accept positional arguments<a class="headerlink" href="#management-commands-that-only-accept-positional-arguments" title="Permalink to this headline">¶</a></h3>
<p>If you have written a custom management command that only accepts positional
arguments and you didn’t specify the
<a class="reference internal" href="../../howto/custom-management-commands/#django.core.management.BaseCommand.args" title="django.core.management.BaseCommand.args"><code class="xref py py-attr docutils literal"><span class="pre">args</span></code></a> command variable, you might
get an error like <code class="docutils literal"><span class="pre">Error:</span> <span class="pre">unrecognized</span> <span class="pre">arguments:</span> <span class="pre">...</span></code>, as variable parsing
is now based on <a class="reference external" href="https://docs.python.org/3/library/argparse.html#module-argparse" title="(in Python v3.5)"><code class="xref py py-mod docutils literal"><span class="pre">argparse</span></code></a> which doesn’t implicitly accept positional
arguments. You can make your command backwards compatible by simply setting the
<a class="reference internal" href="../../howto/custom-management-commands/#django.core.management.BaseCommand.args" title="django.core.management.BaseCommand.args"><code class="xref py py-attr docutils literal"><span class="pre">args</span></code></a> class variable. However, if
you don’t have to keep compatibility with older Django versions, it’s better to
implement the new <a class="reference internal" href="../../howto/custom-management-commands/#django.core.management.BaseCommand.add_arguments" title="django.core.management.BaseCommand.add_arguments"><code class="xref py py-meth docutils literal"><span class="pre">add_arguments()</span></code></a>
method as described in <a class="reference internal" href="../../howto/custom-management-commands/"><em>Writing custom django-admin commands</em></a>.</p>
</div>
<div class="section" id="s-custom-test-management-command-arguments-through-test-runner">
<span id="custom-test-management-command-arguments-through-test-runner"/><h3>Custom test management command arguments through test runner<a class="headerlink" href="#custom-test-management-command-arguments-through-test-runner" title="Permalink to this headline">¶</a></h3>
<p>The method to add custom arguments to the <cite>test</cite> management command through the
test runner has changed. Previously, you could provide an <cite>option_list</cite> class
variable on the test runner to add more arguments (à la <a class="reference external" href="https://docs.python.org/3/library/optparse.html#module-optparse" title="(in Python v3.5)"><code class="xref py py-mod docutils literal"><span class="pre">optparse</span></code></a>).
Now to implement the same behavior, you have to create an
<code class="docutils literal"><span class="pre">add_arguments(cls,</span> <span class="pre">parser)</span></code> class method on the test runner and call
<code class="docutils literal"><span class="pre">parser.add_argument</span></code> to add any custom arguments, as parser is now an
<a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.ArgumentParser" title="(in Python v3.5)"><code class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></code></a> instance.</p>
</div>
<div class="section" id="s-model-check-ensures-auto-generated-column-names-are-within-limits-specified-by-database">
<span id="model-check-ensures-auto-generated-column-names-are-within-limits-specified-by-database"/><h3>Model check ensures auto-generated column names are within limits specified by database<a class="headerlink" href="#model-check-ensures-auto-generated-column-names-are-within-limits-specified-by-database" title="Permalink to this headline">¶</a></h3>
<p>A field name that’s longer than the column name length supported by a database
can create problems. For example, with MySQL you’ll get an exception trying to
create the column, and with PostgreSQL the column name is truncated by the
database (you may see a warning in the PostgreSQL logs).</p>
<p>A model check has been introduced to better alert users to this scenario before
the actual creation of database tables.</p>
<p>If you have an existing model where this check seems to be a false positive,
for example on PostgreSQL where the name was already being truncated, simply
use <a class="reference internal" href="../../ref/models/fields/#django.db.models.Field.db_column" title="django.db.models.Field.db_column"><code class="xref py py-attr docutils literal"><span class="pre">db_column</span></code></a> to specify the name that’s being
used.</p>
<p>The check also applies to the columns generated in an implicit
<code class="docutils literal"><span class="pre">ManyToManyField.through</span></code> model. If you run into an issue there, use
<a class="reference internal" href="../../ref/models/fields/#django.db.models.ManyToManyField.through" title="django.db.models.ManyToManyField.through"><code class="xref py py-attr docutils literal"><span class="pre">through</span></code></a> to create an explicit model
and then specify <a class="reference internal" href="../../ref/models/fields/#django.db.models.Field.db_column" title="django.db.models.Field.db_column"><code class="xref py py-attr docutils literal"><span class="pre">db_column</span></code></a> on its column(s)
as needed.</p>
</div>
<div class="section" id="s-query-relation-lookups-now-check-object-types">
<span id="query-relation-lookups-now-check-object-types"/><h3>Query relation lookups now check object types<a class="headerlink" href="#query-relation-lookups-now-check-object-types" title="Permalink to this headline">¶</a></h3>
<p>Querying for model lookups now checks if the object passed is of correct type
and raises a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.5)"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code></a> if not. Previously, Django didn’t care if the
object was of correct type; it just used the object’s related field attribute
(e.g. <code class="docutils literal"><span class="pre">id</span></code>) for the lookup. Now, an error is raised to prevent incorrect
lookups:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">book</span> <span class="o">=</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Django"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">book</span> <span class="o">=</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">author</span><span class="o">=</span><span class="n">book</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot query "&lt;Book: Django&gt;": Must be "Author" instance.</span>
</pre></div>
</div>
</div>

<div class="section" id="s-default-emailfield-max-length-increased-to-254">
<span id="default-emailfield-max-length-increased-to-254"/><h3>Default <code class="docutils literal"><span class="pre">EmailField.max_length</span></code> increased to 254<a class="headerlink" href="#default-emailfield-max-length-increased-to-254" title="Permalink to this headline">¶</a></h3>
<p>The old default 75 character <code class="docutils literal"><span class="pre">max_length</span></code> was not capable of storing all
possible RFC3696/5321-compliant email addresses. In order to store all
possible valid email addresses, the <code class="docutils literal"><span class="pre">max_length</span></code> has been increased to 254
characters. You will need to generate and apply database migrations for your
affected models (or add <code class="docutils literal"><span class="pre">max_length=75</span></code> if you wish to keep the length on
your current fields). A migration for
<a class="reference internal" href="../../ref/contrib/auth/#django.contrib.auth.models.User.email" title="django.contrib.auth.models.User.email"><code class="xref py py-attr docutils literal"><span class="pre">django.contrib.auth.models.User.email</span></code></a> is included.</p>
</div>
<div class="section" id="s-support-for-postgresql-versions-older-than-9-0">
<span id="support-for-postgresql-versions-older-than-9-0"/><h3>Support for PostgreSQL versions older than 9.0<a class="headerlink" href="#support-for-postgresql-versions-older-than-9-0" title="Permalink to this headline">¶</a></h3>
<p>The end of upstream support periods was reached in July 2014 for PostgreSQL 8.4.
As a consequence, Django 1.8 sets 9.0 as the minimum PostgreSQL version it
officially supports.</p>
<p>This also includes dropping support for PostGIS 1.3 and 1.4 as these versions
are not supported on versions of PostgreSQL later than 8.4.</p>
<p>Django also now requires the use of Psycopg2 version 2.4.5 or higher (or 2.5+
if you want to use <a class="reference internal" href="../../ref/contrib/postgres/#module-django.contrib.postgres" title="django.contrib.postgres: PostgreSQL-specific fields and features"><code class="xref py py-mod docutils literal"><span class="pre">django.contrib.postgres</span></code></a>).</p>
</div>
<div class="section" id="s-support-for-mysql-versions-older-than-5-5">
<span id="support-for-mysql-versions-older-than-5-5"/><h3>Support for MySQL versions older than 5.5<a class="headerlink" href="#support-for-mysql-versions-older-than-5-5" title="Permalink to this headline">¶</a></h3>
<p>The end of upstream support periods was reached in January 2012 for MySQL 5.0
and December 2013 for MySQL 5.1. As a consequence, Django 1.8 sets 5.5 as the
minimum MySQL version it officially supports.</p>
</div>
<div class="section" id="s-support-for-oracle-versions-older-than-11-1">
<span id="support-for-oracle-versions-older-than-11-1"/><h3>Support for Oracle versions older than 11.1<a class="headerlink" href="#support-for-oracle-versions-older-than-11-1" title="Permalink to this headline">¶</a></h3>
<p>The end of upstream support periods was reached in July 2010 for Oracle 9.2,
January 2012 for Oracle 10.1, and July 2013 for Oracle 10.2. As a consequence,
Django 1.8 sets 11.1 as the minimum Oracle version it officially supports.</p>
</div>
<div class="section" id="s-specific-privileges-used-instead-of-roles-for-tests-on-oracle">
<span id="specific-privileges-used-instead-of-roles-for-tests-on-oracle"/><h3>Specific privileges used instead of roles for tests on Oracle<a class="headerlink" href="#specific-privileges-used-instead-of-roles-for-tests-on-oracle" title="Permalink to this headline">¶</a></h3>
<p>Earlier versions of Django granted the CONNECT and RESOURCE roles to the test
user on Oracle. These roles have been deprecated, so Django 1.8 uses the
specific underlying privileges instead. This changes the privileges required
of the main user for running tests (unless the project is configured to avoid
creating a test user). The exact privileges required now are detailed in
<a class="reference internal" href="../../ref/databases/#oracle-notes"><span>Oracle notes</span></a>.</p>
</div>
<div class="section" id="s-abstractuser-last-login-allows-null-values">
<span id="abstractuser-last-login-allows-null-values"/><h3><code class="docutils literal"><span class="pre">AbstractUser.last_login</span></code> allows null values<a class="headerlink" href="#abstractuser-last-login-allows-null-values" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../ref/contrib/auth/#django.contrib.auth.models.User.last_login" title="django.contrib.auth.models.User.last_login"><code class="xref py py-attr docutils literal"><span class="pre">AbstractUser.last_login</span></code></a>
field now allows null values. Previously, it defaulted to the time when the user
was created which was misleading if the user never logged in. If you are using
the default user (<a class="reference internal" href="../../ref/contrib/auth/#django.contrib.auth.models.User" title="django.contrib.auth.models.User"><code class="xref py py-class docutils literal"><span class="pre">django.contrib.auth.models.User</span></code></a>), run the database
migration included in <code class="docutils literal"><span class="pre">contrib.auth</span></code>.</p>
<p>If you are using a custom user model that inherits from <code class="docutils literal"><span class="pre">AbstractUser</span></code>,
you’ll need to run <a class="reference internal" href="../../ref/django-admin/#django-admin-makemigrations"><code class="xref std std-djadmin docutils literal"><span class="pre">makemigrations</span></code></a> and generate a migration for your
app that contains that model. Also, if wish to set <code class="docutils literal"><span class="pre">last_login</span></code> to <code class="docutils literal"><span class="pre">NULL</span></code>
for users who haven’t logged in, you can run this query:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">get_user_model</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">AbstractBaseUser</span>

<span class="n">UserModel</span> <span class="o">=</span> <span class="n">get_user_model</span><span class="p">()</span>
<span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">UserModel</span><span class="p">,</span> <span class="n">AbstractBaseUser</span><span class="p">):</span>
    <span class="n">UserModel</span><span class="o">.</span><span class="n">_default_manager</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">last_login</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">F</span><span class="p">(</span><span class="s1">'date_joined'</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">last_login</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-id1">
<span id="id1"/>
<ul class="simple">
<li>Support for GEOS 3.1 and GDAL 1.6 has been dropped.</li>
<li>Support for SpatiaLite &lt; 2.4 has been dropped.</li>
<li>GIS-specific lookups have been refactored to use the
<a class="reference internal" href="../../ref/models/lookups/#django.db.models.Lookup" title="django.db.models.Lookup"><code class="xref py py-class docutils literal"><span class="pre">django.db.models.Lookup</span></code></a> API.</li>
<li>The default <code class="docutils literal"><span class="pre">str</span></code> representation of
<a class="reference internal" href="../../ref/contrib/gis/geos/#django.contrib.gis.geos.GEOSGeometry" title="django.contrib.gis.geos.GEOSGeometry"><code class="xref py py-class docutils literal"><span class="pre">GEOSGeometry</span></code></a> objects has been changed from
WKT to EWKT format (including the SRID). As this representation is used in
the serialization framework, that means that <code class="docutils literal"><span class="pre">dumpdata</span></code> output will now
contain the SRID value of geometry objects.</li>
</ul>
</div>
<div class="section" id="s-priority-of-context-processors-for-templateresponse-brought-in-line-with-render">
<span id="priority-of-context-processors-for-templateresponse-brought-in-line-with-render"/><h3>Priority of context processors for <code class="docutils literal"><span class="pre">TemplateResponse</span></code> brought in line with <code class="docutils literal"><span class="pre">render</span></code><a class="headerlink" href="#priority-of-context-processors-for-templateresponse-brought-in-line-with-render" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../ref/template-response/#django.template.response.TemplateResponse" title="django.template.response.TemplateResponse"><code class="xref py py-class docutils literal"><span class="pre">TemplateResponse</span></code></a> constructor is designed to be a
drop-in replacement for the <a class="reference internal" href="../../topics/http/shortcuts/#django.shortcuts.render" title="django.shortcuts.render"><code class="xref py py-func docutils literal"><span class="pre">render()</span></code></a> function. However,
it had a slight incompatibility, in that for <code class="docutils literal"><span class="pre">TemplateResponse</span></code>, context data
from the passed in context dictionary could be shadowed by context data returned
from context processors, whereas for <code class="docutils literal"><span class="pre">render</span></code> it was the other way
around. This was a bug, and the behavior of <code class="docutils literal"><span class="pre">render</span></code> is more appropriate,
since it allows the globally defined context processors to be overridden locally
in the view. If you were relying on the fact context data in a
<code class="docutils literal"><span class="pre">TemplateResponse</span></code> could be overridden using a context processor, you will
need to change your code.</p>
</div>
<div class="section" id="s-overriding-setupclass-teardownclass-in-test-cases">
<span id="overriding-setupclass-teardownclass-in-test-cases"/><h3>Overriding <code class="docutils literal"><span class="pre">setUpClass</span></code> / <code class="docutils literal"><span class="pre">tearDownClass</span></code> in test cases<a class="headerlink" href="#overriding-setupclass-teardownclass-in-test-cases" title="Permalink to this headline">¶</a></h3>
<p>The decorators <a class="reference internal" href="../../topics/testing/tools/#django.test.override_settings" title="django.test.override_settings"><code class="xref py py-func docutils literal"><span class="pre">override_settings()</span></code></a> and
<a class="reference internal" href="../../topics/testing/tools/#django.test.modify_settings" title="django.test.modify_settings"><code class="xref py py-func docutils literal"><span class="pre">modify_settings()</span></code></a> now act at the class level when used as
class decorators. As a consequence, when overriding <code class="docutils literal"><span class="pre">setUpClass()</span></code> or
<code class="docutils literal"><span class="pre">tearDownClass()</span></code>, the <code class="docutils literal"><span class="pre">super</span></code> implementation should always be called.</p>
</div>

<div class="section" id="s-database-connection-reloading-between-tests">
<span id="database-connection-reloading-between-tests"/><h3>Database connection reloading between tests<a class="headerlink" href="#database-connection-reloading-between-tests" title="Permalink to this headline">¶</a></h3>
<p>Django previously closed database connections between each test within a
<code class="docutils literal"><span class="pre">TestCase</span></code>. This is no longer the case as Django now wraps the whole
<code class="docutils literal"><span class="pre">TestCase</span></code> within a transaction. If some of your tests relied on the old
behavior, you should have them inherit from <code class="docutils literal"><span class="pre">TransactionTestCase</span></code> instead.</p>
</div>
<div class="section" id="s-cleanup-of-the-django-template-namespace">
<span id="cleanup-of-the-django-template-namespace"/><h3>Cleanup of the <code class="docutils literal"><span class="pre">django.template</span></code> namespace<a class="headerlink" href="#cleanup-of-the-django-template-namespace" title="Permalink to this headline">¶</a></h3>
<p>If you’ve been relying on private APIs exposed in the <code class="docutils literal"><span class="pre">django.template</span></code>
module, you may have to import them from <code class="docutils literal"><span class="pre">django.template.base</span></code> instead.</p>
<p>Also private APIs <code class="docutils literal"><span class="pre">django.template.base.compile_string()</span></code>,
<code class="docutils literal"><span class="pre">django.template.loader.find_template()</span></code>, and
<code class="docutils literal"><span class="pre">django.template.loader.get_template_from_string()</span></code> were removed.</p>
</div>
<div class="section" id="s-model-attribute-on-private-model-relations">
<span id="model-attribute-on-private-model-relations"/><h3><code class="docutils literal"><span class="pre">model</span></code> attribute on private model relations<a class="headerlink" href="#model-attribute-on-private-model-relations" title="Permalink to this headline">¶</a></h3>
<p>In earlier versions of Django, on a model with a reverse foreign key
relationship (for example), <code class="docutils literal"><span class="pre">model._meta.get_all_related_objects()</span></code> returned
the relationship as a <code class="docutils literal"><span class="pre">django.db.models.related.RelatedObject</span></code> with the
<code class="docutils literal"><span class="pre">model</span></code> attribute set to the source of the relationship. Now, this method
returns the relationship as <code class="docutils literal"><span class="pre">django.db.models.fields.related.ManyToOneRel</span></code>
(private API <code class="docutils literal"><span class="pre">RelatedObject</span></code> has been removed), and the <code class="docutils literal"><span class="pre">model</span></code> attribute
is set to the target of the relationship instead of the source. The source
model is accessible on the <code class="docutils literal"><span class="pre">related_model</span></code> attribute instead.</p>
<p>Consider this example from the tutorial in Django 1.8:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_related_objects</span><span class="p">()</span>
<span class="go">[&lt;ManyToOneRel: polls.choice&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_related_objects</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span>
<span class="go">&lt;class 'polls.models.Poll'&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_related_objects</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">related_model</span>
<span class="go">&lt;class 'polls.models.Choice'&gt;</span>
</pre></div>
</div>
<p>and compare it to the behavior on older versions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_related_objects</span><span class="p">()</span>
<span class="go">[&lt;RelatedObject: polls:choice related to poll&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_related_objects</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span>
<span class="go">&lt;class 'polls.models.Choice'&gt;</span>
</pre></div>
</div>
<p>To access the source model, you can use a pattern like this to write code that
will work with both Django 1.8 and older versions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">relation</span> <span class="ow">in</span> <span class="n">opts</span><span class="o">.</span><span class="n">get_all_related_objects</span><span class="p">():</span>
    <span class="n">to_model</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">relation</span><span class="p">,</span> <span class="s1">'related_model'</span><span class="p">,</span> <span class="n">relation</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p>Also note that <code class="docutils literal"><span class="pre">get_all_related_objects()</span></code> is deprecated in 1.8. See the
<a class="reference internal" href="../../ref/models/meta/#migrating-old-meta-api"><span>upgrade guide</span></a> for the new API.</p>
</div>
<div class="section" id="s-database-backend-api">
<span id="database-backend-api"/><h3>Database backend API<a class="headerlink" href="#database-backend-api" title="Permalink to this headline">¶</a></h3>
<p>The following changes to the database backend API are documented to assist
those writing third-party backends in updating their code:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">BaseDatabaseXXX</span></code> classes have been moved to <code class="docutils literal"><span class="pre">django.db.backends.base</span></code>.
Please import them from the new locations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db.backends.base.base</span> <span class="kn">import</span> <span class="n">BaseDatabaseWrapper</span>
<span class="kn">from</span> <span class="nn">django.db.backends.base.client</span> <span class="kn">import</span> <span class="n">BaseDatabaseClient</span>
<span class="kn">from</span> <span class="nn">django.db.backends.base.creation</span> <span class="kn">import</span> <span class="n">BaseDatabaseCreation</span>
<span class="kn">from</span> <span class="nn">django.db.backends.base.features</span> <span class="kn">import</span> <span class="n">BaseDatabaseFeatures</span>
<span class="kn">from</span> <span class="nn">django.db.backends.base.introspection</span> <span class="kn">import</span> <span class="n">BaseDatabaseIntrospection</span>
<span class="kn">from</span> <span class="nn">django.db.backends.base.introspection</span> <span class="kn">import</span> <span class="n">FieldInfo</span><span class="p">,</span> <span class="n">TableInfo</span>
<span class="kn">from</span> <span class="nn">django.db.backends.base.operations</span> <span class="kn">import</span> <span class="n">BaseDatabaseOperations</span>
<span class="kn">from</span> <span class="nn">django.db.backends.base.schema</span> <span class="kn">import</span> <span class="n">BaseDatabaseSchemaEditor</span>
<span class="kn">from</span> <span class="nn">django.db.backends.base.validation</span> <span class="kn">import</span> <span class="n">BaseDatabaseValidation</span>
</pre></div>
</div>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">data_types</span></code>, <code class="docutils literal"><span class="pre">data_types_suffix</span></code>, and
<code class="docutils literal"><span class="pre">data_type_check_constraints</span></code> attributes have moved from the
<code class="docutils literal"><span class="pre">DatabaseCreation</span></code> class to <code class="docutils literal"><span class="pre">DatabaseWrapper</span></code>.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">SQLCompiler.as_sql()</span></code> method now takes a <code class="docutils literal"><span class="pre">subquery</span></code> parameter
(<a class="reference external" href="https://code.djangoproject.com/ticket/24164">#24164</a>).</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">BaseDatabaseOperations.date_interval_sql()</span></code> method now only takes a
<code class="docutils literal"><span class="pre">timedelta</span></code> parameter.</p>
</li>
</ul>
</div>
<div class="section" id="s-id2">
<span id="id2"/>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">AdminSite</span></code> no longer takes an <code class="docutils literal"><span class="pre">app_name</span></code> argument and its <code class="docutils literal"><span class="pre">app_name</span></code>
attribute has been removed. The application name is always <code class="docutils literal"><span class="pre">admin</span></code> (as
opposed to the instance name which you can still customize using
<code class="docutils literal"><span class="pre">AdminSite(name="...")</span></code>.</li>
<li>The <code class="docutils literal"><span class="pre">ModelAdmin.get_object()</span></code> method (private API) now takes a third
argument named <code class="docutils literal"><span class="pre">from_field</span></code> in order to specify which field should match
the provided <code class="docutils literal"><span class="pre">object_id</span></code>.</li>
<li>The <a class="reference internal" href="../../ref/contrib/admin/#django.contrib.admin.ModelAdmin.response_delete" title="django.contrib.admin.ModelAdmin.response_delete"><code class="xref py py-meth docutils literal"><span class="pre">ModelAdmin.response_delete()</span></code></a> method
now takes a second argument named <code class="docutils literal"><span class="pre">obj_id</span></code> which is the serialized
identifier used to retrieve the object before deletion.</li>
</ul>
</div>
<div class="section" id="s-default-autoescaping-of-functions-in-django-template-defaultfilters">
<span id="default-autoescaping-of-functions-in-django-template-defaultfilters"/><h3>Default autoescaping of functions in <code class="docutils literal"><span class="pre">django.template.defaultfilters</span></code><a class="headerlink" href="#default-autoescaping-of-functions-in-django-template-defaultfilters" title="Permalink to this headline">¶</a></h3>
<p>In order to make built-in template filters that output HTML “safe by default”
when calling them in Python code, the following functions in
<code class="docutils literal"><span class="pre">django.template.defaultfilters</span></code> have been changed to automatically escape
their input value:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">join</span></code></li>
<li><code class="docutils literal"><span class="pre">linebreaksbr</span></code></li>
<li><code class="docutils literal"><span class="pre">linebreaks_filter</span></code></li>
<li><code class="docutils literal"><span class="pre">linenumbers</span></code></li>
<li><code class="docutils literal"><span class="pre">unordered_list</span></code></li>
<li><code class="docutils literal"><span class="pre">urlize</span></code></li>
<li><code class="docutils literal"><span class="pre">urlizetrunc</span></code></li>
</ul>
<p>You can revert to the old behavior by specifying <code class="docutils literal"><span class="pre">autoescape=False</span></code> if you
are passing trusted content. This change doesn’t have any effect when using
the corresponding filters in templates.</p>
</div>
<div class="section" id="s-miscellaneous">
<span id="miscellaneous"/><h3>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">connections.queries</span></code> is now a read-only attribute.</p>
</li>
<li><p class="first">Database connections are considered equal only if they’re the same object.
They aren’t hashable any more.</p>
</li>
<li><p class="first"><a class="reference internal" href="../../ref/middleware/#django.middleware.gzip.GZipMiddleware" title="django.middleware.gzip.GZipMiddleware"><code class="xref py py-class docutils literal"><span class="pre">GZipMiddleware</span></code></a> used to disable compression
for some content types when the request is from Internet Explorer, in order
to work around a bug in IE6 and earlier. This behavior could affect
performance on IE7 and later. It was removed.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">URLField.to_python</span></code> no longer adds a trailing slash to pathless URLs.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../../ref/templates/builtins/#std:templatefilter-length"><code class="xref std std-tfilter docutils literal"><span class="pre">length</span></code></a> template filter now returns <code class="docutils literal"><span class="pre">0</span></code> for an undefined
variable, rather than an empty string.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">ForeignKey.default_error_message['invalid']</span></code> has been changed from
<code class="docutils literal"><span class="pre">'%(model)s</span> <span class="pre">instance</span> <span class="pre">with</span> <span class="pre">pk</span> <span class="pre">%(pk)r</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">exist.'</span></code> to
<code class="docutils literal"><span class="pre">'%(model)s</span> <span class="pre">instance</span> <span class="pre">with</span> <span class="pre">%(field)s</span> <span class="pre">%(value)r</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">exist.'</span></code> If you are
using this message in your own code, please update the list of interpolated
parameters. Internally, Django will continue to provide the
<code class="docutils literal"><span class="pre">pk</span></code> parameter in <code class="docutils literal"><span class="pre">params</span></code> for backwards compatibility.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">UserCreationForm.error_messages['duplicate_username']</span></code> is no longer used.
If you wish to customize that error message, <a class="reference internal" href="../../topics/forms/modelforms/#modelforms-overriding-default-fields"><span>override it on the form</span></a> using the <code class="docutils literal"><span class="pre">'unique'</span></code> key in
<code class="docutils literal"><span class="pre">Meta.error_messages['username']</span></code> or, if you have a custom form field for
<code class="docutils literal"><span class="pre">'username'</span></code>, using the the <code class="docutils literal"><span class="pre">'unique'</span></code> key in its
<a class="reference internal" href="../../ref/forms/fields/#django.forms.Field.error_messages" title="django.forms.Field.error_messages"><code class="xref py py-attr docutils literal"><span class="pre">error_messages</span></code></a> argument.</p>
</li>
<li><p class="first">The block <code class="docutils literal"><span class="pre">usertools</span></code> in the <code class="docutils literal"><span class="pre">base.html</span></code> template of
<a class="reference internal" href="../../ref/contrib/admin/#module-django.contrib.admin" title="django.contrib.admin: Django's admin site."><code class="xref py py-mod docutils literal"><span class="pre">django.contrib.admin</span></code></a> now requires the <code class="docutils literal"><span class="pre">has_permission</span></code> context
variable to be set. If you have any custom admin views that use this
template, update them to pass <a class="reference internal" href="../../ref/contrib/admin/#django.contrib.admin.AdminSite.has_permission" title="django.contrib.admin.AdminSite.has_permission"><code class="xref py py-meth docutils literal"><span class="pre">AdminSite.has_permission()</span></code></a> as this new variable’s
value or simply include <a class="reference internal" href="../../ref/contrib/admin/#django.contrib.admin.AdminSite.each_context" title="django.contrib.admin.AdminSite.each_context"><code class="xref py py-meth docutils literal"><span class="pre">AdminSite.each_context(request)</span></code></a> in the context.</p>
</li>
<li><p class="first">Internal changes were made to the <a class="reference internal" href="../../ref/forms/widgets/#django.forms.ClearableFileInput" title="django.forms.ClearableFileInput"><code class="xref py py-class docutils literal"><span class="pre">ClearableFileInput</span></code></a>
widget to allow more customization. The undocumented <code class="docutils literal"><span class="pre">url_markup_template</span></code>
attribute was removed in favor of <code class="docutils literal"><span class="pre">template_with_initial</span></code>.</p>
</li>
<li><p class="first">For consistency with other major vendors, the <code class="docutils literal"><span class="pre">en_GB</span></code> locale now has Monday
as the first day of the week.</p>
</li>
<li><p class="first">Seconds have been removed from any locales that had them in <code class="docutils literal"><span class="pre">TIME_FORMAT</span></code>,
<code class="docutils literal"><span class="pre">DATETIME_FORMAT</span></code>, or <code class="docutils literal"><span class="pre">SHORT_DATETIME_FORMAT</span></code>.</p>
</li>
<li><p class="first">The default max size of the Oracle test tablespace has increased from 300M
(or 200M, before 1.7.2) to 500M.</p>
</li>
<li><p class="first"><a class="reference internal" href="../../ref/urlresolvers/#django.core.urlresolvers.reverse" title="django.core.urlresolvers.reverse"><code class="xref py py-func docutils literal"><span class="pre">reverse()</span></code></a> and
<a class="reference internal" href="../../ref/urlresolvers/#django.core.urlresolvers.reverse_lazy" title="django.core.urlresolvers.reverse_lazy"><code class="xref py py-func docutils literal"><span class="pre">reverse_lazy()</span></code></a> now return Unicode strings
instead of byte strings.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">CacheClass</span></code> shim has been removed from all cache backends.
These aliases were provided for backwards compatibility with Django 1.3.
If you are still using them, please update your project to use the real
class name found in the <a class="reference internal" href="../../ref/settings/#std:setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal"><span class="pre">BACKEND</span></code></a> key of the
<a class="reference internal" href="../../ref/settings/#std:setting-CACHES"><code class="xref std std-setting docutils literal"><span class="pre">CACHES</span></code></a> setting.</p>
</li>
<li><p class="first">By default, <a class="reference internal" href="../../ref/django-admin/#call-command"><span>call_command</span></a> now always skips the check
framework (unless you pass it <code class="docutils literal"><span class="pre">skip_checks=False</span></code>).</p>
</li>
<li><p class="first">When iterating over lines, <a class="reference internal" href="../../ref/files/file/#django.core.files.File" title="django.core.files.File"><code class="xref py py-class docutils literal"><span class="pre">File</span></code></a> now uses
<a class="reference external" href="https://www.python.org/dev/peps/pep-0278">universal newlines</a>. The following are recognized as ending a line: the
Unix end-of-line convention <code class="docutils literal"><span class="pre">'\n'</span></code>, the Windows convention <code class="docutils literal"><span class="pre">'\r\n'</span></code>, and
the old Macintosh convention <code class="docutils literal"><span class="pre">'\r'</span></code>.</p>
</li>
<li><p class="first">The Memcached cache backends <code class="docutils literal"><span class="pre">MemcachedCache</span></code> and <code class="docutils literal"><span class="pre">PyLibMCCache</span></code> will
delete a key if <code class="docutils literal"><span class="pre">set()</span></code> fails. This is necessary to ensure the <code class="docutils literal"><span class="pre">cache_db</span></code>
session store always fetches the most current session data.</p>
</li>
<li><p class="first">Private APIs <code class="docutils literal"><span class="pre">override_template_loaders</span></code> and <code class="docutils literal"><span class="pre">override_with_test_loader</span></code>
in <code class="docutils literal"><span class="pre">django.test.utils</span></code> were removed. Override <code class="docutils literal"><span class="pre">TEMPLATES</span></code> with
<code class="docutils literal"><span class="pre">override_settings</span></code> instead.</p>
</li>
<li><p class="first">Warnings from the MySQL database backend are no longer converted to
exceptions when <a class="reference internal" href="../../ref/settings/#std:setting-DEBUG"><code class="xref std std-setting docutils literal"><span class="pre">DEBUG</span></code></a> is <code class="docutils literal"><span class="pre">True</span></code>.</p>
</li>
<li><p class="first"><a class="reference internal" href="../../ref/request-response/#django.http.HttpRequest" title="django.http.HttpRequest"><code class="xref py py-class docutils literal"><span class="pre">HttpRequest</span></code></a> now has a simplified <code class="docutils literal"><span class="pre">repr</span></code> (e.g.
<code class="docutils literal"><span class="pre">&lt;WSGIRequest:</span> <span class="pre">GET</span> <span class="pre">'/somepath/'&gt;</span></code>). This won’t change the behavior of
the <a class="reference internal" href="../../howto/error-reporting/#django.views.debug.SafeExceptionReporterFilter" title="django.views.debug.SafeExceptionReporterFilter"><code class="xref py py-class docutils literal"><span class="pre">SafeExceptionReporterFilter</span></code></a> class.</p>
</li>
<li><p class="first">Class-based views that use <a class="reference internal" href="../../ref/class-based-views/mixins-editing/#django.views.generic.edit.ModelFormMixin" title="django.views.generic.edit.ModelFormMixin"><code class="xref py py-class docutils literal"><span class="pre">ModelFormMixin</span></code></a>
will raise an <a class="reference internal" href="../../ref/exceptions/#django.core.exceptions.ImproperlyConfigured" title="django.core.exceptions.ImproperlyConfigured"><code class="xref py py-exc docutils literal"><span class="pre">ImproperlyConfigured</span></code></a> exception
when both the <code class="docutils literal"><span class="pre">fields</span></code> and <code class="docutils literal"><span class="pre">form_class</span></code> attributes are specified.
Previously, <code class="docutils literal"><span class="pre">fields</span></code> was silently ignored.</p>
</li>
<li><p class="first">When following redirects, the test client now raises
<a class="reference internal" href="../../ref/exceptions/#django.test.client.RedirectCycleError" title="django.test.client.RedirectCycleError"><code class="xref py py-exc docutils literal"><span class="pre">RedirectCycleError</span></code></a> if it detects a loop or hits a
maximum redirect limit (rather than passing silently).</p>
</li>
<li><p class="first">Translatable strings set as the <code class="docutils literal"><span class="pre">default</span></code> parameter of the field are cast
to concrete strings later, so the return type of <code class="docutils literal"><span class="pre">Field.get_default()</span></code> is
different in some cases. There is no change to default values which are the
result of a callable.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">GenericIPAddressField.empty_strings_allowed</span></code> is now <code class="docutils literal"><span class="pre">False</span></code>. Database
backends that interpret empty strings as null (only Oracle among the backends
that Django includes) will no longer convert null values back to an empty
string. This is consistent with other backends.</p>
</li>
<li><p class="first">When the <a class="reference internal" href="../../howto/custom-management-commands/#django.core.management.BaseCommand.leave_locale_alone" title="django.core.management.BaseCommand.leave_locale_alone"><code class="xref py py-attr docutils literal"><span class="pre">leave_locale_alone</span></code></a>
attribute is <code class="docutils literal"><span class="pre">False</span></code>, translations are now deactivated instead of forcing
the “en-us” locale. In the case your models contained non-English strings and
you counted on English translations to be activated in management commands,
this will not happen any longer. It might be that new database migrations are
generated (once) after migrating to 1.8.</p>
</li>
<li><p class="first"><a class="reference internal" href="../../ref/utils/#django.utils.translation.get_language" title="django.utils.translation.get_language"><code class="xref py py-func docutils literal"><span class="pre">django.utils.translation.get_language()</span></code></a> now returns <code class="docutils literal"><span class="pre">None</span></code> instead
of <a class="reference internal" href="../../ref/settings/#std:setting-LANGUAGE_CODE"><code class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_CODE</span></code></a> when translations are temporarily deactivated.</p>
</li>
<li><p class="first">When a translation doesn’t exist for a specific literal, the fallback is now
taken from the <a class="reference internal" href="../../ref/settings/#std:setting-LANGUAGE_CODE"><code class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_CODE</span></code></a> language (instead of from the
untranslated <code class="docutils literal"><span class="pre">msgid</span></code> message).</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">name</span></code> field of <a class="reference internal" href="../../ref/contrib/contenttypes/#django.contrib.contenttypes.models.ContentType" title="django.contrib.contenttypes.models.ContentType"><code class="xref py py-class docutils literal"><span class="pre">django.contrib.contenttypes.models.ContentType</span></code></a>
has been removed by a migration and replaced by a property. That means it’s
not possible to query or filter a <code class="docutils literal"><span class="pre">ContentType</span></code> by this field any longer.</p>
<p>Be careful if you upgrade to Django 1.8 and skip Django 1.7. If you run
<code class="docutils literal"><span class="pre">manage.py</span> <span class="pre">migrate</span> <span class="pre">--fake</span></code>, this migration will be skipped and you’ll see
a <code class="docutils literal"><span class="pre">RuntimeError:</span> <span class="pre">Error</span> <span class="pre">creating</span> <span class="pre">new</span> <span class="pre">content</span> <span class="pre">types.</span></code> exception because the
<code class="docutils literal"><span class="pre">name</span></code> column won’t be dropped from the database. Use <code class="docutils literal"><span class="pre">migrate.py</span> <span class="pre">migrate</span>
<span class="pre">--fake-initial</span></code> to fake only the initial migration instead.</p>
</li>
<li><p class="first"><a class="reference internal" href="../../ref/django-admin/#django-admin-migrate"><code class="xref std std-djadmin docutils literal"><span class="pre">migrate</span></code></a> now accepts the <a class="reference internal" href="../../ref/django-admin/#django-admin-option---fake-initial"><code class="xref std std-djadminopt docutils literal"><span class="pre">--fake-initial</span></code></a> option to
allow faking initial migrations. In 1.7 initial migrations were always
automatically faked if all tables created in an initial migration already
existed.</p>
</li>
<li><p class="first">An app <em>without</em> migrations with a <code class="docutils literal"><span class="pre">ForeignKey</span></code> to an app <em>with</em> migrations
may now result in a foreign key constraint error when migrating the database
or running tests. In Django 1.7, this could fail silently and result in a
missing constraint. To resolve the error, add migrations to the app without
them.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="s-features-deprecated-in-1-8">
<span id="s-deprecated-features-1-8"/><span id="features-deprecated-in-1-8"/><span id="deprecated-features-1-8"/><h2>Features deprecated in 1.8<a class="headerlink" href="#features-deprecated-in-1-8" title="Permalink to this headline">¶</a></h2>
<div class="section" id="s-selected-methods-in-django-db-models-options-options">
<span id="selected-methods-in-django-db-models-options-options"/><h3>Selected methods in <code class="docutils literal"><span class="pre">django.db.models.options.Options</span></code><a class="headerlink" href="#selected-methods-in-django-db-models-options-options" title="Permalink to this headline">¶</a></h3>
<p>As part of the formalization of the <code class="docutils literal"><span class="pre">Model._meta</span></code> API (from the
<a class="reference internal" href="../../ref/models/meta/#django.db.models.options.Options" title="django.db.models.options.Options"><code class="xref py py-class docutils literal"><span class="pre">django.db.models.options.Options</span></code></a> class), a number of methods have been
deprecated and will be removed in Django 1.10:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">get_all_field_names()</span></code></li>
<li><code class="docutils literal"><span class="pre">get_all_related_objects()</span></code></li>
<li><code class="docutils literal"><span class="pre">get_all_related_objects_with_model()</span></code></li>
<li><code class="docutils literal"><span class="pre">get_all_related_many_to_many_objects()</span></code></li>
<li><code class="docutils literal"><span class="pre">get_all_related_m2m_objects_with_model()</span></code></li>
<li><code class="docutils literal"><span class="pre">get_concrete_fields_with_model()</span></code></li>
<li><code class="docutils literal"><span class="pre">get_field_by_name()</span></code></li>
<li><code class="docutils literal"><span class="pre">get_fields_with_model()</span></code></li>
<li><code class="docutils literal"><span class="pre">get_m2m_with_model()</span></code></li>
</ul>
<p>A <a class="reference internal" href="../../ref/models/meta/#migrating-old-meta-api"><span>migration guide</span></a> has been provided to assist
in converting your code from the old API to the new, official API.</p>
</div>

<div class="section" id="s-django-conf-urls-patterns">
<span id="django-conf-urls-patterns"/><h3><code class="docutils literal"><span class="pre">django.conf.urls.patterns()</span></code><a class="headerlink" href="#django-conf-urls-patterns" title="Permalink to this headline">¶</a></h3>
<p>In the olden days of Django, it was encouraged to reference views as strings
in <code class="docutils literal"><span class="pre">urlpatterns</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">'^$'</span><span class="p">,</span> <span class="s1">'myapp.views.myview'</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>and Django would magically import <code class="docutils literal"><span class="pre">myapp.views.myview</span></code> internally and turn
the string into a real function reference. In order to reduce repetition when
referencing many views from the same module, the <code class="docutils literal"><span class="pre">patterns()</span></code> function takes
a required initial <code class="docutils literal"><span class="pre">prefix</span></code> argument which is prepended to all
views-as-strings in that set of <code class="docutils literal"><span class="pre">urlpatterns</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s1">'myapp.views'</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">'^$'</span><span class="p">,</span> <span class="s1">'myview'</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">'^other/$'</span><span class="p">,</span> <span class="s1">'otherview'</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In the modern era, we have updated the tutorial to instead recommend importing
your views module and referencing your view functions (or classes) directly.
This has a number of advantages, all deriving from the fact that we are using
normal Python in place of “Django String Magic”: the errors when you mistype a
view name are less obscure, IDEs can help with autocompletion of view names,
etc.</p>
<p>So these days, the above use of the <code class="docutils literal"><span class="pre">prefix</span></code> arg is much more likely to be
written (and is better written) as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">myapp</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">'^$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">myview</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">'^other/$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">otherview</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Thus <code class="docutils literal"><span class="pre">patterns()</span></code> serves little purpose and is a burden when teaching new users
(answering the newbie’s question “why do I need this empty string as the first
argument to <code class="docutils literal"><span class="pre">patterns()</span></code>?”). For these reasons, we are deprecating it.
Updating your code is as simple as ensuring that <code class="docutils literal"><span class="pre">urlpatterns</span></code> is a list of
<a class="reference internal" href="../../ref/urls/#django.conf.urls.url" title="django.conf.urls.url"><code class="xref py py-func docutils literal"><span class="pre">django.conf.urls.url()</span></code></a> instances. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">myapp</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">'^$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">myview</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">'^other/$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">otherview</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="s-passing-a-string-as-view-to-url">
<span id="passing-a-string-as-view-to-url"/><h3>Passing a string as <code class="docutils literal"><span class="pre">view</span></code> to <a class="reference internal" href="../../ref/urls/#django.conf.urls.url" title="django.conf.urls.url"><code class="xref py py-func docutils literal"><span class="pre">url()</span></code></a><a class="headerlink" href="#passing-a-string-as-view-to-url" title="Permalink to this headline">¶</a></h3>
<p>Related to the previous item, referencing views as strings in the <code class="docutils literal"><span class="pre">url()</span></code>
function is deprecated. Pass the callable view as described in the previous
section instead.</p>
</div>

<div class="section" id="s-django-core-context-processors">
<span id="django-core-context-processors"/><h3><code class="docutils literal"><span class="pre">django.core.context_processors</span></code><a class="headerlink" href="#django-core-context-processors" title="Permalink to this headline">¶</a></h3>
<p>Built-in template context processors have been moved to
<code class="docutils literal"><span class="pre">django.template.context_processors</span></code>.</p>
</div>


<div class="section" id="s-using-an-incorrect-count-of-unpacked-values-in-the-for-template-tag">
<span id="using-an-incorrect-count-of-unpacked-values-in-the-for-template-tag"/><h3>Using an incorrect count of unpacked values in the <a class="reference internal" href="../../ref/templates/builtins/#std:templatetag-for"><code class="xref std std-ttag docutils literal"><span class="pre">for</span></code></a> template tag<a class="headerlink" href="#using-an-incorrect-count-of-unpacked-values-in-the-for-template-tag" title="Permalink to this headline">¶</a></h3>
<p>Using an incorrect count of unpacked values in <a class="reference internal" href="../../ref/templates/builtins/#std:templatetag-for"><code class="xref std std-ttag docutils literal"><span class="pre">for</span></code></a> tag will raise an
exception rather than fail silently in Django 1.10.</p>
</div>
<div class="section" id="s-passing-a-dotted-path-to-reverse-and-url">
<span id="passing-a-dotted-path-to-reverse-and-url"/><h3>Passing a dotted path to <a class="reference internal" href="../../ref/urlresolvers/#django.core.urlresolvers.reverse" title="django.core.urlresolvers.reverse"><code class="xref py py-func docutils literal"><span class="pre">reverse()</span></code></a> and <a class="reference internal" href="../../ref/templates/builtins/#std:templatetag-url"><code class="xref std std-ttag docutils literal"><span class="pre">url</span></code></a><a class="headerlink" href="#passing-a-dotted-path-to-reverse-and-url" title="Permalink to this headline">¶</a></h3>
<p>Reversing URLs by Python path is an expensive operation as it causes the
path being reversed to be imported. This behavior has also resulted in a
<a class="reference external" href="https://www.djangoproject.com/weblog/2014/apr/21/security/#s-issue-unexpected-code-execution-using-reverse">security issue</a>. Use <a class="reference internal" href="../../topics/http/urls/#naming-url-patterns"><span>named URL patterns</span></a>
for reversing instead.</p>
<p>If you are using <a class="reference internal" href="../../ref/contrib/sitemaps/#module-django.contrib.sitemaps" title="django.contrib.sitemaps: A framework for generating Google sitemap XML files."><code class="xref py py-mod docutils literal"><span class="pre">django.contrib.sitemaps</span></code></a>, add the <code class="docutils literal"><span class="pre">name</span></code> argument to
the <code class="docutils literal"><span class="pre">url</span></code> that references <a class="reference internal" href="../../ref/contrib/sitemaps/#django.contrib.sitemaps.views.sitemap" title="django.contrib.sitemaps.views.sitemap"><code class="xref py py-func docutils literal"><span class="pre">django.contrib.sitemaps.views.sitemap()</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.sitemaps.views</span> <span class="kn">import</span> <span class="n">sitemap</span>

<span class="n">url</span><span class="p">(</span><span class="s1">r'^sitemap\.xml$'</span><span class="p">,</span> <span class="n">sitemap</span><span class="p">,</span> <span class="p">{</span><span class="s1">'sitemaps'</span><span class="p">:</span> <span class="n">sitemaps</span><span class="p">},</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">'django.contrib.sitemaps.views.sitemap'</span><span class="p">)</span>
</pre></div>
</div>
<p>to ensure compatibility when reversing by Python path is removed in Django 1.10.</p>
<p>Similarly for GIS sitemaps, add <code class="docutils literal"><span class="pre">name='django.contrib.gis.sitemaps.views.kml'</span></code>
or <code class="docutils literal"><span class="pre">name='django.contrib.gis.sitemaps.views.kmz'</span></code>.</p>
</div>
<div class="section" id="s-aggregate-methods-and-modules">
<span id="aggregate-methods-and-modules"/><h3>Aggregate methods and modules<a class="headerlink" href="#aggregate-methods-and-modules" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">django.db.models.sql.aggregates</span></code> and
<code class="docutils literal"><span class="pre">django.contrib.gis.db.models.sql.aggregates</span></code> modules (both private API), have
been deprecated as <code class="docutils literal"><span class="pre">django.db.models.aggregates</span></code> and
<code class="docutils literal"><span class="pre">django.contrib.gis.db.models.aggregates</span></code> are now also responsible
for SQL generation. The old modules will be removed in Django 1.10.</p>
<p>If you were using the old modules, see <a class="reference internal" href="../../ref/models/expressions/"><em>Query Expressions</em></a> for instructions on rewriting custom aggregates
using the new stable API.</p>
<p>The following methods and properties of <code class="docutils literal"><span class="pre">django.db.models.sql.query.Query</span></code>
have also been deprecated and the backwards compatibility shims will be removed
in Django 1.10:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Query.aggregates</span></code>, replaced by <code class="docutils literal"><span class="pre">annotations</span></code>.</li>
<li><code class="docutils literal"><span class="pre">Query.aggregate_select</span></code>, replaced by <code class="docutils literal"><span class="pre">annotation_select</span></code>.</li>
<li><code class="docutils literal"><span class="pre">Query.add_aggregate()</span></code>, replaced by <code class="docutils literal"><span class="pre">add_annotation()</span></code>.</li>
<li><code class="docutils literal"><span class="pre">Query.set_aggregate_mask()</span></code>, replaced by <code class="docutils literal"><span class="pre">set_annotation_mask()</span></code>.</li>
<li><code class="docutils literal"><span class="pre">Query.append_aggregate_mask()</span></code>, replaced by <code class="docutils literal"><span class="pre">append_annotation_mask()</span></code>.</li>
</ul>
</div>
<div class="section" id="s-extending-management-command-arguments-through-command-option-list">
<span id="extending-management-command-arguments-through-command-option-list"/><h3>Extending management command arguments through <code class="docutils literal"><span class="pre">Command.option_list</span></code><a class="headerlink" href="#extending-management-command-arguments-through-command-option-list" title="Permalink to this headline">¶</a></h3>
<p>Management commands now use <a class="reference external" href="https://docs.python.org/3/library/argparse.html#module-argparse" title="(in Python v3.5)"><code class="xref py py-mod docutils literal"><span class="pre">argparse</span></code></a> instead of <a class="reference external" href="https://docs.python.org/3/library/optparse.html#module-optparse" title="(in Python v3.5)"><code class="xref py py-mod docutils literal"><span class="pre">optparse</span></code></a> to
parse command-line arguments passed to commands. This also means that the way
to add custom arguments to commands has changed: instead of extending the
<code class="docutils literal"><span class="pre">option_list</span></code> class list, you should now override the
<a class="reference internal" href="../../howto/custom-management-commands/#django.core.management.BaseCommand.add_arguments" title="django.core.management.BaseCommand.add_arguments"><code class="xref py py-meth docutils literal"><span class="pre">add_arguments()</span></code></a> method and add
arguments through <code class="docutils literal"><span class="pre">argparse.add_argument()</span></code>. See
<a class="reference internal" href="../../howto/custom-management-commands/#custom-commands-options"><span>this example</span></a> for more details.</p>
</div>
<div class="section" id="s-django-core-management-noargscommand">
<span id="django-core-management-noargscommand"/><h3><code class="docutils literal"><span class="pre">django.core.management.NoArgsCommand</span></code><a class="headerlink" href="#django-core-management-noargscommand" title="Permalink to this headline">¶</a></h3>
<p>The class <a class="reference internal" href="../../howto/custom-management-commands/#django.core.management.NoArgsCommand" title="django.core.management.NoArgsCommand"><code class="xref py py-class docutils literal"><span class="pre">NoArgsCommand</span></code></a> is now deprecated and
will be removed in Django 1.10. Use <a class="reference internal" href="../../howto/custom-management-commands/#django.core.management.BaseCommand" title="django.core.management.BaseCommand"><code class="xref py py-class docutils literal"><span class="pre">BaseCommand</span></code></a>
instead, which takes no arguments by default.</p>
</div>
<div class="section" id="s-listing-all-migrations-in-a-project">
<span id="listing-all-migrations-in-a-project"/><h3>Listing all migrations in a project<a class="headerlink" href="#listing-all-migrations-in-a-project" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">--list</span></code> option of the <a class="reference internal" href="../../ref/django-admin/#django-admin-migrate"><code class="xref std std-djadmin docutils literal"><span class="pre">migrate</span></code></a> management command is
deprecated and will be removed in Django 1.10. Use <a class="reference internal" href="../../ref/django-admin/#django-admin-showmigrations"><code class="xref std std-djadmin docutils literal"><span class="pre">showmigrations</span></code></a>
instead.</p>
</div>
<div class="section" id="s-cache-choices-option-of-modelchoicefield-and-modelmultiplechoicefield">
<span id="cache-choices-option-of-modelchoicefield-and-modelmultiplechoicefield"/><h3><code class="docutils literal"><span class="pre">cache_choices</span></code> option of <code class="docutils literal"><span class="pre">ModelChoiceField</span></code> and <code class="docutils literal"><span class="pre">ModelMultipleChoiceField</span></code><a class="headerlink" href="#cache-choices-option-of-modelchoicefield-and-modelmultiplechoicefield" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../../ref/forms/fields/#django.forms.ModelChoiceField" title="django.forms.ModelChoiceField"><code class="xref py py-class docutils literal"><span class="pre">ModelChoiceField</span></code></a> and
<a class="reference internal" href="../../ref/forms/fields/#django.forms.ModelMultipleChoiceField" title="django.forms.ModelMultipleChoiceField"><code class="xref py py-class docutils literal"><span class="pre">ModelMultipleChoiceField</span></code></a> took an undocumented, untested
option <code class="docutils literal"><span class="pre">cache_choices</span></code>. This cached querysets between multiple renderings of
the same <code class="docutils literal"><span class="pre">Form</span></code> object. This option is subject to an accelerated deprecation
and will be removed in Django 1.9.</p>
</div>
<div class="section" id="s-django-template-resolve-variable">
<span id="django-template-resolve-variable"/><h3><code class="docutils literal"><span class="pre">django.template.resolve_variable()</span></code><a class="headerlink" href="#django-template-resolve-variable" title="Permalink to this headline">¶</a></h3>
<p>The function has been informally marked as “Deprecated” for some time. Replace
<code class="docutils literal"><span class="pre">resolve_variable(path,</span> <span class="pre">context)</span></code> with
<code class="docutils literal"><span class="pre">django.template.Variable(path).resolve(context)</span></code>.</p>
</div>
<div class="section" id="s-django-contrib-webdesign">
<span id="django-contrib-webdesign"/><h3><code class="docutils literal"><span class="pre">django.contrib.webdesign</span></code><a class="headerlink" href="#django-contrib-webdesign" title="Permalink to this headline">¶</a></h3>
<p>It provided the <a class="reference internal" href="../../ref/templates/builtins/#std:templatetag-lorem"><code class="xref std std-ttag docutils literal"><span class="pre">lorem</span></code></a> template tag which is now included in the
built-in tags. Simply remove <code class="docutils literal"><span class="pre">'django.contrib.webdesign'</span></code> from
<a class="reference internal" href="../../ref/settings/#std:setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></code></a> and <code class="docutils literal"><span class="pre">{%</span> <span class="pre">load</span> <span class="pre">webdesign</span> <span class="pre">%}</span></code> from your templates.</p>
</div>
<div class="section" id="s-error-message-argument-to-django-forms-regexfield">
<span id="error-message-argument-to-django-forms-regexfield"/><h3><code class="docutils literal"><span class="pre">error_message</span></code> argument to <code class="docutils literal"><span class="pre">django.forms.RegexField</span></code><a class="headerlink" href="#error-message-argument-to-django-forms-regexfield" title="Permalink to this headline">¶</a></h3>
<p>It provided backwards compatibility for pre-1.0 code, but its functionality is
redundant. Use <code class="docutils literal"><span class="pre">Field.error_messages['invalid']</span></code> instead.</p>
</div>
<div class="section" id="s-old-unordered-list-syntax">
<span id="old-unordered-list-syntax"/>
<p>An older (pre-1.0), more restrictive and verbose input format for the
<a class="reference internal" href="../../ref/templates/builtins/#std:templatefilter-unordered_list"><code class="xref std std-tfilter docutils literal"><span class="pre">unordered_list</span></code></a> template filter has been deprecated:</p>
<div class="highlight-python"><div class="highlight"><pre>``['States', [['Kansas', [['Lawrence', []], ['Topeka', []]]], ['Illinois', []]]]``
</pre></div>
</div>
<p>Using the new syntax, this becomes:</p>
<div class="highlight-python"><div class="highlight"><pre>``['States', ['Kansas', ['Lawrence', 'Topeka'], 'Illinois']]``
</pre></div>
</div>
</div>
<div class="section" id="s-django-forms-field-has-changed">
<span id="django-forms-field-has-changed"/><h3><code class="docutils literal"><span class="pre">django.forms.Field._has_changed()</span></code><a class="headerlink" href="#django-forms-field-has-changed" title="Permalink to this headline">¶</a></h3>
<p>Rename this method to <a class="reference internal" href="../../ref/forms/fields/#django.forms.Field.has_changed" title="django.forms.Field.has_changed"><code class="xref py py-meth docutils literal"><span class="pre">has_changed()</span></code></a> by removing the
leading underscore. The old name will still work until Django 1.10.</p>
</div>

<div class="section" id="s-is-admin-site-argument-to-django-contrib-auth-views-password-reset">
<span id="is-admin-site-argument-to-django-contrib-auth-views-password-reset"/><h3><code class="docutils literal"><span class="pre">is_admin_site</span></code> argument to <code class="docutils literal"><span class="pre">django.contrib.auth.views.password_reset()</span></code><a class="headerlink" href="#is-admin-site-argument-to-django-contrib-auth-views-password-reset" title="Permalink to this headline">¶</a></h3>
<p>It’s a legacy option that should no longer be necessary.</p>
</div>
<div class="section" id="s-subfieldbase">
<span id="subfieldbase"/><h3><code class="docutils literal"><span class="pre">SubfieldBase</span></code><a class="headerlink" href="#subfieldbase" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">django.db.models.fields.subclassing.SubfieldBase</span></code> has been deprecated and
will be removed in Django 1.10. Historically, it was used to handle fields where
type conversion was needed when loading from the database, but it was not used
in <code class="docutils literal"><span class="pre">.values()</span></code> calls or in aggregates. It has been replaced with
<a class="reference internal" href="../../ref/models/fields/#django.db.models.Field.from_db_value" title="django.db.models.Field.from_db_value"><code class="xref py py-meth docutils literal"><span class="pre">from_db_value()</span></code></a>. Note that the new approach does
not call the <a class="reference internal" href="../../ref/models/fields/#django.db.models.Field.to_python" title="django.db.models.Field.to_python"><code class="xref py py-meth docutils literal"><span class="pre">to_python()</span></code></a> method on assignment
as was the case with <code class="docutils literal"><span class="pre">SubfieldBase</span></code>.</p>
</div>
<div class="section" id="s-django-utils-checksums">
<span id="django-utils-checksums"/><h3><code class="docutils literal"><span class="pre">django.utils.checksums</span></code><a class="headerlink" href="#django-utils-checksums" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">django.utils.checksums</span></code> module has been deprecated and will be removed
in Django 1.10. The functionality it provided (validating checksum using the
Luhn algorithm) was undocumented and not used in Django. The module has been
moved to the <a class="reference external" href="https://pypi.python.org/pypi/django-localflavor">django-localflavor</a> package (version 1.1+).</p>
</div>
<div class="section" id="s-inlineadminform-original-content-type-id">
<span id="inlineadminform-original-content-type-id"/><h3><code class="docutils literal"><span class="pre">InlineAdminForm.original_content_type_id</span></code><a class="headerlink" href="#inlineadminform-original-content-type-id" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">original_content_type_id</span></code> attribute on <code class="docutils literal"><span class="pre">InlineAdminForm</span></code> has been
deprecated and will be removed in Django 1.10. Historically, it was used
to construct the “view on site” URL. This URL is now accessible using the
<code class="docutils literal"><span class="pre">absolute_url</span></code> attribute of the form.</p>
</div>
<div class="section" id="s-django-views-generic-edit-formmixin-get-form-s-form-class-argument">
<span id="django-views-generic-edit-formmixin-get-form-s-form-class-argument"/><h3><code class="docutils literal"><span class="pre">django.views.generic.edit.FormMixin.get_form()</span></code>’s <code class="docutils literal"><span class="pre">form_class</span></code> argument<a class="headerlink" href="#django-views-generic-edit-formmixin-get-form-s-form-class-argument" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">FormMixin</span></code> subclasses that override the <code class="docutils literal"><span class="pre">get_form()</span></code> method should make
sure to provide a default value for the <code class="docutils literal"><span class="pre">form_class</span></code> argument since it’s
now optional.</p>
</div>
<div class="section" id="s-rendering-templates-loaded-by-get-template-with-a-context">
<span id="rendering-templates-loaded-by-get-template-with-a-context"/>
<p>The return type of <a class="reference internal" href="../../topics/templates/#django.template.loader.get_template" title="django.template.loader.get_template"><code class="xref py py-func docutils literal"><span class="pre">get_template()</span></code></a> has changed
in Django 1.8: instead of a <a class="reference internal" href="../../ref/templates/api/#django.template.Template" title="django.template.Template"><code class="xref py py-class docutils literal"><span class="pre">django.template.Template</span></code></a>, it returns a
<code class="docutils literal"><span class="pre">Template</span></code> instance whose exact type depends on which backend loaded it.</p>
<p>Both classes provide a <code class="docutils literal"><span class="pre">render()</span></code> method, however, the former takes a
<a class="reference internal" href="../../ref/templates/api/#django.template.Context" title="django.template.Context"><code class="xref py py-class docutils literal"><span class="pre">django.template.Context</span></code></a> as an argument while the latter expects a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.5)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a>. This change is enforced through a deprecation path for Django
templates.</p>
<p>Since it’s easier to understand with examples, the <a class="reference internal" href="../../ref/templates/upgrading/#get-template-upgrade-django-18"><span>upgrade guide</span></a> shows how to adapt affected code.</p>
<p>All this also applies to <a class="reference internal" href="../../topics/templates/#django.template.loader.select_template" title="django.template.loader.select_template"><code class="xref py py-func docutils literal"><span class="pre">select_template()</span></code></a>.</p>
</div>
<div class="section" id="s-template-and-context-classes-in-template-responses">
<span id="template-and-context-classes-in-template-responses"/><h3><a class="reference internal" href="../../ref/templates/api/#django.template.Template" title="django.template.Template"><code class="xref py py-class docutils literal"><span class="pre">Template</span></code></a> and <a class="reference internal" href="../../ref/templates/api/#django.template.Context" title="django.template.Context"><code class="xref py py-class docutils literal"><span class="pre">Context</span></code></a> classes in template responses<a class="headerlink" href="#template-and-context-classes-in-template-responses" title="Permalink to this headline">¶</a></h3>
<p>Some methods of <a class="reference internal" href="../../ref/template-response/#django.template.response.SimpleTemplateResponse" title="django.template.response.SimpleTemplateResponse"><code class="xref py py-class docutils literal"><span class="pre">SimpleTemplateResponse</span></code></a> and
<a class="reference internal" href="../../ref/template-response/#django.template.response.TemplateResponse" title="django.template.response.TemplateResponse"><code class="xref py py-class docutils literal"><span class="pre">TemplateResponse</span></code></a> accepted
<a class="reference internal" href="../../ref/templates/api/#django.template.Context" title="django.template.Context"><code class="xref py py-class docutils literal"><span class="pre">django.template.Context</span></code></a> and <a class="reference internal" href="../../ref/templates/api/#django.template.Template" title="django.template.Template"><code class="xref py py-class docutils literal"><span class="pre">django.template.Template</span></code></a> objects
as arguments. They should now receive <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.5)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> and backend-dependent
template objects respectively.</p>
<p>This also applies to the return types if you have subclassed either template
response class.</p>
<p>Check the <a class="reference internal" href="../../ref/template-response/"><em>template response API documentation</em></a>
for details.</p>
</div>

<div class="section" id="s-dictionary-and-context-instance-arguments-of-rendering-functions">
<span id="dictionary-and-context-instance-arguments-of-rendering-functions"/><h3><code class="docutils literal"><span class="pre">dictionary</span></code> and <code class="docutils literal"><span class="pre">context_instance</span></code> arguments of rendering functions<a class="headerlink" href="#dictionary-and-context-instance-arguments-of-rendering-functions" title="Permalink to this headline">¶</a></h3>
<p>The following functions will no longer accept the <code class="docutils literal"><span class="pre">dictionary</span></code> and
<code class="docutils literal"><span class="pre">context_instance</span></code> parameters in Django 1.10:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">django.shortcuts.render()</span></code></li>
<li><code class="docutils literal"><span class="pre">django.shortcuts.render_to_response()</span></code></li>
<li><code class="docutils literal"><span class="pre">django.template.loader.render_to_string()</span></code></li>
</ul>
<p>Use the <code class="docutils literal"><span class="pre">context</span></code> parameter instead. When <code class="docutils literal"><span class="pre">dictionary</span></code> is passed as a
positional argument, which is the most common idiom, no changes are needed.</p>
<p>If you’re passing a <a class="reference internal" href="../../ref/templates/api/#django.template.Context" title="django.template.Context"><code class="xref py py-class docutils literal"><span class="pre">Context</span></code></a> in <code class="docutils literal"><span class="pre">context_instance</span></code>,
pass a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.5)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> in the <code class="docutils literal"><span class="pre">context</span></code> parameter instead. If you’re passing a
<a class="reference internal" href="../../ref/templates/api/#django.template.RequestContext" title="django.template.RequestContext"><code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code></a>, pass the request separately in the
<code class="docutils literal"><span class="pre">request</span></code> parameter.</p>
<p>If you’re using <code class="docutils literal"><span class="pre">context_instance=RequestContext(request))</span></code> with
<code class="docutils literal"><span class="pre">render_to_response()</span></code>, use <a class="reference internal" href="../../topics/http/shortcuts/#django.shortcuts.render" title="django.shortcuts.render"><code class="xref py py-func docutils literal"><span class="pre">django.shortcuts.render()</span></code></a>, which always
makes <code class="docutils literal"><span class="pre">RequestContext</span></code> available, instead. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render_to_response</span>
<span class="kn">from</span> <span class="nn">django.template</span> <span class="kn">import</span> <span class="n">RequestContext</span>
<span class="n">render_to_response</span><span class="p">(</span><span class="s1">'template.html'</span><span class="p">,</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span> <span class="n">context_instance</span><span class="o">=</span><span class="n">RequestContext</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<p>becomes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'template.html'</span><span class="p">,</span> <span class="p">{</span><span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="s-dirs-argument-of-template-finding-functions">
<span id="dirs-argument-of-template-finding-functions"/><h3><code class="docutils literal"><span class="pre">dirs</span></code> argument of template-finding functions<a class="headerlink" href="#dirs-argument-of-template-finding-functions" title="Permalink to this headline">¶</a></h3>
<p>The following functions will no longer accept a <code class="docutils literal"><span class="pre">dirs</span></code> parameter to override
<code class="docutils literal"><span class="pre">TEMPLATE_DIRS</span></code> in Django 1.10:</p>

<p>The parameter didn’t work consistently across different template loaders and
didn’t work for included templates.</p>
</div>
<div class="section" id="s-django-template-loader-baseloader">
<span id="django-template-loader-baseloader"/><h3><code class="docutils literal"><span class="pre">django.template.loader.BaseLoader</span></code><a class="headerlink" href="#django-template-loader-baseloader" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">django.template.loader.BaseLoader</span></code> was renamed to
<code class="docutils literal"><span class="pre">django.template.loaders.base.Loader</span></code>. If you’ve written a custom template
loader that inherits <code class="docutils literal"><span class="pre">BaseLoader</span></code>, you must inherit <code class="docutils literal"><span class="pre">Loader</span></code> instead.</p>
</div>
<div class="section" id="s-django-test-utils-testtemplateloader">
<span id="django-test-utils-testtemplateloader"/><h3><code class="docutils literal"><span class="pre">django.test.utils.TestTemplateLoader</span></code><a class="headerlink" href="#django-test-utils-testtemplateloader" title="Permalink to this headline">¶</a></h3>
<p>Private API <code class="docutils literal"><span class="pre">django.test.utils.TestTemplateLoader</span></code> is deprecated in favor of
<code class="docutils literal"><span class="pre">django.template.loaders.locmem.Loader</span></code> and will be removed in Django 1.9.</p>
</div>
<div class="section" id="s-support-for-the-max-length-argument-on-custom-storage-classes">
<span id="s-storage-max-length-update"/><span id="support-for-the-max-length-argument-on-custom-storage-classes"/><span id="storage-max-length-update"/><h3>Support for the <code class="docutils literal"><span class="pre">max_length</span></code> argument on custom <code class="docutils literal"><span class="pre">Storage</span></code> classes<a class="headerlink" href="#support-for-the-max-length-argument-on-custom-storage-classes" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">Storage</span></code> subclasses should add <code class="docutils literal"><span class="pre">max_length=None</span></code> as a parameter to
<a class="reference internal" href="../../ref/files/storage/#django.core.files.storage.Storage.get_available_name" title="django.core.files.storage.Storage.get_available_name"><code class="xref py py-meth docutils literal"><span class="pre">get_available_name()</span></code></a> and/or
<a class="reference internal" href="../../ref/files/storage/#django.core.files.storage.Storage.save" title="django.core.files.storage.Storage.save"><code class="xref py py-meth docutils literal"><span class="pre">save()</span></code></a> if they override either method.
Support for storages that do not accept this argument will be removed in
Django 1.10.</p>
</div>
<div class="section" id="s-qn-replaced-by-compiler">
<span id="qn-replaced-by-compiler"/><h3><code class="docutils literal"><span class="pre">qn</span></code> replaced by <code class="docutils literal"><span class="pre">compiler</span></code><a class="headerlink" href="#qn-replaced-by-compiler" title="Permalink to this headline">¶</a></h3>
<p>In previous Django versions, various internal ORM methods (mostly <code class="docutils literal"><span class="pre">as_sql</span></code>
methods) accepted a <code class="docutils literal"><span class="pre">qn</span></code> (for “quote name”) argument, which was a reference
to a function that quoted identifiers for sending to the database. In Django
1.8, that argument has been renamed to <code class="docutils literal"><span class="pre">compiler</span></code> and is now a full
<code class="docutils literal"><span class="pre">SQLCompiler</span></code> instance. For backwards-compatibility, calling a
<code class="docutils literal"><span class="pre">SQLCompiler</span></code> instance performs the same name-quoting that the <code class="docutils literal"><span class="pre">qn</span></code>
function used to. However, this backwards-compatibility shim is immediately
deprecated: you should rename your <code class="docutils literal"><span class="pre">qn</span></code> arguments to <code class="docutils literal"><span class="pre">compiler</span></code>, and call
<code class="docutils literal"><span class="pre">compiler.quote_name_unless_alias(...)</span></code> where you previously called
<code class="docutils literal"><span class="pre">qn(...)</span></code>.</p>
</div>
<div class="section" id="s-default-value-of-redirectview-permanent">
<span id="default-value-of-redirectview-permanent"/><h3>Default value of <code class="docutils literal"><span class="pre">RedirectView.permanent</span></code><a class="headerlink" href="#default-value-of-redirectview-permanent" title="Permalink to this headline">¶</a></h3>
<p>The default value of the
<a class="reference internal" href="../../ref/class-based-views/base/#django.views.generic.base.RedirectView.permanent" title="django.views.generic.base.RedirectView.permanent"><code class="xref py py-attr docutils literal"><span class="pre">RedirectView.permanent</span></code></a>
attribute will change from <code class="docutils literal"><span class="pre">True</span></code> to <code class="docutils literal"><span class="pre">False</span></code> in Django 1.9.</p>
</div>
<div class="section" id="s-using-authenticationmiddleware-without-sessionauthenticationmiddleware">
<span id="using-authenticationmiddleware-without-sessionauthenticationmiddleware"/><h3>Using <code class="docutils literal"><span class="pre">AuthenticationMiddleware</span></code> without <code class="docutils literal"><span class="pre">SessionAuthenticationMiddleware</span></code><a class="headerlink" href="#using-authenticationmiddleware-without-sessionauthenticationmiddleware" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../../ref/middleware/#django.contrib.auth.middleware.SessionAuthenticationMiddleware" title="django.contrib.auth.middleware.SessionAuthenticationMiddleware"><code class="xref py py-class docutils literal"><span class="pre">django.contrib.auth.middleware.SessionAuthenticationMiddleware</span></code></a> was
added in Django 1.7. In Django 1.7.2, its functionality was moved to
<code class="docutils literal"><span class="pre">auth.get_user()</span></code> and, for backwards compatibility, enabled only if
<code class="docutils literal"><span class="pre">'django.contrib.auth.middleware.SessionAuthenticationMiddleware'</span></code> appears in
<a class="reference internal" href="../../ref/settings/#std:setting-MIDDLEWARE_CLASSES"><code class="xref std std-setting docutils literal"><span class="pre">MIDDLEWARE_CLASSES</span></code></a>.</p>
<p>In Django 1.10, session verification will be enabled regardless of whether or not
<code class="docutils literal"><span class="pre">SessionAuthenticationMiddleware</span></code> is enabled (at which point
<code class="docutils literal"><span class="pre">SessionAuthenticationMiddleware</span></code> will have no significance). You can add it
to your <code class="docutils literal"><span class="pre">MIDDLEWARE_CLASSES</span></code> sometime before then to opt-in. Please read the
<a class="reference internal" href="../../topics/auth/default/#session-invalidation-on-password-change"><span>upgrade considerations</span></a> first.</p>
</div>
<div class="section" id="s-django-contrib-sitemaps-flatpagesitemap">
<span id="django-contrib-sitemaps-flatpagesitemap"/><h3><code class="docutils literal"><span class="pre">django.contrib.sitemaps.FlatPageSitemap</span></code><a class="headerlink" href="#django-contrib-sitemaps-flatpagesitemap" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">django.contrib.sitemaps.FlatPageSitemap</span></code> has moved to
<code class="docutils literal"><span class="pre">django.contrib.flatpages.sitemaps.FlatPageSitemap</span></code>. The old import location
is deprecated and will be removed in Django 1.9.</p>
</div>

<div class="section" id="s-ssi-template-tag">
<span id="ssi-template-tag"/><h3><code class="docutils literal"><span class="pre">ssi</span></code> template tag<a class="headerlink" href="#ssi-template-tag" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../ref/templates/builtins/#std:templatetag-ssi"><code class="xref std std-ttag docutils literal"><span class="pre">ssi</span></code></a> template tag allows files to be included in a template by
absolute path. This is of limited use in most deployment situations, and
the <a class="reference internal" href="../../ref/templates/builtins/#std:templatetag-include"><code class="xref std std-ttag docutils literal"><span class="pre">include</span></code></a> tag often makes more sense. This tag is now deprecated and
will be removed in Django 1.10.</p>
</div>
<div class="section" id="s-as-comparison-operator-in-if-template-tag">
<span id="as-comparison-operator-in-if-template-tag"/><h3><code class="docutils literal"><span class="pre">=</span></code> as comparison operator in <code class="docutils literal"><span class="pre">if</span></code> template tag<a class="headerlink" href="#as-comparison-operator-in-if-template-tag" title="Permalink to this headline">¶</a></h3>
<p>Using a single equals sign with the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">if</span> <span class="pre">%}</span></code> template tag for equality
testing was undocumented and untested. It’s now deprecated in favor of <code class="docutils literal"><span class="pre">==</span></code>.</p>
</div>
<div class="section" id="s-foo-s-syntax-in-modelformmixin-success-url">
<span id="foo-s-syntax-in-modelformmixin-success-url"/><h3><code class="docutils literal"><span class="pre">%(&lt;foo&gt;)s</span></code> syntax in <code class="docutils literal"><span class="pre">ModelFormMixin.success_url</span></code><a class="headerlink" href="#foo-s-syntax-in-modelformmixin-success-url" title="Permalink to this headline">¶</a></h3>
<p>The legacy <code class="docutils literal"><span class="pre">%(&lt;foo&gt;)s</span></code> syntax in <a class="reference internal" href="../../ref/class-based-views/mixins-editing/#django.views.generic.edit.ModelFormMixin.success_url" title="django.views.generic.edit.ModelFormMixin.success_url"><code class="xref py py-attr docutils literal"><span class="pre">ModelFormMixin.success_url</span></code></a> is deprecated and
will be removed in Django 1.10.</p>
</div>
<div class="section" id="s-geoqueryset-aggregate-methods">
<span id="geoqueryset-aggregate-methods"/><h3><code class="docutils literal"><span class="pre">GeoQuerySet</span></code> aggregate methods<a class="headerlink" href="#geoqueryset-aggregate-methods" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">collect()</span></code>, <code class="docutils literal"><span class="pre">extent()</span></code>, <code class="docutils literal"><span class="pre">extent3d()</span></code>, <code class="docutils literal"><span class="pre">make_line()</span></code>, and
<code class="docutils literal"><span class="pre">unionagg()</span></code> aggregate methods are deprecated and should be replaced by their
function-based aggregate equivalents (<code class="docutils literal"><span class="pre">Collect</span></code>, <code class="docutils literal"><span class="pre">Extent</span></code>, <code class="docutils literal"><span class="pre">Extent3D</span></code>,
<code class="docutils literal"><span class="pre">MakeLine</span></code>, and <code class="docutils literal"><span class="pre">Union</span></code>).</p>
</div>
<div class="section" id="s-signature-of-the-allow-migrate-router-method">
<span id="s-deprecated-signature-of-allow-migrate"/><span id="signature-of-the-allow-migrate-router-method"/><span id="deprecated-signature-of-allow-migrate"/><h3>Signature of the <code class="docutils literal"><span class="pre">allow_migrate</span></code> router method<a class="headerlink" href="#signature-of-the-allow-migrate-router-method" title="Permalink to this headline">¶</a></h3>
<p>The signature of the <a class="reference internal" href="../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal"><span class="pre">allow_migrate()</span></code></a> method of database routers has
changed from <code class="docutils literal"><span class="pre">allow_migrate(db,</span> <span class="pre">model)</span></code> to
<code class="docutils literal"><span class="pre">allow_migrate(db,</span> <span class="pre">app_label,</span> <span class="pre">model_name=None,</span> <span class="pre">**hints)</span></code>.</p>
<p>When <code class="docutils literal"><span class="pre">model_name</span></code> is set, the value that was previously given through the
<code class="docutils literal"><span class="pre">model</span></code> positional argument may now be found inside the <code class="docutils literal"><span class="pre">hints</span></code> dictionary
under the key <code class="docutils literal"><span class="pre">'model'</span></code>.</p>
<p>After switching to the new signature the router will also be called by the
<a class="reference internal" href="../../ref/migration-operations/#django.db.migrations.operations.RunPython" title="django.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal"><span class="pre">RunPython</span></code></a> and
<a class="reference internal" href="../../ref/migration-operations/#django.db.migrations.operations.RunSQL" title="django.db.migrations.operations.RunSQL"><code class="xref py py-class docutils literal"><span class="pre">RunSQL</span></code></a> operations.</p>
</div>
</div>
</div></body></html>