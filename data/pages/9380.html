<html><body><div><div class="entry-content">
                    <p>Today I wanted to use the Django Class Based View (CBV) UpdateView but without a slug identifier in the URL. For example, instead of <tt class="docutils literal">/profiles/pydanny/</tt> I would go to <tt class="docutils literal"><span class="pre">/my-crazy-profile/</span></tt>. Also, I needed to force authentication.</p>
<p>I've done this with Django functional views a few times times, but today I did it in Django. This is what I did:</p>
<div class="section" id="added-django-braces-to-my-project">
<h2>1. Added django-braces to my project</h2>
<p><a class="reference external" href="https://twitter.com/kennethlove">Kenneth Love</a> and <a class="reference external" href="https://twitter.com/tehjones">Chris Jones</a>' awesome <a class="reference external" href="https://github.com/brack3t/django-braces/">django-braces</a> package has some very handy mixins for working with Django CBVs. Kenneth and Chris really understand CBVs, specifically on how to extend them, and have provided a bunch of really useful utility methods in the django-braces library. Yeah, I could figure this stuff out on my own, but since those guys already did the hard work I might as well just lean on them.</p>
<div class="highlight"><pre>pip install django-braces<span class="o">==</span>0.1.3
</pre></div>
<div class="highlight"><pre><span class="c"># settings.py</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
<span class="o">...</span>
<span class="s">'braces'</span><span class="p">,</span>
<span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="section" id="wrote-the-view">
<h2>2. Wrote the view</h2>
<p>Assuming a very simple profile Model and Form (which they weren't - but that's not what this post is about), this is how I implemented the view:</p>
<div class="highlight"><pre><span class="c"># profiles/views.py</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">UpdateView</span>

<span class="kn">from</span> <span class="nn">braces.views</span> <span class="kn">import</span> <span class="n">LoginRequiredMixin</span>  <span class="c"># handles authentication</span>

<span class="kn">from</span> <span class="nn">profiles.forms</span> <span class="kn">import</span> <span class="n">ProfileForm</span>
<span class="kn">from</span> <span class="nn">profiles.models</span> <span class="kn">import</span> <span class="n">Profile</span>

<span class="k">class</span> <span class="nc">ProfileUpdateView</span><span class="p">(</span><span class="n">LoginRequiredMixin</span><span class="p">,</span> <span class="n">UpdateView</span><span class="p">):</span>

    <span class="n">form_class</span> <span class="o">=</span> <span class="n">ProfileForm</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="s">"/my-crazy-profile/"</span>  <span class="c"># You should be using reverse here</span>

    <span class="k">def</span> <span class="nf">get_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Profile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="wrote-the-urlconf">
<h2>3. Wrote the URLconf</h2>
<p>The URL pretty much wrote itself:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls.defaults</span> <span class="kn">import</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">profiles</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">""</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s">r'^my-crazy-profile/$'</span><span class="p">,</span>
        <span class="n">view</span><span class="o">=</span><span class="n">views</span><span class="o">.</span><span class="n">ProfileUpdateView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s">'profile_update'</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="section" id="closing-thoughts">
<h2>Closing Thoughts</h2>
<p>For a while, I've used django-braces for anything that involves CBVs. I can't imagine working on projects using CBVs without them. In fact, some of the mixins such as <tt class="docutils literal">LoginRequiredMixin</tt> are things that I could argue ought to be in core Django.</p>
<p>This pattern really nails the sweet spot of Django CBVs. Thanks to the use of mixins and model forms, I get an amazing amount of stuff done in a 5 line CBV.</p>
</div>

                    
                </div>
                                </div></body></html>