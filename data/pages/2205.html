<html><body><div><div class="pf-content"><p>Today we will look at Tim Golden’s handy package, <a href="http://winshell.readthedocs.org/en/latest/" target="_blank">winshell</a>. The winshell package allows you to find special folders on Windows, create shortcuts easily, work with metadata via “structured storage”, use the Windows shell to accomplish file operations and work with the Windows Recycle Bin.</p>
<p>We will focus on the special folders, shortcuts and the Recycle bin functionality of winshell in this article.</p>
<p><span id="more-4447"/></p>
<hr/>
<h3>Getting Started</h3>
<p>
</p><p>The winshell package depends on having <a href="http://sourceforge.net/projects/pywin32/files/pywin32/" target="_blank">PyWin32</a> installed. Make sure you have that installed first. Once that’s done, you can install winshell using pip:</p>
<p><code><br/>
pip install winshell<br/>
</code></p>
<p>Now that you have winshell installed, we can continue.</p>
<hr/>
<h3>Accessing Special Folders</h3>
<p>
</p><p>The winshell package exposes access to the paths of special folders in Windows. The paths exposed are:</p>
<ul>
<li>application_data</li>
<li>favourites</li>
<li>bookmarks (alias of favourites)</li>
<li>start_menu</li>
<li>programs</li>
<li>startup</li>
<li>personal_folder</li>
<li>my_documents (alias of personal_folder)</li>
<li>recent</li>
<li>sendto</li>
</ul>
<p>Let’s look at a few examples:</p>
<pre class="python"><span>&gt;&gt;&gt;</span> <span>import</span> winshell
<span>&gt;&gt;&gt;</span> winshell.<span>application_data</span><span>(</span><span>)</span>
<span>'C:<span>\\</span>Users<span>\\</span>mdriscoll<span>\\</span>AppData<span>\\</span>Roaming'</span>
<span>&gt;&gt;&gt;</span> winshell.<span>desktop</span><span>(</span><span>)</span>
<span>'C:<span>\\</span>Users<span>\\</span>mdriscoll<span>\\</span>Desktop'</span>
<span>&gt;&gt;&gt;</span> winshell.<span>start_menu</span><span>(</span><span>)</span>
<span>'C:<span>\\</span>Users<span>\\</span>mdriscoll<span>\\</span>AppData<span>\\</span>Roaming<span>\\</span>Microsoft<span>\\</span>Windows<span>\\</span>Start Menu'</span></pre>
<p>This is pretty self-explanatory. Let’s take a look at one other related method that’s called <strong>folder</strong>. According to the documentation, it uses <em>either the CSIDL numeric constant or the corresponding name, eg “appdata” for CSIDL_APPDATA or “desktop” for CSIDL_DESKTOP</em>. Let’s look at a simple example:</p>
<pre class="python"><span>&gt;&gt;&gt;</span> <span>import</span> winshell
<span>&gt;&gt;&gt;</span> winshell.<span>folder</span><span>(</span><span>"desktop"</span><span>)</span>
<span>'C:<span>\\</span>Users<span>\\</span>mdriscoll<span>\\</span>Desktop'</span></pre>
<p>This uses some Windows internals that I’ve never even heard of. You will probably need to look up CSIDL numeric constants on MSDN to use this part of winshell effectively. Otherwise I would recommend just sticking with the previously mentioned functions.</p>
<hr/>
<h3>Working with Shortcuts</h3>
<p>
</p><p>You can use winshell to get information about shortcuts. Let’s take a look at an example where we look at a Google Chrome shortcut:</p>
<pre class="python"><span>&gt;&gt;&gt;</span> <span>import</span> winshell
<span>&gt;&gt;&gt;</span> <span>import</span> <span>os</span>
<span>&gt;&gt;&gt;</span> link_path = <span>os</span>.<span>path</span>.<span>join</span><span>(</span>winshell.<span>desktop</span><span>(</span><span>)</span>, <span>"Google Chrome.lnk"</span><span>)</span>
<span>&gt;&gt;&gt;</span> sh = winshell.<span>shortcut</span><span>(</span>link_path<span>)</span>
<span>&gt;&gt;&gt;</span> sh.<span>path</span>
<span>'C:<span>\\</span>Program Files<span>\\</span>Google<span>\\</span>Chrome<span>\\</span>Application<span>\\</span>chrome.exe'</span>
<span>&gt;&gt;&gt;</span> sh.<span>description</span>
<span>'Access the Internet'</span>
<span>&gt;&gt;&gt;</span> sh.<span>arguments</span>
<span>''</span></pre>
<p>This let’s us learn a bit about the shortcut’s properties. There are a bunch of other methods we could call as well. I recommend reading the full documentation to see what else you can do. Now let’s try creating a shortcut using winshell:</p>
<pre class="python"><span>&gt;&gt;&gt;</span> winshell.<span>CreateShortcut</span><span>(</span>
	Path=<span>os</span>.<span>path</span>.<span>join</span><span>(</span>winshell.<span>desktop</span><span>(</span><span>)</span>, <span>"Custom Python.lnk"</span><span>)</span>,
	Target=r<span>"c:<span>\p</span>ython34<span>\p</span>ython.exe"</span>,
	Icon=<span>(</span>r<span>"c:<span>\p</span>ython34<span>\p</span>ython.exe"</span>, <span>0</span><span>)</span>,
	Description=<span>"The Python Interpreter"</span><span>)</span></pre>
<p>If you’re a long time reader of this blog, you may recall that I actually wrote about <a href="http://www.blog.pythonlibrary.org/2008/05/16/create-a-shortcut-in-windows-using-winshell-or-pywin32/" target="_blank">creating shortcuts with winshell</a> several years ago. The functionality here isn’t really any different than it was before and is pretty self-explanatory. You might want to check out that old article though as it also shows how to create shortcuts using PyWin32 too.</p>
<hr/>
<h3>winshell and the Recycle Bin</h3>
<p>
</p><p>You can also use winshell to access the Windows Recycle Bin. Let’s see what you can do:</p>
<pre class="python"><span>&gt;&gt;&gt;</span> <span>import</span> winshell
<span>&gt;&gt;&gt;</span> recycle_bin = winshell.<span>recycle_bin</span><span>(</span><span>)</span>
<span>&gt;&gt;&gt;</span>
<span>&gt;&gt;&gt;</span> <span># undelete a file</span>
<span>&gt;&gt;&gt;</span> recycle_bin.<span>undelete</span><span>(</span>filepath<span>)</span>
<span>&gt;&gt;&gt;</span>
<span>&gt;&gt;&gt;</span> <span># empty the recycle bin</span>
<span>&gt;&gt;&gt;</span> recycle_bin.<span>empty</span><span>(</span>confirm=<span>False</span><span>)</span></pre>
<p>If you call the <strong>undelete</strong> method multiple times on the same path, you will undelete previous versions of the file that were deleted, if applicable. You can also empty the Recyle Bin via the <strong>empty</strong> method. There are also some undocumented methods, such as <strong>items</strong> or <strong>folders</strong> that appear to return a generator object that I assume you can iterate over to discover what all is currently in the Recycle Bin.</p>
<hr/>
<h3>Wrapping Up</h3>
<p>
</p><p>At this point, you should be able to use the winshell package pretty competently. You have just learned how to work with the Recycle Bin, read and write shortcuts and acquire special folders on Windows. I hope you have enjoyed this tutorial and can use it in your own code soon. </p>
</div>	</div></body></html>