<html><body><div><div class="post-text" itemprop="text">

<p>I am using </p>

<pre><code>install_requires = [str(ir.req) for ir in parse_requirements("requirements.txt", session=PipSession())]
</code></pre>

<p>with <code>pip install .</code>. However, this does not seem to work with a requirements.txt that looks like this:</p>

<pre><code>--trusted-host blah
--extra-index-url blah2
...
</code></pre>

<p>(support for --trusted-host was added in pip8.0.0). The install from blah fails because it complains about it not being an untrusted host as if it never processed the first line. </p>

<p>HOWEVER, <code>pip install -r requirements.txt</code> works perfectly, so these options are correct. </p>

<p>This means there is something <code>parse_requirements</code> is not doing. <strong>My question is</strong>: how do I fix or work around this using only <code>pip install .</code>? I could do something horrendous like:</p>

<pre><code>os.system(pip install -r requirements.txt)
setup(...
</code></pre>

<p>in the setup.py file. </p>

<p>The implicit coupling of requirements.txt and setup.py is confusing to me. Nothing in setup calls requirements.txt unless you explicitly parse requirements.txt yourself, yet requirements.txt is a very standard python convention. </p>

<p>EDIT: We are using tools (Cloudify and sometimes Chef) that execute a <code>pip install .</code>. We cannot change this. I have to get this working as a pippable package, with the --trusted-host and --extra-index-urls without using a pip.conf either. Currently we are doing the os.system trick. </p>
    </div>
    </div></body></html>