<html><body><div><div class="col-md-8">
          <h1>How to Provide Simple and Clean Global Configuration Variables in Python with YAML</h1>
<p>I really despise software that keeps its configuration in the syntax of the language in which the software is written - I’m looking at you, Drupal. Users should not need to know PHP, Python, or Ruby in order to customize settings. That’s why storing settings as YAML is vastly superior since it’s easy for humans to parse at a casual glance. So, what’s the best and most Pythonic way to provide settings globally across a project?</p>

<p>In Python projects, I always ran into a messy problem when trying to share keys and values from YAML across different modules.</p>

<p>An example <code class="highlighter-rouge">settings.yaml</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>jenkins:
  host: http://jenkins.example.com
  user: donny
  token: I@m7h3W4lrU$
db:
  host: http://mysql.example.com
  user: lebowski
repo: /path/to/directory
require:
- ldap
- php
- zip
</code></pre>
</div>

<p>Together with that YAML dictionary, my first attempt ended up looking something like:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">config</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s">"settings.yaml"</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">some_function</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"foo"</span><span class="p">,</span> <span class="n">expire</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span>

<span class="n">some_other_function</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s">"repo"</span><span class="p">],</span> <span class="n">pkg</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s">"require"</span><span class="p">][</span><span class="s">"ldap"</span><span class="p">])</span></code></pre></figure>

<p>So each time some function needed some values from settings, I ended up passing either multiple arguments or the entire dictionary. This added extra arguments to every function in my code and it was quite ugly. Let’s keep it simple. So, I came up with a much, much cleaner and more Pythonic solution that retains the simplicity of YAML while also honoring <a href="//www.python.org/dev/peps/pep-0020">The Zen of Python</a>.</p>

<p>Create a file named <code class="highlighter-rouge">config.py</code> and place in it:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">yaml</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"settings.yaml"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></code></pre></figure>

<p>Now, everywhere else in your project you can simply import settings like:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">settings</span></code></pre></figure>

<p>That’s it - now your settings can be used anywhere without passing it around as an extra argument.</p>

<hr/>

<ins class="adsbygoogle" data-ad-client="ca-pub-8244598697443713" data-ad-slot="9961827581" data-ad-format="auto"/>

<p id="disqus_thread"/>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
        </div></body></html>