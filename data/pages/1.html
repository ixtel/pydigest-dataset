<html><body><div><p>This article explains the new features in Python 3.4, compared to 3.3.
Python 3.4 was released on March 16, 2014.  For full details, see the
<a class="reference external" href="https://docs.python.org/3.4/whatsnew/changelog.html">changelog</a>.</p>
<div class="section" id="improved-modules">
<h2>Improved Modules</h2>
<div class="section" id="abc">
<h3>abc</h3>
<p>New function <a class="reference internal" href="../library/abc.html#abc.get_cache_token" title="abc.get_cache_token"><code class="xref py py-func docutils literal"><span class="pre">abc.get_cache_token()</span></code></a> can be used to know when to invalidate
caches that are affected by changes in the object graph.  (Contributed
by Łukasz Langa in <a class="reference external" href="https://bugs.python.org/issue16832">issue 16832</a>.)</p>
<p>New class <a class="reference internal" href="../library/abc.html#abc.ABC" title="abc.ABC"><code class="xref py py-class docutils literal"><span class="pre">ABC</span></code></a> has <a class="reference internal" href="../library/abc.html#abc.ABCMeta" title="abc.ABCMeta"><code class="xref py py-class docutils literal"><span class="pre">ABCMeta</span></code></a> as its meta class.
Using <code class="docutils literal"><span class="pre">ABC</span></code> as a base class has essentially the same effect as specifying
<code class="docutils literal"><span class="pre">metaclass=abc.ABCMeta</span></code>, but is simpler to type and easier to read.
(Contributed by Bruno Dupuis in <a class="reference external" href="https://bugs.python.org/issue16049">issue 16049</a>.)</p>
</div>

<div class="section" id="argparse">
<h3>argparse</h3>
<p>The <a class="reference internal" href="../library/argparse.html#argparse.FileType" title="argparse.FileType"><code class="xref py py-class docutils literal"><span class="pre">FileType</span></code></a> class now accepts <em>encoding</em> and
<em>errors</em> arguments, which are passed through to <a class="reference internal" href="../library/functions.html#open" title="open"><code class="xref py py-func docutils literal"><span class="pre">open()</span></code></a>.  (Contributed
by Lucas Maystre in <a class="reference external" href="https://bugs.python.org/issue11175">issue 11175</a>.)</p>
</div>
<div class="section" id="audioop">
<h3>audioop</h3>
<p><a class="reference internal" href="../library/audioop.html#module-audioop" title="audioop: Manipulate raw audio data."><code class="xref py py-mod docutils literal"><span class="pre">audioop</span></code></a> now supports 24-bit samples.  (Contributed by Serhiy Storchaka
in <a class="reference external" href="https://bugs.python.org/issue12866">issue 12866</a>.)</p>
<p>New <a class="reference internal" href="../library/audioop.html#audioop.byteswap" title="audioop.byteswap"><code class="xref py py-func docutils literal"><span class="pre">byteswap()</span></code></a> function converts big-endian samples to
little-endian and vice versa.  (Contributed by Serhiy Storchaka in
<a class="reference external" href="https://bugs.python.org/issue19641">issue 19641</a>.)</p>
<p>All <a class="reference internal" href="../library/audioop.html#module-audioop" title="audioop: Manipulate raw audio data."><code class="xref py py-mod docutils literal"><span class="pre">audioop</span></code></a> functions now accept any <a class="reference internal" href="../glossary.html#term-bytes-like-object"><span class="xref std std-term">bytes-like object</span></a>.  Strings
are not accepted: they didn’t work before, now they raise an error right away.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue16685">issue 16685</a>.)</p>
</div>
<div class="section" id="base64">
<h3>base64</h3>
<p>The encoding and decoding functions in <a class="reference internal" href="../library/base64.html#module-base64" title="base64: RFC 3548: Base16, Base32, Base64 Data Encodings; Base85 and Ascii85"><code class="xref py py-mod docutils literal"><span class="pre">base64</span></code></a> now accept any
<a class="reference internal" href="../glossary.html#term-bytes-like-object"><span class="xref std std-term">bytes-like object</span></a> in cases where it previously required a
<a class="reference internal" href="../library/functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> or <a class="reference internal" href="../library/functions.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal"><span class="pre">bytearray</span></code></a> instance.  (Contributed by Nick Coghlan in
<a class="reference external" href="https://bugs.python.org/issue17839">issue 17839</a>.)</p>
<p>New functions <a class="reference internal" href="../library/base64.html#base64.a85encode" title="base64.a85encode"><code class="xref py py-func docutils literal"><span class="pre">a85encode()</span></code></a>, <a class="reference internal" href="../library/base64.html#base64.a85decode" title="base64.a85decode"><code class="xref py py-func docutils literal"><span class="pre">a85decode()</span></code></a>,
<a class="reference internal" href="../library/base64.html#base64.b85encode" title="base64.b85encode"><code class="xref py py-func docutils literal"><span class="pre">b85encode()</span></code></a>, and <a class="reference internal" href="../library/base64.html#base64.b85decode" title="base64.b85decode"><code class="xref py py-func docutils literal"><span class="pre">b85decode()</span></code></a> provide the ability to
encode and decode binary data from and to <code class="docutils literal"><span class="pre">Ascii85</span></code> and the git/mercurial
<code class="docutils literal"><span class="pre">Base85</span></code> formats, respectively.  The <code class="docutils literal"><span class="pre">a85</span></code> functions have options that can
be used to make them compatible with the variants of the <code class="docutils literal"><span class="pre">Ascii85</span></code> encoding,
including the Adobe variant.  (Contributed by Martin Morrison, the Mercurial
project, Serhiy Storchaka, and Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue17618">issue 17618</a>.)</p>
</div>
<div class="section" id="collections">
<h3>collections</h3>
<p>The <a class="reference internal" href="../library/collections.html#collections.ChainMap.new_child" title="collections.ChainMap.new_child"><code class="xref py py-meth docutils literal"><span class="pre">ChainMap.new_child()</span></code></a> method now accepts an <em>m</em> argument specifying
the child map to add to the chain.  This allows an existing mapping and/or a
custom mapping type to be used for the child.  (Contributed by Vinay Sajip in
<a class="reference external" href="https://bugs.python.org/issue16613">issue 16613</a>.)</p>
</div>
<div class="section" id="colorsys">
<h3>colorsys</h3>
<p>The number of digits in the coefficients for the RGB — YIQ conversions have
been expanded so that they match the FCC NTSC versions.  The change in
results should be less than 1% and may better match results found elsewhere.
(Contributed by Brian Landers and Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue14323">issue 14323</a>.)</p>
</div>
<div class="section" id="contextlib">
<h3>contextlib</h3>
<p>The new <a class="reference internal" href="../library/contextlib.html#contextlib.suppress" title="contextlib.suppress"><code class="xref py py-class docutils literal"><span class="pre">contextlib.suppress</span></code></a> context manager helps to clarify the
intent of code that deliberately suppresses exceptions from a single
statement.  (Contributed by Raymond Hettinger in <a class="reference external" href="https://bugs.python.org/issue15806">issue 15806</a> and
Zero Piraeus in <a class="reference external" href="https://bugs.python.org/issue19266">issue 19266</a>.)</p>
<p>The new <a class="reference internal" href="../library/contextlib.html#contextlib.redirect_stdout" title="contextlib.redirect_stdout"><code class="xref py py-func docutils literal"><span class="pre">contextlib.redirect_stdout()</span></code></a> context manager makes it easier
for utility scripts to handle inflexible APIs that write their output to
<a class="reference internal" href="../library/sys.html#sys.stdout" title="sys.stdout"><code class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></code></a> and don’t provide any options to redirect it.  Using the
context manager, the <a class="reference internal" href="../library/sys.html#sys.stdout" title="sys.stdout"><code class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></code></a> output can be redirected to any
other stream or, in conjunction with <a class="reference internal" href="../library/io.html#io.StringIO" title="io.StringIO"><code class="xref py py-class docutils literal"><span class="pre">io.StringIO</span></code></a>, to a string.
The latter can be especially useful, for example, to capture output
from a function that was written to implement a command line interface.
It is recommended only for utility scripts because it affects the
global state of <a class="reference internal" href="../library/sys.html#sys.stdout" title="sys.stdout"><code class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></code></a>.  (Contributed by Raymond Hettinger
in <a class="reference external" href="https://bugs.python.org/issue15805">issue 15805</a>.)</p>
<p>The <a class="reference internal" href="../library/contextlib.html#module-contextlib" title="contextlib: Utilities for with-statement contexts."><code class="xref py py-mod docutils literal"><span class="pre">contextlib</span></code></a> documentation has also been updated to include a
<a class="reference internal" href="../library/contextlib.html#single-use-reusable-and-reentrant-cms"><span>discussion</span></a> of the
differences between single use, reusable and reentrant context managers.</p>
</div>
<div class="section" id="dbm">
<h3>dbm</h3>
<p><a class="reference internal" href="../library/dbm.html#dbm.open" title="dbm.open"><code class="xref py py-func docutils literal"><span class="pre">dbm.open()</span></code></a> objects now support the context management protocol.  When
used in a <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal"><span class="pre">with</span></code></a> statement, the <code class="docutils literal"><span class="pre">close</span></code> method of the database
object will be called automatically at the end of the block.  (Contributed by
Claudiu Popa and Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue19282">issue 19282</a>.)</p>
</div>
<div class="section" id="dis">
<h3>dis</h3>
<p>Functions <a class="reference internal" href="../library/dis.html#dis.show_code" title="dis.show_code"><code class="xref py py-func docutils literal"><span class="pre">show_code()</span></code></a>, <a class="reference internal" href="../library/dis.html#dis.dis" title="dis.dis"><code class="xref py py-func docutils literal"><span class="pre">dis()</span></code></a>, <a class="reference internal" href="../library/dis.html#dis.distb" title="dis.distb"><code class="xref py py-func docutils literal"><span class="pre">distb()</span></code></a>, and
<a class="reference internal" href="../library/dis.html#dis.disassemble" title="dis.disassemble"><code class="xref py py-func docutils literal"><span class="pre">disassemble()</span></code></a> now accept a keyword-only <em>file</em> argument that
controls where they write their output.</p>
<p>The <a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><code class="xref py py-mod docutils literal"><span class="pre">dis</span></code></a> module is now built around an <a class="reference internal" href="../library/dis.html#dis.Instruction" title="dis.Instruction"><code class="xref py py-class docutils literal"><span class="pre">Instruction</span></code></a> class
that provides object oriented access to the details of each individual bytecode
operation.</p>
<p>A new method, <a class="reference internal" href="../library/dis.html#dis.get_instructions" title="dis.get_instructions"><code class="xref py py-func docutils literal"><span class="pre">get_instructions()</span></code></a>, provides an iterator that emits
the Instruction stream for a given piece of Python code.  Thus it is now
possible to write a program that inspects and manipulates a bytecode
object in ways different from those provided by the <a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><code class="xref py py-mod docutils literal"><span class="pre">dis</span></code></a> module
itself.  For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span/><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">dis</span><span class="o">.</span><span class="n">get_instructions</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">opname</span><span class="p">)</span>
<span class="go">LOAD_FAST</span>
<span class="go">LOAD_CONST</span>
<span class="go">BINARY_ADD</span>
<span class="go">RETURN_VALUE</span>
</pre></div>
</div>
<p>The various display tools in the <a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><code class="xref py py-mod docutils literal"><span class="pre">dis</span></code></a> module have been rewritten to use
these new components.</p>
<p>In addition, a new application-friendly class <a class="reference internal" href="../library/dis.html#dis.Bytecode" title="dis.Bytecode"><code class="xref py py-class docutils literal"><span class="pre">Bytecode</span></code></a> provides
an object-oriented API for inspecting bytecode in both in human-readable form
and for iterating over instructions.  The <a class="reference internal" href="../library/dis.html#dis.Bytecode" title="dis.Bytecode"><code class="xref py py-class docutils literal"><span class="pre">Bytecode</span></code></a> constructor
takes the same arguments that <code class="xref py py-func docutils literal"><span class="pre">get_instruction()</span></code> does (plus an
optional <em>current_offset</em>), and the resulting object can be iterated to produce
<a class="reference internal" href="../library/dis.html#dis.Instruction" title="dis.Instruction"><code class="xref py py-class docutils literal"><span class="pre">Instruction</span></code></a> objects.  But it also has a <a class="reference internal" href="../library/dis.html#dis.Bytecode.dis" title="dis.Bytecode.dis"><code class="xref py py-mod docutils literal"><span class="pre">dis</span></code></a>
method, equivalent to calling <a class="reference internal" href="../library/dis.html#dis.dis" title="dis.dis"><code class="xref py py-mod docutils literal"><span class="pre">dis</span></code></a> on the constructor argument, but
returned as a multi-line string:</p>
<div class="highlight-python3"><div class="highlight"><pre><span/><span class="gp">&gt;&gt;&gt; </span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="n">Bytecode</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">current_offset</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">bytecode</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">opname</span><span class="p">,</span> <span class="n">instr</span><span class="o">.</span><span class="n">opcode</span><span class="p">))</span>
<span class="go">LOAD_FAST (124)</span>
<span class="go">LOAD_CONST (100)</span>
<span class="go">BINARY_ADD (23)</span>
<span class="go">RETURN_VALUE (83)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bytecode</span><span class="o">.</span><span class="n">dis</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>       
<span class="go">['  1           0 LOAD_FAST                0 (x)',</span>
<span class="go"> '      --&gt;     3 LOAD_CONST               1 (1)',</span>
<span class="go"> '              6 BINARY_ADD',</span>
<span class="go"> '              7 RETURN_VALUE']</span>
</pre></div>
</div>
<p><a class="reference internal" href="../library/dis.html#dis.Bytecode" title="dis.Bytecode"><code class="xref py py-class docutils literal"><span class="pre">Bytecode</span></code></a> also has a class method,
<a class="reference internal" href="../library/dis.html#dis.Bytecode.from_traceback" title="dis.Bytecode.from_traceback"><code class="xref py py-meth docutils literal"><span class="pre">from_traceback()</span></code></a>, that provides the ability to manipulate a
traceback (that is, <code class="docutils literal"><span class="pre">print(Bytecode.from_traceback(tb).dis())</span></code> is equivalent
to <code class="docutils literal"><span class="pre">distb(tb)</span></code>).</p>
<p>(Contributed by Nick Coghlan, Ryan Kelly and Thomas Kluyver in <a class="reference external" href="https://bugs.python.org/issue11816">issue 11816</a>
and Claudiu Popa in <a class="reference external" href="https://bugs.python.org/issue17916">issue 17916</a>.)</p>
<p>New function <a class="reference internal" href="../library/dis.html#dis.stack_effect" title="dis.stack_effect"><code class="xref py py-func docutils literal"><span class="pre">stack_effect()</span></code></a> computes the effect on the Python stack
of a given opcode and argument, information that is not otherwise available.
(Contributed by Larry Hastings in <a class="reference external" href="https://bugs.python.org/issue19722">issue 19722</a>.)</p>
</div>
<div class="section" id="doctest">
<h3>doctest</h3>
<p>A new <a class="reference internal" href="../library/doctest.html#doctest-options"><span>option flag</span></a>, <a class="reference internal" href="../library/doctest.html#doctest.FAIL_FAST" title="doctest.FAIL_FAST"><code class="xref py py-data docutils literal"><span class="pre">FAIL_FAST</span></code></a>, halts
test running as soon as the first failure is detected.  (Contributed by R.
David Murray and Daniel Urban in <a class="reference external" href="https://bugs.python.org/issue16522">issue 16522</a>.)</p>
<p>The <a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal"><span class="pre">doctest</span></code></a> command line interface now uses <a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><code class="xref py py-mod docutils literal"><span class="pre">argparse</span></code></a>, and has two
new options, <code class="docutils literal"><span class="pre">-o</span></code> and <code class="docutils literal"><span class="pre">-f</span></code>.  <code class="docutils literal"><span class="pre">-o</span></code> allows <a class="reference internal" href="../library/doctest.html#doctest-options"><span>doctest options</span></a> to be specified on the command line, and <code class="docutils literal"><span class="pre">-f</span></code> is a
shorthand for <code class="docutils literal"><span class="pre">-o</span> <span class="pre">FAIL_FAST</span></code> (to parallel the similar option supported by the
<a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal"><span class="pre">unittest</span></code></a> CLI).  (Contributed by R. David Murray in <a class="reference external" href="https://bugs.python.org/issue11390">issue 11390</a>.)</p>
<p><a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal"><span class="pre">doctest</span></code></a> will now find doctests in extension module <code class="docutils literal"><span class="pre">__doc__</span></code> strings.
(Contributed by Zachary Ware in <a class="reference external" href="https://bugs.python.org/issue3158">issue 3158</a>.)</p>
</div>
<div class="section" id="email">
<h3>email</h3>
<p><a class="reference internal" href="../library/email.message.html#email.message.Message.as_string" title="email.message.Message.as_string"><code class="xref py py-meth docutils literal"><span class="pre">as_string()</span></code></a> now accepts a <em>policy</em> argument to
override the default policy of the message when generating a string
representation of it.  This means that <code class="docutils literal"><span class="pre">as_string</span></code> can now be used in more
circumstances, instead of having to create and use a <a class="reference internal" href="../library/email.generator.html#module-email.generator" title="email.generator: Generate flat text email messages from a message structure."><code class="xref py py-mod docutils literal"><span class="pre">generator</span></code></a> in
order to pass formatting parameters to its <code class="docutils literal"><span class="pre">flatten</span></code> method.  (Contributed by
R. David Murray in <a class="reference external" href="https://bugs.python.org/issue18600">issue 18600</a>.)</p>
<p>New method <a class="reference internal" href="../library/email.message.html#email.message.Message.as_bytes" title="email.message.Message.as_bytes"><code class="xref py py-meth docutils literal"><span class="pre">as_bytes()</span></code></a> added to produce a bytes
representation of the message in a fashion similar to how <code class="docutils literal"><span class="pre">as_string</span></code>
produces a string representation.  It does not accept the <em>maxheaderlen</em>
argument, but does accept the <em>unixfrom</em> and <em>policy</em> arguments. The
<a class="reference internal" href="../library/email.message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> <a class="reference internal" href="../library/email.message.html#email.message.Message.__bytes__" title="email.message.Message.__bytes__"><code class="xref py py-meth docutils literal"><span class="pre">__bytes__()</span></code></a> method
calls it, meaning that <code class="docutils literal"><span class="pre">bytes(mymsg)</span></code> will now produce the intuitive
result:  a bytes object containing the fully formatted message.  (Contributed
by R. David Murray in <a class="reference external" href="https://bugs.python.org/issue18600">issue 18600</a>.)</p>
<p>The <a class="reference internal" href="../library/email.message.html#email.message.Message.set_param" title="email.message.Message.set_param"><code class="xref py py-meth docutils literal"><span class="pre">Message.set_param()</span></code></a> message now accepts a <em>replace</em> keyword argument.
When specified, the associated header will be updated without changing
its location in the list of headers.  For backward compatibility, the default
is <code class="docutils literal"><span class="pre">False</span></code>.  (Contributed by R. David Murray in <a class="reference external" href="https://bugs.python.org/issue18891">issue 18891</a>.)</p>
<p id="whatsnew-email-contentmanager">A pair of new subclasses of <a class="reference internal" href="../library/email.message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> have been added
(<a class="reference internal" href="../library/email.contentmanager.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal"><span class="pre">EmailMessage</span></code></a> and <a class="reference internal" href="../library/email.contentmanager.html#email.message.MIMEPart" title="email.message.MIMEPart"><code class="xref py py-class docutils literal"><span class="pre">MIMEPart</span></code></a>), along with a new sub-module,
<a class="reference internal" href="../library/email.contentmanager.html#module-email.contentmanager" title="email.contentmanager: Storing and Retrieving Content from MIME Parts"><code class="xref py py-mod docutils literal"><span class="pre">contentmanager</span></code></a> and a new <a class="reference internal" href="../library/email.policy.html#module-email.policy" title="email.policy: Controlling the parsing and generating of messages"><code class="xref py py-mod docutils literal"><span class="pre">policy</span></code></a> attribute
<a class="reference internal" href="../library/email.policy.html#email.policy.EmailPolicy.content_manager" title="email.policy.EmailPolicy.content_manager"><code class="xref py py-attr docutils literal"><span class="pre">content_manager</span></code></a>.  All documentation is
currently in the new module, which is being added as part of email’s new
<a class="reference internal" href="../glossary.html#term-provisional-api"><span class="xref std std-term">provisional API</span></a>.  These classes provide a number of new methods that
make extracting content from and inserting content into email messages much
easier.  For details, see the <a class="reference internal" href="../library/email.contentmanager.html#module-email.contentmanager" title="email.contentmanager: Storing and Retrieving Content from MIME Parts"><code class="xref py py-mod docutils literal"><span class="pre">contentmanager</span></code></a> documentation and
the <a class="reference internal" href="../library/email-examples.html#email-contentmanager-api-examples"><span>Examples using the Provisional API</span></a>.  These API additions complete the
bulk of the work that was planned as part of the email6 project.  The currently
provisional API is scheduled to become final in Python 3.5 (possibly with a few
minor additions in the area of error handling).  (Contributed by R. David
Murray in <a class="reference external" href="https://bugs.python.org/issue18891">issue 18891</a>.)</p>
</div>
<div class="section" id="filecmp">
<h3>filecmp</h3>
<p>A new <a class="reference internal" href="../library/filecmp.html#filecmp.clear_cache" title="filecmp.clear_cache"><code class="xref py py-func docutils literal"><span class="pre">clear_cache()</span></code></a> function provides the ability to clear the
<a class="reference internal" href="../library/filecmp.html#module-filecmp" title="filecmp: Compare files efficiently."><code class="xref py py-mod docutils literal"><span class="pre">filecmp</span></code></a> comparison cache, which uses <a class="reference internal" href="../library/os.html#os.stat" title="os.stat"><code class="xref py py-func docutils literal"><span class="pre">os.stat()</span></code></a> information to
determine if the file has changed since the last compare.  This can be used,
for example, if the file might have been changed and re-checked in less time
than the resolution of a particular filesystem’s file modification time field.
(Contributed by Mark Levitt in <a class="reference external" href="https://bugs.python.org/issue18149">issue 18149</a>.)</p>
<p>New module attribute <a class="reference internal" href="../library/filecmp.html#filecmp.DEFAULT_IGNORES" title="filecmp.DEFAULT_IGNORES"><code class="xref py py-data docutils literal"><span class="pre">DEFAULT_IGNORES</span></code></a> provides the list of
directories that are used as the default value for the <em>ignore</em> parameter of
the <a class="reference internal" href="../library/filecmp.html#filecmp.dircmp" title="filecmp.dircmp"><code class="xref py py-func docutils literal"><span class="pre">dircmp()</span></code></a> function.  (Contributed by Eli Bendersky in
<a class="reference external" href="https://bugs.python.org/issue15442">issue 15442</a>.)</p>
</div>

<div class="section" id="gc">
<h3>gc</h3>
<p>New function <a class="reference internal" href="../library/gc.html#gc.get_stats" title="gc.get_stats"><code class="xref py py-func docutils literal"><span class="pre">get_stats()</span></code></a> returns a list of three per-generation
dictionaries containing the collections statistics since interpreter startup.
(Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue16351">issue 16351</a>.)</p>
</div>
<div class="section" id="glob">
<h3>glob</h3>
<p>A new function <a class="reference internal" href="../library/glob.html#glob.escape" title="glob.escape"><code class="xref py py-func docutils literal"><span class="pre">escape()</span></code></a> provides a way to escape special characters
in a filename so that they do not become part of the globbing expansion but are
instead matched literally.  (Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue8402">issue 8402</a>.)</p>
</div>

<div class="section" id="hmac">
<h3>hmac</h3>
<p><a class="reference internal" href="../library/hmac.html#module-hmac" title="hmac: Keyed-Hashing for Message Authentication (HMAC) implementation"><code class="xref py py-mod docutils literal"><span class="pre">hmac</span></code></a> now accepts <code class="docutils literal"><span class="pre">bytearray</span></code> as well as <code class="docutils literal"><span class="pre">bytes</span></code> for the <em>key</em>
argument to the <a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><code class="xref py py-func docutils literal"><span class="pre">new()</span></code></a> function, and the <em>msg</em> parameter to both the
<a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><code class="xref py py-func docutils literal"><span class="pre">new()</span></code></a> function and the <a class="reference internal" href="../library/hmac.html#hmac.HMAC.update" title="hmac.HMAC.update"><code class="xref py py-meth docutils literal"><span class="pre">update()</span></code></a> method now
accepts any type supported by the <a class="reference internal" href="../library/hashlib.html#module-hashlib" title="hashlib: Secure hash and message digest algorithms."><code class="xref py py-mod docutils literal"><span class="pre">hashlib</span></code></a> module.  (Contributed
by Jonas Borgström in <a class="reference external" href="https://bugs.python.org/issue18240">issue 18240</a>.)</p>
<p>The <em>digestmod</em> argument to the <a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><code class="xref py py-func docutils literal"><span class="pre">hmac.new()</span></code></a> function may now be any hash
digest name recognized by <a class="reference internal" href="../library/hashlib.html#module-hashlib" title="hashlib: Secure hash and message digest algorithms."><code class="xref py py-mod docutils literal"><span class="pre">hashlib</span></code></a>.  In addition, the current behavior in
which the value of <em>digestmod</em> defaults to <code class="docutils literal"><span class="pre">MD5</span></code> is deprecated: in a
future version of Python there will be no default value.  (Contributed by
Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue17276">issue 17276</a>.)</p>
<p>With the addition of <a class="reference internal" href="../library/hmac.html#hmac.HMAC.block_size" title="hmac.HMAC.block_size"><code class="xref py py-attr docutils literal"><span class="pre">block_size</span></code></a> and <a class="reference internal" href="../library/hmac.html#hmac.HMAC.name" title="hmac.HMAC.name"><code class="xref py py-attr docutils literal"><span class="pre">name</span></code></a>
attributes (and the formal documentation of the <a class="reference internal" href="../library/hmac.html#hmac.HMAC.digest_size" title="hmac.HMAC.digest_size"><code class="xref py py-attr docutils literal"><span class="pre">digest_size</span></code></a>
attribute), the <a class="reference internal" href="../library/hmac.html#module-hmac" title="hmac: Keyed-Hashing for Message Authentication (HMAC) implementation"><code class="xref py py-mod docutils literal"><span class="pre">hmac</span></code></a> module now conforms fully to the <span class="target" id="index-37"/><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0247"><strong>PEP 247</strong></a> API.
(Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue18775">issue 18775</a>.)</p>
</div>
<div class="section" id="html">
<h3>html</h3>
<p>New function <a class="reference internal" href="../library/html.html#html.unescape" title="html.unescape"><code class="xref py py-func docutils literal"><span class="pre">unescape()</span></code></a> function converts HTML5 character references to
the corresponding Unicode characters.  (Contributed by Ezio Melotti in
<a class="reference external" href="https://bugs.python.org/issue2927">issue 2927</a>.)</p>
<p><a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><code class="xref py py-class docutils literal"><span class="pre">HTMLParser</span></code></a> accepts a new keyword argument
<em>convert_charrefs</em> that, when <code class="docutils literal"><span class="pre">True</span></code>, automatically converts all character
references.  For backward-compatibility, its value defaults to <code class="docutils literal"><span class="pre">False</span></code>, but
it will change to <code class="docutils literal"><span class="pre">True</span></code> in a future version of Python, so you are invited to
set it explicitly and update your code to use this new feature.  (Contributed
by Ezio Melotti in <a class="reference external" href="https://bugs.python.org/issue13633">issue 13633</a>.)</p>
<p>The <em>strict</em> argument of <a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><code class="xref py py-class docutils literal"><span class="pre">HTMLParser</span></code></a> is now deprecated.
(Contributed by Ezio Melotti in <a class="reference external" href="https://bugs.python.org/issue15114">issue 15114</a>.)</p>
</div>
<div class="section" id="http">
<h3>http</h3>
<p><a class="reference internal" href="../library/http.server.html#http.server.BaseHTTPRequestHandler.send_error" title="http.server.BaseHTTPRequestHandler.send_error"><code class="xref py py-meth docutils literal"><span class="pre">send_error()</span></code></a> now accepts an
optional additional <em>explain</em> parameter which can be used to provide an
extended error description, overriding the hardcoded default if there is one.
This extended error description will be formatted using the
<code class="xref py py-attr docutils literal"><span class="pre">error_message_format</span></code> attribute and sent as the body
of the error response.  (Contributed by Karl Cow in <a class="reference external" href="https://bugs.python.org/issue12921">issue 12921</a>.)</p>
<p>The <a class="reference internal" href="../library/http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal"><span class="pre">http.server</span></code></a> <a class="reference internal" href="../library/http.server.html#http-server-cli"><span>command line interface</span></a> now has
a <code class="docutils literal"><span class="pre">-b/--bind</span></code> option that causes the server to listen on a specific address.
(Contributed by Malte Swart in <a class="reference external" href="https://bugs.python.org/issue17764">issue 17764</a>.)</p>
</div>
<div class="section" id="idlelib-and-idle">
<h3>idlelib and IDLE</h3>
<p>Since idlelib implements the IDLE shell and editor and is not intended for
import by other programs, it gets improvements with every release. See
<code class="file docutils literal"><span class="pre">Lib/idlelib/NEWS.txt</span></code> for a cumulative list of changes since 3.3.0,
as well as changes made in future 3.4.x releases. This file is also available
from the IDLE  dialog.</p>
</div>

<div class="section" id="inspect">
<h3>inspect</h3>
<p>The <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><code class="xref py py-mod docutils literal"><span class="pre">inspect</span></code></a> module now offers a basic <a class="reference internal" href="../library/inspect.html#inspect-module-cli"><span>command line interface</span></a> to quickly display source code and other
information for modules, classes and functions.  (Contributed by Claudiu Popa
and Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue18626">issue 18626</a>.)</p>
<p><a class="reference internal" href="../library/inspect.html#inspect.unwrap" title="inspect.unwrap"><code class="xref py py-func docutils literal"><span class="pre">unwrap()</span></code></a> makes it easy to unravel wrapper function chains
created by <a class="reference internal" href="../library/functools.html#functools.wraps" title="functools.wraps"><code class="xref py py-func docutils literal"><span class="pre">functools.wraps()</span></code></a> (and any other API that sets the
<code class="docutils literal"><span class="pre">__wrapped__</span></code> attribute on a wrapper function).  (Contributed by
Daniel Urban, Aaron Iles and Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue13266">issue 13266</a>.)</p>
<p>As part of the implementation of the new <a class="reference internal" href="../library/enum.html#module-enum" title="enum: Implementation of an enumeration class."><code class="xref py py-mod docutils literal"><span class="pre">enum</span></code></a> module, the
<a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><code class="xref py py-mod docutils literal"><span class="pre">inspect</span></code></a> module now has substantially better support for custom
<code class="docutils literal"><span class="pre">__dir__</span></code> methods and dynamic class attributes provided through
metaclasses.  (Contributed by Ethan Furman in <a class="reference external" href="https://bugs.python.org/issue18929">issue 18929</a> and
<a class="reference external" href="https://bugs.python.org/issue19030">issue 19030</a>.)</p>
<p><a class="reference internal" href="../library/inspect.html#inspect.getfullargspec" title="inspect.getfullargspec"><code class="xref py py-func docutils literal"><span class="pre">getfullargspec()</span></code></a> and <a class="reference internal" href="../library/inspect.html#inspect.getargspec" title="inspect.getargspec"><code class="xref py py-func docutils literal"><span class="pre">getargspec()</span></code></a>
now use the <a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal"><span class="pre">signature()</span></code></a> API. This allows them to
support a much broader range of callables, including those with
<code class="docutils literal"><span class="pre">__signature__</span></code> attributes, those with metadata provided by argument
clinic, <a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><code class="xref py py-func docutils literal"><span class="pre">functools.partial()</span></code></a> objects and more. Note that, unlike
<a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal"><span class="pre">signature()</span></code></a>, these functions still ignore <code class="docutils literal"><span class="pre">__wrapped__</span></code>
attributes, and report the already bound first argument for bound methods,
so it is still necessary to update your code to use
<a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal"><span class="pre">signature()</span></code></a> directly if those features are desired.
(Contributed by Yury Selivanov in <a class="reference external" href="https://bugs.python.org/issue17481">issue 17481</a>.)</p>
<p><a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal"><span class="pre">signature()</span></code></a> now supports duck types of CPython functions,
which adds support for functions compiled with Cython.  (Contributed
by Stefan Behnel and Yury Selivanov in <a class="reference external" href="https://bugs.python.org/issue17159">issue 17159</a>.)</p>
</div>
<div class="section" id="ipaddress">
<h3>ipaddress</h3>
<p><a class="reference internal" href="../library/ipaddress.html#module-ipaddress" title="ipaddress: IPv4/IPv6 manipulation library."><code class="xref py py-mod docutils literal"><span class="pre">ipaddress</span></code></a> was added to the standard library in Python 3.3 as a
<a class="reference internal" href="../glossary.html#term-provisional-api"><span class="xref std std-term">provisional API</span></a>. With the release of Python 3.4, this qualification
has been removed: <a class="reference internal" href="../library/ipaddress.html#module-ipaddress" title="ipaddress: IPv4/IPv6 manipulation library."><code class="xref py py-mod docutils literal"><span class="pre">ipaddress</span></code></a> is now considered a stable API, covered
by the normal standard library requirements to maintain backwards
compatibility.</p>
<p>A new <a class="reference internal" href="../library/ipaddress.html#ipaddress.IPv4Address.is_global" title="ipaddress.IPv4Address.is_global"><code class="xref py py-attr docutils literal"><span class="pre">is_global</span></code></a> property is <code class="docutils literal"><span class="pre">True</span></code> if
an address is globally routeable.  (Contributed by Peter Moody in
<a class="reference external" href="https://bugs.python.org/issue17400">issue 17400</a>.)</p>
</div>
<div class="section" id="logging">
<h3>logging</h3>
<p>The <a class="reference internal" href="../library/logging.handlers.html#logging.handlers.TimedRotatingFileHandler" title="logging.handlers.TimedRotatingFileHandler"><code class="xref py py-class docutils literal"><span class="pre">TimedRotatingFileHandler</span></code></a> has a new <em>atTime</em>
parameter that can be used to specify the time of day when rollover should
happen.  (Contributed by Ronald Oussoren in <a class="reference external" href="https://bugs.python.org/issue9556">issue 9556</a>.)</p>
<p><a class="reference internal" href="../library/logging.handlers.html#logging.handlers.SocketHandler" title="logging.handlers.SocketHandler"><code class="xref py py-class docutils literal"><span class="pre">SocketHandler</span></code></a> and
<a class="reference internal" href="../library/logging.handlers.html#logging.handlers.DatagramHandler" title="logging.handlers.DatagramHandler"><code class="xref py py-class docutils literal"><span class="pre">DatagramHandler</span></code></a> now support Unix domain sockets (by
setting <em>port</em> to <code class="docutils literal"><span class="pre">None</span></code>).  (Contributed by Vinay Sajip in commit
ce46195b56a9.)</p>
<p><a class="reference internal" href="../library/logging.config.html#logging.config.fileConfig" title="logging.config.fileConfig"><code class="xref py py-func docutils literal"><span class="pre">fileConfig()</span></code></a> now accepts a
<a class="reference internal" href="../library/configparser.html#configparser.RawConfigParser" title="configparser.RawConfigParser"><code class="xref py py-class docutils literal"><span class="pre">configparser.RawConfigParser</span></code></a> subclass instance for the <em>fname</em>
parameter.  This facilitates using a configuration file when logging
configuration is just a part of the overall application configuration, or where
the application modifies the configuration before passing it to
<a class="reference internal" href="../library/logging.config.html#logging.config.fileConfig" title="logging.config.fileConfig"><code class="xref py py-func docutils literal"><span class="pre">fileConfig()</span></code></a>.  (Contributed by Vinay Sajip in
<a class="reference external" href="https://bugs.python.org/issue16110">issue 16110</a>.)</p>
<p>Logging configuration data received from a socket via the
<a class="reference internal" href="../library/logging.config.html#logging.config.listen" title="logging.config.listen"><code class="xref py py-func docutils literal"><span class="pre">logging.config.listen()</span></code></a> function can now be validated before being
processed by supplying a verification function as the argument to the new
<em>verify</em> keyword argument.  (Contributed by Vinay Sajip in <a class="reference external" href="https://bugs.python.org/issue15452">issue 15452</a>.)</p>
</div>
<div class="section" id="marshal">
<span id="whatsnew-marshal-3"/><h3>marshal</h3>
<p>The default <a class="reference internal" href="../library/marshal.html#module-marshal" title="marshal: Convert Python objects to streams of bytes and back (with different constraints)."><code class="xref py py-mod docutils literal"><span class="pre">marshal</span></code></a> version has been bumped to 3.  The code implementing
the new version restores the Python2 behavior of recording only one copy of
interned strings and preserving the interning on deserialization, and extends
this “one copy” ability to any object type (including handling recursive
references).  This reduces both the size of <code class="docutils literal"><span class="pre">.pyc</span></code> files and the amount of
memory a module occupies in memory when it is loaded from a <code class="docutils literal"><span class="pre">.pyc</span></code> (or
<code class="docutils literal"><span class="pre">.pyo</span></code>) file.  (Contributed by Kristján Valur Jónsson in <a class="reference external" href="https://bugs.python.org/issue16475">issue 16475</a>,
with additional speedups by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue19219">issue 19219</a>.)</p>
</div>
<div class="section" id="mmap">
<h3>mmap</h3>
<p>mmap objects can now be <a class="reference internal" href="../library/weakref.html#module-weakref" title="weakref: Support for weak references and weak dictionaries."><code class="xref py py-mod docutils literal"><span class="pre">weakref</span></code></a>ed.  (Contributed by Valerie Lambert in
<a class="reference external" href="https://bugs.python.org/issue4885">issue 4885</a>.)</p>
</div>
<div class="section" id="multiprocessing">
<h3>multiprocessing</h3>
<p id="whatsnew-multiprocessing-no-fork">On Unix two new <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-methods"><span>start methods</span></a>,
<code class="docutils literal"><span class="pre">spawn</span></code> and <code class="docutils literal"><span class="pre">forkserver</span></code>, have been added for starting processes using
<a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></code></a>.  These make the mixing of processes with threads more
robust, and the <code class="docutils literal"><span class="pre">spawn</span></code> method matches the semantics that multiprocessing has
always used on Windows.  New function
<a class="reference internal" href="../library/multiprocessing.html#multiprocessing.get_all_start_methods" title="multiprocessing.get_all_start_methods"><code class="xref py py-func docutils literal"><span class="pre">get_all_start_methods()</span></code></a> reports all start methods
available on the platform, <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.get_start_method" title="multiprocessing.get_start_method"><code class="xref py py-func docutils literal"><span class="pre">get_start_method()</span></code></a> reports
the current start method, and <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.set_start_method" title="multiprocessing.set_start_method"><code class="xref py py-func docutils literal"><span class="pre">set_start_method()</span></code></a> sets
the start method.  (Contributed by Richard Oudkerk in <a class="reference external" href="https://bugs.python.org/issue8713">issue 8713</a>.)</p>
<p><a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></code></a> also now has the concept of a <code class="docutils literal"><span class="pre">context</span></code>, which
determines how child processes are created.  New function
<a class="reference internal" href="../library/multiprocessing.html#multiprocessing.get_context" title="multiprocessing.get_context"><code class="xref py py-func docutils literal"><span class="pre">get_context()</span></code></a> returns a context that uses a specified
start method.  It has the same API as the <a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></code></a> module itself,
so you can use it to create <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.pool.Pool" title="multiprocessing.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>s and other
objects that will operate within that context.  This allows a framework and an
application or different parts of the same application to use multiprocessing
without interfering with each other.  (Contributed by Richard Oudkerk in
<a class="reference external" href="https://bugs.python.org/issue18999">issue 18999</a>.)</p>
<p>Except when using the old <em>fork</em> start method, child processes no longer
inherit unneeded handles/file descriptors from their parents (part of
<a class="reference external" href="https://bugs.python.org/issue8713">issue 8713</a>).</p>
<p><a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></code></a> now relies on <a class="reference internal" href="../library/runpy.html#module-runpy" title="runpy: Locate and run Python modules without importing them first."><code class="xref py py-mod docutils literal"><span class="pre">runpy</span></code></a> (which implements the
<code class="docutils literal"><span class="pre">-m</span></code> switch) to initialise <code class="docutils literal"><span class="pre">__main__</span></code> appropriately in child processes
when using the <code class="docutils literal"><span class="pre">spawn</span></code> or <code class="docutils literal"><span class="pre">forkserver</span></code> start methods. This resolves some
edge cases where combining multiprocessing, the <code class="docutils literal"><span class="pre">-m</span></code> command line switch,
and explicit relative imports could cause obscure failures in child
processes.  (Contributed by Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue19946">issue 19946</a>.)</p>
</div>
<div class="section" id="operator">
<h3>operator</h3>
<p>New function <a class="reference internal" href="../library/operator.html#operator.length_hint" title="operator.length_hint"><code class="xref py py-func docutils literal"><span class="pre">length_hint()</span></code></a> provides an implementation of the
specification for how the <a class="reference internal" href="../reference/datamodel.html#object.__length_hint__" title="object.__length_hint__"><code class="xref py py-meth docutils literal"><span class="pre">__length_hint__()</span></code></a> special method should
be used, as part of the <span class="target" id="index-38"/><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0424"><strong>PEP 424</strong></a> formal specification of this language
feature.  (Contributed by Armin Ronacher in <a class="reference external" href="https://bugs.python.org/issue16148">issue 16148</a>.)</p>
<p>There is now a pure-python version of the <a class="reference internal" href="../library/operator.html#module-operator" title="operator: Functions corresponding to the standard operators."><code class="xref py py-mod docutils literal"><span class="pre">operator</span></code></a> module available for
reference and for use by alternate implementations of Python.  (Contributed by
Zachary Ware in <a class="reference external" href="https://bugs.python.org/issue16694">issue 16694</a>.)</p>
</div>

<div class="section" id="pdb">
<h3>pdb</h3>
<p><a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal"><span class="pre">pdb</span></code></a> has been enhanced to handle generators, <a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal"><span class="pre">yield</span></code></a>, and
<code class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span></code> in a more useful fashion.  This is especially helpful when
debugging <a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O, event loop, coroutines and tasks."><code class="xref py py-mod docutils literal"><span class="pre">asyncio</span></code></a> based programs.  (Contributed by Andrew Svetlov and
Xavier de Gaye in <a class="reference external" href="https://bugs.python.org/issue16596">issue 16596</a>.)</p>
<p>The <code class="docutils literal"><span class="pre">print</span></code> command has been removed from <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal"><span class="pre">pdb</span></code></a>, restoring access to the
Python <a class="reference internal" href="../library/functions.html#print" title="print"><code class="xref py py-func docutils literal"><span class="pre">print()</span></code></a> function from the pdb command line.  Python2’s <code class="docutils literal"><span class="pre">pdb</span></code> did
not have a <code class="docutils literal"><span class="pre">print</span></code> command; instead, entering <code class="docutils literal"><span class="pre">print</span></code> executed the
<code class="docutils literal"><span class="pre">print</span></code> statement.  In Python3 <code class="docutils literal"><span class="pre">print</span></code> was mistakenly made an alias for the
pdb <a class="reference internal" href="../library/pdb.html#pdbcommand-p"><code class="xref std std-pdbcmd docutils literal"><span class="pre">p</span></code></a> command.  <code class="docutils literal"><span class="pre">p</span></code>, however, prints the <code class="docutils literal"><span class="pre">repr</span></code> of its argument,
not the <code class="docutils literal"><span class="pre">str</span></code> like the Python2 <code class="docutils literal"><span class="pre">print</span></code> command did.  Worse, the Python3
<code class="docutils literal"><span class="pre">pdb</span> <span class="pre">print</span></code> command shadowed the Python3 <code class="docutils literal"><span class="pre">print</span></code> function, making it
inaccessible at the <code class="docutils literal"><span class="pre">pdb</span></code> prompt.  (Contributed by Connor Osborn in
<a class="reference external" href="https://bugs.python.org/issue18764">issue 18764</a>.)</p>
</div>
<div class="section" id="pickle">
<span id="whatsnew-protocol-4"/><h3>pickle</h3>
<p><a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal"><span class="pre">pickle</span></code></a> now supports (but does not use by default) a new pickle protocol,
protocol 4.  This new protocol addresses a number of issues that were present
in previous protocols, such as the serialization of nested classes, very large
strings and containers, and classes whose <a class="reference internal" href="../reference/datamodel.html#object.__new__" title="object.__new__"><code class="xref py py-meth docutils literal"><span class="pre">__new__()</span></code></a> method takes
keyword-only arguments.  It also provides some efficiency improvements.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-39"/><a class="pep reference external" href="https://www.python.org/dev/peps/pep-3154"><strong>PEP 3154</strong></a> – Pickle protocol 4</dt>
<dd>PEP written by Antoine Pitrou and implemented by Alexandre Vassalotti.</dd>
</dl>
</div>
</div>
<div class="section" id="plistlib">
<h3>plistlib</h3>
<p><a class="reference internal" href="../library/plistlib.html#module-plistlib" title="plistlib: Generate and parse Mac OS X plist files."><code class="xref py py-mod docutils literal"><span class="pre">plistlib</span></code></a> now has an API that is similar to the standard pattern for
stdlib serialization protocols, with new <a class="reference internal" href="../library/plistlib.html#plistlib.load" title="plistlib.load"><code class="xref py py-func docutils literal"><span class="pre">load()</span></code></a>,
<a class="reference internal" href="../library/plistlib.html#plistlib.dump" title="plistlib.dump"><code class="xref py py-func docutils literal"><span class="pre">dump()</span></code></a>, <a class="reference internal" href="../library/plistlib.html#plistlib.loads" title="plistlib.loads"><code class="xref py py-func docutils literal"><span class="pre">loads()</span></code></a>, and <a class="reference internal" href="../library/plistlib.html#plistlib.dumps" title="plistlib.dumps"><code class="xref py py-func docutils literal"><span class="pre">dumps()</span></code></a>
functions.  (The older API is now deprecated.)  In addition to the already
supported XML plist format (<a class="reference internal" href="../library/plistlib.html#plistlib.FMT_XML" title="plistlib.FMT_XML"><code class="xref py py-data docutils literal"><span class="pre">FMT_XML</span></code></a>), it also now supports
the binary plist format (<a class="reference internal" href="../library/plistlib.html#plistlib.FMT_BINARY" title="plistlib.FMT_BINARY"><code class="xref py py-data docutils literal"><span class="pre">FMT_BINARY</span></code></a>).  (Contributed by Ronald
Oussoren and others in <a class="reference external" href="https://bugs.python.org/issue14455">issue 14455</a>.)</p>
</div>
<div class="section" id="poplib">
<h3>poplib</h3>
<p>Two new methods have been added to <a class="reference internal" href="../library/poplib.html#module-poplib" title="poplib: POP3 protocol client (requires sockets)."><code class="xref py py-mod docutils literal"><span class="pre">poplib</span></code></a>: <a class="reference internal" href="../library/poplib.html#poplib.POP3.capa" title="poplib.POP3.capa"><code class="xref py py-meth docutils literal"><span class="pre">capa()</span></code></a>,
which returns the list of capabilities advertised by the POP server, and
<a class="reference internal" href="../library/poplib.html#poplib.POP3.stls" title="poplib.POP3.stls"><code class="xref py py-meth docutils literal"><span class="pre">stls()</span></code></a>, which switches a clear-text POP3 session into an
encrypted POP3 session if the POP server supports it.  (Contributed by Lorenzo
Catucci in <a class="reference external" href="https://bugs.python.org/issue4473">issue 4473</a>.)</p>
</div>
<div class="section" id="pprint">
<h3>pprint</h3>
<p>The <a class="reference internal" href="../library/pprint.html#module-pprint" title="pprint: Data pretty printer."><code class="xref py py-mod docutils literal"><span class="pre">pprint</span></code></a> module’s <a class="reference internal" href="../library/pprint.html#pprint.PrettyPrinter" title="pprint.PrettyPrinter"><code class="xref py py-class docutils literal"><span class="pre">PrettyPrinter</span></code></a> class and its
<a class="reference internal" href="../library/pprint.html#pprint.pformat" title="pprint.pformat"><code class="xref py py-func docutils literal"><span class="pre">pformat()</span></code></a>, and <a class="reference internal" href="../library/pprint.html#pprint.pprint" title="pprint.pprint"><code class="xref py py-func docutils literal"><span class="pre">pprint()</span></code></a> functions have a new
option, <em>compact</em>, that controls how the output is formatted.  Currently
setting <em>compact</em> to <code class="docutils literal"><span class="pre">True</span></code> means that sequences will be printed with as many
sequence elements as will fit within <em>width</em> on each (indented) line.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue19132">issue 19132</a>.)</p>
<p>Long strings are now wrapped using Python’s normal line continuation
syntax.  (Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue17150">issue 17150</a>.)</p>
</div>
<div class="section" id="pty">
<h3>pty</h3>
<p><a class="reference internal" href="../library/pty.html#pty.spawn" title="pty.spawn"><code class="xref py py-func docutils literal"><span class="pre">pty.spawn()</span></code></a> now returns the status value from <a class="reference internal" href="../library/os.html#os.waitpid" title="os.waitpid"><code class="xref py py-func docutils literal"><span class="pre">os.waitpid()</span></code></a> on
the child process, instead of <code class="docutils literal"><span class="pre">None</span></code>.  (Contributed by Gregory P. Smith.)</p>
</div>
<div class="section" id="pydoc">
<h3>pydoc</h3>
<p>The <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><code class="xref py py-mod docutils literal"><span class="pre">pydoc</span></code></a> module is now based directly on the <a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal"><span class="pre">inspect.signature()</span></code></a>
introspection API, allowing it to provide signature information for a wider
variety of callable objects. This change also means that <code class="docutils literal"><span class="pre">__wrapped__</span></code>
attributes are now taken into account when displaying help information.
(Contributed by Larry Hastings in <a class="reference external" href="https://bugs.python.org/issue19674">issue 19674</a>.)</p>
<p>The <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><code class="xref py py-mod docutils literal"><span class="pre">pydoc</span></code></a> module no longer displays the <code class="docutils literal"><span class="pre">self</span></code> parameter for
already bound methods. Instead, it aims to always display the exact current
signature of the supplied callable.  (Contributed by Larry Hastings in
<a class="reference external" href="https://bugs.python.org/issue20710">issue 20710</a>.)</p>
<p>In addition to the changes that have been made to <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><code class="xref py py-mod docutils literal"><span class="pre">pydoc</span></code></a> directly,
its handling of custom <code class="docutils literal"><span class="pre">__dir__</span></code> methods and various descriptor
behaviours has also been improved substantially by the underlying changes in
the <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><code class="xref py py-mod docutils literal"><span class="pre">inspect</span></code></a> module.</p>
<p>As the <a class="reference internal" href="../library/functions.html#help" title="help"><code class="xref py py-func docutils literal"><span class="pre">help()</span></code></a> builtin is based on <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><code class="xref py py-mod docutils literal"><span class="pre">pydoc</span></code></a>, the above changes also
affect the behaviour of <a class="reference internal" href="../library/functions.html#help" title="help"><code class="xref py py-func docutils literal"><span class="pre">help()</span></code></a>.</p>
</div>
<div class="section" id="re">
<h3>re</h3>
<p>New <a class="reference internal" href="../library/re.html#re.fullmatch" title="re.fullmatch"><code class="xref py py-func docutils literal"><span class="pre">fullmatch()</span></code></a> function and <a class="reference internal" href="../library/re.html#re.regex.fullmatch" title="re.regex.fullmatch"><code class="xref py py-meth docutils literal"><span class="pre">regex.fullmatch()</span></code></a> method anchor
the pattern at both ends of the string to match.  This provides a way to be
explicit about the goal of the match, which avoids a class of subtle bugs where
<code class="docutils literal"><span class="pre">$</span></code> characters get lost during code changes or the addition of alternatives
to an existing regular expression.  (Contributed by Matthew Barnett in
<a class="reference external" href="https://bugs.python.org/issue16203">issue 16203</a>.)</p>
<p>The repr of <a class="reference internal" href="../library/re.html#re-objects"><span>regex objects</span></a> now includes the pattern
and the flags; the repr of <a class="reference internal" href="../library/re.html#match-objects"><span>match objects</span></a> now
includes the start, end, and the part of the string that matched.  (Contributed
by Hugo Lopes Tavares and Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue13592">issue 13592</a> and
<a class="reference external" href="https://bugs.python.org/issue17087">issue 17087</a>.)</p>
</div>
<div class="section" id="resource">
<h3>resource</h3>
<p>New <a class="reference internal" href="../library/resource.html#resource.prlimit" title="resource.prlimit"><code class="xref py py-func docutils literal"><span class="pre">prlimit()</span></code></a> function, available on Linux platforms with a
kernel version of 2.6.36 or later and glibc of 2.13 or later, provides the
ability to query or set the resource limits for processes other than the one
making the call.  (Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue16595">issue 16595</a>.)</p>
<p>On Linux kernel version 2.6.36 or later, there are there are also some new
Linux specific constants: <a class="reference internal" href="../library/resource.html#resource.RLIMIT_MSGQUEUE" title="resource.RLIMIT_MSGQUEUE"><code class="xref py py-attr docutils literal"><span class="pre">RLIMIT_MSGQUEUE</span></code></a>,
<a class="reference internal" href="../library/resource.html#resource.RLIMIT_NICE" title="resource.RLIMIT_NICE"><code class="xref py py-attr docutils literal"><span class="pre">RLIMIT_NICE</span></code></a>, <a class="reference internal" href="../library/resource.html#resource.RLIMIT_RTPRIO" title="resource.RLIMIT_RTPRIO"><code class="xref py py-attr docutils literal"><span class="pre">RLIMIT_RTPRIO</span></code></a>,
<a class="reference internal" href="../library/resource.html#resource.RLIMIT_RTTIME" title="resource.RLIMIT_RTTIME"><code class="xref py py-attr docutils literal"><span class="pre">RLIMIT_RTTIME</span></code></a>, and <a class="reference internal" href="../library/resource.html#resource.RLIMIT_SIGPENDING" title="resource.RLIMIT_SIGPENDING"><code class="xref py py-attr docutils literal"><span class="pre">RLIMIT_SIGPENDING</span></code></a>.
(Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue19324">issue 19324</a>.)</p>
<p>On FreeBSD version 9 and later, there some new FreeBSD specific constants:
<a class="reference internal" href="../library/resource.html#resource.RLIMIT_SBSIZE" title="resource.RLIMIT_SBSIZE"><code class="xref py py-attr docutils literal"><span class="pre">RLIMIT_SBSIZE</span></code></a>, <a class="reference internal" href="../library/resource.html#resource.RLIMIT_SWAP" title="resource.RLIMIT_SWAP"><code class="xref py py-attr docutils literal"><span class="pre">RLIMIT_SWAP</span></code></a>, and
<a class="reference internal" href="../library/resource.html#resource.RLIMIT_NPTS" title="resource.RLIMIT_NPTS"><code class="xref py py-attr docutils literal"><span class="pre">RLIMIT_NPTS</span></code></a>.  (Contributed by Claudiu Popa in
<a class="reference external" href="https://bugs.python.org/issue19343">issue 19343</a>.)</p>
</div>
<div class="section" id="select">
<h3>select</h3>
<p><a class="reference internal" href="../library/select.html#select.epoll" title="select.epoll"><code class="xref py py-class docutils literal"><span class="pre">epoll</span></code></a> objects now support the context management protocol.
When used in a <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal"><span class="pre">with</span></code></a> statement, the <a class="reference internal" href="../library/select.html#select.epoll.close" title="select.epoll.close"><code class="xref py py-meth docutils literal"><span class="pre">close()</span></code></a>
method will be called automatically at the end of the block.  (Contributed
by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue16488">issue 16488</a>.)</p>
<p><a class="reference internal" href="../library/select.html#select.devpoll" title="select.devpoll"><code class="xref py py-class docutils literal"><span class="pre">devpoll</span></code></a> objects now have <a class="reference internal" href="../library/select.html#select.devpoll.fileno" title="select.devpoll.fileno"><code class="xref py py-meth docutils literal"><span class="pre">fileno()</span></code></a> and
<a class="reference internal" href="../library/select.html#select.devpoll.close" title="select.devpoll.close"><code class="xref py py-meth docutils literal"><span class="pre">close()</span></code></a> methods, as well as a new attribute
<a class="reference internal" href="../library/select.html#select.devpoll.closed" title="select.devpoll.closed"><code class="xref py py-attr docutils literal"><span class="pre">closed</span></code></a>.  (Contributed by Victor Stinner in
<a class="reference external" href="https://bugs.python.org/issue18794">issue 18794</a>.)</p>
</div>
<div class="section" id="shelve">
<h3>shelve</h3>
<p><a class="reference internal" href="../library/shelve.html#shelve.Shelf" title="shelve.Shelf"><code class="xref py py-class docutils literal"><span class="pre">Shelf</span></code></a> instances may now be used in <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal"><span class="pre">with</span></code></a> statements,
and will be automatically closed at the end of the <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal"><span class="pre">with</span></code></a> block.
(Contributed by Filip Gruszczyński in <a class="reference external" href="https://bugs.python.org/issue13896">issue 13896</a>.)</p>
</div>
<div class="section" id="shutil">
<h3>shutil</h3>
<p><a class="reference internal" href="../library/shutil.html#shutil.copyfile" title="shutil.copyfile"><code class="xref py py-func docutils literal"><span class="pre">copyfile()</span></code></a> now raises a specific <a class="reference internal" href="../library/shutil.html#shutil.Error" title="shutil.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> subclass,
<a class="reference internal" href="../library/shutil.html#shutil.SameFileError" title="shutil.SameFileError"><code class="xref py py-exc docutils literal"><span class="pre">SameFileError</span></code></a>, when the source and destination are the same
file, which allows an application to take appropriate action on this specific
error.  (Contributed by Atsuo Ishimoto and Hynek Schlawack in
<a class="reference external" href="https://bugs.python.org/issue1492704">issue 1492704</a>.)</p>
</div>
<div class="section" id="smtpd">
<h3>smtpd</h3>
<p>The <a class="reference internal" href="../library/smtpd.html#smtpd.SMTPServer" title="smtpd.SMTPServer"><code class="xref py py-class docutils literal"><span class="pre">SMTPServer</span></code></a> and <a class="reference internal" href="../library/smtpd.html#smtpd.SMTPChannel" title="smtpd.SMTPChannel"><code class="xref py py-class docutils literal"><span class="pre">SMTPChannel</span></code></a> classes now
accept a <em>map</em> keyword argument which, if specified, is passed in to
<a class="reference internal" href="../library/asynchat.html#asynchat.async_chat" title="asynchat.async_chat"><code class="xref py py-class docutils literal"><span class="pre">asynchat.async_chat</span></code></a> as its <em>map</em> argument.  This allows an application
to avoid affecting the global socket map.  (Contributed by Vinay Sajip in
<a class="reference external" href="https://bugs.python.org/issue11959">issue 11959</a>.)</p>
</div>
<div class="section" id="smtplib">
<h3>smtplib</h3>
<p><a class="reference internal" href="../library/smtplib.html#smtplib.SMTPException" title="smtplib.SMTPException"><code class="xref py py-exc docutils literal"><span class="pre">SMTPException</span></code></a> is now a subclass of <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal"><span class="pre">OSError</span></code></a>, which allows
both socket level errors and SMTP protocol level errors to be caught in one
try/except statement by code that only cares whether or not an error occurred.
(Contributed by Ned Jackson Lovely in <a class="reference external" href="https://bugs.python.org/issue2118">issue 2118</a>.)</p>
</div>
<div class="section" id="socket">
<h3>socket</h3>
<p>The socket module now supports the <a class="reference internal" href="../library/socket.html#socket.CAN_BCM" title="socket.CAN_BCM"><code class="xref py py-data docutils literal"><span class="pre">CAN_BCM</span></code></a> protocol on
platforms that support it.  (Contributed by Brian Thorne in <a class="reference external" href="https://bugs.python.org/issue15359">issue 15359</a>.)</p>
<p>Socket objects have new methods to get or set their <a class="reference internal" href="../library/os.html#fd-inheritance"><span>inheritable flag</span></a>, <a class="reference internal" href="../library/socket.html#socket.socket.get_inheritable" title="socket.socket.get_inheritable"><code class="xref py py-meth docutils literal"><span class="pre">get_inheritable()</span></code></a> and
<a class="reference internal" href="../library/socket.html#socket.socket.set_inheritable" title="socket.socket.set_inheritable"><code class="xref py py-meth docutils literal"><span class="pre">set_inheritable()</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">socket.AF_*</span></code> and <code class="docutils literal"><span class="pre">socket.SOCK_*</span></code> constants are now enumeration values
using the new <a class="reference internal" href="../library/enum.html#module-enum" title="enum: Implementation of an enumeration class."><code class="xref py py-mod docutils literal"><span class="pre">enum</span></code></a> module.  This allows meaningful names to be printed
during debugging, instead of integer “magic numbers”.</p>
<p>The <a class="reference internal" href="../library/socket.html#socket.AF_LINK" title="socket.AF_LINK"><code class="xref py py-data docutils literal"><span class="pre">AF_LINK</span></code></a> constant is now available on BSD and OSX.</p>
<p><a class="reference internal" href="../library/socket.html#socket.inet_pton" title="socket.inet_pton"><code class="xref py py-func docutils literal"><span class="pre">inet_pton()</span></code></a> and <a class="reference internal" href="../library/socket.html#socket.inet_ntop" title="socket.inet_ntop"><code class="xref py py-func docutils literal"><span class="pre">inet_ntop()</span></code></a> are now supported
on Windows.  (Contributed by Atsuo Ishimoto in <a class="reference external" href="https://bugs.python.org/issue7171">issue 7171</a>.)</p>
</div>

<div class="section" id="ssl">
<h3>ssl</h3>
<p id="whatsnew-tls-11-12"><a class="reference internal" href="../library/ssl.html#ssl.PROTOCOL_TLSv1_1" title="ssl.PROTOCOL_TLSv1_1"><code class="xref py py-data docutils literal"><span class="pre">PROTOCOL_TLSv1_1</span></code></a> and <a class="reference internal" href="../library/ssl.html#ssl.PROTOCOL_TLSv1_2" title="ssl.PROTOCOL_TLSv1_2"><code class="xref py py-data docutils literal"><span class="pre">PROTOCOL_TLSv1_2</span></code></a> (TLSv1.1 and
TLSv1.2 support) have been added; support for these protocols is only available if
Python is linked with OpenSSL 1.0.1 or later.  (Contributed by Michele Orrù and
Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue16692">issue 16692</a>.)</p>
<p id="whatsnew34-sslcontext">New function <a class="reference internal" href="../library/ssl.html#ssl.create_default_context" title="ssl.create_default_context"><code class="xref py py-func docutils literal"><span class="pre">create_default_context()</span></code></a> provides a standard way to
obtain an <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal"><span class="pre">SSLContext</span></code></a> whose settings are intended to be a
reasonable balance between compatibility and security.  These settings are
more stringent than the defaults provided by the <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal"><span class="pre">SSLContext</span></code></a>
constructor, and may be adjusted in the future, without prior deprecation, if
best-practice security requirements change.  The new recommended best
practice for using stdlib libraries that support SSL is to use
<a class="reference internal" href="../library/ssl.html#ssl.create_default_context" title="ssl.create_default_context"><code class="xref py py-func docutils literal"><span class="pre">create_default_context()</span></code></a> to obtain an <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal"><span class="pre">SSLContext</span></code></a>
object, modify it if needed, and then pass it as the <em>context</em> argument
of the appropriate stdlib API.  (Contributed by Christian Heimes
in <a class="reference external" href="https://bugs.python.org/issue19689">issue 19689</a>.)</p>
<p><a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal"><span class="pre">SSLContext</span></code></a> method <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.load_verify_locations" title="ssl.SSLContext.load_verify_locations"><code class="xref py py-meth docutils literal"><span class="pre">load_verify_locations()</span></code></a>
accepts a new optional argument <em>cadata</em>, which can be used to provide PEM or
DER encoded certificates directly via strings or bytes, respectively.
(Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue18138">issue 18138</a>.)</p>
<p>New function <a class="reference internal" href="../library/ssl.html#ssl.get_default_verify_paths" title="ssl.get_default_verify_paths"><code class="xref py py-func docutils literal"><span class="pre">get_default_verify_paths()</span></code></a> returns
a named tuple of the paths and environment variables that the
<a class="reference internal" href="../library/ssl.html#ssl.SSLContext.set_default_verify_paths" title="ssl.SSLContext.set_default_verify_paths"><code class="xref py py-meth docutils literal"><span class="pre">set_default_verify_paths()</span></code></a> method uses to set
OpenSSL’s default <code class="docutils literal"><span class="pre">cafile</span></code> and <code class="docutils literal"><span class="pre">capath</span></code>.  This can be an aid in
debugging default verification issues.  (Contributed by Christian Heimes
in <a class="reference external" href="https://bugs.python.org/issue18143">issue 18143</a>.)</p>
<p><a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal"><span class="pre">SSLContext</span></code></a> has a new method,
<a class="reference internal" href="../library/ssl.html#ssl.SSLContext.cert_store_stats" title="ssl.SSLContext.cert_store_stats"><code class="xref py py-meth docutils literal"><span class="pre">cert_store_stats()</span></code></a>, that reports the number of loaded
<code class="docutils literal"><span class="pre">X.509</span></code> certs, <code class="docutils literal"><span class="pre">X.509</span> <span class="pre">CA</span></code> certs, and certificate revocation lists (<code class="docutils literal"><span class="pre">crl</span></code>s), as well as a <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.get_ca_certs" title="ssl.SSLContext.get_ca_certs"><code class="xref py py-meth docutils literal"><span class="pre">get_ca_certs()</span></code></a> method that returns a
list of the loaded <code class="docutils literal"><span class="pre">CA</span></code> certificates.  (Contributed by Christian Heimes in
<a class="reference external" href="https://bugs.python.org/issue18147">issue 18147</a>.)</p>
<p>If OpenSSL 0.9.8 or later is available, <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal"><span class="pre">SSLContext</span></code></a> has an new
attribute <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.verify_flags" title="ssl.SSLContext.verify_flags"><code class="xref py py-attr docutils literal"><span class="pre">verify_flags</span></code></a> that can be used to control the
certificate verification process by setting it to some combination of the new
constants <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_DEFAULT" title="ssl.VERIFY_DEFAULT"><code class="xref py py-data docutils literal"><span class="pre">VERIFY_DEFAULT</span></code></a>, <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_CRL_CHECK_LEAF" title="ssl.VERIFY_CRL_CHECK_LEAF"><code class="xref py py-data docutils literal"><span class="pre">VERIFY_CRL_CHECK_LEAF</span></code></a>,
<a class="reference internal" href="../library/ssl.html#ssl.VERIFY_CRL_CHECK_CHAIN" title="ssl.VERIFY_CRL_CHECK_CHAIN"><code class="xref py py-data docutils literal"><span class="pre">VERIFY_CRL_CHECK_CHAIN</span></code></a>, or <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_X509_STRICT" title="ssl.VERIFY_X509_STRICT"><code class="xref py py-data docutils literal"><span class="pre">VERIFY_X509_STRICT</span></code></a>.
OpenSSL does not do any CRL verification by default.  (Contributed by
Christien Heimes in <a class="reference external" href="https://bugs.python.org/issue8813">issue 8813</a>.)</p>
<p>New <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal"><span class="pre">SSLContext</span></code></a> method <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.load_default_certs" title="ssl.SSLContext.load_default_certs"><code class="xref py py-meth docutils literal"><span class="pre">load_default_certs()</span></code></a>
loads a set of default “certificate authority” (CA) certificates from default
locations, which vary according to the platform.  It can be used to load both
TLS web server authentication certificates
(<code class="docutils literal"><span class="pre">purpose=</span></code><a class="reference internal" href="../library/ssl.html#ssl.Purpose.SERVER_AUTH" title="ssl.Purpose.SERVER_AUTH"><code class="xref py py-data docutils literal"><span class="pre">SERVER_AUTH</span></code></a>) for a client to use to verify a
server, and certificates for a server to use in verifying client certificates
(<code class="docutils literal"><span class="pre">purpose=</span></code><a class="reference internal" href="../library/ssl.html#ssl.Purpose.CLIENT_AUTH" title="ssl.Purpose.CLIENT_AUTH"><code class="xref py py-data docutils literal"><span class="pre">CLIENT_AUTH</span></code></a>).  (Contributed by Christian
Heimes in <a class="reference external" href="https://bugs.python.org/issue19292">issue 19292</a>.)</p>
<p id="whatsnew34-win-cert-store">Two new windows-only functions, <a class="reference internal" href="../library/ssl.html#ssl.enum_certificates" title="ssl.enum_certificates"><code class="xref py py-func docutils literal"><span class="pre">enum_certificates()</span></code></a> and
<a class="reference internal" href="../library/ssl.html#ssl.enum_crls" title="ssl.enum_crls"><code class="xref py py-func docutils literal"><span class="pre">enum_crls()</span></code></a> provide the ability to retrieve certificates,
certificate information, and CRLs from the Windows cert store.  (Contributed
by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue17134">issue 17134</a>.)</p>
<p id="whatsnew34-sni">Support for server-side SNI (Server Name Indication) using the new
<a class="reference internal" href="../library/ssl.html#ssl.SSLContext.set_servername_callback" title="ssl.SSLContext.set_servername_callback"><code class="xref py py-meth docutils literal"><span class="pre">ssl.SSLContext.set_servername_callback()</span></code></a> method.
(Contributed by Daniel Black in <a class="reference external" href="https://bugs.python.org/issue8109">issue 8109</a>.)</p>
<p>The dictionary returned by <a class="reference internal" href="../library/ssl.html#ssl.SSLSocket.getpeercert" title="ssl.SSLSocket.getpeercert"><code class="xref py py-meth docutils literal"><span class="pre">SSLSocket.getpeercert()</span></code></a> contains additional
<code class="docutils literal"><span class="pre">X509v3</span></code> extension items: <code class="docutils literal"><span class="pre">crlDistributionPoints</span></code>, <code class="docutils literal"><span class="pre">calIssuers</span></code>, and
<code class="docutils literal"><span class="pre">OCSP</span></code> URIs.  (Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue18379">issue 18379</a>.)</p>
</div>
<div class="section" id="stat">
<h3>stat</h3>
<p>The <a class="reference internal" href="../library/stat.html#module-stat" title="stat: Utilities for interpreting the results of os.stat(), os.lstat() and os.fstat()."><code class="xref py py-mod docutils literal"><span class="pre">stat</span></code></a> module is now backed by a C implementation in <code class="xref py py-mod docutils literal"><span class="pre">_stat</span></code>. A C
implementation is required as most of the values aren’t standardized and
are platform-dependent.  (Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue11016">issue 11016</a>.)</p>
<p>The module supports new <a class="reference internal" href="../library/stat.html#stat.ST_MODE" title="stat.ST_MODE"><code class="xref py py-mod docutils literal"><span class="pre">ST_MODE</span></code></a> flags, <a class="reference internal" href="../library/stat.html#stat.S_IFDOOR" title="stat.S_IFDOOR"><code class="xref py py-mod docutils literal"><span class="pre">S_IFDOOR</span></code></a>,
<a class="reference internal" href="../library/stat.html#stat.S_IFPORT" title="stat.S_IFPORT"><code class="xref py py-attr docutils literal"><span class="pre">S_IFPORT</span></code></a>, and <a class="reference internal" href="../library/stat.html#stat.S_IFWHT" title="stat.S_IFWHT"><code class="xref py py-attr docutils literal"><span class="pre">S_IFWHT</span></code></a>.  (Contributed by
Christian Hiemes in <a class="reference external" href="https://bugs.python.org/issue11016">issue 11016</a>.)</p>
</div>

<div class="section" id="subprocess">
<h3>subprocess</h3>
<p><a class="reference internal" href="../library/subprocess.html#subprocess.check_output" title="subprocess.check_output"><code class="xref py py-func docutils literal"><span class="pre">check_output()</span></code></a> now accepts an <em>input</em> argument that can
be used to provide the contents of <code class="docutils literal"><span class="pre">stdin</span></code> for the command that is run.
(Contributed by Zack Weinberg in <a class="reference external" href="https://bugs.python.org/issue16624">issue 16624</a>.)</p>
<p><code class="xref py py-func docutils literal"><span class="pre">getstatus()</span></code> and <a class="reference internal" href="../library/subprocess.html#subprocess.getstatusoutput" title="subprocess.getstatusoutput"><code class="xref py py-func docutils literal"><span class="pre">getstatusoutput()</span></code></a> now
work on Windows.  This change was actually inadvertently made in 3.3.4.
(Contributed by Tim Golden in <a class="reference external" href="https://bugs.python.org/issue10197">issue 10197</a>.)</p>
</div>
<div class="section" id="sunau">
<h3>sunau</h3>
<p>The <code class="xref py py-meth docutils literal"><span class="pre">getparams()</span></code> method now returns a namedtuple rather than a
plain tuple.  (Contributed by Claudiu Popa in <a class="reference external" href="https://bugs.python.org/issue18901">issue 18901</a>.)</p>
<p><a class="reference internal" href="../library/sunau.html#sunau.open" title="sunau.open"><code class="xref py py-meth docutils literal"><span class="pre">sunau.open()</span></code></a> now supports the context management protocol: when used in a
<a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal"><span class="pre">with</span></code></a> block, the <code class="docutils literal"><span class="pre">close</span></code> method of the returned object will be
called automatically at the end of the block.  (Contributed by Serhiy Storchaka
in <a class="reference external" href="https://bugs.python.org/issue18878">issue 18878</a>.)</p>
<p><a class="reference internal" href="../library/sunau.html#sunau.AU_write.setsampwidth" title="sunau.AU_write.setsampwidth"><code class="xref py py-meth docutils literal"><span class="pre">AU_write.setsampwidth()</span></code></a> now supports 24 bit samples, thus adding
support for writing 24 sample using the module.  (Contributed by
Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue19261">issue 19261</a>.)</p>
<p>The <a class="reference internal" href="../library/sunau.html#sunau.AU_write.writeframesraw" title="sunau.AU_write.writeframesraw"><code class="xref py py-meth docutils literal"><span class="pre">writeframesraw()</span></code></a> and
<a class="reference internal" href="../library/sunau.html#sunau.AU_write.writeframes" title="sunau.AU_write.writeframes"><code class="xref py py-meth docutils literal"><span class="pre">writeframes()</span></code></a> methods now accept any <a class="reference internal" href="../glossary.html#term-bytes-like-object"><span class="xref std std-term">bytes-like
object</span></a>.  (Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue8311">issue 8311</a>.)</p>
</div>
<div class="section" id="sys">
<h3>sys</h3>
<p>New function <a class="reference internal" href="../library/sys.html#sys.getallocatedblocks" title="sys.getallocatedblocks"><code class="xref py py-func docutils literal"><span class="pre">sys.getallocatedblocks()</span></code></a> returns the current number of
blocks allocated by the interpreter.  (In CPython with the default
<code class="docutils literal"><span class="pre">--with-pymalloc</span></code> setting, this is allocations made through the
<code class="xref c c-func docutils literal"><span class="pre">PyObject_Malloc()</span></code> API.)  This can be useful for tracking memory leaks,
especially if automated via a test suite.  (Contributed by Antoine Pitrou
in <a class="reference external" href="https://bugs.python.org/issue13390">issue 13390</a>.)</p>
<p>When the Python interpreter starts in <a class="reference internal" href="../tutorial/interpreter.html#tut-interactive"><span>interactive mode</span></a>, it checks for an <a class="reference internal" href="../library/sys.html#sys.__interactivehook__" title="sys.__interactivehook__"><code class="xref py py-data docutils literal"><span class="pre">__interactivehook__</span></code></a> attribute
on the <a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal"><span class="pre">sys</span></code></a> module.  If the attribute exists, its value is called with no
arguments just before interactive mode is started.  The check is made after the
<span class="target" id="index-40"/><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONSTARTUP"><code class="xref std std-envvar docutils literal"><span class="pre">PYTHONSTARTUP</span></code></a> file is read, so it can be set there.  The <a class="reference internal" href="../library/site.html#module-site" title="site: Module responsible for site-specific configuration."><code class="xref py py-mod docutils literal"><span class="pre">site</span></code></a>
module <a class="reference internal" href="../library/site.html#rlcompleter-config"><span>sets it</span></a> to a function that enables tab
completion and history saving (in <code class="file docutils literal"><span class="pre">~/.python-history</span></code>) if the platform
supports <a class="reference internal" href="../library/readline.html#module-readline" title="readline: GNU readline support for Python. (Unix)"><code class="xref py py-mod docutils literal"><span class="pre">readline</span></code></a>.  If you do not want this (new) behavior, you can
override it in <span class="target" id="index-41"/><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONSTARTUP"><code class="xref std std-envvar docutils literal"><span class="pre">PYTHONSTARTUP</span></code></a>, <code class="xref py py-mod docutils literal"><span class="pre">sitecustomize</span></code>, or
<code class="xref py py-mod docutils literal"><span class="pre">usercustomize</span></code> by deleting this attribute from <a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal"><span class="pre">sys</span></code></a> (or setting it
to some other callable).  (Contributed by Éric Araujo and Antoine Pitrou in
<a class="reference external" href="https://bugs.python.org/issue5845">issue 5845</a>.)</p>
</div>
<div class="section" id="tarfile">
<h3>tarfile</h3>
<p>The <a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal"><span class="pre">tarfile</span></code></a> module now supports a simple <a class="reference internal" href="../library/tarfile.html#tarfile-commandline"><span>Command Line Interface</span></a> when
called as a script directly or via <code class="docutils literal"><span class="pre">-m</span></code>.  This can be used to create and
extract tarfile archives.  (Contributed by Berker Peksag in <a class="reference external" href="https://bugs.python.org/issue13477">issue 13477</a>.)</p>
</div>
<div class="section" id="textwrap">
<h3>textwrap</h3>
<p>The <a class="reference internal" href="../library/textwrap.html#textwrap.TextWrapper" title="textwrap.TextWrapper"><code class="xref py py-class docutils literal"><span class="pre">TextWrapper</span></code></a> class has two new attributes/constructor
arguments: <a class="reference internal" href="../library/textwrap.html#textwrap.TextWrapper.max_lines" title="textwrap.TextWrapper.max_lines"><code class="xref py py-attr docutils literal"><span class="pre">max_lines</span></code></a>, which limits the number of
lines in the output, and <a class="reference internal" href="../library/textwrap.html#textwrap.TextWrapper.placeholder" title="textwrap.TextWrapper.placeholder"><code class="xref py py-attr docutils literal"><span class="pre">placeholder</span></code></a>, which is a
string that will appear at the end of the output if it has been truncated
because of <em>max_lines</em>.  Building on these capabilities, a new convenience
function <a class="reference internal" href="../library/textwrap.html#textwrap.shorten" title="textwrap.shorten"><code class="xref py py-func docutils literal"><span class="pre">shorten()</span></code></a> collapses all of the whitespace in the input
to single spaces and produces a single line of a given <em>width</em> that ends with
the <em>placeholder</em> (by default, <code class="docutils literal"><span class="pre">[...]</span></code>).  (Contributed by Antoine Pitrou and
Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue18585">issue 18585</a> and <a class="reference external" href="https://bugs.python.org/issue18725">issue 18725</a>.)</p>
</div>
<div class="section" id="threading">
<h3>threading</h3>
<p>The <a class="reference internal" href="../library/threading.html#threading.Thread" title="threading.Thread"><code class="xref py py-class docutils literal"><span class="pre">Thread</span></code></a> object representing the main thread can be
obtained from the new <a class="reference internal" href="../library/threading.html#threading.main_thread" title="threading.main_thread"><code class="xref py py-func docutils literal"><span class="pre">main_thread()</span></code></a> function.  In normal
conditions this will be the thread from which the Python interpreter was
started.  (Contributed by Andrew Svetlov in <a class="reference external" href="https://bugs.python.org/issue18882">issue 18882</a>.)</p>
</div>
<div class="section" id="traceback">
<h3>traceback</h3>
<p>A new <a class="reference internal" href="../library/traceback.html#traceback.clear_frames" title="traceback.clear_frames"><code class="xref py py-func docutils literal"><span class="pre">traceback.clear_frames()</span></code></a> function takes a traceback object
and clears the local variables in all of the frames it references,
reducing the amount of memory consumed.  (Contributed by Andrew Kuchling in
<a class="reference external" href="https://bugs.python.org/issue1565525">issue 1565525</a>.)</p>
</div>
<div class="section" id="types">
<h3>types</h3>
<p>A new <a class="reference internal" href="../library/types.html#types.DynamicClassAttribute" title="types.DynamicClassAttribute"><code class="xref py py-func docutils literal"><span class="pre">DynamicClassAttribute()</span></code></a> descriptor provides a way to define
an attribute that acts normally when looked up through an instance object, but
which is routed to the <em>class</em> <code class="docutils literal"><span class="pre">__getattr__</span></code> when looked up through the
class.  This allows one to have properties active on a class, and have virtual
attributes on the class with the same name (see <code class="xref py py-mod docutils literal"><span class="pre">Enum</span></code> for an example).
(Contributed by Ethan Furman in <a class="reference external" href="https://bugs.python.org/issue19030">issue 19030</a>.)</p>
</div>
<div class="section" id="urllib">
<h3>urllib</h3>
<p><a class="reference internal" href="../library/urllib.request.html#module-urllib.request" title="urllib.request: Extensible library for opening URLs."><code class="xref py py-mod docutils literal"><span class="pre">urllib.request</span></code></a> now supports <code class="docutils literal"><span class="pre">data:</span></code> URLs via the
<a class="reference internal" href="../library/urllib.request.html#urllib.request.DataHandler" title="urllib.request.DataHandler"><code class="xref py py-class docutils literal"><span class="pre">DataHandler</span></code></a> class.  (Contributed by Mathias Panzenböck
in <a class="reference external" href="https://bugs.python.org/issue16423">issue 16423</a>.)</p>
<p>The http method that will be used by a <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a> class
can now be specified by setting a <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.method" title="urllib.request.Request.method"><code class="xref py py-class docutils literal"><span class="pre">method</span></code></a>
class attribute on the subclass.  (Contributed by Jason R Coombs in
<a class="reference external" href="https://bugs.python.org/issue18978">issue 18978</a>.)</p>
<p><a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a> objects are now reusable: if the
<a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.full_url" title="urllib.request.Request.full_url"><code class="xref py py-attr docutils literal"><span class="pre">full_url</span></code></a> or <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.data" title="urllib.request.Request.data"><code class="xref py py-attr docutils literal"><span class="pre">data</span></code></a>
attributes are modified, all relevant internal properties are updated.  This
means, for example, that it is now possible to use the same
<a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a> object in more than one
<a class="reference internal" href="../library/urllib.request.html#urllib.request.OpenerDirector.open" title="urllib.request.OpenerDirector.open"><code class="xref py py-meth docutils literal"><span class="pre">OpenerDirector.open()</span></code></a> call with different <em>data</em> arguments, or to
modify a <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a>‘s <code class="docutils literal"><span class="pre">url</span></code> rather than recomputing it
from scratch.  There is also a new
<a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.remove_header" title="urllib.request.Request.remove_header"><code class="xref py py-meth docutils literal"><span class="pre">remove_header()</span></code></a> method that can be used to remove
headers from a <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a>.  (Contributed by Alexey
Kachayev in <a class="reference external" href="https://bugs.python.org/issue16464">issue 16464</a>, Daniel Wozniak in <a class="reference external" href="https://bugs.python.org/issue17485">issue 17485</a>, and Damien Brecht
and Senthil Kumaran in <a class="reference external" href="https://bugs.python.org/issue17272">issue 17272</a>.)</p>
<p><a class="reference internal" href="../library/urllib.error.html#urllib.error.HTTPError" title="urllib.error.HTTPError"><code class="xref py py-class docutils literal"><span class="pre">HTTPError</span></code></a> objects now have a
<a class="reference internal" href="../library/urllib.error.html#urllib.error.HTTPError.headers" title="urllib.error.HTTPError.headers"><code class="xref py py-attr docutils literal"><span class="pre">headers</span></code></a> attribute that provides access to the
HTTP response headers associated with the error.  (Contributed by
Berker Peksag in <a class="reference external" href="https://bugs.python.org/issue15701">issue 15701</a>.)</p>
</div>
<div class="section" id="unittest">
<h3>unittest</h3>
<p>The <a class="reference internal" href="../library/unittest.html#unittest.TestCase" title="unittest.TestCase"><code class="xref py py-class docutils literal"><span class="pre">TestCase</span></code></a> class has a new method,
<a class="reference internal" href="../library/unittest.html#unittest.TestCase.subTest" title="unittest.TestCase.subTest"><code class="xref py py-meth docutils literal"><span class="pre">subTest()</span></code></a>, that produces a context manager whose
<a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal"><span class="pre">with</span></code></a> block becomes a “sub-test”.  This context manager allows a test
method to dynamically generate subtests  by, say, calling the <code class="docutils literal"><span class="pre">subTest</span></code>
context manager inside a loop.  A single test method can thereby produce an
indefinite number of separately-identified and separately-counted tests, all of
which will run even if one or more of them fail.  For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span/><span class="k">class</span> <span class="nc">NumbersTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_even</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>will result in six subtests, each identified in the unittest verbose output
with a label consisting of the variable name <code class="docutils literal"><span class="pre">i</span></code> and a particular value for
that variable (<code class="docutils literal"><span class="pre">i=0</span></code>, <code class="docutils literal"><span class="pre">i=1</span></code>, etc).  See <a class="reference internal" href="../library/unittest.html#subtests"><span>Distinguishing test iterations using subtests</span></a> for the full
version of this example.  (Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue16997">issue 16997</a>.)</p>
<p><a class="reference internal" href="../library/unittest.html#unittest.main" title="unittest.main"><code class="xref py py-func docutils literal"><span class="pre">unittest.main()</span></code></a> now accepts an iterable of test names for
<em>defaultTest</em>, where previously it only accepted a single test name as a
string.  (Contributed by Jyrki Pulliainen in <a class="reference external" href="https://bugs.python.org/issue15132">issue 15132</a>.)</p>
<p>If <a class="reference internal" href="../library/unittest.html#unittest.SkipTest" title="unittest.SkipTest"><code class="xref py py-class docutils literal"><span class="pre">SkipTest</span></code></a> is raised during test discovery (that is, at the
module level in the test file), it is now reported as a skip instead of an
error.  (Contributed by Zach Ware in <a class="reference external" href="https://bugs.python.org/issue16935">issue 16935</a>.)</p>
<p><a class="reference internal" href="../library/unittest.html#unittest.TestLoader.discover" title="unittest.TestLoader.discover"><code class="xref py py-meth docutils literal"><span class="pre">discover()</span></code></a> now sorts the discovered files to provide
consistent test ordering.  (Contributed by Martin Melin and Jeff Ramnani in
<a class="reference external" href="https://bugs.python.org/issue16709">issue 16709</a>.)</p>
<p><a class="reference internal" href="../library/unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal"><span class="pre">TestSuite</span></code></a> now drops references to tests as soon as the test
has been run, if the test is successful.  On Python interpreters that do
garbage collection, this allows the tests to be garbage collected if nothing
else is holding a reference to the test.  It is possible to override this
behavior by creating a <a class="reference internal" href="../library/unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal"><span class="pre">TestSuite</span></code></a> subclass that defines a
custom <code class="docutils literal"><span class="pre">_removeTestAtIndex</span></code> method.  (Contributed by Tom Wardill, Matt
McClure, and Andrew Svetlov in <a class="reference external" href="https://bugs.python.org/issue11798">issue 11798</a>.)</p>
<p>A new test assertion context-manager, <a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertLogs" title="unittest.TestCase.assertLogs"><code class="xref py py-meth docutils literal"><span class="pre">assertLogs()</span></code></a>,
will ensure that a given block of code emits a log message using the
<a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> module.  By default the message can come from any logger and
have a priority of <code class="docutils literal"><span class="pre">INFO</span></code> or higher, but both the logger name and an
alternative minimum logging level may be specified.  The object returned by the
context manager can be queried for the <a class="reference internal" href="../library/logging.html#logging.LogRecord" title="logging.LogRecord"><code class="xref py py-class docutils literal"><span class="pre">LogRecord</span></code></a>s and/or
formatted messages that were logged.  (Contributed by Antoine Pitrou in
<a class="reference external" href="https://bugs.python.org/issue18937">issue 18937</a>.)</p>
<p>Test discovery now works with namespace packages (Contributed by Claudiu Popa
in <a class="reference external" href="https://bugs.python.org/issue17457">issue 17457</a>.)</p>
<p><a class="reference internal" href="../library/unittest.mock.html#module-unittest.mock" title="unittest.mock: Mock object library."><code class="xref py py-mod docutils literal"><span class="pre">unittest.mock</span></code></a> objects now inspect their specification signatures when
matching calls, which means an argument can now be matched by either position
or name, instead of only by position.  (Contributed by Antoine Pitrou in
<a class="reference external" href="https://bugs.python.org/issue17015">issue 17015</a>.)</p>
<p><code class="xref py py-func docutils literal"><span class="pre">mock_open()</span></code> objects now have <code class="docutils literal"><span class="pre">readline</span></code> and <code class="docutils literal"><span class="pre">readlines</span></code>
methods.  (Contributed by Toshio Kuratomi in <a class="reference external" href="https://bugs.python.org/issue17467">issue 17467</a>.)</p>
</div>
<div class="section" id="venv">
<h3>venv</h3>
<p><a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><code class="xref py py-mod docutils literal"><span class="pre">venv</span></code></a> now includes activation scripts for the <code class="docutils literal"><span class="pre">csh</span></code> and <code class="docutils literal"><span class="pre">fish</span></code>
shells.  (Contributed by Andrew Svetlov in <a class="reference external" href="https://bugs.python.org/issue15417">issue 15417</a>.)</p>
<p><a class="reference internal" href="../library/venv.html#venv.EnvBuilder" title="venv.EnvBuilder"><code class="xref py py-class docutils literal"><span class="pre">EnvBuilder</span></code></a> and the <a class="reference internal" href="../library/venv.html#venv.create" title="venv.create"><code class="xref py py-func docutils literal"><span class="pre">create()</span></code></a> convenience function
take a new keyword argument <em>with_pip</em>, which defaults to <code class="docutils literal"><span class="pre">False</span></code>, that
controls whether or not <a class="reference internal" href="../library/venv.html#venv.EnvBuilder" title="venv.EnvBuilder"><code class="xref py py-class docutils literal"><span class="pre">EnvBuilder</span></code></a> ensures that <code class="docutils literal"><span class="pre">pip</span></code> is
installed in the virtual environment.  (Contributed by Nick Coghlan in
<a class="reference external" href="https://bugs.python.org/issue19552">issue 19552</a> as part of the <span class="target" id="index-42"/><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0453"><strong>PEP 453</strong></a> implementation.)</p>
</div>

<div class="section" id="weakref">
<h3>weakref</h3>
<p>New <a class="reference internal" href="../library/weakref.html#weakref.WeakMethod" title="weakref.WeakMethod"><code class="xref py py-class docutils literal"><span class="pre">WeakMethod</span></code></a> class simulates weak references to bound
methods.  (Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue14631">issue 14631</a>.)</p>
<p>New <a class="reference internal" href="../library/weakref.html#weakref.finalize" title="weakref.finalize"><code class="xref py py-class docutils literal"><span class="pre">finalize</span></code></a> class makes it possible to register a callback
to be invoked when an object is garbage collected, without needing to
carefully manage the lifecycle of the weak reference itself.  (Contributed by
Richard Oudkerk in <a class="reference external" href="https://bugs.python.org/issue15528">issue 15528</a>.)</p>
<p>The callback, if any, associated with a <a class="reference internal" href="../library/weakref.html#weakref.ref" title="weakref.ref"><code class="xref py py-class docutils literal"><span class="pre">ref</span></code></a> is now
exposed via the <a class="reference internal" href="../library/weakref.html#weakref.ref.__callback__" title="weakref.ref.__callback__"><code class="xref py py-attr docutils literal"><span class="pre">__callback__</span></code></a> attribute.  (Contributed
by Mark Dickinson in <a class="reference external" href="https://bugs.python.org/issue17643">issue 17643</a>.)</p>
</div>

<div class="section" id="zipfile">
<h3>zipfile</h3>
<p>The <a class="reference internal" href="../library/zipfile.html#zipfile.PyZipFile.writepy" title="zipfile.PyZipFile.writepy"><code class="xref py py-meth docutils literal"><span class="pre">writepy()</span></code></a> method of the
<a class="reference internal" href="../library/zipfile.html#zipfile.PyZipFile" title="zipfile.PyZipFile"><code class="xref py py-class docutils literal"><span class="pre">PyZipFile</span></code></a> class has a new <em>filterfunc</em> option that can be
used to control which directories and files are added to the archive.  For
example, this could be used to exclude test files from the archive.
(Contributed by Christian Tismer in <a class="reference external" href="https://bugs.python.org/issue19274">issue 19274</a>.)</p>
<p>The <em>allowZip64</em> parameter to <a class="reference internal" href="../library/zipfile.html#zipfile.ZipFile" title="zipfile.ZipFile"><code class="xref py py-class docutils literal"><span class="pre">ZipFile</span></code></a> and
<code class="xref py py-class docutils literal"><span class="pre">PyZipfile</span></code> is now <code class="docutils literal"><span class="pre">True</span></code> by default.  (Contributed by
William Mallard in <a class="reference external" href="https://bugs.python.org/issue17201">issue 17201</a>.)</p>
</div>
</div>
</div></body></html>