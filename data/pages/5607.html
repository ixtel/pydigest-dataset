<html><body><div><div id="quickstart">
<h3>Quickstart</h3>
<p>Below is an example of a <tt>vladfile.py</tt></p>
<pre><span class="kn">from</span> <span class="nn">vladiate</span> <span class="kn">import</span> <span class="n">Vlad</span>
<span class="kn">from</span> <span class="nn">vladiate.validators</span> <span class="kn">import</span> <span class="n">UniqueValidator</span><span class="p">,</span> <span class="n">SetValidator</span>
<span class="kn">from</span> <span class="nn">vladiate.inputs</span> <span class="kn">import</span> <span class="n">LocalFile</span>

<span class="k">class</span> <span class="nc">YourFirstValidator</span><span class="p">(</span><span class="n">Vlad</span><span class="p">):</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">LocalFile</span><span class="p">(</span><span class="s1">'vampires.csv'</span><span class="p">)</span>
    <span class="n">validators</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'Column A'</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">UniqueValidator</span><span class="p">()</span>
        <span class="p">],</span>
        <span class="s1">'Column B'</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SetValidator</span><span class="p">([</span><span class="s1">'Vampire'</span><span class="p">,</span> <span class="s1">'Not A Vampire'</span><span class="p">])</span>
        <span class="p">]</span>
    <span class="p">}</span>
</pre>
<p>Here we define a number of validators for a local file <tt>vampires.csv</tt>,
which would look like this:</p>
<pre>Column A,Column B
Vlad the Impaler,Not A Vampire
Dracula,Vampire
Count Chocula,Vampire
</pre>
<p>We then run <tt>vladiate</tt> in the same directory as your <tt>.csv</tt> file:</p>
<pre>$ vladiate
</pre>
<p>And get the following output:</p>
<pre>Validating YourFirstValidator(source=LocalFile('vampires.csv'))
Passed! :)
</pre>
<div id="handling-changes">
<h4>Handling Changes</h4>
<p>Let’s imagine that you’ve gotten a new CSV file,
<tt>potential_vampires.csv</tt>, that looks like this:</p>
<pre>Column A,Column B
Vlad the Impaler,Not A Vampire
Dracula,Vampire
Count Chocula,Vampire
Ronald Reagan,Maybe A Vampire
</pre>
<p>If we were to update our first validator to use this file as follows:</p>
<pre>- class YourFirstValidator(Vlad):
-     source = LocalFile('vampires.csv')
+ class YourFirstFailingValidator(Vlad):
+     source = LocalFile('potential_vampires.csv')
</pre>
<p>we would get the following error:</p>
<pre>Validating YourFirstFailingValidator(source=LocalFile('potential_vampires.csv'))
Failed :(
  SetValidator failed 1 time(s) on field: 'Column B'
    Invalid fields: ['Maybe A Vampire']
</pre>
<p>And we would know that we’d either need to sanitize this field, or add
it to the <tt>SetValidator</tt>.</p>
</div>
<div id="starting-from-scratch">
<h4>Starting from scratch</h4>
<p>To make writing a new <tt>vladfile.py</tt> easy, Vladiate will give
meaningful error messages.</p>
<p>Given the following as <tt>real_vampires.csv</tt>:</p>
<pre>Column A,Column B,Column C
Vlad the Impaler,Not A Vampire
Dracula,Vampire
Count Chocula,Vampire
Ronald Reagan,Maybe A Vampire
</pre>
<p>We could write a bare-bones validator as follows:</p>
<pre><span class="k">class</span> <span class="nc">YourFirstEmptyValidator</span><span class="p">(</span><span class="n">Vlad</span><span class="p">):</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">LocalFile</span><span class="p">(</span><span class="s1">'real_vampires.csv'</span><span class="p">)</span>
    <span class="n">validators</span> <span class="o">=</span> <span class="p">{}</span>
</pre>
<p>Running this with <tt>vladiate</tt> would give the following error:</p>
<pre>Validating YourFirstEmptyValidator(source=LocalFile('real_vampires.csv'))
Missing...
  Missing validators for:
    'Column A': [],
    'Column B': [],
    'Column C': [],
</pre>
<p>Vladiate expects something to be specified for every column, <em>even if it
is an empty list</em> (more on this later). We can easily copy and paste
from the error into our <tt>vladfile.py</tt> to make it:</p>
<pre><span class="k">class</span> <span class="nc">YourFirstEmptyValidator</span><span class="p">(</span><span class="n">Vlad</span><span class="p">):</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">LocalFile</span><span class="p">(</span><span class="s1">'real_vampires.csv'</span><span class="p">)</span>
    <span class="n">validators</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'Column A'</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">'Column B'</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">'Column C'</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
</pre>
<p>When we run <em>this</em> with <tt>vladiate</tt>, we get:</p>
<pre>Validating YourSecondEmptyValidator(source=LocalFile('real_vampires.csv'))
Failed :(
  EmptyValidator failed 4 time(s) on field: 'Column A'
    Invalid fields: ['Dracula', 'Vlad the Impaler', 'Count Chocula', 'Ronald Reagan']
  EmptyValidator failed 4 time(s) on field: 'Column B'
    Invalid fields: ['Maybe A Vampire', 'Not A Vampire', 'Vampire']
  EmptyValidator failed 4 time(s) on field: 'Column C'
    Invalid fields: ['Real', 'Not Real']
</pre>
<p>This is because Vladiate interprets an empty list of validators for a
field as an <tt>EmptyValidator</tt>, which expects an empty string in every
field. This helps us make meaningful decisions when adding validators to
our <tt>vladfile.py</tt>. It also ensures that we are not forgetting about a
column or field which is not empty.</p>
</div>
<div id="built-in-validators">
<h4>Built-in Validators</h4>
<p>Vladiate comes with a few common validators built-in:</p>
<p><em>class</em> <tt>Validator</tt></p>
<blockquote>
Generic validator. Should be subclassed by any custom validators. Not to
be used directly.</blockquote>
<p><em>class</em> <tt>CastValidator</tt></p>
<blockquote>
Generic “can-be-cast-to-x” validator. Should be subclassed by any
cast-test validator. Not to be used directly.</blockquote>
<p><em>class</em> <tt>IntValidator</tt></p>
<blockquote>
<p>Validates whether a field can be cast to an <tt>int</tt> type or not.</p>
<table>
<colgroup><col/>
<col/>
</colgroup><tbody>
<tr><th><tt>empty_ok=False</tt>:</th><td>Specify whether a field which is an empty string should be ignored.</td>
</tr>
</tbody>
</table>
</blockquote>
<p><em>class</em> <tt>FloatValidator</tt></p>
<blockquote>
<p>Validates whether a field can be cast to an <tt>float</tt> type or not.</p>
<table>
<colgroup><col/>
<col/>
</colgroup><tbody>
<tr><th><tt>empty_ok=False</tt>:</th><td>Specify whether a field which is an empty string should be ignored.</td>
</tr>
</tbody>
</table>
</blockquote>
<p><em>class</em> <tt>SetValidator</tt></p>
<blockquote>
<p>Validates whether a field is in the specified set of possible fields.</p>
<table>
<colgroup><col/>
<col/>
</colgroup><tbody>
<tr><th><tt><span class="pre">valid_set=[]</span></tt>:</th><td>List of valid possible fields</td>
</tr>
<tr><th><tt>empty_ok=False</tt>:</th><td>Implicity adds the empty string to the specified set.</td>
</tr>
</tbody>
</table>
</blockquote>
<p><em>class</em> <tt>UniqueValidator</tt></p>
<blockquote>
<p>Ensures that a given field is not repeated in any other column. Can
optionally determine “uniqueness” with other fields in the row as well via
<tt>unique_with</tt>.</p>
<table>
<colgroup><col/>
<col/>
</colgroup><tbody>
<tr><th><tt><span class="pre">unique_with=[]</span></tt>:</th><td>List of field names to make the primary field unique with.</td>
</tr>
</tbody>
</table>
</blockquote>
<p><em>class</em> <tt>RegexValidator</tt></p>
<blockquote>
<p>Validates whether a field matches the given regex using <cite>re.match()</cite>.</p>
<table>
<colgroup><col/>
<col/>
</colgroup><tbody>
<tr><th><tt>pattern=r'di^'</tt>:</th><td>The regex pattern. Fails for all fields by default.</td>
</tr>
</tbody>
</table>
</blockquote>
<p><em>class</em> <tt>EmptyValidator</tt></p>
<blockquote>
Ensure that a field is always empty. Essentially the same as an empty
<tt>SetValidator</tt>. This is used by default when a field has no
validators.</blockquote>
<p><em>class</em> <tt>Ignore</tt></p>
<blockquote>
Always passes validation. Used to explicity ignore a given column.</blockquote>
</div>
<div id="built-in-input-types">
<h4>Built-in Input Types</h4>
<p>Vladiate comes with the following input types:</p>
<p><em>class</em> <tt>VladInput</tt></p>
<blockquote>
Generic input. Should be subclassed by any custom inputs. Not to be used
directly.</blockquote>
<p><em>class</em> <tt>LocalFile</tt></p>
<blockquote>
<p>Read from a file local to the filesystem.</p>
<table>
<colgroup><col/>
<col/>
</colgroup><tbody>
<tr><th><tt>filename</tt>:</th><td>Path to a local CSV file.</td>
</tr>
</tbody>
</table>
</blockquote>
<p><em>class</em> <tt>S3File</tt></p>
<blockquote>
<p>Read from a file in S3. Uses the <a href="https://github.com/boto/boto" rel="nofollow">boto</a>
library. Optionally can specify either a full path, or a bucket/key pair.</p>
<table>
<colgroup><col/>
<col/>
</colgroup><tbody>
<tr><th><tt>path=None</tt>:</th><td>A full S3 filepath (e.g., <tt><span class="pre">s3://foo.bar/path/to/file.csv</span></tt>)</td>
</tr>
<tr><th><tt>bucket=None</tt>:</th><td>S3 bucket. Must be specified with a <tt>key</tt>.</td>
</tr>
<tr><th><tt>key=None</tt>:</th><td>S3 key. Must be specified with a <tt>bucket</tt>.</td>
</tr>
</tbody>
</table>
</blockquote>
<p><em>class</em> <tt>String</tt></p>
<blockquote>
<p>Read CSV from a string. Can take either an <tt>str</tt> or a <tt>StringIO</tt>.</p>
<dl>
<dt>:<tt>string_input=None</tt></dt>
<dd>Regular Python string input.</dd>
<dt>:<tt>string_io=None</tt></dt>
<dd><tt>StringIO</tt> input.</dd>
</dl>
</blockquote>
</div>
<div id="running-vlads-programatically">
<h4>Running Vlads Programatically</h4>
<p><em>class</em> <tt>Vlad</tt></p>
<blockquote>
<p>Initialize a Vlad programatically</p>
<table>
<colgroup><col/>
<col/>
</colgroup><tbody>
<tr><th><tt>source</tt>:</th><td>Required. Any <cite>VladInput</cite>.</td>
</tr>
<tr><th><tt><span class="pre">validators={}</span></tt>:</th><td>List of validators. Optional, defaults to the class variable <cite>validators</cite>
if set, otherwise uses <cite>EmptyValidator</cite> for all fields.</td>
</tr>
<tr><th><tt><span class="pre">delimiter=','</span></tt>:</th><td>The delimiter used within your csv source. Optional, defaults to <cite>,</cite>.</td>
</tr>
</tbody>
</table>
<p>For example:</p>
</blockquote>
<pre><span class="kn">from</span> <span class="nn">vladiate</span> <span class="kn">import</span> <span class="n">Vlad</span>
<span class="kn">from</span> <span class="nn">vladiate.inputs</span> <span class="kn">import</span> <span class="n">LocalFile</span>
<span class="n">Vlad</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">LocalFile</span><span class="p">(</span><span class="s1">'path/to/local/file.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</pre>
</div>
</div>
<div id="command-line-arguments">
<h3>Command Line Arguments</h3>
<pre>Usage: vladiate <span class="o">[</span>options<span class="o">]</span> <span class="o">[</span>VladClass <span class="o">[</span>VladClass2 ... <span class="o">]]</span>

Options:
  -h, --help            show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -f VLADFILE, --vladfile<span class="o">=</span>VLADFILE
                        Python module file to import, e.g. <span class="s1">'../other.py'</span>.
                        Default: vladfile
  -l, --list            Show list of possible vladiate classes and <span class="nb">exit</span>
  -V, --version         show version number and <span class="nb">exit</span>
  -p PROCESSES, --processes<span class="o">=</span>PROCESSES
                        attempt to use this number of processes, Default: 1
</pre>
</div>
</div></body></html>