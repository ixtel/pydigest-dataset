<html><body><div><section class="post_content clearfix" itemprop="articleBody">
                            <p class="shareaholic-canvas" data-app-id="18930042" data-app="share_buttons" data-title="Writing IPython Notebook Plugins" data-link="https://www.safaribooksonline.com/blog/2013/12/18/ipython-notebook-plugins/" data-summary=""/><p><img alt="code" class=" wp-image-13127 alignleft thumb" src="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/12/jonathan.main_.jpg"/> <em>A guest post by Jonathan Frederic who is currently working as a full time IPython Developer. He works on the IPython Notebook and related tools, and enjoys spending his spare time writing a video game in Python. He can be contacted either by email at <a href="mailto:jonathan@bitplexity.com">jonathan@bitplexity.com</a> or on GitHub at <a href="https://github.com/jdfreder">github.com/jdfreder</a>.</em></p>
<p>In my last post covering the IPython Notebook, I showed you how to <a href="https://www.safaribooksonline.com/blog/2013/12/12/start-ipython-notebook/">get started</a>. In this post I will show you how to write plugins for both the IPython Notebook and nbconvert.  The plugins will work together, enabling you to interactively exclude cells in exported notebooks.  To do this, you will write two plugins.  The first plugin will allow you to select which cells to exclude. The second plugin will exclude the cells during export of the notebook.<span id="more-12964"/></p>
<p>This post was written and tested on Lubuntu 13.10 and assumes that you have read the <a href="https://www.safaribooksonline.com/blog/2013/12/12/start-ipython-notebook/">getting started</a> post. </p>
<h2>Notebook Plugin</h2>
<p>To start with, a GUI is required that allows you to select what cells should be excluded. The IPython Notebook’s GUI can be extended with custom features to allow you to do this. A notebook plugin has the ability to register custom toolbars.</p>
<h3>Loading Custom Notebook Code</h3>
<p>To add custom content to the notebook server, you need to create an IPython user profile.  Do this by running:</p>

		<div id="crayon-56d5b2af1cecc171223052" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b2af1cecc171223052-1"><span class="crayon-h">    </span><span class="crayon-e">ipython </span><span class="crayon-e">profile </span><span class="crayon-e">create</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cecc171223052-2"><span class="crayon-e">    </span><span class="crayon-i">cd</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-e">ipython </span><span class="crayon-e">locate </span><span class="crayon-v">profile</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<blockquote><p><strong>Note</strong>:  If you have Python 3.x installed on your machine, you will need to replace <code>ipython</code> in all of the shell commands in this post with <code>ipython3</code>.</p></blockquote>
<p>After running the commands above, the current working directory will be changed to your new profile’s directory.  In this new directory, you need to make a subdirectory named <code>static/custom</code>.  The name of the subdirectories are significant.  IPython will look for and load files from within this directory because of its name.  You can make the directory via the terminal by running:</p>

		<div id="crayon-56d5b2af1ced8451165265" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b2af1ced8451165265-1"><span class="crayon-h">    </span><span class="crayon-e">mkdir </span><span class="crayon-m">static</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1ced8451165265-2"><span class="crayon-h">    </span><span class="crayon-e">mkdir </span><span class="crayon-m">static</span><span class="crayon-o">/</span><span class="crayon-e">custom</span></p><p class="crayon-line" id="crayon-56d5b2af1ced8451165265-3"><span class="crayon-e">    </span><span class="crayon-e">cd </span><span class="crayon-m">static</span><span class="crayon-o">/</span><span class="crayon-v">custom</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>Create a <code>custom.js</code> file inside the new directory using your favorite JavaScript editor (I prefer <a href="https://www.sublimetext.com/">Sublime Text</a>.  Paste the following code into the file:</p>
<p/>

		<div id="crayon-56d5b2af1cedc342243790" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b2af1cedc342243790-1"><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">IPython</span><span class="crayon-sy">.</span><span class="crayon-v">events</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'app_initialized.NotebookApp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cedc342243790-2"><span class="crayon-h">        </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'custom/excluder'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b2af1cedc342243790-3"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>The code inside the new <code>custom.js</code> file registers an IPython event handler that fires when a notebook page is loaded.  When it is triggered, the handler will try to load an <code>excluder.js</code> file located in the current directory.</p>
<p>The IPython notebook uses <a href="http://requirejs.org/">require.js</a> to load JavaScript dependencies.  In the code above, require.js is used to load the <code>excluder.js</code> file from the <code>static/custom/</code> directory you created.  The <code>static/</code> doesn’t appear in the code because it is automatically pre-pended by IPython.  </p>
<p>Create an <code>excluder.js</code> file in the current directory and paste the following into it:</p>
<p/>

		<div id="crayon-56d5b2af1cee0297859905" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b2af1cee0297859905-1"><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">"Our extension was loaded successfully"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>When this code is executed, it will log the above message to the JavaScript console.</p>
<p>In a new terminal window, navigate to your notebook directory and start the notebook server by running:</p>

		

<p/>
<p>Your default web browser will launch and show the notebook dashboard.  At this point, you need to clear the cache of your web browser (you do not need to clear your history or cookies).  Instructions on how to do this can be found at:</p>

<p>Once the cache is cleared, refresh the page.  Create a new notebook or open an existing notebook and show the browser’s JavaScript console.  Instructions on how to do this can be found at:</p>

<p>You will see “Our extension was loaded successfully” shown in the console (as seen below).</p>
<p><a href="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/12/t2_p1.jpg"><img alt="t2_p1" class="aligncenter size-full wp-image-13201" src="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/12/t2_p1.jpg"/></a></p>
<h3>Custom Toolbar</h3>
<p>Now that we have verified that the JavaScript is loading correctly, a custom toolbar can be created. </p>
<p>Toolbars must be registered by name.  Every toolbar is a list of <em>control constructing</em> method names.  Each control constructing method in the toolbar must be registered with IPython using a unique name.</p>
<p>Replace the code in the <code>excluder.js</code> file created earlier with the code below:</p>
<p/>

		<div id="crayon-56d5b2af1cee8186721746" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-2">2</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-4">4</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-6">6</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-8">8</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-10">10</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-12">12</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-14">14</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-16">16</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-18">18</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-20">20</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-22">22</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-24">24</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-26">26</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-28">28</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-30">30</p><p class="crayon-num" data-line="crayon-56d5b2af1cee8186721746-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b2af1cee8186721746-32">32</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-1"><span class="crayon-c">// Create and register the method that creates the checkbox that </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-2"><span class="crayon-c">// alters the new 'exclude'</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-3"><span class="crayon-c">// flag of the cell's metadata.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-4"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">flag_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'exclude_cell'</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-5"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">cell_flag_init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">IPython</span><span class="crayon-sy">.</span><span class="crayon-v">CellToolbar</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">checkbox_ui_generator</span><span class="crayon-sy">(</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-6"> </p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-7"><span class="crayon-h">    </span><span class="crayon-c">// Name</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-8"><span class="crayon-h">    </span><span class="crayon-v">flag_name</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-10"><span class="crayon-h">    </span><span class="crayon-c">// Setter, called when the checkboxes state has been changed.  </span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-11"><span class="crayon-h">    </span><span class="crayon-c">// Sets the flag name and</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-12"><span class="crayon-h">    </span><span class="crayon-c">// value in the cell's metadata.</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-13"><span class="crayon-h">    </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">cell</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-14"><span class="crayon-h">        </span><span class="crayon-v">cell</span><span class="crayon-sy">.</span><span class="crayon-v">metadata</span><span class="crayon-sy">[</span><span class="crayon-v">flag_name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-15"><span class="crayon-h">    </span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-16"> </p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-17"><span class="crayon-h">    </span><span class="crayon-c">// Getter, called when the control is rendered.  Determines the initial </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-18"><span class="crayon-h">    </span><span class="crayon-c">// state of the checkbox.  If the flag doesn't in the metadata, default </span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-19"><span class="crayon-h">    </span><span class="crayon-c">// to false.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-20"><span class="crayon-h">    </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">cell</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h"> </span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-21"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">cell</span><span class="crayon-sy">.</span><span class="crayon-v">metadata</span><span class="crayon-sy">[</span><span class="crayon-v">flag_name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-v">undefined</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">cell</span><span class="crayon-sy">.</span><span class="crayon-v">metadata</span><span class="crayon-sy">[</span><span class="crayon-v">flag_name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-22"><span class="crayon-h">           </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-23"><span class="crayon-h">            </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-24"><span class="crayon-h">        </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-25"><span class="crayon-h">            </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-26"><span class="crayon-h">        </span><span class="crayon-sy">}</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-27"><span class="crayon-h">    </span><span class="crayon-sy">}</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-28"><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-29"><span class="crayon-v">IPython</span><span class="crayon-sy">.</span><span class="crayon-v">CellToolbar</span><span class="crayon-sy">.</span><span class="crayon-e">register_callback</span><span class="crayon-sy">(</span><span class="crayon-v">flag_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cell_flag_init</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-30"> </p><p class="crayon-line" id="crayon-56d5b2af1cee8186721746-31"><span class="crayon-c">// Create and register the toolbar with IPython.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cee8186721746-32"><span class="crayon-v">IPython</span><span class="crayon-sy">.</span><span class="crayon-v">CellToolbar</span><span class="crayon-sy">.</span><span class="crayon-e">register_preset</span><span class="crayon-sy">(</span><span class="crayon-s">'Export Cell Exclusion'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">flag_name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>When executed, this code will create a cell toolbar with a checkbox.  The toolbar’s unique name will be “Export Cell Exclusion”.  The checkbox in the toolbar manages a new flag in the cell’s metadata called <code>exclude_cell</code>.</p>
<blockquote><p><strong>Note</strong>: The naming of the flag does not matter.</p></blockquote>
<p>Return to the notebook dashboard and empty the cache of your web browser.  Create a new notebook and in the <em>cell toolbar</em> drop down select “Export Cell Exclusion”.  This will prepend  every cell in the notebook with an “exclude_cell” checkbox (as seen below).  Checking or unchecking any of these cells toggles the new flag that we added.  Toggle one of the cells and save the notebook and exit.</p>
<p><a href="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/12/t2_p2.jpg"><img alt="t2_p2" class="aligncenter size-full wp-image-13202" src="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/12/t2_p2.jpg"/></a></p>
<p>The new <em>exclude_cell</em> flag can be seen in the notebook’s JSON (as seen below).</p>
<p/>

		<div id="crayon-56d5b2af1ceed051302310" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b2af1ceed051302310-1"><span class="crayon-s">"metadata"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1ceed051302310-2"><span class="crayon-s">"exclude_cell"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></p><p class="crayon-line" id="crayon-56d5b2af1ceed051302310-3"><span class="crayon-sy">}</span><span class="crayon-sy">,</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h2>Nbconvert Plugin</h2>
<p>The second plugin will exclude the cells during export of the notebook.  This plugin will remove cells flagged with <code>exclude_cell</code>.  This plugin will implement a custom <em>transformer</em>.  A transformer is a component used in nbconvert to preprocess an entire notebook before the notebook is actually converted.</p>
<blockquote><p><strong>Note</strong>:  In IPython 2.0 (not yet released) <code>transformers</code> have been renamed to <code>preprocessors</code>.</p></blockquote>
<p>Within the same directory where your notebook resides, create a file named <code>exclude_transformer.py</code>.  Insert the following code into the file:</p>
<p/>

		<div id="crayon-56d5b2af1cef1126660790" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b2af1cef1126660790-1"><span class="crayon-e">from </span><span class="crayon-v">IPython</span><span class="crayon-sy">.</span><span class="crayon-v">nbconvert</span><span class="crayon-sy">.</span><span class="crayon-v">transformers</span><span class="crayon-sy">.</span><span class="crayon-e">base </span><span class="crayon-e">import </span><span class="crayon-e">Transformer</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cef1126660790-2"> </p><p class="crayon-line" id="crayon-56d5b2af1cef1126660790-3"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">ExcludeTransformer</span><span class="crayon-sy">(</span><span class="crayon-v">Transformer</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cef1126660790-4"><span class="crayon-h">    </span><span class="crayon-e">def </span><span class="crayon-e">call</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">resources</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b2af1cef1126660790-5"><span class="crayon-h">        </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cef1126660790-6"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">worksheet </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">nb</span><span class="crayon-sy">.</span><span class="crayon-v">worksheets</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b2af1cef1126660790-7"><span class="crayon-h">            </span><span class="crayon-v">remove_cells</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cef1126660790-8"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">cell </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">worksheet</span><span class="crayon-sy">.</span><span class="crayon-v">cells</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b2af1cef1126660790-9"><span class="crayon-h">                </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-s">'exclude_cell'</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">cell</span><span class="crayon-sy">.</span><span class="crayon-e">metadata </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">cell</span><span class="crayon-sy">.</span><span class="crayon-v">metadata</span><span class="crayon-sy">.</span><span class="crayon-v">exclude_cell</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cef1126660790-10"><span class="crayon-h">                    </span><span class="crayon-v">remove_cells</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b2af1cef1126660790-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cef1126660790-12"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">remove_cells</span><span class="crayon-sy">[</span><span class="crayon-o">::</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b2af1cef1126660790-13"><span class="crayon-h">                </span><span class="crayon-e">del </span><span class="crayon-v">worksheet</span><span class="crayon-sy">.</span><span class="crayon-v">cells</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cef1126660790-14"><span class="crayon-h">                </span></p><p class="crayon-line" id="crayon-56d5b2af1cef1126660790-15"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">nb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">resources</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>In the code above, the <code>IPython.nbconvert.transformer.base.Transformer</code> base class is inherited to create a custom transformer.  To get the custom transformer to load into nbconvert, an IPython nbconvert config file will be used.  </p>
<p>Create a file named <code>ipython_nbconvert_config.py</code> in the current directory.  This is a special file name that nbconvert always looks for in the current working directory.  If this file exists, nbconvert will load it as a configuration file.  Insert the following configuration code into the new file:</p>
<p/>

		<div id="crayon-56d5b2af1cef5686803525" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b2af1cef5686803525-1"><span class="crayon-v">C</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_config</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b2af1cef5686803525-2"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-v">Exporter</span><span class="crayon-sy">.</span><span class="crayon-v">transformers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span>‘<span class="crayon-v">exclude_transformer</span><span class="crayon-sy">.</span><span class="crayon-i">ExcludeTransformer</span>’<span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p>The code above loads the transformer when exporting a notebook.  Any notebooks in the same directory as the transformer and the config created above will be converted and flagged cells will be excluded (as seen below).</p>
<p><a href="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/12/t2_p3.jpg"><img alt="t2_p3" class="aligncenter size-full wp-image-13203" src="https://www.safaribooksonline.com/blog/wp-content/uploads/2013/12/t2_p3.jpg"/></a></p>
<p>I hope this post has helped you understand how to write plugins for both the IPython Notebook and for nbconvert. </p>
<p>See below for IPython resources from Safari Books Online.</p>
<p>Not a subscriber? Sign up for a <a href="https://ssl.safaribooksonline.com/trial?iid=2012-10-01-freetrial-SBOBlog&amp;promocode=blog1999_1307" target="_blank">free trial</a>.</p>
<h2>Safari Books Online has the content you need</h2>
<table>
<tbody>
<tr>
<td><a href="https://www.safaribooksonline.com/library/view/mining-the-social/9781449368180/" target="_blank"><img alt="" hspace="70" src="https://www.safaribooksonline.com/library/cover/9781449368180/" vspace="30"/></a></td>
<td><a href="https://www.safaribooksonline.com/library/view/mining-the-social/9781449368180/" target="_blank">Mining the Social Web, 2nd Edition</a> combines popular and useful social web data with analysis techniques and visualization to help you find the needles in the social haystack that you’ve been looking for—as well as many you probably didn’t even know existed. You’ll also find an appendix that covers IPython Notebook tips and tricks.</td>
</tr>
<tr>
<td><a href="https://www.safaribooksonline.com/library/view/learning-ipython-for/9781782169932/" target="_blank"><img alt="" hspace="70" src="https://www.safaribooksonline.com/library/cover/9781782169932/" vspace="30"/></a></td>
<td><a href="https://www.safaribooksonline.com/library/view/learning-ipython-for/9781782169932/" target="_blank">Learning IPython for Interactive Computing and Data Visualization</a> covers all aspects of IPython, from the highly powerful interactive Python console to the numerical and visualization features that are commonly associated with IPython.</td>
</tr>
<tr>
<td><a href="https://www.safaribooksonline.com/library/view/practical-data-analysis/9781783280995/" target="_blank"><img alt="" hspace="70" src="https://www.safaribooksonline.com/library/cover/9781783280995/" vspace="30"/></a></td>
<td><a href="https://www.safaribooksonline.com/library/view/practical-data-analysis/9781783280995/" target="_blank">Practical Data Analysis</a> is a hands-on guide to understanding the nature of your data and turn it into insight. It will introduce you to the use of machine learning techniques, social networks analytics, and econometrics to help your clients get insights about the pool of data they have at hand. Performing data preparation and processing over several kinds of data such as text, images, graphs, documents, and time series will also be covered, and covers the IPython Notebook.</td>
</tr>
</tbody>
</table>
                          
                            
                                                
                        </section> 
                        
                        </div></body></html>