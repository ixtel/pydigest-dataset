<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-python-o365---office365-for-you-server" class="anchor" href="#python-o365---office365-for-you-server" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Python-O365 - Office365 for you server</h1>

<p>The objective O365 is to make it easy to make utilities that are to be run against an Office 365 account. If you wanted to script sending an email it could be as simple as:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> <span class="pl-c1">O365</span> <span class="pl-k">import</span> Message
authenticiation <span class="pl-k">=</span> (<span class="pl-s"><span class="pl-pds">'</span>YourAccount@office365.com<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>YourPassword<span class="pl-pds">'</span></span>)
m <span class="pl-k">=</span> Message(<span class="pl-v">auth</span><span class="pl-k">=</span>authenticiation)
m.setRecipients(<span class="pl-s"><span class="pl-pds">'</span>reciving@office365.com<span class="pl-pds">'</span></span>)
m.setSubject(<span class="pl-s"><span class="pl-pds">'</span>I made an email script.<span class="pl-pds">'</span></span>)
m.setBody(<span class="pl-s"><span class="pl-pds">'</span>Talk to the computer, cause the human does not want to hear it any more.<span class="pl-pds">'</span></span>)
m.sendMessage()</pre></div>

<p>To keep the library simple but powerful there are wrapper methods to access most of the attributes:</p>



<p>But all attributes listed on the documenation for the <a href="https://msdn.microsoft.com/office/office365/APi/api-catalog">Office365 API</a> are available through the json representation stored in the instance of every O365 object:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">if</span> m.json[<span class="pl-s"><span class="pl-pds">'</span>IsReadReceiptRequested<span class="pl-pds">'</span></span>]:
    m.reply(<span class="pl-s"><span class="pl-pds">'</span>Got it.<span class="pl-pds">'</span></span>)</pre></div>

<h2><a id="user-content-table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Table of contents</h2>



<h2><a id="user-content-email" class="anchor" href="#email" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Email</h2>

<p>There are two classes for working with emails in O365.</p>

<h4><a id="user-content-inbox" class="anchor" href="#inbox" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Inbox</h4>

<p>A collection of emails. This is used when ever you are requesting an email or emails. It can be set with filters so that you only download the emails which your script is interested in. </p>

<h4><a id="user-content-message" class="anchor" href="#message" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Message</h4>

<p>An actual email with all it's associated data.</p>

<p>In the <a href="https://github.com/Narcolapser/python-o365/blob/master/examples/fetchFile.py">Fetch File</a> example a filter is used to get only the unread messages with the subject line "Fetch File"</p>

<div class="highlight highlight-source-python"><pre>i <span class="pl-k">=</span> Inbox(e,p,<span class="pl-v">getNow</span><span class="pl-k">=</span><span class="pl-c1">False</span>) <span class="pl-c">#Email, Password, Delay fetching so I can change the filters.</span>

i.setFilter(<span class="pl-s"><span class="pl-pds">"</span>IsRead eq false &amp; Subject eq 'Fetch File'<span class="pl-pds">"</span></span>)

i.getMessages()</pre></div>

<p>When the inbox has run it's getMessages method, whether when it is instanced or later, all the messages it retrieves will be stored in a list local to the instance of inbox. Inbox.messages</p>

<p>While the Inbox class is used exclusively for incoming mail, as the name might imply, the message class is incoming and out going. In the fetch file example in it's processMessage method it work with both an incoming message, "m", and prepares an out going message, "resp":</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">processMessage</span>(<span class="pl-smi">m</span>):
    path <span class="pl-k">=</span> m.json[<span class="pl-s"><span class="pl-pds">'</span>BodyPreview<span class="pl-pds">'</span></span>]

    path <span class="pl-k">=</span> path[:path.index(<span class="pl-s"><span class="pl-pds">'</span><span class="pl-cce">\n</span><span class="pl-pds">'</span></span>)]
    <span class="pl-k">if</span> path[<span class="pl-k">-</span><span class="pl-c1">1</span>] <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-cce">\r</span><span class="pl-pds">'</span></span>:
        path <span class="pl-k">=</span> path[:<span class="pl-k">-</span><span class="pl-c1">1</span>]

    att <span class="pl-k">=</span> Attachment(<span class="pl-v">path</span><span class="pl-k">=</span>path)

    resp <span class="pl-k">=</span> Message(<span class="pl-v">auth</span><span class="pl-k">=</span>auth)
    resp.setRecipients(m.getSender())

    resp.setSubject(<span class="pl-s"><span class="pl-pds">'</span>Your file sir!<span class="pl-pds">'</span></span>)
    resp.setBody(path)
    resp.attachments.append(att)
    resp.sendMessage()

    <span class="pl-k">return</span> <span class="pl-c1">True</span></pre></div>

<p>In this method we pull the BodyPreview, less likely to have Markup, and pull out it's first line to get the path to a file. That path is then sent to the attachment class and a response message is created and sent. Simple and straight forward.</p>

<p>The attachment class is a relatively simple class for handling downloading and creating attachments. Attachments in Office365 are stored seperately from the email in most cases and as such will have to be downloaded and uploaded seperately as well. This however is also taken care of behind the scenes with O365. Simply call a message's getAttachments method to download the attachments locally to your process. This creates a list of attachments local to the instance of Message, as is seen in the <a href="https://github.com/Narcolapser/python-o365/blob/master/examples/EmailPrinting/emailprinting.py">Email Printing example</a>:</p>

<div class="highlight highlight-source-python"><pre>m.fetchAttachments()
<span class="pl-k">for</span> att <span class="pl-k">in</span> m.attachments:
    processAttachment(att,resp)
<span class="pl-c">#various un-related bits left out for brevity.</span></pre></div>

<p>The attachment class stores the files as base64 encoded files. But this doesn't matter to you! The attachment class can work with you if you want to just send/recieve raw binary or base64. You can also just give it a path to a file if you want to creat an attachment:</p>

<div class="highlight highlight-source-python"><pre>att <span class="pl-k">=</span> Attachment(<span class="pl-v">path</span><span class="pl-k">=</span>path)</pre></div>

<p>or if you want to save the file</p>

<pre><code>att.save(path)
</code></pre>

<h2><a id="user-content-calendar" class="anchor" href="#calendar" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Calendar</h2>

<p>Events are on a Calendar, Calendars are grouped into a Schedule. In the <a href="https://github.com/Narcolapser/python-o365/blob/master/examples/VehicleBookings/veh.py">Vehicle Booking</a> example the purpose of the script is to create a json file with information to be imported into another program for presentation. We want to know all of the times the vehicles are booked out, for each vehicle, and by who, etc. This is done by simple getting the schedule and calendar for each vehicle and spitting out it's events:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">for</span> veh <span class="pl-k">in</span> vj:
    e <span class="pl-k">=</span> veh[<span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>]
    p <span class="pl-k">=</span> veh[<span class="pl-s"><span class="pl-pds">'</span>password<span class="pl-pds">'</span></span>]

    schedule <span class="pl-k">=</span> Schedule(e,p)
    <span class="pl-k">try</span>:
        result <span class="pl-k">=</span> schedule.getCalendars()
        <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">'</span>Fetched calendars for<span class="pl-pds">'</span></span>,e,<span class="pl-s"><span class="pl-pds">'</span>was successful:<span class="pl-pds">'</span></span>,result
    <span class="pl-k">except</span>:
        <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">'</span>Login failed for<span class="pl-pds">'</span></span>,e

    bookings <span class="pl-k">=</span> []

    <span class="pl-k">for</span> cal <span class="pl-k">in</span> schedule.calendars:
        <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">'</span>attempting to fetch events for<span class="pl-pds">'</span></span>,e
        <span class="pl-k">try</span>:
            result <span class="pl-k">=</span> cal.getEvents()
            <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">'</span>Got events<span class="pl-pds">'</span></span>,result,<span class="pl-s"><span class="pl-pds">'</span>got<span class="pl-pds">'</span></span>,<span class="pl-c1">len</span>(cal.events)
        <span class="pl-k">except</span>:
            <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">'</span>failed to fetch events<span class="pl-pds">'</span></span>
        <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">'</span>attempting for event information<span class="pl-pds">'</span></span>
        <span class="pl-k">for</span> event <span class="pl-k">in</span> cal.events:
            <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">'</span>HERE!<span class="pl-pds">'</span></span>
            bookings.append(event.fullcalendarioJson())
    json_outs[e] <span class="pl-k">=</span> bookings</pre></div>

<p>Events can be made relatively easily too. You just have to create a event class:</p>

<div class="highlight highlight-source-python"><pre>e <span class="pl-k">=</span> Event(authentication,parentCalendar)</pre></div>

<p>and give it a few nesessary details:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> time
e.setSubject(<span class="pl-s"><span class="pl-pds">'</span>Coffee!<span class="pl-pds">'</span></span>)
e.setStart(time.gmtime(time.time()<span class="pl-k">+</span><span class="pl-c1">3600</span>)) <span class="pl-c">#start an hour from now.</span>
e.setEnd(time.gmtime(time.time()<span class="pl-k">+</span><span class="pl-c1">7200</span>)) <span class="pl-c">#end two hours from now.</span>
new_e <span class="pl-k">=</span> e.create()</pre></div>

<h2><a id="user-content-contacts" class="anchor" href="#contacts" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Contacts</h2>

<p>Contacts are a small part of this library, but can have their use. You can store email addresses in your contacts list in folders and then use this as a form of mailing list:</p>

<div class="highlight highlight-source-python"><pre>e <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>youremail@office365.com<span class="pl-pds">'</span></span>
p <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>embarrassingly simple password.<span class="pl-pds">'</span></span>
group <span class="pl-k">=</span> Group(e,p,<span class="pl-s"><span class="pl-pds">'</span>Contact folder name<span class="pl-pds">'</span></span>)
m <span class="pl-k">=</span> Message(<span class="pl-v">auth</span><span class="pl-k">=</span>(e,p))
m.setSubject(<span class="pl-s"><span class="pl-pds">'</span>News for today<span class="pl-pds">'</span></span>)
m.setBody(<span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>news.html<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>r<span class="pl-pds">'</span></span>).read())
m.setRecipients(group)
m.sendMessage()</pre></div>

<h2><a id="user-content-looking-for-new-maintainer" class="anchor" href="#looking-for-new-maintainer" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Looking for new maintainer</h2>

<p>I no longer, as of October 2015, have an office365 account and so I'm looking for someone to take over this project. Please fork and carry on.</p>

<h4><a id="user-content-soli-deo-gloria" class="anchor" href="#soli-deo-gloria" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Soli Deo Gloria</h4>
</article>
  </div></body></html>