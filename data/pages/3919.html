<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-creating--releasing-a-new-project-in-10-minutes" class="anchor" href="#creating--releasing-a-new-project-in-10-minutes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Creating + Releasing a New Project in 10 Minutes</h1>

<p><em>This is a practical demo with screenshots of how this Cookiecutter
template can be used to create a project from scratch without much effort,
how to develop and release it – while applying testing and code quality controls –
and finally end up with a fully working CLI tool stub installed as a Debian package.</em></p>

<h2><a id="user-content-preparation" class="anchor" href="#preparation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Preparation</h2>

<p>Install a few tools.</p>

<div class="highlight highlight-source-shell"><pre><span class="pl-c"># create demo sandbox</span>
rm -rf <span class="pl-k">~</span>/src/cc-demo<span class="pl-k">;</span> mkdir -p <span class="pl-k">~</span>/src/cc-demo<span class="pl-k">;</span> <span class="pl-c1">cd</span> <span class="pl-k">~</span>/src/cc-demo

git clone -b <span class="pl-s"><span class="pl-pds">"</span>enriched-context-for-hooks<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>https://github.com/jhermann/cookiecutter.git<span class="pl-pds">"</span></span>
git clone <span class="pl-s"><span class="pl-pds">"</span>https://github.com/jhermann/rituals<span class="pl-pds">"</span></span>
git clone <span class="pl-s"><span class="pl-pds">"</span>https://github.com/Springerle/py-generic-project<span class="pl-pds">"</span></span>
git clone <span class="pl-s"><span class="pl-pds">"</span>https://github.com/Springerle/dh-virtualenv-mold<span class="pl-pds">"</span></span></pre></div>

<h2><a id="user-content-bootstrap" class="anchor" href="#bootstrap" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Bootstrap</h2>

<p>Create a virtualenv with Cookiecutter installed into it.</p>

<div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> py-generic-project
<span class="pl-c1">.</span> .env --yes --develop
pip -q install -e ../cookiecutter <span class="pl-c"># activate patched version</span>
cookiecutter --version</pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo010.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo010.png" alt="Bootstrap #1"/></a></p>

<p>Now use the locally cloned Cookiecutter template “py-generic-project”
to create our demo project.
Normally you'd do that directly from the GitHub repository (using its URL instead of ‘<code>.</code>’).</p>

<div class="highlight highlight-source-shell"><pre>rm -rf new-project <span class="pl-c"># make sure there is nothing there</span>
cookiecutter --no-input <span class="pl-c1">.</span></pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo020.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo020.png" alt="Bootstrap #2"/></a></p>

<p>Add the created files immediately into a new <code>git</code> repo,
and tag that tree for easy incremental updates of the template.</p>

<div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> new-project
git init<span class="pl-k">;</span> git add <span class="pl-c1">.</span>
git commit -m <span class="pl-s"><span class="pl-pds">"</span>New project from py-generic-project cookiecutter<span class="pl-pds">"</span></span>
git tag -a <span class="pl-s"><span class="pl-pds">"</span>v0<span class="pl-pds">"</span></span> -m <span class="pl-s"><span class="pl-pds">"</span>Cookiecutter update reference<span class="pl-pds">"</span></span></pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo030.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo030.png" alt="Bootstrap #3"/></a></p>

<p>Create a second virtualenv, this time for the new project.</p>



<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo040.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo040.png" alt="Bootstrap #4"/></a></p>

<h2><a id="user-content-developing" class="anchor" href="#developing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Developing</h2>

<p>Run the unit tests (<code>inv</code> is the short form of <code>invoke</code>).</p>



<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo110.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo110.png" alt="Development Test"/></a></p>

<p>Run the code quality checks.</p>



<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo120.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo120.png" alt="Development Check"/></a></p>

<p>Assuming you have a local <code>devpi</code> install (see “References” below for more),
you can now release a development version for use by your co-workers.</p>

<div class="highlight highlight-source-shell"><pre>devpi use <span class="pl-s"><span class="pl-pds">"</span>http://localhost:3141/<span class="pl-pds">"</span></span>
devpi login <span class="pl-s"><span class="pl-pds">"</span>local<span class="pl-pds">"</span></span>
devpi use <span class="pl-s"><span class="pl-pds">"</span>local/dev<span class="pl-pds">"</span></span></pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo130.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo130.png" alt="Development &quot;devpi use&quot;"/></a></p>

<p>Bump the version number to uniquely identify what we're releasing
– the created version number is compliant to PEP-440.</p>

<div class="highlight highlight-source-shell"><pre>inv release.bump
inv release.dist --devpi</pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo140.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo140.png" alt="Development Dist"/></a></p>

<p>    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇    </p>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo141.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo141.png" alt="Development Dist"/></a></p>

<p>The template also contains skeletons for normal and test modules.</p>

<div class="highlight highlight-source-shell"><pre><span class="pl-c"># use this to add new modules with a simple "cp"</span>
view project.d/skeleton_module.py</pre></div>

<h2><a id="user-content-releasing" class="anchor" href="#releasing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Releasing</h2>

<p>Prepare your working directory for a release.</p>



<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo151.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo151.png" alt="Release Prep try'n'error"/></a></p>

<p>Oops, we still have those development release version changes lying around! <img class="emoji" title=":blush:" alt=":blush:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f60a.png" align="absmiddle"/></p>

<p>And creating ‘official’ releases from a dirty working directory is not such a great idea,
thus the error message. Let's try that again…</p>

<div class="highlight highlight-source-shell"><pre>git checkout HEAD -- setup.cfg
inv release.prep
git show HEAD</pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo152.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo152.png" alt="Release Prep #1"/></a></p>

<p>    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇   </p>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo153.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo153.png" alt="Release Prep #2"/></a></p>

<p>Now make a distribution and upload it into <code>devpi</code>.</p>

<div class="highlight highlight-source-shell"><pre>inv release.dist --devpi <span class="pl-k">&gt;</span>/dev/null
devpi list new-project</pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo160.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo160.png" alt="Release devpi"/></a></p>

<h2><a id="user-content-packaging" class="anchor" href="#packaging" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Packaging</h2>

<p>OK, we now have a local developer installation of the tool, and Python packages in a repository.
Wouldn't it be great to have it as OS packages, to keep <code>/usr/local</code> clean?
Yes, indeed…</p>

<div class="highlight highlight-source-shell"><pre>cookiecutter ../../dh-virtualenv-mold
dch -r <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span> <span class="pl-c"># give the changelog a properly formatted, current date entry</span></pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo210.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo210.png" alt="Packaging create 'debian'"/></a></p>

<p>Make our tool visible in the normal <code>PATH</code> and then create the package.</p>

<div class="highlight highlight-source-shell"><pre><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>usr/share/python/new-project/bin/new-project usr/bin/new-project-cli<span class="pl-pds">"</span></span> \
    <span class="pl-k">&gt;</span>debian/new-project.links
dpkg-buildpackage -uc -us -b
dpkg -I ../<span class="pl-k">*</span>.deb</pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo220.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo220.png" alt="Packaging create 'debian'"/></a></p>

<p>    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇    ⌇   </p>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo221.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo221.png" alt="Packaging create 'debian'"/></a></p>

<p>Install &amp; enjoy…</p>

<div class="highlight highlight-source-shell"><pre>sudo dpkg -i ../<span class="pl-k">*</span>.deb
/usr/bin/new-project-cli --version</pre></div>

<p><a href="/Springerle/py-generic-project/blob/master/demo/img/demo230.png" target="_blank"><img src="/Springerle/py-generic-project/raw/master/demo/img/demo230.png" alt="Packaging create 'debian'"/></a></p>

<h2><a id="user-content-references" class="anchor" href="#references" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>References</h2>

<p><strong>Tools</strong></p>



<p><strong>Packages</strong></p>


</article>
  </div></body></html>