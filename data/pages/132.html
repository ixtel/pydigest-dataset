<html><body><div><article class="markdown-body entry-content" itemprop="text"><a href="https://camo.githubusercontent.com/09beee9f8308952ee171d1920056373ab4691368/68747470733a2f2f64726f6e652e696f2f6769746875622e636f6d2f6d61696c67756e2f666c616e6b65722f7374617475732e706e67" target="_blank"><img alt="https://drone.io/github.com/mailgun/flanker/status.png" src="https://camo.githubusercontent.com/09beee9f8308952ee171d1920056373ab4691368/68747470733a2f2f64726f6e652e696f2f6769746875622e636f6d2f6d61696c67756e2f666c616e6b65722f7374617475732e706e67" data-canonical-src="https://drone.io/github.com/mailgun/flanker/status.png"/></a>
<a name="user-content-flanker"/>
<h2><a id="user-content-flanker" class="anchor" href="#flanker" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Flanker</h2>
<p>Flanker is an open source parsing library written in Python by the Mailgun Team.
Flanker currently consists of an address parsing library (flanker.addresslib) as
well as a MIME parsing library (flanker.mime).</p>
<p>Detailed documentation is provided in the <a href="https://github.com/mailgun/flanker/blob/master/docs/User%20Manual.md">User Manual</a> as well as the
<a href="https://github.com/mailgun/flanker/blob/master/docs/API%20Reference.md">API Reference</a>. A Quickstart Guide is provided below.</p>
<a name="user-content-quickstart-guide"/>
<h3><a id="user-content-quickstart-guide" class="anchor" href="#quickstart-guide" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Quickstart Guide</h3>
<a name="user-content-installing"/>
<h4><a id="user-content-installing" class="anchor" href="#installing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installing</h4>
<p><strong>Flanker was built and tested with Python 2.7.2.</strong></p>
<p>You can install flanker via pip or clone the repo from GitHub.</p>
<p>You'll need Python headers files before you start working with flanker, so install them first:</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c"># ubuntu</span>
sudo apt-get install python-dev
<span class="pl-c"># fedora</span>
sudo yum install python-devel</pre></div>
<p>If you are using pip, simply type:</p>

<p><em>Note about installing from PyPi. Installing without specifying a version number will
install the latest version from PyPi that does not pin version dependences. This version
of Flanker will most likely work, but is not guaranteed. If you want to run a guaranteed
to work version of Flanker, run the version where we pin dependences, which is one lower
major version number. For example, if the current release is `0.4.4` then the stabled
pinned dependency version is `0.3.4`.</em></p>
<p>If you are cloning from GitHub, you can type:</p>
<div class="highlight highlight-source-shell"><pre>git clone git@github.com:mailgun/flanker.git
<span class="pl-c1">cd</span> flanker
python setup.py install</pre></div>
<a name="user-content-address-parsing"/>
<h4><a id="user-content-address-parsing" class="anchor" href="#address-parsing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Address Parsing</h4>
<p>To parse a single mailbox (display name as well as email address):</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker.addresslib <span class="pl-k">import</span> address
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> address.parse(<span class="pl-s"><span class="pl-pds">'</span>Foo foo@example.com<span class="pl-pds">'</span></span>)
Foo <span class="pl-k">&lt;</span>foo<span class="pl-k">@</span>example.com<span class="pl-k">&gt;</span></pre></div>
<p>An invalid address is returned as None:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker.addresslib <span class="pl-k">import</span> address
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">print</span> address.parse(<span class="pl-s"><span class="pl-pds">'</span>@example.com<span class="pl-pds">'</span></span>)
<span class="pl-c1">None</span></pre></div>
<p>To parse a single email address (no display name):</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker.addresslib <span class="pl-k">import</span> address
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> address.parse(<span class="pl-s"><span class="pl-pds">'</span>foo@example.com<span class="pl-pds">'</span></span>, <span class="pl-v">addr_spec_only</span><span class="pl-k">=</span><span class="pl-c1">True</span>)
foo<span class="pl-k">@</span>example.com</pre></div>
<p>To parse an address list:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker.addresslib <span class="pl-k">import</span> address
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> address.parse_list(<span class="pl-s"><span class="pl-pds">'</span>foo@example.com, bar@example.com, @example.com<span class="pl-pds">'</span></span>)
[foo<span class="pl-k">@</span>example.com, bar<span class="pl-k">@</span>example.com]</pre></div>
<p>To parse an address list as well as return a tuple containing the parsed
addresses and the unparsable portions</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker.addresslib <span class="pl-k">import</span> address
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> address.parse_list(<span class="pl-s"><span class="pl-pds">'</span>foo@example.com, bar@example.com, @example.com<span class="pl-pds">'</span></span>, <span class="pl-v">as_tuple</span><span class="pl-k">=</span><span class="pl-c1">True</span>)
[foo<span class="pl-k">@</span>example.com, bar<span class="pl-k">@</span>example.com], [<span class="pl-s"><span class="pl-pds">'</span>@example.com<span class="pl-pds">'</span></span>]</pre></div>
<p>To parse an address list in strict mode:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker.addresslib <span class="pl-k">import</span> address
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> address.parse_list(<span class="pl-s"><span class="pl-pds">'</span>foo@example.com, bar@example.com, @example.com<span class="pl-pds">'</span></span>, <span class="pl-v">strict</span><span class="pl-k">=</span><span class="pl-c1">True</span>)
[foo<span class="pl-k">@</span>example.com, bar<span class="pl-k">@</span>example.com]</pre></div>
<p>To validate an email address (parse as well as DNS, MX existence, and ESP grammar checks):</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker.addresslib <span class="pl-k">import</span> address
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> address.validate_address(<span class="pl-s"><span class="pl-pds">'</span>foo@mailgun.com<span class="pl-pds">'</span></span>)
foo<span class="pl-k">@</span>mailgun.com</pre></div>
<p>To validate an address list:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker.addresslib <span class="pl-k">import</span> address
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> address.validate_list(<span class="pl-s"><span class="pl-pds">'</span>foo@mailgun.com, bar@mailgun.com, @mailgun.com<span class="pl-pds">'</span></span>, <span class="pl-v">as_tuple</span><span class="pl-k">=</span><span class="pl-c1">True</span>)
([foo<span class="pl-k">@</span>mailgun.com, bar<span class="pl-k">@</span>mailgun.com], [<span class="pl-s"><span class="pl-pds">'</span>@mailgun.com<span class="pl-pds">'</span></span>])</pre></div>
<a name="user-content-mime-parsing"/>
<h4><a id="user-content-mime-parsing" class="anchor" href="#mime-parsing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>MIME Parsing</h4>
<p>For the following examples, message_string will be set to the following MIME message:</p>
<pre>MIME-Version: 1.0
Content-Type: multipart/alternative; boundary=001a11c1d71697c7f004e6856996
From: Bob &lt;bob@example.com&gt;
To: Alice &lt;alice@example.com&gt;
Subject: hello, world
Date: Mon, 16 Sep 2013 12:43:03 -0700

--001a11c1d71697c7f004e6856996
Content-Type: text/plain; charset=us-ascii

Hello, *Alice*

--001a11c1d71697c7f004e6856996
Content-Type: text/html; charset=us-ascii

&lt;p&gt;Hello, &lt;b&gt;Alice&lt;/b&gt;&lt;/p&gt;

--001a11c1d71697c7f004e6856996--
</pre>
<p>To parse a MIME message:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker <span class="pl-k">import</span> mime
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> msg <span class="pl-k">=</span> mime.from_string(message_string)</pre></div>
<p>MIME message headers (unicode multi-value dictionary with headers):</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker <span class="pl-k">import</span> mime
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> msg <span class="pl-k">=</span> mime.from_string(message_string)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> msg.headers.items()
[(<span class="pl-s"><span class="pl-pds">'</span>Mime-Version<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1.0<span class="pl-pds">'</span></span>),
 (<span class="pl-s"><span class="pl-pds">'</span>Content-Type<span class="pl-pds">'</span></span>,
  (<span class="pl-s"><span class="pl-pds">'</span>multipart/alternative<span class="pl-pds">'</span></span>, {<span class="pl-s"><span class="pl-pds">'</span>boundary<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-k">u</span><span class="pl-pds">'</span>001a11c1d71697c7f004e6856996<span class="pl-pds">'</span></span>})),
 (<span class="pl-s"><span class="pl-pds">'</span>From<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Bob &lt;bob@example.com&gt;<span class="pl-pds">'</span></span>),
 (<span class="pl-s"><span class="pl-pds">'</span>To<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Alice &lt;alice@example.com&gt;<span class="pl-pds">'</span></span>),
 (<span class="pl-s"><span class="pl-pds">'</span>Subject<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>hello, world<span class="pl-pds">'</span></span>),
 (<span class="pl-s"><span class="pl-pds">'</span>Date<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Mon, 16 Sep 2013 12:43:03 -0700<span class="pl-pds">'</span></span>)]</pre></div>
<p>Useful content_type member with predicates:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker <span class="pl-k">import</span> mime
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> msg <span class="pl-k">=</span> mime.from_string(message_string)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> msg.content_type.is_multipart()
<span class="pl-c1">True</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> msg.content_type.is_singlepart()
<span class="pl-c1">False</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> msg.content_type.is_message_container()
<span class="pl-c1">False</span></pre></div>
<p>Decoded body of a message:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> flanker <span class="pl-k">import</span> mime
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> msg <span class="pl-k">=</span> mime.from_string(message_string)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c"># None because message is multipart</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">print</span> msg.body
<span class="pl-c1">None</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">for</span> part <span class="pl-k">in</span> msg.parts:
       <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">'</span>Content-Type: <span class="pl-c1">{}</span> Body: <span class="pl-c1">{}</span><span class="pl-pds">'</span></span>.format(part, part.body)

Content<span class="pl-k">-</span>Type: (text<span class="pl-k">/</span>plain) Body: Hello, <span class="pl-k">*</span>Alice<span class="pl-k">*</span>
Content<span class="pl-k">-</span>Type: (text<span class="pl-k">/</span>html) Body: <span class="pl-k">&lt;</span>p<span class="pl-k">&gt;</span>Hello, <span class="pl-k">&lt;</span>b<span class="pl-k">&gt;</span>Alice<span class="pl-k">&lt;</span><span class="pl-k">/</span>b<span class="pl-k">&gt;&lt;</span><span class="pl-k">/</span>p<span class="pl-k">&gt;</span>

<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c"># None because no enclosed messages exist</span>
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1">print</span> msg.enclosed
<span class="pl-c1">None</span></pre></div>

</article>
  </div></body></html>