<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-active-alchemy" class="anchor" href="#active-alchemy" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Active-Alchemy</h1>

<p><strong>Version 0.4.</strong>*</p>

<hr/>

<p>Active-Alchemy is a framework agnostic wrapper for SQLAlchemy that makes it really easy
to use by implementing a simple active record like api, while it still uses the db.session underneath.
Inspired by Flask-SQLAlchemy.</p>

<p>Works with Python 2.6, 2.7, 3.3, 3.4 and pypy.</p>

<hr/>

<h2><a id="user-content-quick-overview" class="anchor" href="#quick-overview" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Quick Overview:</h2>

<h4><a id="user-content-create-the-model" class="anchor" href="#create-the-model" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Create the model</h4>

<pre><code>from active_alchemy import SQLAlchemy

db = SQLAlchemy('sqlite://')

class User(db.Model):
    name = db.Column(db.String(25))
    location = db.Column(db.String(50), default="USA")
    last_access = db.Column(db.Datetime)
</code></pre>

<h4><a id="user-content-create-new-record" class="anchor" href="#create-new-record" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Create new record</h4>

<pre><code>user = User.create(name="Mardix", location="Moon")

# or

user = User(name="Mardix", location="Moon").save()
</code></pre>

<h4><a id="user-content-get-all-records" class="anchor" href="#get-all-records" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Get all records</h4>

<pre><code>all = User.all()
</code></pre>

<h4><a id="user-content-get-a-record-by-id" class="anchor" href="#get-a-record-by-id" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Get a record by id</h4>

<pre><code>user = User.get(1234)
</code></pre>

<h4><a id="user-content-update-record" class="anchor" href="#update-record" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Update record</h4>

<pre><code>user = User.get(1234)
if user:
    user.update(location="Neptune") 
</code></pre>

<h4><a id="user-content-soft-delete-a-record" class="anchor" href="#soft-delete-a-record" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Soft Delete a record</h4>

<pre><code>user = User.get(1234)
if user:
    user.delete() 
</code></pre>

<h4><a id="user-content-query-records" class="anchor" href="#query-records" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Query Records</h4>

<pre><code>users = User.all(User.location.distinct())

for user in users:
    ...
</code></pre>

<h4><a id="user-content-query-with-filter" class="anchor" href="#query-with-filter" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Query with filter</h4>

<pre><code>all = User.all().filter(User.location == "USA")

for user in users:
    ...
</code></pre>

<h2><a id="user-content-how-to-use" class="anchor" href="#how-to-use" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>How to use</h2>

<h3><a id="user-content-install" class="anchor" href="#install" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Install</h3>

<pre><code>pip install active_alchemy
</code></pre>

<h3><a id="user-content-create-a-connection" class="anchor" href="#create-a-connection" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Create a connection</h3>

<p>The SQLAlchemy class is used to instantiate a SQLAlchemy connection to
a database.</p>

<pre><code>from active_alchemy import SQLAlchemy

db = SQLAlchemy(dialect+driver://username:password@host:port/database)
</code></pre>

<h4><a id="user-content-databases-drivers--db-connection-examples" class="anchor" href="#databases-drivers--db-connection-examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Databases Drivers &amp; DB Connection examples</h4>

<p>Active-Alchemy comes with a <code>PyMySQL</code> and <code>PG8000</code> as drivers for MySQL 
and PostgreSQL respectively, because they are in pure Python. But you can use 
other drivers for better performance. <code>SQLite</code> is already built in Python. </p>

<p><strong>SQLite:</strong></p>

<pre><code>from active_alchemy import SQLAlchemy

db = SQLAlchemy("sqlite://") # in memory

# or 

db = SQLAlchemy("sqlite:///foo.db") # DB file
</code></pre>

<p><strong>PostgreSql:</strong></p>

<pre><code>from active_alchemy import SQLAlchemy

db = SQLAlchemy("postgresql+pg8000://user:password@host:port/dbname")
</code></pre>

<p><strong>PyMySQL:</strong></p>

<pre><code>from active_alchemy import SQLAlchemy

db = SQLAlchemy("mysql+pymysql://user:password@host:port/dbname")
</code></pre>

<hr/>

<p>Active-Alchemy also provides access to all the SQLAlchemy
functions from the <code>sqlalchemy</code> and <code>sqlalchemy.orm</code> modules.
So you can declare models like the following examples:</p>

<h3><a id="user-content-create-a-model" class="anchor" href="#create-a-model" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Create a Model</h3>

<p>To start, create a model class and extends it with db.Model</p>

<pre><code># mymodel.py

from active_alchemy import SQLAlchemy

db = SQLAlchemy("sqlite://")

class MyModel(db.Model):
    name = db.Column(db.String(25))
    is_live = db.Column(db.Boolean, default=False)

# Put at the end of the model module to auto create all models
db.create_all()
</code></pre>

<ul>
<li><p>Upon creation of the table, db.Model will add the following columns: <code>id</code>, <code>created_at</code>, <code>upated_at</code>, <code>is_deleted</code>, <code>deleted_at</code></p></li>
<li><p>It does an automatic table naming (if no table name is already defined using the <code>__tablename__</code> property)
by using the class name. So, for example, a <code>User</code> model gets a table named <code>user</code>, <code>TodoList</code> becomes <code>todo_list</code>
The name will not be plurialized.</p></li>
</ul>

<hr/>

<h2><a id="user-content-models-dbmodel" class="anchor" href="#models-dbmodel" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Models: <em>db.Model</em></h2>

<p><strong>db.Model</strong> extends your model with helpers that turn your model into an active record like model. But underneath, it still uses the <code>db.session</code> </p>

<p><strong>db.Model</strong> also adds a few preset columns on the table: </p>

<p><code>id</code>: The primary key</p>

<p><code>created_at</code>: Datetime. It contains the creation date of the record</p>

<p><code>updated_at</code>: Datetime. It is updated whenever the record is updated.</p>

<p><code>deleted_at</code>: Datetime. Contains the datetime the record was soft-deleted. </p>

<p><code>is_deleted</code>: Boolean. A flag to set if record is soft-deleted or not</p>

<p><strong>-- About Soft Delete --</strong></p>

<p>By definition, soft-delete marks a record as deleted so it doesn't get queried, but it still exists in the database. To actually delete the record itself, a hard delete must apply. </p>

<p>By default, when a record is deleted, <strong>Active-Alchemy</strong> actually sets <code>is_deleted</code> to True and excludes it from being queried, and <code>deleted_at</code> is also set. But this happens only when using the method <code>db.Model.delete()</code>.</p>

<p>When a record is soft-deleted, you can also undelete a record by doing: <code>db.Model.delete(False)</code></p>

<p>Now, to totally delete off the table, <code>db.Model.delete(hard_delete=True)</code>   </p>

<p><strong>-- Querying with <em>db.Model.all()</em> --</strong></p>

<p>Due to the fact that <strong>Active-Alchemy</strong> has soft-delete, to query a model without the soft-deleted records, you must query your model by using the <code>all(*args, **kwargs)</code> which returns a db.session.query object for you to apply filter on etc.</p>

<p><strong>-- db.BaseModel --</strong></p>

<p>By default <code>db.Model</code> adds several preset columns on the table, if you don't want to have them in your model, you can use instead <code>db.BaseModel</code>, which still give you access to the methods to query your model.</p>

<hr/>

<h3><a id="user-content-dbmodel-methods-description" class="anchor" href="#dbmodel-methods-description" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>db.Model Methods Description</h3>

<p><strong>all(*args, **kwargs)</strong></p>

<p>Returns a <code>db.session.query</code> object to filter or apply more conditions. </p>

<pre><code>all = User.all()
for user in all:
    print(user.login)
</code></pre>

<p>By default all() will show only all non-soft-delete records. To display both deleted and non deleted items, add the arg: <code>include_deleted=True</code></p>

<pre><code>all = User.all(include_deleted=True)
for user in all:
    print(user.login)
</code></pre>

<p>Use all to select columns etc</p>

<pre><code>all = User.all(User.name.distinct(), User.location)
for user in all:
    print(user.login)
</code></pre>

<p>Use all for complete filter</p>

<pre><code>all = User.all(User.name.distinct, User.location).order_by(User.updated_at.desc()).filter(User.location == "Charlotte")
</code></pre>

<p><strong>get(id)</strong></p>

<p>Get one record by id. By default it will query only a record that is not soft-deleted</p>

<pre><code>id = 1234
user = User.get(id)

print(user.id)
print(user.login)
</code></pre>

<p>To query a record that has been soft deleted, just set the argument <code>include_deleted=True</code></p>

<pre><code>id = 234
user = User.get(id, include_deleted=True)
</code></pre>

<p><strong>create(**kwargs)</strong></p>

<p>To create/insert new record. Same as <strong>init</strong>, but just a shortcut to it.</p>

<pre><code>record = User.create(login='abc', passw_hash='hash', profile_id=123)
print (record.login) # -&gt; abc
</code></pre>

<p>or you can use the <strong>init</strong> with save()</p>

<pre><code>record = User(login='abc', passw_hash='hash', profile_id=123).save()
print (record.login) # -&gt; abc
</code></pre>

<p>or </p>

<pre><code>record = User(login='abc', passw_hash='hash', profile_id=123)
record.save()
print (record.login) # -&gt; abc
</code></pre>

<p><strong>update(**kwargs)</strong></p>

<p>Update an existing record </p>

<pre><code>record = User.get(124)
record.update(login='new_login')
print (record.login) # -&gt; new_login
</code></pre>

<p><strong>delete()</strong></p>

<p>To soft delete a record. <code>is_deleted</code> will be set to True and <code>deleted_at</code> datetime will be set</p>

<pre><code>record = User.get(124)
record.delete()
print (record.is_deleted) # -&gt; True
</code></pre>

<p>To soft UNdelete a record. <code>is_deleted</code> will be set to False and <code>deleted_at</code> datetime will be None</p>

<pre><code>record = User.get(124)
record.delete(delete=False)
print (record.is_deleted) # -&gt; False
</code></pre>

<p>To HARD delete a record. The record will be deleted completely</p>

<pre><code>record = User.get(124)
record.delete(hard_delete=True)
</code></pre>

<p><strong>save()</strong></p>

<p>A shortcut to <code>session.add</code> + <code>session.commit()</code></p>

<pre><code>record = User.get(124)
record.login = "Another one"
record.save()
</code></pre>

<hr/>

<h4><a id="user-content-method-chaining" class="anchor" href="#method-chaining" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Method Chaining</h4>

<p>For convenience, some method chaining are available</p>

<pre><code>user = User(name="Mardix", location="Charlotte").save()

User.get(12345).update(location="Atlanta")

User.get(345).delete().delete(False).update(location="St. Louis")
</code></pre>

<hr/>

<h4><a id="user-content-aggegated-selects" class="anchor" href="#aggegated-selects" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Aggegated selects</h4>

<pre><code>class Product(db.Model):
    name = db.Column(db.String(250))
    price = db.Column(db.Numeric)

results = Product.all(db.func.sum(Unit.price).label('price'))
</code></pre>

<hr/>

<h2><a id="user-content-with-web-application" class="anchor" href="#with-web-application" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>With Web Application</h2>

<p>In a web application you need to call <code>db.session.remove()</code> after each response, and <code>db.session.rollback()</code> if an error occurs. However, if you are using Flask or other framework that uses the <code>after_request</code> and <code>on_exception</code> decorators, these bindings it is done automatically.</p>

<p>For example using Flask, you can do:</p>

<pre><code>app = Flask(__name__)

db = SQLAlchemy('sqlite://', app=app)
</code></pre>

<p>or</p>

<pre><code>db = SQLAlchemy()

app = Flask(__name__)

db.init_app(app)
</code></pre>

<h3><a id="user-content-more-examples" class="anchor" href="#more-examples" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>More examples</h3>

<h4><a id="user-content-many-databases-one-web-app" class="anchor" href="#many-databases-one-web-app" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Many databases, one web app</h4>

<pre><code>app = Flask(__name__)
db1 = SQLAlchemy(URI1, app)
db2 = SQLAlchemy(URI2, app)
</code></pre>

<h4><a id="user-content-many-web-apps-one-database" class="anchor" href="#many-web-apps-one-database" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Many web apps, one database</h4>

<pre><code>db = SQLAlchemy(URI1)

app1 = Flask(__name__)
app2 = Flask(__name__)
db.init_app(app1)
db.init_app(app2)
</code></pre>

<hr/>

<h2><a id="user-content-pagination" class="anchor" href="#pagination" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Pagination</h2>

<p>All the results can be easily paginated</p>

<pre><code>users = User.paginate(page=2, per_page=20)
print(list(users))  # [User(21), User(22), User(23), ... , User(40)]
</code></pre>

<p>The paginator object it's an iterable that returns only the results for that page, so you use it in your templates in the same way than the original result:</p>

<pre><code>{% for item in paginated_items %}
    &lt;li&gt;{{ item.name }}&lt;/li&gt;
{% endfor %}
</code></pre>

<p>Rendering the pages</p>

<p>Below your results is common that you want it to render the list of pages.</p>

<p>The <code>paginator.pages</code> property is an iterator that returns the page numbers, but sometimes not all of them: if there are more than 11 pages, the result will be one of these, depending of what is the current page:</p>

<p>Skipped page numbers are represented as <code>None</code>.</p>

<p>How many items are displayed can be controlled calling <code>paginator.iter_pages</code> instead.</p>

<p>This is one way how you could render such a pagination in your templates:</p>

<pre><code>{% macro pagination(paginator, endpoint=None, class_='pagination') %}
    {% if not endpoint %}
        {% set endpoint = request.endpoint %}
    {% endif %}
    {% if "page" in kwargs %}
        {% do kwargs.pop("page") %}
    {% endif %}
    &lt;nav&gt;
        &lt;ul class="{{ class_ }}"&gt;
          {%- if paginator.has_prev %}
            &lt;li&gt;&lt;a href="{{ url_for(endpoint, page=paginator.prev_page_number, **kwargs) }}"
             rel="me prev"&gt;&lt;span aria-hidden="true"&gt;&amp;laquo;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
          {% else %}
            &lt;li class="disabled"&gt;&lt;span&gt;&lt;span aria-hidden="true"&gt;&amp;laquo;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
          {%- endif %}

          {%- for page in paginator.pages %}
            {% if page %}
              {% if page != paginator.page %}
                &lt;li&gt;&lt;a href="{{ url_for(endpoint, page=page, **kwargs) }}"
                 rel="me"&gt;{{ page }}&lt;/a&gt;&lt;/li&gt;
              {% else %}
                &lt;li class="active"&gt;&lt;span&gt;{{ page }}&lt;/span&gt;&lt;/li&gt;
              {% endif %}
            {% else %}
              &lt;li&gt;&lt;span class=ellipsis&gt;…&lt;/span&gt;&lt;/li&gt;
            {% endif %}
          {%- endfor %}

          {%- if paginator.has_next %}
            &lt;li&gt;&lt;a href="{{ url_for(endpoint, page=paginator.next_page_number, **kwargs) }}"
             rel="me next"&gt;»&lt;/a&gt;&lt;/li&gt;
          {% else %}
            &lt;li class="disabled"&gt;&lt;span aria-hidden="true"&gt;&amp;raquo;&lt;/span&gt;&lt;/li&gt;
          {%- endif %}
        &lt;/ul&gt;
    &lt;/nav&gt;
{% endmacro %}
</code></pre>

<hr/>

<h4><a id="user-content-credits" class="anchor" href="#credits" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Credits:</h4>

<p><a href="http://www.sqlalchemy.org/">SQLAlchemy</a></p>

<p><a href="https://pythonhosted.org/Flask-SQLAlchemy">Flask-SQLAlchemy</a></p>

<p><a href="https://github.com/lucuma/sqlalchemy-wrapper">SQLAlchemy-Wrapper</a></p>

<hr/>

<p>copyright: 2015</p>

<p>license: MIT, see LICENSE for more details.</p>
</article>
  </div></body></html>