<html><body><div><article class="post-458 post type-post status-publish format-standard hentry category-programming-2 category-python" id="post-458">
				
				<h2>Introducing recipy: effortless provenance tracking with Python</h2>
				<time>August 28, 2015</time>
		
				<p>By time this blog post is published, I will have finished my presentation about <a href="https://github.com/recipy/recipy">recipy</a> at EuroSciPy (see the <a href="https://www.euroscipy.org/2015/schedule/presentation/16/">abstract</a> for my talk), and so I thought it would be a good time to introduce recipy to the wider world. I’ve been looking for something like recipy for ages – and I suggested the idea at the <a href="http://www.software.ac.uk/cw15">Collaborations Workshop 2015</a> Hack Day. I got together in a team with Raquel Alegre and Janneke van der Zwaan, and our implementation of recipy won the Hack Day prize! I’m very excited about where it could go next, but first I ought to explain what it is:</p>
<p>So, have you ever run a Python script to produce some outputs and then forgotten exactly how you created them? For example, you created plot.png a few weeks ago and now you want to use it in a publication, but you can’t remember how you created it. By adding a single line of code to your script, recipy will log your inputs, outputs and code each time you run the script, and you can then query the resulting database to find out how exactly plot.png was created.</p>
<p>Does this sound good to you? If so, read on to find out how to use it.</p>
<p>Installation is stupidly simple: <tt>pip install recipy</tt></p>
<p>Using it is also very simple – just take a Python script like this:</p>
<pre class="brush: python; gutter: false; first-line: 1">import pandas as pd
from matplotlib.pyplot import *

data = pd.read_csv('data.csv')

data.plot(x='year', y='temperature')
savefig('graph.png')

data.temperature = data.temperature - 273
data.to_csv('output_kelvin.csv')
</pre>
<p>and add a single extra line of code to the top:</p>
<pre class="brush: python; gutter: false; first-line: 1">import recipy
import pandas as pd
from matplotlib.pyplot import *
...(code continues as above)...
</pre>
<p>Now you can just run the script as usual, and you’ll see a little bit of extra output on stdout:</p>
<pre>recipy run inserted, with ID 1b40ce05-c587-4f5d-bfae-498e64d71a6c</pre>
<p>This just shows that recipy has recorded this particular run of your code.</p>
<p>Once you’ve done this you can query your recipy database using the <tt>recipy</tt> command-line tool. For example, you can run:</p>
<pre>$ recipy search graph.png

Run ID: 1b40ce05-c587-4f5d-bfae-498e64d71a6c
Created by robin on 2015-08-27T20:50:23
Ran /Users/robin/code/euroscipy/recipy/example_script.py using /Users/robin/.virtualenvs/recipypres/bin/python
Git: commit 4efa33fc6e0a81e9c16c522377f07f9bf66384e2, in repo /Users/robin/code/euroscipy, with origin None
Environment: Darwin-14.3.0-x86_64-i386-64bit, python 2.7.9 (default, Feb 10 2015, 03:28:08)
Inputs:
  /Users/robin/code/euroscipy/recipy/data.csv

Outputs:
  /Users/robin/code/euroscipy/recipy/graph.png
  /Users/robin/code/euroscipy/recipy/output_kelvin.csv

** Previous runs creating this output have been found. Run with --all to show. **
</pre>
<p>You can also view these runs in a GUI by running <tt>recipy gui</tt>, which will give you a web interface like:</p>
<p><a href="http://blog.rtwilson.com/wp-content/uploads/2015/08/RecipyGUI.png"><img class="aligncenter wp-image-459 size-large" src="http://blog.rtwilson.com/wp-content/uploads/2015/08/RecipyGUI-1024x362.png" alt="RecipyGUI" srcset="http://blog.rtwilson.com/wp-content/uploads/2015/08/RecipyGUI-300x106.png 300w, http://blog.rtwilson.com/wp-content/uploads/2015/08/RecipyGUI-1024x362.png 1024w, http://blog.rtwilson.com/wp-content/uploads/2015/08/RecipyGUI.png 1245w" sizes="(max-width: 550px) 100vw, 550px"/></a></p>
<p> </p>
<p>There are more ways to search and find more details about particular runs: see <tt>recipy --help</tt> for more details. Full documentation is available <a href="https://github.com/recipy/recipy">at Github</a> – which includes information about how this all works under the hood (it’s all to do with the crazy magic of <tt>sys.meta_path</tt>).</p>
<p>So – please install recipy (<tt>pip install recipy</tt>), let me know what you think of it (feel free to comment here, or email me at robin AT rtwilson.com), and please submit issues on <a href="https://github.com/recipy/recipy">Github</a> for any bugs you run into (pull requests would be even nicer!).</p>

				<hr class="clearfix"/>

        
        <p class="post_categories"><strong>Categorised as:</strong> <a href="http://blog.rtwilson.com/category/programming-2/" rel="category tag">Programming</a>, <a href="http://blog.rtwilson.com/category/programming-2/python/" rel="category tag">Python</a> </p>

								
				<hr class="clearfix"/>
				
			</article>

			


	

	</div></body></html>