<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-epoxy" class="anchor" href="#epoxy" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Epoxy</h1>

<p><a href="https://travis-ci.org/digidotcom/epoxy"><img src="https://camo.githubusercontent.com/d88ac945d20bef92e65fee402d5f429589d1397b/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f64696769646f74636f6d2f65706f78792e737667" alt="Build Status" data-canonical-src="https://img.shields.io/travis/digidotcom/epoxy.svg"/></a>
<a href="https://coveralls.io/r/digidotcom/epoxy"><img src="https://camo.githubusercontent.com/f0e00a118aab5a1c9e3c10e4f181e1863217e674/68747470733a2f2f696d672e736869656c64732e696f2f636f766572616c6c732f64696769646f74636f6d2f65706f78792e737667" alt="Coverage Status" data-canonical-src="https://img.shields.io/coveralls/digidotcom/epoxy.svg"/></a>
<a href="https://codeclimate.com/github/digidotcom/epoxy"><img src="https://camo.githubusercontent.com/76c214f49bd5d9426d53be3cc8cee29d56db404a/68747470733a2f2f696d672e736869656c64732e696f2f636f6465636c696d6174652f6769746875622f64696769646f74636f6d2f65706f78792e737667" alt="Code Climate" data-canonical-src="https://img.shields.io/codeclimate/github/digidotcom/epoxy.svg"/></a>
<a href="https://pypi.python.org/pypi/epoxy/"><img src="https://camo.githubusercontent.com/1510b66757b6acf6f31aabda41f43d7a7356953d/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f65706f78792e737667" alt="Latest Version" data-canonical-src="https://img.shields.io/pypi/v/epoxy.svg"/></a>
<a href="https://github.com/digidotcom/epoxy/blob/master/LICENSE"><img src="https://camo.githubusercontent.com/5659a7e1b618ffd55a16f8641014adc2088329a5/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d504c253230322e302d626c75652e737667" alt="License" data-canonical-src="https://img.shields.io/badge/license-MPL%202.0-blue.svg"/></a></p>

<h2><a id="user-content-introduction" class="anchor" href="#introduction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Introduction</h2>

<p>Epoxy is an dependency injection framework for Python applications
packaged with a set of adapters that can be used with a number of
existing technologies.  Epoxy allows you to clearly separate out the
concern of mapping dependencies to components from defining those
components.</p>

<p>Epoxy is probably overkill for small apps (like the example below) but
shows its true value on larger projects where a higher degree of
flexibility and lower degree of coupling is desirable.</p>

<h2><a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>License</h2>

<p>This library is available under the terms of the MPL.  Please see the
LICENSE file for details.</p>

<h2><a id="user-content-an-example" class="anchor" href="#an-example" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>An Example</h2>

<p>Here's an example of an epoxy component:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> epoxy.component <span class="pl-k">import</span> Component, Dependency

<span class="pl-k">class</span> <span class="pl-en">PrinterComponent</span>(<span class="pl-e">Component</span>):

    prefix <span class="pl-k">=</span> StringSetting(<span class="pl-v">required</span><span class="pl-k">=</span><span class="pl-c1">False</span>, <span class="pl-v">default</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>PRINTING<span class="pl-pds">"</span></span>)

    <span class="pl-k">def</span> <span class="pl-en">write</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">stuff</span>):
        <span class="pl-c1">print</span> (<span class="pl-s"><span class="pl-pds">"</span>[<span class="pl-c1">%s</span>] <span class="pl-c1">%%</span>s<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-v">self</span>.prefix) <span class="pl-k">%</span> stuff

    <span class="pl-k">def</span> <span class="pl-en">start</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
        <span class="pl-c1">print</span> <span class="pl-v">self</span>.write(<span class="pl-s"><span class="pl-pds">"</span>Warming up printer<span class="pl-pds">"</span></span>)


<span class="pl-k">class</span> <span class="pl-en">ScreenRenderer</span>(<span class="pl-e">Component</span>):

    printer <span class="pl-k">=</span> Dependency()

    <span class="pl-k">def</span> <span class="pl-en">render_screen</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
        <span class="pl-v">self</span>.printer.write(<span class="pl-s"><span class="pl-pds">"</span>My Stuff<span class="pl-pds">"</span></span>)

    <span class="pl-k">def</span> <span class="pl-en">start</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
        <span class="pl-v">self</span>.printer.write(<span class="pl-s"><span class="pl-pds">"</span>Screen Renderer Initialized<span class="pl-pds">"</span></span>)</pre></div>

<p>In this example, ScreenRenderer does not need to know the precise
printer which will be used as a dependency at runtime, it just needs
to declare the dependency and use it (there is an assumed interface,
as with much in python we just use duck typing).</p>

<p>To wire these components up at runtime, we would write a yaml file
that would have something like this:</p>

<div class="highlight highlight-source-yaml"><pre><span class="pl-s"><span class="pl-ent">components:</span></span>
  <span class="pl-s"><span class="pl-ent">printer:</span></span>
    <span class="pl-s"><span class="pl-ent">class:</span> <span class="pl-s">my.module:PrinterComponent</span></span>
    <span class="pl-s"><span class="pl-ent">settings:</span></span>
      <span class="pl-s"><span class="pl-ent">prefix:</span> <span class="pl-s">PREFIX</span></span>

  <span class="pl-s"><span class="pl-ent">screen_renderer:</span></span>
    <span class="pl-s"><span class="pl-ent">class:</span> <span class="pl-s">my.module:ScreenRenderer</span></span>
    <span class="pl-s"><span class="pl-ent">dependencies:</span></span>
      <span class="pl-s"><span class="pl-ent">printer:</span> <span class="pl-s">printer</span></span>

<span class="pl-s"><span class="pl-ent">entry-point:</span></span>
  <span class="pl-ent">screen_renderer</span>:render_screen</pre></div>

<p>Finally, to load in our configuration and run the application, we
would write something like the following:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> epoxy.configuration <span class="pl-k">import</span> YamlConfigurationLoader
<span class="pl-k">from</span> epoxy.core <span class="pl-k">import</span> ComponentManager

loader <span class="pl-k">=</span> YamlConfigurationLoader(<span class="pl-s"><span class="pl-pds">"</span>myapp.yml<span class="pl-pds">"</span></span>)
config <span class="pl-k">=</span> loader.load_configuration()
component_mgr <span class="pl-k">=</span> ComponentManager()
component_mgr.launch_configuration(config)</pre></div>

<p>This would run our entry point and print the following to the screen:</p>

<pre><code>[PREFIX] Warming up printer
[PREFIX] Screen Renderer Initialized
[PREFIX] my stuff
</code></pre>

<h2><a id="user-content-writing-a-component" class="anchor" href="#writing-a-component" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Writing a Component</h2>

<p>Any Component that is written should follow these basic rules in order
to play nicely:</p>

<ol>
<li><p>No-args constructor: Components should have a no-args constructor
in order to be instantiated by the framework.  To initialize a
Component in your own code (maybe from a unit test) you can use
the "from_dependencies" classmethod available on any component and
pass in any relevant dependencies/settings as keyword arguments.</p>

<p>For instance, instantiating our previous object graph would look
like the following:</p>

<div class="highlight highlight-source-python"><pre>printer <span class="pl-k">=</span> PrinterComponent.from_dependencies(<span class="pl-v">prefix</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>FROM_DEPS<span class="pl-pds">"</span></span>)
renderer <span class="pl-k">=</span> ScreenRenderer.from_dependencies(<span class="pl-v">printer</span><span class="pl-k">=</span>printer)</pre></div>

<p>When <code>__init__</code> is executed it is guaranteed that all dependencies
will be present and initialized (but not started).</p></li>
<li><p>Implement <code>start()</code> method: After all objects in the graph are
instantiated, they will be started.  Like with <code>__init__</code>,
dependencies will be present and will have had <code>start()</code> called.
Calls to <code>start()</code> should not block.  For long-running tasks, using
an entry-point is more appropriate.</p></li>
<li><p>Avoid Dependency Cycles: If the object graph has dependencies, you
will get errors when trying to build the dependency graph and you
will not be able to run your application.  There are many
different strategies for breaking these cycles.  If you run into
this issue and are ticked off, just know that fixing this issue is
making your application better.</p></li>
</ol>
</article>
  </div></body></html>