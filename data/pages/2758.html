<html><body><div><div role="main">
        
<h2>Security releases issued</h2>

<span class="meta">Posted by <strong>Tim Graham</strong> on January 13, 2015 </span>

<p>Today the Django team is issuing multiple releases -- Django 1.4.18, Django 1.6.10, and Django 1.7.3 -- as
part of <a class="reference external" href="https://www.djangoproject.com/security/">our security process</a>. These releases are now
available on <a class="reference external" href="https://pypi.python.org/pypi/Django">PyPI</a> and <a class="reference external" href="https://www.djangoproject.com/download/">our download page</a>.</p>
<p>These releases address several security issues. We encourage all users of Django to upgrade
as soon as possible.</p>
<div class="section" id="s-issue-wsgi-header-spoofing-via-underscore-dash-conflation">
<h3>Issue: WSGI header spoofing via underscore/dash conflation</h3>
<p>When HTTP headers are placed into the WSGI environ, they are normalized
by converting to uppercase, converting all dashes to underscores, and
prepending <cite>HTTP_</cite>. For instance, a header <tt class="docutils literal"><span class="pre">X-Auth-User</span></tt> would become
<tt class="docutils literal">HTTP_X_AUTH_USER</tt> in the WSGI environ (and thus also in Django's
<tt class="docutils literal">request.META</tt> dictionary).</p>
<p>Unfortunately, this means that the WSGI environ cannot distinguish
between headers containing dashes and headers containing underscores:
<tt class="docutils literal"><span class="pre">X-Auth-User</span></tt> and <tt class="docutils literal"><span class="pre">X-Auth_User</span></tt> both become <tt class="docutils literal">HTTP_X_AUTH_USER</tt>.
This means that if a header is used in a security-sensitive way (for
instance, passing authentication information along from a front-end
proxy), even if the proxy carefully strips any incoming value for
<tt class="docutils literal"><span class="pre">X-Auth-User</span></tt>, an attacker may be able to provide an <tt class="docutils literal"><span class="pre">X-Auth_User</span></tt>
header (with underscore) and bypass this protection.</p>
<p>In order to prevent such attacks, both Nginx and Apache 2.4+ strip all
headers containing underscores from incoming requests by default.
Django's built-in development server now does the same. Django's
development server is not recommended for production use, but matching
the behavior of common production servers reduces the surface area for
behavior changes during deployment.</p>
<p>This issue has been assigned the CVE identifier CVE-2015-0219.</p>
<p>Thanks to Jedediah Smith for reporting the issue.</p>
</div>
<div class="section" id="s-issue-mitigated-possible-xss-attack-via-user-supplied-redirect-urls">
<h3>Issue: Mitigated possible XSS attack via user-supplied redirect URLs</h3>
<p>Django relies on user input in some cases (e.g.
<tt class="docutils literal">django.contrib.auth.views.login()</tt>
and i18n) to redirect the user to an "on success" URL. The security
checks for these redirects (namely <tt class="docutils literal">django.util.http.is_safe_url()</tt>)
didn't strip leading whitespace on the tested URL and as such considered
URLs like <tt class="docutils literal"><span class="pre">\njavascript:...</span></tt> safe. If a developer relied on
<tt class="docutils literal">is_safe_url()</tt> to provide safe redirect targets and put such a URL
into a link, they could suffer from a XSS attack. This bug doesn't
affect Django currently, since we only put this URL into the
<tt class="docutils literal">Location</tt> response header and browsers seem to ignore JavaScript there.</p>
<p>This issue has been assigned the CVE identifier CVE-2015-0220.</p>
<p>Thanks to Mikko Ohtamaa for reporting the issue.</p>
</div>
<div class="section" id="s-issue-denial-of-service-attack-against-django-views-static-serve">
<h3>Issue: Denial-of-service attack against <tt class="docutils literal">django.views.static.serve</tt></h3>
<p>In older versions of Django, the <tt class="docutils literal">django.views.static.serve()</tt> view
read the files it served one line at a time. Therefore, a big file with
no newlines would result in memory usage equal to the size of that file.
An attacker could exploit this and launch a denial-of-service attack by
simultaneously requesting many large files. This view now reads the file
in chunks to prevent large memory usage.</p>
<p>Note, however, that this view has always carried a warning that it is
not hardened for production use and should be used only as a development
aid. Now may be a good time to audit your project and serve your files
in production using a real front-end web server if you are not doing so.</p>
<p>This issue has been assigned the CVE identifier CVE-2015-0221.</p>
<p>Thanks Alex Gaynor for reporting the issue.</p>
</div>
<div class="section" id="s-issue-database-denial-of-service-with-modelmultiplechoicefield">
<h3>Issue: Database denial-of-service with <tt class="docutils literal">ModelMultipleChoiceField</tt></h3>
<p>Given a form that uses <tt class="docutils literal">ModelMultipleChoiceField</tt> and
<tt class="docutils literal">show_hidden_initial=True</tt> (not a documented API), it was possible for
a user to cause an unreasonable number of SQL queries by submitting
duplicate values for the field's data. The validation logic in
<tt class="docutils literal">ModelMultipleChoiceField</tt> now deduplicates submitted values to
address this issue.</p>
<p>This issue has been assigned the CVE identifier CVE-2015-0222.</p>
<p>Thanks Keryn Knight for reporting the issue.</p>
</div>
<div class="section" id="s-affected-versions">
<h3>Affected versions</h3>
<ul class="simple">
<li>Django master development branch (currently at pre-alpha status) (except the <tt class="docutils literal">serve()</tt> denial of service issue)</li>
<li>Django 1.7</li>
<li>Django 1.6</li>
<li>Django 1.4 [Long-term support] (except the <tt class="docutils literal">ModelMultipleChoiceField</tt> issue)</li>
</ul>
<p>Per our <a class="reference external" href="https://docs.djangoproject.com/en/dev/internals/release-process/#supported-versions">supported versions policy</a>, Django 1.5 is no longer receiving security updates.</p>
</div>
<div class="section" id="s-resolution">
<h3>Resolution</h3>
<p>Patches have been applied to Django's master development branch and to the 1.4, 1.6 and 1.7
release branches, which resolve the issues described above. The patches may be obtained
directly from the following changesets:</p>
<p>On the development master branch:</p>

<p>On the 1.7 release branch:</p>

<p>On the 1.6 release branch:</p>

<p>On the 1.4 release branch:</p>

<p>The following new releases have been issued:</p>

<p>The PGP key ID used for this release is Tim Graham: 1E8ABDC773EDE252.</p>
</div>
<div class="section" id="s-general-notes-regarding-security-reporting">
<h3>General notes regarding security reporting</h3>
<p>As always, we ask that potential security issues be reported via
private email to <tt class="docutils literal">security@djangoproject.com</tt>, and not via Django's
Trac instance or the django-developers list. Please see <a class="reference external" href="https://www.djangoproject.com/security/">our security
policies</a> for further
information.</p>
</div>


        <a href="#top" class="backtotop"><i class="icon icon-chevron-up"/> Back to Top</a>
      </div>

      
  </div></body></html>