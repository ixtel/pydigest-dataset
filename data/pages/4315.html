<html><body><div><div class=" highlight hl-ipython2"><pre><span/><span class="k">def</span> <span class="nf">RR_convergents</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">A</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1j</span><span class="o">*</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">shape</span><span class="o">+</span><span class="p">(</span><span class="mi">7</span><span class="p">,))</span><span class="c1"># define an array of shape (r, c, 7), where (r,c) is the shape of</span>
                                    <span class="c1"># the  "complex meshgrid" q=x+1j*y</span>
    <span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="p">[:,:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="c1"># A[;,;:3], B= A[:,:, 3:6] is for B</span>
    <span class="n">tp</span><span class="o">=</span><span class="n">A</span><span class="p">[:,:,:</span><span class="mi">6</span><span class="p">]</span><span class="c1"># a working array</span>
    
    <span class="n">A</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">B</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">q</span>
    <span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">q</span><span class="o">+</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">over</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="n">divide</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">tp</span><span class="o">=</span><span class="n">A</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">q</span><span class="o">**</span><span class="n">k</span>
            <span class="n">A</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">A</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span> <span class="n">A</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">tp</span> <span class="c1"># recurrence for A_n</span>
            <span class="n">tp</span><span class="o">=</span><span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">B</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">q</span><span class="o">**</span><span class="n">k</span>
            <span class="n">B</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">B</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span> <span class="n">B</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">tp</span> <span class="c1"># recurrence  for B_n</span>
        <span class="k">return</span> <span class="n">A</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>   
</pre></div>

</div></body></html>