<html><body><div><p>HTTP security headers for Flask.</p>








<p>Talisman is a small Flask extension that handles setting HTTP headers
that can help protect against a few common web application security
issues.</p>
<div id="content-security-policy">
<h2>Content Security Policy</h2>
<p>The default content security policy is extremely strict, and will
prevent loading any resources that are not in the same domain as the
application.</p>
<p>A slightly more permissive policy is available at
<tt>talisman.GOOGLE_CSP_POLICY</tt>, which allows loading Google-hosted JS
libraries, fonts, and embeding media from YouTube and Maps.</p>
<p>You can and should create your own policy to suit your site’s needs.
Here’s a few examples adapted from
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/CSP/Using_Content_Security_Policy" rel="nofollow">MDN</a>:</p>
<div id="example-1">
<h3>Example 1</h3>
<p>This is the default policy. A web site administrator wants all content
to come from the site’s own origin (this excludes subdomains.)</p>
<pre><span class="n">csp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'default-src'</span><span class="p">:</span> <span class="s1">'</span><span class="se">\'</span><span class="s1">self</span><span class="se">\'</span><span class="s1">'</span>
<span class="p">}</span>
</pre>
</div>
<div id="example-2">
<h3>Example 2</h3>
<p>A web site administrator wants to allow content from a trusted domain
and all its subdomains (it doesn’t have to be the same domain that the
CSP is set on.)</p>
<pre><span class="n">csp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'default-src'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'</span><span class="se">\'</span><span class="s1">self</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span>
        <span class="s1">'*.trusted.com'</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre>
</div>
<div id="example-3">
<h3>Example 3</h3>
<p>A web site administrator wants to allow users of a web application to
include images from any origin in their own content, but to restrict
audio or video media to trusted providers, and all scripts only to a
specific server that hosts trusted code.</p>
<pre><span class="n">csp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'default-src'</span><span class="p">:</span> <span class="s1">'</span><span class="se">\'</span><span class="s1">self</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span>
    <span class="s1">'image-src'</span><span class="p">:</span> <span class="s1">'*'</span><span class="p">,</span>
    <span class="s1">'media-src'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'media1.com'</span><span class="p">,</span>
        <span class="s1">'media2.com'</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'script-src'</span><span class="p">:</span> <span class="s1">'userscripts.example.com'</span>
<span class="p">}</span>
</pre>
<p>Here, by default, content is only permitted from the document’s origin,
with the following exceptions:</p>
<ul>
<li>Images may loaded from anywhere (note the <tt>*</tt> wildcard).</li>
<li>Media is only allowed from media1.com and media2.com (and not from
subdomains of those sites).</li>
<li>Executable script is only allowed from userscripts.example.com.</li>
</ul>
</div>
<div id="example-4">
<h3>Example 4</h3>
<p>A web site administrator for an online banking site wants to ensure that
all its content is loaded using SSL, in order to prevent attackers from
eavesdropping on requests.</p>
<pre><span class="n">csp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'default-src'</span><span class="p">:</span> <span class="s1">'https://onlinebanking.jumbobank.com'</span>
<span class="p">}</span>
</pre>
<p>The server only permits access to documents being loaded specifically
over HTTPS through the single origin onlinebanking.jumbobank.com.</p>
</div>
<div id="example-5">
<h3>Example 5</h3>
<p>A web site administrator of a web mail site wants to allow HTML in
email, as well as images loaded from anywhere, but not JavaScript or
other potentially dangerous content.</p>
<pre><span class="n">csp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'default-src'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'</span><span class="se">\'</span><span class="s1">self</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span>
        <span class="s1">'*.mailsite.com'</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'img-src'</span><span class="p">:</span> <span class="s1">'*'</span>
<span class="p">}</span>
</pre>
<p>Note that this example doesn’t specify a <tt><span class="pre">script-src</span></tt>; with the
example CSP, this site uses the setting specified by the <tt><span class="pre">default-src</span></tt>
directive, which means that scripts can be loaded only from the
originating server.</p>
</div>
</div>
</div></body></html>