<html><body><div><p>django-eventtools is a lightweight library designed to handle repeating
and one-off event occurrences for display on a website.</p>
<div id="usage">
<h2>Usage</h2>
<p>Create a sample event &amp; occurrences</p>
<pre>&gt;&gt;&gt; from datetime import datetime
&gt;&gt;&gt; from dateutil import rrule
&gt;&gt;&gt; from myapp.models import Event
&gt;&gt;&gt; event = Event.objects.create(title='Test event')
&gt;&gt;&gt; once_off = Occurrence.objects.create(
        event=event,
        start=datetime(2016, 1, 1, 12, 0),
        end=datetime(2016, 1, 1, 2, 0))
&gt;&gt;&gt; christmas = Occurrence.objects.create(
        event=event,
        start=datetime(2015, 12, 25, 7, 0),
        end=datetime(2015, 12, 25, 22, 0),
        repeat=rrule.YEARLY)
&gt;&gt;&gt; daily = Occurrence.objects.create(
        event=event,
        start=datetime(2016, 1, 1, 7, 0),
        end=datetime(2016, 1, 1, 8, 0),
        repeat=rrule.DAILY)
</pre>
<p><tt>Event</tt> and <tt>Occurrence</tt> instances, and their associated querysets,
all support the <tt>all_occurrences</tt> method, which takes two optional
arguments - <tt>from_date</tt> and <tt>to_date</tt>, which may be dates or
datetimes. <tt>from_date</tt> defaults to the current day, <tt>to_date</tt> to
<tt>None</tt>. The method returns a python generator yielding tuples in the
format <tt>(start, end, data)</tt> - for example:</p>
<pre>&gt;&gt;&gt; Event.objects.all().all_occurrences()
&gt;&gt;&gt; event.all_occurrences(from_date=datetime(2015, 1, 1, 10, 0))
&gt;&gt;&gt; event.occurrence_set.all().all_occurrences(to_date=date(2016, 1, 1))
&gt;&gt;&gt; occurrence.all_occurrences(from_date=date(2016, 1, 1),
                               to_date=date(2016, 12, 31))
</pre>
<p>A <tt>next_occurrence</tt> method is also provided, taking the same
arguments, but returning a single occurrence tuple.</p>
<pre>&gt;&gt;&gt; event.next_occurrence()
&gt;&gt;&gt; event.next_occurrence(from_date=date(2016, 1, 1))
</pre>
<div id="queryset-filtering">
<h3>Queryset filtering</h3>
<p>Querysets can also be filtered, but due to uncertainty with repetitions,
from_date filtering is only an approximation (to_date filtering is
accurate). If you need a queryset filtered exactly, pass <tt>exact=True</tt>
- this will filter using occurrences but still return a queryset - but
be careful with this as it may be very slow. For example</p>
<pre>&gt;&gt;&gt; Event.objects.for_period(from_date=date(2015, 1, 1),
                             to_date=date(2015, 12, 31))
&gt;&gt;&gt; event.occurrence_set.for_period(from_date=date(2015, 1, 1), exact=True)
</pre>
</div>
<div id="adding-additional-data-to-occurrence-tuples">
<h3>Adding additional data to occurrence tuples</h3>
<p>If you need more information about the occurrence than just a pair of
dates, add an occurrence_data property to your <tt>BaseOccurrence</tt>
subclass - i.e.</p>
<pre>class Occurrence(BaseOccurrence):
    event = models.ForeignKey(Event)

    @property
    def occurrence_data(self):
        return {
            'event_title': self.event.title,
            'image': self.event.image,
        }
</pre>
<p>The result will be appended to the occurrence tuple, i.e.
<tt>(start, end, data)</tt></p>
</div>
</div>
</div></body></html>