<html><body><div><p>Django image renderer is an app that will help you render images in many
sizes (renditions). This can be really helpful for generating images
size for different screens resolution (especially when targeting
mobile).</p>
<div id="quick-start">
<h2>Quick start</h2>
<p>Install the app.</p>
<pre>pip install django-image-renderer
</pre>
<p>Add “renderer” to your INSTALLED_APPS setting like this:</p>
<p><em>settings.py</em></p>
<pre><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># your apps</span>
    <span class="s1">'renderer'</span><span class="p">,</span>
<span class="p">)</span>
</pre>
<p>Include the renderer URL configuration in your project <em>urls.py</em> like
this:</p>
<p><em>urls.py</em></p>
<pre><span class="n">url</span><span class="p">(</span><span class="s1">r'^renderer/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">'renderer.urls'</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">'renderer'</span><span class="p">)),</span>
</pre>
<p>Run <tt>python manage.py migrate</tt> to create the renderer models.</p>
<p>Start the development server and visit <a href="http://localhost:8000/admin/" rel="nofollow">http://localhost:8000/admin/</a> to
create a MasterImage (you’ll need the Admin app enabled).</p>
</div>
<div id="usage">
<h2>Usage</h2>
<p>There is only one model in the app: <em>MasterImage</em>. With a <em>MasterImage</em>
you can ask for renditions.</p>
<pre><span class="n">m</span> <span class="o">=</span> <span class="n">MasterImage</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

<span class="c1"># get the master file's URL</span>
<span class="n">m</span><span class="o">.</span><span class="n">get_master_url</span><span class="p">()</span>
<span class="c1"># or</span>
<span class="n">m</span><span class="o">.</span><span class="n">get_rendition_url</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># cache and return URL of a renditions that as 200 pixels width</span>
<span class="c1"># and height computed according to master's aspect ratio</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_rendition_url</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># cache and return URL of a renditions that as 50 pixels height</span>
<span class="c1"># and width computed according to master's aspect ratio</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_rendition_url</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre>
<p>If you ask for a size that do not fit master’s aspect ration you’ll
receive a center cropped image.</p>
<p>You can also ask for a rendition in templates.</p>
<p><em>models.py</em></p>
<pre><span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">MasterImage</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'demo/index.html'</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">'master'</span><span class="p">:</span> <span class="n">m</span><span class="p">,</span>
    <span class="p">})</span>
</pre>
<p><em>index.html</em></p>
<pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">renderer</span> <span class="cp">%}</span>
...
<span class="cp">{%</span> <span class="k">rendition</span> <span class="nv">master</span> <span class="m">42</span> <span class="m">42</span> <span class="cp">%}</span>
...
<span class="cp">{%</span> <span class="k">rendition_url</span> <span class="m">42</span> <span class="m">42</span> <span class="cp">%}</span>
...
</pre>
<p>This will render as:</p>
<pre><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">"/media/img/0fb34de8-9d83-456a-828b-72ab21f8ebab_42x42.png"</span> <span class="na">width</span><span class="o">=</span><span class="s">"42"</span> <span class="na">height</span><span class="o">=</span><span class="s">"42"</span> <span class="na">alt</span><span class="o">=</span><span class="s">""</span><span class="p">&gt;</span>
...
/media/img/0fb34de8-9d83-456a-828b-72ab21f8ebab_42x42.png
...
</pre>
<p>When using <em>MasterImage</em> in your model you may need a widget who
provides a preview for you image. For convenience a mixin is provided.</p>
<p><em>models.py</em></p>
<pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">DemoModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">master</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">'renderer.MasterImage'</span><span class="p">)</span>
</pre>
<p><em>admin.py</em></p>
<pre><span class="kn">from</span> <span class="nn">demo.models</span> <span class="kn">import</span> <span class="n">DemoModel</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">renderer.widgets</span> <span class="kn">import</span> <span class="n">MasterImageAdminMixin</span>

<span class="nd">@admin.register</span><span class="p">(</span><span class="n">DemoModel</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">DemoModelAdmin</span><span class="p">(</span><span class="n">MasterImageAdminMixin</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'master'</span><span class="p">,</span> <span class="p">)</span>
</pre>
</div>
<div id="sample-project">
<h2>Sample project</h2>
<p>A sample project is available in the
<a href="https://github.com/rouk1/django-image-renderer/tree/master/sample" rel="nofollow">sample</a>
folder. Test it as an usual Django project:</p>
<pre>virtualenv --no-site-packages venv
<span class="nb">source</span> venv/bin/activate
pip install -r requirements.txt
python sample/manage.py migrate
python sample/manage.py createsuperuser
python sample/manage.py runserver
</pre>
<p>It’ also deployed at <a href="http://django-image-renderer.herokuapp.com/" rel="nofollow">http://django-image-renderer.herokuapp.com/</a>.</p>
</div>


</div></body></html>