<html><body><div><section class="post-content">
            <p><img src="/content/images/2016/02/xScreen-Shot-2016-02-23-at-11-29-48-AM.png.pagespeed.ic.u6J2r-dgpD.png" alt=""/></p>

<h3 id="whywouldyoudothis">Why would you do this?</h3>

<p>Docker containers are awesome for isolating applications from each other, but what if you <em>want</em> them to talk to each other? For instance, if you're developing an app in python that needs to interact with software written in another language. There are <a href="https://wiki.python.org/moin/IntegratingPythonWithOtherLanguages">a few techniques</a> for achieving low-level interoperability between Python and other popular languages. But if you have a <a href="http://stackoverflow.com/questions/546160/what-is-erlang-written-in?answertab=votes#tab-top">weird case</a>, or some complex legacy software, this becomes difficult or impossible.</p>

<h3 id="theideacontainersasmodules">The idea: containers as modules</h3>

<p>We created <a href="https://github.com/deepgram/sidomo">sidomo - Simple Docker Module</a>* so that if you can get your weirdo app to run in <em>any linux environment</em>, then you can instantly call it from Python with zero added effort.</p>

<p>Right now most people use the Docker Daemon API to manage containers carrying their apps. (<a href="http://kubernetes.io/">Kubernetes</a> / <a href="http://mesos.apache.org/">Mesos</a> are great examples of this). Sidomo opens up a whole new use case for containersâ€”turning weirdo software into nice, plain vanilla python modules that work seamlessly in python code.</p>

<p>*not an <a href="https://www.expeditedssl.com/aws-in-plain-english">AWS service</a></p>

<h2 id="howtousesidomo">How to use sidomo</h2>

<p>Make sure you have docker installed and a docker daemon running. If you're not sure if this is the case, run <code>docker ps</code> and see if you get "CONTAINER ID ..." as output. If you aren't sure how to get docker set up properly, you can check out <a href="https://docs.docker.com/engine/installation/">this link</a> or <a href="https://www.google.com/search?q=install+docker">search here</a> to find your way.</p>

<h3 id="settingupsidomoaoneliner">Setting up Sidomo: a one-liner</h3>

<p>You can install sidomo directly from the git repository using pip. Just run the following command in your shell:  </p>

<pre><code class="language-bash">pip install -e 'git+https://github.com/deepgram/sidomo.git#egg=sidomo'  
</code></pre>

<h3 id="exampleasimplehelloworld">Example: a simple Hello World</h3>

<p>This will start a container from the ubuntu base image, run <code>echo hello from</code> and then <code>echo the other side</code>, and print the lines of output from the process. To prepare for this example, you need to pull the ubuntu image to your machine with one shell command.  </p>

<h6 id="shell">shell</h6>

<pre><code class="language-bash"># Get the latest Ubuntu image
docker pull ubuntu  
</code></pre>

<h6 id="python">Python</h6>

<pre><code class="language-python">from sidomo import Container

with Container('ubuntu') as c:  
    for line in c.run('bash -c "echo hello from; echo the other side;"'):
        print(line)
</code></pre>

<h3 id="examplewranglingffmpegwithsidomo">Example: wrangling FFMPEG with sidomo</h3>

<p>Now let's actually do something useful with sidomo. <a href="https://www.ffmpeg.org/">FFMPEG</a> is a somewhat complex piece of software that manipulates media files efficiently for almost any purpose, but it's not easy to install consistently on different platforms, and there are no up-to-date python bindings for it. With Sidomo, you can pull FFMPEG with docker and easily run it from Python.</p>

<h6 id="shell">shell</h6>

<pre><code class="language-bash">docker pull cellofellow/ffmpeg  
</code></pre>

<h6 id="python">Python</h6>

<p>The example below will grab audio from a URL, transcode it, and print debug messages to prove that it worked. The process's stdout (the raw audio output) is disabled since we only want to see the debug messages.  </p>

<pre><code class="language-python">from sidomo import Container  
url = 'http://www2.warwick.ac.uk/fac/soc/sociology/staff/sfuller/media/audio/9_minutes_on_epistemology.mp3'  
with Container(  
    'cellofellow/ffmpeg',
    stdout=False
) as c:
    for line in c.run(
        'bash -c \"\
            wget -nv -O tmp.unconverted %s;\
            ffmpeg -i tmp.unconverted -f wav -acodec pcm_s16le -ac 1 -ar 16000 tmp.wav;\
            cat tmp.wav\
        \"\
        ' % url
    ):
        print line
</code></pre>

<p>If you wanted to actually save the transcoded audio from this process, you would replace the line <code>stdout=False</code> with <code>stderr=False</code> and make sure to write each line of output from the container process (raw audio data) to a file.</p>

<h2 id="funinthefuture">Fun in the future</h2>

<p>If you have to write python bindings for some complex software, consider containerizing that software instead. With sidomo, turning a containerized application into a python module is painless and clean.</p>

<p>If you find yourself using subprocess frequently to interact with code for which proper bindings do not exist, then containerizing these processes may make some things simpler.</p>

<p><img src="http://www.adweek.com/socialtimes/files/2014/01/twitter-nesting-dolls.jpg" alt=""/></p>

<p>If you use sidomo in a python app that ends up developing complex dependencies, you may need to wrap the app in its own container and call it from an app with fewer dependencies on the outside. Sidomo supports this as well, since <a href="https://blog.docker.com/2013/09/docker-can-now-run-within-docker/">docker supports nested containers</a>. You can make your own software matryoshka doll by using sidomo to import sidomo to import sidomo....</p>

<p>Good luck! Just remember, you can't containerize away complexity indefinitely. Or can you?</p>

<p><a href="https://github.com/deepgram/sidomo">Sidomo on github</a></p>

<h2 id="whydwemakethis">Why'd we make this?</h2>

<p>We created the DeepGram API, a search engine for audio and video that makes speech searchable. DeepGram uses a complex stack of signal processing, statistics, and machine learning software working in concert to give a seamless "upload and search" experience. Sidomo lets us rapidly containerize finicky software and integrate it with python, our glue.</p>

<p>You can grab an account with API access at <a href="http://www.deepgram.com">www.deepgram.com</a>. The account has 40 hours of free uploads each month (this goes a long way!). Check it out and let us know <a href="http://www.deepgram.com/contact">what you think</a>.</p>
        </section>

        </div></body></html>