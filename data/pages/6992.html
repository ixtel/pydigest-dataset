<html><body><div><article class="post-content">
    <h2 id="follow-along">Follow along</h2>

<p>The Python functions used in this article are available on <a href="https://pypi.python.org/pypi/hackthederivative/0.0.1">PyPI</a> and <a href="https://github.com/eriktaubeneck/hack-the-derivative/releases/tag/v0.0.1">GitHub</a>. These links point to the most current version as of publishing (September 2015), but the latest version (if any changes have been made in the mean time) are easily available from there. To follow along at home:</p>

<div class="highlight"><pre><code>$ mkdir somewhere_new
$ cd somewhere_new
$ virtualenv venv
$ source venv/bin/activate
$ pip install hackthederivative=0.0.1
$ python
&gt;&gt;&gt; from hackthederivative import *
</code></pre></div>
<h2 id="introduction">Introduction</h2>

<p>The derivative (the mathematical flavor, not the financial) is one of the first things that a young calculus student learns. By the time they are formally taught it, it’s likely that a student has already encountered the idea before; the slope of a line (rise over run!) is typically taught a couple years earlier. The student has likely already thought about the relationship between position, speed, and acceleration in physics, even before it is explained to them directly. But the derivative is not only the first piece of calculus presented to young mathematicians, it is one of the most important cornerstones of advanced mathematics, particularly in applied mathematics.</p>

<p>Computing the derivative (as opposed to calculating it by hand) is a critical procedure in applied fields like physics, finance, and statistics. Standard approaches for this calculation exist, but as is always the case with computational mathematics, there are limits and tradeoffs.</p>

<p>When taking derivatives, we are typically working with the <a href="https://en.wikipedia.org/wiki/Real_number">real numbers</a>. The real numbers have a number of fancy mathematical properties that are incompatible with finite representation, whether that be on a piece of paper or in a computer. In fact, single irrational numbers (say <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">π</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="sqrt mord"><span class="sqrt-sign"><span class="style-wrap reset-textstyle textstyle uncramped">√</span></span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"/></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span>) cannot even <em>be</em> represented exactly in a computer. Modern 64-bit computers can, however, do exact operations on the integers modulo 18,446,744,073,709,551,616, represented unsigned as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mi>z</mi><mo>∈</mo><mrow><mi mathvariant="double-struck">Z</mi></mrow><mo>∣</mo><mn>0</mn><mo>&lt;</mo><mo>=</mo><mi>z</mi><mo>&lt;</mo><mo>=</mo><msup><mn>2</mn><mrow><mn>6</mn><mn>4</mn></mrow></msup><mo>−</mo><mn>1</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">\{z \in \mathbb{Z} \mid 0 &lt;= z &lt;= 2^{64}-1 \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord mathit">z</span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">Z</span></span><span class="mrel">∣</span><span class="mord mathrm">0</span><span class="mrel">&lt;</span><span class="mrel">=</span><span class="mord mathit">z</span><span class="mrel">&lt;</span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">2</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">6</span><span class="mord mathrm">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">}</span></span></span></span> or signed as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mi>z</mi><mo>∈</mo><mrow><mi mathvariant="double-struck">Z</mi></mrow><mo>∣</mo><mo>−</mo><msup><mn>2</mn><mrow><mn>6</mn><mn>3</mn></mrow></msup><mo>&lt;</mo><mo>=</mo><mi>z</mi><mo>&lt;</mo><mo>=</mo><msup><mn>2</mn><mrow><mn>6</mn><mn>3</mn></mrow></msup><mo>−</mo><mn>1</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">\{z \in \mathbb{Z} \mid -2^{63} &lt;= z &lt;= 2^{63}-1 \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord mathit">z</span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">Z</span></span><span class="mrel">∣</span><span class="mord">−</span><span class="mord"><span class="mord mathrm">2</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">6</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">&lt;</span><span class="mrel">=</span><span class="mord mathit">z</span><span class="mrel">&lt;</span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">2</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">6</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">}</span></span></span></span>.</p>

<p>The standard computational approximation of the real numbers are the <a href="https://en.wikipedia.org/wiki/Floating_point">floating point numbers</a>, and they work quite nicely for a great deal of calculations. Yet they are just that: an approximation. This rears its ugly head in the most standard way of computing the derivative. To understand this, we will look into the derivative itself and the implementation of floating point numbers. Once we understand the issue at hand, we’ll find an interesting solution in one of the most important theorems in modern mathematics, the <a href="https://en.wikipedia.org/wiki/Cauchy%E2%80%93Riemann_equations">Cauchy-Riemann equations</a>. To tee this up, we’ll have to understand a little bit about the imaginary number (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> in math, <code>j</code> in Python) and complex numbers. Then we’ll be ready to hack the derivative.</p>

<h2 id="the-derivative">The derivative</h2>

<p>Informally, the derivative is a mathematical method for determining the slope of a possibly nonlinear curve at a specific point, as shown in the following image from <a href="https://en.wikipedia.org/wiki/Tangent#/media/File:Tangent_to_a_curve.svg">Wikipedia</a>:</p>

<p align="center">
<img src="/images/four/hack-the-derivative/tangent.svg"/>
</p>

<p>Formally, the derivative of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f'(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">f</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>, is a new function which tells us the <em>slope</em> of the tangent line that intersects <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span></span></span></span> at any given <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>. Mathematically, we define this as</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>h</mi><mo>)</mo><mo>−</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">f</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mord mathrm">.</span></span></span></span></span></div>
<h3 id="example-1">Example 1</h3>

<p>Consider the function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f(x) = x^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span>. To find the derivative <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f'(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">f</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>, we can plug <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span></span></span></span> right into the definition:</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mi>h</mi><msup><mo>)</mo><mn>2</mn></msup><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><mrow><mi>h</mi></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi>x</mi><mi>h</mi><mo>+</mo><msup><mi>h</mi><mn>2</mn></msup><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><mrow><mi>h</mi></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mn>2</mn><mi>x</mi><mi>h</mi><mo>+</mo><msup><mi>h</mi><mn>2</mn></msup></mrow><mrow><mi>h</mi></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mn>2</mn><mi>x</mi><mo>+</mo><mi>h</mi></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><mn>2</mn><mi>x</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mi mathvariant="normal">□</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
    f'(x) &amp; = \lim_{h \to 0} \frac{(x+h)^2 - x^2}{h} \\[2.5ex]
    &amp; = \lim_{h \to 0} \frac{x^2 + 2xh + h^2 - x^2}{h} \\[2.5ex]
    &amp; = \lim_{h \to 0} \frac{2xh + h^2}{h} \\[2.5ex]
    &amp; = \lim_{h \to 0} 2x + h \\[2.5ex]
    &amp; = 2x. \\[2.5ex]
    &amp; \Box
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">f</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mord mathit">h</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mord mathit">h</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mord mathrm">.</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">□</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<h3 id="example-2">Example 2</h3>

<p>Let’s put a little more meat on it. Consider the function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x) = sin(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>. We’re going to rely on the following <a href="https://en.wikipedia.org/wiki/List_of_trigonometric_identities#Product-to-sum_and_sum-to-product_identities">trigonometric identity</a> and a lemma (proofs omitted):</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>sin</mi><mi>θ</mi><mo>±</mo><mi>sin</mi><mi>φ</mi><mo>=</mo><mn>2</mn><mi>sin</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>θ</mi><mo>±</mo><mi>φ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mi>cos</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>θ</mi><mo>∓</mo><mi>φ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sin \theta \pm \sin \varphi = 2 \sin \left ( \frac{ \theta \pm \varphi}{2} \right ) \cos \left ( \frac{ \theta \mp \varphi}{2} \right )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mop">sin</span><span class="mord mathit">θ</span><span class="mbin">±</span><span class="mop">sin</span><span class="mord mathit">φ</span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mop">sin</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">(</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">θ</span><span class="mbin">±</span><span class="mord mathit">φ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">)</span></span></span><span class="mop">cos</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">(</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">θ</span><span class="mbin">∓</span><span class="mord mathit">φ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">)</span></span></span></span></span></span></span></div>
<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>lim</mi><mrow><mi>θ</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>sin</mi><mi>θ</mi></mrow><mrow><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\lim_{\theta \to 0} \frac{\sin \theta}{\theta} = 1.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">θ</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">θ</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mop">sin</span><span class="mord mathit">θ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>Now, to find the derivative <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f'(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">f</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>, we again plug <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span></span></span></span> right into the definition:</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>sin</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>h</mi><mo>)</mo><mo>−</mo><mi>sin</mi><mi>x</mi></mrow><mrow><mi>h</mi></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mn>2</mn><mi>sin</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mi>h</mi><mo>−</mo><mi>x</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mi>cos</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mi>h</mi><mo>+</mo><mi>x</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><mrow><mi>h</mi></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mn>2</mn><mi>sin</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mi>cos</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mn>2</mn><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><mrow><mi>h</mi></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mn>2</mn><mi>sin</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mi>cos</mi><mrow><mo fence="true">(</mo><mi>x</mi><mo>+</mo><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><mrow><mi>h</mi></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>sin</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><mrow><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></mfrac><mi>cos</mi><mrow><mo fence="true">(</mo><mi>x</mi><mo>+</mo><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>sin</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><mrow><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></mfrac><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mi>cos</mi><mrow><mo fence="true">(</mo><mi>x</mi><mo>+</mo><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><mn>1</mn><mo>∗</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mi>cos</mi><mrow><mo fence="true">(</mo><mi>x</mi><mo>+</mo><mfrac><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><mi>cos</mi><mi>x</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mi mathvariant="normal">□</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
    f'(x) &amp; = \lim_{h \to 0} \frac{\sin(x+h) - \sin x}{h} \\[2.5ex]
    &amp; = \lim_{h \to 0} \frac{ 2 \sin \left ( \frac{ x + h - x }{2} \right ) \cos \left ( \frac{ x + h + x }{2} \right )}{h} \\[2.5ex]
    &amp; = \lim_{h \to 0} \frac{ 2 \sin \left ( \frac{ h }{2} \right ) \cos \left ( \frac{ 2x + h }{2} \right )}{h} \\[2.5ex]
    &amp; = \lim_{h \to 0} \frac{ 2 \sin \left ( \frac{ h }{2} \right ) \cos \left ( x + \frac{ h }{2} \right )}{h} \\[2.5ex]
    &amp; = \lim_{h \to 0} \frac{ \sin \left ( \frac{ h }{2} \right )}{\frac{h}{2}} \cos \left ( x + \frac{ h }{2} \right ) \\[2.5ex]
    &amp; = \lim_{h \to 0} \frac{ \sin \left ( \frac{ h }{2} \right )}{\frac{h}{2}} \lim_{h \to 0} \cos \left ( x + \frac{ h }{2} \right ) \\[2.5ex]
    &amp; = 1 * \lim_{h \to 0} \cos \left ( x + \frac{ h }{2} \right ) \\[2.5ex]
    &amp; = \cos x.
    &amp; \Box
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">f</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mbin">−</span><span class="mop">sin</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mop">sin</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mbin">−</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">)</span></span></span><span class="mop">cos</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mbin">+</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mop">sin</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">)</span></span></span><span class="mop">cos</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mop">sin</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">)</span></span></span><span class="mop">cos</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">(</span></span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord reset-textstyle textstyle cramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mop">sin</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mop">cos</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">(</span></span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">)</span></span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord reset-textstyle textstyle cramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mop">sin</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mop">cos</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">(</span></span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">)</span></span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mbin">∗</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mop">cos</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">(</span></span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size3">)</span></span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop">cos</span><span class="mord mathit">x</span><span class="mord mathrm">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<p>This is obviously just the tip of the derivative iceberg, and I encourage you to check out <a href="https://simple.wikipedia.org/wiki/Derivative_(mathematics)">Wikipedia</a> or a <a href="https://books.google.com/books?id=AavjDHGwGpIC&amp;lpg=PP1&amp;dq=calculus&amp;pg=PP1#v=onepage&amp;q&amp;f=false_">text book</a> if you feel uninitiated.</p>

<h2 id="finite-difference">Finite difference</h2>

<p>The most common approach for computationally estimating the derivative of a function is the <a href="https://en.wikipedia.org/wiki/Finite_difference_method"><em>finite difference method</em></a>. In the definition of the derivative, instead of taking the limit as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h \to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span>, we simply plug in a small <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">h</span></span></span></span>. It probably seems quite natural that the smaller the step we take, the closer the approximation is to the true value. A curious reader can verify this using a <a href="https://en.wikipedia.org/wiki/Taylor_series">Taylor Series expansion</a>.</p>

<p>The finite difference method can be implemented in Python quite easily:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="k">def</span> <span class="nf">finite_difference</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
           <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">h</span>
</code></pre></div>
<p>To test this out:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="k">print</span> <span class="n">finite_difference</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="mf">2.00001000001393</span>
</code></pre></div>
<p>(Remember from Example 1 that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mn>2</mn><mi>x</mi></mrow><annotation encoding="application/x-tex">f'(x) = 2x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">f</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathit">x</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f(x) = x^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span>, and so <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>(</mo><mn>1</mn><mo>)</mo><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">f'(1) = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">f</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">2</span></span></span></span>.) This is fairly accurate, but can we take it further? As discussed earlier, we are using floating point numbers, so in Python we can try this out with the smallest float.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="k">print</span> <span class="n">finite_difference</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="nb">min</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="mf">0.0</span>
</code></pre></div>
<p>This is clearly the wrong answer. Since <code>h = 0.00001</code> was reasonably small and worked before, you may be tempted to just use that. Unfortunately, it can break too: consider the case where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>0</mn></mrow></msup></mrow><annotation encoding="application/x-tex">x_0 = 10^{20}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span>.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">finite_difference</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.0e20</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="mf">0.0</span>
</code></pre></div>
<p>To understand what is happening here, we’ll take a closer look at the floating point numbers.</p>

<h2 id="floating-point-numbers">Floating point numbers</h2>

<p>A <a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format">Float64</a>, or a double-precision floating-point number, consists of</p>

<p align="center">
<img src="/images/four/hack-the-derivative/float-format.png"/>
</p>

<p>and represents a real number <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">sign</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit">g</span><span class="mord mathit">n</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">e</span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>∈</mo><mo>{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">b_i \in \{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">∈</span><span class="mopen">{</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mclose">}</span></span></span></span> such that</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mo>−</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi></mrow></msup><mo>(</mo><mn>1</mn><mi mathvariant="normal">.</mi><msub><mi>b</mi><mrow><mn>5</mn><mn>1</mn></mrow></msub><msub><mi>b</mi><mrow><mn>5</mn><mn>0</mn></mrow></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>b</mi><mrow><mn>0</mn></mrow></msub><msub><mo>)</mo><mn>2</mn></msub><mtext> </mtext><msup><mn>2</mn><mrow><mi>e</mi><mo>−</mo><mn>1</mn><mn>0</mn><mn>2</mn><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">(-1)^{sign} (1.b_{51}b_{50}...b_{0})_2 \ 2^{e-1023}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit">g</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord mspace"> </span><span class="mord"><span class="mord mathrm">2</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">e</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></div>
<p>or, potentially more readable,</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mo>−</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi></mrow></msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mn>5</mn><mn>2</mn></mrow></msubsup><msub><mi>b</mi><mrow><mn>5</mn><mn>2</mn><mo>−</mo><mi>i</mi></mrow></msub><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo fence="true">)</mo></mrow><mo>×</mo><msup><mn>2</mn><mrow><mi>e</mi><mo>−</mo><mn>1</mn><mn>0</mn><mn>2</mn><mn>3</mn></mrow></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">(-1)^{sign} \left ( 1 + \sum_{i=1}^{52} b_{52-i} 2^{-i} \right ) \times 2^{e-1023}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit">g</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size4">(</span></span><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span><span class="mord mathrm">2</span><span class="mbin">−</span><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord"><span class="mord mathrm">2</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size4">)</span></span></span><span class="mbin">×</span><span class="mord"><span class="mord mathrm">2</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">e</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>In essence, floating point numbers have three main components: the sign, the exponent (which gives us scale), and the fraction (which gives us precision). This is much like scientific notation, e.g., <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">5.916829373 \times 10^{23}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span>, but in base two. For the following example, we’ll use base ten scientific notation, since it’s a bit easier to work with.</p>

<p>This format allows for two numbers to be multiplied and divided without loss of precision:</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow/></mtd><mtd><mrow><mo>(</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup><mo>)</mo><mo>×</mo><mo>(</mo><mn>7</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>0</mn><mn>8</mn><mn>2</mn><mn>0</mn><mn>9</mn><mn>3</mn><mn>4</mn><mn>2</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn><mn>1</mn></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup><mo>×</mo><mn>7</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>0</mn><mn>8</mn><mn>2</mn><mn>0</mn><mn>9</mn><mn>3</mn><mn>4</mn><mn>2</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn><mn>1</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>7</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>0</mn><mn>8</mn><mn>2</mn><mn>0</mn><mn>9</mn><mn>3</mn><mn>4</mn><mn>2</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn><mn>1</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><mo>(</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>7</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>0</mn><mn>8</mn><mn>2</mn><mn>0</mn><mn>9</mn><mn>3</mn><mn>4</mn><mn>2</mn><mo>)</mo><mo>×</mo><mo>(</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn><mn>1</mn></mrow></msup><mo>)</mo><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
     &amp; (5.916829373 \times 10^{23}) \times (7.208209342 \times 10^{-51}) \\[2.5ex]
  =  &amp; 5.916829373 \times 10^{23} \times 7.208209342 \times 10^{-51} \\[2.5ex]
  =  &amp; 5.916829373 \times 7.208209342 \times 10^{23} \times 10^{-51} \\[2.5ex]
  =  &amp; (5.916829373 \times 7.208209342) \times (10^{23} \times 10^{-51}).
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">×</span><span class="mopen">(</span><span class="mord mathrm">7</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">4</span><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">5</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathrm">7</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">4</span><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">5</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">7</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">4</span><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">5</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">7</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">4</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mbin">×</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">5</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathrm">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<p>This works great for multiplication and division (due to associativity and commutativity) as we can rearrange and compute these operations separately. This is not the case, however, for addition and subtraction:</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow/></mtd><mtd><mrow><mo>(</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup><mo>)</mo><mo>+</mo><mo>(</mo><mn>7</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>0</mn><mn>8</mn><mn>2</mn><mn>0</mn><mn>9</mn><mn>3</mn><mn>4</mn><mn>2</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn><mn>1</mn></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>!</mo><mo>=</mo></mrow></mtd><mtd><mrow><mo>(</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>7</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>0</mn><mn>8</mn><mn>2</mn><mn>0</mn><mn>9</mn><mn>3</mn><mn>4</mn><mn>1</mn><mo>)</mo><mo>+</mo><mo>(</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn><mn>1</mn></mrow></msup><mo>)</mo></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
     &amp; (5.916829373 \times 10^{23}) + (7.208209342 \times 10^{-51}) \\[2.5ex]
  != &amp; (5.916829373 \times 7.208209341) + (10^{23} \times 10^{-51})
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mclose">!</span><span class="mrel">=</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">7</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">4</span><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">5</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">7</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">4</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">5</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<p>and so we end up with having to round off. In fact, in this case, we lose the fact that we added anything at all!</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow/></mtd><mtd><mrow><mo>(</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup><mo>)</mo><mo>+</mo><mo>(</mo><mn>7</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>0</mn><mn>8</mn><mn>2</mn><mn>0</mn><mn>9</mn><mn>3</mn><mn>4</mn><mn>2</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn><mn>1</mn></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><mo>(</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>1</mn><mn>6</mn><mn>8</mn><mn>2</mn><mn>9</mn><mn>3</mn><mn>7</mn><mn>3</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mn>2</mn><mn>3</mn></mrow></msup><mo>)</mo><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
     &amp; (5.916829373 \times 10^{23}) + (7.208209342 \times 10^{-51}) \\[2.5ex]
  =  &amp; (5.916829373 \times 10^{23}).
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">7</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">4</span><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">5</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mord mathrm">8</span><span class="mord mathrm">2</span><span class="mord mathrm">9</span><span class="mord mathrm">3</span><span class="mord mathrm">7</span><span class="mord mathrm">3</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathrm">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<p>This may seem obvious, but it means that the floating point numbers have gaps. For each floating point (except the largest one), there is a next one. More importantly, the gaps between each floating point number and the next one change as the floating point numbers get larger. We can see this in Python:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">plus_epsilon_identity</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">eps</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">eps</span> <span class="o">==</span> <span class="n">x</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">eps</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="nb">min</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">plus_epsilon_identity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="bp">False</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">plus_epsilon_identity</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="bp">True</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">plus_epsilon_identity</span><span class="p">(</span><span class="mf">1.0e20</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="bp">True</span>
</code></pre></div>
<p>Now, given <code>x_0</code>, if we choose <code>h</code> so small such that <code>x_0 + h == x_0</code>, then</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>f</mi><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><mi>h</mi><mo>)</mo><mo>−</mo><mi>f</mi><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>f</mi><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>)</mo><mo>−</mo><mi>f</mi><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>0</mn></mrow><mrow><mi>h</mi></mrow></mfrac><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{f(x_0 +h) - f(x_0)}{h} = \frac{f(x_0) - f(x_0)}{h} = \frac{0}{h} = 0.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>This is clearly undesirable. To take this on we first need to understand the size of the gaps. In Python:</p>

<div class="highlight"><pre><code>In  [7]: def eps(x):
             e = float(max(sys.float_info.min, abs(x)))
             while not plus_epsilon_identity(x, e):
                 last = e
                 e = e / 2.
             return last
In [8]: eps(1.0)
Out[8]: 2.220446049250313e-16
In [9]: eps(1.0e10)
Out[9]: 1.1102230246251565e-06
In [10]: eps(1.0e20)
Out[10]: 11102.230246251565
</code></pre></div>
<p>It turns out that a good choice for <code>h</code> is<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup></p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><msqrt><mrow><mi>u</mi></mrow></msqrt><mo>×</mo><mi>max</mi><mo>(</mo><mrow><mo fence="true">∣</mo><mi>x</mi><mo fence="true">∣</mo></mrow><mo separator="true">,</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">h = \sqrt{u} \times \max(\left \vert x \right \vert, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord mathit">h</span><span class="mrel">=</span><span class="sqrt mord"><span class="sqrt-sign"><span class="style-wrap reset-textstyle textstyle uncramped">√</span></span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathit">u</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"/></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">×</span><span class="mop">max</span><span class="mopen">(</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped">∣</span><span class="mord mathit">x</span><span class="style-wrap reset-textstyle textstyle uncramped">∣</span></span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span></span></div>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>=</mo><mi>e</mi><mi>p</mi><mi>s</mi><mo>(</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">u = eps(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">u</span><span class="mrel">=</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="mord mathit">s</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span>. We can update our finite difference method accordingly:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">finite_difference</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
             <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
                 <span class="n">h</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">eps</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
             <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">h</span>
</code></pre></div>
<p>We can test this out on some functions which we know the derivative of:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
             <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">finite_difference</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">error_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">f</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">error_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="mf">7.450580596923828e-09</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">error_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e5</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="mf">9.045761108398438e-09</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">error_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e20</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="mf">4.5369065472e-09</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">math</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">f</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">error_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="mf">1.2780011808656197e-08</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">error_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e10</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="mf">1.002014830004253</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">error_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e20</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="mf">0.9999999999998509</span>
</code></pre></div>
<p>At this point we have essentially minimized the total error, both from the finite difference method and from computational round off.<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup> As such, it would be easy to think this is as good as it gets. Surprisingly, though, with the help of the complex numbers, we can take this even further.</p>

<h2 id="complex-analysis">Complex analysis</h2>

<p>Have you ever tried to solve <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x^2 + 1 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>? If you have, you’ll know that it is impossible for all <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span>. We would need <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^2 = -1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathrm">1</span></span></span></span>, but when we square a real number, it will stay positive if it’s positive, become positive if it’s negative, or stay <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span> if it’s <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span>. In order to solve this, we actually need to bring in a whole new set of numbers: the <em>imaginary numbers</em>. We define</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><msqrt><mrow><mo>−</mo><mn>1</mn></mrow></msqrt></mrow><annotation encoding="application/x-tex">i = \sqrt{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="sqrt mord"><span class="sqrt-sign"><span class="style-wrap reset-textstyle textstyle uncramped">√</span></span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle cramped"><span class="mord">−</span><span class="mord mathrm">1</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"/></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></div>
<p>and then, together with the real numbers, build the complex numbers as:</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="double-struck">C</mi></mrow><mo>=</mo><mo>{</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi><mtext> </mtext><mi mathvariant="normal">∀</mi><mtext> </mtext><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mn>2</mn></msup><mo>}</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathbb{C} = \{x + iy \ \forall \ x,y \in \mathbb{R}^2 \}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbb">C</span></span><span class="mrel">=</span><span class="mopen">{</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">y</span><span class="mord mspace"> </span><span class="mord mathrm">∀</span><span class="mord mspace"> </span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mrel">∈</span><span class=""><span class="mord displaystyle textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">}</span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>We can now solve our dreaded <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x^2 + 1 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>±</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">\pm i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord">±</span><span class="mord mathit">i</span></span></span></span>. In fact, all polynomials of degree <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> will have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> zeros in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="double-struck">C</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbb">C</span></span></span></span></span>. There is plenty to explore in the realm of complex analysis, but we are going to focus on the derivative.</p>

<h3 id="example-3">Example 3</h3>

<p>Consider</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>z</mi><mn>2</mn></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">f(x) = z^2.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">z</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>Let <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">z = x + iy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">z</span><span class="mrel">=</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">y</span></span></span></span>. Then</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><mi>f</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>=</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi><mo>)</mo></mrow></mtd><mtd><mrow><mo>=</mo><mo>(</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi><msup><mo>)</mo><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi>i</mi><mi>x</mi><mi>y</mi><mo>+</mo><msup><mi>i</mi><mn>2</mn></msup><msup><mi>y</mi><mn>2</mn></msup></mrow></mtd></mtr><mtr><mtd><mrow/></mtd><mtd><mrow><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi>i</mi><mi>x</mi><mi>y</mi><mo>−</mo><msup><mi>y</mi><mn>2</mn></msup><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
  f(z) = f(x+iy) &amp; = (x+iy)^2 = x^2 +2ixy + i^2y^2 \\[2.5ex]
                 &amp; = x^2 + 2ixy - y^2.
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">z</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">y</span><span class="mclose">)</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"/></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">y</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mord mathit">i</span><span class="mord mathit">x</span><span class="mord mathit">y</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">i</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">y</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mord mathit">i</span><span class="mord mathit">x</span><span class="mord mathit">y</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">y</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord mathrm">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<p>Functions can always be written in terms of their <em>real</em> and <em>imaginary</em> parts, e.g., <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi><mo>)</mo><mo>=</mo><mi>u</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>+</mo><mi>i</mi><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x+iy) = u(x,y) + iv(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mclose">)</span></span></span></span>. These can also be written as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="fraktur">R</mi></mrow><mo>(</mo><mi>f</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathfrak{R}(f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathfrak">R</span></span><span class="mopen">(</span><span class="mord mathit">f</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="fraktur">I</mi></mrow><mo>(</mo><mi>f</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathfrak{I}(f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathfrak">I</span></span><span class="mopen">(</span><span class="mord mathit">f</span><span class="mclose">)</span></span></span></span>, respectively. Note that both <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">v</span></span></span></span> are real valued functions, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">y</span></span></span></span> are both real numbers. In our example, we have</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><msup><mi>y</mi><mn>2</mn></msup><mtext> </mtext><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>=</mo><mn>2</mn><mi>x</mi><mi>y</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">u(x,y) = x^2 - y^2 \ \mathrm{and} \ v(x,y) = 2xy.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">y</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord mspace"> </span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">n</span><span class="mord mathrm">d</span></span><span class="mord mspace"> </span><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mord mathit">y</span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>We now have two equations, both of two variables, and so we can take four derivatives:</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>2</mn><mi>x</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>2</mn><mi>y</mi></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mn>2</mn><mi>y</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mn>2</mn><mi>x</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
\frac{\partial u}{\partial x} = 2x &amp; \frac{\partial v}{\partial x} = 2y \\[2.5ex]
\frac{\partial u}{\partial y} = -2y &amp; \frac{\partial v}{\partial y} = 2x.
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathit">x</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathrm">2</span><span class="mord mathit">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathit">y</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mord mathrm">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<p>Note that:</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
  \frac{\partial u}{\partial x} = \frac{\partial v}{\partial y}, &amp;
  \frac{\partial u}{\partial y} = -\frac{\partial v}{\partial x}.
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord">−</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mord mathrm">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<p>These are the <a href="https://en.wikipedia.org/wiki/Cauchy%E2%80%93Riemann_equations">Cauchy-Riemann equations</a> and they hold for all analytic functions on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="double-struck">C</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbb">C</span></span></span></span></span>! (See <a href="https://books.google.com/books?id=Z26tKIymJjMC&amp;lpg=PP1&amp;dq=complex%20analysis&amp;pg=PA66#v=onepage&amp;q&amp;f=false">Marsden and Hoffman</a> for a proof.) This theorem is going to give us the power to hack the derivative.</p>

<h2 id="hack-the-derivative">Hack the derivative</h2>

<p>Given our function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>:</mo><mrow><mi mathvariant="double-struck">C</mi></mrow><mo>→</mo><mi>X</mi><mo>⊆</mo><mrow><mi mathvariant="double-struck">C</mi></mrow></mrow><annotation encoding="application/x-tex">f: \mathbb{C} \to X \subseteq \mathbb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mrel">:</span><span class="mord textstyle uncramped"><span class="mord mathbb">C</span></span><span class="mrel">→</span><span class="mord mathit">X</span><span class="mrel">⊆</span><span class="mord textstyle uncramped"><span class="mord mathbb">C</span></span></span></span></span>, with the added restriction that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>:</mo><mrow><mi mathvariant="double-struck">R</mi></mrow><mo>→</mo><mi>X</mi><mo>⊆</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">f: \mathbb{R} \to X \subseteq \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mrel">:</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="mrel">→</span><span class="mord mathit">X</span><span class="mrel">⊆</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span>, we can rewrite as</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>=</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi><mo>)</mo><mo>=</mo><mi>u</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>+</mo><mi>i</mi><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(z) = f(x+iy) = u(x,y) + iv(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">z</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mclose">)</span></span></span></span></span></div>
<p>Now, for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>∈</mo><mrow><mi mathvariant="double-struck">C</mi></mrow></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">z</span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">C</span></span></span></span></span> we are only concerned with the subset of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>z</mi></mrow><mo>¯</mo></mover><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">\bar{z} \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord textstyle cramped"><span class="mord mathit">z</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="accent-body"><span>¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span>. This tells us that for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>z</mi></mrow><mo>¯</mo></mover><mo>=</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\bar{z} = x + iy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord textstyle cramped"><span class="mord mathit">z</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="accent-body"><span>¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">y</span></span></span></span>, we know that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">y</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>. Plugging this in</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mover accent="true"><mrow><mi>z</mi></mrow><mo>¯</mo></mover><mo>)</mo><mo>=</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>i</mi><mn>0</mn><mo>)</mo><mo>=</mo><mi>u</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo><mo>+</mo><mi>i</mi><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">f(\bar{z}) = f(x + i0) = u(x,0) + iv(x,0).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord accent"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathit">z</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="accent-body"><span>¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>Similarly, we know that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>:</mo><mrow><mi mathvariant="double-struck">R</mi></mrow><mo>→</mo><mi>X</mi><mo>⊆</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">f: \mathbb{R} \to X \subseteq \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mrel">:</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="mrel">→</span><span class="mord mathit">X</span><span class="mrel">⊆</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mover accent="true"><mrow><mi>z</mi></mrow><mo>¯</mo></mover><mo>)</mo><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">f(\bar{z}) \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord accent"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord textstyle cramped"><span class="mord mathit">z</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="accent-body"><span>¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span>, which tells us that</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">v(x,0) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span></span></div>
<p>and so</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo><mo>=</mo><mi>u</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">f(x,0) = u(x,0).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>We’ve done a bit of algebra here, but all we are really saying is that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span></span></span></span> returns real values for real valued input. We are going to use this and the Cauchy Riemann equations to our advantage.</p>

<p>We are attempting to estimate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{df}{\partial x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span></span>. Since for all <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>z</mi></mrow><mo>¯</mo></mover><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">\bar{z} \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord textstyle cramped"><span class="mord mathit">z</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="accent-body"><span>¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span> we know <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">f=u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mrel">=</span><span class="mord mathit">u</span></span></span></span>,</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{df}{\partial x} = \frac{\partial u}{\partial x} = \frac{\partial v}{\partial y}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>Using the definition of the derivative,</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>+</mo><mi>h</mi><mo>)</mo><mo>−</mo><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\partial v}{\partial y} = \lim_{h \to 0} \frac{v(x,y+h) - v(x,y)}{h}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">y</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>We know <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>z</mi></mrow><mo>¯</mo></mover><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">\bar{z} \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord textstyle cramped"><span class="mord mathit">z</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="accent-body"><span>¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span>, so we can substitute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">y</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">v(x, 0) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>:</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo></mrow></mtd><mtd><mrow><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>h</mi><mo>)</mo><mo>−</mo><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{align}
  \frac{\partial v}{\partial y} = &amp; \lim_{h \to 0} \frac{v(x,h) - v(x,0)}{h} \\[2.5ex]
   = &amp; \lim_{h \to 0} \frac{v(x,h)}{h}.
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="minner"><span class="mtable"><span class="col-align-r"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="arraycolsep"/><span class="arraycolsep"/><span class="col-align-l"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mord mathrm">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span></span></span></span></span></span></span></div>
<p>eliminating both addition/subtraction operations that are so susceptible to rounding errors!</p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\partial v}{\partial y} = \lim_{h \to 0} \frac{v(x,h)}{h}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>Now, to estimate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{df}{\partial x} = \frac{\partial v}{\partial y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">y</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">∂</span><span class="mord mathit">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span></span></span></span>, we again use a very small <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">h</span></span></span></span></p>

<div class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>≈</mo><mfrac><mrow><mi>v</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow><mi mathvariant="fraktur">I</mi></mrow><mo>(</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>h</mi><mo>)</mo><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{df}{\partial x} \approx \frac{v(x,h)}{h} = \frac{\mathfrak{I}(f(x+ih))}{h}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">∂</span><span class="mord mathit">x</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">≈</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">v</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped frac-line"/></span><span><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathfrak">I</span></span><span class="mopen">(</span><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">i</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span>​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"/></span><span class="mord mathrm">.</span></span></span></span></span></div>
<p>This time, however, we will be able to use a much smaller <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">h</span></span></span></span>.
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">□</mi></mrow><annotation encoding="application/x-tex">\Box</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathrm">□</span></span></span></span></p>

<p>Python has native support for complex numbers, so we can implement this as</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">complex_step_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
           <span class="n">h</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="nb">min</span>
           <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="mf">1.0</span><span class="n">j</span><span class="p">))</span><span class="o">.</span><span class="n">imag</span> <span class="o">/</span> <span class="n">h</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">f</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">complex_step_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="mf">2.0</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">complex_step_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.0e10</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="mf">20000000000.0</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">complex_step_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.0e20</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="mf">2e+20</span>
</code></pre></div>
<p>The results here are stunning. We can formally test this out the same way as above:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">cerror</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
           <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">complex_step_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
           <span class="k">return</span> <span class="n">cerror</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">x</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="mf">0.0</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e10</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="mf">0.0</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e20</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="mf">0.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">cmath</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">f</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">cmath</span><span class="o">.</span><span class="n">cos</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="mf">0.0</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e10</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="mf">0.0</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e20</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="mf">0.0</span>
</code></pre></div>
<p>Again, stunning, but we can find <em>some</em> cases where it’s not perfect:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e5</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="o">.</span><span class="mf">110933124815182e-16</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">cmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">cmath</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mf">1.5</span><span class="p">))</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="mf">0.0</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="mf">1.1570932160552342e-16</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">5.67</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="mf">1.2795419601231268e-16</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">cerror_rate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.0e3</span><span class="p">)</span>
<span class="n">Out</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="nb">OverflowError</span><span class="p">:</span> <span class="n">math</span> <span class="nb">range</span> <span class="n">error</span>
</code></pre></div>
<p>As you can see, the implementation of some complex functions have limitations. We also will not be able to use <code>abs</code> (its imaginary part is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span> by definition) or a function with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mrel">&lt;</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mrel">&gt;</span></span></span></span> in it (the complex numbers <a href="https://en.wikipedia.org/wiki/Complex_number#Ordering">are not ordered</a>).</p>

<h2 id="the-hack-in-the-details">The hack in the details</h2>

<p>This is not an unknown method: the ACM Transactions on Mathematical Software published an article on the subject, <a href="http://dl.acm.org/citation.cfm?id=838251"><em>The complex-step derivative approximation</em></a> by Martins, Sturdza, and Alonso, in 2003. It also is not the only alternative to finite differencing. In fact, SIAM (the Society for Industrial and Applied Mathematics) issued a volume, <a href="http://www.amazon.com/Computational-Differentiation-Applications-Proceedings-Mathematics/dp/0898713854">Computational Differentiation: Techniques, Applications, and Tools (Siam Proceedings in Applied Mathematics Series ; Vol. 89)</a>, on the topic. We’ve only managed to scratch the surface here, and I make no claims of this being the optimal solution. (The optimal solution is almost entirely contextual, anyway.) There is plenty of the computational differentiation rabbit hole to left to explore.</p>

<p>The advantage of this method over finite differencing is quite stark (within the bounds where it works). Not only is it more accurate, but it also doesn’t involve the extra search for the right step size. Exploring these advantages and comparing them not only to finite differencing but all the other known methods is beyond the scope of an article such as this. But there is something quite interesting happening in the details here that offers a bit of insight into numerical computation. The “hack” that makes this work lies in the fact that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo><mo>=</mo><mi>u</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x,0) = u(x,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span> and the substitution using the Cauchy-Riemann equations. But in general, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo><mo>=</mo><mi>u</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x,0) = u(x,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span> is basically just the identity function. Yet somehow this gives us startlingly more accurate results.</p>

<p>The devil is in the details. The problems with the finite-differencing methods arise from the fact that basic mathematical truths, such as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>+</mo><mi>ϵ</mi><mo>≠</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">x + \epsilon \ne x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">ϵ</span><span class="mrel">≠</span><span class="mord mathit">x</span></span></span></span> whenever <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\epsilon \ne 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">ϵ</span><span class="mrel">≠</span><span class="mord mathrm">0</span></span></span></span>, do not hold true in floating point arithmetic. It is not actually that surprising that this is the case. Take the number <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut"/><span class="strut bottom"/><span class="base textstyle uncramped"><span class="mord mathit">π</span></span></span></span>, for example. Even with every atom in the visible universe acting as a bit in some hypothetical “universe computer”, you would not be able to represent the whole thing. It goes on forever. And there are uncountably more digits that are just the same way. In a lot of respects, it’s quite amazing how accurate many calculations can be made with floating numbers, like <a href="https://en.wikipedia.org/wiki/Orbital_mechanics">orbital mechanics</a> and <a href="https://en.wikipedia.org/wiki/Heat_equation">heat equations</a>. It is important to remember that numerical computation is not abstract mathematics, and to have an awareness of what is happening under the hood. This hack gives us a fun way to take a peek, see where things break down, and use some other mathematics to patch it up.</p>



  </article>

  
    </div></body></html>