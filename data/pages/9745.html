<html><body><div><div class="post-text" itemprop="text">

<p>Suppose I have a simple <code>Test</code> class which inherits from <code>numpy.ndarray</code> (<a href="http://docs.scipy.org/doc/numpy-1.10.1/user/basics.subclassing.html">documentation on <code>ndarray</code> subclassing</a>). This class creates an object which is a partial view of another <code>ndarray</code>. Now I would like to create a method that modifies this view in-place. Something like:</p>

<pre><code>import numpy


class Test(numpy.ndarray):

    def __new__(cls, info='Test class'):
        base = numpy.ndarray.__new__(cls, (6, 2), dtype=float)
        view = base[0:2, :]
        view.info = info
        return view

    def __array_finalize__(self, obj):
        if obj is None:
            return
        self.info = getattr(obj, 'info', None)

    def change_view(self, start, stop):
        """This is the method I'd like to implement"""
        # Incorrect, but represents what I am looking for
        self = self.base[start:stop]


if __name__ == '__main__':
    t = Test()
    print(t)
    print(t.info)
    t.change_view(1, 5)
    print(t)
    print(t.info)
</code></pre>

<p>I would expect the method <code>.change_view(x)</code> to modify the view of the <code>.base</code> attribute to show rows <code>[1:5]</code> instead of <code>[0:2]</code>, which is the default in <code>__new__()</code>.</p>

<p>Is this possible? If so, how? Otherwise, why not? Note that <code>.base</code> never changes (it always occupies the same memory space), I just want to change the view of it.</p>

<h2>Notes</h2>

<ul>
<li>See the comments in <code>change_view()</code>. I know <code>self = self.base[start:stop]</code> is not correct, and I know and understand why, but I think it is a short way to represent what I am looking for.</li>
<li>As noted in the answers bellow, one could think of <code>self[:] = ...</code> or <code>self.data = ...</code>. However, this will not work when changing the view size (which is exactly the case).</li>
</ul>

<h2>References</h2>

<p>This question <a href="http://stackoverflow.com/questions/5149269/subclassing-numpy-ndarray-problem">was already asked here</a> (or at least it is a similar case), but answers referred to solutions which returned the modified array (i.e. no in-place modification) or which used a wrapper object (i.e. having an attribute with the array that is to be modified).</p>

<p>I am aware of those possibilities, and I know they can be simpler or even more convenient. However, I would like to understand why (if so) it is not possible to do what I am looking for.</p>
    </div>
    </div></body></html>