<html><body><div><div id="installation">
<h2>Installation</h2>
<p>The current stable release:</p>
<pre>pip install pytest_click
</pre>
<p>or:</p>
<pre>easy_install pytest_click
</pre>
<p>or from source:</p>
<pre>$ sudo python setup.py install
</pre>
</div>
<div id="usage">
<h2>Usage</h2>
<p>pytest-click comes with some configurable fixtures - <tt>cli_runner</tt> and <tt>isolated_cli_runner</tt>.</p>
<pre><span class="kn">import</span> <span class="nn">click</span>


<span class="k">def</span> <span class="nf">test_cli</span><span class="p">(</span><span class="n">cli_runner</span><span class="p">):</span>

    <span class="nd">@click.command</span><span class="p">()</span>
    <span class="nd">@click.argument</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s1">'Hello </span><span class="si">%s</span><span class="s1">!'</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">cli_runner</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">hello</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Peter'</span><span class="p">])</span>
    <span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">exit_code</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">'Hello Peter!</span><span class="se">\n</span><span class="s1">'</span>
</pre>
<pre><span class="kn">import</span> <span class="nn">click</span>


<span class="k">def</span> <span class="nf">test_fixture</span><span class="p">(</span><span class="n">isolated_cli_runner</span><span class="p">):</span>

    <span class="nd">@click.command</span><span class="p">()</span>
    <span class="nd">@click.argument</span><span class="p">(</span><span class="s1">'f'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">click</span><span class="o">.</span><span class="n">File</span><span class="p">())</span>
    <span class="k">def</span> <span class="nf">cat</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'hello.txt'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'Hello World!'</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">isolated_cli_runner</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="p">[</span><span class="s1">'hello.txt'</span><span class="p">])</span>
    <span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">exit_code</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">'Hello World!</span><span class="se">\n</span><span class="s1">'</span>
</pre>
<p>Both runners can be configured via <tt>runner_setup</tt> mark:</p>
<pre><span class="kn">import</span> <span class="nn">pytest</span>


<span class="nd">@pytest.mark.runner_setup</span><span class="p">(</span><span class="n">charset</span><span class="o">=</span><span class="s1">'cp1251'</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">'test'</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">echo_stdin</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_runner_setup</span><span class="p">(</span><span class="n">cli_runner</span><span class="p">):</span>
    <span class="o">...</span>
</pre>
<p>All kwargs will be passed to <tt>click.testing.CliRunner</tt> initialization.</p>
</div>
<div id="python-support">
<h2>Python support</h2>
<p>pytest-click supports Python 2.6, 2.7, 3.3, 3.4, 3.5, PyPy, PyPy3 and Jython.</p>
</div>


</div></body></html>