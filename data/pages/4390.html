<html><body><div><div class="blog-entry" id="e20150502T161137"><p>Working in a Python project, it's common to have a clean-up step that
    deletes all the .pyc files, like this:</p><blockquote class="code"><code><span class="nv">$ </span>find . -name <span class="s1">'*.pyc'</span> -delete
<br/></code></blockquote><p>This works great, but there's a slight chance of a problem: Git records
    information about branches in files within the .git directory.  These files
    have the same name as the branch.</p><p>Try this:</p><blockquote class="code"><code><span class="nv">$ </span>git checkout -b cleanup-all-.pyc
<br/></code></blockquote><p>This makes a branch called "cleanup-all-.pyc".  After making a commit, I
    will have files named .git/refs/heads/cleanup-all-.pyc and
    logs/refs/heads/cleanup-all-.pyc. Now if I run my find command, it will
    delete those files inside the .git directory, and my branch will be
    lost.</p><p>One way to fix it is to tell find not to delete the file if it's found in
    the .git directory:</p><blockquote class="code"><code><span class="nv">$ </span>find . -name <span class="s1">'*.pyc'</span> -not -path <span class="s1">'./.git/*'</span> -delete
<br/></code></blockquote><p>A better way is:</p><blockquote class="code"><code><span class="nv">$ </span>find . -name <span class="s1">'.git'</span> -prune -o -name <span class="s1">'*.pyc'</span> -exec rm <span class="o">{}</span> <span class="se">\;</span><br/></code></blockquote><p>The first command examines every file in .git, but won't delete the .pyc it
    finds there.  The second command will skip the entire .git directory, and
    not waste time examining it.</p><p>UPDATE: I originally had -delete in that latter command, but find doesn't
    like -prune and -delete together.  It seems simplistic and unfortunate,
    but there it is.</p></div></div></body></html>