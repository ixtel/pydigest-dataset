<html><body><div><div class="content">
							
							
							
		
							<p>Django and Flask are two well known Python web frameworks. There are lot of benchmarks claim Flask is 2x
faster for simple JSON Response, one such is <a href="http://t.umblr.com/redirect?z=https%3A%2F%2Fwww.techempower.com%2Fbenchmarks%2F&amp;t=OTAwZGY3OTJlMDg5MTQ0YjJiNTU0NDZmZjAxN2EzOGEwYzk0YWY2ZSxrdFVDU3Q3Uw%3D%3D" target="_blank">Techempower</a>. After looking
into the <a href="http://t.umblr.com/redirect?z=https%3A%2F%2Fgithub.com%2FTechEmpower%2FFrameworkBenchmarks%2Ftree%2Fmaster%2Fframeworks%2FPython%2Fdjango&amp;t=NjZjOGU5MmRkMDBiZWI1NGNlZmRmZjcxODIzN2VjMTRhZjk3NGY5NCxrdFVDU3Q3Uw%3D%3D" target="_blank">source</a>, it struck
me Django can do better!</p>

<p>I will compare Flask and Django for simple json response. The machine used is Macbook pro, <code>Intel Core i5-4258U CPU @ 2.40GHz</code>,
with <code>8 GB</code> Memory on <code>OS X 10.10.3</code>. <code>gunicorn==19.3.0</code> will be used for serving WSGI application.</p>

<pre><code>#flask simple app
from flask import Flask, jsonify

app = Flask(__name__)

@app.route('/index')
def index():
    return jsonify({'hello': 'world'})

if __name__ == "__main__":
    app.run()
</code></pre>

<p>Start the flask app, <code>gunicorn -w 2 -b 127.0.0.1:5000 flask_app:app</code>.</p>

<p><code>apachebench</code> will be used for benchmarking, you can use any tool for this.</p>

<pre><code>ab -n 1000 -c 2 http://localhost:5000/index
...
Server Software:        gunicorn/19.3.0
Server Hostname:        localhost
Server Port:            5000

Document Path:          /index
Document Length:        22 bytes

Concurrency Level:      2
Time taken for tests:   0.622 seconds
Complete requests:      1000
Failed requests:        0
Total transferred:      174000 bytes
HTML transferred:       22000 bytes
Requests per second:    1429.55 [#/sec] (mean)
Time per request:       1.399 [ms] (mean)
Time per request:       0.700 [ms] (mean, across all concurrent requests)
Transfer rate:          242.91 [Kbytes/sec] received
</code></pre>

<p>Now let’s do same thing with Django 1.8 with default settings.</p>

<pre><code>#hello/views.py
from django.http import JsonResponse

# Create your views here.
def index(request):
    return JsonResponse({'hello': 'world'})
</code></pre>

<p>Add <code>url('^index/$', index),</code> in <code>urls.py</code> and <code>hello</code> app in <code>settings.py</code>.
Start the Django app, <code>gunicorn -w 2 -b 127.0.0.1:8000 django_app.wsgi</code>.</p>

<pre><code>ab -n 1000 -c 2 http://localhost:8000/index/
...
Server Software:        gunicorn/19.3.0
Server Hostname:        localhost
Server Port:            8000

Document Path:          /index/
Document Length:        18 bytes

Concurrency Level:      2
Time taken for tests:   0.814 seconds
Complete requests:      1000
Failed requests:        0
Total transferred:      179000 bytes
HTML transferred:       18000 bytes
Requests per second:    1228.25 [#/sec] (mean)
Time per request:       1.628 [ms] (mean)
Time per request:       0.814 [ms] (mean, across all concurrent requests)
Transfer rate:          214.70 [Kbytes/sec] received
</code></pre>

<p>Time taken for 1000 requests by Django is <code>0.814s</code> and Flask is <code>0.622s</code>. Clearly flask is faster.</p>

<p>Django is full fledged framework but Flask is micro framework. Django comes with lot of middlewares, contrib
models etc … Remove all those unused settings in <code>settings.py</code>.</p>

<p>Comment all <code>middleware classes</code>. The <code>settings</code> snippet looks like</p>

<pre><code>INSTALLED_APPS = (
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',

    'hello',
)

MIDDLEWARE_CLASSES = (
    # 'django.contrib.sessions.middleware.SessionMiddleware',
    # 'django.middleware.common.CommonMiddleware',
    # 'django.middleware.csrf.CsrfViewMiddleware',
    # 'django.contrib.auth.middleware.AuthenticationMiddleware',
    # 'django.contrib.messages.middleware.MessageMiddleware',
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
)
</code></pre>

<p>Restart the django app and run <code>ab -n 1000 -c 2 http://localhost:8000/index/</code>.</p>

<pre><code>...
Server Software:        gunicorn/19.3.0
Server Hostname:        localhost
Server Port:            8000

Document Path:          /index/
Document Length:        18 bytes

Concurrency Level:      2
Time taken for tests:   0.560 seconds
Complete requests:      1000
Failed requests:        0
Total transferred:      150000 bytes
HTML transferred:       18000 bytes
Requests per second:    1784.37 [#/sec] (mean)
Time per request:       1.121 [ms] (mean)
Time per request:       0.560 [ms] (mean, across all concurrent requests)
Transfer rate:          261.38 [Kbytes/sec] received
</code></pre>

<p>Now Django took only <code>0.560s</code> for 1000 requests compared to flask <code>0.622s</code>.</p>

<p>Now remove Django admin from <code>urls.py</code>, and remove all <code>contrib</code> apps in <code>INSTALLED_APPS</code>.</p>

<pre><code>INSTALLED_APPS = (
#'django.contrib.admin',
#'django.contrib.auth',
#'django.contrib.contenttypes',
#'django.contrib.sessions',
#'django.contrib.messages',
#'django.contrib.staticfiles',

'hello',
)
</code></pre>

<p>Restart the Django app and run the benchmark <code>ab -n 1000 -c 2 http://localhost:5000/index</code>.</p>

<pre><code>...
Server Software:        gunicorn/19.3.0
Server Hostname:        localhost
Server Port:            8000

Document Path:          /index/
Document Length:        18 bytes

Concurrency Level:      2
Time taken for tests:   0.553 seconds
Complete requests:      1000
Failed requests:        0
Total transferred:      150000 bytes
HTML transferred:       18000 bytes
Requests per second:    1806.90 [#/sec] (mean)
Time per request:       1.107 [ms] (mean)
Time per request:       0.553 [ms] (mean, across all concurrent requests)
Transfer rate:          264.68 [Kbytes/sec] received
</code></pre>

<p>That is much better. While developing API based application in Django tweak <code>settings.py</code> to get
better performance out of Django. Source code for this benchmark can be found in <a href="http://t.umblr.com/redirect?z=https%3A%2F%2Fgithub.com%2Fkracekumar%2Fflask_vs_django_bench&amp;t=YWIwNDYxYjJlZjk2OTVkMGNkNWRjOTE3MTA4ODkzMmI1M2RkNjA0MixrdFVDU3Q3Uw%3D%3D" target="_blank">Github</a>.</p>
						</div>
						
						</div></body></html>