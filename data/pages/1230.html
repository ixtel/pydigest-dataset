<html><body><div><div class="col-md-12">
				<p>When your website crashes you can either hear about it from your alerting software or an angry customer. That’s why a variety of hosted services exist to monitor websites.</p>
<p dir="ltr">However, for small websites you often want a simple open source project that can be set up in a couple of minutes to get the monitoring job done. In this post we’ll walk through the creation of a monitoring and alerting Python package.</p>
<p dir="ltr">This project is called Plushcap. What’s a Plushcap? It’s a species of tiny bird found in South American countries such as Argentina and Peru.</p>
<p dir="ltr"><img src="https://lh4.googleusercontent.com/1l4NeOZsohRrVBq_fOYqTsLi_GPbAprnNixwiaGv_TbGw6QPtVxP7_F9Rx_aYuAQU9KG26Bx2LxhBjiNsqpPqHs_3HAuBGoHrJOLKJ6zopKCxffui1gLQiIPqlHAWS6Lcg" alt=""/></p>
<p dir="ltr">We’re going with the name Plushcap for a few reasons. First, the name is available on <a href="https://pypi.python.org/pypi">PyPI</a> so there will not be any naming conflicts. Second, there are no projects named “plushcap” on GitHub in any language so we won’t be stepping on anyone else’s open source project name. Third and most importantly, I’m a huge fan of the amazing <a href="http://blog.getpelican.com/">Pelican</a> static website generator. Plushcap is a nod to that other P-bird-named open source project.</p>
<p dir="ltr">Many blog posts just walk through coding an app. This post will go a step farther and walk through the entire lifecycle of a Python open source project from initial code structure to making Plushcap available on PyPI.</p>
<h3>Setting up our Initial Python Package</h3>
<p dir="ltr">There’s some boilerplate code required for a Python project to be installable via PyPI. We can use the wonderful <a href="http://cookiecutter.readthedocs.org/en/latest/">cookiecutter</a> tool to get our initial codebase together. Cookiecutter has some external dependencies such as Jinja2 so I create a separate virtualenv just for these initial bootstrapping steps.</p>
<p/>

		<div id="crayon-56d5b9b22729f709579390" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b22729f709579390-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">virtualenv</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">no</span><span class="crayon-o">-</span><span class="crayon-v">site</span><span class="crayon-o">-</span><span class="crayon-v">packages</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-o">/</span><span class="crayon-v">Envs</span><span class="crayon-o">/</span><span class="crayon-v">cookie</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Next we activate the virtualenv.</p>
<p/>

		<div id="crayon-56d5b9b2272c1665884383" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2272c1665884383-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">source</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-o">/</span><span class="crayon-v">Envs</span><span class="crayon-o">/</span><span class="crayon-v">cookie</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">activate</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Install cookiecutter.</p>
<p/>

		<div id="crayon-56d5b9b2272d5678785866" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2272d5678785866-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">cookiecutter</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Now let’s create a directory where our project will be stored along with the requisite files for a Python package. Our input is bolded.</p>
<p/>

		<div id="crayon-56d5b9b2272e9544570975" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-2">2</p><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-4">4</p><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-6">6</p><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-8">8</p><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-10">10</p><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-12">12</p><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-14">14</p><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-16">16</p><p class="crayon-num" data-line="crayon-56d5b9b2272e9544570975-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2272e9544570975-18">18</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-1"><span class="crayon-sy">(</span><span class="crayon-v">cookie</span><span class="crayon-sy">)</span><span class="crayon-o">~</span><span class="crayon-o">/</span><span class="crayon-v">devel</span><span class="crayon-o">/</span><span class="crayon-v">py</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">cookiecutter </span><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//github.com/audreyr/cookiecutter-pypackage.git</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-2"><span class="crayon-e">Cloning </span><span class="crayon-i">into</span><span class="crayon-h"> </span><span class="crayon-s">'cookiecutter-pypackage'</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></p><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-3"><span class="crayon-v">remote</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Reusing </span><span class="crayon-e">existing </span><span class="crayon-v">pack</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">377</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-4"><span class="crayon-v">remote</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Counting </span><span class="crayon-v">objects</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">.</span></p><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-5"><span class="crayon-v">remote</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Compressing </span><span class="crayon-v">objects</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-o">/</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-6"><span class="crayon-v">remote</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Total</span><span class="crayon-h"> </span><span class="crayon-cn">383</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">delta</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">reused</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">delta</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-7"><span class="crayon-e">Receiving </span><span class="crayon-v">objects</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">383</span><span class="crayon-o">/</span><span class="crayon-cn">383</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">59.93</span><span class="crayon-h"> </span><span class="crayon-v">KiB</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-8"><span class="crayon-e">Resolving </span><span class="crayon-v">deltas</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">187</span><span class="crayon-o">/</span><span class="crayon-cn">187</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">.</span></p><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-9"><span class="crayon-e">full_name</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"Audrey Roy"</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-e">Matt </span><span class="crayon-e">Makai</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-10"><span class="crayon-e">email</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"audreyr@gmail.com"</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-v">mmakai</span><span class="crayon-sy">@</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></p><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-11"><span class="crayon-e">github_username</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"audreyr"</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-e">makaimc</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-12"><span class="crayon-e">project_name</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"Python Boilerplate"</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-e">Plushcap</span></p><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-13"><span class="crayon-e">repo_name</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"boilerplate"</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-e">plushcap</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-14"><span class="crayon-e">project_short_description</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"Python Boilerplate contains all the boilerplate you need to create a Python package."</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-e">Plushcap </span><span class="crayon-e">monitors </span><span class="crayon-e">websites </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">alerts </span><span class="crayon-e">people </span><span class="crayon-e">via </span><span class="crayon-e">text </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-e">phone </span><span class="crayon-e">call </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">there </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">problem</span><span class="crayon-sy">.</span></p><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-15"><span class="crayon-e">release_date</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"2014-01-11"</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-cn">2014</span><span class="crayon-o">-</span><span class="crayon-cn">07</span><span class="crayon-o">-</span><span class="crayon-cn">06</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-16"><span class="crayon-e">year</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"2014"</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span></p><p class="crayon-line" id="crayon-56d5b9b2272e9544570975-17"><span class="crayon-e">version</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">default</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"0.1.0"</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2272e9544570975-18"><span class="crayon-sy">(</span><span class="crayon-v">cookie</span><span class="crayon-sy">)</span><span class="crayon-o">~</span><span class="crayon-o">/</span><span class="crayon-v">devel</span><span class="crayon-o">/</span><span class="crayon-v">py</span><span class="crayon-sy">$</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">What did cookiecutter just do? It cloned the <a href="https://github.com/audreyr/cookiecutter-pypackage">cookiecutter-pypackage.git</a> repository and inserted the input values into files in our Python package directory named plushcap. We now have a directory with the following files.</p>
<ul>
<li>
			<span id="crayon-56d5b9b2272fd964833287" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">AUTHORS</span><span class="crayon-sy">.</span><span class="crayon-v">rst</span></span></span> – <a href="http://sphinx-doc.org/rest.html">reStructuredText</a> file with a list of package author’s names and optionally their email addresses </li>
<li>
			<span id="crayon-56d5b9b227311219786081" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">CONTRIBUTING</span><span class="crayon-sy">.</span><span class="crayon-v">rst</span></span></span> – guidelines for open source contributions to this project </li>
<li>
			<span id="crayon-56d5b9b227324783070907" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">HISTORY</span><span class="crayon-sy">.</span><span class="crayon-v">rst</span></span></span> – placeholder file for documenting changes for each version of the library </li>
<li>
			<span id="crayon-56d5b9b227337079250953" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">Makefile</span></span></span> – convenient shortcut commands with the <a href="http://www.gnu.org/software/make/">make</a> program for packaging, testing and building the package and documentation </li>
<li>
			<span id="crayon-56d5b9b22734b355117022" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">LICENSE</span></span></span> – boilerplate legalese with the BSD license </li>
<li>
			<span id="crayon-56d5b9b22735e963969566" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">MANIFEST</span><span class="crayon-sy">.</span><span class="crayon-st">in</span></span></span> – enumerates the files to include in the Python package distributable when it is built </li>
<li>
			<span id="crayon-56d5b9b227371712140466" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">README</span><span class="crayon-sy">.</span><span class="crayon-v">rst</span></span></span> – the first documentation file for others to review when they encounter the project </li>
<li>
			<span id="crayon-56d5b9b227384523173651" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">requirements</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span></span></span> – application dependencies for developers working on the Plushcap library </li>
<li>
			<span id="crayon-56d5b9b227397271832946" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">setup</span><span class="crayon-sy">.</span><span class="crayon-v">cfg</span></span></span> – <a href="https://docs.python.org/2/distutils/configfile.html">setup configuration file</a> </li>
<li>
			<span id="crayon-56d5b9b2273a9110231319" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">setup</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> – <a href="https://docs.python.org/2/distutils/setupscript.html">Python setup script</a> for packaging </li>
<li>
			<span id="crayon-56d5b9b2273bd651768156" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-v">tox</span><span class="crayon-sy">.</span><span class="crayon-v">ini</span></span></span> – configuration for the <a href="https://testrun.org/tox/latest/">tox automation project</a> </li>
<li>
			<span id="crayon-56d5b9b2273d0132992863" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-sy">.</span><span class="crayon-v">travis</span><span class="crayon-sy">.</span><span class="crayon-v">yml</span></span></span> – configuration file for <a href="https://travis-ci.org/">Travis CI</a> automated builds that are free for open source projects </li>
<li>
			<span id="crayon-56d5b9b2273e2461094053" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas"><span class="crayon-pre crayon-code"><span class="crayon-sy">.</span><span class="crayon-v">gitignore</span></span></span> – Python-specific Git ignore file for files we do not want to include in the package’s Git repository </li>
</ul>
<p dir="ltr">We also have the following directories.</p>

<p dir="ltr">Next our new project will need its own virtualenv.</p>
<p/>

		<div id="crayon-56d5b9b22742f810650412" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b22742f810650412-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">virtualenv</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">no</span><span class="crayon-o">-</span><span class="crayon-v">site</span><span class="crayon-o">-</span><span class="crayon-v">packages</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-o">/</span><span class="crayon-v">Envs</span><span class="crayon-o">/</span><span class="crayon-i">plushcap</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22742f810650412-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">source</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-o">/</span><span class="crayon-v">Envs</span><span class="crayon-o">/</span><span class="crayon-v">plushcap</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">activate</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Once the virtualenv is activated we’ll have a prompt like the following to let us know the virtualenv that is currently in use.</p>
<p/>

		

<p/>
<h3>Initial Git commit</h3>
<p dir="ltr">For the remainder of this tutorial assume that we’ve activated the plushcap virtualenv even if it is not shown at the prompt. Next we change into the Plushcap project directory.</p>
<p/>

		

<p/>
<p dir="ltr">Let’s initialize the git repository and prep a push to a remote repository we’ll set up on GitHub.</p>
<p dir="ltr">Note that on Windows Git may add a remote repository after the git init command. Remove the incorrect remote repository with git remote remove origin then execute steps 2-4.</p>
<p/>

		<div id="crayon-56d5b9b227469017414815" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b227469017414815-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">git </span><span class="crayon-i">init</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227469017414815-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">git </span><span class="crayon-e">remote </span><span class="crayon-e">add </span><span class="crayon-e">origin </span><span class="crayon-v">git</span><span class="crayon-sy">@</span><span class="crayon-v">github</span><span class="crayon-sy">.</span><span class="crayon-v">com</span><span class="crayon-o">:</span><span class="crayon-v">makaimc</span><span class="crayon-o">/</span><span class="crayon-v">plushcap</span><span class="crayon-sy">.</span><span class="crayon-i">git</span></p><p class="crayon-line" id="crayon-56d5b9b227469017414815-3"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">git </span><span class="crayon-v">add</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">A</span><span class="crayon-h"> </span><span class="crayon-sy">.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227469017414815-4"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">git </span><span class="crayon-v">commit</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">m</span><span class="crayon-h"> </span><span class="crayon-s">"Initial commit with skeleton project structure."</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Let’s get our public repository set up on GitHub so we can push it there.</p>
<p dir="ltr"><img src="https://lh6.googleusercontent.com/qGtac52m9-V9ZXlG9gv0Ilwn0D8BsELL9f1BWc9yZN0yE64OG9DpARB3uPkmhutYQa5onyvLYGGECn5gl7kfLFQ0_AxR8L8DVSE7P_Zf36uMwecOND6H-pywGwNzm28kRg" alt=""/></p>
<p dir="ltr">Selecting “New repository” will send us to a form where we fill in the repository details.</p>
<p dir="ltr"><img src="https://lh5.googleusercontent.com/e6wReyWSUafGHGDJ5VJHx9cw5-YiS8znPyFLvFd47qf0oK-A9Tz__p2GhaNKdZ6Tx3vkoAN8ducP8Fim9yH6CCOUxA-wBm11Cm8H2sqcyuU_SbLDegOirvVJClsfJo3zeA" alt=""/></p>
<p dir="ltr">We now have an empty repository after filling in the details and pressing the green “Create repository” button.</p>
<p dir="ltr"><img src="https://lh3.googleusercontent.com/erlkjYzJJZQ224zUXeDv8abIu7Eb3pZAyaAfsM4TGHTd_wu-JvsTB_mi4UIrM3tQsFACKhWB7GA_dNRIrW1BYABs0ul0mMPvN-RawalzhXPk6Qd0sVjGTcapcdNsQTRS7w" alt=""/></p>
<p dir="ltr">Let’s push the local repository to our remote repository.</p>
<p/>

		<div id="crayon-56d5b9b22747e029573189" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b22747e029573189-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">git </span><span class="crayon-v">push</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">u</span><span class="crayon-h"> </span><span class="crayon-e">origin </span><span class="crayon-v">master</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Now we’ll see the following code in the GitHub remote repository when we refresh the browser window.</p>
<p dir="ltr"><img src="https://lh6.googleusercontent.com/QApbK4FLQ5dgGtfno1WgKd754LJjhIMdyZTJt6KWfYjqtMS62RXWYmpEHe-y0QKl0kvv9rriyki1Xefthh8HhB7G51N1EaKktL7C-fTtGB8Mix212MB1XY1KN4eiTFshug" alt=""/></p>
<p dir="ltr">We now have the skeleton of a Python package we can now fill our code into. You can see the results at this step or start from here with the <a href="https://github.com/makaimc/plushcap/tree/tutorial-step-1">tutorial-step-1 tag</a>.</p>
<h3>Writing the monitoring code</h3>
<p dir="ltr">Let’s write some code to monitor if a website at an arbitrary URL is up or down. We’ll use the <a href="http://docs.python-requests.org/en/latest/">Requests</a> library to easily retrieve the HTTP status code and content from URLs we want to monitor. We can then wrap conditional logic around responses to complete a simple version of our Plushcap library.</p>
<p dir="ltr">Requests can be installed through pip.</p>
<p/>

		

<p/>
<p dir="ltr">We also need to make sure Requests is in our requirements.txt file. We can freeze our current requirements with the freeze command.</p>
<p/>

		<div id="crayon-56d5b9b2274a6716986911" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2274a6716986911-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-v">freeze</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">requirements</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Let’s take a look at what’s in there so far. This list is from Linux so if you’re running through these commands on Windows or Mac OS X you may have more or less packages listed. As long as Requests is in there you’re in good shape.</p>
<p/>

		<div id="crayon-56d5b9b2274b9560535255" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2274b9560535255-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">more </span><span class="crayon-v">requirements</span><span class="crayon-sy">.</span><span class="crayon-e">txt</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274b9560535255-2"><span class="crayon-v">argparse</span><span class="crayon-o">==</span><span class="crayon-cn">1.2.1</span></p><p class="crayon-line" id="crayon-56d5b9b2274b9560535255-3"><span class="crayon-v">requests</span><span class="crayon-o">==</span><span class="crayon-cn">2.3.0</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274b9560535255-4"><span class="crayon-v">wheel</span><span class="crayon-o">==</span><span class="crayon-cn">0.23.0</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Wheel was installed by the cookiecutter package. Requests relies on argparse so that’s included as a dependency as well.</p>
<p dir="ltr">Let’s add some code to our library so it’s not just a skeleton structure package. Open a file named plushcap.py under the plushcap/ directory and add the following code into it.</p>
<p/>

		<div id="crayon-56d5b9b2274cd200887471" class="crayon-syntax crayon-theme-solarized-dark crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-2">2</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-4">4</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-6">6</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-8">8</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-10">10</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-12">12</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-14">14</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-16">16</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-18">18</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-20">20</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b2274cd200887471-22">22</p><p class="crayon-num" data-line="crayon-56d5b9b2274cd200887471-23">23</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">sys</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">requests</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-4"><span class="crayon-v">CONNECTION_ERROR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">100</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-6"><span class="crayon-v">responses</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">CONNECTION_ERROR</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"is down or did not respond to the request."</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-7"><span class="crayon-h">             </span><span class="crayon-cn">200</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"is online and returning 200 OK."</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-8"><span class="crayon-h">             </span><span class="crayon-cn">403</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"is online but is denying the request due to lack of "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-9"><span class="crayon-h">                  </span><span class="crayon-s">"permission."</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-10"><span class="crayon-h">             </span><span class="crayon-cn">404</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"is online but the webpage at that URL was not found."</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-11"><span class="crayon-h">             </span><span class="crayon-cn">500</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"is online but returning an internal server error."</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-12"><span class="crayon-sy">}</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-13"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-14"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">contact_url</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-15"><span class="crayon-h">    </span><span class="crayon-s">"""</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-16"><span class="crayon-s">        Attempts to access the URL specified as a parameter. Returns the</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-17"><span class="crayon-s">        status code and the content for the request once it is complete.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-18"><span class="crayon-s">    """</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-19"><span class="crayon-h">    </span><span class="crayon-st">try</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-20"><span class="crayon-h">        </span><span class="crayon-v">response</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">requests</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-21"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">content</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274cd200887471-22"><span class="crayon-e">    </span><span class="crayon-st">except</span><span class="crayon-h"> </span><span class="crayon-v">requests</span><span class="crayon-sy">.</span><span class="crayon-k ">exceptions</span><span class="crayon-sy">.</span><span class="crayon-v">ConnectionError</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b2274cd200887471-23"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">CONNECTION_ERROR</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">""</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">The contact_url function works but let’s leave it deliberately simple for this first iteration. We’ll add additional handling and functionality as we go along.</p>
<p> </p>
<p dir="ltr">Let’s also add a main function so we can execute Plushcap from the command line.</p>
<p> </p>

		<div id="crayon-56d5b9b2274e1619304383" class="crayon-syntax crayon-theme-solarized-dark crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2274e1619304383-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-o">==</span><span class="crayon-s">'__main__'</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274e1619304383-2"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b2274e1619304383-3"><span class="crayon-h">        </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"usage: python plushcap.py http://test.url/"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274e1619304383-4"><span class="crayon-h">    </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b2274e1619304383-5"><span class="crayon-h">        </span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">content</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">contact_url</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-o">=</span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274e1619304383-6"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">responses</span><span class="crayon-sy">.</span><span class="crayon-e">has_key</span><span class="crayon-sy">(</span><span class="crayon-v">status_code</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b2274e1619304383-7"><span class="crayon-h">            </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">"The server at %s "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">responses</span><span class="crayon-sy">[</span><span class="crayon-v">status_code</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2274e1619304383-8"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b2274e1619304383-9"><span class="crayon-h">            </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Server response was unknown, status code: "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">status_code</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">We can now run the code from within the plushcap project subdirectory. The code will reach out to the URL specified as an argument and find out the HTTP status code. Based on the status code a message will be displayed whether the website is up, down or erroring out.</p>
<p dir="ltr">For example, try out the following command.</p>
<p/>

		<div id="crayon-56d5b9b2274f6246006342" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2274f6246006342-1"><span class="crayon-e">python </span><span class="crayon-v">plushcap</span><span class="crayon-sy">.</span><span class="crayon-e">py </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//www.fullstackpython.com/</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">If the server for <a href="http://www.fullstackpython.com/">http://www.fullstackpython.com/</a> is up then you’ll see the following success message.</p>
<p/>

		<div id="crayon-56d5b9b227508554066079" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b227508554066079-1"><span class="crayon-e">The </span><span class="crayon-e">server </span><span class="crayon-e">at </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//www.fullstackpython.com/ is online and returning 200 OK.</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">In case <a href="http://www.fullstackpython.com/">http://www.fullstackpython.com/</a> is down, you’ll instead see a message like this one.</p>
<p/>

		<div id="crayon-56d5b9b22751b754724437" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b22751b754724437-1"><span class="crayon-e">The </span><span class="crayon-e">server </span><span class="crayon-e">at </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//www.fullstackpython.com/ is down or did not respond to the request.</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p> </p>
<p dir="ltr">You can view the code we’ve written so far in the <a href="https://github.com/makaimc/plushcap/tree/tutorial-step-2">tutorial-step-2 tag</a> on GitHub.</p>
<h3>Testing functionality</h3>
<p dir="ltr">Next we’ll add a few tests to ensure a basic scenarios work in this package. The tests will be run before every check in to ensure the main URL retrieval didn’t break with our changes. We’ll add more extensive tests and check our code coverage in a later step.</p>
<p dir="ltr">For now, we have two tests. The first test retrieves a known working URL for <a href="http://www.fullstackpython.com/">Full Stack Python</a>. The second test attempts to contact a localhost server at a port which is unavailable. Add these to the tests/test_plushcap.py file.</p>
<p> </p>

		<div id="crayon-56d5b9b22752f710231173" class="crayon-syntax crayon-theme-solarized-dark crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-2">2</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-4">4</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-6">6</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-8">8</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-10">10</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-12">12</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-14">14</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-16">16</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-18">18</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-20">20</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-22">22</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-24">24</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-26">26</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-28">28</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b22752f710231173-30">30</p><p class="crayon-num" data-line="crayon-56d5b9b22752f710231173-31">31</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b22752f710231173-1"><span class="crayon-h">    </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">sys</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-2"><span class="crayon-h">    </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-4"><span class="crayon-h">    </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">unittest</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-6"><span class="crayon-h">    </span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">'.'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plushcap'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-7"><span class="crayon-h">    </span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">'..'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plushcap'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-8"><span class="crayon-h">    </span><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">plushcap </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">plushcap</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-10"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">TestPlushcap</span><span class="crayon-sy">(</span><span class="crayon-k ">unittest</span><span class="crayon-sy">.</span><span class="crayon-v">TestCase</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-11"><span class="crayon-h">    </span><span class="crayon-s">"""</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-12"><span class="crayon-s">        Tests that URLs can be retrieved when they exist. URLs that do not</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-13"><span class="crayon-s">        exist or are down return the proper status codes.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-14"><span class="crayon-s">    """</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-15"><span class="crayon-h">    </span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">setUp</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-16"><span class="crayon-h">        </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">working_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"http://www.fullstackpython.com/"</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-17"><span class="crayon-h">        </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">non_existent_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"http://localhost:8889/"</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-18"> </p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-19"><span class="crayon-h">    </span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">tearDown</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-20"><span class="crayon-h">        </span><span class="crayon-r">pass</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-21"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-22"><span class="crayon-h">    </span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">test_working_url</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-23"><span class="crayon-h">        </span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">content</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plushcap</span><span class="crayon-sy">.</span><span class="crayon-e">contact_url</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">working_url</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-24"><span class="crayon-h">        </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">assertEquals</span><span class="crayon-sy">(</span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-25"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-26"><span class="crayon-h">    </span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">test_non_existent_url</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-27"><span class="crayon-h">        </span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">content</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plushcap</span><span class="crayon-sy">.</span><span class="crayon-e">contact_url</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">non_existent_url</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-28"><span class="crayon-h">        </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">assertEquals</span><span class="crayon-sy">(</span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">plushcap</span><span class="crayon-sy">.</span><span class="crayon-v">CONNECTION_ERROR</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-29"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22752f710231173-30"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'__main__'</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b22752f710231173-31"><span class="crayon-h">    </span><span class="crayon-k ">unittest</span><span class="crayon-sy">.</span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">The <a href="https://github.com/makaimc/plushcap/tree/tutorial-step-2">tutorial-step-2 tag</a> contains all the code to this point in the blog post.</p>
<h3>Adding notifications</h3>
<p dir="ltr">At this point we have a concise Python package that reaches out to a URL and prints a message based on the HTTP status code received. However, we’d like to monitor the URL on a regular interval and know if something happens to the website at the monitored URL. This step is where we can flesh out the code and integrate Twilio’s API to send SMS alerts when the website does not respond or returns an HTTP error status code.</p>
<p dir="ltr">Let’s add a new function to plushcap/plushcap.py that checks a URL at a regular frequency then sends an alert if the status code returned is not 200.</p>
<p/>

		<div id="crayon-56d5b9b227544106381858" class="crayon-syntax crayon-theme-solarized-dark crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b227544106381858-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">check_url</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_client</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_from_number</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alert_number</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227544106381858-2"><span class="crayon-h">    </span><span class="crayon-v">frequency</span><span class="crayon-o">=</span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b227544106381858-3"><span class="crayon-h">    </span><span class="crayon-s">"""</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227544106381858-4"><span class="crayon-s">        Loops in a separate thread checking a given URL. Sends a </span></p><p class="crayon-line" id="crayon-56d5b9b227544106381858-5"><span class="crayon-s">        notification if the website goes down, 500 errors or gives a 404.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227544106381858-6"><span class="crayon-s">    """</span></p><p class="crayon-line" id="crayon-56d5b9b227544106381858-7"><span class="crayon-h">    </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227544106381858-8"><span class="crayon-h">        </span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">content</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">contact_url</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b227544106381858-9"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">status_code</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227544106381858-10"><span class="crayon-h">            </span><span class="crayon-c"># alert time</span></p><p class="crayon-line" id="crayon-56d5b9b227544106381858-11"><span class="crayon-h">            </span><span class="crayon-e">send_alert</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_client</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_from_number</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227544106381858-12"><span class="crayon-h">                </span><span class="crayon-v">alert_number</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b227544106381858-13"><span class="crayon-h">    </span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-v">frequency</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Now let’s create another function that sets up the Twilio client and is the entry point when you set the Twilio environment variables for the Account SID, auth token, from number and alert number.</p>
<p dir="ltr">At the top of plushcap/plushcap.py add the following import.</p>
<p/>

		<div id="crayon-56d5b9b227559297804417" class="crayon-syntax crayon-theme-solarized-dark crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b227559297804417-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-e">rest </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">TwilioRestClient</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">Then add the following function to plushcap/plushcap.py.</p>
<p/>

		<div id="crayon-56d5b9b227575477913242" class="crayon-syntax crayon-theme-solarized-dark crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-2">2</p><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-4">4</p><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-6">6</p><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-8">8</p><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-10">10</p><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-12">12</p><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-14">14</p><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-16">16</p><p class="crayon-num" data-line="crayon-56d5b9b227575477913242-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5b9b227575477913242-18">18</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b227575477913242-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">monitor</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frequency</span><span class="crayon-o">=</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_account_sid</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_auth_token</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-2"><span class="crayon-h">            </span><span class="crayon-v">twilio_from_number</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alert_number</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b227575477913242-3"><span class="crayon-h">    </span><span class="crayon-s">"""</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-4"><span class="crayon-s">        Monitors the given URL. Default frequency is once a minute. Twilio </span></p><p class="crayon-line" id="crayon-56d5b9b227575477913242-5"><span class="crayon-s">        account SID and auth token are required for notifications and will be </span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-6"><span class="crayon-s">        pulled from the environment variables TWILIO_ACCOUNT_SID and </span></p><p class="crayon-line" id="crayon-56d5b9b227575477913242-7"><span class="crayon-s">        TWILIO_AUTH_TOKEN if not specified.</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-8"><span class="crayon-s">    """</span></p><p class="crayon-line" id="crayon-56d5b9b227575477913242-9"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">twilio_account_sid </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">twilio_auth_token</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-10"><span class="crayon-h">        </span><span class="crayon-c"># initialize with environment vars instead of function parameters</span></p><p class="crayon-line" id="crayon-56d5b9b227575477913242-11"><span class="crayon-h">        </span><span class="crayon-v">twilio_client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TwilioRestClient</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-12"><span class="crayon-h">    </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b227575477913242-13"><span class="crayon-h">        </span><span class="crayon-v">twilio_client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TwilioRestClient</span><span class="crayon-sy">(</span><span class="crayon-v">twilio_account_sid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_auth_token</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-14"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">twilio_from_number</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b227575477913242-15"><span class="crayon-h">        </span><span class="crayon-v">twilio_from_number</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_env_setting</span><span class="crayon-sy">(</span><span class="crayon-s">'TWILIO_FROM_NUMBER'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-16"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">alert_number</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b227575477913242-17"><span class="crayon-h">        </span><span class="crayon-v">alert_number</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_env_setting</span><span class="crayon-sy">(</span><span class="crayon-s">'ALERT_NUMBER'</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b227575477913242-18"><span class="crayon-h">    </span><span class="crayon-e">check_url</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_client</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twilio_from_number</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alert_number</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frequency</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">These values that need to be set for these environment variables are found on the <a href="https://www.twilio.com/user/account">dashboard of your account</a> when you log in or in your account settings page. If you already have a Twilio account you can skip the following sign up steps. If not let’s quickly walk through the registration process.</p>
<p dir="ltr">First, sign up for a <a href="http://www.twilio.com/try-twilio">free Twilio account here</a>.</p>
<p dir="ltr"><img src="https://lh4.googleusercontent.com/z4bpSO608ocqT3c5iqkvBeKw7WYc1EDM7xKIFHSsYeKG3APVF0P1Sg9xl9F4eSDyMor8YsTOOQsO1C2JRBpXjN0HFsguAZJxkLdPFIwJJ9moFHmRCgkRfLrGnlWUHZU2_g" alt=""/></p>
<p dir="ltr">After signing up Twilio needs to quickly verify not a malicious spam bot by either sending you a text message or giving you a voice call.</p>
<p dir="ltr"><img src="https://lh4.googleusercontent.com/TRz6XnblfWEMqg2nKbfy-xuU3hwjHZx05VhmadEwyAlgj8iVaPLNn9tRe7uIQMaVmedkZ_-MA19d4AfrCv0cB5pjIbdq0SG8WGpNi9vWVHpIBH3d8_yBXppptejJIQHpDA" alt=""/></p>
<p dir="ltr">If you choose the text message verification you’ll receive a message like this one with a code to enter into the sign up form.</p>
<p dir="ltr"><img src="https://lh6.googleusercontent.com/csBVpagp9Q3poSNqSzskodwg04joY-S3J4PKtAiu3fU-nkYNQOz072ovGLFtD84bo-RdOqV-jqC_EECYPw4Ewm1BaYUyCKQjTNeP8MsyCTiI4ZVGAeRvVaETvqOox9fkcA" alt=""/></p>
<p dir="ltr">Twilio will assign a random phone number once the sign up process is complete. You can also search for another number through the Twilio web interface or purchase one <a href="https://www.twilio.com/docs/api/rest/available-phone-numbers">programmatically through the API</a>.</p>
<p dir="ltr"><img src="https://lh3.googleusercontent.com/fLEGicEitj4X1tSxteQapVV9GiS8VxNY-F1OyHo0NL5hd2duAsMz8LdFaSWc_CgUC84vZLXyX503moyy9dFswh7dDMo9u5I9MtHA8Pp9GP3i64EoMd7KnQXvCsZhG61iFA" alt=""/></p>
<p dir="ltr">Answers to further phone number questions can be found on the <a href="https://www.twilio.com/help/faq/phone-numbers">phone number FAQ page</a>.</p>
<p dir="ltr">Now we just need to grab the credentials from the account dashboard and export them as environment variables on the system that will run Plushcap.</p>
<p dir="ltr">Let’s modify the main function a bit to take these environment variables into account.</p>
<p/>

		<div id="crayon-56d5b9b22758b056459198" class="crayon-syntax crayon-theme-solarized-dark crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b22758b056459198-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-o">==</span><span class="crayon-s">'__main__'</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22758b056459198-2"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5b9b22758b056459198-3"><span class="crayon-h">        </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"usage: python plushcap.py http://test.url/"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22758b056459198-4"><span class="crayon-h">        </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"also ensure that TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN, "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></p><p class="crayon-line" id="crayon-56d5b9b22758b056459198-5"><span class="crayon-h">              </span><span class="crayon-s">"TWILIO_FROM_NUMBER\nand ALERT_NUMBER are set as "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22758b056459198-6"><span class="crayon-h">              </span><span class="crayon-s">"environment variables"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b22758b056459198-7"><span class="crayon-h">    </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22758b056459198-8"><span class="crayon-h">        </span><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5b9b22758b056459198-9"><span class="crayon-h">        </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"Monitoring %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">url</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22758b056459198-10"><span class="crayon-e">        </span><span class="crayon-v">status_code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">content</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">monitor</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b22758b056459198-11"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">responses</span><span class="crayon-sy">.</span><span class="crayon-e">has_key</span><span class="crayon-sy">(</span><span class="crayon-v">status_code</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22758b056459198-12"><span class="crayon-h">            </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">"The server at %s "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">responses</span><span class="crayon-sy">[</span><span class="crayon-v">status_code</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">url</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5b9b22758b056459198-13"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b22758b056459198-14"><span class="crayon-h">            </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Alert: status code received from %s is %i instead of "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></p><p class="crayon-line" id="crayon-56d5b9b22758b056459198-15"><span class="crayon-h">                  </span><span class="crayon-s">"200 OK."</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">status_code</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">The <a href="https://github.com/makaimc/plushcap/tree/tutorial-step-3">tutorial-step-3 tag</a> contains all the code we’ve written so far in this blog post.</p>
<h3>Packaging and Uploading to PyPI</h3>
<p dir="ltr">Now that we have the initial functionality for the package along with tests and documentation we can upload the library to PyPI. We need a MANIFEST.in file that tells setup.py what to include when we build a distributable package. Here’s our MANIFEST.in for Plushcap that sits in the base directory of the package:</p>
<p/>

		<div id="crayon-56d5b9b2275a1315006360" class="crayon-syntax crayon-theme-solarized-dark crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2275a1315006360-1"><span class="crayon-e">include </span><span class="crayon-v">AUTHORS</span><span class="crayon-sy">.</span><span class="crayon-e">rst</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2275a1315006360-2"><span class="crayon-e">include </span><span class="crayon-v">CONTRIBUTING</span><span class="crayon-sy">.</span><span class="crayon-e">rst</span></p><p class="crayon-line" id="crayon-56d5b9b2275a1315006360-3"><span class="crayon-e">include </span><span class="crayon-v">HISTORY</span><span class="crayon-sy">.</span><span class="crayon-e">rst</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2275a1315006360-4"><span class="crayon-e">include </span><span class="crayon-r">LICENSE</span></p><p class="crayon-line" id="crayon-56d5b9b2275a1315006360-5"><span class="crayon-e">include </span><span class="crayon-v">README</span><span class="crayon-sy">.</span><span class="crayon-e">rst</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2275a1315006360-6"><span class="crayon-e">include </span><span class="crayon-v">setup</span><span class="crayon-sy">.</span><span class="crayon-e">py</span></p><p class="crayon-line" id="crayon-56d5b9b2275a1315006360-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2275a1315006360-8"><span class="crayon-v">recursive</span><span class="crayon-o">-</span><span class="crayon-e">include </span><span class="crayon-v">tests</span><span class="crayon-h"> </span><span class="crayon-o">*</span></p><p class="crayon-line" id="crayon-56d5b9b2275a1315006360-9"><span class="crayon-v">recursive</span><span class="crayon-o">-</span><span class="crayon-v">exclude</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">__pycache__</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2275a1315006360-10"><span class="crayon-v">recursive</span><span class="crayon-o">-</span><span class="crayon-v">exclude</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-sy">[</span><span class="crayon-v">co</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5b9b2275a1315006360-11"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5b9b2275a1315006360-12"><span class="crayon-v">recursive</span><span class="crayon-o">-</span><span class="crayon-e">include </span><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-e">rst </span><span class="crayon-v">conf</span><span class="crayon-sy">.</span><span class="crayon-e">py </span><span class="crayon-e">Makefile </span><span class="crayon-v">make</span><span class="crayon-sy">.</span><span class="crayon-v">bat</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">We’re including reStructedText (.rst) files, tests, our .py source files (but not the .pyc files) and the docs.</p>
<p dir="ltr">With this in place we can package up our Plushcap project and upload it to the central PyPI hosted packages repository. These commands should be run in the setup.py directory which is the base directory of our project. Note that your package cannot be named the same as an existing package in PyPI. Use PyPI’s search feature to find out what package names are available for new libraries. Once you’ve found an available name edit the package_name value in your project’s setup.py file. Then upload the new package with the following command.</p>
<p/>

		<div id="crayon-56d5b9b2275b6828667096" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5b9b2275b6828667096-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">setup</span><span class="crayon-sy">.</span><span class="crayon-e">py </span><span class="crayon-e">sdist </span><span class="crayon-v">upload</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<p dir="ltr">If everything goes well with the upload we’ll see output with a Server response (200): OK like the following screenshot (installation output capped for brevity).</p>
<p dir="ltr"><img src="https://lh4.googleusercontent.com/1dDHmM88V26ZrryISi0TvccL9CLHZEu5Us4DRCFWKfxwUpPlZr-Kf_A76ANPCSpURdojLw5rfDF5ghC8S8V6toRy_XBcb0lNav41jfJ0xCIxfS_NRfhoiF3895QpSetsRQ" alt=""/></p>
<p dir="ltr">Now Plushcap is on PyPI and can be installed by anyone with an Internet connection and pip installed by running the following command…</p>
<p/>

		

<p/>
<p dir="ltr"><img src="https://lh5.googleusercontent.com/p0sctzVrOCuPKc9Z-I2e8bjfr7V8e0_Pq9B_6091HOIc3Z0kZbOJQlQq2F1OcCf6TFLkuk4OOFtKM6CUU-CRaVizpOMHe4GJR0I-yl5zz5Y-TyKO9tA195SWOkMlSW8ceA" alt=""/></p>
<p dir="ltr">…and it’s installed!</p>
<h3>Next up: Building a web application with Plushcap</h3>
<p dir="ltr">The initial Plushcap library version is ready to go. But what if you want to use the code through a web application instead of directly through the Python interpreter? In the next post of this series we’ll take a look at using the a Python web application framework to build an application around the Plushcap library.</p>
<p> </p>
			</div>
					</div></body></html>