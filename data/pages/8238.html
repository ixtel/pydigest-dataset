<html><body><div><div class="post-text" itemprop="text">

<p>I am wondering how the <a href="http://docs.nvidia.com/cuda/cublas/#cublas-lt-t-gt-gemm" rel="nofollow">GEMM</a> Transpose works. I have a matrix which I want to multiply and I want to multiple the sample matrix transposed. Such as A.T * A</p>

<p>I have something like this,</p>

<pre><code>def bptrs(a):
  return gpuarray.arange(a.ptr,a.ptr+a.shape[0]*a.strides[0],a.strides[0],dtype=ctypes.c_void_p)

handle=cublasCreate()
A=np.ones((s,3)).astype(np.float64)
B=A.T # transposed

m,k=A.shape
k,n=B.shape

a_gpu = gpuarray.to_gpu(A)
b_gpu = gpuarray.to_gpu(B) # I am guessing I need to do a copy since A.T is a view
c_gpu = gpuarray.empty((m,n), np.float64) #Not 100% sure if this is right. I want to get a view returned, so I can save on memory

alpha = np.float64(1.0)
beta = np.float64(0.0)

cublasDgemmBatched(handle, 't','n',
n, m, k, alpha,
b_arr.gpudata, m,
a_arr.gpudata, k,
beta, c_arr.gpudata, m, 1)
</code></pre>

<p>I am using Cublas 7 </p>
    </div>
    </div></body></html>