<html><body><div><div class="post" id="post-1899">
				
				
				<div class="entry">
					<p>I had a bunch of Python files that I needed to convert in bulk to IPython Notebook files. I searched on <a href="https://www.google.com/search?q=converting+.py+to+.ipynb">converting .py to .ipynb</a>, but was only able to find <a href="http://stackoverflow.com/questions/23292242/converting-to-not-from-ipython-notebook-format">this Stack question</a>, which provides an answer, which appears to be outdated. After digging through the <a href="https://ipython.org/ipython-doc/3/api/generated/IPython.nbformat.html">nbformat module documentation</a> for a solution to no avail, I wrote a little script for doing this.<span id="more-1899"/></p>
<p>IPython Notebook files are simple JSON files with a <code>cells</code> array containing one or more unnamed cell nodes.<br/>
<a href="https://www.webucator.com/blog/wp-content/uploads/2015/07/ipython-div-by-zero.png"><img src="https://www.webucator.com/blog/wp-content/uploads/2015/07/ipython-div-by-zero.png" alt="ipython-div-by-zero" class="alignnone size-full wp-image-1903"/></a></p>
<p>For example, here’s the code for the simple IPython notebook shown in the image above. Note the <code>cells</code> array and, in particular, the <code>source</code> key.</p>

<div class="wp_syntax"><table><tr><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="code"><pre class="json">{
    "cells": [
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {
                "collapsed": false
            },
            "outputs": [],
<span>            "source": [
</span><span>                "try:\n",
</span><span>                "    1/0\n",
</span><span>                "except:\n",
</span><span>                "    print('You cannot divide by zero!')"
</span><span>            ]
</span>        }
    ],
    "metadata": {
        "kernelspec": {
            "display_name": "Python 3",
            "language": "python",
            "name": "python3"
        },
        "language_info": {
            "codemirror_mode": {
                "name": "ipython",
                "version": 3
            },
            "file_extension": ".py",
            "mimetype": "text/x-python",
            "name": "python",
            "nbconvert_exporter": "python",
            "pygments_lexer": "ipython3",
            "version": "3.4.3"
        }
    },
    "nbformat": 4,
    "nbformat_minor": 0
}</pre></td></tr></table></div>

<p>The only piece we need to change to convert Python files to IPython Notebook files is the highlighted <code>source</code> value, which contains the Python code that goes in the cell. Everything else we can copy verbatim.</p>
<p>My <span>py-to-ipynb.py</span> script looks like this:</p>

<div class="wp_syntax"><table><tr><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="code"><pre class="python"><span>import</span> <span>os</span>
<span>from</span> json.<span>encoder</span> <span>import</span> JSONEncoder
 
nb_start <span>=</span> <span>'''{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": ['''</span>
 
nb_end <span>=</span><span>''']
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.4.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}'''</span>
 
<span>def</span> main<span>(</span><span>)</span>:
    <span>for</span> dirpath<span>,</span> dirnames<span>,</span> filenames <span>in</span> <span>os</span>.<span>walk</span><span>(</span><span>'.'</span><span>)</span>:
        <span>for</span> fname <span>in</span> filenames:
            path <span>=</span> dirpath+<span>'/'</span>+fname
            <span>if</span> fname<span>[</span>-<span>3</span>:<span>]</span> <span>==</span> <span>'.py'</span> <span>and</span> <span>not</span> <span>os</span>.<span>path</span>.<span>samefile</span><span>(</span>path<span>,</span><span>'.<span>\\</span>py-to-ipynb.py'</span><span>)</span>:
                path <span>=</span> dirpath+<span>'/'</span>+fname
                nb_path <span>=</span> path<span>[</span>:-<span>3</span><span>]</span> + <span>'.ipynb'</span>
                <span>with</span> <span>open</span><span>(</span>path<span>,</span><span>'r'</span><span>)</span> <span>as</span> f_in:
                    f_in_content <span>=</span> JSONEncoder<span>(</span><span>)</span>.<span>encode</span><span>(</span>f_in.<span>read</span><span>(</span><span>)</span><span>)</span>
                    nb_content <span>=</span> nb_start + f_in_content + nb_end
 
                    <span>with</span> <span>open</span><span>(</span>nb_path<span>,</span><span>'w'</span><span>)</span> <span>as</span> f_out:
                        f_out.<span>write</span><span>(</span>nb_content<span>)</span>
 
                <span>print</span><span>(</span><span>"Created"</span><span>,</span>nb_path<span>)</span>
 
main<span>(</span><span>)</span></pre></td></tr></table></div>

<p>Here’s what it does:</p>
<ol>
<li>Walks through all the files within the current directory and its subdirectories.</li>
<li>Reads in the contents of every file (except itself) ending with <span>.py</span>, encodes it as JSON, and stores it as <code>f_in_content</code>.</li>
<li>Creates a <code>nb_content</code> variable by concatenating…
<ol>
<li><code>nb_start</code> – the JSON text that goes before the <code>source</code> value in the IPython Notebook JSON.</li>
<li><code>f_in_content</code></li>
<li><code>nb_end</code> – the JSON text that goes after the <code>source</code> value in the IPython Notebook JSON.</li>
</ol></li>
<li>Writes <code>nb_content</code> to a new file with the same name, but with a <span>.ipynb</span> extension.</li>
</ol>
<p>I know it’s a hack, but I couldn’t find a built-in way of doing this. I’ve only done some minimal testing, so use at your own risk. <img src="https://www.webucator.com/blog/wp-includes/images/smilies/icon_smile.gif" alt=":-)" class="wp-smiley"/></p>
<hr/><p>
Related Training: </p><a href="https://www.webucator.com/programming/python.cfm">Python</a>

<p class="fb-social-plugin fb-like" data-ref="below-post" data-href="https://www.webucator.com/blog/2015/07/bulk-convert-python-files-to-ipython-notebook-files-py-to-ipynb-conversion/" data-share="true" data-width="450"/>
				</div>
			</div>
			</div></body></html>