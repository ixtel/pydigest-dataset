<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-orator" class="anchor" href="#orator" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Orator</h1>
<a href="https://travis-ci.org/sdispater/orator"><img alt="Orator Build status" src="https://camo.githubusercontent.com/05cb3db5a8274262917d4cd0c5ae50ab63de6ac3/68747470733a2f2f7472617669732d63692e6f72672f7364697370617465722f6f7261746f722e706e67" data-canonical-src="https://travis-ci.org/sdispater/orator.png"/></a>
<p>The Orator ORM provides a simple yet beautiful ActiveRecord implementation.</p>
<p>It is inspired by the database part of the <a href="http://laravel.com">Laravel framework</a>,
but largely modified to be more pythonic.</p>
<p>The full documentation is available here: <a href="http://orator-orm.com/docs">http://orator-orm.com/docs</a></p>
<a name="user-content-installation"/>
<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>
<p>You can install Orator in 2 different ways:</p>
<ul>
<li>The easier and more straightforward is to use pip</li>
</ul>


<p>The different dbapi packages are not part of the package dependencies,
so you must install them in order to connect to corresponding databases:</p>
<ul>
<li>Postgres: <code>psycopg2</code></li>
<li>MySQL: <code>PyMySQL</code> or <code>mysqlclient</code></li>
<li>Sqlite: The <code>sqlite3</code> module is bundled with Python by default</li>
</ul>
<a name="user-content-basic-usage"/>
<h2><a id="user-content-basic-usage" class="anchor" href="#basic-usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Basic Usage</h2>
<a name="user-content-configuration"/>
<h3><a id="user-content-configuration" class="anchor" href="#configuration" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Configuration</h3>
<p>All you need to get you started is the configuration describing your database connections
and passing it to a <code>DatabaseManager</code> instance.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> orator <span class="pl-k">import</span> DatabaseManager, Model

config <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>mysql<span class="pl-pds">'</span></span>: {
        <span class="pl-s"><span class="pl-pds">'</span>driver<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>mysql<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>host<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>localhost<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>database<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>database<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>username<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>root<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>password<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>prefix<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
    }
}

db <span class="pl-k">=</span> DatabaseManager(config)
Model.set_connection_resolver(db)</pre></div>
<a name="user-content-defining-a-model"/>
<h3><a id="user-content-defining-a-model" class="anchor" href="#defining-a-model" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Defining a model</h3>

<p>Note that we did not tell the ORM which table to use for the <code>User</code> model. The plural "snake case" name of the
class name will be used as the table name unless another name is explicitly specified.
In this case, the ORM will assume the <code>User</code> model stores records in the <code>users</code> table.
You can specify a custom table by defining a <code>__table__</code> property on your model:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">class</span> <span class="pl-en">User</span>(<span class="pl-e">Model</span>):

    __table__ <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>my_users<span class="pl-pds">'</span></span></pre></div>
<p>The ORM will also assume that each table has a primary key column named <code>id</code>.
You can define a <code>__primary_key__</code> property to override this convention.
Likewise, you can define a <code>__connection__</code> property to override the name of the database
connection that should be used when using the model.</p>
<p>Once a model is defined, you are ready to start retrieving and creating records in your table.
Note that you will need to place <code>updated_at</code> and <code>created_at</code> columns on your table by default.
If you do not wish to have these columns automatically maintained,
set the <code>__timestamps__</code> property on your model to <code>False</code>.</p>
<a name="user-content-retrieving-all-models"/>
<h3><a id="user-content-retrieving-all-models" class="anchor" href="#retrieving-all-models" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Retrieving all models</h3>

<a name="user-content-retrieving-a-record-by-primary-key"/>
<h3><a id="user-content-retrieving-a-record-by-primary-key" class="anchor" href="#retrieving-a-record-by-primary-key" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Retrieving a record by primary key</h3>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> User.find(<span class="pl-c1">1</span>)

<span class="pl-c1">print</span>(user.name)</pre></div>
<a name="user-content-querying-using-models"/>
<h3><a id="user-content-querying-using-models" class="anchor" href="#querying-using-models" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Querying using models</h3>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> User.where(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-c1">100</span>).take(<span class="pl-c1">10</span>).get()

<span class="pl-k">for</span> user <span class="pl-k">in</span> users:
    <span class="pl-c1">print</span>(user.name)</pre></div>
<a name="user-content-aggregates"/>
<h3><a id="user-content-aggregates" class="anchor" href="#aggregates" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Aggregates</h3>
<p>You can also use the query builder aggregate functions:</p>
<div class="highlight highlight-source-python"><pre>count <span class="pl-k">=</span> User.where(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-c1">100</span>).count()</pre></div>
<p>If you feel limited by the builder's fluent interface, you can use the <code>where_raw</code> method:</p>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> User.where_raw(<span class="pl-s"><span class="pl-pds">'</span>age &gt; ? and votes = 100<span class="pl-pds">'</span></span>, [<span class="pl-c1">25</span>]).get()</pre></div>
<a name="user-content-chunking-results"/>
<h3><a id="user-content-chunking-results" class="anchor" href="#chunking-results" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Chunking Results</h3>
<p>If you need to process a lot of records, you can use the <code>chunk</code> method to avoid
consuming a lot of RAM:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">for</span> users <span class="pl-k">in</span> User.chunk(<span class="pl-c1">100</span>):
    <span class="pl-k">for</span> user <span class="pl-k">in</span> users:
        <span class="pl-c"># ...</span></pre></div>
<a name="user-content-specifying-the-query-connection"/>
<h3><a id="user-content-specifying-the-query-connection" class="anchor" href="#specifying-the-query-connection" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Specifying the query connection</h3>
<p>You can specify which database connection to use when querying a model by using the <code>on</code> method:</p>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> User.on(<span class="pl-s"><span class="pl-pds">'</span>connection-name<span class="pl-pds">'</span></span>).find(<span class="pl-c1">1</span>)</pre></div>
<p>If you are using read / write connections, you can force the query to use the "write" connection
with the following method:</p>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> User.on_write_connection().find(<span class="pl-c1">1</span>)</pre></div>
<a name="user-content-mass-assignment"/>
<h2><a id="user-content-mass-assignment" class="anchor" href="#mass-assignment" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Mass assignment</h2>
<p>When creating a new model, you pass attributes to the model constructor.
These attributes are then assigned to the model via mass-assignment.
Though convenient, this can be a serious security concern when passing user input into a model,
since the user is then free to modify <strong>any</strong> and <strong>all</strong> of the model's attributes.
For this reason, all models protect against mass-assignment by default.</p>
<p>To get started, set the <code>__fillable__</code> or <code>__guarded__</code> properties on your model.</p>
<a name="user-content-defining-fillable-attributes-on-a-model"/>
<h3><a id="user-content-defining-fillable-attributes-on-a-model" class="anchor" href="#defining-fillable-attributes-on-a-model" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Defining fillable attributes on a model</h3>
<p>The <code>__fillable__</code> property specifies which attributes can be mass-assigned.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">class</span> <span class="pl-en">User</span>(<span class="pl-e">Model</span>):

    __fillable__ <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>first_name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>last_name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>]</pre></div>
<a name="user-content-defining-guarded-attributes-on-a-model"/>
<h3><a id="user-content-defining-guarded-attributes-on-a-model" class="anchor" href="#defining-guarded-attributes-on-a-model" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Defining guarded attributes on a model</h3>
<p>The <code>__guarded__</code> is the inverse and acts as "blacklist".</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">class</span> <span class="pl-en">User</span>(<span class="pl-e">Model</span>):

    __guarded__ <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>password<span class="pl-pds">'</span></span>]</pre></div>
<p>You can also block <strong>all</strong> attributes from mass-assignment:</p>

<a name="user-content-insert-update-and-delete"/>
<h2><a id="user-content-insert-update-and-delete" class="anchor" href="#insert-update-and-delete" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Insert, update and delete</h2>
<a name="user-content-saving-a-new-model"/>
<h3><a id="user-content-saving-a-new-model" class="anchor" href="#saving-a-new-model" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Saving a new model</h3>
<p>To create a new record in the database, simply create a new model instance and call the <code>save</code> method.</p>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> User()

user.name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>

user.save()</pre></div>
<p>You can also use the <code>create</code> method to save a model in a single line, but you will need to specify
either the <code>__fillable__</code> or <code>__guarded__</code> property on the model since all models are protected against
mass-assigment by default.</p>
<p>After saving or creating a new model with auto-incrementing IDs, you can retrieve the ID by accessing
the object's <code>id</code> attribute:</p>

<a name="user-content-using-the-create-method"/>
<h3><a id="user-content-using-the-create-method" class="anchor" href="#using-the-create-method" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using the create method</h3>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># Create a new user in the database</span>
user <span class="pl-k">=</span> User.create(<span class="pl-v">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>)

<span class="pl-c"># Retrieve the user by attributes, or create it if it does not exist</span>
user <span class="pl-k">=</span> User.first_or_create(<span class="pl-v">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>)

<span class="pl-c"># Retrieve the user by attributes, or instantiate it if it does not exist</span>
user <span class="pl-k">=</span> User.first_or_new(<span class="pl-v">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>)</pre></div>
<a name="user-content-updating-a-retrieved-model"/>
<h3><a id="user-content-updating-a-retrieved-model" class="anchor" href="#updating-a-retrieved-model" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Updating a retrieved model</h3>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> User.find(<span class="pl-c1">1</span>)

user.name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Foo<span class="pl-pds">'</span></span>

user.save()</pre></div>
<p>You can also run updates as queries against a set of models:</p>
<div class="highlight highlight-source-python"><pre>affected_rows <span class="pl-k">=</span> User.where(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-c1">100</span>).update(<span class="pl-v">status</span><span class="pl-k">=</span><span class="pl-c1">2</span>)</pre></div>
<a name="user-content-deleting-an-existing-model"/>
<h3><a id="user-content-deleting-an-existing-model" class="anchor" href="#deleting-an-existing-model" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Deleting an existing model</h3>
<p>To delete a model, simply call the <code>delete</code> model:</p>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> User.find(<span class="pl-c1">1</span>)

user.delete()</pre></div>
<a name="user-content-deleting-an-existing-model-by-key"/>
<h3><a id="user-content-deleting-an-existing-model-by-key" class="anchor" href="#deleting-an-existing-model-by-key" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Deleting an existing model by key</h3>
<div class="highlight highlight-source-python"><pre>User.destroy(<span class="pl-c1">1</span>)

User.destroy(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>)</pre></div>
<p>You can also run a delete query on a set of models:</p>
<div class="highlight highlight-source-python"><pre>affected_rows <span class="pl-k">=</span> User.where(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span> <span class="pl-c1">100</span>).delete()</pre></div>
<a name="user-content-updating-only-the-model-s-timestamps"/>
<h3><a id="user-content-updating-only-the-models-timestamps" class="anchor" href="#updating-only-the-models-timestamps" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Updating only the model's timestamps</h3>
<p>If you want to only update the timestamps on a model, you can use the <code>touch</code> method:</p>

<a name="user-content-timestamps"/>
<h2><a id="user-content-timestamps" class="anchor" href="#timestamps" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Timestamps</h2>
<p>By default, the ORM will maintain the <code>created_at</code> and <code>updated_at</code> columns on your database table
automatically. Simply add these <code>timestamp</code> columns to your table. If you do not wish for the ORM to maintain
these columns, just add the <code>__timestamps__</code> property:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">class</span> <span class="pl-en">User</span>(<span class="pl-e">Model</span>):

    __timestamps__ <span class="pl-k">=</span> <span class="pl-c1">False</span></pre></div>
<a name="user-content-providing-a-custom-timestamp-format"/>
<h3><a id="user-content-providing-a-custom-timestamp-format" class="anchor" href="#providing-a-custom-timestamp-format" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Providing a custom timestamp format</h3>
<p>If you whish to customize the format of your timestamps (the default is the ISO Format) that will be returned when using the <code>to_dict</code>
or the <code>to_json</code> methods, you can override the <code>get_date_format</code> method:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">class</span> <span class="pl-en">User</span>(<span class="pl-e">Model</span>):

    <span class="pl-k">def</span> <span class="pl-en">get_date_format</span>():
        <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">'</span>DD-MM-YY<span class="pl-pds">'</span></span></pre></div>
<a name="user-content-converting-to-dictionaries-json"/>
<h2><a id="user-content-converting-to-dictionaries--json" class="anchor" href="#converting-to-dictionaries--json" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Converting to dictionaries / JSON</h2>
<a name="user-content-converting-a-model-to-a-dictionary"/>
<h3><a id="user-content-converting-a-model-to-a-dictionary" class="anchor" href="#converting-a-model-to-a-dictionary" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Converting a model to a dictionary</h3>
<p>When building JSON APIs, you may often need to convert your models and relationships to dictionaries or JSON.
So, Orator includes methods for doing so. To convert a model and its loaded relationship to a dictionary,
you may use the <code>to_dict</code> method:</p>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> User.with_(<span class="pl-s"><span class="pl-pds">'</span>roles<span class="pl-pds">'</span></span>).first()

<span class="pl-k">return</span> user.to_dict()</pre></div>
<p>Note that entire collections of models can also be converted to dictionaries:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">return</span> User.all().to_dict()</pre></div>
<a name="user-content-converting-a-model-to-json"/>
<h3><a id="user-content-converting-a-model-to-json" class="anchor" href="#converting-a-model-to-json" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Converting a model to JSON</h3>
<p>To convert a model to JSON, you can use the <code>to_json</code> method!</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">return</span> User.find(<span class="pl-c1">1</span>).to_json()</pre></div>
<a name="user-content-query-builder"/>
<h2><a id="user-content-query-builder" class="anchor" href="#query-builder" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Query Builder</h2>
<a name="user-content-introduction"/>
<h3><a id="user-content-introduction" class="anchor" href="#introduction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Introduction</h3>
<p>The database query builder provides a fluent interface to create and run database queries.
It can be used to perform most database operations in your application, and works on all supported database systems.</p>
<a name="user-content-selects"/>
<h3><a id="user-content-selects" class="anchor" href="#selects" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Selects</h3>
<a name="user-content-retrieving-all-row-from-a-table"/>
<h4><a id="user-content-retrieving-all-row-from-a-table" class="anchor" href="#retrieving-all-row-from-a-table" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Retrieving all row from a table</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).get()

<span class="pl-k">for</span> user <span class="pl-k">in</span> users:
    <span class="pl-c1">print</span>(user[<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>])</pre></div>
<a name="user-content-chunking-results-from-a-table"/>
<h4><a id="user-content-chunking-results-from-a-table" class="anchor" href="#chunking-results-from-a-table" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Chunking results from a table</h4>
<div class="highlight highlight-source-python"><pre><span class="pl-k">for</span> users <span class="pl-k">in</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).chunk(<span class="pl-c1">100</span>):
    <span class="pl-k">for</span> user <span class="pl-k">in</span> users:
        <span class="pl-c"># ...</span></pre></div>
<a name="user-content-retrieving-a-single-row-from-a-table"/>
<h4><a id="user-content-retrieving-a-single-row-from-a-table" class="anchor" href="#retrieving-a-single-row-from-a-table" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Retrieving a single row from a table</h4>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>).first()
<span class="pl-c1">print</span>(user[<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>])</pre></div>
<a name="user-content-retrieving-a-single-column-from-a-row"/>
<h4><a id="user-content-retrieving-a-single-column-from-a-row" class="anchor" href="#retrieving-a-single-column-from-a-row" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Retrieving a single column from a row</h4>
<div class="highlight highlight-source-python"><pre>user <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>).pluck(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>)</pre></div>
<a name="user-content-retrieving-a-list-of-column-values"/>
<h4><a id="user-content-retrieving-a-list-of-column-values" class="anchor" href="#retrieving-a-list-of-column-values" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Retrieving a list of column values</h4>
<div class="highlight highlight-source-python"><pre>roles <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>roles<span class="pl-pds">'</span></span>).lists(<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>)</pre></div>
<p>This method will return a list of role titles. It can return a dictionary
if you pass an extra key parameter.</p>
<div class="highlight highlight-source-python"><pre>roles <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>roles<span class="pl-pds">'</span></span>).lists(<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>)</pre></div>
<a name="user-content-specifying-a-select-clause"/>
<h4><a id="user-content-specifying-a-select-clause" class="anchor" href="#specifying-a-select-clause" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Specifying a select clause</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).select(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>).get()

users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).distinct().get()

users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).select(<span class="pl-s"><span class="pl-pds">'</span>name as user_name<span class="pl-pds">'</span></span>).get()</pre></div>
<a name="user-content-adding-a-select-clause-to-an-existing-query"/>
<h4><a id="user-content-adding-a-select-clause-to-an-existing-query" class="anchor" href="#adding-a-select-clause-to-an-existing-query" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Adding a select clause to an existing query</h4>
<div class="highlight highlight-source-python"><pre>query <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).select(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>)

users <span class="pl-k">=</span> query.add_select(<span class="pl-s"><span class="pl-pds">'</span>age<span class="pl-pds">'</span></span>).get()</pre></div>
<a name="user-content-using-where-operators"/>
<h4><a id="user-content-using-where-operators" class="anchor" href="#using-where-operators" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using where operators</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where(<span class="pl-s"><span class="pl-pds">'</span>age<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-c1">25</span>).get()</pre></div>
<a name="user-content-or-statements"/>
<h4><a id="user-content-or-statements" class="anchor" href="#or-statements" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Or statements</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where(<span class="pl-s"><span class="pl-pds">'</span>age<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-c1">25</span>).or_where(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>).get()</pre></div>
<a name="user-content-using-where-between"/>
<h4><a id="user-content-using-where-between" class="anchor" href="#using-where-between" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using Where Between</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where_between(<span class="pl-s"><span class="pl-pds">'</span>age<span class="pl-pds">'</span></span>, [<span class="pl-c1">25</span>, <span class="pl-c1">35</span>]).get()</pre></div>
<a name="user-content-using-where-not-between"/>
<h4><a id="user-content-using-where-not-between" class="anchor" href="#using-where-not-between" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using Where Not Between</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where_not_between(<span class="pl-s"><span class="pl-pds">'</span>age<span class="pl-pds">'</span></span>, [<span class="pl-c1">25</span>, <span class="pl-c1">35</span>]).get()</pre></div>
<a name="user-content-using-where-in"/>
<h4><a id="user-content-using-where-in" class="anchor" href="#using-where-in" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using Where In</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where_in(<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>, [<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>]).get()

users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where_not_in(<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>, [<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>]).get()</pre></div>
<a name="user-content-using-where-null-to-find-records-with-null-values"/>
<h4><a id="user-content-using-where-null-to-find-records-with-null-values" class="anchor" href="#using-where-null-to-find-records-with-null-values" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Using Where Null to find records with null values</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where_null(<span class="pl-s"><span class="pl-pds">'</span>updated_at<span class="pl-pds">'</span></span>).get()</pre></div>
<a name="user-content-order-by-group-by-and-having"/>
<h4><a id="user-content-order-by-group-by-and-having" class="anchor" href="#order-by-group-by-and-having" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Order by, group by and having</h4>
<div class="highlight highlight-source-python"><pre>query <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).order_by(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>desc<span class="pl-pds">'</span></span>)
query <span class="pl-k">=</span> query.group_by(<span class="pl-s"><span class="pl-pds">'</span>count<span class="pl-pds">'</span></span>)
query <span class="pl-k">=</span> query.having(<span class="pl-s"><span class="pl-pds">'</span>count<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-c1">100</span>)

users <span class="pl-k">=</span> query.get()</pre></div>
<a name="user-content-offset-and-limit"/>
<h4><a id="user-content-offset-and-limit" class="anchor" href="#offset-and-limit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Offset and limit</h4>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).skip(<span class="pl-c1">10</span>).take(<span class="pl-c1">5</span>).get()

users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).offset(<span class="pl-c1">10</span>).limit(<span class="pl-c1">5</span>).get()</pre></div>
<a name="user-content-joins"/>
<h3><a id="user-content-joins" class="anchor" href="#joins" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Joins</h3>
<p>The query builder can also be used to write join statements.</p>
<a name="user-content-basic-join-statement"/>
<h4><a id="user-content-basic-join-statement" class="anchor" href="#basic-join-statement" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Basic join statement</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>) \
    .join(<span class="pl-s"><span class="pl-pds">'</span>contacts<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>users.id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>contacts.user_id<span class="pl-pds">'</span></span>) \
    .join(<span class="pl-s"><span class="pl-pds">'</span>orders<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>users.id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>orders.user_id<span class="pl-pds">'</span></span>) \
    .select(<span class="pl-s"><span class="pl-pds">'</span>users.id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>contacts.phone<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>orders.price<span class="pl-pds">'</span></span>) \
    .get()</pre></div>
<a name="user-content-left-join-statement"/>
<h4><a id="user-content-left-join-statement" class="anchor" href="#left-join-statement" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Left join statement</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).left_join(<span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>users.id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>posts.user_id<span class="pl-pds">'</span></span>).get()</pre></div>
<p>You can also specify more advance join clauses:</p>
<div class="highlight highlight-source-python"><pre>clause <span class="pl-k">=</span> JoinClause(<span class="pl-s"><span class="pl-pds">'</span>contacts<span class="pl-pds">'</span></span>).on(<span class="pl-s"><span class="pl-pds">'</span>users.id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>contacts.user_id<span class="pl-pds">'</span></span>).or_on(<span class="pl-c1">...</span>)

db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).join(clause).get()</pre></div>
<p>If you would like to use a "where" style clause on your joins,
you may use the <code>where</code> and <code>or_where</code> methods on a join.
Instead of comparing two columns, these methods will compare the column against a value:</p>
<div class="highlight highlight-source-python"><pre>clause <span class="pl-k">=</span> JoinClause(<span class="pl-s"><span class="pl-pds">'</span>contacts<span class="pl-pds">'</span></span>).on(<span class="pl-s"><span class="pl-pds">'</span>users.id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>contacts.user_id<span class="pl-pds">'</span></span>).where(<span class="pl-s"><span class="pl-pds">'</span>contacts.user_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-c1">5</span>)

db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).join(clause).get()</pre></div>
<a name="user-content-advanced-where"/>
<h3><a id="user-content-advanced-where" class="anchor" href="#advanced-where" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Advanced where</h3>
<p>Sometimes you may need to create more advanced where clauses such as "where exists" or nested parameter groupings.
It is pretty easy to do with the Orator query builder</p>
<a name="user-content-parameter-grouping"/>
<h4><a id="user-content-parameter-grouping" class="anchor" href="#parameter-grouping" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Parameter grouping</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>) \
    .where(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>) \
    .or_where(
        db.query().where(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-c1">100</span>).where(<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>!=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>admin<span class="pl-pds">'</span></span>)
    ).get()</pre></div>
<p>The query above will produce the following SQL:</p>
<div class="highlight highlight-source-sql"><pre><span class="pl-k">SELECT</span> <span class="pl-k">*</span> <span class="pl-k">FROM</span> users <span class="pl-k">WHERE</span> name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span> <span class="pl-k">OR</span> (votes <span class="pl-k">&gt;</span> <span class="pl-c1">100</span> <span class="pl-k">AND</span> title <span class="pl-k">!=</span> <span class="pl-s"><span class="pl-pds">'</span>Admin<span class="pl-pds">'</span></span>)</pre></div>
<a name="user-content-exists-statement"/>
<h4><a id="user-content-exists-statement" class="anchor" href="#exists-statement" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Exists statement</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where_exists(
    db.table(<span class="pl-s"><span class="pl-pds">'</span>orders<span class="pl-pds">'</span></span>).select(db.raw(<span class="pl-c1">1</span>)).where_raw(<span class="pl-s"><span class="pl-pds">'</span>order.user_id = users.id<span class="pl-pds">'</span></span>)
)</pre></div>
<p>The query above will produce the following SQL:</p>
<div class="highlight highlight-source-sql"><pre><span class="pl-k">SELECT</span> <span class="pl-k">*</span> <span class="pl-k">FROM</span> users
<span class="pl-k">WHERE</span> EXISTS (
    <span class="pl-k">SELECT</span> <span class="pl-c1">1</span> <span class="pl-k">FROM</span> orders <span class="pl-k">WHERE</span> <span class="pl-c1">orders</span>.<span class="pl-c1">user_id</span> <span class="pl-k">=</span> <span class="pl-c1">users</span>.<span class="pl-c1">id</span>
)</pre></div>
<a name="user-content-id1"/>
<h3><a id="user-content-aggregates-1" class="anchor" href="#aggregates-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Aggregates</h3>
<p>The query builder also provides a variety of aggregate methods, `
such as <code>count</code>, <code>max</code>, <code>min</code>, <code>avg</code>, and <code>sum</code>.</p>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).count()

price <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>orders<span class="pl-pds">'</span></span>).max(<span class="pl-s"><span class="pl-pds">'</span>price<span class="pl-pds">'</span></span>)

price <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>orders<span class="pl-pds">'</span></span>).min(<span class="pl-s"><span class="pl-pds">'</span>price<span class="pl-pds">'</span></span>)

price <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>orders<span class="pl-pds">'</span></span>).avg(<span class="pl-s"><span class="pl-pds">'</span>price<span class="pl-pds">'</span></span>)

total <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).sum(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>)</pre></div>
<a name="user-content-raw-expressions"/>
<h3><a id="user-content-raw-expressions" class="anchor" href="#raw-expressions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Raw expressions</h3>
<p>Sometimes you may need to use a raw expression in a query.
These expressions will be injected into the query as strings, so be careful not to create any SQL injection points!
To create a raw expression, you may use the <code>raw()</code> method:</p>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>) \
    .select(db.raw(<span class="pl-s"><span class="pl-pds">'</span>count(*) as user_count, status<span class="pl-pds">'</span></span>)) \
    .where(<span class="pl-s"><span class="pl-pds">'</span>status<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>!=<span class="pl-pds">'</span></span>, <span class="pl-c1">1</span>) \
    .group_by(<span class="pl-s"><span class="pl-pds">'</span>status<span class="pl-pds">'</span></span>) \
    .get()</pre></div>
<a name="user-content-inserts"/>
<h3><a id="user-content-inserts" class="anchor" href="#inserts" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Inserts</h3>
<a name="user-content-insert-records-into-a-table"/>
<h4><a id="user-content-insert-records-into-a-table" class="anchor" href="#insert-records-into-a-table" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Insert records into a table</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).insert(<span class="pl-v">email</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>foo@bar.com<span class="pl-pds">'</span></span>, <span class="pl-v">votes</span><span class="pl-k">=</span><span class="pl-c1">0</span>)

db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).insert({
    <span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>foo@bar.com<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>: <span class="pl-c1">0</span>
})</pre></div>
<p>It is important to note that there is two notations available.
The reason is quite simple: the dictionary notation, though a little less practical, is here to handle
columns names which cannot be passed as keywords arguments.</p>
<a name="user-content-inserting-records-into-a-table-with-an-auto-incrementing-id"/>
<h4><a id="user-content-inserting-records-into-a-table-with-an-auto-incrementing-id" class="anchor" href="#inserting-records-into-a-table-with-an-auto-incrementing-id" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Inserting records into a table with an auto-incrementing ID</h4>
<p>If the table has an auto-incrementing id, use <code>insert_get_id</code> to insert a record and retrieve the id:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c1">id</span> <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).insert_get_id({
    <span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>foo@bar.com<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>: <span class="pl-c1">0</span>
})</pre></div>
<a name="user-content-inserting-multiple-record-into-a-table"/>
<h4><a id="user-content-inserting-multiple-record-into-a-table" class="anchor" href="#inserting-multiple-record-into-a-table" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Inserting multiple record into a table</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).insert([
    {<span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>foo@bar.com<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>: <span class="pl-c1">0</span>},
    {<span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>bar@baz.com<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>: <span class="pl-c1">0</span>}
])</pre></div>
<a name="user-content-updates"/>
<h3><a id="user-content-updates" class="anchor" href="#updates" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Updates</h3>
<a name="user-content-updating-records"/>
<h4><a id="user-content-updating-records" class="anchor" href="#updating-records" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Updating records</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where(<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>, <span class="pl-c1">1</span>).update(<span class="pl-v">votes</span><span class="pl-k">=</span><span class="pl-c1">1</span>)

db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where(<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>, <span class="pl-c1">1</span>).update({<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>: <span class="pl-c1">1</span>})</pre></div>
<p>Like the <code>insert</code> statement, there is two notations available.
The reason is quite simple: the dictionary notation, though a little less practical, is here to handle
columns names which cannot be passed as keywords arguments.</p>
<a name="user-content-incrementing-or-decrementing-the-value-of-a-column"/>
<h4><a id="user-content-incrementing-or-decrementing-the-value-of-a-column" class="anchor" href="#incrementing-or-decrementing-the-value-of-a-column" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Incrementing or decrementing the value of a column</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).increment(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>)  <span class="pl-c"># Increment the value by 1</span>

db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).increment(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>, <span class="pl-c1">5</span>)  <span class="pl-c"># Increment the value by 5</span>

db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).decrement(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>)  <span class="pl-c"># Decrement the value by 1</span>

db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).decrement(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>, <span class="pl-c1">5</span>)  <span class="pl-c"># Decrement the value by 5</span></pre></div>
<p>You can also specify additional columns to update:</p>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).increment(<span class="pl-s"><span class="pl-pds">'</span>votes<span class="pl-pds">'</span></span>, <span class="pl-c1">1</span>, <span class="pl-v">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>)</pre></div>
<a name="user-content-deletes"/>
<h3><a id="user-content-deletes" class="anchor" href="#deletes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Deletes</h3>
<a name="user-content-deleting-records"/>
<h4><a id="user-content-deleting-records" class="anchor" href="#deleting-records" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Deleting records</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where(<span class="pl-s"><span class="pl-pds">'</span>age<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&lt;<span class="pl-pds">'</span></span>, <span class="pl-c1">25</span>).delete()</pre></div>
<a name="user-content-delete-all-records"/>
<h4><a id="user-content-delete-all-records" class="anchor" href="#delete-all-records" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Delete all records</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).delete()</pre></div>
<a name="user-content-truncate"/>
<h4><a id="user-content-truncate" class="anchor" href="#truncate" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Truncate</h4>
<div class="highlight highlight-source-python"><pre>db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).truncate()</pre></div>
<a name="user-content-unions"/>
<h3><a id="user-content-unions" class="anchor" href="#unions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Unions</h3>
<p>The query builder provides a quick and easy way to "union" two queries:</p>
<div class="highlight highlight-source-python"><pre>first <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where_null(<span class="pl-s"><span class="pl-pds">'</span>first_name<span class="pl-pds">'</span></span>)

users <span class="pl-k">=</span> db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).where_null(<span class="pl-s"><span class="pl-pds">'</span>last_name<span class="pl-pds">'</span></span>).union(first).get()</pre></div>
<p>The <code>union_all</code> method is also available.</p>
<a name="user-content-id2"/>
<h2><a id="user-content-read--write-connections" class="anchor" href="#read--write-connections" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Read / Write connections</h2>
<p>Sometimes you may wish to use one database connection for SELECT statements,
and another for INSERT, UPDATE, and DELETE statements. Orator makes this easy,
and the proper connections will always be used whether you use raw queries, the query
builder or the actual ORM</p>
<p>Here is an example of how read / write connections should be configured:</p>
<div class="highlight highlight-source-python"><pre>config <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">'</span>mysql<span class="pl-pds">'</span></span>: {
        <span class="pl-s"><span class="pl-pds">'</span>read<span class="pl-pds">'</span></span>: {
            <span class="pl-s"><span class="pl-pds">'</span>host<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>192.168.1.1<span class="pl-pds">'</span></span>
        },
        <span class="pl-s"><span class="pl-pds">'</span>write<span class="pl-pds">'</span></span>: {
            <span class="pl-s"><span class="pl-pds">'</span>host<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>192.168.1.2<span class="pl-pds">'</span></span>
        },
        <span class="pl-s"><span class="pl-pds">'</span>driver<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>mysql<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>database<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>database<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>username<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>root<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>password<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>prefix<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
    }
}</pre></div>
<p>Note that two keys have been added to the configuration dictionary: <code>read</code> and <code>write</code>.
Both of these keys have dictionary values containing a single key: <code>host</code>.
The rest of the database options for the <code>read</code> and <code>write</code> connections
will be merged from the main <code>mysql</code> dictionary. So, you only need to place items
in the <code>read</code> and <code>write</code> dictionaries if you wish to override the values in the main dictionary.
So, in this case, <code>192.168.1.1</code> will be used as the "read" connection, while <code>192.168.1.2</code>
will be used as the "write" connection. The database credentials, prefix, character set,
and all other options in the main <code>mysql</code> dictionary will be shared across both connections.</p>
<a name="user-content-database-transactions"/>
<h2><a id="user-content-database-transactions" class="anchor" href="#database-transactions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Database transactions</h2>
<p>To run a set of operations within a database transaction, you can use the <code>transaction</code> method
which is a context manager:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">with</span> db.transaction():
    db.table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).update({votes: <span class="pl-c1">1</span>})
    db.table(<span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>).delete()</pre></div>
<div>
<p>Note</p>
<p>Any exception thrown within a transaction block will cause the transaction to be rolled back
automatically.</p>
</div>
<p>Sometimes you may need to start a transaction yourself:</p>

<p>You can rollback a transaction with the <code>rollback</code> method:</p>

<p>You can also commit a transaction via the <code>commit</code> method:</p>

<p>By default, all underlying DBAPI connections are set to be in autocommit mode
meaning that you don't need to explicitly commit after each operation.</p>
<a name="user-content-accessing-connections"/>
<h2><a id="user-content-accessing-connections" class="anchor" href="#accessing-connections" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Accessing connections</h2>
<p>When using multiple connections, you can access them via the <code>connection()</code> method:</p>
<div class="highlight highlight-source-python"><pre>users <span class="pl-k">=</span> db.connection(<span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>).table(<span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>).get()</pre></div>
<p>You also can access the raw, underlying dbapi connection instance:</p>
<div class="highlight highlight-source-python"><pre>db.connection().get_connection()</pre></div>
<p>Sometimes, you may need to reconnect to a given database:</p>

<p>If you need to disconnect from the given database, use the <code>disconnect</code> method:</p>


</article>
  </div></body></html>