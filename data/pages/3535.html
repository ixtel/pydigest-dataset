<html><body><div><div class="post-text" itemprop="text">

<p>Is it possible to create a spider which inherits the functionality from two base spiders, namely SitemapSpider and CrawlSpider?</p>

<p>I have been trying to scrape data from various sites and realized that not all sites have listing of every page on the website, thus a need to use CrawlSpider. But CrawlSpider goes through a lot of junk pages and is kind of an overkill.</p>

<p>What I would like to do is something like this:</p>

<ol>
<li><p>Start my Spider which is a subclass of SitemapSpider and pass regex
matched  responses to the parse_products to extract useful
information method.</p></li>
<li><p>Go to links matching the regex: /reviews/ from the products page,
and sending the data to parse_review function.<br/>
   <strong>Note:</strong> "/reviews/" type pages are not listed in sitemap</p></li>
<li><p>Extract information from /reviews/ page</p></li>
<li><p>CrawlSpider is basically for recursive crawls and scraping</p></li>
</ol>

<p>-------ADDITIONAL DETAILS-------</p>

<p>The site in question is www.flipkart.com
The site has listings for a lot of products, with each page having its own detail page.
Along with the details page, their is a corresponding "review" page for the product. The link to the review page is also available on the product details page. </p>

<p><strong>Note: Review pages are not listed on the sitemap.</strong></p>

<pre><code>class WebCrawler(SitemapSpider, CrawlSpider):
    name = "flipkart"
    allowed_domains = ['flipkart.com']
    sitemap_urls = ['http://www.flipkart.com/robots.txt']
    sitemap_rules = [(regex('/(.*?)/p/(.*?)'), 'parse_product')]
    start_urls = ['http://www.flipkart.com/']
    rules = [Rule(LinkExtractor(allow=['/(.*?)/product-reviews/(.*?)']), 'parse_reviews'),
             Rule(LinkExtractor(restrict_xpaths='//div[@class="fk-navigation fk-text-center tmargin10"]'), follow=True)]

    def parse_product(self, response):
        loader = FlipkartItemLoader(response=response)
        loader.add_value('pid', 'value of pid')
        loader.add_xpath('name', 'xpath to name')
        yield loader.load_item()

    def parse_reviews(self, response):
        loader = ReviewItemLoader(response=response)
        loader.add_value('pid','value of pid')
        loader.add_xpath('review_title', 'xpath to review title')
        loader.add_xpath('review_text', 'xpath to review text')
        yield loader.load_item()
</code></pre>
    </div>
    </div></body></html>