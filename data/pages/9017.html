<html><body><div><div class="post-body entry-content"><p>
By </p><a href="http://jugad2.blogspot.in/p/about-vasudev-ram.html">Vasudev Ram</a>
<a href=""/><p>
In this recent post:

</p><a href="http://jugad2.blogspot.in/2016/01/generate-pdf-from-python-controlled.html">Generate PDF from a Python-controlled Unix pipeline</a><p> ,
</p><p>
I forgot to include the code for the program PopenToPDF.py. Here it is now:
</p><pre># PopenToPDF.py
# Demo program to read text from a shell pipeline using 
# subprocess.Popen, and write the text to PDF using xtopdf.
# Author: Vasudev Ram
# Copyright (C) 2016 Vasudev Ram - http://jugad2.blogspot.com

import sys
import subprocess
from PDFWriter import PDFWriter

def error_exit(message):
    sys.stderr.write(message + '\n')
    sys.stderr.write("Terminating.\n")
    sys.exit(1)

def main():
    try:
        # Create and set up a PDFWriter instance.
        pw = PDFWriter("PopenTo.pdf")
        pw.setFont("Courier", 12)
        pw.setHeader("Use subprocess.Popen to read pipe and write to PDF.")
        pw.setFooter("Done using selpg, xtopdf, Python and ReportLab, on Linux.")

        # Set up a pipeline with nl and selpg such that we can read from its stdout.
        # nl numbers the lines of the input.
        # selpg extracts pages 3 to 5 from the input.
        pipe = subprocess.Popen("nl -ba 1000-lines.txt | selpg -s3 -e5", \
            shell=True, bufsize=-1, stdout=subprocess.PIPE, 
            stderr=sys.stderr).stdout

        # Read from the pipeline and write the data to PDF, using the PDFWriter instance.
        for idx, line in enumerate(pipe):
            pw.writeLine(str(idx).zfill(8) + ": " + line)
    except IOError as ioe:
        error_exit("Caught IOError: {}".format(str(ioe)))
    except Exception as e:
        error_exit("Caught Exception: {}".format(str(e)))
    finally:
        pw.close()

main()
</pre><p>I ran it in the usual way with:
</p><pre>$ python PopenToPDF.py
</pre><p>to get the output shown in the </p><a href="http://jugad2.blogspot.in/2016/01/generate-pdf-from-python-controlled.html">previous post describing PopenToPDF</a><p>.
</p><p>
Also, this is the one-off script, </p><b>gen-file.py</b><p>, that created the 1000 line input file:
</p><pre>with open("1000-lines.txt", "w") as fil:
    for i in range(1000):
        fil.write("This is a line of text.\n")
fil.close()
</pre><p>
- Vasudev

</p><p/><p>- </p><a href="http://jugad2.blogspot.in/p/about-vasudev-ram.html">Vasudev Ram - Online Python training and  programming</a> <p/><b><a href="mailto:vasudevram@gmail.com?subject=Email%20me%20about%20your%20new%20products%20and%20services">Signup to hear about new products and services I create.</a></b> <p/><a href="http://jugad2.blogspot.com/search/label/python">Posts about Python</a>  <a href="http://jugad2.blogspot.com/search/label/xtopdf">Posts about xtopdf</a> <p/><p/><a href="https://code.activestate.com/recipes/users/4173351/">My ActiveState recipes</a> <p/>   
<p/>
</div>
</div></body></html>