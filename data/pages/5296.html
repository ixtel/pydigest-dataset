<html><body><div><div class="content">
	<p><a href="https://www.openshift.com/">Openshift free tier</a> is an excellent way to host your python web app for staging or testing, and you can even host a low to medium traffic production site. Openshift provides several options (cartridges) for hosting including <code class="highlighter-rouge">python, php, node.js, etc.</code> but <code class="highlighter-rouge">python</code> being my favorite language and <code class="highlighter-rouge">Flask</code> being a minimalist and flexible framework, this combination is what I usually end up with.</p>

<h3 id="create-an-openshift-account">Create an Openshift account</h3>

<p>In case you haven’t already, head over to <a href="https://www.openshift.com/">Openshift</a> and sign up for a free tier. You will be able to host at most three apps for each account. Openshift apps are hosted on <code class="highlighter-rouge">rhcloud.com</code> domain and you’ll have to setup a subdomain first which will be part of your app url. For instance, if I register <code class="highlighter-rouge">prahladyeri.rhcloud.com</code> subdomain, I can create the following apps with that:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>myflaskapp-prahladyeri.rhcloud.com
myphpapp-prahladyeri.rhcloud.com
blog-prahladyeri.rhcloud.com
</code></pre>
</div>



<p>You will need the following:</p>

<ol>
  <li><a href="git-scm.com/">Git</a>: Your app resides in a git repository, so you’ll need git installed on your machine to push changes. App is deployed automatically once you push.</li>
  <li><a href="http://python.org">Python and Flask</a>: Obviously, you are going to need them if you are building a Flask app.</li>
  <li><a href="https://rubygems.org/gems/rhc">Openshift rhc tool</a>: This <code class="highlighter-rouge">ruby</code> based tool is optional, only use it if you don’t want to use their online portal for creating apps or you aren’t familiar with ssh. Personally, I didn’t want to install <code class="highlighter-rouge">ruby</code> on my machine just for this one purpose.</li>
</ol>

<h3 id="pull-the-remote-repo">Pull the remote repo</h3>

<p>Once you create a python app, Openshift will provide you a git repository url as follows:</p>

<p><img src="/assets/openshift-git-repo.png" alt="Openshift git url"/></p>

<p>Now open your command line and pull this starter repo to your local machine:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">git clone &lt;YOUR_SOURCE_URL&gt; myFlaskApp</code></pre></div>

<p>Now, the remote repository will be cloned in the <code class="highlighter-rouge">myFlaskApp</code> folder. Browse it to see the scaffolding.</p>

<h3 id="add-your-flask-app">Add your flask app</h3>

<p>The scaffolding structure will be as follows:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">wsgi.py
setup.py
.openshift/..
.settings/..
wsgi/..			<span class="o">=</span>&gt; your python <span class="nb">source </span>files go here.
wsgi/static..	<span class="o">=</span>&gt; your static folders viz css, img, fonts, et al. go here.</code></pre></div>

<p>If the wsgi/ folder doesn’t exist, you’ll have to create it. Just modify the setup.py and add Flask and SQLAlchemy as your app dependencies along with your app name. This tells openshift to make sure that dependency packages are available whenever you push any code changes.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'myFlaskApp'</span><span class="p">,</span>
	  <span class="n">version</span><span class="o">=</span><span class="s">'1.0'</span><span class="p">,</span>
	  <span class="n">description</span><span class="o">=</span><span class="s">'myFlaskApp'</span><span class="p">,</span>
	  <span class="n">author</span><span class="o">=</span><span class="s">'Prahlad Yeri'</span><span class="p">,</span>
	  <span class="n">author_email</span><span class="o">=</span><span class="s">'<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="79090b181115181d001c0b10390018111616571a1614">[email protected]</a>'</span><span class="p">,</span>
	  <span class="n">url</span><span class="o">=</span><span class="s">'http://www.python.org/sigs/distutils-sig/'</span><span class="p">,</span>
	  <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span><span class="s">'Flask==0.10.1'</span><span class="p">,</span><span class="s">'SQLAlchemy==0.9.8'</span><span class="p">],</span>
	 <span class="p">)</span></code></pre></div>

<p>Now, create a text file named <code class="highlighter-rouge">application</code> in the wsgi/ folder with the following contents:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/python</span>
<span class="kn">import</span> <span class="nn">os</span>
 
<span class="n">virtenv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'OPENSHIFT_PYTHON_DIR'</span><span class="p">]</span> <span class="o">+</span> <span class="s">'/virtenv/'</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'PYTHON_EGG_CACHE'</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">virtenv</span><span class="p">,</span> <span class="s">'lib/python2.7/site-packages'</span><span class="p">)</span>
<span class="n">virtualenv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">virtenv</span><span class="p">,</span> <span class="s">'bin/activate_this.py'</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
	<span class="nb">execfile</span><span class="p">(</span><span class="n">virtualenv</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">__file__</span><span class="o">=</span><span class="n">virtualenv</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
	<span class="k">pass</span>
 
<span class="kn">from</span> <span class="nn">myFlaskApp</span> <span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">application</span></code></pre></div>

<p>This is a configuration file that tells openshift where your Flask app script resides. Now create a python file called myFlaskApp.py, this will be your HelloWorld script:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">flask</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
	<span class="k">return</span> <span class="s">"Hello World"</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
	<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></code></pre></div>

<p>The last part of the code (app.run) is there so that you may test the Flask app by running this script on your local machine before pushing these changes.</p>

<h3 id="push-your-changes">Push your changes</h3>

<p>All that is left to be done now is committing your changes and pushing them to openshift:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git add .
git commit -m "Initial commit for myFlaskApp"
git push origin master
</code></pre>
</div>

<h3 id="voila-you-are-done">Voila! You are done</h3>

<p>Wasn’t it almost as easy as deploying a <code class="highlighter-rouge">php</code> script on your web host? If everything goes right, your Flask app will be hosted on <code class="highlighter-rouge">http://myFlaskApp-mydomain.rhcloud.com/</code>. Visit your app link and check it out.</p>

<h3 id="few-important-things">Few important things</h3>

<ul>
  <li>
    <p>In case you aren’t familiar about how git over ssl works, the remote machine authenticates your machine using an SSL public key you have already provided them. So if this is your fist time, you’ll have to generate a private-public key pair (using ssh in linux or putty on windows). After that, you’ll have to update your public key to Openshift, so they can authenticate your machine. You can add it using the Settings menu on the Openshift portal.</p>
  </li>
  <li>
    <p>Its very important that all your static files reside in <strong>wsgi/static</strong> folder and that folder only. Openshift uses that path by default. But in case you are really stuck with using <code class="highlighter-rouge">/css</code> and <code class="highlighter-rouge">/js</code> in your existing app, as a solution you can clear the <code class="highlighter-rouge">static_url_path</code> in your flask app as follows:</p>
  </li>
</ul>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="n">static_url_path</span><span class="o">=</span><span class="s">''</span><span class="p">,</span> <span class="n">static_folder</span><span class="o">=</span><span class="s">'static'</span><span class="p">)</span></code></pre></div>

<p>Refer to this Openshift <a href="https://blog.openshift.com/build-your-app-on-openshift-using-flask-sqlalchemy-and-postgresql-92/">tutorial</a> for more details.</p>

<ul>
  <li>Make the most of SSH. Some times, you may want to connect with the remote server using secured shell (ssh/putty) for troubleshooting, viewing logs, etc. Your SSH url is included in your git source url. So, if your git url is of the form:</li>
</ul>



<p>Just remove the <code class="highlighter-rouge">ssh://</code> from the beginning and the other things after the domain, so the SSH host url becomes:</p>



<p><em>References:</em></p>



	</div>
	</div></body></html>