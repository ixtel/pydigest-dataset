<html><body><div><div class="wall_post_text"><a href="/feed?section=search&amp;q=%23python">#python</a> <a href="/feed?section=search&amp;q=%23pynsk">#pynsk</a><p>Таинство стандартной библиотеки: multiprocessing</p><p>GIL Python снимает множество головной боли с программиста, но и не дает малой кровью использовать всю мощь CPU. </p><p>А что если реально надо быстрее исполнить код? Например, надо сделать 1000 запросов в web. </p><p>Можно завести несколько параллельных потоков или даже процессов. Вот с процессами только беда - как их синхронизировать между собой?</p><p>В этом случае выходит на сцену модуль multiprocessing. </p><p>multiprocessing позволяет работать с процессам как с потоками. Это значит, что модуль берет на себя проблему синхронизации отдельных Python-процессов. Много процессов - много GIL'ов (каждый в своем процессе) - нет проблем с использованием процессора.</p><p>Пример использования может быть такой:</p><p>from subprocess import Popen, PIPE</p><p>from multiprocessing import Process, Queue</p><p>def execute(queue):</p><p> proc = Popen( "python ./</p><a href="/away.php?to=http%3A%2F%2FdsTest.py&amp;post=-96469126_552" target="_blank">dsTest.py</a><p>", shell=True, stdout=PIPE )</p><p> proc.wait() # дождаться выполнения</p><p> queue.put(proc.communicate()[0]) ## получить то, что вернул подпроцесс</p><p>allProcesses = []</p><p>queue = Queue()</p><p>for i in xrange(10):</p><p> p = Process(target=execute, args=(queue,))</p><p> allProcesses.append(p)</p><p> p.start()</p><p>for p in allProcesses:</p><p> p.join()</p><p>for i in xrange( queue.qsize() ):</p><p> print queue.get()</p><p>Казалось бы, много процессов - процессор заполнен на полную, но есть же лежка дегтя? Ложка дегтя - это синхронизация процессов. Именно на этом процессе могут быть основные траты ресурсов.</p><p>Читаем дальше по ссылкам:</p><a href="/away.php?to=https%3A%2F%2Fdocs.python.org%2F3.5%2Flibrary%2Fmultiprocessing.html&amp;post=-96469126_552" target="_blank" title="https://docs.python.org/3.5/library/multiprocessing.html">https://docs.python.org/3.5/library/multiprocessing.h..</a><a href="/away.php?to=https%3A%2F%2Fpymotw.com%2F2%2Fmultiprocessing%2F&amp;post=-96469126_552" target="_blank">https://pymotw.com/2/multiprocessing/</a><a href="/away.php?to=http%3A%2F%2Ftoly.github.io%2Fblog%2F2014%2F02%2F13%2Fparallelism-in-one-line%2F&amp;post=-96469126_552" target="_blank" title="http://toly.github.io/blog/2014/02/13/parallelism-in-one-line/">http://toly.github.io/blog/2014/02/13/parallelism-in-..</a><a href="/away.php?to=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fru%2Flibrary%2Fl-python_details_05%2F&amp;post=-96469126_552" target="_blank" title="https://www.ibm.com/developerworks/ru/library/l-python_details_05/">https://www.ibm.com/developerworks/ru/library/l-pytho..</a><a href="/away.php?to=http%3A%2F%2Fantonkonovalov.blogspot.ru%2F2011%2F12%2Fpython.html&amp;post=-96469126_552" target="_blank">http://antonkonovalov.blogspot.ru/2011/12/python.html</a></div></div></body></html>