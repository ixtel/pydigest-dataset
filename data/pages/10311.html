<html><body><div><div class="col-md-12">
				<p><a href="https://www.twilio.com/docs/api/lookups">Twilio Lookup</a> is a simple REST API with a ton of utility. You can use Lookup to check whether a number exists, format international numbers to local standards, determine whether a phone is a landline or can receive text messages, and even discover information about the carrier associated with that phone number.</p>
<p>In this post, we’re going to learn how to deal with valid and invalid numbers using the <a href="https://www.twilio.com/docs/python/install">Twilio Python library</a>. This code could work in any context whether you use it to look up customer numbers in your production Django app or just have a basic script you want to run to check numbers in a local database. This should also work regardless of whether you are using Python 2 or 3.</p>
<p>Before getting started you will need to have <a href="https://www.python.org/downloads/">Python</a> installed as well as <a href="http://pip.readthedocs.org/en/stable/installing/">pip</a>, which should come with most versions of Python. You will also need to sign up for <a href="http://twilio.com/try-twilio">free Twilio account</a>.</p>
<h3 class="c0 c1">
<a id="h.t4g6gfuyha2x" name="h.t4g6gfuyha2x"/>Getting started<br/>
</h3>
<p>First off you should run a <a href="https://virtualenv.pypa.io/en/latest/index.html">virtualenv</a> in order to cleanly install python libraries with pip. If you are unfamiliar with pip and virtualenv you can check out <a href="https://www.twilio.com/docs/quickstart/python/devenvironment">this guide</a>.</p>
<p>Head over to your terminal and install the Twilio Python module:
</p>
<p/>

		<div id="crayon-56d5994e85f2f367873125" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5994e85f2f367873125-1"><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">twilio</span><span class="crayon-o">&gt;=</span><span class="crayon-cn">5.0.0</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
</p><p>
You will also need to have your Account SID and Auth Token handy, which you can grab from your <a href="https://www.twilio.com/user/account/settings">Twilio account dashboard</a>.</p>
<p><img alt="twilio-credentials.gif" src="https://www.twilio.com/blog/wp-content/uploads/2016/02/iDAQcmxBYn7TF204ZeIOPwciQV2Zn-HWiflo7X8xgRgTZ9hMq8Oqq2iUQ9y6ANSMbQ0BD8WsrgyCxbBRX779U0ObFGckOoJ6888N5jBDat2jZKcm4TzJqVsqAwbI4-MfyDY6Kuc9.png" title="" class="&quot; aligncenter"/></p>
<p>Now take those values and set them as environment variables:
</p>
<p/>

		<div id="crayon-56d5994e85f42684287576" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5994e85f42684287576-1"><span class="crayon-e">export </span><span class="crayon-v">TWILIO_ACCOUNT_SID</span><span class="crayon-o">=</span><span class="crayon-s">'Replace this with your Twilio Account SID*'</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f42684287576-2"><span class="crayon-e">export </span><span class="crayon-v">TWILIO_AUTH_TOKEN</span><span class="crayon-o">=</span><span class="crayon-s">'*Replace this with your Twilio Auth Token*'</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
</p><p>
With these set as environment variables, the Twilio Python module will be able to access them so you don’t have the problem of accidentally committing your account credentials to version control. You can also check out <a href="https://www.twilio.com/blog/2015/02/managing-development-environment-variables-across-multiple-ruby-applications.html">this guide</a> on managing your environment variables.</p>
<h3 class="c0 c1">
<a id="h.dcwybn43o1ho" name="h.dcwybn43o1ho"/>Looking up valid phone numbers<br/>
</h3>
<p>You can check out the <a href="https://www.twilio.com/lookup">Lookup page</a> if you want to play around with the API and see what type of data a request will return. Try entering a phone number and take a look at the JSON response object.<br/>
<img alt="lookup-number.gif" src="https://www.twilio.com/blog/wp-content/uploads/2016/02/bSki52NVUzHJs3rjtvShdOiqNkuAlhBl578Qev9R9kFsJ0nE1IyZ5oFyjJjMxcembNO7qiYS5QDueaLYkUmBOJPU-JYzNaRCG87Yi1HuZZvwf2-ZhUh6fIi0xxCly8IzaRmtAGLk.png" title="" class="&quot; aligncenter"/></p>
<p>Here’s a quick code sample for that type of lookup without getting the carrier information:
</p>
<p/>

		<div id="crayon-56d5994e85f4f772603759" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5994e85f4f772603759-1"><span class="crayon-e">from </span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">rest</span><span class="crayon-sy">.</span><span class="crayon-e">lookups </span><span class="crayon-e">import </span><span class="crayon-e">TwilioLookupsClient</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f4f772603759-2"> </p><p class="crayon-line" id="crayon-56d5994e85f4f772603759-3"><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TwilioLookupsClient</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f4f772603759-4"><span class="crayon-v">number</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">phone_numbers</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">"15108675309"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5994e85f4f772603759-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">number</span><span class="crayon-sy">.</span><span class="crayon-v">national_format</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># =&gt; (510) 867-5309</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
</p><p>
This basic functionality is free, but you can get more information by doing a carrier lookup, which will <a href="https://www.twilio.com/lookup#pricing">not cost much</a>. Carrier lookups are commonly used to determine if a number is capable of receiving SMS/MMS messages.</p>
<p>Carrier lookups contain much more useful information, but require an extra parameter:
</p>
<p/>

		<div id="crayon-56d5994e85f60311334147" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5994e85f60311334147-1"><span class="crayon-p"># Download the Python helper library from twilio.com/docs/python/install</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f60311334147-2"><span class="crayon-e">from </span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">rest</span><span class="crayon-sy">.</span><span class="crayon-e">lookups </span><span class="crayon-e">import </span><span class="crayon-v">TwilioLookupsClient</span></p><p class="crayon-line" id="crayon-56d5994e85f60311334147-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f60311334147-4"><span class="crayon-p"># Your Account Sid and Auth Token from twilio.com/user/account</span></p><p class="crayon-line" id="crayon-56d5994e85f60311334147-5"><span class="crayon-p"># Store them in the environment variables:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f60311334147-6"><span class="crayon-p"># "TWILIO_ACCOUNT_SID" and "TWILIO_AUTH_TOKEN"</span></p><p class="crayon-line" id="crayon-56d5994e85f60311334147-7"><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TwilioLookupsClient</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f60311334147-8"> </p><p class="crayon-line" id="crayon-56d5994e85f60311334147-9"><span class="crayon-v">number</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">phone_numbers</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">"15108675309"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">include_carrier_info</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f60311334147-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">number</span><span class="crayon-sy">.</span><span class="crayon-v">carrier</span><span class="crayon-sy">[</span><span class="crayon-s">'name'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># =&gt; Sprint Spectrum, L.P.</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/>
<h3 class="c0 c1">
<a id="h.7h4qqmyuxu6k" name="h.7h4qqmyuxu6k"/>Looking up invalid phone numbers<br/>
</h3>
<p>You can think about Twilio Lookup as a phonebook REST API. In this “online phonebook” the phone numbers serve as a unique ID. When you try to look up a phone number that does not exist you will get a 404 response. </p>
<p>Head over to the Lookup homepage again to see this in action when you check a number that doesn’t exist:</p>
<p><img alt="invalid-phone-lookup.gif" src="https://www.twilio.com/blog/wp-content/uploads/2016/02/ZixwNsMm7CVar6mxoRfvpPlv-XSUticVG5Pc3Lfv9Fk-JziTt0iJdzg6zG-pX_TZP3CqU_N2O64UdsFQNkBtsB4r84EDd98q2KVkWBCD14eIrNtoK2lRAOx8j7U3SN6EkEMBxK9s.png" title="" class="&quot; aligncenter"/></p>
<p>When the Twilio Python library encounters a 404 it will throw a “TwilioRestException”. If you change our current code to look up an incorrect phone number you will see this in action:</p>
<p><img alt="Screen Shot 2016-02-01 at 4.42.10 PM.png" src="https://www.twilio.com/blog/wp-content/uploads/2016/02/lGYgVMRoiFS31cW1jvjJvqrXbnBOzvXkPazQTxLxUtMP62QLefs3Z5ZojZfqNJThLl8UWhtr8lxwhChtCIdGytUwxpCKDuZr4hdVlLNx5cLoN8v7fUtXWkHc1EZilXdK27ooMZxi.png" title="" class="&quot; aligncenter"/></p>
<p>The error code for this is <a href="https://www.twilio.com/docs/api/errors/20404">20404</a>, so if we want to write a function that validates phone numbers we can check to see if an exception was raised with code 20404. </p>
<p>Create a file called “lookup.py” and try this code out:
</p>
<p/>

		<div id="crayon-56d5994e85f6e913525026" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover expand">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-2">2</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-4">4</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-6">6</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-8">8</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-10">10</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-12">12</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-14">14</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-16">16</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-18">18</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-20">20</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5994e85f6e913525026-22">22</p><p class="crayon-num" data-line="crayon-56d5994e85f6e913525026-23">23</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5994e85f6e913525026-1"><span class="crayon-p"># Download the Python helper library from twilio.com/docs/python/install</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-2"><span class="crayon-e">from </span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">rest</span><span class="crayon-sy">.</span><span class="crayon-e">lookups </span><span class="crayon-e">import </span><span class="crayon-e">TwilioLookupsClient</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-3"><span class="crayon-e">from </span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">rest</span><span class="crayon-sy">.</span><span class="crayon-e">exceptions </span><span class="crayon-e">import </span><span class="crayon-v">TwilioRestException</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-4"> </p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-5"><span class="crayon-p"># Your Account Sid and Auth Token from twilio.com/user/account</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-6"><span class="crayon-p"># Store them in the environment variables:</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-7"><span class="crayon-p"># "TWILIO_ACCOUNT_SID" and "TWILIO_AUTH_TOKEN"</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-8"><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TwilioLookupsClient</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-9"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-10"> </p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-11"><span class="crayon-e">def </span><span class="crayon-e">is_valid_number</span><span class="crayon-sy">(</span><span class="crayon-v">number</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-12"><span class="crayon-h">    </span><span class="crayon-st">try</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-13"><span class="crayon-h">        </span><span class="crayon-v">response</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">phone_numbers</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">number</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">include_carrier_info</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-14"><span class="crayon-h">        </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">phone_number</span><span class="crayon-h">  </span><span class="crayon-p"># If invalid, throws an exception.</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-15"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">True</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-16"><span class="crayon-h">    </span><span class="crayon-e">except </span><span class="crayon-e">TwilioRestException </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-17"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">code</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">20404</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-18"><span class="crayon-h">            </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">False</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-19"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-20"><span class="crayon-h">            </span><span class="crayon-i">raise</span><span class="crayon-h"> </span><span class="crayon-i">e</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-21"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5994e85f6e913525026-22"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">is_valid_number</span><span class="crayon-sy">(</span><span class="crayon-s">'19999999999'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># False</span></p><p class="crayon-line" id="crayon-56d5994e85f6e913525026-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">is_valid_number</span><span class="crayon-sy">(</span><span class="crayon-s">'15108675309'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># True</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>
</p><p>
You now have a function you could use anywhere in your code for validating phone numbers.
</p>
<h3 class="c0 c1">
<a id="h.i3x147ubu89b" name="h.i3x147ubu89b"/>Looking ahead<br/>
</h3>
<p>So now you know how to use the REST API phone book that is Twilio Lookup. You’ve used it for validating phone numbers, but you can also do cool things like phone number formatting and checking to see whether a number can receive text messages or not. </p>
<p>You might want to use one of these more common cases, but I’m always excited to see what other crazy ideas people think of with new APIs. I cannot wait to see what you build with Twilio Lookup. </p>
<p>If you have any questions or want to show off what you built, feel free to reach out:
</p>

			</div>
					</div></body></html>