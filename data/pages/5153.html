<html><body><div><body id="readabilityBody">

<h1>SlopPy: An error-tolerant Python interpreter that facilitates sloppy programming</h1>

<h3>What is SlopPy?</h3>

<p><b>SlopPy</b> (<b>Slop</b>py <b>Py</b>thon) is a modified Python
interpreter that ensures your scripts will never crash.</p>

<p>Whenever SlopPy encounters an uncaught exception, instead of crashing
the script, it will create a special NA ("Not Available")
object, make that the result of the current expression, and continue
executing normally.  Whenever an NA object appears in an expression,
SlopPy propagates it according to special rules.  For example, all unary
and binary operations involving NA will return NA.</p>

<p>SlopPy allows imperfect scripts to finish executing and produce
partial results (and a log of all exceptions), which can be more
informative than simply crashing at the first uncaught exception.
SlopPy is a drop-in replacement for the Python 2.6 interpreter, so it
should work seamlessly with all of your existing scripts and 3rd-party
libraries with no run-time slowdown.</p>


<h3>How can SlopPy be useful for me?</h3>


<p>If you've written Python scripts that run for at least a few minutes,
then you've probably encountered the following annoyance:</p>

<ol>

<li>You start executing a long-running script on your machine.</li>

<li>You switch to working on another task or go home for the evening.</li>

<li>When you return to check on your script, you see that it crashed at
the first uncaught exception without producing any useful results.</li>

</ol>

<p>Now you need to edit your script to fix that bug and then re-execute.
It might take a few minutes to hours before your script gets past the
point where it originally crashed, and then it will likely crash again
with another exception.  It might take a few rounds of debugging and
re-executing before the script successfully finishes running and
produces results.</p>

<p>SlopPy allows your buggy script to finish running on the first
attempt, produce partial results, and show you all uncaught exceptions
(not just the first one).  You can always gain more insights from
partial results than from no results, and you can also try to patch up
all exceptions in one round of edits rather than addressing one at a
time.</p>

<p>In sum, SlopPy allows you to write sloppy scripts in a
'quick-and-dirty' manner without worrying about error handling, which
can speed up your iteration cycle when prototyping.</p>


<h3>Can you show me a quick demo?</h3>

<p>Sure, this 6-minute screencast demonstrates SlopPy's basic capabilities:</p>

<center>
<p>

<object><param name="movie" value="http://www.youtube.com/v/yYpTcK0Z9z8?fs=1&amp;hl=en_US"/><param name="allowFullScreen" value="true"/><param name="allowscriptaccess" value="always"/><embed src="http://www.youtube.com/v/yYpTcK0Z9z8?fs=1&amp;hl=en_US" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true"/></object>

</p>
</center>


<h3>How can I learn more about SlopPy?</h3>

<p>This workshop paper reflects the state of SlopPy circa late-2010:</p>

<p><a href="publications/SlopPy-error-tolerant-Python-interpreter_WODA-2011.pdf"><strong>Sloppy Python: Using Dynamic Analysis to Automatically Add Error Tolerance to Ad-Hoc Data Processing Scripts.</strong></a>
Philip J. Guo.
<em>International Workshop on Dynamic Analysis (WODA)</em>, July 2011.
<br/>[<a href="publications/SlopPy-error-tolerant-Python-interpreter_WODA-2011.txt">BibTeX</a>]</p>



<hr/>

<h3>How can I download and install
SlopPy?</h3>

<p>SlopPy is a modified version of the Python 2.6.3 interpreter.  I want
to make it easy for people to start using SlopPy, but I haven't yet had
time to create reliable one-click installers for all supported operating
systems.  Currently, the only way to install SlopPy is to download and
compile its source code.  If you don't want to go through this hassle,
please email me at:</p>



<p>and I will try my best to <b>compile a custom version for your
computer</b> and to guide you through the setup process.</p>

<p>The SlopPy source code resides in a <a href="http://github.com/pgbovine/SlopPy/">public GitHub code
repository</a>.  You can check out the latest copy and compile using
these commands:

</p><pre>
git clone git://github.com/pgbovine/SlopPy.git
cd SlopPy
./configure
make
</pre>


<h4>Dependencies</h4>

<p><b>Mac OS X</b>: If you install the 'Xcode developer tools' and 'X11'
packages from your installation DVD, then you should have most of the
software required to compile SlopPy.  It's also a good idea to install
the <a href="http://tiswww.case.edu/php/chet/readline/rltop.html">GNU
readline</a> library before compiling SlopPy, so that your Python
interactive prompt acts more pleasant.</p>

<p><b>Linux</b>: The software needed to compile SlopPy might already
come pre-installed, but in case they're not, here are some useful
packages to install (these names are for Debian-based distros, but it
should be easy to look up the corresponding names in other package
management systems):</p>

<pre>
sudo apt-get install libc6-dev g++ gcc libreadline-dev
</pre>


<p>
It's normal for warning messages like this one to appear when you're
compiling Python:
</p>

<pre>
Failed to find the necessary bits to build these modules:
_bsddb             bsddb185           dbm
dl                 gdbm               imageop
sunaudiodev
To find the necessary bits, look in setup.py in detect_modules() for the module's name.
</pre>

<p>
It just means that certain Python modules cannot be compiled for your
machine, but as long as you see an executable named <tt>python</tt> (or
<tt>python.exe</tt> on Mac OS X) in the SlopPy directory, the build was
successful.
</p>


<h4>Running SlopPy for the first time</h4>

<p> After a successful compile, there should be an executable named
<tt>python</tt> (or <tt>python.exe</tt> on Mac OS X) in the SlopPy
directory.  When you execute that program, you should see an interactive
Python prompt like the following:

</p><pre>
$ ./python.exe 
SlopPy: A Python interpreter that facilitates sloppy, error-tolerant data analysis
Created by Philip Guo (pg@cs.stanford.edu)

Python 2.6.3 (r263:75183, Sep  5 2010, 13:56:04) 
[GCC 4.2.1 (Apple Inc. build 5646)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;
</pre>




<h4>Working with 3rd-party libraries</h4>

<p>SlopPy is designed to work seamlessly with all 3rd-party libraries,
extensions, and tools (e.g., NumPy, SciPy, matplotlib, IPython), as long as they are
compatible with Python 2.6.  <b>You shouldn't need to re-compile any
libraries or extension code.</b></p>

<p>All you need to do is to set the <a href="http://docs.python.org/using/cmdline.html#envvar-PYTHONPATH">PYTHONPATH</a>
environment variable so that SlopPy knows where your libraries and
extensions are installed (alternatively, you can prepend the path onto
the <a href="http://docs.python.org/library/sys.html#sys.path"><tt>sys.path</tt></a>
variable from within your Python script).</p>

<p>You can install 3rd-party libraries in a variety of ways, but if
you're affiliated with a university, I highly recommend downloading a free
academic version of the <a href="http://www.enthought.com/products/epdlibraries.php">Enthought
Python Distribution</a>.  It's a fantastic one-click installer
containing Python 2.6 and over 75 useful libraries.</p>

<p>After installing the Enthought Python Distribution on my Mac OS X
10.6 computer, I can give SlopPy access to all of its installed libraries
by setting <tt>PYTHONPATH</tt> to the appropriate location and then
starting up SlopPy:</p>

<pre>
export PYTHONPATH=/Library/Frameworks/Python.framework/Versions/6.1/lib/python2.6/site-packages
~/SlopPy/python.exe
</pre>

<p>If you're on a 64-bit machine and want to compile a 32-bit x86 SlopPy
binary (e.g., to interoperate with already-installed 32-bit 3rd-party
libraries), you can run this modified configure command before
compiling:</p>

<pre>
# for Mac OS X:
./configure CC="gcc -arch i386" CXX="g++ -arch i386"

# for Linux:
./configure CC="gcc -m32" CXX="g++ -m32"
</pre>

<p>Please let me know if you have troubles getting 3rd-party libraries
working with SlopPy.</p>


<h3>How does SlopPy work?</h3>

<p>The best way to show how SlopPy works is to demonstrate using the
Python interactive prompt.</p>

<h4>Creating NA objects from uncaught exceptions</h4>

<p>When a regular Python interpreter encounters an uncaught exception,
it will crash with a traceback message.  For example, let's try to
execute <tt>x = 1 / 0</tt>:</p>

<pre>
$ python
Python 2.6.1 (r261:67515, Feb 11 2010, 00:51:29) 
[GCC 4.2.1 (Apple Inc. build 5646)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; x = 1 / 0
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ZeroDivisionError: integer division or modulo by zero
</module></stdin></pre>

<p>When SlopPy executes that same statement, it will create a special NA
object to represent the <tt>ZeroDivisionError</tt> and assign it to
<tt>x</tt>:</p>

<pre>
$ ~/SlopPy/python.exe 
SlopPy: A Python interpreter that facilitates sloppy, error-tolerant data analysis
Created by Philip Guo (pg@cs.stanford.edu)

Python 2.6.3 (r263:75183, Sep  5 2010, 13:56:04) 
[GCC 4.2.1 (Apple Inc. build 5646)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; x = 1 / 0
&gt;&gt;&gt; print x
&lt;NA&gt;
</pre>

<p>NA stands for "Not Available", which is a term statisticians use to
indicate missing data.</p>

<h4>Treatment of NA values</h4>

<p>When an NA value appears in most types of expressions, SlopPy simply
propagates it to the expression's result.  The intuition here is that if
an operand has an unknown (NA) value, then the result should also be
unknown.  For example:</p>

<pre>
&gt;&gt;&gt; x = 1 / 0
&gt;&gt;&gt; print x
&lt;NA&gt;
&gt;&gt;&gt; y = 5   
&gt;&gt;&gt; z = x + y
&gt;&gt;&gt; print z
&lt;NA&gt;
</pre>

<p>Pretty much anything you do to an NA value just propagates it.  Here
are some more examples:</p>

<pre>
&gt;&gt;&gt; x = 1 / 0
&gt;&gt;&gt; x
&lt;NA&gt;
# Unary operation:
&gt;&gt;&gt; -x
&lt;NA&gt;
# Binary operation:
&gt;&gt;&gt; x + 5
&lt;NA&gt;
# Element indexing:
&gt;&gt;&gt; x[1]
&lt;NA&gt;
&gt;&gt;&gt; lst = [1, 2, 3]
&gt;&gt;&gt; lst[x]
&lt;NA&gt;
# Field access:
&gt;&gt;&gt; x.field
&lt;NA&gt;
# Function call:
&gt;&gt;&gt; x(1, 2, 3)
&lt;NA&gt;
# Method call:
&gt;&gt;&gt; x.method('a', 'b', 'c')
&lt;NA&gt;
# Comparison:
&gt;&gt;&gt; x &gt; 5
&lt;NA&gt;
&gt;&gt;&gt; x &gt;&gt; x == 5
&lt;NA&gt;
</pre>

<p>Iterating over an NA value terminates instantly (to prevent infinite
loops):</p>

<pre>
&gt;&gt;&gt; for line in open(NONEXISTENT_FILE):
...     print line
... 
&gt;&gt;&gt;
</pre>

<p>In the above example, the name <tt>NONEXISTENT_FILE</tt> is unbound,
so its value is NA; the NA propagates as the result of the
<tt>open()</tt> call, and iterating over it terminates instantly.</p>

<p>Mutating an NA value does nothing:</p>

<pre>
&gt;&gt;&gt; x[1] = 5
&gt;&gt;&gt; x.field = 5
</pre>

<p>Iterators and generators skip over NA values rather than yielding
them.  The intuition here is that when a mostly-correct script is
executing, most elements in collections are legal values.  Thus, the
results of aggregate statistics computed via iteration (e.g., summation)
should not be corrupted by NA values.  e.g.,:</p>

<pre>
&gt;&gt;&gt; x = 1 / 0
&gt;&gt;&gt; x
&lt;NA&gt;
&gt;&gt;&gt; lst = [1, 2, 3]
&gt;&gt;&gt; lst.append(x)
&gt;&gt;&gt; lst.append(4)
&gt;&gt;&gt; lst.append(x)
&gt;&gt;&gt; lst
[1, 2, 3, &lt;NA&gt;, 4, &lt;NA&gt;]
&gt;&gt;&gt; for e in lst:
...     print e
... 
1
2
3
4
</pre>

<p>Special treatment for conjunctions and disjunctions:</p>

<pre>
&gt;&gt;&gt; x and False
False
&gt;&gt;&gt; False and x
False
&gt;&gt;&gt; x or True
True
&gt;&gt;&gt; True or x
True
</pre>

<p>If a branch condition is NA, then SlopPy takes an arbitrary side
(technically, neither is correct).  In most circumstances, it takes the
'true' side of the branch:</p>

<pre>
&gt;&gt;&gt; x = 1 / 0
&gt;&gt;&gt; if x:
...     print "TRUE BRANCH"
... else:
...     print "FALSE BRANCH"
... 
TRUE BRANCH
</pre>


<h4>Warning logs</h4>

<p>While the target script is executing, SlopPy outputs two warning logs
to the current working directory: <tt>slop_verbose.log</tt>
(human-readable text) and <tt>slop_binary.log</tt> (pickled Python
objects for consumption by other scripts).  These logs contain the
context of each exception (e.g., stack traceback and local variable
values) and an indication of how NA values propagate throughout
execution.  Please email me if you have questions about how to
understand or use these logs.</p>

<hr/>

<small>

</small><p>SlopPy is created and maintained by <a href="http://www.stanford.edu/~pgbovine/">Philip Guo</a></p>



<p>Last updated: 2010-09-30</p>



</body>
</div></body></html>