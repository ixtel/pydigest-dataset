<html><body><div><div class="post-text" itemprop="text">
<p>So after a lot of debugging and trial and error looks like I found the issue in case anyone else is interested or will have the same problem.</p>

<p>I was also adding the folder to the zip and looks like it didn't liked the folders being compressed with ZIP_DEFLATED. What I did was to manually set the compression to ZIP_STORED for folders and to ZIP_DEFLATED for files and after this it worked. Interesting how Java knew to do this automatically behind the scenes, or at least I guess it does as the Java version is kind of the same (iterate over folders/files and add them to the ZIP) except I just use the default values (so I never explicitly set the compression type for anything).</p>

<p>So basically my code (the version that didn't worked) was something like this:</p>

<pre><code>for dir_path, dir_names, file_names in os.walk(absolute_folder_path, compression=zipfile.ZIP_DEFLATED):
    ...
    # Add folder to ZIP
    f_zip.write(absolute_dir_path, arcname=relative_dir_path)

    for file_name in file_names:
        ...
        # Add file to ZIP
        f_zip.write(absolute_file_path, arcname=relative_file_path)
</code></pre>

<p>and the fix was this one:</p>

<pre><code>for dir_path, dir_names, file_names in os.walk(absolute_folder_path):
    ...
    # Add folder to ZIP
    f_zip.write(absolute_dir_path, arcname=relative_dir_path, compress_type=zipfile.ZIP_STORED)

    for file_name in file_names:
        ...
        # Add file to ZIP
        f_zip.write(absolute_file_path, arcname=relative_file_path, compress_type=zipfile.ZIP_DEFLATED)
</code></pre>
    </div>
    </div></body></html>