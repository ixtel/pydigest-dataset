<html><body><div><div id="features">
<h2>Features</h2>
<p>Sometimes (mainly in test) we need to convert asynchronous functions to normal,
synchronous functions and run it synchronously. It can be done by
<tt><span class="pre">ayncio.get_event_loop().run_until_complete()</span></tt>, but it’s quite long…</p>
<p>Syncer makes this conversion easy.</p>
<ul>
<li>Convert coroutine-function (defined by <tt>aync def</tt>) to normal (synchronous) function</li>
<li>Run coroutines synchronously</li>
<li>Support both <tt>async def</tt> and decorator (<tt>@asyncio.coroutine</tt>) style</li>
</ul>
</div>
<div id="install">
<h2>Install</h2>
<p>At the command line:</p>
<pre>$ pip install syncer
</pre>
<p>Or, if you have virtualenvwrapper installed:</p>
<pre>$ mkvirtualenv syncer
$ pip install syncer
</pre>
</div>
<div id="usage">
<h2>Usage</h2>
<p>This module has only one function: <tt>syncer.sync</tt>.</p>
<pre><span class="kn">from</span> <span class="nn">syncer</span> <span class="kn">import</span> <span class="n">sync</span>
<span class="n">async</span> <span class="k">def</span> <span class="nf">async_fun</span><span class="p">():</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">sync</span><span class="p">(</span><span class="n">async_fun</span><span class="p">)</span>  <span class="c1"># now b is synchronous</span>
<span class="k">assert</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">b</span><span class="p">()</span>
</pre>
<p>To test the above <tt>async_fun</tt> in asynchronous test functions:</p>
<pre><span class="kn">import</span> <span class="nn">unittest</span>

<span class="k">class</span> <span class="nc">TestA</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="c1"># ``sync`` can be used as decorator.</span>
    <span class="c1"># The decorated function becomes synchronous.</span>
    <span class="nd">@sync</span>
    <span class="n">async</span> <span class="k">def</span> <span class="nf">test_async_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">await</span> <span class="n">async_fun</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
</pre>
<p>Or, keep test synchronous, get result synchronously:</p>
<pre><span class="k">class</span> <span class="nc">TestA</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_async_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># run coroutine and return the result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sync</span><span class="p">(</span><span class="n">async_fun</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># This is equivalent to below, just a shortcut</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_fun</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
</pre>
</div>
</div></body></html>