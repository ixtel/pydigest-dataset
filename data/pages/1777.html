<html><body><div><div id="installation">
<h2>installation</h2>
<div id="basic-installation">
<h3>basic installation</h3>
<pre>pip install charitycheck
</pre>
<p>simple as that, you’re now good to go! But make sure to read on for
(very important) notices about module useage and getting good
performance.</p>
</div>
<div id="disclaimer-about-and-maintaining-up-to-date-information">
<h3>Disclaimer About and Maintaining Up-to-date Information</h3>
<div id="returned-charity-status-may-not-be-up-to-date">
<h4>Returned charity status may not be up-to-date</h4>
<p>This module uses the IRS publication 78 to perform its checks against
charity EIN’s. Essentially, the module downloads a copy of IRS Pub 78,
unzips the file, converts the data to a quickly searchable dbm file, and
then provides some functions to interface with this file. That means
that the module searches its local version of Publication 78, thus if
you check for a new nonprofit’s charity status, it might not yet be in
your database. Similarly, if a nonprofit recently lost its status, your
database might not yet reflect that either.</p>
</div>
<div id="how-to-update-your-charity-information">
<h4>How to update your charity information</h4>
<p>To fix the above problem, you should regularly update your dbm file.
This can be done by running this module as a script from the
commandline:</p>
<pre>python /path/to/charitycheck.py
</pre>
<p>(in the above command, python should be whatever command your system
uses to run python scripts, of course)</p>
<p>or importing the function <tt>make_dbm</tt> and running it without arguments:</p>
<pre><span class="kn">from</span> <span class="nn">charitycheck</span> <span class="kn">import</span> <span class="n">make_dbm</span>

<span class="n">make_dbm</span><span class="p">()</span>
</pre>
<p>So that you don’t forget to do this regularly, we recommend setting up a
cron job to do this at least less than every two weeks (14 days). You
must be the judge of how important it is to make the most up to date
information on these nonprofit organizations available to your module.</p>
</div>
<div id="auto-updating-and-performance">
<h4>Auto updating and performance</h4>
<p>Because having up-to-date information from the IRS is so important,
we’ve added a way for python to internally track how up-to-date your
copy of publication 78 is. If you’re local copy is 15 or more days out
of date, then the module will automatically download a new copy and
recreate the database when one of the public functions in it is called
with the argument <tt>optimize=False</tt>, which they are all set to by
default; however, creating the database can take up to several minutes,
so <em>not regularly updating your database will unpredictably and severely
affect the performance of this module, on top of increasingly jeopardize
the validity of its results</em>.</p>
<p>Only you can decide how often you should update your database, but for
this reason we suggest at least once every 14 days.</p>
</div>
</div>
<div id="note-on-performance">
<h3>Note on performance:</h3>
<p>The module uses python’s anydbm module, so for performance reasons you
should make sure that you have a fast implementation of the dbm format
installed to which python has access. Simply try the following imports
to check:</p>
<pre><span class="kn">import</span> <span class="nn">dbm</span> <span class="c1"># the classic new dbm implementation</span>
</pre>
<pre><span class="kn">import</span> <span class="nn">gdbm</span> <span class="c1"># gnu dbm implementation</span>
</pre>
<pre><span class="kn">import</span> <span class="nn">dbhash</span> <span class="c1"># dbm implementation found on windows in python2.7</span>
</pre>
<p>If any of these imports work, you’re good to go. If none of them work,
this module will still operate for you, but it will use the <tt>dumbdbm</tt>
implementation, and could be much slower. Consider getting one of the
above dbm implementations in python (dbhash is also deprecated and not
included in python 3).</p>
</div>
</div>
<div id="basic-useage">
<h2>basic useage</h2>
<p>The following are the public functions make available by the module:</p>
<pre><span class="n">make_dbm</span><span class="p">()</span>
</pre>
<p>Downloads publication 78 from the IRS, unzips it, saves the txt to disk,
then converts it into a dbm file for quick useage.</p>
<pre><span class="n">get_nonprofit_data</span><span class="p">(</span>
    <span class="n">ein</span><span class="p">,</span> <span class="c1"># the nonprofit organization's ein number</span>
    <span class="n">optimize</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre>
<p>Given an EIN, retrieves the pipe delimited string data,
<tt>"name|city|state|country|deductability code"</tt> from the local copy of
publication 78 if the organization exists, otherwise it raises a key
error.</p>
<p>If <tt>optimize=False</tt>, as by default, then it also checks to make sure
the local copy of publication 78 is no more than 15 days out of date,
calling <tt>make_dbm()</tt> if the data is more out of date than 15 days.</p>
<pre><span class="n">verify_nonprofit</span><span class="p">(</span>
    <span class="n">ein</span><span class="p">,</span> <span class="c1"># the nonprofit organization's ein number</span>
    <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># name of the organization **as it appears in publication 78**</span>
    <span class="n">city</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># name of the city the organization is based in</span>
    <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># state abbreviation for the organization</span>
    <span class="n">deductability_code</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># the deductability code of the organization</span>
        <span class="c1"># (see 'explanation of data and sources' in README.md)</span>
    <span class="n">optimize</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre>
<p>takes data about the nonprofit organization as outlined in its call
signature. The EIN must always be provided, all data should be given as
strings. Every piece of information provided besides the EIN is
optional. The function will take the provided non-None data, and check
it against organizations in the database. If an organization is found
matching the provided arguments, then <tt>verify_nonprofit</tt> returns true,
else it returns false. The optimize parameter behaves the same as in
<tt>get_nonprofit_data</tt>.</p>
<pre><span class="n">get_deductability_code</span><span class="p">(</span>
    <span class="n">ein</span><span class="p">,</span> <span class="c1"># the nonprofit organization's ein number</span>
    <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># name of the organization **as it appears in publication 78**</span>
    <span class="n">city</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># name of the city the organization is based in</span>
    <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># state abbreviation for the organization</span>
    <span class="n">optimize</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre>
<p>takes data about the nonprofit organization as outlined in its call
signature, the same as with <tt>verify_nonprofit</tt> except that it doesn’t
accept a deductability code argument. Checks the provided data against
organizations in the database, if a match is found, it returns the
deductability code, if no match is found, it returns the empty string.
The optimize parameter behaves the same as the optimize parameter for
<tt>get_nonprofit_data</tt>.</p>
<p>Of course, this function can also be used to replace
<tt>verify_nonprofit</tt> in a more extensible way, by coercing the string
values returned by <tt>get_deductability_code</tt> to booleans.</p>
</div>
<div id="explanation-of-data-and-sources">
<h2>explanation of data and sources</h2>
<p>The data used in this module is generated from IRS publication 78,
located at <a href="http://apps.irs.gov/app/eos/forwardToPub78Download.do" rel="nofollow">http://apps.irs.gov/app/eos/forwardToPub78Download.do</a>.</p>
<p>The format of the file at that download site is expected to be a zipped
folder, containing a text file, whose names are both
data-download-pub78.zip and data-download-pub78.txt respectively, with
data-download-pub78.txt being a textfile with a charity on each line,
and every line having the format:</p>
<pre>EIN|name|city|state|country|deductability code
</pre>
<p>If any of these assumptions change, the code may need to change
accordingly</p>
<p>From the IRS website, here is an explanation of the deductability status
codes:</p>
<pre>-----------------------------------------------------------------------------------------------
| Code    |    Type of organization and use of contribution.    |    Deductibility Limitation |
-----------------------------------------------------------------------------------------------
| PC      |    A public charity.                                |    50%                      |
-----------------------------------------------------------------------------------------------
| POF     |    A private operating foundation.                  |    50%                      |
-----------------------------------------------------------------------------------------------
| PF      |    A private foundation.                            |    30% (generally)          |
-----------------------------------------------------------------------------------------------
| GROUP   |    Generally, a central organization holding a group|                             |
|         |    exemption letter, whose subordinate units covered|                             |
|         |    by the group exemption are also eligible to      | Depends on various factors. |
|         |    receive tax-deductible contributions, even though|                             |
|         |    they are not separately listed.                  |                             |
-----------------------------------------------------------------------------------------------
| LODGE   |    A domestic fraternal society, operating under the|                             |
|         |    lodge system, but only if the contribution is to |    30%                      |
|         |    be used exclusively for charitable purposes.     |                             |
-----------------------------------------------------------------------------------------------
| UNKWN   |    A charitable organization whose public charity   | Depends on various factors. |
|         |    status has not been determined.                  |                             |
-----------------------------------------------------------------------------------------------
| EO      |    An organization described in section 170(c) of   |                             |
|         |    the Internal Revenue Code other than a public    | Depends on various factors. |
|         |    charity or private foundation.                   |                             |
-----------------------------------------------------------------------------------------------
| FORGN   |    A foreign-addressed organization. These are      |                             |
|         |    generally organizations formed in the United     |                             |
|         |    States that conduct activities in foreign        |                             |
|         |    countries. Certain foreign organizations that    | Depends on various factors. |
|         |    receive charitable contributions deductible      |                             |
|         |    pursuant to treaty are also included, as are     |                             |
|         |    organizations created in U.S. possessions.       |                             |
-----------------------------------------------------------------------------------------------
| SO      |    A Type I, Type II, or functionally integrated    |    50%                      |
|         |    Type III supporting organization.                |                             |
-----------------------------------------------------------------------------------------------
| SONFI   |    A non-functionally integrated Type III           |    50%                      |
|         |    supporting organization.                         |                             |
-----------------------------------------------------------------------------------------------
| SOUNK   |    A supporting organization, unspecified type.     |    50%                      |
-----------------------------------------------------------------------------------------------

# contributors

So far this module has been developed only by Nicholas Lourie, but if other people are interested in helping to extend it to a larger framework for dealing with nonprofit data, pull requests are welcome!
</pre>
</div>


</div></body></html>