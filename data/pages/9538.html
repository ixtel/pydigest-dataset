<html><body><div><p>beanstalkclient is a simple beanstalkd client library for Python.</p>








<div id="beanstalkclient">
<h2>beanstalkclient</h2>
<p>beanstalkclient is a simple beanstalkd client library for Python. beanstalkd is a fast, distributed, in-memory workqueue service.</p>
<p>beanstalkclient on Python 2 and Python 3 is supported.</p>
</div>
<div id="usage">
<h2>Usage</h2>
<p>Here is a short example:</p>
<pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">beanstalk</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bsc</span> <span class="o">=</span> <span class="n">beanstalk</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">'127.0.0.1'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">11300</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">beanstalk</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">'Hi!'</span><span class="p">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">job</span> <span class="o">=</span> <span class="n">beanstalk</span><span class="o">.</span><span class="n">reserve</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">job</span><span class="o">.</span><span class="n">body</span>
<span class="n">Hi</span><span class="err">!</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">job</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre>
<p>Here is a hashring example:</p>
<pre><span class="c1"># ==================== Terminal ======================</span>
<span class="c1"># beanstalkd -l 127.0.0.1 -p 11300</span>
<span class="c1"># beanstalkd -l 127.0.0.1 -p 11301</span>
<span class="c1"># beanstalkd -l 127.0.0.1 -p 11302</span>
<span class="c1"># ========== open three beanstalkd services ==========</span>

<span class="kn">import</span> <span class="nn">beanstalk</span>

<span class="n">servers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'127.0.0.1:11300'</span><span class="p">,</span>
    <span class="s1">'127.0.0.1:11301'</span><span class="p">,</span>
    <span class="s1">'127.0.0.1:11302'</span>
<span class="p">]</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'127.0.0.1:11300'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'127.0.0.1:11301'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">'127.0.0.1:11302'</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>

<span class="n">bsc</span> <span class="o">=</span> <span class="n">beanstalk</span><span class="o">.</span><span class="n">HashRingConnection</span><span class="p">(</span><span class="n">servers</span><span class="o">=</span><span class="n">servers</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">tube_name</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">i</span>
    <span class="n">bsc</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">tube_name</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="s1">'Hi #</span><span class="si">%s</span><span class="s1">! put to </span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">bsc</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">bsc</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
    <span class="n">bsc</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">tube_name</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">i</span>
        <span class="n">bsc</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="n">tube_name</span><span class="p">)</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">bsc</span><span class="o">.</span><span class="n">reserve</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="s2">"this bsc is </span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">bsc</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">bsc</span><span class="o">.</span><span class="n">port</span><span class="p">))</span>
        <span class="n">job</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre>
<p>For more information, see the <a href="https://achais.github.io/beanstalkclient" rel="nofollow">tutorial</a>, which will explain most everything.</p>
</div>
</div></body></html>