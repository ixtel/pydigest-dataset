<html><body><div><div class="post-body entry-content" id="post-body-6026467422630184935" itemprop="description articleBody"><p>
I've entered the realm of async programming in Python about two years ago. I've started with Tornado framework and my first task was to design REST API against backend powered by ElasticSearch. Luckily, ElasticSearch speaks HTTP and Tornado comes with async http client - no worries. Later on, I needed to speak to Postgres and found </p><a href="https://pypi.python.org/pypi/Momoko/2.0.0">Momoko</a><p> project that wraps async functionality of psycopg2 for Tornado. It was a bit rusty and dusty, but with some patching worked well.
</p><p>
Next came MySQL... well, this is when I started to ask myself questions. The thing is that I did not find anything stable for MySQL. Tornado wiki </p><a href="https://github.com/tornadoweb/tornado/wiki/Links">lists</a><p> couple of projects - first has unclear license and too many </p><a href="https://github.com/abael/amysql">bold warnings</a><p>, the other one did not had any releases since 2009. At the end I've ended up using ad-hock pooling software based on good old MySQLdb, plus ThreadExecutor from </p><code>concurrent.futures</code><p> package. Fortunately my project did go further then prototype.
</p><p>
Time went on as I decided to rewrite Momoko to use Tornado's new </p><a href="http://tornado.readthedocs.org/en/latest/concurrent.html">Future</a><p> interface. After rewrite I run some benchmarks and the </p><a href="https://github.com/FSX/momoko/blob/master/perf_test.py">results</a><p> were quite surprising. In fact async code introduces quite a bit of overhead. So if your database is very fast and you don't open huge amount of connections (less then 100), async code has actually more overhead then threaded code. And obviously you are not going to open hundreds of database connections from a single Tornado process. I.e. in real life, connection handling overhead will be negligible compared to database response.
</p><p>
So do we really need native async adapters for every SQL database? Looks like we don't. And that's probably why there are no any Tornado adapters for neither MSSQL nor Oracle.
</p><p>
What I really liked about Momoko is its connection pooling. It behaves like... well, like a good connection pooling that you get from SQLAchemy for example. So I think the ultimate solution for async connectivity to SQL databases would be async connection pool project that would expose native Future-based interface and use ThreadExecutor behind the scenes to utilize any Python DB2ABI driver. This will unleash async power to any of the existing DB2API modules. 
</p><p>
Sounds like an idea for the next open source project. Unless there already exist one. Did I miss it?
</p><p/>
</div>
</div></body></html>