<html><body><div><div class="section">
              <h1>django-shoogie 0.8</h1>

              


<p>Log server errors to database</p>








<p>Shoogie is a small django application for logging exceptions
to a table in the database, along with django’s standard HTML debug
response.  It is intended to be a lightweight alternative to
<a href="http://pypi.python.org/pypi/django-sentry" rel="nofollow">django-sentry</a>, inspired by <a href="http://stackoverflow.com/questions/7130985/#answer-7579467" rel="nofollow">this answer on stackoverflow</a>.</p>
<p>Shoogie has been used in production since March 2012.</p>
<p>The name Shoogie is a diminutive of the Hebrew word <em>sh’giah</em> (שגיאה), which means
‘error.’  <em>Shoogie</em> (שוגי) also happens to be the name of a popular kids’ candy snack in
Israel.  It’s our hope that django-shoogie will make dealing with server errors a
sweeter experience.</p>
<div id="key-features">
<h2>Key Features</h2>
<ul>
<li>Simple, server-error specific logging</li>
<li>Logs django’s familiar technical 500 response</li>
<li>Uses django’s standard admin interface</li>
<li>Easy retrieval by user, exception, file, function</li>
<li>Easy extraction of users’ email addresses</li>
<li>Logging handler operates outside transaction management</li>
<li>Configurable exception ignores</li>
<li>Configurable traceback filtering</li>
</ul>
</div>
<div id="version-compatibility">
<h2>Version Compatibility</h2>
<p>django-shoogie is compatible with Django versions 1.3 to 1.6</p>
</div>
<div id="installation">
<h2>Installation</h2>
<p>To install shoogie:</p>
<pre>pip install django-shoogie
</pre>
<p>To use shoogie in a django project, add it to the <tt>INSTALLED_APPS</tt> and
add the shoogie logging handler to <tt>LOGGING</tt> in your <tt>settings.py</tt>. as
below.  You must add an entry for the shoogie handler to the <tt>handlers</tt> section,
and then add it to the list of handlers for the <tt>django.request</tt> logger.</p>
<p>Make sure to run <tt>syncdb</tt> after adding shoogie to create the
<tt>shoogie_servererror</tt> table.</p>
<p>Depending on which Django version you use, and your particular setup,
your logging configuration may look different than this.
The Shoogie-specific additions are indicated with comments.</p>
<p>The <tt>django.contrib.admin</tt> app must also be installed to view
the errors logged via django’s admin interface:</p>
<pre>INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.sessions',
    'django.contrib.admin',
    'django.contrib.admindocs',
    'shoogie',                      # &lt;---
    # ...
)

LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'filters': {
        'require_debug_false': {
            '()': 'django.utils.log.RequireDebugFalse',
        },
    },
    'handlers': {
        # THIS IS THE HANDLER TO ADD #
        'shoogie': {
            'level': 'ERROR',
            'filters': ['require_debug_false'],
            'class': 'shoogie.log_handler.DatabaseLogHandler',
        },
        'mail_admins': {
            'level': 'ERROR',
            'filters': ['require_debug_false'],
            'class': 'django.utils.log.AdminEmailHandler',
        },
    },
    'loggers': {
        'django.request': {
            # THIS IS WHERE TO SPECIFY THE NEW SHOOGIE HANDLER #
            'handlers': ['shoogie', 'mail_admins'],
            'level': 'ERROR',
            'propagate': True,
        },
    },
}
</pre>
<div>
<p>Note</p>
<p>The require_debug_false filter is available in Django &gt;= 1.4.</p>
<p>Django 1.3 never logs 500 server errors if DEBUG=True.</p>
</div>
<div id="upgrading-from-shoogie-0-6">
<h3>Upgrading from shoogie 0.6</h3>
<p>Shoogie 0.7 uses a logging handler instead of middleware.
Shoogie’s middleware still works, but switching to the logging handler
configuration is recommended.  Remove the Shoogie middleware from
<tt>MIDDLEWARE_CLASSES</tt> in settings.py and follow the logging configuration
instructions above.  If both the middleware and the logging handler are
configured, every error will be logged twice!</p>
</div>
</div>
<div id="configuration">
<h2>Configuration</h2>
<p>Shoogie can be configured with the following settings:</p>
<div id="settings-shoogie-ignore-exceptions">
<h3>settings.SHOOGIE_IGNORE_EXCEPTIONS</h3>
<p>A sequence of absolute dotted paths of exceptions which it should not log.
These exceptions and their subclasses will be ignored.
The default value is:</p>
<pre>SHOOGIE_IGNORE_EXCEPTIONS = (
    'django.http.Http404',
    'django.exceptions.PermissionDenied',
)
</pre>
</div>
<div id="settings-shoogie-traceback-exclude">
<h3>settings.SHOOGIE_TRACEBACK_EXCLUDE</h3>
<p>A sequence of regular expression pairs (filename, funcname) used to filter
the traceback included in django’s debug page.  This is intended to
eliminate the time needed to render, store, and display traceback frames
which aren’t useful.  The default value is:</p>
<pre>SHOOGIE_TRACEBACK_EXCLUDE = (
    ('/django/core/handlers/base.py$', '^get_response$'),
    ('/django/template/', 'render'),
)
</pre>
</div>
</div>
<div id="use">
<h2>Use</h2>
<p>Errors logged by shoogie can be viewed via django’s admin interface at
<tt>/admin/shoogie/servererror/</tt>.</p>
<p>To view the data fields stored in the log entry, click in the first column.</p>
<p>To visit the url in which the error occurred, click the ‘path’ column.
This won’t work if the host is inaccessible, if the request method was
something other than GET, or if the path isn’t really an HTTP request path
(see below).</p>
<p>If a user is logged with an entry, a link to the admin detail page for the
user will be displayed in the admin list.</p>
<p>Click the ‘debug’ link to view the django-generated ‘technical response’
(debug page) for the exception.</p>
<p>To get a list of users and email addresses who encountered a set of errors,
select the log entries using the checkboxes on the left, then select “Get
user email addresses for selected errors” from the ‘Action’ drop-down menu
and click the ‘Go’ button.</p>
<p>To mark a set of errors as resolved or as not resolved, select the entries
in question and pick the appropriate action from the drop-down as above.</p>
</div>
<div id="api">
<h2>API</h2>
<p>Shoogie can also be used to log exceptions directly.  This could be useful
for exceptions occurring in back-end processes such as long-running
calculations, cron-jobs, and celery workers:</p>
<pre>from shoogie import logger
logger.log_exception([request, [exc_type, exc_val, tb]])
</pre>
<p>Logs an exception to the db.  If <tt>exc_type</tt>, <tt>exc_val</tt>, and <tt>tb</tt>
aren’t supplied, they will be retrieved using <tt>sys.exc_info()</tt>.
The django technical debug page stored will display the traceback as with
errors occuring in normal views.</p>
<p>If <tt>request</tt> is given, whatever request information is present will also
be saved in the log entry.  <tt>request</tt> should be an object which implements,
partially or wholly, the same interface as a <tt>django.http.HttpRequest</tt>.</p>
<p>For conveniently logging exceptions outside the context of an HTTP
request, <tt>log_exception</tt> can be passed a string instead, which will be
logged as the request path.  Make sure the logging is done outside any
transaction which might be reversed by the exception being logged.  A
general pattern as follows is recommended:</p>
<pre>try:
    with transaction.commit_on_success():
        "insert your processing here"
except:
    logger.log_exception('Description')
</pre>
<p>As of version 0.7 it is possible to log errors to shoogie via the standard
<tt>logging</tt> module, using any logger for which shoogie is configured as a
handler.  For example, with the logging configuration described in
<a href="#installation" rel="nofollow">Installation</a>, above, the <tt>django.request</tt> logger can be used to both log
an exception to shoogie and send email to the admins:</p>
<pre>import logging
django_logger = logging.getLogger('django.request')
django_logger.error('Description', exc_info=True)
</pre>
</div>



<a name="downloads"> </a>


<ul class="nodot">
  <li><strong>Downloads (All Versions):</strong></li>
  <li>
    <span>0</span> downloads in the last day
  </li>
  <li>
    <span>40</span> downloads in the last week
  </li>
  <li>
    <span>225</span> downloads in the last month
  </li>
</ul>









            </div>


          </div></body></html>