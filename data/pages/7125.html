<html><body><div><section class="entry">
<p class="fsb-clear"/><p><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_dataset.jpg"><img class="aligncenter wp-image-3177" src="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_dataset.jpg" alt="time_scrape_dataset" srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_dataset-300x228.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_dataset.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a>Since this is a computer vision and OpenCV blog, you might be wondering: <em>“Hey Adrian, why in the world are you talking about scraping images?”</em></p>
<p>Great question.</p>
<p><em><strong>The reason is because image acquisition is one of the most under-talked about subjects in the computer vision field!</strong></em></p>
<p>Think about it. Whether you’re leveraging machine learning to train an image classifier, building an image search engine to find relevant images in a collection of photos, or simply developing your own hobby computer vision application — <strong><em>it all starts with the images themselves. </em></strong></p>
<p>And where do these images come from?</p>
<p>Well, if you’re lucky, you might be utilizing an existing image dataset like <a href="http://www.vision.caltech.edu/Image_Datasets/Caltech256/" target="_blank">CALTECH-256</a>, <a href="http://www.image-net.org/" target="_blank">ImageNet</a>, or <a href="http://yann.lecun.com/exdb/mnist/" target="_blank">MNIST</a>.</p>
<p>But in the cases where you can’t find a dataset that suits your needs (or when you want to create your own custom dataset), you might be left with the task of <em>scraping and gathering your images</em>. While scraping a website for images isn’t <em>exactly</em> a computer vision technique, <strong><em>it’s still a good skill to have in your tool belt.</em></strong></p>
<p>In the remainder of this blog post, I’ll show you how to use the <a href="http://scrapy.org/" target="_blank">Scrapy framework</a> and the Python programming language to scrape images from webpages.</p>
<p>Specifically, we’ll be scraping <em><strong>ALL</strong></em> <em><a href="http://time.com/" target="_blank">Time.com</a></em> magazine cover images. We’ll then use this dataset of magazine cover images in the next few blog posts as we apply a series of image analysis and computer vision algorithms to better explore and understand the dataset.</p>

<h2>Installing Scrapy</h2>
<p>I actually had a bit of a problem installing <a href="http://scrapy.org/" target="_blank">Scrapy</a> on my OSX machine — no matter what I did, I simply could not get the dependencies installed properly (flashback to trying to install OpenCV for the first time as an undergrad in college).</p>
<p>After a few hours of tinkering around without success, I simply gave up and <strong>switched over to my Ubuntu system </strong>where I used <strong>Python 2.7</strong>.<strong> </strong>After that, installation was a breeze.</p>
<p>The first thing you’ll need to do is install a few dependencies to help Scrapy parse documents (again, keep in mind that I ran these commands on my <i>Ubuntu</i> system):</p>

		<div id="crayon-56d58fc012f6f973498822" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc012f6f973498822-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-r">get</span><span class="crayon-h"> </span><span class="crayon-e">install </span><span class="crayon-v">libffi</span><span class="crayon-o">-</span><span class="crayon-i">dev</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012f6f973498822-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-r">get</span><span class="crayon-h"> </span><span class="crayon-e">install </span><span class="crayon-v">libssl</span><span class="crayon-o">-</span><span class="crayon-i">dev</span></p><p class="crayon-line" id="crayon-56d58fc012f6f973498822-3"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-r">get</span><span class="crayon-h"> </span><span class="crayon-e">install </span><span class="crayon-v">libxml2</span><span class="crayon-o">-</span><span class="crayon-e">dev </span><span class="crayon-v">libxslt1</span><span class="crayon-o">-</span><span class="crayon-v">dev</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Note: </strong>This next step is optional, <em><strong>but I</strong> <strong>highly suggest you do it</strong></em>.</p>
<p>I then used <a href="https://virtualenv.pypa.io/en/latest/" target="_blank">virtualenv</a> and <a href="https://virtualenvwrapper.readthedocs.org/en/latest/" target="_blank">virtualenvwrapper</a> to create a Python virtual environment called 
			<span id="crayon-56d58fc012f79459964984" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">scrapy</span></span></span>  to keep my system 
			<span id="crayon-56d58fc012f7d952644636" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">site</span><span class="crayon-o">-</span><span class="crayon-v">packages</span></span></span>  independent and sequestered from the new Python environment I was about to setup. Again, this is optional, but if you’re a 
			<span id="crayon-56d58fc012f80595008295" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">virtualenv</span></span></span>  user, there’s no harm in doing it:</p>

		

<p>In either case, now we need to install Scrapy along with <a href="https://python-pillow.github.io/" target="_blank">Pillow</a>, which is a requirement if you plan on scraping actual binary files (such as images):</p>

		<div id="crayon-56d58fc012f87741084320" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc012f87741084320-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-i">pillow</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012f87741084320-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">scrapy</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Scrapy should take a few minutes to pull down its dependencies, compile, and and install.</p>
<p>You can test that Scrapy is installed correctly by opening up a shell (accessing the 
			<span id="crayon-56d58fc012f8b315715957" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">scrapy</span></span></span>  virtual environment if necessary) and trying to import the 
			<span id="crayon-56d58fc012f8e458429528" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">scrapy</span></span></span>  library:</p>

		<div id="crayon-56d58fc012f92607027953" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc012f92607027953-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012f92607027953-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-v">scrapy</span></p><p class="crayon-line" id="crayon-56d58fc012f92607027953-3"><span class="crayon-o">&gt;&gt;&gt;</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>If you get an import error (or any other error) it’s likely that Scrapy was not linked against a particular dependency correctly. Again, I’m no Scrapy expert so I would suggest consulting the <a href="http://scrapy.org/doc/" target="_blank">docs</a> or posting on the <a href="http://scrapy.org/community/" target="_blank">Scrapy community</a> if you run into problems.</p>
<h2>Creating the Scrapy project</h2>
<p>If you’ve used the <a href="https://www.djangoproject.com/" target="_blank">Django web framework</a> before, then you should feel right at home with Scrapy — at least in terms of project structure and the Model-View-Template pattern; although, in this case it’s more of a <em>Model-Spider</em> pattern.</p>
<p>To create our Scrapy project, just execute the following command:</p>

		<div id="crayon-56d58fc012f96769199284" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc012f96769199284-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">scrapy </span><span class="crayon-e">startproject </span><span class="crayon-v">timecoverspider</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>After running the command you’ll see a 
			<span id="crayon-56d58fc012f99755959626" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">timecoverspider</span></span></span>  in your current working directory. Changing into the 
			<span id="crayon-56d58fc012f9c036142388" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">timecoverspider</span></span></span> directory, you’ll see the following Scrapy project structure:</p>

		<div id="crayon-56d58fc012fa0699701199" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc012fa0699701199-1"><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-e">.cfg</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fa0699701199-2"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">timecoverspider</span></p><p class="crayon-line" id="crayon-56d58fc012fa0699701199-3"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">__init__</span><span class="crayon-e">.py</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fa0699701199-4"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">items</span><span class="crayon-e">.py</span></p><p class="crayon-line" id="crayon-56d58fc012fa0699701199-5"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">pipelines</span><span class="crayon-e">.py</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fa0699701199-6"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">settings</span><span class="crayon-e">.py</span></p><p class="crayon-line" id="crayon-56d58fc012fa0699701199-7"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">spiders</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fa0699701199-8"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-v">__init__</span><span class="crayon-e">.py</span></p><p class="crayon-line" id="crayon-56d58fc012fa0699701199-9"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-v">coverspider</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-c"># (we need to manually create this file)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>In order to develop our <em>Time</em> magazine cover crawler, we’ll need to edit the following files two files: 
			<span id="crayon-56d58fc012fa4141795982" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">items</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  and 
			<span id="crayon-56d58fc012fa7625295899" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">settings</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> . We’ll also need to create our customer spider, 
			<span id="crayon-56d58fc012faa861733490" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">coverspider</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  inside the 
			<span id="crayon-56d58fc012fae888318458" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">spiders</span></span></span>  directory</p>
<p>Let’s start with the 
			<span id="crayon-56d58fc012fb1110714802" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">settings</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  file which only requires to quick updates. The first is to find the 
			<span id="crayon-56d58fc012fb4825773483" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ITEMS_PIPELINE</span></span></span>  tuple, uncomment it (if it’s commented out), and add in the following setting:</p>

		<div id="crayon-56d58fc012fb8896064479" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc012fb8896064479-1"><span class="crayon-c"># Configure item pipelines</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fb8896064479-2"><span class="crayon-c"># See http://scrapy.readthedocs.org/en/latest/topics/item-pipeline.html</span></p><p class="crayon-line" id="crayon-56d58fc012fb8896064479-3"><span class="crayon-v">ITEM_PIPELINES</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fb8896064479-4"><span class="crayon-h">   </span><span class="crayon-s">'scrapy.contrib.pipeline.images.FilesPipeline'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d58fc012fb8896064479-5"><span class="crayon-sy">}</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>This setting will activate Scrapy’s default file scraping capability.</p>
<p>The second update can be appended to the bottom of the file. This value, 
			<span id="crayon-56d58fc012fbb622963574" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">FILES_STORE</span></span></span> , is simply the path to the output directory where the download images will be stored:</p>

		<div id="crayon-56d58fc012fbf902526069" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc012fbf902526069-1"><span class="crayon-v">FILES_STORE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"/home/adrian/projects/time_magazine/timecoverspider/output"</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Again, feel free to add this setting to the bottom of the 
			<span id="crayon-56d58fc012fc2586360476" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">settings</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  file — it doesn’t matter where in the file you put it.</p>
<p>Now we can move on to 
			<span id="crayon-56d58fc012fc6805729027" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">items</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> , which allows us to define a data object model for the webpages our spider crawls:</p>

		<div id="crayon-56d58fc012fc9248682264" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc012fc9248682264-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fc9248682264-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">scrapy</span></p><p class="crayon-line" id="crayon-56d58fc012fc9248682264-3"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fc9248682264-4"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">MagazineCover</span><span class="crayon-sy">(</span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">Item</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d58fc012fc9248682264-5"><span class="crayon-h">	</span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">Field</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fc9248682264-6"><span class="crayon-h">	</span><span class="crayon-v">pubDate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">Field</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58fc012fc9248682264-7"><span class="crayon-h">	</span><span class="crayon-v">file_urls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">Field</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc012fc9248682264-8"><span class="crayon-h">	</span><span class="crayon-v">files</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">Field</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The code here is pretty self-explanatory. On <strong>Line 2</strong> we import our 
			<span id="crayon-56d58fc012fcc418376985" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">scrapy</span></span></span>  package, followed by defining the 
			<span id="crayon-56d58fc012fd0396485483" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">MagazineCover</span></span></span>  class on <strong>Line 4</strong>. This class encapsulates the data we’ll scrape from each of the 
			<span id="crayon-56d58fc012fd3059937049" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-v">com</span></span></span>  magazine cover webpages. For each of these pages we’ll return a 
			<span id="crayon-56d58fc012fd7020185347" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">MagazineCover</span></span></span>  object which includes:</p>
<ul>
<li>
			<span id="crayon-56d58fc012fda249645905" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">title</span></span></span> : The title of the current <em>Time</em> magazine issue. For example, this could be <em>“Code Red”</em>, <em>“The Diploma That Works”</em>, <em>“The Infinity Machine”</em>, etc.</li>
<li>
			<span id="crayon-56d58fc012fde194401389" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">pubDate</span></span></span> : This field will store the date the issue was published on in 
			<span id="crayon-56d58fc012fe1223459190" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">year</span><span class="crayon-o">-</span><span class="crayon-v">month</span><span class="crayon-o">-</span><span class="crayon-v">day</span></span></span>  format.</li>
<li>
			<span id="crayon-56d58fc012fe4911221073" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">file_urls</span></span></span> : The 
			<span id="crayon-56d58fc012fe8239361680" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">file_urls</span></span></span>  field is a <b><i>very important </i></b>field that you must <b><i>explicitly</i></b> define to scrape binary files (whether it’s images, PDFs, mp3s), etc. from a website. You <em>cannot</em> name this variable differently and must be within your 
			<span id="crayon-56d58fc012feb312858783" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">Item</span></span></span>  sub-class.</li>
<li>
			<span id="crayon-56d58fc012fee475261940" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">files</span></span></span> : Similarly, the 
			<span id="crayon-56d58fc012ff2608531360" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">files</span></span></span>  field is required when scraping binary data. <em>Do not</em> name it anything different. For more information on the structure of the 
			<span id="crayon-56d58fc012ff5110952821" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">Item</span></span></span>  sub-class intended to save binary data to disk, be sure to read <a href="https://groups.google.com/forum/#!msg/scrapy-users/kzGHFjXywuY/O6PIhoT3thsJ" target="_blank">this thread on Scrapy Google Groups</a>.</li>
</ul>
<p>Now that we have our settings updated and created our data model, we can move on to the hard part — actually implementing the spider to scrape <em>Time</em> for cover images. Create a new file in the 
			<span id="crayon-56d58fc012ff9019718722" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">spiders</span></span></span>  directory, name it 
			<span id="crayon-56d58fc012ffc930834469" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">coverspider</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> , and we’ll get to work:</p>

		<div id="crayon-56d58fc013000228832778" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc013000228832778-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013000228832778-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">timecoverspider</span><span class="crayon-sy">.</span><span class="crayon-e">items </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">MagazineCover</span></p><p class="crayon-line" id="crayon-56d58fc013000228832778-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013000228832778-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">scrapy</span></p><p class="crayon-line" id="crayon-56d58fc013000228832778-5"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013000228832778-6"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">CoverSpider</span><span class="crayon-sy">(</span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">Spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d58fc013000228832778-7"><span class="crayon-h">	</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"pyimagesearch-cover-spider"</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013000228832778-8"><span class="crayon-h">	</span><span class="crayon-v">start_urls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"http://search.time.com/results.html?N=46&amp;Ns=p_date_range|1"</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Lines 2-4</strong> handle importing our necessary packages. We’ll be sure to import our 
			<span id="crayon-56d58fc013003781782481" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">MagazineCover</span></span></span>  data object, 
			<span id="crayon-56d58fc013006918563228" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">datetime</span></span></span>  to parse dates from the <em>Time.com</em> website, followed by 
			<span id="crayon-56d58fc01300a768358291" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">scrapy</span></span></span>  to obtain access to our actual spidering and scraping tools.</p>
<p>From there, we can define the 
			<span id="crayon-56d58fc01300d570604739" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">CoverSpider</span></span></span>  class on <strong>Line 6</strong>, a sub-class of 
			<span id="crayon-56d58fc013010532509895" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">Spider</span></span></span> . This class needs to have two pre-defined values:</p>
<ul>
<li>
			<span id="crayon-56d58fc013014722393028" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">name</span></span></span> : The name of our spider. The 
			<span id="crayon-56d58fc013017830039529" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">name</span></span></span>  should be <i>descriptive</i> of what the spider does; however, <em>don’t make it too long</em>, since you’ll have to manually type it into your command line to trigger and execute it.</li>
<li>
			<span id="crayon-56d58fc01301b413478711" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">start_urls</span></span></span> : This is a list of the seed URLs the spider will crawl first. The URL we have supplied here is the <a href="http://search.time.com/results.html?N=46&amp;Ns=p_date_range|1" target="_blank">main page of the <em>Time.com</em> cover browser</a>.</li>
</ul>
<p>Every Scrapy spider is required to have (at a bare minimum) a 
			<span id="crayon-56d58fc01301e047041145" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">parse</span></span></span>  method that handles parsing the 
			<span id="crayon-56d58fc013021021657372" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">start_urls</span></span></span> . This method can in turn yield other requests, triggering other pages to be crawled and spidered, but at the very least, we’ll need to define our 
			<span id="crayon-56d58fc013025251543991" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">parse</span></span></span>  function:</p>

		<div id="crayon-56d58fc013028724775367" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013028724775367-10"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d58fc013028724775367-11"><span class="crayon-h">		</span><span class="crayon-c"># let's only gather Time U.S. magazine covers</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013028724775367-12"><span class="crayon-h">		</span><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">css</span><span class="crayon-sy">(</span><span class="crayon-s">"div.refineCol ul li"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">"a[contains(., 'TIME U.S.')]"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58fc013028724775367-13"><span class="crayon-h">		</span><span class="crayon-r">yield</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">Request</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">"@href"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract_first</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">parse_page</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>One of the awesome aspects of Scrapy is the ability to traverse the <a href="https://en.wikipedia.org/wiki/Document_Object_Model" target="_blank">Document Object Model</a> (DOM) using simple CSS and <a href="https://en.wikipedia.org/wiki/XPath" target="_blank">XPath</a> selectors. On <strong>Line 12</strong> we traverse the DOM and grab the 
			<span id="crayon-56d58fc01302c702134991" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">href</span></span></span>  (i.e. URL) of the link that contains the text 
			<span id="crayon-56d58fc013030117699943" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-i">TIME</span><span class="crayon-h"> </span><span class="crayon-v">U</span><span class="crayon-sy">.</span><span class="crayon-v">S</span><span class="crayon-sy">.</span></span></span> . I have highlighted the <em>“TIME U.S.”</em> link in the screenshot below:</p>
<div id="attachment_3176" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_start_page.jpg"><img class="wp-image-3176" src="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_start_page.jpg" alt="Figure 1: The first step in our scraper is to access the &quot;TIME U.S.&quot; page." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_start_page-300x290.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_start_page.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 1:</strong> The first step in our scraper is to access the <em>“TIME U.S.”</em> page.</p></div>
<p>I was able to obtain this CSS selector by using the Chrome browser, right clicking on the link element, selecting <em>Inspect Element”</em>, and using Chrome’s developer tools to traverse the DOM:</p>
<div id="attachment_3178" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_inspect_element.jpg"><img class="wp-image-3178" src="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_inspect_element.jpg" alt="Figure 2: Utilizing Chrome's Developer tools to navigate the DOM." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_inspect_element-300x290.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_inspect_element.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 2:</strong> Utilizing Chrome’s Developer tools to navigate the DOM.</p></div>
<p>Now that we have the URL of the link, we yield a 
			<span id="crayon-56d58fc013034457263565" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">Request</span></span></span>  to that page (which is essentially telling Scrapy to “click that link”), indicating that the 
			<span id="crayon-56d58fc013037788941442" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">parse_page</span></span></span>  method should be used to handle parsing it.</p>
<p>A screenshot of the <a href="http://search.time.com/results.html?sid=150424A4D8E2&amp;internalid=endeca_dimension&amp;N=46+30&amp;Ns=p_date_range|1&amp;Nty=1" target="_blank">“<em>TIME U.S.”</em> page</a> can be seen below:</p>
<div id="attachment_3179" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_us_page.jpg"><img class="wp-image-3179" src="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_us_page.jpg" alt="Figure 3: On this page we need to extract all &quot;Large Cover&quot; links, followed by following the &quot;Next&quot; link in the pagination." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_us_page-300x290.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_us_page.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 3:</strong> On this page we need to extract all <em>“Large Cover”</em> links, followed by following the <em>“Next”</em> link in the pagination.</p></div>
<p>We have two primary goals in parsing this page:</p>
<ul>
<li><strong>Goal #1:</strong> Grab the URLs of all links with the text <em>“Large Cover” </em>(highlighted in <em><strong>green</strong></em> in the figure above).</li>
<li><strong>Goal #2:</strong> Once we have grabbed all the <em>“Large Cover”</em> links, we need to click the <em>“Next”</em> button (highlighted in <em><strong>purple</strong></em>), allowing us to follow the pagination and parse <strong><em>all</em></strong> issues of <em>Time</em> and grab their respective covers.</li>
</ul>
<p>Below follows our implementation of the 
			<span id="crayon-56d58fc01303c164938738" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">parse_page</span></span></span>  method to accomplish exactly this:</p>

		<div id="crayon-56d58fc01303f692670550" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc01303f692670550-15"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">parse_page</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01303f692670550-16"><span class="crayon-h">		</span><span class="crayon-c"># loop over all cover link elements that link off to the large</span></p><p class="crayon-line" id="crayon-56d58fc01303f692670550-17"><span class="crayon-h">		</span><span class="crayon-c"># cover of the magazine and yield a request to grab the cove</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01303f692670550-18"><span class="crayon-h">		</span><span class="crayon-c"># data and image</span></p><p class="crayon-line" id="crayon-56d58fc01303f692670550-19"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">href </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">"//a[contains(., 'Large Cover')]"</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01303f692670550-20"><span class="crayon-h">			</span><span class="crayon-r">yield</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">Request</span><span class="crayon-sy">(</span><span class="crayon-v">href</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">"@href"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract_first</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d58fc01303f692670550-21"><span class="crayon-h">				</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">parse_covers</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01303f692670550-22"> </p><p class="crayon-line" id="crayon-56d58fc01303f692670550-23"><span class="crayon-h">		</span><span class="crayon-c"># extract the 'Next' link from the pagination, load it, and</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01303f692670550-24"><span class="crayon-h">		</span><span class="crayon-c"># parse it</span></p><p class="crayon-line" id="crayon-56d58fc01303f692670550-25"><span class="crayon-h">		</span><span class="crayon-k ">next</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">css</span><span class="crayon-sy">(</span><span class="crayon-s">"div.pages"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">"a[contains(., 'Next')]"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01303f692670550-26"><span class="crayon-h">		</span><span class="crayon-r">yield</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">Request</span><span class="crayon-sy">(</span><span class="crayon-k ">next</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">"@href"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract_first</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">parse_page</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We start off on <strong>Line 19</strong> by looping over all link elements that contain the text 
			<span id="crayon-56d58fc013044890838781" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-e">Large </span><span class="crayon-v">Cover</span></span></span> . For each of these links, we “click” it, and yield a request to that page using the 
			<span id="crayon-56d58fc013047725349213" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">parse_covers</span></span></span>  method (which we’ll define in a few minutes).</p>
<p>Then, once we have generated requests to all cover pages, it’s safe to click the 
			<span id="crayon-56d58fc01304a150178165" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">Next</span></span></span>  button and use the same 
			<span id="crayon-56d58fc01304e980876424" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">parse_page</span></span></span>  method to extract data from the following page as well — this process is repeated until we have exhausted the pagination of magazine issues and there are no further pages in the pagination to process.</p>
<p>The last step is to extract the 
			<span id="crayon-56d58fc013051823718776" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">title</span></span></span> , 
			<span id="crayon-56d58fc013055808047878" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">pubDate</span></span></span> , and store the <em>Time</em> cover image itself. An example screenshot of a <a href="http://content.time.com/time/covers/0,16641,20140310,00.html" target="_blank">cover page from <em>Time</em></a> can be seen below:</p>
<div id="attachment_3180" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_cover_page.jpg"><img class="wp-image-3180" src="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_cover_page.jpg" alt="Figure 4: On the actual cover page, we need to extract the issue title, publish date, and cover image URL." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_cover_page-300x290.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_cover_page.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 4:</strong> On the actual cover page, we need to extract the <em>issue title</em>, <em>publish date</em>, and cover <em>image URL</em>.</p></div>
<p>Here I have highlighted the issue name in <em><strong>green</strong></em>, the publication date in <em><strong>red</strong></em>, and the cover image itself in <em><strong>purple</strong></em>. All that’s left to do is define the 
			<span id="crayon-56d58fc013059075875802" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">parse_covers</span></span></span>  method to extract this data:</p>

		<div id="crayon-56d58fc01305c471620980" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-28">28</p><p class="crayon-num" data-line="crayon-56d58fc01305c471620980-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-30">30</p><p class="crayon-num" data-line="crayon-56d58fc01305c471620980-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-32">32</p><p class="crayon-num" data-line="crayon-56d58fc01305c471620980-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-34">34</p><p class="crayon-num" data-line="crayon-56d58fc01305c471620980-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-36">36</p><p class="crayon-num" data-line="crayon-56d58fc01305c471620980-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-38">38</p><p class="crayon-num" data-line="crayon-56d58fc01305c471620980-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-40">40</p><p class="crayon-num" data-line="crayon-56d58fc01305c471620980-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-42">42</p><p class="crayon-num" data-line="crayon-56d58fc01305c471620980-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d58fc01305c471620980-44">44</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-28"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">parse_covers</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d58fc01305c471620980-29"><span class="crayon-h">		</span><span class="crayon-c"># grab the URL of the cover image</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-30"><span class="crayon-h">		</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">css</span><span class="crayon-sy">(</span><span class="crayon-s">".art-cover-photo figure a img"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">"@src"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58fc01305c471620980-31"><span class="crayon-h">		</span><span class="crayon-v">imageURL</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">extract_first</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-32"> </p><p class="crayon-line" id="crayon-56d58fc01305c471620980-33"><span class="crayon-h">		</span><span class="crayon-c"># grab the title and publication date of the current issue</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-34"><span class="crayon-h">		</span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">css</span><span class="crayon-sy">(</span><span class="crayon-s">".content-main-aside h1::text"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract_first</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58fc01305c471620980-35"><span class="crayon-h">		</span><span class="crayon-v">year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">css</span><span class="crayon-sy">(</span><span class="crayon-s">".content-main-aside h1 time a::text"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract_first</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-36"><span class="crayon-h">		</span><span class="crayon-v">month</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">css</span><span class="crayon-sy">(</span><span class="crayon-s">".content-main-aside h1 time::text"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract_first</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d58fc01305c471620980-37"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-38"><span class="crayon-h">		</span><span class="crayon-c"># parse the date</span></p><p class="crayon-line" id="crayon-56d58fc01305c471620980-39"><span class="crayon-h">		</span><span class="crayon-v">date</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"{} {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">month</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">year</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-40"><span class="crayon-h">		</span><span class="crayon-v">d</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-v">date</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"%b %d %Y"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58fc01305c471620980-41"><span class="crayon-h">		</span><span class="crayon-v">pub</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"{}-{}-{}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">year</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">month</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">zfill</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">day</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">zfill</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-42"> </p><p class="crayon-line" id="crayon-56d58fc01305c471620980-43"><span class="crayon-h">		</span><span class="crayon-c"># yield the result</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01305c471620980-44"><span class="crayon-h">		</span><span class="crayon-r">yield</span><span class="crayon-h"> </span><span class="crayon-e">MagazineCover</span><span class="crayon-sy">(</span><span class="crayon-v">title</span><span class="crayon-o">=</span><span class="crayon-v">title</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pubDate</span><span class="crayon-o">=</span><span class="crayon-v">pub</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">file_urls</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">imageURL</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Just as the other parse methods, the 
			<span id="crayon-56d58fc013061956486823" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">parse_covers</span></span></span>  method is also straightforward. <strong>Lines 30 and 31</strong> extract the URL of the cover image.</p>
<p><strong>Lines 33 </strong>grabs the title of the magazine issue, while <strong>Lines 35 and 36</strong> extract the publication year and month.</p>
<p>However, the publication date could use a little formatting — let’s create a consisting formatting in 
			<span id="crayon-56d58fc013064967289111" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">year</span><span class="crayon-o">-</span><span class="crayon-v">month</span><span class="crayon-o">-</span><span class="crayon-v">day</span></span></span> . While it’s not entirely obvious at this moment why this date formatting is useful, it will be <em>very obvious</em> in next week’s post when we actually perform a <em>temporal image analysis</em> on the magazine covers themselves.</p>
<p>Finally, <strong>Line 44</strong> yields a 
			<span id="crayon-56d58fc013068438587128" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">MagazineCover</span></span></span>  object including the 
			<span id="crayon-56d58fc01306b931208716" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">title</span></span></span> , 
			<span id="crayon-56d58fc01306f794453954" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">pubDate</span></span></span> , and 
			<span id="crayon-56d58fc013072791644833" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">imageURL</span></span></span>  (which will be downloaded and stored on disk).</p>
<h2>Running the spider</h2>
<p>To run our Scrapy spider to scrape images, just execute the following command:</p>

		<div id="crayon-56d58fc013075013403139" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc013075013403139-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">scrapy </span><span class="crayon-e">crawl </span><span class="crayon-v">pyimagesearch</span><span class="crayon-o">-</span><span class="crayon-v">cover</span><span class="crayon-o">-</span><span class="crayon-v">spider</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-e">.json</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>This will kick off the image scraping process, serializing each 
			<span id="crayon-56d58fc013079030769106" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">MagazineCover</span></span></span>  item to an output file, 
			<span id="crayon-56d58fc01307c569650325" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-v">json</span></span></span> . The resulting scraped images will be stored in 
			<span id="crayon-56d58fc01307f822549125" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">full</span></span></span> , a sub-directory that Scrapy creates automatically in the 
			<span id="crayon-56d58fc013083393956165" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">output</span></span></span>  directory that we specified via the 
			<span id="crayon-56d58fc013086761653852" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">FILES_STORE</span></span></span>  option in 
			<span id="crayon-56d58fc013089555802289" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">settings</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  above.</p>
<p>Below follows a screenshot of the image scraping process running:</p>
<div id="attachment_3181" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_running_scrape.jpg"><img class="wp-image-3181" src="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_running_scrape.jpg" alt="Figure 5: Kicking off our image scraper and letting it run." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_running_scrape-300x201.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_running_scrape.jpg 881w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 5:</strong> Kicking off our image scraper and letting it run.</p></div>
<p>On my system, the entire scrape to grab <em><strong>all</strong></em> <em>Time</em> magazine covers using Python + Scrapy took a speedy <strong><em>2m 23s </em></strong>— <strong>not bad for nearly 4,000 images!</strong></p>
<h2>Our complete set of <em>Time</em> magazine covers</h2>
<p>Now that our spider has finished scraping the <em>Time</em> magazine covers, let’s take a look at our 
			<span id="crayon-56d58fc01308d261649129" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-v">json</span></span></span>  file:</p>
<div id="attachment_3182" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_output_json.jpg"><img class="wp-image-3182" src="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_output_json.jpg" alt="Figure 6: A screenshot of our output.json file." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_output_json-300x201.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_output_json.jpg 881w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 6:</strong> A screenshot of our output.json file.</p></div>
<p>To inspect them individually, let’s fire up a Python shell and see what we’re working with:</p>

		<div id="crayon-56d58fc013091704090977" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc013091704090977-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">python</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013091704090977-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-v">json</span></p><p class="crayon-line" id="crayon-56d58fc013091704090977-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">"output.json"</span><span class="crayon-sy">)</span><span class="crayon-e">.read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013091704090977-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">json</span><span class="crayon-e">.loads</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d58fc013091704090977-5"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc013091704090977-6"><span class="crayon-cn">3969</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>As we can see, we have scraped a total of <em>3,969</em> images.</p>
<p>Each entry in the 
			<span id="crayon-56d58fc013095739034047" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">data</span></span></span>  list is a dictionary, which essentially maps to our 
			<span id="crayon-56d58fc013098294627882" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">MagazineCover</span></span></span>  data model:</p>

		<div id="crayon-56d58fc01309b516790562" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc01309b516790562-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">data</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01309b516790562-2"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'files'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'url'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'http://img.timeinc.net/time/magazine/archive/covers/2014/1101140113_600.jpg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'path'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'full/78a2264fb6103aaf20ff13982a09cb182294709d.jpg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'checksum'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'02a6b4d22402fd9d5642535bea950c5f'</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'file_urls'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">u</span><span class="crayon-s">'http://img.timeinc.net/time/magazine/archive/covers/2014/1101140113_600.jpg'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'pubDate'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'2014-01-13'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'title'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'2014: The Year Ahead '</span><span class="crayon-sy">}</span></p><p class="crayon-line" id="crayon-56d58fc01309b516790562-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-e">.keys</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01309b516790562-4"><span class="crayon-sy">[</span><span class="crayon-i">u</span><span class="crayon-s">'files'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'file_urls'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'pubDate'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'title'</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We can easily grab the path to the <em>Time</em> cover image like this:</p>

		<div id="crayon-56d58fc01309f836823399" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc01309f836823399-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Title: {}\nFile Path: {}"</span><span class="crayon-e">.format</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"title"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"files"</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"path"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc01309f836823399-2"><span class="crayon-v">Title</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2014</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">The </span><span class="crayon-e">Year </span><span class="crayon-e">Ahead </span></p><p class="crayon-line" id="crayon-56d58fc01309f836823399-3"><span class="crayon-r">File</span><span class="crayon-h"> </span><span class="crayon-v">Path</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">full</span><span class="crayon-o">/</span><span class="crayon-cn">78a2264fb6103aaf20ff13982a09cb182294709d.jpg</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Inspecting the 
			<span id="crayon-56d58fc0130a3226716580" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">full</span></span></span>  directory we can see we have our <em>3,969</em> images:</p>

		<div id="crayon-56d58fc0130a7358844679" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d58fc0130a7358844679-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">cd</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">full</span><span class="crayon-o">/</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d58fc0130a7358844679-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">ls</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">l</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-e">.jpg</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-r">wc</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">l</span></p><p class="crayon-line" id="crayon-56d58fc0130a7358844679-3"><span class="crayon-h">    </span><span class="crayon-cn">3969</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/><div id="attachment_3177" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_dataset.jpg"><img class="wp-image-3177" src="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_dataset.jpg" alt="Figure 7: Our dataset of Time magazine cover images." srcset="http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_dataset-300x228.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2015/10/time_scrape_dataset.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 7:</strong> Our dataset of Time magazine cover images.</p></div>
<p>So now that we have all of these images, the big question is: <strong><em>“What are we going to do with them?!”</em></strong></p>
<p>I’ll be answering that question over the next few blog posts. We’ll be spending some time analyzing this dataset using computer vision and image processing techniques, so don’t worry, <i>your bandwidth wasn’t wasted for nothing! </i></p>
<p><strong>Note:</strong> If Scrapy is not working for you (or if you don’t want to bother setting it up), no worries — I have included the 
			<span id="crayon-56d58fc0130ab036683519" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-v">json</span></span></span>  and raw, scraped 
			<span id="crayon-56d58fc0130ae738263581" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-sy">.</span><span class="crayon-v">jpg</span></span></span>  images in the source code download of the post found at the bottom of this page. You’ll still be able to follow along through the upcoming PyImageSearch posts without a problem.</p>
<h2>Summary</h2>
<p>In this blog post we learned how to use Python scrape all cover images of <em>Time</em> magazine. To accomplish this task, we utilized <a href="http://scrapy.org/" target="_blank">Scrapy</a>, a fast and powerful web scraping framework. Overall, our entire spider file consisted of less than <em><strong>44 lines of code</strong></em> which really demonstrates the power and abstraction behind the Scrapy libray.</p>
<p>So now that we have this dataset of <em>Time</em> magazine covers, <em>what are we going to do with them?</em></p>
<p>Well, this is a computer vision blog after all — so next week we’ll start with a <em>visual analytics</em> project where we perform a <em>temporal investigation</em> of the cover images. This is a really cool project and I’m super excited about it!</p>
<p><b>Be sure to sign up for PyImageSearch newsletter using the form at the bottom of this post — <em>you won’t want to miss the followup posts as we analyze the </em>Time <em>magazine cover dataset!</em></b></p>
<h2 id="post_downloads">Downloads:</h2>

	</section>
	</div></body></html>