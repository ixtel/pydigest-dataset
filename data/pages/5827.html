<html><body><div><section>
            <span>5</span>
            <h2 id="content-types-in-our-models">Content Types in our models</h2>
            
              <p>From the docs:</p><p> <em>Adding a foreign key from one of your own models to ContentType allows your model to effectively tie itself to another model class</em>.</p><p>So we add a new model to our models called car which uses the <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/contenttypes/#generic-relations" class="guide-link">Generic Relations</a>.</p><p><code>class Car(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = GenericForeignKey('content_type', 'object_id')
    created = models.DateTimeField()
    class Meta:
        ordering = ['-created']
    def __str__(self):
        return "{0} - {1}".format(self.content_object.series,
                                  self.created.date())</code></p><p>We then update our models and define a <a href="https://docs.djangoproject.com/en/1.8/ref/signals/#post-save" class="guide-link">post save handler</a>.</p><p><code>def create_car(sender, instance, created, **kwargs):
    """
    Post save handler to create/update car instances when
    Bmw or Tesla is created/updated
    """
    content_type = ContentType.objects.get_for_model(instance)
    try:
        car= Car.objects.get(content_type=content_type,
                             object_id=instance.id)
    except Car.DoesNotExist:
        car = Car(content_type=content_type, object_id=instance.id)
    car.created = instance.created
    car.series = instance.series
    car.save()</code></p><p>And we add the <a href="https://docs.djangoproject.com/en/1.8/ref/signals/#post-save" class="guide-link">post save</a> handler to our Tesla model.</p><p><code>class Tesla(models.Model):
    series = models.CharField(max_length=50)
    created = models.DateTimeField()
    class Meta:
        ordering = ['-created']
    def __str__(self):
        return "{0} - {1}".format(self.series, self.created.date())
post_save.connect(create_car, sender=Tesla)</code></p><p>(and similarly added for Bmw model not show for brevity)</p><p>So now every time an instance of Tesla or Bmw is created or updated, the corresponding Car model instance gets updated.</p>
            
            
          </section>
          </div></body></html>