<html><body><div><div class="entry-content">
			<p>Using <strong><a href="https://www.torproject.org/" target="_blank">tor</a></strong> with python’s urllib2 is pretty easy, you just need to setup a few things before hand.</p>
<p>First off what is tor? Tor stands for “<strong>The Onion Router</strong>” and allows you to anonymously browse the internet by bouncing your request through multiple tor nodes.</p>
<p><a href="http://nessy.info/wp-content/uploads/2013/11/htw2.jpg"><img class="alignnone size-medium wp-image-120" alt="htw2" src="http://nessy.info/wp-content/uploads/2013/11/htw2-300x192.jpg"/></a></p>
<p>I’m going to be using a Fedora 17 machine to demonstrate, and show output.</p>
<p>First lets install two packages from our package manager:</p>
<pre># yum install privoxy tor</pre>
<p>Next we need to edit our privoxy config (<em>/etc/privoxy/config</em>) and add the following line:</p>
<pre>forward-socks4a / localhost:9050 .</pre>
<p>We are now set to start the services:</p>
<pre>service tor start
service privoxy start</pre>
<p>Lets go ahead and fire up our Python interrupter and get to it:</p>
<pre>In [1]: import urllib2

In [2]: proxy = urllib2.ProxyHandler({'http': '127.0.0.1:8118'})

In [3]: opener = urllib2.build_opener(proxy)

In [4]: urllib2.install_opener(opener)

In [5]: print urllib2.urlopen('http://icanhazip.com/').read()
78.108.63.46</pre>
<p>To verify we are working we can request a new identity from the</p>
<p>tor process by sending the <strong>SIGHUP</strong> signal:</p>
<pre># ps aux | grep tor
root      5126  0.5  0.9  61752 19068 pts/1    S+   15:24   0:00 tor
root      5289  0.0  0.0 109400   824 pts/3    R+   15:26   0:00 grep --color=auto tor

# kill -s SIGHUP 5126</pre>
<p>Now when we run our Python code we should have a new ip address:</p>
<pre>In [6]: print urllib2.urlopen('http://icanhazip.com/').read()
91.219.237.229</pre>
					</div>
		
		</div></body></html>