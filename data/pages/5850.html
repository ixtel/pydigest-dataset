<html><body><div><p>A convenient DSL for generating SublimeText configs.</p>








<p>The configuration of Sublime Text uses verbose JSON files, XML files,
and also horrible PList/XML files (TextMate legacy). When used in
plugins, some of them (e.g. keymaps) may contain even hundreds of lines
with huge ratio of duplications. Sooner or later, it’ll become quite
hard to maintain such a mess.</p>
<p>The aim of this module is to provide simple pythonic DSL for generating
particular configuration files. Currently only <a href="http://docs.sublimetext.info/en/latest/reference/key_bindings.html" rel="nofollow">Key
Bindings</a>
are supported, but other configs may come later.</p>
<div id="usage">
<h2>Usage</h2>
<h2 id="examples"><span class="section-subtitle">Examples</span></h2>
<pre><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">from</span> <span class="nn">sublimedsl.keymap</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">Keymap</span><span class="p">(</span>
    <span class="n">bind</span><span class="p">(</span><span class="s1">'backspace'</span><span class="p">)</span>
        <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">'run_macro_file'</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="s1">'res://Packages/Default/Delete Left Right.sublime-macro'</span><span class="p">)</span>
        <span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="s1">'setting.auto_match_enabled'</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">true</span><span class="p">()</span>
        <span class="o">.</span><span class="n">also</span><span class="p">(</span><span class="s1">'preceding_text'</span><span class="p">)</span><span class="o">.</span><span class="n">regex_contains</span><span class="p">(</span><span class="s1">r'_$'</span><span class="p">)</span>
        <span class="o">.</span><span class="n">also</span><span class="p">(</span><span class="s1">'following_text'</span><span class="p">)</span><span class="o">.</span><span class="n">regex_contains</span><span class="p">(</span><span class="s1">r'^_'</span><span class="p">),</span>

    <span class="n">bind</span><span class="p">(</span><span class="s1">'super+k'</span><span class="p">,</span> <span class="s1">'super+shift+up'</span><span class="p">)</span>
        <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">'new_pane'</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>

    <span class="n">common_context</span><span class="o">=</span><span class="p">[</span>
        <span class="n">context</span><span class="p">(</span><span class="s1">'selector'</span><span class="p">)</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="s1">'text.asciidoc'</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="n">default_match_all</span><span class="o">=</span><span class="bp">True</span>

<span class="p">)</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
</pre>
<p>The above code generates:</p>
<pre><span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">"keys"</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"backspace"</span> <span class="p">],</span>
    <span class="nt">"command"</span><span class="p">:</span> <span class="s2">"run_macro_file"</span><span class="p">,</span>
    <span class="nt">"args"</span><span class="p">:</span> <span class="p">{</span> <span class="nt">"file"</span><span class="p">:</span> <span class="s2">"res://Packages/Default/Delete Left Right.sublime-macro"</span> <span class="p">},</span>
    <span class="nt">"context"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">"key"</span><span class="p">:</span> <span class="s2">"setting.auto_match_enabled"</span><span class="p">,</span> <span class="nt">"operator"</span><span class="p">:</span> <span class="s2">"equal"</span><span class="p">,</span> <span class="nt">"operand"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">"match_all"</span><span class="p">:</span> <span class="kc">false</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">"key"</span><span class="p">:</span> <span class="s2">"preceding_text"</span><span class="p">,</span> <span class="nt">"operator"</span><span class="p">:</span> <span class="s2">"regex_contains"</span><span class="p">,</span> <span class="nt">"operand"</span><span class="p">:</span> <span class="s2">"_$"</span><span class="p">,</span> <span class="nt">"match_all"</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">"key"</span><span class="p">:</span> <span class="s2">"following_text"</span><span class="p">,</span> <span class="nt">"operator"</span><span class="p">:</span> <span class="s2">"regex_contains"</span><span class="p">,</span> <span class="nt">"operand"</span><span class="p">:</span> <span class="s2">"^_"</span><span class="p">,</span> <span class="nt">"match_all"</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">"key"</span><span class="p">:</span> <span class="s2">"selector"</span><span class="p">,</span> <span class="nt">"operator"</span><span class="p">:</span> <span class="s2">"equal"</span><span class="p">,</span> <span class="nt">"operand"</span><span class="p">:</span> <span class="s2">"text.asciidoc"</span><span class="p">,</span> <span class="nt">"match_all"</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">"keys"</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"super+k"</span><span class="p">,</span> <span class="s2">"super+shift+up"</span> <span class="p">],</span>
    <span class="nt">"command"</span><span class="p">:</span> <span class="s2">"new_pane"</span><span class="p">,</span>
    <span class="nt">"args"</span><span class="p">:</span> <span class="p">{</span> <span class="nt">"move"</span><span class="p">:</span> <span class="kc">false</span> <span class="p">},</span>
    <span class="nt">"context"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">"key"</span><span class="p">:</span> <span class="s2">"selector"</span><span class="p">,</span> <span class="nt">"operator"</span><span class="p">:</span> <span class="s2">"equal"</span><span class="p">,</span> <span class="nt">"operand"</span><span class="p">:</span> <span class="s2">"text.asciidoc"</span><span class="p">,</span> <span class="nt">"match_all"</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre>
<p>You can also look at real-world example in the <a href="https://github.com/asciidoctor/sublimetext-asciidoc/" rel="nofollow">Asciidoctor
plugin</a>:
<a href="https://github.com/asciidoctor/sublimetext-asciidoc/blob/master/Keymaps/Default.sublime-keymap.py" rel="nofollow">Keymap
DSL</a>
and <a href="https://github.com/asciidoctor/sublimetext-asciidoc/blob/master/Keymaps/Default.sublime-keymap" rel="nofollow">generated
JSON</a>.</p>
</div>
<div id="installation">
<h2>Installation</h2>
<div id="system-wide">
<h3>System-wide</h3>
<p>Install from PyPI system-wide:</p>
<pre>sudo pip install sublimedsl
</pre>
<p>…or manually:</p>
<pre>git clone git@github.com:jirutka/sublimedsl.git
cd sublimedsl
sudo ./setup.py install
</pre>
</div>
<div id="locally">
<h3>Locally</h3>
<p>If you don’t have a root access to the system, or just don’t want to
install sublimedsl system-wide, then you can tell <tt>pip</tt> or
<tt>setup.py</tt> to install it into your home directory (namely
<tt><span class="pre">~/.local</span></tt>):</p>
<pre>pip install --user sublimedsl
</pre>
<p>…or manually:</p>
<pre>git clone git@github.com:jirutka/sublimedsl.git
cd sublimedsl
./setup.py --user install
</pre>
</div>
</div>
</div></body></html>