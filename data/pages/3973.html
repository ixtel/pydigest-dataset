<html><body><div><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-selenium-requests" class="anchor" href="#selenium-requests" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Selenium Requests</h1>

<p>Extends Selenium WebDriver classes to include the <a href="http://docs.python-requests.org/en/latest/api/#requests.request">request</a> function from the <a href="http://python-requests.org/">Requests</a> library, while doing all the needed cookie and request headers handling.</p>

<p>Before the actual request is made, a local HTTP server is started that serves a single request made by the webdriver instance to get the "standard" HTTP request headers sent by this webdriver; these are cached (only happens once during its lifetime) and later used in conjunction with the Requests library to make the requests look identical to those that would have been sent by the webdriver. Cookies held by the webdriver instance are added to the request headers and those returned in a response automatically set for the webdriver instance.</p>

<h2><a id="user-content-features" class="anchor" href="#features" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Features</h2>

<ul>
<li>Sends the "default" HTTP headers for the chosen WebDriver</li>
<li>Manages cookies bidirectionally: Requests &lt;-&gt; Selenium</li>
<li>Switches to an already existing window handle, or creates a temporary new one to work with cookies when making a request</li>
<li>All operations preserve the original state (active window handle and window handles) of the WebDriver</li>
<li>Tested to work with Mozilla Firefox, Google Chrome and PhantomJS</li>
</ul>

<h2><a id="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Usage</h2>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># Import any WebDriver class that you would usually import from</span>
<span class="pl-c"># selenium.webdriver from the seleniumrequests module</span>
<span class="pl-k">from</span> seleniumrequests <span class="pl-k">import</span> Firefox

<span class="pl-c"># Simple usage with built-in WebDrivers:</span>
webdriver <span class="pl-k">=</span> Firefox()
response <span class="pl-k">=</span> webdriver.request(<span class="pl-s"><span class="pl-pds">'</span>GET<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>https://www.google.com/<span class="pl-pds">'</span></span>)
<span class="pl-c1">print</span>(response)


<span class="pl-c"># More complex usage, using a WebDriver from another Selenium-related module:</span>
<span class="pl-k">from</span> seleniumrequests.request <span class="pl-k">import</span> RequestMixin
<span class="pl-k">from</span> someothermodule <span class="pl-k">import</span> CustomWebDriver


<span class="pl-k">class</span> <span class="pl-en">MyCustomWebDriver</span>(<span class="pl-e">CustomWebDriver</span>, <span class="pl-e">RequestMixin</span>):
    <span class="pl-k">pass</span>


custom_webdriver <span class="pl-k">=</span> MyCustomWebDriver()
response <span class="pl-k">=</span> custom_webdriver.request(<span class="pl-s"><span class="pl-pds">'</span>GET<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>https://www.google.com/<span class="pl-pds">'</span></span>)
<span class="pl-c1">print</span>(response)</pre></div>

<h2><a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Installation</h2>

<p><code>pip install selenium-requests</code></p>

<h2><a id="user-content-details" class="anchor" href="#details" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" role="img" version="1.1" viewbox="0 0 16 16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"/></svg></a>Details</h2>

<p>The request method supports two additional arguments:</p>

<ul>
<li><code>find_window_handle_timeout</code> (default: -1 seconds)</li>
<li><code>page_load_timeout</code> (default: -1 seconds)</li>
</ul>

<p>If the timeout is negative, then the script will be allowed to run indefinitely (similarly to Selenium WebDriver's default behaviour).</p>

<p>The first is needed because there is no reliable way to create a new window handle with the Selenium WebDriver interface, so a new handle has to be spawned via JavaScript and subsequently found to be able to get or set cookies with the WebDriver. There are two methods to do this: The first involves simply comparing the set of window handles before and after the JavaScript was executed and finding the difference. If the difference is unreliable (0 or more than 1 window handles found) an alternative less reliable method is used: the top-level domain for each frame is compared to the top-level domain of the requested URL (JavaScript redirects are not supported when this method is used). If no results are found, an additional GET request is made to the requested domain to check for a potential redirect. Whether there was a redirect or not, the old or new top-level domain will now be searched for <code>find_window_handle_timeout</code> seconds until it is either found or a <code>TimeoutException</code> is raised.</p>

<p>The second is needed mostly because of <a href="http://phantomjs.org/">PhantomJS</a>. Every other webdriver blocks until the current window handle is loaded, except PhantomJS. If the new window handle was found via the first method (see above) and then cookies should be set, it's possible that an exception is raised, because the webdriver has to have switched to a window handle with the correct domain prior to setting cookies. Thus the method waits <code>page_load_timeout</code> seconds before raising a <code>TimeoutException</code>.</p>
</article>
  </div></body></html>