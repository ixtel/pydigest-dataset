<html><body><div><div id="id1">
<span id="basic-usage"/><h3>Basic Usage</h3>
<p>As an example usage, we consider testing <a href="http://www.topasmc.org" rel="nofollow">TOPAS</a>. This is a Monte Carlo tool for particle simulation, designed for medical physics research. Of course, such a tool must be rigorously validated against experimental data. But it is also useful to frequently run shorter tests, checking for regressions by comparing results to a previous version.</p>
<p>First, we describe the software under test in a configuration file called <tt><span class="pre">apps/topas-2.0.3.json</span></tt>. Note that <tt>setup_script</tt> defines the environment needed to run the software.</p>
<pre><span class="p">{</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"topas"</span><span class="p">,</span>
    <span class="nt">"version"</span> <span class="p">:</span> <span class="s2">"2.0.3"</span><span class="p">,</span>
    <span class="nt">"setup_script"</span> <span class="p">:</span> <span class="s2">"/path/to/topas-2.0.3/setup.sh"</span><span class="p">,</span>
    <span class="nt">"exe"</span> <span class="p">:</span> <span class="s2">"topas"</span>
<span class="p">}</span>
</pre>
<p>We then describe the test in second configuration file called <tt>tests/Scoring_01.json</tt>. In doing so, we define the command-line arguments presented to the executable and the input files needed for the test to run. Finally, we also specify the expected output files, and declare how they should be compared to a benchmark. Here we use <tt>topas binned</tt>, which is a custom comparison routine, though some comparison routines are bundled with nrtest. It is also easy to add your own.</p>
<pre><span class="p">{</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"Scoring_01"</span><span class="p">,</span>
    <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"1.0"</span><span class="p">,</span>
    <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"Basic test shooting a 6cm diameter proton beam into a water phantom."</span><span class="p">,</span>
    <span class="nt">"args"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"Scoring_01.txt"</span>
    <span class="p">],</span>
    <span class="nt">"input_files"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"Scoring_01.txt"</span><span class="p">,</span>
        <span class="s2">"GlobalParameters.txt"</span>
    <span class="p">],</span>
    <span class="nt">"output_files"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"Dose.csv"</span><span class="p">:</span> <span class="s2">"topas binned"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
<p>To execute the test, we tell <tt>nrtest</tt> where to find the configuration files and where to output the benchmark. Note that <tt>nrtest</tt> will search <tt>tests/</tt> for tests, though we could have specified <tt>tests/Scoring_01.json</tt>.</p>
<pre>$ nrtest execute apps/topas-2.0.3.json tests/ -o benchmarks/2.0.3
INFO: Found <span class="m">1</span> tests
Scoring_01: pass
INFO: Finished
</pre>
<p>To compare to a previous benchmark:</p>
<pre>$ nrtest compare benchmarks/2.0.3 benchmarks/2.0.2
Scoring_01: pass
INFO: Finished
</pre>
<p>More advanced usage is detailed in the <a href="https://nrtest.readthedocs.org/en/latest" rel="nofollow">documentation</a>.</p>
</div>
</div></body></html>