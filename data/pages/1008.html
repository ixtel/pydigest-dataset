<html><body><div><p>py.test plugin to locally test sftp server connections.</p>



<p>The SFTP-Server provided by this fixture serves content not from files but
directly from Python objects.</p>
<div id="quickstart">
<h2>Quickstart</h2>
<p>Assume you want to test a function that downloads a file from an SFTP-Server:</p>
<pre>from contextlib import closing
import paramiko
def get_sftp_file(host, port, username, password, path):
    with closing(paramiko.Transport((host, port))) as transport:
        transport.connect(username=username, password=password)
        with closing(paramiko.SFTPClient.from_transport(transport)) as sftpclient:
            with sftpclient.open(path, "r") as sftp_file:
                return sftp_file.read()
</pre>
<p>This plugin allows to test such functions without having to spin up an external
SFTP-Server by providing a pytest <a href="http://pytest.org/latest/fixture.html#fixtures-as-function-arguments" rel="nofollow">fixture</a> called <cite>sftpserver</cite>. You use it
simply by adding a parameter named <cite>sftpserver</cite> to your test function:</p>
<pre>def test_sftp_fetch(sftpserver):
    with sftpserver.serve_content({'a_dir': {'somefile.txt': "File content"}}):
        assert get_sftp_file(sftpserver.host, sftpserver.port, "user",
                             "pw", "/a_dir/somefile.txt") == "File content"
</pre>
<p>As can be seen from this example <cite>sftpserver</cite> serves content directly from
python objects instead of files.</p>
</div>
</div></body></html>