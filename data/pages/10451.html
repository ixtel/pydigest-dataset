<html><body><div><section class="entry">
<p class="fsb-clear"/><p><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_result.gif"><img class="aligncenter size-full wp-image-3641" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_result.gif" alt="determining_object_color_result"/></a></p>
<p>This is the final post in our three part series on <i>shape detection and analysis.</i></p>
<p>Previously, we learned how to:</p>
<ol>
<li><a href="http://www.pyimagesearch.com/2016/02/01/opencv-center-of-contour/" target="_blank">Compute the center of a contour</a></li>
<li><a href="http://www.pyimagesearch.com/2016/02/08/opencv-shape-detection/" target="_blank">Perform shape detection &amp; identification</a></li>
</ol>
<p>Today we are going to perform both <strong><em>shape detection</em></strong> and <strong><em>color labeling</em></strong> on objects in images.</p>
<p>At this point, we understand that regions of an image can be characterized by both <a href="http://www.pyimagesearch.com/2014/01/22/clever-girl-a-guide-to-utilizing-color-histograms-for-computer-vision-and-image-search-engines/" target="_blank">color histograms</a> and by <a href="http://www.pyimagesearch.com/2014/03/03/charizard-explains-describe-quantify-image-using-feature-vectors/" target="_blank">basic color channel statistics</a> such as mean and standard deviation.</p>
<p>But while we can compute these various statistics, they cannot give us an actual <em>label</em> such as “red”, “green”, “blue”, or “black” that tags a region as containing a specific color.</p>
<p><em><strong>…or can they?</strong></em></p>
<p>In this blog post, I’ll detail how we can leverage the <a href="https://en.wikipedia.org/wiki/Lab_color_space" target="_blank">L*a*b* color space</a> along with the Euclidean distance to tag, label, and determine the color of objects in images using Python and OpenCV.</p>

<h2>Determining object color with OpenCV</h2>
<p>Before we dive into any code, let’s briefly review our project structure:</p>

		<div id="crayon-56d5c8f8d16de663040385" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c8f8d16de663040385-1"><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d16de663040385-2"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">__init__</span><span class="crayon-e">.py</span></p><p class="crayon-line" id="crayon-56d5c8f8d16de663040385-3"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">colorlabeler</span><span class="crayon-e">.py</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d16de663040385-4"><span class="crayon-o">|</span><span class="crayon-h">    </span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">shapedetector</span><span class="crayon-e">.py</span></p><p class="crayon-line" id="crayon-56d5c8f8d16de663040385-5"><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">detect_color</span><span class="crayon-e">.py</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d16de663040385-6"><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">example_shapes</span><span class="crayon-e">.png</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Notice how we are reusing the 
			<span id="crayon-56d5c8f8d16ee953862956" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">shapedetector</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  and 
			<span id="crayon-56d5c8f8d16f3324142146" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ShapeDetector</span></span></span>  class from our <a href="http://www.pyimagesearch.com/2016/02/08/opencv-shape-detection/" target="_blank">previous blog post</a>. We’ll also create a new file, 
			<span id="crayon-56d5c8f8d16f7302707965" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">colorlabeler</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span> , that will be used to tag image regions with a <em>text label</em> of a color.</p>
<p>Finally, the 
			<span id="crayon-56d5c8f8d16fa508467819" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">detect_color</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  driver script will be used to glue all the pieces together.</p>
<p>Before you continue working through this post, make sure that you have the <a href="https://github.com/jrosebr1/imutils" target="_blank">imutils Python package</a> installed on your system:</p>

		

<p>We’ll be using various functions inside this library through the remainder of the lesson.</p>
<h3>Labeling colors in images</h3>
<p>The first step in this project is to create a Python class that can be used to label shapes in an image with their associated color.</p>
<p>To do this, let’s define a class named 
			<span id="crayon-56d5c8f8d1701361732730" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ColorLabeler</span></span></span>  in the 
			<span id="crayon-56d5c8f8d1705104925095" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">colorlabeler</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  file:</p>

		<div id="crayon-56d5c8f8d1708915324954" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-1">1</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-2">2</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-3">3</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-4">4</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-5">5</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-6">6</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-7">7</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-8">8</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-9">9</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-10">10</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-11">11</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-12">12</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-13">13</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-14">14</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-16">16</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-18">18</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-20">20</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-22">22</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-24">24</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-26">26</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1708915324954-28">28</p><p class="crayon-num" data-line="crayon-56d5c8f8d1708915324954-29">29</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">scipy</span><span class="crayon-sy">.</span><span class="crayon-e">spatial </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">distance </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">dist</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">collections</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">OrderedDict</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-6"> </p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-7"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-v">ColorLabeler</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-8"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-9"><span class="crayon-h">		</span><span class="crayon-c"># initialize the colors dictionary, containing the color</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-10"><span class="crayon-h">		</span><span class="crayon-c"># name as the key and the RGB tuple as the value</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-11"><span class="crayon-h">		</span><span class="crayon-v">colors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">OrderedDict</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-12"><span class="crayon-h">			</span><span class="crayon-s">"red"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-13"><span class="crayon-h">			</span><span class="crayon-s">"green"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-14"><span class="crayon-h">			</span><span class="crayon-s">"blue"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-15"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-16"><span class="crayon-h">		</span><span class="crayon-c"># allocate memory for the L*a*b* image, then initialize</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-17"><span class="crayon-h">		</span><span class="crayon-c"># the color names list</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-18"><span class="crayon-h">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">lab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">colors</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-19"><span class="crayon-h">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">colorNames</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-20"> </p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-21"><span class="crayon-h">		</span><span class="crayon-c"># loop over the colors dictionary</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-22"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rgb</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">colors</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-23"><span class="crayon-h">			</span><span class="crayon-c"># update the L*a*b* array and the color names list</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-24"><span class="crayon-h">			</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">lab</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">rgb</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-25"><span class="crayon-e">			</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">colorNames</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-26"> </p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-27"><span class="crayon-h">		</span><span class="crayon-c"># convert the L*a*b* array from the RGB color space</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1708915324954-28"><span class="crayon-h">		</span><span class="crayon-c"># to L*a*b*</span></p><p class="crayon-line" id="crayon-56d5c8f8d1708915324954-29"><span class="crayon-h">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">lab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">lab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_RGB2LAB</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Line 2-5</strong> imports our required Python packages while <strong>Line 7</strong> defines the 
			<span id="crayon-56d5c8f8d1711322652506" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ColorLabeler</span></span></span>  class.</p>
<p>We then dive into the constructor on <strong>Line 8</strong>. To start, we need to initialize a colors dictionary (<strong>Lines 11-14</strong>) that specifies the mapping of the <em>color name</em> (the <em>key</em> to the dictionary) to the <em>RGB tuple</em> (the <em>value</em> of the dictionary).</p>
<p>From there, we allocate memory for a NumPy array to store these colors, followed by initializing the list of color names (<strong>Lines 18 and 19</strong>).</p>
<p>The next step is to loop over the 
			<span id="crayon-56d5c8f8d1715602830305" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">colors</span></span></span>  dictionary, followed by updating the NumPy array and the 
			<span id="crayon-56d5c8f8d1718826416994" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">colorNames</span></span></span>  list, respectively (<strong>Lines 22-25</strong>).</p>
<p>Finally, we convert the NumPy “image” from the RGB color space to the <a href="https://en.wikipedia.org/wiki/Lab_color_space" target="_blank">L*a*b* color space</a>.</p>
<p>So why are we using the L*a*b* color space rather than RGB or HSV?</p>
<p>Well, in order to actually label and tag regions of an image as containing a certain color, we’ll be computing the <a href="https://en.wikipedia.org/wiki/Euclidean_distance" target="_blank">Euclidean distance</a> between our dataset of <em>known colors</em> (i.e., the 
			<span id="crayon-56d5c8f8d171c219305403" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">lab</span></span></span>  array) and the <em>averages</em> of a particular image region.</p>
<p><strong>The known color that minimizes the Euclidean distance will be chosen as the color identification.</strong></p>
<p>And unlike HSV and RGB color spaces, the Euclidean distance between L*a*b* colors has <em>actual perceptual meaning</em> — hence we’ll be using it in the remainder of this post.</p>
<p>The next step is to define the 
			<span id="crayon-56d5c8f8d1720073105842" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">label</span></span></span>  method:</p>

		<div id="crayon-56d5c8f8d1724052330919" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-32">32</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-34">34</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-35">35</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-36">36</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-38">38</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-40">40</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-42">42</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-44">44</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-46">46</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-48">48</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-50">50</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-52">52</p><p class="crayon-num" data-line="crayon-56d5c8f8d1724052330919-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1724052330919-54">54</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-31"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">label</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-32"><span class="crayon-h">		</span><span class="crayon-c"># construct a mask for the contour, then compute the</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-33"><span class="crayon-h">		</span><span class="crayon-c"># average L*a*b* value for the masked region</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-34"><span class="crayon-h">		</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-35"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">drawContours</span><span class="crayon-sy">(</span><span class="crayon-v">mask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">c</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-36"><span class="crayon-h">		</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">erode</span><span class="crayon-sy">(</span><span class="crayon-v">mask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">iterations</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-37"><span class="crayon-h">		</span><span class="crayon-v">mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mask</span><span class="crayon-o">=</span><span class="crayon-v">mask</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-38"> </p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-39"><span class="crayon-h">		</span><span class="crayon-c"># initialize the minimum distance found thus far</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-40"><span class="crayon-h">		</span><span class="crayon-v">minDist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">inf</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-41"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-42"><span class="crayon-h">		</span><span class="crayon-c"># loop over the known L*a*b* color values</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-43"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">lab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-44"><span class="crayon-h">			</span><span class="crayon-c"># compute the distance between the current L*a*b*</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-45"><span class="crayon-h">			</span><span class="crayon-c"># color value and the mean of the image</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-46"><span class="crayon-h">			</span><span class="crayon-v">d</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-sy">.</span><span class="crayon-e">euclidean</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-47"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-48"><span class="crayon-h">			</span><span class="crayon-c"># if the distance is smaller than the current distance,</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-49"><span class="crayon-h">			</span><span class="crayon-c"># then update the bookkeeping variable</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-50"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">minDist</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-51"><span class="crayon-h">				</span><span class="crayon-v">minDist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-52"> </p><p class="crayon-line" id="crayon-56d5c8f8d1724052330919-53"><span class="crayon-h">		</span><span class="crayon-c"># return the name of the color with the smallest distance</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1724052330919-54"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">colorNames</span><span class="crayon-sy">[</span><span class="crayon-v">minDist</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>The 
			<span id="crayon-56d5c8f8d1729630718410" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">label</span></span></span>  method requires two arguments: the L*a*b* 
			<span id="crayon-56d5c8f8d1730013069087" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">image</span></span></span>  containing the shape we want to compute color channel statistics for, followed by 
			<span id="crayon-56d5c8f8d1733939063109" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">c</span></span></span> , the contour region of the 
			<span id="crayon-56d5c8f8d1737207644237" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">image</span></span></span>  we are interested in.</p>
<p><strong>Lines 34 and 35</strong> construct a mask for contour region, an example of which we can see below:</p>
<div id="attachment_3639" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_mask.jpg"><img class="wp-image-3639" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_mask.jpg" alt="Figure 1: (Right) The original image. (Left) The mask image, indicating that we will only perform computations in the &quot;white&quot; region of the image, ignoring the black background." srcset="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_mask-300x137.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_mask.jpg 800w" sizes="(max-width: 600px) 100vw, 600px"/></a><p class="wp-caption-text"><strong>Figure 1:</strong> <em>(Right)</em> The original image. <em>(Left)</em> The mask image for the blue pentagon at the bottom of the image, indicating that we will only perform computations in the “white” region of the image, ignoring the black background.</p></div>
<p>Notice how the <em>foreground</em> region of the 
			<span id="crayon-56d5c8f8d173b651521948" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">mask</span></span></span>  is set to white, while the <em>background</em> is set to black. We’ll only perform computations within the masked (white) region of the image.</p>
<p>We also erode the mask slightly to ensure statistics are <em>only</em> being computed for the masked region and that <em>no background</em> is accidentally included (due to a non-perfect segmentation of the shape from the original image, for instance).</p>
<p><strong>Line 37</strong> computes the mean (i.e., average) for each of the L*, a*, and *b* channels of the 
			<span id="crayon-56d5c8f8d173f857134194" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">image</span></span></span> for <em><strong>only</strong></em> the 
			<span id="crayon-56d5c8f8d1742210520344" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">mask</span></span></span> ‘ed region.</p>
<p>Finally, <strong>Lines 43-51</strong> handles looping over each row of the 
			<span id="crayon-56d5c8f8d1745474349786" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">lab</span></span></span>  array, computing the Euclidean distance between each known color and the average color, and then returning the name of the color with the smallest Euclidean distance.</p>
<h3>Defining the color labeling and shape detection process</h3>
<p>Now that we have defined our 
			<span id="crayon-56d5c8f8d1749647206979" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ColorLabeler</span></span></span> , let’s create the 
			<span id="crayon-56d5c8f8d174c364507122" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">detect_color</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  driver script. Inside this script we’ll be combining <em>both</em> our 
			<span id="crayon-56d5c8f8d1750166150265" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ShapeDetector</span></span></span>  class from <a href="http://www.pyimagesearch.com/2016/02/08/opencv-shape-detection/" target="_blank">last week</a> and the 
			<span id="crayon-56d5c8f8d1753772007824" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ColorLabeler</span></span></span>  from today’s post.</p>
<p>Let’s go ahead and get started:</p>

		<div id="crayon-56d5c8f8d175a533962871" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c8f8d175a533962871-1"><span class="crayon-c"># import the necessary packages</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d175a533962871-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span><span class="crayon-sy">.</span><span class="crayon-e">shapedetector </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">ShapeDetector</span></p><p class="crayon-line" id="crayon-56d5c8f8d175a533962871-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span><span class="crayon-sy">.</span><span class="crayon-e">colorlabeler </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">ColorLabeler</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d175a533962871-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></p><p class="crayon-line" id="crayon-56d5c8f8d175a533962871-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d175a533962871-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></p><p class="crayon-line" id="crayon-56d5c8f8d175a533962871-7"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d175a533962871-8"><span class="crayon-c"># construct the argument parse and parse the arguments</span></p><p class="crayon-line" id="crayon-56d5c8f8d175a533962871-9"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d175a533962871-10"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-i"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5c8f8d175a533962871-11"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to the input image"</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d175a533962871-12"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Lines 2-6</strong> import our required Python packages — notice how we are importing both our 
			<span id="crayon-56d5c8f8d175e943112286" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ShapeDetector</span></span></span>  and 
			<span id="crayon-56d5c8f8d1761428345375" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ColorLabeler</span></span></span> .</p>
<p><strong>Lines 9-12 </strong>then parse our command line arguments. Like the other two posts in this series, we only need a single argument: the 
			<span id="crayon-56d5c8f8d1765819498053" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-o">--</span><span class="crayon-v">image</span></span></span>  path where the image we want to process lives on disk.</p>
<p>Next up, we can load the image and process it:</p>

		<div id="crayon-56d5c8f8d1768527531147" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-14">14</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-15">15</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-16">16</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-17">17</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-18">18</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-19">19</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-20">20</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-21">21</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-22">22</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-23">23</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-24">24</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-25">25</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-26">26</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-27">27</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-28">28</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-29">29</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-30">30</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-31">31</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-32">32</p><p class="crayon-num" data-line="crayon-56d5c8f8d1768527531147-33">33</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d1768527531147-34">34</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-14"><span class="crayon-c"># load the image and resize it to a smaller factor so that</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-15"><span class="crayon-c"># the shapes can be approximated better</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-16"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"image"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-17"><span class="crayon-v">resized</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-18"><span class="crayon-v">ratio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-v">resized</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-19"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-20"><span class="crayon-c"># blur the resized image slightly, then convert it to both</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-21"><span class="crayon-c"># grayscale and the L*a*b* color spaces</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-22"><span class="crayon-v">blurred</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">GaussianBlur</span><span class="crayon-sy">(</span><span class="crayon-v">resized</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-23"><span class="crayon-v">gray</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-v">blurred</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_BGR2GRAY</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-24"><span class="crayon-v">lab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-v">blurred</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_BGR2LAB</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-25"><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">threshold</span><span class="crayon-sy">(</span><span class="crayon-v">gray</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">THRESH_BINARY</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-26"> </p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-27"><span class="crayon-c"># find contours in the thresholded image</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-28"><span class="crayon-v">cnts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">findContours</span><span class="crayon-sy">(</span><span class="crayon-v">thresh</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">RETR_EXTERNAL</span><span class="crayon-sy">,</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-29"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">CHAIN_APPROX_SIMPLE</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-30"><span class="crayon-v">cnts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cnts</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">is_cv2</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">cnts</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-31"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-32"><span class="crayon-c"># initialize the shape detector and color labeler</span></p><p class="crayon-line" id="crayon-56d5c8f8d1768527531147-33"><span class="crayon-v">sd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ShapeDetector</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d1768527531147-34"><span class="crayon-v">cl</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ColorLabeler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><strong>Lines 16-18</strong> handle loading the image from disk and then creating a 
			<span id="crayon-56d5c8f8d176d594758338" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">resized</span></span></span>  version of it, keeping track of the 
			<span id="crayon-56d5c8f8d1770576754459" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">ratio</span></span></span>  of the original height to the resized height. We resize the image so that our contour approximation is more accurate for shape identification. Furthermore, the smaller the image is, the less data there is to process, thus our code will execute faster.</p>
<p><strong>Lines 22-25</strong> apply Gaussian smoothing to our resized image, converting to grayscale and L*a*b*, and finally thresholding to reveal the shapes in the image:</p>
<div id="attachment_3640" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_thresh.jpg"><img class="wp-image-3640" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_thresh.jpg" alt="Figure 2: Thresholding is applied to segment the background from the foreground shapes." srcset="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_thresh-300x268.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_thresh.jpg 600w" sizes="(max-width: 400px) 100vw, 400px"/></a><p class="wp-caption-text"><strong>Figure 2:</strong> Thresholding is applied to segment the background from the foreground shapes.</p></div>
<p>We find the contours (i.e., outlines) of the shapes on <strong>Lines 29-30</strong>, taking care of to grab the appropriate tuple value of 
			<span id="crayon-56d5c8f8d1774884155445" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">cnts</span></span></span>  <a href="http://www.pyimagesearch.com/2015/08/10/checking-your-opencv-version-using-python/" target="_blank">based on our OpenCV version</a>.</p>
<p>We are now ready to detect both the <em>shape</em> and <em>color</em> of each object in the image:</p>

		<div id="crayon-56d5c8f8d177b931818003" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content"><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-36">36</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-37">37</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-38">38</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-39">39</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-40">40</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-41">41</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-42">42</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-43">43</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-44">44</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-45">45</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-46">46</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-47">47</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-48">48</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-49">49</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-50">50</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-51">51</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-52">52</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-53">53</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-54">54</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-55">55</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-56">56</p><p class="crayon-num" data-line="crayon-56d5c8f8d177b931818003-57">57</p><p class="crayon-num crayon-striped-num" data-line="crayon-56d5c8f8d177b931818003-58">58</p></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-36"><span class="crayon-c"># loop over the contours</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-37"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">cnts</span><span class="crayon-o">:</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-38"><span class="crayon-h">	</span><span class="crayon-c"># compute the center of the contour</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-39"><span class="crayon-h">	</span><span class="crayon-v">M</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">moments</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-40"><span class="crayon-h">	</span><span class="crayon-v">cX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">M</span><span class="crayon-sy">[</span><span class="crayon-s">"m10"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">M</span><span class="crayon-sy">[</span><span class="crayon-s">"m00"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-41"><span class="crayon-h">	</span><span class="crayon-v">cY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">M</span><span class="crayon-sy">[</span><span class="crayon-s">"m01"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">M</span><span class="crayon-sy">[</span><span class="crayon-s">"m00"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-42"> </p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-43"><span class="crayon-h">	</span><span class="crayon-c"># detect the shape of the contour and label the color</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-44"><span class="crayon-h">	</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sd</span><span class="crayon-sy">.</span><span class="crayon-e">detect</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-45"><span class="crayon-h">	</span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cl</span><span class="crayon-sy">.</span><span class="crayon-e">label</span><span class="crayon-sy">(</span><span class="crayon-v">lab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-46"> </p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-47"><span class="crayon-h">	</span><span class="crayon-c"># multiply the contour (x, y)-coordinates by the resize ratio,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-48"><span class="crayon-h">	</span><span class="crayon-c"># then draw the contours and the name of the shape and labeled</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-49"><span class="crayon-h">	</span><span class="crayon-c"># color on the image</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-50"><span class="crayon-h">	</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">*=</span><span class="crayon-h"> </span><span class="crayon-e">ratio</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-51"><span class="crayon-e">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"{} {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">color</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-52"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">drawContours</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">c</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-53"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">putText</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">cX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-54"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">FONT_HERSHEY_SIMPLEX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-55"> </p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-56"><span class="crayon-h">	</span><span class="crayon-c"># show the output image</span></p><p class="crayon-line" id="crayon-56d5c8f8d177b931818003-57"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span></p><p class="crayon-line crayon-striped-line" id="crayon-56d5c8f8d177b931818003-58"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>We start looping over each of the contours on <strong>Line 37</strong>, while <strong>Lines 39-41</strong> compute the <a href="http://www.pyimagesearch.com/2016/02/01/opencv-center-of-contour/" target="_blank">center of the shape</a>.</p>
<p>Using the contour, we can then detect the 
			<span id="crayon-56d5c8f8d1781017264055" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">shape</span></span></span>  of the object, followed by determining its 
			<span id="crayon-56d5c8f8d1785928280448" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco"><span class="crayon-pre crayon-code"><span class="crayon-v">color</span></span></span>  on <strong>Lines 44-45</strong>.</p>
<p>Finally, <strong>Lines 50-54</strong> handle drawing the outline of the current shape, followed by the color + text label on the output image.</p>
<p><strong>Lines 57 and 58</strong> display the results to our screen.</p>
<h3>Color labeling results</h3>
<p>To run our shape detector + color labeler, just download the source code to the post using the form at the bottom of this tutorial and execute the following command:</p>

		<div id="crayon-56d5c8f8d1788877018604" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover">
		
			
			<p class="crayon-info"/>
			<p class="crayon-plain-wrap"/>
			<div class="crayon-main">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					
				</td>
						<td class="crayon-code"><div class="crayon-pre"><p class="crayon-line" id="crayon-56d5c8f8d1788877018604-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">detect_color</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">example_shapes</span><span class="crayon-e">.png</span></p></div></td>
					</tr>
				</table>
			</div>
		</div>

<p/><div id="attachment_3641" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_result.gif"><img class="size-full wp-image-3641" src="http://www.pyimagesearch.com/wp-content/uploads/2016/01/determining_object_color_result.gif" alt="Figure 3: Detecting the shape and labeling the color of objects in an image."/></a><p class="wp-caption-text"><strong>Figure 3:</strong> Detecting the shape and labeling the color of objects in an image.</p></div>
<p>As you can see from the GIF above, each object has been correctly identified both in terms of <em>shape</em> and in terms of <em>color</em>.</p>
<h3>Limitations</h3>
<p>One of the primary drawbacks to using the method presented in this post to label colors is that due to lighting conditions, along with various hues and saturations, colors <em>rarely</em> look like <strong>pure</strong> red, green, blue, etc.</p>
<p>You can often identify small sets of colors using the L*a*b* color space and the Euclidean distance, but for larger color palettes, this method will likely return incorrect results depending on the complexity of your images.</p>
<p>So, that being said, how can we <em>more reliably label</em> colors in images?</p>
<p>Perhaps there is a way to <em>“learn”</em> what colors “look like” in the real-world.</p>
<p>Indeed, there is.</p>
<p>And that’s exactly what I’ll be discussing in a future blog post.</p>
<h2>Summary</h2>
<p>Today is the final post in our three part series on shape detection and analysis.</p>
<p>We started by learning how to <a href="http://www.pyimagesearch.com/2016/02/01/opencv-center-of-contour/" target="_blank">compute the center of a contour using OpenCV</a>. Last week we learned how to utilize contour approximation to <a href="http://www.pyimagesearch.com/2016/02/08/opencv-shape-detection/" target="_blank">detect shapes in images</a>. And finally, today we combined our shape detection algorithm with a color labeler, used to tag shapes a specific color name.</p>
<p>While this method works for small color sets in semi-controlled lighting conditions, it will likely not work for larger color palettes in less controlled environments. As I hinted at in the “Limitations” section of this post, there is actually a way for us to “learn” what colors “look like” in the real-world. I’ll save the discussion of this method for a future blog post.</p>
<p><strong>So, what did you think of this series of blog posts? Be sure to let me know in the comments section.</strong></p>
<p><strong>And be sure to signup for the PyImageSearch Newsletter using the form below to be notified when new posts go live!</strong></p>
<h2 id="post_downloads">Downloads:</h2>

	</section>
	</div></body></html>