<html><body><div><div class="section" id="when-it-all-works">
<h2>When It All Works</h2>
<p>I have tried to apply these ideas to my internal projects and have had good success.
However, nothing is perfect so I’m interested to see what others say.</p>
<p>Before I go into specifics, let me give one example that just happened a week ago.
I think it illustrates my point well.</p>
<p>I received a request to produce a summary report of some data. It was an exploratory
data request for some sales information over a period of time and I had a good
idea of how to pull it together (including other scripts that did many of the
actions I needed). I figured it would have taken me 10-20 minutes of Excel manipulation
to get the report. I also knew that I could put in about 1 hour and have a python
script to pull the data and output it into an Excel file. What to do?</p>
<p>I decided to spend a little extra time and create a python script.</p>
<p>Fast forward a couple of days when I was discussing the report. The group had
some good ideas for how to modify it. For instance, we wanted to look at
prior 6 months of sales instead of 12 months. We also wanted to look at units instead
of revenue.</p>
<p>I looked at my script and in a total of less than 5 minutes, I made all those changes
and re-ran it. The new output was finished in a fraction of the time it would have
taken me to manipulate it in Excel. I also know there will be more changes and
that it is super easy to re-run it again if I need to. That extra time and attention
I spent in the beginning will save me way more time in the long run.</p>

<p>This is one small example but once you start rolling, I am confident you
will have many of your own. I am hopeful that these guidelines will be applicable
to your situations as well.</p>
</div>
<div class="section" id="general-guidelines">
<h2>General Guidelines</h2>
<p>One of the biggest pieces of advice I have is to treat your code like an open source
project. I do not mean that you release all your code to the world but that you
should use the best practices and conventions in the open source world to make
your repository more manageable. Always think about how you would hand this
code off to someone else in your organization.</p>
<div class="section" id="use-version-control">
<h3>Use Version Control</h3>
<p>Whatever you do, make sure you check the code into a version control system. Even
if you think you’ll be the only person using it and that the code won’t grow and
change that much - do it. There is no excuse. If you have an internal system,
use it. If not, then look for alternatives. I know that most people use github
but bitbucket is actually a little more attractive if you want to use it for
private repos. You can have unlimited private repos and up to 5 users in the
<a class="reference external" href="https://bitbucket.org/plans/">free plan</a>.</p>
<p>The one caveat I would have is to make sure you understand your company’s policy
on this type of hosting. Some companies may have restrictions on
using external version control systems. I will leave it to you to navigate that.</p>
<p>One word of caution I would give you is to keep any confidential data sorted locally
and not stored in an external repo. Your code is going to be mostly useless without
the data files so I would feel most comfortable with that approach. Please make
sure you understand your organization’s policies.</p>
<p>Even if you find yourself unable to host code externally, you can still set up
a local mercurial repo. The other really cool thing is that you can use
<code class="code">
hg serve</code>
 to have a <a class="reference external" href="http://hgbook.red-bean.com/read/collaborating-with-other-people.html#sec:collab:serve">local webserver</a> that allows you to browse your repo and
view changesets. This is a really useful feature for an individual developer.</p>

<p>Once you have a repo set up, then you should start to manage the code in the repo
like you would an open source project. What does that mean?</p>
<ol class="arabic simple">
<li>Document the code with a <span class="caps">README</span> file. If you create a <span class="caps">README</span>, this has the
advantage of giving you a nice summary of what is in the repo. In my <span class="caps">README</span>, I
include certain items like:<ul>
<li>Overview of the required python versions and how to get them.</li>
<li>Description of major packages (Pandas, <span class="caps">SQL</span> Alchemy, etc)</li>
<li>Description of each file, including working files, log files, configs.</li>
<li>Notes on upgrading the environment or configuring certain items.</li>
<li>What the directories are used for. As mentioned above, I don’t keep the
external files in a remote repo but do want to keep a record of the
various directories I use and how I get the files.</li>
<li>Notes on when specific files need to be run (daily, monthly, etc).</li>
<li>Reminders to yourself about how to update packages or any dependencies.</li>
</ul>
</li>
<li>Have good commit notes. It’s so easy to put in commit notes like
“Minor formatting changes” or “Fixes for Joe”. However, those notes will not help
you when you’re trying to figure out why you made a change many months ago. This
<a class="reference external" href="https://vip.wordpress.com/documentation/commit-messages/">post</a> is a good summary of what your commits should look like.</li>
<li>Consider using the ticket functionality. If your code is in bitbucket or github
then you get ticket functionality for free. Go ahead and use it. Anything you
can do to help pull your thoughts and history together in one place is a good
idea. If you use tickets, make sure to reference them in your commit notes.</li>
</ol>
</div>
<div class="section" id="document-your-code">
<h3>Document Your Code</h3>
<p>Even when you have  only a few lines of code in a file, you should still make
sure to follow good coding practices. One of the most important is good
documentation. For the particular class of problems we are solving, I want
to cover a couple of specific methods that have worked well for me.</p>
<p>I like to include a couple of items in the docstring header of my file that look
something like this:</p>
<div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">"""</span>
<span class="sd">Created on Tue Jun 30 11:12:50 2015</span>

<span class="sd">Generate 12 month sales trends of Product X, Y and Z</span>
<span class="sd">Report was requested by Jane Smith in marketing</span>
<span class="sd">Expect this to be an ad-hoc report to support new product launch in Q3 2015</span>

<span class="sd">Source data is from SAP ad-hoc report generated by Fred Jones</span>
<span class="sd">Output is summarized Excel report</span>
<span class="sd">"""</span>
</pre></div>
<p>In the example above, I include a creation date as well as a summary of what the
script is for. I also find it incredibly useful to include who is asking for it
and then some idea if this is a one off request or something I intend to run
frequently. Finally, I include descriptions of any input and output files. If I
am working on a file that someone gave to me, I need to make sure I understand
how to get it again.</p>
<p>In addition to summary info, I wanted to give a couple of specific examples
of inline code comments.</p>
<p>For instance, if you have any code that you are using based on a stack overflow
answer or blog post, I recommend you provide a link back to the original answer
or post. In one particular case, I wanted to merge two dictionaries together.
Since I was not sure the best approach, I searched the web and found a detailed
stack overflow <a class="reference external" href="http://stackoverflow.com/questions/38987/how-can-i-merge-two-python-dictionaries-in-a-single-expression">answer</a>.</p>
<p>Here is what my comment looked like:</p>
<div class="highlight"><pre><span class="c"># Create one dict of all promo codes</span>
<span class="c"># We know keys are unique so this is ok approach</span>
<span class="c"># http://stackoverflow.com/questions/38987/how-can-i-merge-two-python-dictionaries-in-a-single-expression</span>
<span class="n">all_promos</span> <span class="o">=</span> <span class="n">sold_to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">all_promos</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">regional</span><span class="p">)</span>
</pre></div>
<p>Another important item to comment would be business rationale around
certain assumptions. For instance, the following code is straightforward pandas and
wouldn’t warrant a comment except for understanding why are we choosing the number 3.</p>
<div class="highlight"><pre><span class="c"># Also filter out any accounts with less than 3 units.</span>
<span class="c"># These accounts are just noise for this analysis.</span>
<span class="c"># These are typically smaller accounts with no consistent business</span>
<span class="n">all_data</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[</span><span class="n">all_data</span><span class="p">[</span><span class="s">"Volume"</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="code-style">
<h3>Code Style</h3>
<p>Fortunately python has many tools to help you enforce the style of your code.
If you want to read lots of opinions there is a <a class="reference external" href="https://www.reddit.com/r/Python/comments/2on5ug/which_python_linters_to_use/">reddit discussion</a> on the options.
I personally think that <a class="reference external" href="https://pypi.python.org/pypi/pyflakes/">pyflakes</a> is useful for the style of coding we’re
discussing. I think the actual choice matters less than the fact that you do
make a choice.</p>
<p>I encourage you to use an editor that has some sort of integration with one of
these tools. I find that it helps me make sure my spacing is consistent and that
I don’t have imported but unused modules. It won’t guarantee bug free code but
the consistency really helps when you look at code that is several months/years old.</p>
<p>I also encourage you to read and follow the <a class="reference external" href="http://docs.python-guide.org/en/latest/writing/style/">Python Code Style Guide</a>. It contains
a bunch of useful examples for best practices in python coding. You should refer
to it often and try to incorporate these guidelines in your code, no matter how
small the script.</p>
</div>
<div class="section" id="managing-input-and-outputs">
<h3>Managing Input and Outputs</h3>
<p>Many of the scripts will have multiple input and output files. I try to
keep all of the files in one input directory and one output directory. I also
include a date (and sometimes) time stamp in my files so that I can run them multiple times
and have some record of the old ones. If you need to run them multiple times
per day, you would need to include the time as well as the date.</p>
<p>Here is a code snippet I frequently use in my scripts:</p>
<div class="highlight"><pre><span class="c"># Data files are stored relative to the current script</span>
<span class="n">INCOMING</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s">"in"</span><span class="p">)</span>
<span class="n">OUTGOING</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s">"out"</span><span class="p">)</span>
<span class="n">default_file_name</span> <span class="o">=</span> <span class="s">"Marketing-Launch-Report-{:%m-</span><span class="si">%d</span><span class="s">-%Y}.xlsx"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
<span class="n">save_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTGOING</span><span class="p">,</span> <span class="n">default_file_name</span><span class="p">)</span>
<span class="n">input_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">INCOMING</span><span class="p">,</span> <span class="s">"inputfile.xlsx"</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
<span class="c"># Do more stuff with pandas here</span>
<span class="c"># Save the data to excel by creating a writer so that we can easily add</span>
<span class="c"># multiple sheets</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
<p>In addition to this code, here are a couple of recommendations on managing your
input files:</p>
<ul class="simple">
<li>Try not to make any alterations by hand to the file. Keep it as close to the
original as possible.</li>
<li>Don’t delete old input files, move them to an archive directory so you don’t
lose them.</li>
</ul>
</div>
<div class="section" id="choosing-3rd-party-apps">
<h3>Choosing 3rd Party Apps</h3>
<p>One of the huge advantages of python is the rich ecosystem of 3rd party
modules that are readily available and easy to install. The downside to this
is that you can sometimes get stuck trying to figure out which ones to install.
Choice is good but too much time can be wasted evaluating all the options.</p>

<p>In general, I try to solve my problems by:</p>
<ol class="arabic simple">
<li>Making sure python’s standard library can’t do it already</li>
<li>Use a package from <a class="reference external" href="http://docs.continuum.io/anaconda/pkg-docs.html">Anaconda</a> (my distro of choice)</li>
<li>Choosing a package that is easy to install with pip install</li>
</ol>
<p>One example is <a class="reference external" href="https://docs.python.org/2/howto/argparse.html">argparse</a>. I frequently use code like this:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">argparse</span>

<span class="c"># Functions here</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">'Create Marketing Report'</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--accounts'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">'Process Account Data)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--sales'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">'Process Sales Data'</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="c"># Process accounts</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">accounts</span><span class="p">:</span>
        <span class="c"># Do something</span>
    <span class="c"># Process sales</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sales</span><span class="p">:</span>
        <span class="c"># Do Something</span>
</pre></div>
<p>For me, this is perfectly serviceable for my simple scripts. I don’t need anything more.</p>
<p>However, python has a bunch of different <a class="reference external" href="http://docs.python-guide.org/en/latest/scenarios/cli/">Command line frameworks</a>. For more complex
command line apps, you may need some of these but if you are just getting started,
the basic <code class="code">
argparse</code>
 module is going to work just fine.</p>
<p>If I had to use another framework, I would first take a look at the options
included in <a class="reference external" href="http://docs.continuum.io/anaconda/pkg-docs.html">Anaconda</a> and make a choice from there.</p>
<p>Finally, if I really had the need for something else I would evaluate the options
available to me via <code class="code">
pip</code>
.</p>
<p>My point with this discussion is that just because there is a third party module,
don’t assume you need it right away. Try to work your way up the decision process
I outlined and use the module when you need it.</p>
<p>The main reason for limiting the number of additional modules is that it makes
maintaining and re-creating your environment that much easier. By minimizing
the number of extra modules, you minimize your setup confusion. Obviously,
there is some judgement here. Certain modules are defacto standards or
absolutely required for your needs. Just make sure you do need it before
you blindly assume you do.</p>
</div>
</div>
<div class="section" id="best-practices-with-pandas">
<h2>Best Practices with Pandas</h2>
<p>If you are in a business setting (and reading this blog) you are probably
using <a class="reference external" href="http://pandas.pydata.org/">pandas</a> in your scripts. Over time, I’ve found a few things that
I consistently do that make the overall development and maintenance process easier.</p>
<div class="section" id="name-your-columns">
<h3>Name your columns</h3>
<p>When reading in data via excel or csv, you will end up with really
long column names or columns in different dataframes that represent the same
item but are labeled differently.</p>
<p>For instance, “State”, “st”, “state”, “<span class="caps">US</span> State” may all mean the same thing
but are labeled differently depending on your inputs.</p>
<p>The other issue is when you have overly long column names like,
“Assistant to the Regional Manager”. If you have to type that over and over
you may want to just shorten it to “Asst”.</p>
<p>One solution is to define the labels when you read in the data by using the
<code class="code">
names</code>
 argument:</p>
<div class="highlight"><pre><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">"number"</span><span class="p">,</span> <span class="s">"name"</span><span class="p">,</span> <span class="s">"region"</span><span class="p">,</span> <span class="s">"territory"</span><span class="p">,</span> <span class="s">"Rep_Name"</span><span class="p">,</span> <span class="s">"state"</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
<p>The other option is to rename all the columns after you have your dataframe:</p>
<div class="highlight"><pre><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"number"</span><span class="p">,</span> <span class="s">"name"</span><span class="p">,</span> <span class="s">"region"</span><span class="p">,</span> <span class="s">"territory"</span><span class="p">,</span> <span class="s">"Rep_Name"</span><span class="p">,</span> <span class="s">"state"</span><span class="p">]</span>
</pre></div>
<p>This option is best when you have a smaller number of columns and want to change
all of their names.</p>
<p>The final option is to rename the columns using <code class="code">
df.rename</code>
:</p>
<div class="highlight"><pre><span class="n">column_names</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Number'</span><span class="p">:</span> <span class="s">'number'</span><span class="p">,</span>
                <span class="s">'Account name'</span><span class="p">:</span> <span class="s">'name'</span><span class="p">,</span>
                <span class="s">'Geographical Region'</span><span class="p">:</span> <span class="s">'region'</span><span class="p">,</span>
                <span class="s">'Sales Representative Name'</span><span class="p">:</span> <span class="s">'Rep_name'</span><span class="p">,</span>
                <span class="s">'Home State'</span><span class="p">:</span> <span class="s">'state'</span>
                <span class="p">}</span>
<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p>Using <code class="code">
rename</code>
 is useful because you can just pass in the specific columns you
want to rename. It will leave any other column names untouched.</p>
<p>It is best to do this as early in the script as possible so that you can take advantage
of it in the rest of your code.</p>
</div>
<div class="section" id="check-your-data-types">
<h3>Check your data types</h3>
<p>Pandas is really good at reading in your data and building a useable
dataframe. The downside is that you might think you have a date column but
it is instead stored as an object. This could become a problem when you
start trying to do calculations. I find it is best to make sure the columns
you need to be a certain type are in that type so your numeric and data
calculations work as expected.</p>
<p>For instance, if you have a numeric column and see that it is of a dtype “object”
then pandas does not think it is a number.</p>
<div class="highlight"><pre><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span> <span class="c"># all columns have the object datatype</span>
</pre></div>
<div class="highlight"><pre>a    object
b    object
c    object
</pre></div>
<p>If you want to force the column to another type, you can use <code class="code">
astype</code>
</p>

<p>If you want to force a column to a datetime type:</p>
<div class="highlight"><pre><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
</pre></div>
<p>Pandas also has a helpful <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.convert_objects.html">convert_objects</a> which will convert an entire dataframe.</p>
<div class="highlight"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">convert_objects</span><span class="p">(</span><span class="n">convert_numeric</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">convert_dates</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p>There is one other datatype that can be handy and that pandas will not automatically
create but that is easy for you to create: <a class="reference external" href="http://pandas.pydata.org/pandas-docs/version/0.16.2/api.html#categorical">Categorical</a>. This <a class="reference external" href="http://continuum.io/blog/pandas-categoricals">blog post</a>
gives some good reasons why you might want to use this data type and shows
how simple it is to do and how much more efficient it can make your code.</p>
<p>If you have a set of data in a column that falls into a small discrete number
of items, categoricals might make sense. In a business setting examples of
categorial items include:</p>
<ul class="simple">
<li>Geographies like countries and states</li>
<li>People like management hierarchy</li>
<li>Products (shoes, shirts, etc.)</li>
<li>Attributes (colors, size, etc)</li>
</ul>
<p>Creating a category is as simple as:</p>
<div class="highlight"><pre><span class="n">df</span><span class="p">[</span><span class="s">"size"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"size"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'category'</span><span class="p">)</span>
</pre></div>
<p>Categoricals are also nice because you can define their order. This attribute
will make certain types of output simpler. For cases where categories make
sense to be ordered, go ahead and do it.</p>
<div class="highlight"><pre><span class="n">df</span><span class="p">[</span><span class="s">"size"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"size"</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">([</span><span class="s">'s'</span><span class="p">,</span> <span class="s">'m'</span><span class="p">,</span> <span class="s">'l'</span><span class="p">,</span> <span class="s">'xl'</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="format-at-the-end">
<h3>Format at the end</h3>
<p>If you generate Excel files as output, hopefully you are using XlsxWriter to
<a class="reference external" href="http://pbpython.com/improve-pandas-excel-output.html">format them</a>. One of the things I recommend is that you format your data
at the very end of the process. It is very frustrating to get all the way through
and then realize you need to add a couple of new columns and your formatting is
all messed up. I use a function call to modify the writer. I don’t actually put
anything in here until I am 95%+ confident that the output looks like I want it
to. Here is how I set up my formatting:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">format_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Go through the output Excel file and do some column formatting to make the</span>
<span class="sd">    numeric formats correct and ensure columns are wide enough to easily view.</span>
<span class="sd">    """</span>
    <span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
    <span class="n">money_fmt</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s">'num_format'</span><span class="p">:</span> <span class="s">'$#,##0'</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="p">[</span><span class="s">"All"</span><span class="p">,</span> <span class="s">"Summary"</span><span class="p">]:</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">tab</span><span class="p">]</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'B:G'</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'I:J'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">money_fmt</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'L:M'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">money_fmt</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c"># Lots of code here</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s">'xlsxwriter'</span><span class="p">)</span>
    <span class="n">summary_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s">"Summary"</span><span class="p">)</span>
    <span class="n">all_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s">"All"</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">format_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div></body></html>