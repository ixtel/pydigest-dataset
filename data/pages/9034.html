<html><body><div><div class="section-inner layoutSingleColumn"><h2 name="5992" id="5992" class="graf--h2 graf--first">Learning How To Code Neural Networks</h2><p name="71ef" id="71ef" class="graf--p graf-after--h2">This is the second post in a series of me trying to learn something new over a short period of time. The first time consisted of learning how to do <a href="https://blog.skcript.com/machine-learning-in-a-week-a0da25d59850#.p5e1j11ry" data-href="https://blog.skcript.com/machine-learning-in-a-week-a0da25d59850#.p5e1j11ry" class="markup--anchor markup--p-anchor" rel="nofollow">machine learning in a week.</a></p><p name="3234" id="3234" class="graf--p graf-after--p">This time I’ve tried to learn neural networks. While I didn’t manage to do it within a week, due to various reasons, I did get a basic understanding of it throughout the summer and autumn of 2015.</p><p name="6dbd" id="6dbd" class="graf--p graf-after--p">By <em class="markup--em markup--p-em">basic understanding</em>, I mean that I finally know how to code <a href="https://github.com/perborgen?tab=repositories" data-href="https://github.com/perborgen?tab=repositories" class="markup--anchor markup--p-anchor" rel="nofollow">simple neural networks</a> from scratch on my own.</p><p name="4cf4" id="4cf4" class="graf--p graf-after--p">In this post, I’ll give a few explanations and guide you to the resources I’ve used, in case you’re interested in doing this yourself.</p><h4 name="265a" id="265a" class="graf--h4 graf-after--p">Step 1: Neurons and forward propagation</h4><p name="7d4f" id="7d4f" class="graf--p graf-after--h4">So what is a neural network? Let’s wait with the network part and start off with one single neuron.</p><blockquote name="6ef0" id="6ef0" class="graf--pullquote pullquote graf-after--p">A neuron is like a function; it takes a few inputs and calculates an output.</blockquote><p name="d522" id="d522" class="graf--p graf-after--pullquote">The circle below illustrates an artificial neuron. Its input is 5 and its output is 1. The input is the sum of the three synapses connecting to the neuron (the three arrows at the left).</p><figure name="aa84" id="aa84" class="graf--figure graf-after--p"/><p name="67fd" id="67fd" class="graf--p graf-after--figure">At the far left we see two input values plus a bias value. The input values are 1 and 0 (the green numbers), while the bias holds a value of -2 (the brown number).</p><blockquote name="e83c" id="e83c" class="graf--blockquote graf-after--p">The inputs here might be numerical representations of two different features. If we’re building a spam filter, it could be wether or not the email contains more than one CAPITALIZED WORD and wether or not it contains the word ‘viagra’.</blockquote><p name="4b7e" id="4b7e" class="graf--p graf-after--blockquote">The two inputs are then multiplied by their so called weights, which are 7 and 3 (the blue numbers).</p><p name="af93" id="af93" class="graf--p graf-after--p">Finally we add it up with the bias and end up with a number, in this case: 5 (the red number). This is the input for our artificial neuron.</p><figure name="efde" id="efde" class="graf--figure graf-after--p"/><p name="1056" id="1056" class="graf--p graf-after--figure">The neuron then performs some kind of computation on this number — in our case the Sigmoid function, and then spits out an output. This happens to be 1, as Sigmoid of 5 equals to 1, if we round the number up (more info on the Sigmoid function follows later).</p><blockquote name="f9e3" id="f9e3" class="graf--blockquote graf-after--p">If this was a spam filter, the fact that we’re outputting 1 (as opposed to 0) probably means that the neuron has labeled the text as ‘spam’.</blockquote><figure name="04f3" id="04f3" class="graf--figure graf--layoutOutsetLeft graf-after--blockquote"><figcaption class="imageCaption">A neural network illustration from <a href="https://en.wikipedia.org/wiki/Artificial_neural_network" data-href="https://en.wikipedia.org/wiki/Artificial_neural_network" class="markup--anchor markup--figure-anchor" rel="nofollow">Wikipedia.</a></figcaption></figure><p name="73d2" id="73d2" class="graf--p graf-after--figure">If you connect a network of these neurons together, you have a neural network, which propagates forward — from input output, via neurons which are connected to each other through synapses, like on the image to the left.</p><p name="fb3b" id="fb3b" class="graf--p graf-after--p">I can strongly recommend the <a href="https://www.youtube.com/watch?v=bxe2T-V8XRs" data-href="https://www.youtube.com/watch?v=bxe2T-V8XRs" class="markup--anchor markup--p-anchor" rel="nofollow">Welch Labs videos on YouTube</a> for getting a better intuitive explanation of this process.</p><h4 name="fe17" id="fe17" class="graf--h4 graf-after--p">Step 2: Understanding the Sigmoid function</h4><p name="bdc7" id="bdc7" class="graf--p graf-after--h4">After you’ve seen the Welch Labs videos, its a good idea to spend some time watching <a href="https://www.coursera.org/learn/machine-learning/home/week/4" data-href="https://www.coursera.org/learn/machine-learning/home/week/4" class="markup--anchor markup--p-anchor" rel="nofollow">Week 4 of the Coursera’s Machine Learning course</a>, which covers neural networks, as it’ll give you more intuition of how they work.</p><p name="e8f7" id="e8f7" class="graf--p graf-after--p">The course is fairly mathematical, and its based around Octave, while I prefer Python. Because of this, I did not do the programming exercises. Instead, I used the videos to help me understand what I needed to learn.</p><p name="4496" id="4496" class="graf--p graf-after--p">The first thing I realized I needed to investigate further was the Sigmoid function, as this seemed to be a critical part of many neural networks. I knew a little bit about the function, as it was also covered in Week 3 of <a href="https://www.coursera.org/learn/machine-learning/" data-href="https://www.coursera.org/learn/machine-learning/" class="markup--anchor markup--p-anchor" rel="nofollow">the same course</a>. So I went back and watched these videos again.</p><figure name="8710" id="8710" class="graf--figure graf--layoutOutsetLeft graf-after--p"><figcaption class="imageCaption">The Sigmoid function simply maps your value (along the horizontal axis) to a value between 0 and 1.</figcaption></figure><p name="5395" id="5395" class="graf--p graf-after--figure">But watching videos won’t get you all the way. To really understand it, I felt I needed to code it from the ground up.</p><p name="1a8c" id="1a8c" class="graf--p graf-after--p">So I started to code a logistic regression algorithm from scratch (which happened to use the Sigmoid function).</p><p name="3646" id="3646" class="graf--p graf-after--p">It took a whole day, and it’s probably not a very good implementation of logistic regression. But that doesn’t matter, as I finally understood how it works. Check the code <a href="https://github.com/perborgen/LogisticRegression" data-href="https://github.com/perborgen/LogisticRegression" class="markup--anchor markup--p-anchor" rel="nofollow">here.</a></p><p name="e7c6" id="e7c6" class="graf--p graf-after--p">You don’t need to perform this entire exercise yourself, as it requires some knowledge about and cost functions and gradient descent, which you might not have at this point.</p><p name="5bcb" id="5bcb" class="graf--p graf-after--p">But make sure you understand how the Sigmoid function works.</p><h4 name="1738" id="1738" class="graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Step 3: Understanding backpropagation</strong></h4><p name="2386" id="2386" class="graf--p graf-after--h4">Understanding how a neural network works from input to output isn’t that difficult to understand, at least conceptually.</p><p name="049b" id="049b" class="graf--p graf-after--p">More difficult though, is understanding how the neural network actually learns from looking at a set of data samples.</p><p name="6a1a" id="6a1a" class="graf--p graf-after--p">The concept is called backpropagation.</p><blockquote name="9fff" id="9fff" class="graf--pullquote pullquote graf-after--p">This essentially means that you look at <strong class="markup--strong markup--pullquote-strong">how wrong </strong>the network guessed, and then adjust the networks weights accordingly.</blockquote><p name="d1dc" id="d1dc" class="graf--p graf-after--pullquote">The weights were the blue numbers on our neuron in the beginning of the article.</p><p name="512e" id="512e" class="graf--p graf-after--p">This process happens backwards, because you start at the end of the network (observe how wrong the networks ‘guess’ is), and then move backwards through the network, while adjusting the weights on the way, until you finally reach the inputs.</p><p name="a143" id="a143" class="graf--p graf-after--p">To calculate this by hand requires some calculus, as it involves getting some derivatives of the networks’ weights. The <a href="https://www.khanacademy.org/" data-href="https://www.khanacademy.org/" class="markup--anchor markup--p-anchor" rel="nofollow">Kahn Academy</a> calculus courses seems like a good way to start, though I haven’t used them myself, as I took calculus on university.</p><blockquote name="f88c" id="f88c" class="graf--blockquote graf-after--p">Note: there are a lot of libraries that calculates the derivatives for you, so if you’d like to start coding neural networks before completely understanding the math, you’re fully able to do this as well.</blockquote><figure name="c909" id="c909" class="graf--figure graf-after--blockquote"><figcaption class="imageCaption">Screehshot from Matt Mazurs<a href="http://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/" data-href="http://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/" class="markup--anchor markup--figure-anchor" rel="nofollow"> tutorial on backpropagation.</a></figcaption></figure><p name="5c61" id="5c61" class="graf--p graf-after--figure">The three best sources I found for understanding backpropagation are these:</p><p name="c93f" id="c93f" class="graf--p graf-after--li">You should definitely code along while you’re reading the articles, especially the two first ones. It’ll give you some sample code to look back at when you’re confused in the future.</p><p name="da7a" id="da7a" class="graf--p graf-after--p">Plus, I can’t really emphasize this enough:</p><blockquote name="8d71" id="8d71" class="graf--pullquote pullquote graf-after--p">You don’t learn much by reading about neural nets, you need to practice it to make the knowledge stick.</blockquote><p name="90c5" id="90c5" class="graf--p graf-after--pullquote">The third article is also fantastic, but I’ve used this more as a wiki than a plain tutorial, as it’s actually an entire book. It contains thorough explanations all the important concepts in neural networks.</p><p name="22a9" id="22a9" class="graf--p graf-after--p">These articles will also help you understand important concepts as cost functions and gradient descent, which play equally important roles in neural networks.</p><h4 name="b87f" id="b87f" class="graf--h4 graf-after--p">Step 4: Coding your own neural networks</h4><p name="d4e6" id="d4e6" class="graf--p graf-after--h4">In some articles and tutorials you’ll actually end up coding small neural networks. As soon as you’re comfortable with that, I recommend you to go all in on this strategy. It’s both fun and an extremely effective way of learning.</p><p name="91c7" id="91c7" class="graf--p graf-after--p">One of the articles I also learned a lot from was <a href="http://iamtrask.github.io/2015/07/12/basic-python-network/" data-href="http://iamtrask.github.io/2015/07/12/basic-python-network/" class="markup--anchor markup--p-anchor" rel="nofollow">A Neural Network in 11 Lines Of Python</a> by <a href="https://twitter.com/iamtrask" data-href="https://twitter.com/iamtrask" class="markup--anchor markup--p-anchor" rel="nofollow">IAmTrask</a>. It contains an extraordinary amount of compressed knowledge and concepts in just 11 lines.</p><figure name="69b5" id="69b5" class="graf--figure graf-after--p"><figcaption class="imageCaption">Screenshot from the <a href="https://iamtrask.github.io/2015/07/12/basic-python-network/" data-href="https://iamtrask.github.io/2015/07/12/basic-python-network/" class="markup--anchor markup--figure-anchor" rel="nofollow">IAmTrask tutorial</a></figcaption></figure><p name="7b8e" id="7b8e" class="graf--p graf-after--figure">After you’ve coded along with this example, you should do as the article states at the bottom, which is to implement it once again without looking at the tutorial. This forces you to really understand the concepts, and will likely reveal holes in your knowledge, which isn’t fun. However, when you finally manage it, you’ll feel like you’ve just acquired a new superpower.</p><blockquote name="1cea" id="1cea" class="graf--blockquote graf-after--p">A little side note: When doing exercises I was often confused by the vectorized implementations some tutorials use, as it requires a little bit of linear algebra to understand. Once again, I turned myself back to the Coursera ML course, as Week 1 contains a full section of <a href="https://www.coursera.org/learn/machine-learning/home/week/1" data-href="https://www.coursera.org/learn/machine-learning/home/week/1" class="markup--anchor markup--blockquote-anchor" rel="nofollow">linear algebra review.</a> This helps you to understand how matrixes and vectors are multiplied in the networks.</blockquote><p name="193f" id="193f" class="graf--p graf-after--blockquote">When you’ve done this, you can continue with this <a href="http://www.wildml.com/2015/09/implementing-a-neural-network-from-scratch/" data-href="http://www.wildml.com/2015/09/implementing-a-neural-network-from-scratch/" class="markup--anchor markup--p-anchor" rel="nofollow">Wild ML tutorial,</a> by <a href="https://medium.com/u/85005d8f5c2d" data-href="https://medium.com/u/85005d8f5c2d" data-anchor-type="2" data-user-id="85005d8f5c2d" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user">Denny Britz</a>, which guides you through a little more robust neural network.</p><figure name="bdd7" id="bdd7" class="graf--figure graf-after--p"><figcaption class="imageCaption">Screenshot from the <a href="http://www.wildml.com/2015/09/implementing-a-neural-network-from-scratch/" data-href="http://www.wildml.com/2015/09/implementing-a-neural-network-from-scratch/" class="markup--anchor markup--figure-anchor" rel="nofollow">WildML tutorial</a>.</figcaption></figure><p name="4365" id="4365" class="graf--p graf-after--figure">At this point, you could either try and code your own neural network from scratch or start playing around with some of the networks you have coded up already. It’s great fun to find a dataset that interests you and try to make some predictions with your neural nets.</p><p name="5c76" id="5c76" class="graf--p graf-after--p">To get a hold of a dataset, just visit my side project <a href="http://www.datasets.co/" data-href="http://www.datasets.co/" class="markup--anchor markup--p-anchor" rel="nofollow">Datasets.co</a> (← shameless self promotion) and find one you like.</p><figure name="5768" id="5768" class="graf--figure graf-after--p"><figcaption class="imageCaption">Visit <a href="http://www.datasets.co/" data-href="http://www.datasets.co/" class="markup--anchor markup--figure-anchor" rel="nofollow">Datasets.co</a> to get hold of a dataset</figcaption></figure><p name="f94a" id="f94a" class="graf--p graf-after--figure">Anyway, the point is that you’re now better off experimenting with stuff that interests you rather than following my advices.</p><p name="ef03" id="ef03" class="graf--p graf-after--p">Personally, I’m currently learning how to use Python libraries that makes it easier to code up neural networks, like Theano, Lasagne and nolearn. I’m using this to do challenges on <a href="http://www.kaggle.com" data-href="http://www.kaggle.com" class="markup--anchor markup--p-anchor" rel="nofollow">Kaggle</a>, which is both great fun and great learning.</p><p name="705b" id="705b" class="graf--p graf-after--p">Good luck!</p><p name="d66d" id="d66d" class="graf--p graf-after--p graf--last">And don’t forget to press the heart button if you liked the article :)</p></div></div></body></html>