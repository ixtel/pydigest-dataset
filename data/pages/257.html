<html><body><div><div class="content-body tutorial-content tutorial-content-legacy" data-growable-markdown="">
      <h3 id="introduction">Introduction</h3>

<hr/>

<p>Web frameworks provide a quick and easy way to jump start a web application.  Almost every web framework adheres to the MVC software pattern.  MVC stands for model, view, and controller.  It is a way of distinguishing and separating the different functions of an application to simplify its design and allow each piece to be changed independently of the other components.</p>

<p>Pyramid is a lightweight web framework for Python applications.  It allows you to get a basic web application up and running quickly.  In fact, it can create the entire framework layout in a single file if you would like.</p>

<p>In this guide, we will introduce you to how to set up Pyramid on your Ubuntu system.  We will then walk you through the basic commands and processes that will allow you to successfully launch an application with this framework.</p>



<hr/>

<p>Before you begin, you must have some prerequisite packages installed.  Since Pyramid is a Python framework, you will need the version of Python that your application was running.</p>

<p>We will be using Python 3 in this guide.  Depending on the version of Ubuntu you have installed, this may be included by default.</p>

<p>Either way, you should run the following command to install the development header files needed by some Pyramid extensions.  If you do not have Python 3 installed, this will be pulled in as a dependency.  Additionally, we will download the <code>setuptools</code> package:</p>
<pre class="code-pre "><code langs="">sudo apt-get update
sudo apt-get install python3-dev python3-setuptools
</code></pre>
<p>We will also need the <code>virtualenv</code> package.  You can do this through the <code>easy_install</code> command:</p>
<pre class="code-pre "><code langs="">sudo easy_install virtualenv
</code></pre>
<p>You should now have the basic components necessary to start working with Pyramid.</p>

<h2 id="configure-the-application-environment">Configure the Application Environment</h2>

<hr/>

<p>Now that we have the Python version we need and the bootstrapping tools necessary to build our application, we can configure our application environment.</p>

<p>The virtualenv package allows us to set up an isolated Python environment.  We will set this up first, and then install the Pyramid files within this environment.</p>

<p>Begin by navigating to your home directory.  From here, we will make a directory to house our project files:</p>
<pre class="code-pre "><code langs="">cd ~
mkdir pyramid_sites
cd pyramid_sites
</code></pre>
<p>Within this directory, we will create our virtual environment.  This will create an isolated bubble where we can install Python tools and libraries without affecting our system's tools.</p>
<pre class="code-pre "><code langs="">virtualenv --no-site-packages env
</code></pre>
<p>This creates a directory called "env" in our current folder.  This is where the environment files are installed.</p>

<p>We can activate our virtual environment, changing the installation context, with this command:</p>
<pre class="code-pre "><code langs="">source env/bin/activate
</code></pre>
<p>This will change the prompt to include the virtual environment.  This makes it easy to know if you are in the virtual environment or not.  If you need to deactivate the environment later, you can type:</p>
<pre class="code-pre "><code langs="">deactivate
</code></pre>
<p>Do not deactivate the environment yet though.  We can install Pyramid in the virtual environment by typing:</p>
<pre class="code-pre "><code langs="">easy_install pyramid
</code></pre>
<p>This will install all of the necessary files for our framework.</p>

<h2 id="set-up-a-sample-application">Set Up a Sample Application</h2>

<hr/>

<p>One of the benefits of the Pyramid framework is that it can be extremely lightweight.  The web framework can be implemented within a single file.</p>

<h3 id="breaking-down-a-one-file-configuration">Breaking Down a One File Configuration</h3>

<hr/>

<p>We can create a one file configuration using an <a href="http://docs.pylonsproject.org/projects/pyramid/en/latest/narr/configuration.html#imperative-configuration">example from the Pyramid project</a>.  This will be a simple 'hello world' application.  We will mainly use it to show some different parts of a general configuration file:</p>

<p>First, create a directory for your application.</p>
<pre class="code-pre "><code langs="">mkdir ~/pyramid_sites/hello_world
cd ~/pyramid_sites/hello_world
</code></pre>
<p>Inside, we can create an <code>application.py</code> file and fill it with the following contents:</p>
<pre class="code-pre "><code langs="">nano application.py
</code></pre>
<hr/>
<pre class="code-pre "><code langs="">from wsgiref.simple_server import make_server
from pyramid.config import Configurator
from pyramid.response import Response

def hello_world(request):
    return Response('&lt;h1&gt;Hello world!&lt;/h1&gt;')

if __name__ == '__main__':
    config = Configurator()
    config.add_view(hello_world)
    app = config.make_wsgi_app()
    server = make_server('0.0.0.0', 8080, app)
    server.serve_forever()
</code></pre>
<p>Let's examine this file in chunks so we can see how Pyramid works.</p>

<p>At the head of the file, we have the import statements:</p>
<pre class="code-pre "><code langs="">from wsgiref.simple_server import make_server
from pyramid.config import Configurator
from pyramid.response import Response
</code></pre>
<p>The first line imports the <code>make_server</code> function, which can create a simple web server when it is passed an application.  The second and third line import the <code>Configurator</code> and <code>Response</code> functions from Pyramid.</p>

<p>These functions are used to configure details and set parameters for the application and respond to requests, respectively.</p>

<p>Next, we have a function definition called <code>hello_world</code>:</p>
<pre class="code-pre "><code langs="">def hello_world(request):
    return Response('&lt;h1&gt;Hello world!&lt;/h1&gt;')
</code></pre>
<p>This function represents a "view" for our application.  Remember, most web frameworks implement an MVC (model, view, controller) paradigm.  A function that fulfills the requirements of a view is responsible for rendering the text that will be passed back to the requesting entity.</p>

<p>In this case, the function, when called, uses the <code>Response</code> function we imported earlier.  This passes back a value that should be given to the client.  In our simple app, this is a very trivial view implementation.</p>

<p>The main portion of the program happens next.  It starts with a common Python convention for calling the main executable portion of a program:</p>
<pre class="code-pre "><code langs="">if __name__ == '__main__':
</code></pre>
<p>This line specifies that if the file is the "main" file being run (meaning it is not being imported and called by another file), the following commands should be run.</p>
<pre class="code-pre "><code langs="">    config = Configurator()
    config.add_view(hello_world)
    app = config.make_wsgi_app()
    server = make_server('0.0.0.0', 8080, app)
    server.serve_forever()
</code></pre>
<p>The first line here creates a variable called <code>config</code> out of the object created by the <code>Configurator</code> function that we imported at the top of the program.</p>

<p>The next line calls the <code>add_view</code> method of this object.  This method is used to define a view that can be used by the application.  As you can see, we pass in the <code>hello_world</code> function we defined earlier.  This is where that function is actually incorporated as a view.</p>

<p>The following line actually creates the WSGI application by calling the <code>make_wsgi_app</code> method of the config object.  This uses the object's attributes, such as the view we added, to create an application.</p>

<p>This application is then passed to the <code>make_server</code> function we imported in order to create an object that can launch a web server to serve our application.  The last line launches this server.</p>

<p>Save and close the file when you are finished.</p>

<p>To launch the application, you simply need to point Python at it:</p>
<pre class="code-pre "><code langs="">python application.py
</code></pre>
<p>Now, if you navigate to the port you defined in the configuration ('8080'), you will see the text you put in your view function:</p>

<pre>
http://<span class="highlight">your_ip_address</span>:8080
</pre>

<p><img src="https://assets.digitalocean.com/articles/pyramid/hello_world.png" alt="DigitalOcean Pyramid hello world"/></p>

<h2 id="create-a-sample-pyramid-application-with-scaffolding">Create a Sample Pyramid Application With Scaffolding</h2>

<hr/>

<p>In the previous example, we did everything through a single file.  While this is a good way to show how compact and simple the process of creating an MVC application with Pyramid is, it isn't always the easiest way of going about things.</p>

<p>Like most popular frameworks, Pyramid can use "scaffolding" to quickly create a complex project directory structure.  We can use the scaffolding through a tool called <code>pcreate</code>.</p>

<p>Back into the Pyramid directory and check what scaffolding we have available:</p>
<pre class="code-pre "><code langs="">cd ~/pyramid_sites
pcreate -l
</code></pre>
<hr/>
<pre class="code-pre "><code langs="">Available scaffolds:
  alchemy:  Pyramid SQLAlchemy project using url dispatch
  starter:  Pyramid starter project
  zodb:     Pyramid ZODB project using traversal
</code></pre>
<p>The first option creates a project with SQL integration.  The second creates a basic project with no persistence between application instances.  The third can create an application to run with ZODB if you are using Python 2.</p>

<p>We can create a scaffolded project by choosing the template and naming the project:</p>
<pre class="code-pre "><code langs="">pcreate -s starter first_project
</code></pre>
<p>This will create a directory named after the project, go inside to see the files that were created:</p>
<pre class="code-pre "><code langs="">cd first_project
ls
</code></pre>
<hr/>
<pre class="code-pre "><code langs="">CHANGES.txt  development.ini  first_project  MANIFEST.in  production.ini  README.txt  setup.cfg  setup.py
</code></pre>
<p>This is a much larger set of files than our last example.  The files directly in this folder are mainly used for configuration.  The program itself is mainly contained within the sub-folder with the project's name.</p>

<p>To see what the scaffolding accomplished, run the setup script to configure the application for a development environment.</p>
<pre class="code-pre "><code langs="">python setup.py develop
</code></pre>
<p>This will read configure your application using the parameters available within the <code>development.ini</code> file.</p>

<p>Afterwards, we can serve the project by typing:</p>
<pre class="code-pre "><code langs="">pserve development.ini
</code></pre>
<p>If you visit your IP address followed by the port number specified on the command line (it should be "6543"), you will see the default application:</p>

<p><img src="https://assets.digitalocean.com/articles/pyramid/scaffold.png" alt="DigitalOcean Pyramid scaffolding site"/></p>

<p>Press "Ctrl-C" in the terminal to stop the web server.</p>

<p>We can enable a debugging panel within the configuration file to allow us to get valuable information about our application.</p>

<p>Edit the <code>development.ini</code> file:</p>
<pre class="code-pre "><code langs="">nano development.ini
</code></pre>
<p>Inside, at the bottom of the <code>[app:main]</code> section, add this line to allow any connecting hosts to view the debugging toolbar:</p>

<pre>
[app:main]
. . .
. . .
pyramid.includes =
    pyramid_debugtoolbar
<span class="highlight">debugtoolbar.hosts = 0.0.0.0/0</span>
</pre>

<p>Save and close the file.  Now, if you restart the server and reload the web page, you will see a debugging toolbar on the right-hand side:</p>
<pre class="code-pre "><code langs="">pserve development.ini
</code></pre>
<hr/>

<p><img src="https://assets.digitalocean.com/articles/pyramid/debug.png" alt="DigitalOcean Pyramid debug toolbar"/></p>

<p>Within this project's structure, you can configure complex MVC interactions.</p>

<h2 id="conclusion">Conclusion</h2>

<hr/>

<p>We have just scratched the surface of what Pyramid can do.  Hopefully, by this point you can see that it has a simple structure built upon Python's conventions and it is flexible enough to scale from extremely easy sites to more complete designs requiring complex interactions.</p>

<p>Explore the documentation for Pyramid in order to get a better understanding of how to implement larger applications.  The framework provides many tools in order to take your application through the development cycle (including incorporated testing), and into production.</p>

<p class="author">By Justin Ellingwood</p>

    </div>
</div></body></html>