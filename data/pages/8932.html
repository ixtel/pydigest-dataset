<html><body><div><div class="entry-content">

                

                <p>Сегодня хочу описать как работать с <code>Feedly</code> через их API в языке Python.</p>
<p>Для начала ссылки, которые точно понадобятся:</p>

<p>Разработчики из Feedly довольно активно желают, чтобы сторонние разработчики участвовали в совершенствовании сервиса. 
Поэтому если вам необходимы какие-то хитрые условия для работы вашего приложения - изменить ограничение по запросам, как пример, то Feedly могут пойти на встречу.</p>
<p>В Feedly есть 3 варианта API:</p>
<ul>
<li>Работа в “<code>песочнице</code>” - <a href="https://sandbox.feedly.com/">https://sandbox.feedly.com/</a>
</li>
<li>Работа с облаком - это <a href="cloud.feedly.com">https://cloud.feedly.com</a>, который является главным сервисом, все пользователи его видят
</li>
<li>И <code>development sandbox</code>. Отличие от первого варианта, что работаешь не через свой аккаунт. А через общий сервис<ul>
<li>Раз в месяц в группе (рыссылке) размещают токен.</li>
</ul>
</li>
</ul>
<p>Интересен мне второй вариант, про него и будет рассказ.</p>
<p>Стоит обратить внимание что в документации можно найти готовые запросы с помощью <code>curl</code>. Т.е. даже не трогая никакого языка программирования можно работать с API Feedly.</p>
<p>Я же буду работать в Python.</p>
<p>И буду использовать <code>python-feedly</code></p>
<p>Устанавливаем спомощью pip:</p>
<p><code>pip install python-feedly</code></p>
<p>В <a href="https://github.com/WarmongeR1/python-feedly/blob/master/README.rst"><code>README.md</code></a> есть готовые примеры для использования. Их и заиспользуем:</p>
<div class="highlight"><pre><span class="n">feedly</span> <span class="o">=</span> <span class="n">FeedlyClient</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span> <span class="n">sandbox</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>


<p>Где <code>token</code>, это длинная строчка типа <code>AhQjf…...Q:feedlydev</code>
Объект есть, теперь можно возиться с ним.</p>
<p>Не стану разводить тут мысли и раздумья и покажу как получить список непрочитанных новостей. </p>
<blockquote>
<p>В документации используется понятие <code>stream_id</code>. Это <code>id</code> почти любого объекта, например, категория, feed и др.</p>
</blockquote>
<p>Получим все категории:</p>
<div class="highlight"><pre><span class="n">categories</span> <span class="o">=</span> <span class="n">feedly</span><span class="o">.</span><span class="n">get_info_type</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="s1">'categories'</span><span class="p">)</span>
</pre></div>


<p>А теперь получим все непрочитанные новости из этих категорий.</p>
<div class="highlight"><pre><span class="n">articles</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">category</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">categories</span><span class="p">):</span>
   <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">category</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"{} of {} category ({})"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">),</span> <span class="n">category</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'label'</span><span class="p">)))</span>
       <span class="n">result</span> <span class="o">=</span> <span class="n">feedly</span><span class="o">.</span><span class="n">get_feed_content</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">category</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'id'</span><span class="p">),</span> <span class="bp">True</span><span class="p">,</span> <span class="n">previous_time</span><span class="p">)</span>
       <span class="n">items</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'items'</span><span class="p">,</span> <span class="p">[])</span>
       <span class="n">articles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</pre></div>


<p>,где <code>token</code> уже знаем что такое, 
<code>previous_time</code> это время начиная с которого хочется получить статьи, целое число, время в unix time.</p>
<p>Оп, теперь в <code>acticles</code> есть список статей, которые не прочтены.</p>
<p>Заголовок, ссылку на новость и описание можно получить так:</p>
<div class="highlight"><pre><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">:</span>
   <span class="n">url</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'alternate'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'href'</span><span class="p">)</span>
   <span class="n">title</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
   <span class="n">description</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'summary'</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'content'</span><span class="p">)</span>
</pre></div>


<p>Теперь умеем получать категории, статьи, а у статей доставать описание, название, ссылку. 
Этого уже достаточно, чтобы написать свой фильтр RSS. </p>
<p>В API Feedly есть еще много всяких возможностей. Пользуйтесь.</p>
            </div>
            
</div></body></html>