<html><body><div><div class="section-inner layoutSingleColumn"><h3 name="3c5a" id="3c5a" class="graf--h3 graf--first">Build a homemade spying machine with a Raspberry-Pi, Firebase, AngularJS and some Python</h3><figure name="fba9" id="fba9" class="graf--figure graf--layoutOutsetLeft graf-after--h3"/><p name="39db" id="39db" class="graf--p graf-after--figure">My favorite characters in spy movies were always the gadget-making-mad-scientists building crazy little machines which help the spy-hero to pull off his amazing feats. Q has always been a much more appealing character than Bond to me, as was Donatello over Leonardo as my favorite Ninja-Turtle.</p><p name="35c3" id="35c3" class="graf--p graf-after--p">Cheap new hardware and the quickly-growing “maker” mindset give us a small opportunity to step into the shoes of such childhood heroes.</p><p name="8692" id="8692" class="graf--p graf-after--p">In this article, I will show you how to build a nifty little device that will allow you to monitor which wifi-enabled devices are present in your home, even when you’re away. We’ll be building a web-based app which we’ll use to view this data from anywhere we have an internet connection. This way you have your Bond-like little device in which you can check up devices which are close to anywhere where you can give it some electricity.</p><blockquote name="ccb8" id="ccb8" class="graf--blockquote graf-after--p">Disclaimer: this article is created for educational purposes, do not spy on your friends and family as it is unfriendly and immoral! (it may also be illegal)</blockquote><p name="8a4f" id="8a4f" class="graf--p graf-after--blockquote">As you may well know, your smartphone or tablet are constantly looking for known WiFi networks as they do so they send over radio waves unencrypted messages known as “Probe” messages to check if any of the wifi networks which they are already familiar with are around. Different devices behave differently, some probe for networks constantly in the background, while other do this only when you open the screen and try to use the internet. The thing that’s interesting to us in this project is that while your device probes for wifi networks it broadcasts it’s MAC-address (a uniqe number identifying itself). If we’re able to listen to these communications, we’ll be able to log who is physically around us, since most people constantly carry their smartphone with them.</p><h4 name="7674" id="7674" class="graf--h4 graf-after--p">Our setup</h4><p name="3484" id="3484" class="graf--p graf-after--h4">This is how we’re going to pull this off:</p><ul class="postList"><li name="a30b" id="a30b" class="graf--li graf-after--p">We will set up a Raspberry Pi B+ with a WiFi dongle</li><li name="e2ce" id="e2ce" class="graf--li graf-after--li">We will run airodump-ng on our Pi in the background to listen for probe messages</li><li name="86e3" id="86e3" class="graf--li graf-after--li">We will write a small python program to process the out from airodump and send it to a Firebase database</li><li name="97a1" id="97a1" class="graf--li graf-after--li">We will write a small web-client to read realtime data from Firebase and show us which devices are near our Pi or have been recently.</li></ul><h4 name="409d" id="409d" class="graf--h4 graf-after--li">Setting up your Pi to monitor for probe messages</h4><p name="f7c0" id="f7c0" class="graf--p graf-after--h4">In order to monitor probe messages we’ll be using a tool called <a href="http://www.aircrack-ng.org/doku.php?id=airodump-ng&amp;DokuWiki=95560e9f99bfee4d78e81aa1436e2cf1" data-href="http://www.aircrack-ng.org/doku.php?id=airodump-ng&amp;DokuWiki=95560e9f99bfee4d78e81aa1436e2cf1" class="markup--anchor markup--p-anchor" rel="nofollow">airodump-ng</a>, which is a part of the <a href="http://www.aircrack-ng.org/" data-href="http://www.aircrack-ng.org/" class="markup--anchor markup--p-anchor" rel="nofollow">aircrack-ng</a> suite used for all sorts of wifi-related functions (such as cracking the key of password-protected wifi networks). Let’s install it.</p><figure name="2c87" id="2c87" class="graf--figure graf--iframe graf-after--p"><p class="iframeContainer"/><figcaption class="imageCaption"><a href="https://gist.github.com/rotemtam/1e08f6b73befd5faef81" data-href="https://gist.github.com/rotemtam/1e08f6b73befd5faef81" class="markup--anchor markup--figure-anchor" rel="nofollow">https://gist.github.com/rotemtam/1e08f6b73befd5faef81</a></figcaption></figure><p name="513e" id="513e" class="graf--p graf-after--figure">For the purpose of this article, I assume that you have a Wifi dongle which supports “monitor-mode” and that it’s set up on the interface “wlan0". We create the following shell script which will basically put your wifi dongle in monitoring mode and then activate airodump-ng and tell it to save all output to a .csv file in your /tmp folder.</p><figure name="7e6c" id="7e6c" class="graf--figure graf--iframe graf-after--p"><p class="iframeContainer"/><figcaption class="imageCaption"><a href="https://gist.github.com/rotemtam/e4e0c84d9dd6fbac5ec2" data-href="https://gist.github.com/rotemtam/e4e0c84d9dd6fbac5ec2" class="markup--anchor markup--figure-anchor" rel="nofollow">https://gist.github.com/rotemtam/e4e0c84d9dd6fbac5ec2</a></figcaption></figure><p name="bd21" id="bd21" class="graf--p graf-after--figure">You can run this in the background, using screen for example.</p><h4 name="3ca9" id="3ca9" class="graf--h4 graf-after--p">Use Python and Firebase to make realtime data available</h4><p name="e50b" id="e50b" class="graf--p graf-after--h4"><a href="https://www.firebase.com/" data-href="https://www.firebase.com/" class="markup--anchor markup--p-anchor" rel="nofollow">Firebase</a> (recently acquired by Google) is a pretty cool product that allows your to create realtime apps very easily. In our project we’ll be using python to write data about devices (called “Stations”) our Pi will discover using airodump-ng, to a Firebase database and later we’ll write a little angularjs-based app to pull this data and display it in realtime. Cool thing about Firebase is that it lets you create save and read data from the cloud without needing to build a server-side cloud-hosted app, say using Django or Rails.</p><p name="26da" id="26da" class="graf--p graf-after--p">Go ahead and open a new account at Firebase, they have a free “hacker” plan which is more than enough to get you started.</p><p name="2162" id="2162" class="graf--p graf-after--p">With airodump-ng running in the background, we will use the following python script to continuously poll the .csv file created by it, format it and then use <a href="https://github.com/mikexstudios/python-firebase" data-href="https://github.com/mikexstudios/python-firebase" class="markup--anchor markup--p-anchor" rel="nofollow">Mike Huynh’s python wrapper for the Firebase RESTful API</a> to push the data to our Firebase database.</p><figure name="6e77" id="6e77" class="graf--figure graf--iframe graf-after--p"><p class="iframeContainer"/><figcaption class="imageCaption"><a href="https://gist.github.com/rotemtam/9ca5e26d6989ad7f5da7" data-href="https://gist.github.com/rotemtam/9ca5e26d6989ad7f5da7" class="markup--anchor markup--figure-anchor" rel="nofollow">https://gist.github.com/rotemtam/9ca5e26d6989ad7f5da7</a></figcaption></figure><p name="9365" id="9365" class="graf--p graf-after--figure">This script should be running in the background on your Pi as well.</p><h4 name="c767" id="c767" class="graf--h4 graf-after--p">Create a simple client to show the data in realtime</h4><figure name="de4b" id="de4b" class="graf--figure graf--layoutOutsetLeft graf-after--h4"/><p name="af9b" id="af9b" class="graf--p graf-after--figure">In order to view all the data collected by our Pi via the Internet, we’ll create an angularjs based webapp which will display information about devices seen by our Pi. It will only take a few minutes to do with yeoman’s <a href="https://www.npmjs.org/package/generator-angularfire" data-href="https://www.npmjs.org/package/generator-angularfire" class="markup--anchor markup--p-anchor" rel="nofollow">angular-firebase generator</a>.</p><p name="bc92" id="bc92" class="graf--p graf-after--p">We won’t go step by step in actually creating the app, for which you can get the code at : <a href="https://github.com/rotemtam/pi-mac-monitor" data-href="https://github.com/rotemtam/pi-mac-monitor" class="markup--anchor markup--p-anchor" rel="nofollow">https://github.com/rotemtam/pi-mac-monitor</a> (see instructions in the README), but here’s some information about how it works.</p><p name="ec70" id="ec70" class="graf--p graf-after--p">The web-app only has one view and a single controller. The controller uses the <a href="https://github.com/firebase/angularFire" data-href="https://github.com/firebase/angularFire" class="markup--anchor markup--p-anchor" rel="nofollow">angular-fire</a> plugin, which allows us to have realtime data in our angular $scope, and have the view be update when the data changes on the server.</p><p name="5837" id="5837" class="graf--p graf-after--p">View:</p><figure name="b06c" id="b06c" class="graf--figure graf--iframe graf-after--p"><p class="iframeContainer"/><figcaption class="imageCaption"><a href="https://gist.github.com/rotemtam/3cc7d46e5ff1bbf4eaaf" data-href="https://gist.github.com/rotemtam/3cc7d46e5ff1bbf4eaaf" class="markup--anchor markup--figure-anchor" rel="nofollow">https://gist.github.com/rotemtam/3cc7d46e5ff1bbf4eaaf</a></figcaption></figure><p name="9f8c" id="9f8c" class="graf--p graf-after--figure">Controller:</p><figure name="ebd2" id="ebd2" class="graf--figure graf--iframe graf-after--p"><p class="iframeContainer"/><figcaption class="imageCaption"><a href="https://gist.github.com/rotemtam/95b5e84ee9946767435a" data-href="https://gist.github.com/rotemtam/95b5e84ee9946767435a" class="markup--anchor markup--figure-anchor" rel="nofollow">https://gist.github.com/rotemtam/95b5e84ee9946767435a</a></figcaption></figure><h4 name="9fd0" id="9fd0" class="graf--h4 graf-after--figure">Summary</h4><p name="dcd0" id="dcd0" class="graf--p graf-after--h4">That’s it! in less then an hour you can be spying on your house members from afar! Just kidding, respect people’s privacy!</p><p name="0dc5" id="0dc5" class="graf--p graf-after--p graf--last"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Like This Post? </em></strong><em class="markup--em markup--p-em">Check out </em><a href="http://referral.ezra-app.co" data-href="http://referral.ezra-app.co" class="markup--anchor markup--p-anchor" rel="nofollow"><em class="markup--em markup--p-em">Ezra</em></a><em class="markup--em markup--p-em">, a new app I’m working on. Ezra gathers responses from people so you don’t have to.</em></p></div></div></body></html>