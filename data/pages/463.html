<html><body><div><div class="pf-content"><p>Python’s logging module has lots of options. In this article, we will looks at the logging module’s ability to create Rotating Logs. Python supports two types of rotating logs:</p>
<ul>
<li>Rotate logs based on size (<strong>RotatingFileHandler</strong>)</li>
<li>Rotate the logs based on some time interval (<strong>TimedRotatingFileHandler</strong>)</li>
</ul>
<p>Let’s spend some time learning how each of these two types of loggers are implemented and used.<span id="more-3807"/></p>
<hr/>
<h3>The RotatingFileHandler</h3>
<p>
</p><p>The RotatingFileHandler class within the logging module allows the developer to create a logging handler object that gives them the ability to rotate their logs based on the size of the log. You can use the <strong>maxBytes</strong> parameter to tell it when to rotate the log. This means that when the log reaches a certain number of bytes, it gets “rolled over”. This occurs when the file size is about to be exceeded. The handler will close the file and silently open a new one. If you pass in a number for the <strong>backupCount</strong> parameter, then it will append “.1”, “.2”, etcetera to the end of the log files. Let’s take a look at a simple example:</p>
<pre class="python"><span>import</span> <span>logging</span>
<span>import</span> <span>time</span>
 
<span>from</span> <span>logging</span>.<span>handlers</span> <span>import</span> RotatingFileHandler
 
<span>#----------------------------------------------------------------------</span>
<span>def</span> create_rotating_log<span>(</span>path<span>)</span>:
    <span>""</span><span>"
    Creates a rotating log
    "</span><span>""</span>
    logger = <span>logging</span>.<span>getLogger</span><span>(</span><span>"Rotating Log"</span><span>)</span>
    logger.<span>setLevel</span><span>(</span><span>logging</span>.<span>INFO</span><span>)</span>
 
    <span># add a rotating handler</span>
    handler = RotatingFileHandler<span>(</span>path, maxBytes=<span>20</span>,
                                  backupCount=<span>5</span><span>)</span>
    logger.<span>addHandler</span><span>(</span>handler<span>)</span>
 
    <span>for</span> i <span>in</span> <span>range</span><span>(</span><span>10</span><span>)</span>:
        logger.<span>info</span><span>(</span><span>"This is test log line %s"</span> <span>%</span> i<span>)</span>
        <span>time</span>.<span>sleep</span><span>(</span><span>1.5</span><span>)</span>
 
<span>#----------------------------------------------------------------------</span>
<span>if</span> __name__ == <span>"__main__"</span>:
    log_file = <span>"test.log"</span>
    create_rotating_log<span>(</span>log_file<span>)</span></pre>
<p>This code is based on an example from the <a href="http://docs.python.org/2/howto/logging-cookbook.html#using-file-rotation" target="_blank">Python Logging Cookbook</a>. Here we create a rotating log with a logging level of INFO. Then we set up the handler to rotate the log whenever the log file is 20 bytes in length. Yes, that’s an absurdly low number, but it makes demonstrating what happens easier. Next we create a loop that will create 10 lines in our log file with a sleep in between each call to log. If you run this code, you should end up with six files: the original test.log and 5 backup logs. </p>
<p>Now let’s look at how to use a <strong>TimedRotatingFileHandler</strong>.</p>
<hr/>
<h3>The TimedRotatingFileHandler</h3>
<p>
</p><p>The TimedRotatingFileHandler allows the developer to create a rotating log based on how much time has elapsed. You can set it to rotate the log on the following time conditions:</p>
<ul>
<li>second (s)</li>
<li>minute (m)</li>
<li>hour (h)</li>
<li>day (d)</li>
<li>w0-w6 (weekday, 0=Monday)</li>
<li>midnight</li>
</ul>
<p>To set one of these conditions, you just pass it in the <strong>when</strong> parameter, which is the 2nd argument. You will also want to set the interval parameter too. Let’s take a look at an example:</p>
<pre class="python"><span>import</span> <span>logging</span>
<span>import</span> <span>time</span>
 
<span>from</span> <span>logging</span>.<span>handlers</span> <span>import</span> TimedRotatingFileHandler
 
<span>#----------------------------------------------------------------------</span>
<span>def</span> create_timed_rotating_log<span>(</span>path<span>)</span>:
    <span>""</span><span>""</span><span>""</span>
    logger = <span>logging</span>.<span>getLogger</span><span>(</span><span>"Rotating Log"</span><span>)</span>
    logger.<span>setLevel</span><span>(</span><span>logging</span>.<span>INFO</span><span>)</span>
 
    handler = TimedRotatingFileHandler<span>(</span>path,
                                       when=<span>"m"</span>,
                                       interval=<span>1</span>,
                                       backupCount=<span>5</span><span>)</span>
    logger.<span>addHandler</span><span>(</span>handler<span>)</span>
 
    <span>for</span> i <span>in</span> <span>range</span><span>(</span><span>6</span><span>)</span>:
        logger.<span>info</span><span>(</span><span>"This is a test!"</span><span>)</span>
        <span>time</span>.<span>sleep</span><span>(</span><span>75</span><span>)</span>
 
<span>#----------------------------------------------------------------------</span>
<span>if</span> __name__ == <span>"__main__"</span>:
    log_file = <span>"timed_test.log"</span>
    create_timed_rotating_log<span>(</span>log_file<span>)</span></pre>
<p>This example will rotate the log every minute with a back up count of 5. A more realistic rotation would probably be on the hour, so you would set the interval to 60 or the when to “h”. When this code is run, it too will create 6 files, but instead of appending integers to the log file name, it will append a timestamp using the strftime format <strong>%Y-%m-%d_%H-%M-%S</strong>.</p>
<hr/>
<h3>Wrapping Up</h3>
<p>
</p><p>Now you know how to use Python’s powerful rotating logs. Hopefully you will be able to integrate it into your own applications or future programs. </p>
<hr/>
<h3>Related Reading</h3>
<p>
</p>
</div>	</div></body></html>