<html><body><div><div class="post-body entry-content"><p>
Во многих компаниях давно использующих python недолюбливают django. Раньше мне было не вполне понятно почему. Я считал это снобизмом. Теперь уверился, что джуниоры, начинающие свой практический путь с использования только фреймворков теряют потенцию искать решение самостоятельно. Первое, что они делают, когда сталкиваются с проблемой - гуглят готовое решение или желательно сразу батарейку. Если удалось найти решение сразу на стэковерфлоу - это победа. Скорей всего, люди писавшие ответ уже подумали, а значит нам думать и вовсе не нужно.Если ошибочное мнение повторено еще и в чьем-нибудь бложике, так вообще здорово. Ты на верном пути, будущий Лайнус Торвальдс. Проблемы начинаются потом. Решение нужно масштабировать/поддерживать/развивать, а понимания того, как оно работает нет.</p>
<p>
Порой доходит до совсем смешного. Предположим некое API, в одном из методов принимает два POST параметра, для которых по сути не нужны ни валидаторы диапазона, ни проверка ввода. Как это правильно делать с точки зрения Django? Надо написать форму!

</p><pre><strong class="k">class</strong> <strong class="nc">DjangoForm</strong><span class="p">(</span><span class="n">forms</span>.<span class="n">Form</span><span class="p">):</span>
    <span class="n">param1</span> = <span class="n">forms</span>.<span class="n">CharField</span><span class="p">(</span><span class="n">required</span>=False<span class="p">)</span>
    <span class="n">param2</span> = <span class="n">forms</span>.<span class="n">CharField</span><span class="p">(</span><span class="n">required</span>=False<span class="p">)</span>


<strong class="k">def</strong> testFormView<span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">form</span> = <span class="n">DjangoForm</span><span class="p">(</span><span class="n">request</span>.<span class="n">POST</span><span class="p">)</span>
    <strong class="k">if</strong> <span class="n">form</span>.<span class="n">is_valid</span><span class="p">():</span>
        <span class="n">param1</span> = <span class="n">form</span>.<span class="n">cleaned_data</span><span class="p">[</span>'param1'<span class="p">]</span>
        <span class="n">param2</span> = <span class="n">form</span>.<span class="n">cleaned_data</span><span class="p">[</span>'param2'<span class="p">]</span> </pre>
<p>
Но в рамках того же проекта на django можно просто обработать POST-параметры:
</p><pre><strong class="k">def</strong> testPOSTView<span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <strong class="k">if</strong> <span class="n">request</span>.<span class="n">method</span> == 'POST'<span class="p">:</span>
        <span class="n">param1</span> = <span class="n">request</span>.<span class="n">POST</span>.<span class="n">get</span><span class="p">(</span>'param1'<span class="p">)</span>
        <span class="n">param2</span> = <span class="n">request</span>.<span class="n">POST</span>.<span class="n">get</span><span class="p">(</span>'param2'<span class="p">)</span> </pre>
<p>
Возьмем для простоты улучшенный RequestFactory из https://djangosnippets.org/snippets/2231/ и напишем простяцкий тест:
</p><pre><span class="n">request</span> = <span class="n">RequestFactory</span><span class="p">()</span>.<span class="n">post</span><span class="p">(</span>'/submit/'<span class="p">,</span> <span class="p">{</span>'param1'<span class="p">:</span> 'value1'<span class="p">,</span> 'param2'<span class="p">:</span> 'value2'<span class="p">})</span>


<strong class="k">def</strong> timeit<span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">times</span><span class="p">):</span>
    <span class="n">start</span> = <span class="n">time</span>.<span class="n">time</span><span class="p">()</span>
    <strong class="k">for</strong> <span class="n">i</span> <strong class="ow">in</strong> range<span class="p">(</span>0<span class="p">,</span> <span class="n">times</span><span class="p">):</span>
        <span class="n">func</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <strong class="k">return</strong> <span class="n">time</span>.<span class="n">time</span><span class="p">()</span> - <span class="n">start</span>


<strong class="k">def</strong> main<span class="p">():</span>
    <strong class="k">print</strong> <span class="n">timeit</span><span class="p">(</span><span class="n">testFormView</span><span class="p">,</span> 10000<span class="p">)</span>
    <strong class="k">print</strong> <span class="n">timeit</span><span class="p">(</span><span class="n">testPOSTView</span><span class="p">,</span> 10000<span class="p">)</span></pre>
<p>
Результат этого теста 1.77991509438 против 0.0828511714935.
</p><p/>
</div>
</div></body></html>